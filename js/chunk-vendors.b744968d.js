(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-vendors"],{"007d":function(e,t,n){var i=n("3eba");n("cb8f"),n("a96b"),n("42f6"),i.registerAction({type:"showTip",event:"showTip",update:"tooltip:manuallyShowTip"},function(){}),i.registerAction({type:"hideTip",event:"hideTip",update:"tooltip:manuallyHideTip"},function(){})},"0156":function(e,t,n){var i=n("6d8b");function r(e,t,n){n=n||{};var r=e.coordinateSystem,a=t.axis,o={},s=a.getAxesOnZeroOf()[0],l=a.position,u=s?"onZero":l,c=a.dim,d=r.getRect(),f=[d.x,d.x+d.width,d.y,d.y+d.height],h={left:0,right:1,top:0,bottom:1,onZero:2},p=t.get("offset")||0,g="x"===c?[f[2]-p,f[3]+p]:[f[0]-p,f[1]+p];if(s){var m=s.toGlobalCoord(s.dataToCoord(0));g[h["onZero"]]=Math.max(Math.min(m,g[1]),g[0])}o.position=["y"===c?g[h[u]]:f[0],"x"===c?g[h[u]]:f[3]],o.rotation=Math.PI/2*("x"===c?0:1);var v={top:-1,bottom:1,left:-1,right:1};o.labelDirection=o.tickDirection=o.nameDirection=v[l],o.labelOffset=s?g[h[l]]-g[h["onZero"]]:0,t.get("axisTick.inside")&&(o.tickDirection=-o.tickDirection),i.retrieve(n.labelInside,t.get("axisLabel.inside"))&&(o.labelDirection=-o.labelDirection);var y=t.get("axisLabel.rotate");return o.labelRotate="top"===u?-y:y,o.z2=1,o}t.layout=r},"01e1":function(e,t,n){"use strict";t["a"]="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope},"01ed":function(e,t,n){var i=n("3eba"),r=n("6d8b"),a=n("2306");n("5aa9"),n("af24"),i.extendComponentView({type:"grid",render:function(e,t){this.group.removeAll(),e.get("show")&&this.group.add(new a.Rect({shape:e.coordinateSystem.getRect(),style:r.defaults({fill:e.get("backgroundColor")},e.getItemStyle()),silent:!0,z2:-1}))}}),i.registerPreprocessor(function(e){e.xAxis&&e.yAxis&&!e.grid&&(e.grid={})})},"01f9":function(e,t,n){"use strict";var i=n("2d00"),r=n("5ca1"),a=n("2aba"),o=n("32e9"),s=n("84f2"),l=n("41a0"),u=n("7f20"),c=n("38fd"),d=n("2b4c")("iterator"),f=!([].keys&&"next"in[].keys()),h="@@iterator",p="keys",g="values",m=function(){return this};e.exports=function(e,t,n,v,y,_,b){l(n,t,v);var E,T,S,w=function(e){if(!f&&e in R)return R[e];switch(e){case p:return function(){return new n(this,e)};case g:return function(){return new n(this,e)}}return function(){return new n(this,e)}},A=t+" Iterator",I=y==g,x=!1,R=e.prototype,C=R[d]||R[h]||y&&R[y],D=C||w(y),k=y?I?w("entries"):D:void 0,M="Array"==t&&R.entries||C;if(M&&(S=c(M.call(new e)),S!==Object.prototype&&S.next&&(u(S,A,!0),i||"function"==typeof S[d]||o(S,d,m))),I&&C&&C.name!==g&&(x=!0,D=function(){return C.call(this)}),i&&!b||!f&&!x&&R[d]||o(R,d,D),s[t]=D,s[A]=m,y)if(E={values:I?D:w(g),keys:_?D:w(p),entries:k},b)for(T in E)T in R||a(R,T,E[T]);else r(r.P+r.F*(f||x),t,E);return E}},"0352":function(e,t,n){var i=n("6cb7"),r=n("b12f"),a=n("0f99"),o=a.detectSourceFormat,s=n("93d0"),l=s.SERIES_LAYOUT_BY_COLUMN;i.extend({type:"dataset",defaultOption:{seriesLayoutBy:l,sourceHeader:null,dimensions:null,source:null},optionUpdated:function(){o(this)}}),r.extend({type:"dataset"})},"04f6":function(e,t){var n=32,i=7;function r(e){var t=0;while(e>=n)t|=1&e,e>>=1;return e+t}function a(e,t,n,i){var r=t+1;if(r===n)return 1;if(i(e[r++],e[t])<0){while(r<n&&i(e[r],e[r-1])<0)r++;o(e,t,r)}else while(r<n&&i(e[r],e[r-1])>=0)r++;return r-t}function o(e,t,n){n--;while(t<n){var i=e[t];e[t++]=e[n],e[n--]=i}}function s(e,t,n,i,r){for(i===t&&i++;i<n;i++){var a,o=e[i],s=t,l=i;while(s<l)a=s+l>>>1,r(o,e[a])<0?l=a:s=a+1;var u=i-s;switch(u){case 3:e[s+3]=e[s+2];case 2:e[s+2]=e[s+1];case 1:e[s+1]=e[s];break;default:while(u>0)e[s+u]=e[s+u-1],u--}e[s]=o}}function l(e,t,n,i,r,a){var o=0,s=0,l=1;if(a(e,t[n+r])>0){s=i-r;while(l<s&&a(e,t[n+r+l])>0)o=l,l=1+(l<<1),l<=0&&(l=s);l>s&&(l=s),o+=r,l+=r}else{s=r+1;while(l<s&&a(e,t[n+r-l])<=0)o=l,l=1+(l<<1),l<=0&&(l=s);l>s&&(l=s);var u=o;o=r-l,l=r-u}o++;while(o<l){var c=o+(l-o>>>1);a(e,t[n+c])>0?o=c+1:l=c}return l}function u(e,t,n,i,r,a){var o=0,s=0,l=1;if(a(e,t[n+r])<0){s=r+1;while(l<s&&a(e,t[n+r-l])<0)o=l,l=1+(l<<1),l<=0&&(l=s);l>s&&(l=s);var u=o;o=r-l,l=r-u}else{s=i-r;while(l<s&&a(e,t[n+r+l])>=0)o=l,l=1+(l<<1),l<=0&&(l=s);l>s&&(l=s),o+=r,l+=r}o++;while(o<l){var c=o+(l-o>>>1);a(e,t[n+c])<0?l=c:o=c+1}return l}function c(e,t){var n,r,a=i,o=0,s=0;o=e.length;var c=[];function d(e,t){n[s]=e,r[s]=t,s+=1}function f(){while(s>1){var e=s-2;if(e>=1&&r[e-1]<=r[e]+r[e+1]||e>=2&&r[e-2]<=r[e]+r[e-1])r[e-1]<r[e+1]&&e--;else if(r[e]>r[e+1])break;p(e)}}function h(){while(s>1){var e=s-2;e>0&&r[e-1]<r[e+1]&&e--,p(e)}}function p(i){var a=n[i],o=r[i],c=n[i+1],d=r[i+1];r[i]=o+d,i===s-3&&(n[i+1]=n[i+2],r[i+1]=r[i+2]),s--;var f=u(e[c],e,a,o,0,t);a+=f,o-=f,0!==o&&(d=l(e[a+o-1],e,c,d,d-1,t),0!==d&&(o<=d?g(a,o,c,d):m(a,o,c,d)))}function g(n,r,o,s){var d=0;for(d=0;d<r;d++)c[d]=e[n+d];var f=0,h=o,p=n;if(e[p++]=e[h++],0!==--s)if(1!==r){var g,m,v,y=a;while(1){g=0,m=0,v=!1;do{if(t(e[h],c[f])<0){if(e[p++]=e[h++],m++,g=0,0===--s){v=!0;break}}else if(e[p++]=c[f++],g++,m=0,1===--r){v=!0;break}}while((g|m)<y);if(v)break;do{if(g=u(e[h],c,f,r,0,t),0!==g){for(d=0;d<g;d++)e[p+d]=c[f+d];if(p+=g,f+=g,r-=g,r<=1){v=!0;break}}if(e[p++]=e[h++],0===--s){v=!0;break}if(m=l(c[f],e,h,s,0,t),0!==m){for(d=0;d<m;d++)e[p+d]=e[h+d];if(p+=m,h+=m,s-=m,0===s){v=!0;break}}if(e[p++]=c[f++],1===--r){v=!0;break}y--}while(g>=i||m>=i);if(v)break;y<0&&(y=0),y+=2}if(a=y,a<1&&(a=1),1===r){for(d=0;d<s;d++)e[p+d]=e[h+d];e[p+s]=c[f]}else{if(0===r)throw new Error;for(d=0;d<r;d++)e[p+d]=c[f+d]}}else{for(d=0;d<s;d++)e[p+d]=e[h+d];e[p+s]=c[f]}else for(d=0;d<r;d++)e[p+d]=c[f+d]}function m(n,r,o,s){var d=0;for(d=0;d<s;d++)c[d]=e[o+d];var f=n+r-1,h=s-1,p=o+s-1,g=0,m=0;if(e[p--]=e[f--],0!==--r)if(1!==s){var v=a;while(1){var y=0,_=0,b=!1;do{if(t(c[h],e[f])<0){if(e[p--]=e[f--],y++,_=0,0===--r){b=!0;break}}else if(e[p--]=c[h--],_++,y=0,1===--s){b=!0;break}}while((y|_)<v);if(b)break;do{if(y=r-u(c[h],e,n,r,r-1,t),0!==y){for(p-=y,f-=y,r-=y,m=p+1,g=f+1,d=y-1;d>=0;d--)e[m+d]=e[g+d];if(0===r){b=!0;break}}if(e[p--]=c[h--],1===--s){b=!0;break}if(_=s-l(e[f],c,0,s,s-1,t),0!==_){for(p-=_,h-=_,s-=_,m=p+1,g=h+1,d=0;d<_;d++)e[m+d]=c[g+d];if(s<=1){b=!0;break}}if(e[p--]=e[f--],0===--r){b=!0;break}v--}while(y>=i||_>=i);if(b)break;v<0&&(v=0),v+=2}if(a=v,a<1&&(a=1),1===s){for(p-=r,f-=r,m=p+1,g=f+1,d=r-1;d>=0;d--)e[m+d]=e[g+d];e[p]=c[h]}else{if(0===s)throw new Error;for(g=p-(s-1),d=0;d<s;d++)e[g+d]=c[d]}}else{for(p-=r,f-=r,m=p+1,g=f+1,d=r-1;d>=0;d--)e[m+d]=e[g+d];e[p]=c[h]}else for(g=p-(s-1),d=0;d<s;d++)e[g+d]=c[d]}n=[],r=[],this.mergeRuns=f,this.forceMergeRuns=h,this.pushRun=d}function d(e,t,i,o){i||(i=0),o||(o=e.length);var l=o-i;if(!(l<2)){var u=0;if(l<n)return u=a(e,i,o,t),void s(e,i,o,i+u,t);var d=new c(e,t),f=r(l);do{if(u=a(e,i,o,t),u<f){var h=l;h>f&&(h=f),s(e,i,i+h,i+u,t),u=h}d.pushRun(i,u),d.mergeRuns(),l-=u,i+=u}while(0!==l);d.forceMergeRuns()}}e.exports=d},"0655":function(e,t,n){var i=n("8728"),r=1e-8;function a(e,t){return Math.abs(e-t)<r}function o(e,t,n){var r=0,o=e[0];if(!o)return!1;for(var s=1;s<e.length;s++){var l=e[s];r+=i(o[0],o[1],l[0],l[1],t,n),o=l}var u=e[0];return a(o[0],u[0])&&a(o[1],u[1])||(r+=i(o[0],o[1],u[0],u[1],t,n)),0!==r}t.contain=o},"06ad":function(e,t,n){var i=n("4436"),r=n("41ef"),a=n("6d8b"),o=a.isArrayLike,s=Array.prototype.slice;function l(e,t){return e[t]}function u(e,t,n){e[t]=n}function c(e,t,n){return(t-e)*n+e}function d(e,t,n){return n>.5?t:e}function f(e,t,n,i,r){var a=e.length;if(1==r)for(var o=0;o<a;o++)i[o]=c(e[o],t[o],n);else{var s=a&&e[0].length;for(o=0;o<a;o++)for(var l=0;l<s;l++)i[o][l]=c(e[o][l],t[o][l],n)}}function h(e,t,n){var i=e.length,r=t.length;if(i!==r){var a=i>r;if(a)e.length=r;else for(var o=i;o<r;o++)e.push(1===n?t[o]:s.call(t[o]))}var l=e[0]&&e[0].length;for(o=0;o<e.length;o++)if(1===n)isNaN(e[o])&&(e[o]=t[o]);else for(var u=0;u<l;u++)isNaN(e[o][u])&&(e[o][u]=t[o][u])}function p(e,t,n){if(e===t)return!0;var i=e.length;if(i!==t.length)return!1;if(1===n){for(var r=0;r<i;r++)if(e[r]!==t[r])return!1}else{var a=e[0].length;for(r=0;r<i;r++)for(var o=0;o<a;o++)if(e[r][o]!==t[r][o])return!1}return!0}function g(e,t,n,i,r,a,o,s,l){var u=e.length;if(1==l)for(var c=0;c<u;c++)s[c]=m(e[c],t[c],n[c],i[c],r,a,o);else{var d=e[0].length;for(c=0;c<u;c++)for(var f=0;f<d;f++)s[c][f]=m(e[c][f],t[c][f],n[c][f],i[c][f],r,a,o)}}function m(e,t,n,i,r,a,o){var s=.5*(n-e),l=.5*(i-t);return(2*(t-n)+s+l)*o+(-3*(t-n)-2*s-l)*a+s*r+t}function v(e){if(o(e)){var t=e.length;if(o(e[0])){for(var n=[],i=0;i<t;i++)n.push(s.call(e[i]));return n}return s.call(e)}return e}function y(e){return e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.floor(e[2]),"rgba("+e.join(",")+")"}function _(e){var t=e[e.length-1].value;return o(t&&t[0])?2:1}function b(e,t,n,a,s,l){var u=e._getter,v=e._setter,b="spline"===t,E=a.length;if(E){var T,S=a[0].value,w=o(S),A=!1,I=!1,x=w?_(a):0;a.sort(function(e,t){return e.time-t.time}),T=a[E-1].time;for(var R=[],C=[],D=a[0].value,k=!0,M=0;M<E;M++){R.push(a[M].time/T);var L=a[M].value;if(w&&p(L,D,x)||!w&&L===D||(k=!1),D=L,"string"==typeof L){var P=r.parse(L);P?(L=P,A=!0):I=!0}C.push(L)}if(l||!k){var N=C[E-1];for(M=0;M<E-1;M++)w?h(C[M],N,x):!isNaN(C[M])||isNaN(N)||I||A||(C[M]=N);w&&h(u(e._target,s),N,x);var O,F,U,B,G,j,V=0,H=0;if(A)var K=[0,0,0,0];var z=function(e,t){var n;if(t<0)n=0;else if(t<H){for(O=Math.min(V+1,E-1),n=O;n>=0;n--)if(R[n]<=t)break;n=Math.min(n,E-2)}else{for(n=V;n<E;n++)if(R[n]>t)break;n=Math.min(n-1,E-2)}V=n,H=t;var i=R[n+1]-R[n];if(0!==i)if(F=(t-R[n])/i,b)if(B=C[n],U=C[0===n?n:n-1],G=C[n>E-2?E-1:n+1],j=C[n>E-3?E-1:n+2],w)g(U,B,G,j,F,F*F,F*F*F,u(e,s),x);else{if(A)r=g(U,B,G,j,F,F*F,F*F*F,K,1),r=y(K);else{if(I)return d(B,G,F);r=m(U,B,G,j,F,F*F,F*F*F)}v(e,s,r)}else if(w)f(C[n],C[n+1],F,u(e,s),x);else{var r;if(A)f(C[n],C[n+1],F,K,1),r=y(K);else{if(I)return d(C[n],C[n+1],F);r=c(C[n],C[n+1],F)}v(e,s,r)}},Z=new i({target:e._target,life:T,loop:e._loop,delay:e._delay,onframe:z,ondestroy:n});return t&&"spline"!==t&&(Z.easing=t),Z}}}var E=function(e,t,n,i){this._tracks={},this._target=e,this._loop=t||!1,this._getter=n||l,this._setter=i||u,this._clipCount=0,this._delay=0,this._doneList=[],this._onframeList=[],this._clipList=[]};E.prototype={when:function(e,t){var n=this._tracks;for(var i in t)if(t.hasOwnProperty(i)){if(!n[i]){n[i]=[];var r=this._getter(this._target,i);if(null==r)continue;0!==e&&n[i].push({time:0,value:v(r)})}n[i].push({time:e,value:t[i]})}return this},during:function(e){return this._onframeList.push(e),this},pause:function(){for(var e=0;e<this._clipList.length;e++)this._clipList[e].pause();this._paused=!0},resume:function(){for(var e=0;e<this._clipList.length;e++)this._clipList[e].resume();this._paused=!1},isPaused:function(){return!!this._paused},_doneCallback:function(){this._tracks={},this._clipList.length=0;for(var e=this._doneList,t=e.length,n=0;n<t;n++)e[n].call(this)},start:function(e,t){var n,i=this,r=0,a=function(){r--,r||i._doneCallback()};for(var o in this._tracks)if(this._tracks.hasOwnProperty(o)){var s=b(this,e,a,this._tracks[o],o,t);s&&(this._clipList.push(s),r++,this.animation&&this.animation.addClip(s),n=s)}if(n){var l=n.onframe;n.onframe=function(e,t){l(e,t);for(var n=0;n<i._onframeList.length;n++)i._onframeList[n](e,t)}}return r||this._doneCallback(),this},stop:function(e){for(var t=this._clipList,n=this.animation,i=0;i<t.length;i++){var r=t[i];e&&r.onframe(this._target,1),n&&n.removeClip(r)}t.length=0},delay:function(e){return this._delay=e,this},done:function(e){return e&&this._doneList.push(e),this},getClips:function(){return this._clipList}};var T=E;e.exports=T},"07d7":function(e,t,n){var i=n("6d8b"),r=n("41ef"),a=n("607d"),o=n("22d1"),s=n("eda2"),l=i.each,u=s.toCamelCase,c=["","-webkit-","-moz-","-o-"],d="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;";function f(e){var t="cubic-bezier(0.23, 1, 0.32, 1)",n="left "+e+"s "+t+",top "+e+"s "+t;return i.map(c,function(e){return e+"transition:"+n}).join(";")}function h(e){var t=[],n=e.get("fontSize"),i=e.getTextColor();return i&&t.push("color:"+i),t.push("font:"+e.getFont()),n&&t.push("line-height:"+Math.round(3*n/2)+"px"),l(["decoration","align"],function(n){var i=e.get(n);i&&t.push("text-"+n+":"+i)}),t.join(";")}function p(e){var t=[],n=e.get("transitionDuration"),i=e.get("backgroundColor"),a=e.getModel("textStyle"),c=e.get("padding");return n&&t.push(f(n)),i&&(o.canvasSupported?t.push("background-Color:"+i):(t.push("background-Color:#"+r.toHex(i)),t.push("filter:alpha(opacity=70)"))),l(["width","color","radius"],function(n){var i="border-"+n,r=u(i),a=e.get(r);null!=a&&t.push(i+":"+a+("color"===n?"":"px"))}),t.push(h(a)),null!=c&&t.push("padding:"+s.normalizeCssArray(c).join("px ")+"px"),t.join(";")+";"}function g(e,t){if(o.wxa)return null;var n=document.createElement("div"),i=this._zr=t.getZr();this.el=n,this._x=t.getWidth()/2,this._y=t.getHeight()/2,e.appendChild(n),this._container=e,this._show=!1,this._hideTimeout;var r=this;n.onmouseenter=function(){r._enterable&&(clearTimeout(r._hideTimeout),r._show=!0),r._inContent=!0},n.onmousemove=function(t){if(t=t||window.event,!r._enterable){var n=i.handler;a.normalizeEvent(e,t,!0),n.dispatch("mousemove",t)}},n.onmouseleave=function(){r._enterable&&r._show&&r.hideLater(r._hideDelay),r._inContent=!1}}g.prototype={constructor:g,_enterable:!0,update:function(){var e=this._container,t=e.currentStyle||document.defaultView.getComputedStyle(e),n=e.style;"absolute"!==n.position&&"absolute"!==t.position&&(n.position="relative")},show:function(e){clearTimeout(this._hideTimeout);var t=this.el;t.style.cssText=d+p(e)+";left:"+this._x+"px;top:"+this._y+"px;"+(e.get("extraCssText")||""),t.style.display=t.innerHTML?"block":"none",this._show=!0},setContent:function(e){this.el.innerHTML=null==e?"":e},setEnterable:function(e){this._enterable=e},getSize:function(){var e=this.el;return[e.clientWidth,e.clientHeight]},moveTo:function(e,t){var n,i=this._zr;i&&i.painter&&(n=i.painter.getViewportRootOffset())&&(e+=n.offsetLeft,t+=n.offsetTop);var r=this.el.style;r.left=e+"px",r.top=t+"px",this._x=e,this._y=t},hide:function(){this.el.style.display="none",this._show=!1},hideLater:function(e){!this._show||this._inContent&&this._enterable||(e?(this._hideDelay=e,this._show=!1,this._hideTimeout=setTimeout(i.bind(this.hide,this),e)):this.hide())},isShow:function(){return this._show}};var m=g;e.exports=m},"097d":function(e,t,n){"use strict";var i=n("5ca1"),r=n("8378"),a=n("7726"),o=n("ebd6"),s=n("bcaa");i(i.P+i.R,"Promise",{finally:function(e){var t=o(this,r.Promise||a.Promise),n="function"==typeof e;return this.then(n?function(n){return s(t,e()).then(function(){return n})}:e,n?function(n){return s(t,e()).then(function(){throw n})}:e)}})},"0b44":function(e,t,n){var i=n("607d"),r=function(){this._track=[]};function a(e){var t=e[1][0]-e[0][0],n=e[1][1]-e[0][1];return Math.sqrt(t*t+n*n)}function o(e){return[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2]}r.prototype={constructor:r,recognize:function(e,t,n){return this._doTrack(e,t,n),this._recognize(e)},clear:function(){return this._track.length=0,this},_doTrack:function(e,t,n){var r=e.touches;if(r){for(var a={points:[],touches:[],target:t,event:e},o=0,s=r.length;o<s;o++){var l=r[o],u=i.clientToLocal(n,l,{});a.points.push([u.zrX,u.zrY]),a.touches.push(l)}this._track.push(a)}},_recognize:function(e){for(var t in s)if(s.hasOwnProperty(t)){var n=s[t](this._track,e);if(n)return n}}};var s={pinch:function(e,t){var n=e.length;if(n){var i=(e[n-1]||{}).points,r=(e[n-2]||{}).points||i;if(r&&r.length>1&&i&&i.length>1){var s=a(i)/a(r);!isFinite(s)&&(s=1),t.pinchScale=s;var l=o(i);return t.pinchX=l[0],t.pinchY=l[1],{type:"pinch",target:e[0].target,event:t}}}}},l=r;e.exports=l},"0bfb":function(e,t,n){"use strict";var i=n("cb7c");e.exports=function(){var e=i(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},"0cde":function(e,t,n){var i=n("1687"),r=n("401b"),a=i.identity,o=5e-5;function s(e){return e>o||e<-o}var l=function(e){e=e||{},e.position||(this.position=[0,0]),null==e.rotation&&(this.rotation=0),e.scale||(this.scale=[1,1]),this.origin=this.origin||null},u=l.prototype;u.transform=null,u.needLocalTransform=function(){return s(this.rotation)||s(this.position[0])||s(this.position[1])||s(this.scale[0]-1)||s(this.scale[1]-1)},u.updateTransform=function(){var e=this.parent,t=e&&e.transform,n=this.needLocalTransform(),r=this.transform;n||t?(r=r||i.create(),n?this.getLocalTransform(r):a(r),t&&(n?i.mul(r,e.transform,r):i.copy(r,e.transform)),this.transform=r,this.invTransform=this.invTransform||i.create(),i.invert(this.invTransform,r)):r&&a(r)},u.getLocalTransform=function(e){return l.getLocalTransform(this,e)},u.setTransform=function(e){var t=this.transform,n=e.dpr||1;t?e.setTransform(n*t[0],n*t[1],n*t[2],n*t[3],n*t[4],n*t[5]):e.setTransform(n,0,0,n,0,0)},u.restoreTransform=function(e){var t=e.dpr||1;e.setTransform(t,0,0,t,0,0)};var c=[];u.decomposeTransform=function(){if(this.transform){var e=this.parent,t=this.transform;e&&e.transform&&(i.mul(c,e.invTransform,t),t=c);var n=t[0]*t[0]+t[1]*t[1],r=t[2]*t[2]+t[3]*t[3],a=this.position,o=this.scale;s(n-1)&&(n=Math.sqrt(n)),s(r-1)&&(r=Math.sqrt(r)),t[0]<0&&(n=-n),t[3]<0&&(r=-r),a[0]=t[4],a[1]=t[5],o[0]=n,o[1]=r,this.rotation=Math.atan2(-t[1]/r,t[0]/n)}},u.getGlobalScale=function(){var e=this.transform;if(!e)return[1,1];var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]),n=Math.sqrt(e[2]*e[2]+e[3]*e[3]);return e[0]<0&&(t=-t),e[3]<0&&(n=-n),[t,n]},u.transformCoordToLocal=function(e,t){var n=[e,t],i=this.invTransform;return i&&r.applyTransform(n,n,i),n},u.transformCoordToGlobal=function(e,t){var n=[e,t],i=this.transform;return i&&r.applyTransform(n,n,i),n},l.getLocalTransform=function(e,t){t=t||[],a(t);var n=e.origin,r=e.scale||[1,1],o=e.rotation||0,s=e.position||[0,0];return n&&(t[4]-=n[0],t[5]-=n[1]),i.scale(t,t,r),o&&i.rotate(t,t,o),n&&(t[4]+=n[0],t[5]+=n[1]),t[4]+=s[0],t[5]+=s[1],t};var d=l;e.exports=d},"0d58":function(e,t,n){var i=n("ce10"),r=n("e11e");e.exports=Object.keys||function(e){return i(e,r)}},"0da8":function(e,t,n){var i=n("19eb"),r=n("9850"),a=n("6d8b"),o=n("5e76");function s(e){i.call(this,e)}s.prototype={constructor:s,type:"image",brush:function(e,t){var n=this.style,i=n.image;n.bind(e,this,t);var r=this._image=o.createOrUpdateImage(i,this._image,this,this.onload);if(r&&o.isImageReady(r)){var a=n.x||0,s=n.y||0,l=n.width,u=n.height,c=r.width/r.height;if(null==l&&null!=u?l=u*c:null==u&&null!=l?u=l/c:null==l&&null==u&&(l=r.width,u=r.height),this.setTransform(e),n.sWidth&&n.sHeight){var d=n.sx||0,f=n.sy||0;e.drawImage(r,d,f,n.sWidth,n.sHeight,a,s,l,u)}else if(n.sx&&n.sy){d=n.sx,f=n.sy;var h=l-d,p=u-f;e.drawImage(r,d,f,h,p,a,s,l,u)}else e.drawImage(r,a,s,l,u);null!=n.text&&(this.restoreTransform(e),this.drawRectText(e,this.getBoundingRect()))}},getBoundingRect:function(){var e=this.style;return this._rect||(this._rect=new r(e.x||0,e.y||0,e.width||0,e.height||0)),this._rect}},a.inherits(s,i);var l=s;e.exports=l},"0f99":function(e,t,n){var i=n("4e08"),r=(i.__DEV__,n("e0d3")),a=r.makeInner,o=r.getDataItemValue,s=n("8b7f"),l=s.getCoordSysDefineBySeries,u=n("6d8b"),c=u.createHashMap,d=u.each,f=u.map,h=u.isArray,p=u.isString,g=u.isObject,m=u.isTypedArray,v=u.isArrayLike,y=u.extend,_=(u.assert,n("ec6f")),b=n("93d0"),E=b.SOURCE_FORMAT_ORIGINAL,T=b.SOURCE_FORMAT_ARRAY_ROWS,S=b.SOURCE_FORMAT_OBJECT_ROWS,w=b.SOURCE_FORMAT_KEYED_COLUMNS,A=b.SOURCE_FORMAT_UNKNOWN,I=b.SOURCE_FORMAT_TYPED_ARRAY,x=b.SERIES_LAYOUT_BY_ROW,R=a();function C(e){var t=e.option.source,n=A;if(m(t))n=I;else if(h(t))for(var i=0,r=t.length;i<r;i++){var a=t[i];if(null!=a){if(h(a)){n=T;break}if(g(a)){n=S;break}}}else if(g(t)){for(var o in t)if(t.hasOwnProperty(o)&&v(t[o])){n=w;break}}else if(null!=t)throw new Error("Invalid data");R(e).sourceFormat=n}function D(e){return R(e).source}function k(e){R(e).datasetMap=c()}function M(e){var t=e.option,n=t.data,i=m(n)?I:E,r=!1,a=t.seriesLayoutBy,o=t.sourceHeader,s=t.dimensions,l=U(e);if(l){var u=l.option;n=u.source,i=R(l).sourceFormat,r=!0,a=a||u.seriesLayoutBy,null==o&&(o=u.sourceHeader),s=s||u.dimensions}var c=L(n,i,a,o,s),d=t.encode;!d&&l&&(d=F(e,l,n,i,a,c)),R(e).source=new _({data:n,fromDataset:r,seriesLayoutBy:a,sourceFormat:i,dimensionsDefine:c.dimensionsDefine,startIndex:c.startIndex,dimensionsDetectCount:c.dimensionsDetectCount,encodeDefine:d})}function L(e,t,n,i,r){if(!e)return{dimensionsDefine:P(r)};var a,s,l,u;if(t===T)"auto"===i||null==i?N(function(e){null!=e&&"-"!==e&&(p(e)?null==s&&(s=1):s=0)},n,e,10):s=i?1:0,r||1!==s||(r=[],N(function(e,t){r[t]=null!=e?e:""},n,e)),a=r?r.length:n===x?e.length:e[0]?e[0].length:null;else if(t===S)r||(r=O(e),l=!0);else if(t===w)r||(r=[],l=!0,d(e,function(e,t){r.push(t)}));else if(t===E){var c=o(e[0]);a=h(c)&&c.length||1}return l&&d(r,function(e,t){"name"===(g(e)?e.name:e)&&(u=t)}),{startIndex:s,dimensionsDefine:P(r),dimensionsDetectCount:a,potentialNameDimIndex:u}}function P(e){if(e){var t=c();return f(e,function(e,n){if(e=y({},g(e)?e:{name:e}),null==e.name)return e;e.name+="",null==e.displayName&&(e.displayName=e.name);var i=t.get(e.name);return i?e.name+="-"+i.count++:t.set(e.name,{count:1}),e})}}function N(e,t,n,i){if(null==i&&(i=1/0),t===x)for(var r=0;r<n.length&&r<i;r++)e(n[r]?n[r][0]:null,r);else{var a=n[0]||[];for(r=0;r<a.length&&r<i;r++)e(a[r],r)}}function O(e){var t,n=0;while(n<e.length&&!(t=e[n++]));if(t){var i=[];return d(t,function(e,t){i.push(t)}),i}}function F(e,t,n,i,r,a){var o=l(e),s={},u=[],f=[],h=e.subType,p=c(["pie","map","funnel"]),g=c(["line","bar","pictorialBar","scatter","effectScatter","candlestick","boxplot"]);if(o&&null!=g.get(h)){var m=e.ecModel,v=R(m).datasetMap,y=t.uid+"_"+r,_=v.get(y)||v.set(y,{categoryWayDim:1,valueWayDim:0});d(o.coordSysDims,function(e){if(null==o.firstCategoryDimIndex){var t=_.valueWayDim++;s[e]=t,f.push(t)}else if(o.categoryAxisMap.get(e))s[e]=0,u.push(0);else{t=_.categoryWayDim++;s[e]=t,f.push(t)}})}else if(null!=p.get(h)){for(var b,E=0;E<5&&null==b;E++)G(n,i,r,a.dimensionsDefine,a.startIndex,E)||(b=E);if(null!=b){s.value=b;var T=a.potentialNameDimIndex||Math.max(b-1,0);f.push(T),u.push(T)}}return u.length&&(s.itemName=u),f.length&&(s.seriesName=f),s}function U(e){var t=e.option,n=t.data;if(!n)return e.ecModel.getComponent("dataset",t.datasetIndex||0)}function B(e,t){return G(e.data,e.sourceFormat,e.seriesLayoutBy,e.dimensionsDefine,e.startIndex,t)}function G(e,t,n,i,r,a){var s,l,u=5;if(m(e))return!1;if(i&&(l=i[a],l=g(l)?l.name:l),t===T)if(n===x){for(var c=e[a],d=0;d<(c||[]).length&&d<u;d++)if(null!=(s=_(c[r+d])))return s}else for(d=0;d<e.length&&d<u;d++){var f=e[r+d];if(f&&null!=(s=_(f[a])))return s}else if(t===S){if(!l)return;for(d=0;d<e.length&&d<u;d++){var v=e[d];if(v&&null!=(s=_(v[l])))return s}}else if(t===w){if(!l)return;c=e[l];if(!c||m(c))return!1;for(d=0;d<c.length&&d<u;d++)if(null!=(s=_(c[d])))return s}else if(t===E)for(d=0;d<e.length&&d<u;d++){v=e[d];var y=o(v);if(!h(y))return!1;if(null!=(s=_(y[a])))return s}function _(e){return(null==e||!isFinite(e)||""===e)&&(!(!p(e)||"-"===e)||void 0)}return!1}t.detectSourceFormat=C,t.getSource=D,t.resetSourceDefaulter=k,t.prepareSource=M,t.guessOrdinal=B},"11e9":function(e,t,n){var i=n("52a7"),r=n("4630"),a=n("6821"),o=n("6a99"),s=n("69a8"),l=n("c69a"),u=Object.getOwnPropertyDescriptor;t.f=n("9e1e")?u:function(e,t){if(e=a(e),t=o(t,!0),l)try{return u(e,t)}catch(e){}if(s(e,t))return r(!i.f.call(e,t),e[t])}},"128e":function(e,t,n){"use strict";function i(){return"boolean"===typeof __RX_PLAYER_DEBUG_MODE__&&__RX_PLAYER_DEBUG_MODE__}function r(e){return null===e||void 0===e}class a{constructor(){this._listeners={}}addEventListener(e,t,n){const i=this._listeners[e];Array.isArray(i)?i.push(t):this._listeners[e]=[t],void 0!==n&&n.register(()=>{this.removeEventListener(e,t)})}removeEventListener(e,t){if(r(e))return void(this._listeners={});const n=this._listeners[e];if(!Array.isArray(n))return;if(r(t))return void delete this._listeners[e];const i=n.indexOf(t);-1!==i&&n.splice(i,1),0===n.length&&delete this._listeners[e]}trigger(e,t){const n=this._listeners[e];Array.isArray(n)&&n.slice().forEach(e=>{try{e(t)}catch(e){0,console.error("RxPlayer: EventEmitter error",e instanceof Error?e:null)}})}}var o=n("45c1"),s=n("d708"),l="function"===typeof queueMicrotask?queueMicrotask:function(e){Promise.resolve().then(e,()=>e())};function u(){if(!s["a"]&&!r(o["a"].WebKitSourceBuffer)&&void 0===o["a"].WebKitSourceBuffer.prototype.addEventListener){const e=o["a"].WebKitSourceBuffer,t=e.prototype;for(const n in a.prototype)a.prototype.hasOwnProperty(n)&&(t[n]=a.prototype[n]);t._listeners=[],t._emitUpdate=function(e,t){l(()=>{this.trigger(e,t),this.updating=!1,this.trigger("updateend")})},t.appendBuffer=function(e){if(this.updating)throw new Error("updating");this.trigger("updatestart"),this.updating=!0;try{this.append(e)}catch(e){return void this._emitUpdate("error",e)}this._emitUpdate("update")}}}let c=!1,d=!1,f=!1,h=!1,p=!1,g=!1,m=!1,v=!1,y=!1,_=!1,b=!1,E=!1,T=!1,S=!1,w=!1;(function(){var e,t,n;s["a"]||("undefined"!==typeof o["a"].MSInputMethodContext&&"undefined"!==typeof document.documentMode?(d=!0,f=!0):"Microsoft Internet Explorer"===navigator.appName||"Netscape"===navigator.appName&&/(Trident|Edge)\//.test(navigator.userAgent)?f=!0:-1!==navigator.userAgent.toLowerCase().indexOf("edg/")?c=!0:-1!==navigator.userAgent.toLowerCase().indexOf("firefox")?h=!0:"string"===typeof navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)?g=!0:(Object.prototype.toString.call(o["a"].HTMLElement).indexOf("Constructor")>=0||"[object SafariRemoteNotification]"===(null===(t=null===(e=o["a"].safari)||void 0===e?void 0:e.pushNotification)||void 0===t?void 0:t.toString())||/Safari\/(\d+)/.test(navigator.userAgent)&&/Version\/(\d+)/.test(navigator.userAgent)&&-1!==(null===(n=navigator.vendor)||void 0===n?void 0:n.indexOf("Apple"))&&!/Chrome\/(\d+)/.test(navigator.userAgent)&&!/Chromium\/(\d+)/.test(navigator.userAgent))&&(p=!0),/SamsungBrowser/.test(navigator.userAgent)&&(m=!0),-1!==navigator.userAgent.indexOf("PlayStation 4")?T=!0:-1!==navigator.userAgent.indexOf("PlayStation 5")?S=!0:/Tizen/.test(navigator.userAgent)?v=!0:/[Ww]eb[O0]S/.test(navigator.userAgent)?(y=!0,/[Ww]eb[O0]S.TV-2022/.test(navigator.userAgent)||/[Cc]hr[o0]me\/87/.test(navigator.userAgent)?b=!0:(/[Ww]eb[O0]S.TV-2021/.test(navigator.userAgent)||/[Cc]hr[o0]me\/79/.test(navigator.userAgent))&&(_=!0)):/[Pp]anasonic/.test(navigator.userAgent)?E=!0:-1!==navigator.userAgent.indexOf("Xbox")&&(w=!0))})();const A=S;var I=A;function x(e){return void 0===e||e.indexOf("widevine")<0}const R={DEFAULT_REQUEST_TIMEOUT:3e4,DEFAULT_CONNECTION_TIMEOUT:15e3,DEFAULT_TEXT_TRACK_MODE:"native",DEFAULT_ENABLE_FAST_SWITCHING:!0,DELTA_POSITION_AFTER_RELOAD:{bitrateSwitch:-.1,trackSwitch:{audio:0,video:0,other:0}},DEFAULT_CODEC_SWITCHING_BEHAVIOR:"continue",DEFAULT_AUTO_PLAY:!1,DEFAULT_WANTED_BUFFER_AHEAD:30,DEFAULT_MAX_BUFFER_AHEAD:1/0,DEFAULT_MAX_BUFFER_BEHIND:1/0,DEFAULT_MAX_VIDEO_BUFFER_SIZE:1/0,MAXIMUM_MAX_BUFFER_AHEAD:{text:18e3},MINIMUM_MAX_BUFFER_AHEAD:{text:120},MAXIMUM_MAX_BUFFER_BEHIND:{text:18e3},DEFAULT_BASE_BANDWIDTH:0,INACTIVITY_DELAY:6e4,DEFAULT_THROTTLE_VIDEO_BITRATE_WHEN_HIDDEN:!1,DEFAULT_VIDEO_RESOLUTION_LIMIT:"none",DEFAULT_LIVE_GAP:{DEFAULT:10,LOW_LATENCY:3.5},BUFFER_DISCONTINUITY_THRESHOLD:.2,BITRATE_REBUFFERING_RATIO:1.5,DEFAULT_MAX_MANIFEST_REQUEST_RETRY:4,DEFAULT_CDN_DOWNGRADE_TIME:60,DEFAULT_MAX_REQUESTS_RETRY_ON_ERROR:4,INITIAL_BACKOFF_DELAY_BASE:{REGULAR:200,LOW_LATENCY:50},MAX_BACKOFF_DELAY_BASE:{REGULAR:3e3,LOW_LATENCY:1e3},SAMPLING_INTERVAL_MEDIASOURCE:1e3,SAMPLING_INTERVAL_LOW_LATENCY:500,SAMPLING_INTERVAL_NO_MEDIASOURCE:500,ABR_ENTER_BUFFER_BASED_ALGO:10,ABR_EXIT_BUFFER_BASED_ALGO:5,ABR_MINIMUM_TOTAL_BYTES:15e4,ABR_MINIMUM_CHUNK_SIZE:16e3,ABR_STARVATION_FACTOR:{DEFAULT:.72,LOW_LATENCY:.72},ABR_REGULAR_FACTOR:{DEFAULT:.72,LOW_LATENCY:.72},ABR_STARVATION_GAP:{DEFAULT:5,LOW_LATENCY:5},OUT_OF_STARVATION_GAP:{DEFAULT:7,LOW_LATENCY:7},ABR_STARVATION_DURATION_DELTA:.1,ABR_FAST_EMA:2,ABR_SLOW_EMA:10,RESUME_GAP_AFTER_SEEKING:{DEFAULT:1.5,LOW_LATENCY:.5},RESUME_GAP_AFTER_NOT_ENOUGH_DATA:{DEFAULT:.5,LOW_LATENCY:.5},RESUME_GAP_AFTER_BUFFERING:{DEFAULT:5,LOW_LATENCY:.5},REBUFFERING_GAP:{DEFAULT:.5,LOW_LATENCY:.2},MINIMUM_BUFFER_AMOUNT_BEFORE_FREEZING:2,UNFREEZING_SEEK_DELAY:6e3,FREEZING_STALLED_DELAY:600,UNFREEZING_DELTA_POSITION:.001,SEGMENT_SYNCHRONIZATION_DELAY:1500,MISSING_DATA_TRIGGER_SYNC_DELAY:.1,MAX_TIME_MISSING_FROM_COMPLETE_SEGMENT:.15,MAX_MANIFEST_BUFFERED_START_END_DIFFERENCE:.4,MAX_MANIFEST_BUFFERED_DURATION_DIFFERENCE:.3,MINIMUM_SEGMENT_SIZE:.001,APPEND_WINDOW_SECURITIES:{START:.2,END:.1},MAXIMUM_HTML_TEXT_TRACK_UPDATE_INTERVAL:50,TEXT_TRACK_SIZE_CHECKS_INTERVAL:250,BUFFER_PADDING:{audio:1,video:3,other:1},SEGMENT_PRIORITIES_STEPS:[2,4,8,12,18,25],MAX_HIGH_PRIORITY_LEVEL:1,MIN_CANCELABLE_PRIORITY:3,EME_DEFAULT_VIDEO_CODECS:['video/mp4;codecs="avc1.4d401e"','video/mp4;codecs="avc1.42e01e"','video/webm;codecs="vp8"'],EME_DEFAULT_AUDIO_CODECS:['audio/mp4;codecs="mp4a.40.2"',"audio/webm;codecs=opus"],EME_DEFAULT_WIDEVINE_ROBUSTNESSES:["HW_SECURE_ALL","HW_SECURE_DECODE","HW_SECURE_CRYPTO","SW_SECURE_DECODE","SW_SECURE_CRYPTO"],EME_DEFAULT_PLAYREADY_RECOMMENDATION_ROBUSTNESSES:["3000","2000"],EME_KEY_SYSTEMS:{clearkey:["webkit-org.w3.clearkey","org.w3.clearkey"],widevine:["com.widevine.alpha"],playready:["com.microsoft.playready.recommendation","com.microsoft.playready","com.chromecast.playready","com.youtube.playready"],fairplay:["com.apple.fps.1_0"]},MAX_CONSECUTIVE_MANIFEST_PARSING_IN_UNSAFE_MODE:10,MIN_MANIFEST_PARSING_TIME_TO_ENTER_UNSAFE_MODE:200,MIN_DASH_S_ELEMENTS_TO_PARSE_UNSAFELY:300,OUT_OF_SYNC_MANIFEST_REFRESH_DELAY:3e3,FAILED_PARTIAL_UPDATE_MANIFEST_REFRESH_DELAY:3e3,DASH_FALLBACK_LIFETIME_WHEN_MINIMUM_UPDATE_PERIOD_EQUAL_0:3,EME_DEFAULT_MAX_SIMULTANEOUS_MEDIA_KEY_SESSIONS:15,EME_MAX_STORED_PERSISTENT_SESSION_INFORMATION:1e3,EME_WAITING_DELAY_LOADED_SESSION_EMPTY_KEYSTATUSES:100,FORCED_ENDED_THRESHOLD:8e-4,ADAP_REP_SWITCH_BUFFER_PADDINGS:{video:{before:5,after:5},audio:{before:2,after:2.5},text:{before:0,after:0}},SOURCE_BUFFER_FLUSHING_INTERVAL:500,CONTENT_REPLACEMENT_PADDING:1.2,CACHE_LOAD_DURATION_THRESHOLDS:{video:50,audio:10},STREAM_EVENT_EMITTER_POLL_INTERVAL:250,DEFAULT_MAXIMUM_TIME_ROUNDING_ERROR:.001,BUFFERED_HISTORY_RETENTION_TIME:6e4,BUFFERED_HISTORY_MAXIMUM_ENTRIES:200,MIN_BUFFER_AHEAD:5,UPTO_CURRENT_POSITION_CLEANUP:5,DEFAULT_VIDEO_REPRESENTATIONS_SWITCHING_MODE:"seamless",DEFAULT_AUDIO_REPRESENTATIONS_SWITCHING_MODE:"seamless",DEFAULT_VIDEO_TRACK_SWITCHING_MODE:"reload",DEFAULT_AUDIO_TRACK_SWITCHING_MODE:"seamless"};var C=R;function D(e,...t){if(null===e||void 0===e)throw new TypeError("Cannot convert undefined or null to object");const n=Object(e);for(let i=0;i<t.length;i++){const e=t[i];for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])}return n}var k="function"===typeof Object.assign?Object.assign:D;function M(e){return null!==e&&void 0!==e&&!Array.isArray(e)&&"object"===typeof e}function L(e,...t){if(0===t.length)return e;const n=t.shift();if(M(e)&&M(n))for(const i in n)if(M(n[i])){let t=e[i];void 0===t&&(t={},e[i]=t),L(t,n[i])}else k(e,{[i]:n[i]});return L(e,...t)}class P{constructor(){this._config=C}update(e){const t=L(this._config,e);this._config=t}getCurrent(){return this._config}}const N=new P;var O=N,F=function(){};const U="NONE";class B extends a{constructor(){super(),this.error=F,this.warn=F,this.info=F,this.debug=F,this._levels={NONE:0,ERROR:1,WARNING:2,INFO:3,DEBUG:4},this._currentLevel=U}setLevel(e,t){let n;const i=this._levels[e];"number"===typeof i?(n=i,this._currentLevel=e):(n=0,this._currentLevel="NONE"),void 0===t?(this.error=n>=this._levels.ERROR?console.error.bind(console):F,this.warn=n>=this._levels.WARNING?console.warn.bind(console):F,this.info=n>=this._levels.INFO?console.info.bind(console):F,this.debug=n>=this._levels.DEBUG?console.log.bind(console):F):(this.error=n>=this._levels.ERROR?(...e)=>t("ERROR",e):F,this.warn=n>=this._levels.WARNING?(...e)=>t("WARNING",e):F,this.info=n>=this._levels.INFO?(...e)=>t("INFO",e):F,this.debug=n>=this._levels.DEBUG?(...e)=>t("DEBUG",e):F),this.trigger("onLogLevelChange",this._currentLevel)}getLevel(){return this._currentLevel}hasLevel(e){return this._levels[e]>=this._levels[this._currentLevel]}}const G=new B;var j=G;const V=1/60;function H(e,t){return Math.abs(e-t)<V}function K(e,t){const n=Math.min(e.start,t.start),i=Math.max(e.end,t.end);return{start:n,end:i}}function z(e){for(let t=0;t<e.length;t++){const n=e[t];n.start===n.end&&e.splice(t--,1)}return e}function Z(e){for(let t=1;t<e.length;t++){const n=e[t-1],i=e[t];if($(n,i)){const r=K(n,i);e.splice(--t,2,r)}}return e}function q(e,t){return e.end<=t.start}function Y({start:e,end:t},n){return e<=n&&n<t}function W(e,t){return Y(e,t.start)||e.start<t.end&&t.end<e.end||Y(t,e.start)}function $(e,t){return H(t.start,e.end)||H(t.end,e.start)}function X(e){const t=[];for(let n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}function Q(e,t){for(let n=e.length-1;n>=0;n--){const i=e.start(n);if(t>=i){const r=e.end(n);if(t<r)return{start:i,end:r}}}return null}function J(e,t){for(let n=e.length-1;n>=0;n--){const i=e[n].start;if(t>=i){const i=e[n].end;if(t<i)return e[n]}}return null}function ee(e,t){const n=e.length;for(let i=0;i<n;i++){const n=e.start(i);if(t<n)return n-t}return 1/0}function te(e,t){let n=null;const i=[];for(let r=0;r<e.length;r++){const a=e[r].start,o=e[r].end;t<a||t>=o?i.push({start:a,end:o}):n={start:a,end:o}}return{outerRanges:i,innerRange:n}}function ne(e,t){const n=Q(e,t);return null!==n?n.end-t:1/0}function ie(e,t){const n=J(e,t);return null!==n?n.end-t:1/0}function re(e,t){if(t.start===t.end)return e;let n=t,i=0;for(;i<e.length;i++){const t=e[i],r=W(n,t),a=$(n,t);if(r||a)n=K(n,t),e.splice(i--,1);else if(0===i){if(q(n,e[0]))break}else if(q(e[i-1],n)&&q(n,t))break}return e.splice(i,0,n),Z(z(e))}function ae(e,t){const n=[];for(let i=0;i<t.length;i++)W(e,t[i])&&n.push(t[i]);return n}function oe(e,t){const n=[];for(let i=0;i<e.length;i++){const r=e[i],a=ae(r,t);if(a.length>0)for(let e=0;e<a.length;e++){const t=a[e];n.push({start:Math.max(r.start,t.start),end:Math.min(r.end,t.end)})}}return n}function se(e,t){const n=[];for(let i=0;i<e.length;i++){const r=e[i],a=[],o=ae(r,t);if(o.length>0)for(let e=0;e<o.length;e++){const t=o[e];a.push({start:Math.max(r.start,t.start),end:Math.min(r.end,t.end)})}if(0===a.length)n.push(r);else{let e=r.start;for(let t=0;t<a.length;t++)a[t].start>e&&n.push({start:e,end:a[t].start}),e=a[t].end;e<r.end&&n.push({start:e,end:r.end})}}return n}function le(e,t,n){if("function"===typeof Array.prototype.findIndex)return e.findIndex(t,n);const i=e.length>>>0;for(let r=0;r<i;r++)if(t.call(n,e[r],r,e))return r;return-1}class ue{constructor(e,t){this._value=e,this._listeners=[],this._isFinished=!1,this._onFinishCbs=[],void 0!==t&&(this._deregisterCancellation=t.register(()=>this.finish()))}getValue(){return this._value}setValue(e){if(this._isFinished)return void 0;if(this._value=e,0===this._listeners.length)return;const t=this._listeners.slice();for(const n of t)try{n.hasBeenCleared||n.trigger(e,n.complete)}catch(e){}}setValueIfChanged(e){e!==this._value&&this.setValue(e)}onUpdate(e,t){const n=()=>{if(void 0!==(null===t||void 0===t?void 0:t.clearSignal)&&t.clearSignal.deregister(n),i.hasBeenCleared)return;i.hasBeenCleared=!0;const e=this._listeners.indexOf(i);e>=0&&this._listeners.splice(e,1)},i={trigger:e,complete:n,hasBeenCleared:!1};this._listeners.push(i),!0===(null===t||void 0===t?void 0:t.emitCurrentValue)&&e(this._value,n),this._isFinished||i.hasBeenCleared?n():void 0!==(null===t||void 0===t?void 0:t.clearSignal)&&t.clearSignal.register(n)}waitUntilDefined(e,t){this.onUpdate((t,n)=>{void 0!==t&&(n(),e(this._value))},{clearSignal:null===t||void 0===t?void 0:t.clearSignal,emitCurrentValue:!0})}_onFinished(e,t){if(t.isCancelled())return F;const n=()=>{const e=le(this._onFinishCbs,e=>e.trigger===i);e>=0&&(this._onFinishCbs[e].hasBeenCleared=!0,this._onFinishCbs.splice(e,1))},i=()=>{n(),e()},r=t.register(n);return this._onFinishCbs.push({trigger:i,hasBeenCleared:!1}),r}finish(){void 0!==this._deregisterCancellation&&this._deregisterCancellation(),this._isFinished=!0;const e=this._listeners.slice();for(const t of e)try{t.hasBeenCleared||(t.complete(),t.hasBeenCleared=!0)}catch(e){}if(this._listeners.length=0,this._onFinishCbs.length>0){const e=this._onFinishCbs.slice();for(const t of e)try{t.hasBeenCleared||(t.trigger(),t.hasBeenCleared=!0)}catch(e){}this._onFinishCbs.length=0}}}function ce(e,t,n){const i=new ue(t(e.getValue()),n);return e.onUpdate(function(e){i.setValue(t(e))},{clearSignal:n}),e._onFinished(()=>{i.finish()},n),i}var de=ue;class fe extends Error{constructor(e){super(e),Object.setPrototypeOf(this,fe.prototype),this.name="AssertionError"}}function he(e,t){0}function pe(e,t,n="object"){he(!r(e),`${n} should be an object`);for(const i in t)t.hasOwnProperty(i)&&he(typeof e[i]===t[i],`${n} should have property ${i} as a ${t[i]}`)}function ge(e){throw new fe("Unreachable path taken")}class me{constructor(){const[e,t]=_e();this._isUsed=!1,this._trigger=e,this.signal=new ve(t)}isUsed(){return this._isUsed}linkToSignal(e){const t=e.register(()=>{this.cancel()});return this.signal.register(t),t}cancel(e){if(this._isUsed)return;this._isUsed=!0;const t=null!==e&&void 0!==e?e:new ye;this._trigger(t)}static isCancellationError(e){return e instanceof ye}}class ve{constructor(e){this._isCancelled=!1,this.cancellationError=null,this._listeners=[],e(e=>{this.cancellationError=e,this._isCancelled=!0;while(this._listeners.length>0)try{const t=this._listeners.pop();null===t||void 0===t||t(e)}catch(e){j.error("Error while calling clean up listener",e instanceof Error?e.toString():"Unknown error")}})}isCancelled(){return this._isCancelled}register(e){return this._isCancelled?(he(null!==this.cancellationError),e(this.cancellationError),F):(this._listeners.push(e),()=>this.deregister(e))}deregister(e){for(let t=this._listeners.length-1;t>=0;t--)this._listeners[t]===e&&this._listeners.splice(t,1)}}class ye extends Error{constructor(){const e="This task was cancelled.";super(e),Object.setPrototypeOf(this,ye.prototype),this.name="CancellationError"}}function _e(){let e=F;return[function(t){e(t)},function(t){e=t}]}const be=new de(0);const Ee="undefined"!==typeof performance?()=>performance.now()+be.getValue():()=>Date.now()+be.getValue();var Te=Ee;function Se(e){const t=e.map(t=>Math.log(t/e[0])),n=t.map(e=>e-t[0]+1),i=(n[n.length-1]-1)/(2*e.length+10),r=1/i;return e.map((e,t)=>a(t));function a(t){if(0===t)return 0;const o=Math.min(Math.max(1,t),e.length-1);return e[o]===e[o-1]?a(t-1):r*(i+(e[o]*n[o-1]-e[o-1]*n[o])/(e[o]-e[o-1]))+4}}const we=6e3,Ae=15e3,Ie=3e3,xe=1e3,Re=9e3;class Ce{constructor(e){this._levelsMap=Se(e).map(e=>{return e+4}),this._bitrates=e,this._lastUnsuitableQualityTimestamp=void 0,this._blockRaiseDelay=we,j.debug("ABR: Steps for buffer based chooser.",this._levelsMap.map((t,n)=>`bufferLevel: ${t}, bitrate: ${e[n]}`).join(" ,"))}onAddedSegment(e){const t=this._levelsMap,n=this._bitrates,{bufferGap:i,currentBitrate:a,currentScore:o,speed:s}=e;if(r(a))return void(this._currentEstimate=n[0]);let l,u=-1;for(let r=0;r<n.length;r++){const e=n[r];if(e===a)u=r;else if(e>a)break}if(u<0||n.length!==t.length)return j.info("ABR: Current Bitrate not found in the calculated levels"),void(this._currentEstimate=n[0]);void 0!==o&&(l=0===s?o.score:o.score/s);const c=isFinite(i)?i:0,d=Te();if(c<t[u]||void 0!==l&&l<1&&1===(null===o||void 0===o?void 0:o.confidenceLevel)){const e=void 0===this._lastUnsuitableQualityTimestamp?-1:d-this._lastUnsuitableQualityTimestamp;if(e<this._blockRaiseDelay+Re){const e=this._blockRaiseDelay+Ie;this._blockRaiseDelay=Math.min(e,Ae),j.debug("ABR: Incrementing blocking raise in BufferBasedChooser due to unstable quality",this._blockRaiseDelay)}else{const e=this._blockRaiseDelay-xe;this._blockRaiseDelay=Math.max(we,e),j.debug("ABR: Lowering quality in BufferBasedChooser",this._blockRaiseDelay)}this._lastUnsuitableQualityTimestamp=d;const i=le(n,e=>e===a);for(let r=i-1;r>=0;r--)if(c>=t[r])return void(this._currentEstimate=n[r]);return void(this._currentEstimate=n[0])}if(void 0!==this._lastUnsuitableQualityTimestamp&&d-this._lastUnsuitableQualityTimestamp<this._blockRaiseDelay||void 0===l||l<1.15||1!==(null===o||void 0===o?void 0:o.confidenceLevel))return void(this._currentEstimate=a);const f=t[u],h=(()=>{for(let e=u+1;e<t.length;e++)if(t[e]>f)return e})();if(void 0!==h){const e=t[h];if(i>=e)return j.debug("ABR: Raising quality in BufferBasedChooser",n[h]),void(this._currentEstimate=n[h])}this._currentEstimate=a}getLastEstimate(){return this._currentEstimate}}function De(e,t,n){if("function"===typeof Array.prototype.find)return e.find(t,n);const i=e.length>>>0;for(let r=0;r<i;r++){const i=e[r];if(t.call(n,i,r,e))return i}}class ke{constructor(e){this._alpha=Math.exp(Math.log(.5)/e),this._lastEstimate=0,this._totalWeight=0}addSample(e,t){const n=Math.pow(this._alpha,e),i=t*(1-n)+n*this._lastEstimate;isNaN(i)||(this._lastEstimate=i,this._totalWeight+=e)}getEstimate(){const e=1-Math.pow(this._alpha,this._totalWeight);return this._lastEstimate/e}}function Me(e,t){let n=-1;for(let o=0;o<e.length;o++){const{segment:i}=e[o].content;if(i.duration<=0)continue;const r=i.time+i.duration;if(!i.complete&&o===e.length-1&&t-i.time>-1.2){n=o;break}if(r>t&&t-i.time>-1.2){n=o;break}}if(n<0)return[];const i=e[n],r=i.content.segment.time,a=[i];for(let o=n+1;o<e.length;o++){if(e[o].content.segment.time!==r)break;a.push(e[o])}return a}function Le(e){if(e.progress.length<5)return;const t=new ke(2),{progress:n}=e;for(let i=1;i<n.length;i++){const e=n[i].size-n[i-1].size,r=n[i].timestamp-n[i-1].timestamp,a=8*e/(r/1e3);t.addSample(r/1e3,a)}return t.getEstimate()}function Pe(e,t){const n=8*(e.totalSize-e.size);return Math.max(n/t,0)}function Ne(e,t,n,i,a){if(i)return;const{bufferGap:o,speed:s,position:l}=t,u=isFinite(o)?o:0,c=l.getWanted()+u,d=Me(e,c);if(1!==d.length)return;const f=d[0],h=Te();let p=1.5*f.content.segment.duration;if(p=Math.min(p,3e3),p=Math.max(p,12e3),h-f.requestTimestamp<p)return;const g=f.progress.length>0?f.progress[f.progress.length-1]:void 0,m=Le(f);if(void 0!==g&&void 0!==m){const e=Pe(g,m);if((h-g.timestamp)/1e3<=e){const t=e-u/s;if(t>2500)return m}}if(!f.content.segment.complete)return;const v=f.content.segment.duration,y=(h-f.requestTimestamp)/1e3,_=y<=(1.5*v+2)/s;if(r(n)||_)return;const b=v/y,E=n.bitrate*Math.min(.7,b);return void 0===a||E<a?E:void 0}function Oe(e,t,n){if(n)return!0;const i=isFinite(e.bufferGap)?e.bufferGap:0,r=e.position.getWanted()+i,a=De(t,({content:e})=>e.segment.duration>0&&e.segment.time+e.segment.duration>r);if(void 0===a)return!0;const o=Te(),s=a.progress.length>0?a.progress[a.progress.length-1]:void 0,l=Le(a);if(void 0===s||void 0===l)return!0;const u=Pe(s,l);if((o-s.timestamp)/1e3>1.2*u)return!0;const c=u-i/e.speed;return c>-1.5}class Fe{constructor(e,t){const{ABR_STARVATION_GAP:n,OUT_OF_STARVATION_GAP:i,ABR_STARVATION_FACTOR:r,ABR_REGULAR_FACTOR:a}=O.getCurrent();this._initialBitrate=e,this._inStarvationMode=!1,this._lowLatencyMode=t,this._config=t?{starvationGap:n.LOW_LATENCY,outOfStarvationGap:i.LOW_LATENCY,starvationBitrateFactor:r.LOW_LATENCY,regularBitrateFactor:a.LOW_LATENCY}:{starvationGap:n.DEFAULT,outOfStarvationGap:i.DEFAULT,starvationBitrateFactor:r.DEFAULT,regularBitrateFactor:a.DEFAULT}}getBandwidthEstimate(e,t,n,i,a){let o,s;const l=this._config,{bufferGap:u,position:c,duration:d}=e,f=isFinite(u)?u:0,{ABR_STARVATION_DURATION_DELTA:h}=O.getCurrent();return isNaN(d)||f+c.getWanted()<d-h?!this._inStarvationMode&&f<=l.starvationGap?(j.info("ABR: enter starvation mode."),this._inStarvationMode=!0):this._inStarvationMode&&f>=l.outOfStarvationGap&&(j.info("ABR: exit starvation mode."),this._inStarvationMode=!1):this._inStarvationMode&&(j.info("ABR: exit starvation mode."),this._inStarvationMode=!1),this._inStarvationMode&&(s=Ne(i,e,n,this._lowLatencyMode,a),void 0!==s&&(j.info("ABR: starvation mode emergency estimate:",s),t.reset(),o=r(n)?s:Math.min(s,n.bitrate))),r(o)&&(s=t.getEstimate(),o=void 0!==s?s*(this._inStarvationMode?l.starvationBitrateFactor:l.regularBitrateFactor):void 0!==a?a*(this._inStarvationMode?l.starvationBitrateFactor:l.regularBitrateFactor):this._initialBitrate),e.speed>1&&(o/=e.speed),{bandwidthEstimate:s,bitrateChosen:o}}isUrgent(e,t,n,i){return null===t||!(e>=t.bitrate)&&Oe(i,n,this._lowLatencyMode)}}class Ue{constructor(e,t){this._scoreCalculator=e,this._lastAbrEstimate=t,this._consecutiveWrongGuesses=0,this._blockGuessesUntil=0,this._lastMaintanableBitrate=null}getGuess(e,t,n,i,r){const{bufferGap:a,speed:o}=t,s=this._lastAbrEstimate.representation;if(null===s)return null;if(i>s.bitrate)return 2===this._lastAbrEstimate.algorithmType&&(null!==this._lastAbrEstimate.representation&&(this._lastMaintanableBitrate=this._lastAbrEstimate.representation.bitrate),this._consecutiveWrongGuesses=0),null;const l=this._scoreCalculator.getEstimate(n);if(2!==this._lastAbrEstimate.algorithmType){if(void 0===l)return null;if(this._canGuessHigher(a,o,l)){const t=Be(e,n);if(null!==t)return t}return null}if(this._isLastGuessValidated(s,i,l)&&(j.debug("ABR: Guessed Representation validated",s.bitrate),this._lastMaintanableBitrate=s.bitrate,this._consecutiveWrongGuesses=0),n.id!==s.id)return s;const u=this._shouldStopGuess(n,l,a,r);if(u)return this._consecutiveWrongGuesses++,this._blockGuessesUntil=Te()+Math.min(15e3*this._consecutiveWrongGuesses,12e4),Ge(e,n);if(void 0===l)return n;if(this._canGuessHigher(a,o,l)){const t=Be(e,n);if(null!==t)return t}return n}_canGuessHigher(e,t,{score:n,confidenceLevel:i}){return isFinite(e)&&e>=2.5&&Te()>this._blockGuessesUntil&&1===i&&n/t>1.01}_shouldStopGuess(e,t,n,i){if(void 0!==t&&t.score<1.01)return!0;if((void 0===t||t.score<1.2)&&n<.6)return!0;const r=i.filter(t=>{return t.content.representation.id===e.id}),a=Te();for(const o of r){const t=a-o.requestTimestamp;if(o.content.segment.isInit){if(t>1e3)return!0}else{if(t>1e3*o.content.segment.duration+200)return!0;{const t=Le(o);if(void 0!==t&&t<.8*e.bitrate)return!0}}}return!1}_isLastGuessValidated(e,t,n){return void 0!==n&&1===n.confidenceLevel&&n.score>1.5||t>=e.bitrate&&(null===this._lastMaintanableBitrate||this._lastMaintanableBitrate<e.bitrate)}}function Be(e,t){const n=e.length;let i=le(e,({id:e})=>e===t.id);if(i<0)return j.error("ABR: Current Representation not found."),null;while(++i<n)if(e[i].bitrate>t.bitrate)return e[i];return null}function Ge(e,t){let n=le(e,({id:e})=>e===t.id);if(n<0)return j.error("ABR: Current Representation not found."),null;while(--n>=0)if(e[n].bitrate<t.bitrate)return e[n];return null}class je{constructor(){const{ABR_FAST_EMA:e,ABR_SLOW_EMA:t}=O.getCurrent();this._fastEWMA=new ke(e),this._slowEWMA=new ke(t),this._bytesSampled=0}addSample(e,t){const{ABR_MINIMUM_CHUNK_SIZE:n}=O.getCurrent();if(t<n)return;const i=8e3*t/e,r=e/1e3;this._bytesSampled+=t,this._fastEWMA.addSample(r,i),this._slowEWMA.addSample(r,i)}getEstimate(){const{ABR_MINIMUM_TOTAL_BYTES:e}=O.getCurrent();if(!(this._bytesSampled<e))return Math.min(this._fastEWMA.getEstimate(),this._slowEWMA.getEstimate())}reset(){const{ABR_FAST_EMA:e,ABR_SLOW_EMA:t}=O.getCurrent();this._fastEWMA=new ke(e),this._slowEWMA=new ke(t),this._bytesSampled=0}}function Ve(e,t){if(0===e.length)return[];e.sort((e,t)=>e.bitrate-t.bitrate);const n=e[0].bitrate,i=Math.max(t,n),r=le(e,e=>e.bitrate>i);return-1===r?e:e.slice(0,r)}function He(e,t){if(void 0===t.width||void 0===t.height)return e;const n=t.width*t.pixelRatio,i=t.height*t.pixelRatio,r=e.slice().sort((e,t)=>{var n,i;return(null!==(n=e.width)&&void 0!==n?n:0)-(null!==(i=t.width)&&void 0!==i?i:0)}),a=De(r,e=>"number"===typeof e.width&&e.width>=n&&"number"===typeof e.height&&e.height>=i);if(void 0===a)return e;const o="number"===typeof a.width?a.width:0;return e.filter(e=>"number"!==typeof e.width||e.width<=o)}class Ke{constructor(){this.bandwidth=void 0,this.representation=null,this.algorithmType=3}update(e,t,n){this.representation=e,this.bandwidth=t,this.algorithmType=n}}function ze(e){return Object.keys(e).map(t=>e[t])}var Ze="function"===typeof Object.values?Object.values:ze;class qe{constructor(){this._currentRequests={}}add(e){const{id:t,requestTimestamp:n,content:i}=e;this._currentRequests[t]={requestTimestamp:n,progress:[],content:i}}addProgress(e){const t=this._currentRequests[e.id];r(t)?j.warn("ABR: progress for a request not added"):t.progress.push(e)}remove(e){r(this._currentRequests[e])&&j.warn("ABR: can't remove unknown request"),delete this._currentRequests[e]}getRequests(){return Ze(this._currentRequests).filter(e=>!r(e)).sort((e,t)=>e.content.segment.time-t.content.segment.time)}}class Ye{constructor(){this._currentRepresentationData=null,this._lastRepresentationWithGoodScore=null}addSample(e,t,n){const i=n/t,r=this._currentRepresentationData;let a;null!==r&&r.representation.id===e.id?(a=r.ewma,r.ewma.addSample(t,i),r.loadedDuration+=n,r.loadedSegments++):(a=new ke(5),a.addSample(t,i),this._currentRepresentationData={representation:e,ewma:a,loadedDuration:n,loadedSegments:0}),a.getEstimate()>1&&this._lastRepresentationWithGoodScore!==e&&(j.debug("ABR: New last stable representation",e.bitrate),this._lastRepresentationWithGoodScore=e)}getEstimate(e){if(null===this._currentRepresentationData||this._currentRepresentationData.representation.id!==e.id)return;const{ewma:t,loadedSegments:n,loadedDuration:i}=this._currentRepresentationData,r=t.getEstimate(),a=n>=5&&i>=10?1:0;return{score:r,confidenceLevel:a}}getLastStableRepresentation(){return this._lastRepresentationWithGoodScore}}function We(e,t){const n=le(e,e=>e.bitrate>t);return-1===n?e[e.length-1]:0===n?e[0]:e[n-1]}const $e=new de(void 0);$e.finish();const Xe=new de(1/0);function Qe(e){const t={},{initialBitrates:n,throttlers:i,lowLatencyMode:a}=e;return function(e,t,r,s,l){var u,c,d;const{type:f}=e.adaptation,h=o(f),p=null!==(u=n[f])&&void 0!==u?u:0,g={limitResolution:null!==(c=i.limitResolution[f])&&void 0!==c?c:$e,throttleBitrate:null!==(d=i.throttleBitrate[f])&&void 0!==d?d:Xe};return Je({bandwidthEstimator:h,context:e,currentRepresentation:t,filters:g,initialBitrate:p,playbackObserver:s,representations:r,lowLatencyMode:a},l)};function o(e){const n=t[e];if(r(n)){j.debug("ABR: Creating new BandwidthEstimator for ",e);const n=new je;return t[e]=n,n}return n}}function Je({bandwidthEstimator:e,context:t,currentRepresentation:n,filters:i,initialBitrate:r,lowLatencyMode:a,playbackObserver:o,representations:s},l){const u=new Ye,c=new Fe(null!==r&&void 0!==r?r:0,a),d=new qe;let f=F;const h={metrics:y,requestBegin:_,requestProgress:b,requestEnd:E,addedSegment(e){f(e)}};let p=new me;p.linkToSignal(l);const g=m(s.getValue(),p.signal);return s.onUpdate(v,{clearSignal:l}),{estimates:g,callbacks:h};function m(r,s){if(r.length<=1)return new de({bitrate:void 0,representation:r[0],urgent:!0,knownStableBitrate:void 0});let l=!1;const h=r.sort((e,t)=>e.bitrate-t.bitrate),p=new Ce(h.map(e=>e.bitrate)),g=new Ke,m=new Ue(u,g);let v=o.getReference().getValue();const y=new de(b());return o.listen(e=>{v=e,_()},{includeLastObservation:!1,clearSignal:s}),f=function(e){if(null===v)return;const{position:t,speed:n}=v,i=e.buffered,r=ie(i,t.getWanted()),{representation:a}=e.content,o=u.getEstimate(a),s=a.bitrate,l={bufferGap:r,currentBitrate:s,currentScore:o,speed:n};p.onAddedSegment(l),_()},s.register(()=>{f=F}),i.throttleBitrate.onUpdate(_,{clearSignal:s}),i.limitResolution.onUpdate(_,{clearSignal:s}),y;function _(){y.setValue(b())}function b(){const{bufferGap:r,position:o,maximumPosition:s}=v,f=i.limitResolution.getValue(),y=i.throttleBitrate.getValue(),_=n.getValue(),b=et(h,f,y),E=d.getRequests(),{bandwidthEstimate:T,bitrateChosen:S}=c.getBandwidthEstimate(v,e,_,E,g.bandwidth),w=u.getLastStableRepresentation(),A=null===w?void 0:w.bitrate/(v.speed>0?v.speed:1),{ABR_ENTER_BUFFER_BASED_ALGO:I,ABR_EXIT_BUFFER_BASED_ALGO:x}=O.getCurrent();l&&r<=x?l=!1:!l&&isFinite(r)&&r>=I&&(l=!0);const R=We(b,S),C=p.getLastEstimate();let D=R.bitrate,k=null;l&&void 0!==C&&C>D&&(k=We(b,C),D=k.bitrate);let M=null;return a&&null!==_&&t.manifest.isDynamic&&s-o.getWanted()<40&&(M=m.getGuess(h,v,_,D,E)),null!==M&&M.bitrate>D?(j.debug("ABR: Choosing representation with guess-based estimation.",M.bitrate,M.id),g.update(M,T,2),{bitrate:T,representation:M,urgent:null===_||M.bitrate<_.bitrate,knownStableBitrate:A}):null!==k?(j.debug("ABR: Choosing representation with buffer-based estimation.",k.bitrate,k.id),g.update(k,T,0),{bitrate:T,representation:k,urgent:c.isUrgent(k.bitrate,_,E,v),knownStableBitrate:A}):(j.debug("ABR: Choosing representation with bandwidth estimation.",R.bitrate,R.id),g.update(R,T,1),{bitrate:T,representation:R,urgent:c.isUrgent(R.bitrate,_,E,v),knownStableBitrate:A})}}function v(){const e=s.getValue();p.cancel(),p=new me,p.linkToSignal(l);const t=m(e,p.signal);t.onUpdate(function(e){g.setValue(e)},{clearSignal:p.signal,emitCurrentValue:!0})}function y(t){const{requestDuration:n,segmentDuration:i,size:r,content:a}=t;if(e.addSample(n,r),!a.segment.isInit){const{segment:e,representation:t}=a;if(void 0===i&&!e.complete)return;const r=null!==i&&void 0!==i?i:e.duration;u.addSample(t,n/1e3,r)}}function _(e){d.add(e)}function b(e){d.addProgress(e)}function E(e){d.remove(e.id)}}function et(e,t,n){let i=e;return void 0!==n&&n<1/0&&(i=Ve(i,n)),void 0!==t&&(i=He(i,t)),i}Xe.finish();var tt=Qe;class nt extends Error{constructor(e,t,n){let i;switch(n){case"TIMEOUT":i="The request timed out";break;case"ERROR_EVENT":i="An error prevented the request to be performed successfully";break;case"PARSE_ERROR":i="An error happened while formatting the response data";break;case"ERROR_HTTP_CODE":i="An HTTP status code indicating failure was received: "+String(t);break}super(i),Object.setPrototypeOf(this,nt.prototype),this.name="RequestError",this.url=e,this.status=t,this.type=n}serialize(){return{url:this.url,status:this.status,type:this.type}}}const it={TIMEOUT:"TIMEOUT",ERROR_EVENT:"ERROR_EVENT",ERROR_HTTP_CODE:"ERROR_HTTP_CODE",PARSE_ERROR:"PARSE_ERROR"},rt=it,at={NETWORK_ERROR:"NETWORK_ERROR",MEDIA_ERROR:"MEDIA_ERROR",ENCRYPTED_MEDIA_ERROR:"ENCRYPTED_MEDIA_ERROR",OTHER_ERROR:"OTHER_ERROR"},ot={PIPELINE_LOAD_ERROR:"PIPELINE_LOAD_ERROR",PIPELINE_PARSE_ERROR:"PIPELINE_PARSE_ERROR",INTEGRITY_ERROR:"INTEGRITY_ERROR",MANIFEST_PARSE_ERROR:"MANIFEST_PARSE_ERROR",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"MANIFEST_INCOMPATIBLE_CODECS_ERROR",MANIFEST_UPDATE_ERROR:"MANIFEST_UPDATE_ERROR",MANIFEST_UNSUPPORTED_ADAPTATION_TYPE:"MANIFEST_UNSUPPORTED_ADAPTATION_TYPE",MEDIA_STARTING_TIME_NOT_FOUND:"MEDIA_STARTING_TIME_NOT_FOUND",MEDIA_TIME_BEFORE_MANIFEST:"MEDIA_TIME_BEFORE_MANIFEST",MEDIA_TIME_AFTER_MANIFEST:"MEDIA_TIME_AFTER_MANIFEST",MEDIA_TIME_NOT_FOUND:"MEDIA_TIME_NOT_FOUND",NO_PLAYABLE_REPRESENTATION:"NO_PLAYABLE_REPRESENTATION",MEDIA_IS_ENCRYPTED_ERROR:"MEDIA_IS_ENCRYPTED_ERROR",CREATE_MEDIA_KEYS_ERROR:"CREATE_MEDIA_KEYS_ERROR",MEDIA_KEYS_ATTACHMENT_ERROR:"MEDIA_KEYS_ATTACHMENT_ERROR",KEY_ERROR:"KEY_ERROR",KEY_STATUS_CHANGE_ERROR:"KEY_STATUS_CHANGE_ERROR",KEY_UPDATE_ERROR:"KEY_UPDATE_ERROR",KEY_LOAD_ERROR:"KEY_LOAD_ERROR",KEY_LOAD_TIMEOUT:"KEY_LOAD_TIMEOUT",KEY_GENERATE_REQUEST_ERROR:"KEY_GENERATE_REQUEST_ERROR",INCOMPATIBLE_KEYSYSTEMS:"INCOMPATIBLE_KEYSYSTEMS",INVALID_ENCRYPTED_EVENT:"INVALID_ENCRYPTED_EVENT",INVALID_KEY_SYSTEM:"INVALID_KEY_SYSTEM",LICENSE_SERVER_CERTIFICATE_ERROR:"LICENSE_SERVER_CERTIFICATE_ERROR",MULTIPLE_SESSIONS_SAME_INIT_DATA:"MULTIPLE_SESSIONS_SAME_INIT_DATA",BUFFER_APPEND_ERROR:"BUFFER_APPEND_ERROR",BUFFER_FULL_ERROR:"BUFFER_FULL_ERROR",BUFFER_TYPE_UNKNOWN:"BUFFER_TYPE_UNKNOWN",MEDIA_ERR_BLOCKED_AUTOPLAY:"MEDIA_ERR_BLOCKED_AUTOPLAY",MEDIA_ERR_PLAY_NOT_ALLOWED:"MEDIA_ERR_PLAY_NOT_ALLOWED",MEDIA_ERR_NOT_LOADED_METADATA:"MEDIA_ERR_NOT_LOADED_METADATA",MEDIA_ERR_ABORTED:"MEDIA_ERR_ABORTED",MEDIA_ERR_NETWORK:"MEDIA_ERR_NETWORK",MEDIA_ERR_DECODE:"MEDIA_ERR_DECODE",MEDIA_ERR_SRC_NOT_SUPPORTED:"MEDIA_ERR_SRC_NOT_SUPPORTED",MEDIA_ERR_UNKNOWN:"MEDIA_ERR_UNKNOWN",MEDIA_SOURCE_NOT_SUPPORTED:"MEDIA_SOURCE_NOT_SUPPORTED",MEDIA_KEYS_NOT_SUPPORTED:"MEDIA_KEYS_NOT_SUPPORTED",DISCONTINUITY_ENCOUNTERED:"DISCONTINUITY_ENCOUNTERED",NONE:"NONE"};function st(e,t){return`${e}: ${t}`}class lt extends Error{constructor(e,t,n){super(st(e,t)),Object.setPrototypeOf(this,lt.prototype),this.name="EncryptedMediaError",this.type=at.ENCRYPTED_MEDIA_ERROR,this.code=e,this._originalMessage=t,this.fatal=!1,"string"===typeof(null===n||void 0===n?void 0:n.keyStatuses)&&(this.keyStatuses=n.keyStatuses)}serialize(){return{name:this.name,code:this.code,reason:this._originalMessage,keyStatuses:this.keyStatuses}}}class ut extends Error{constructor(e,t,n){super(st(e,t)),Object.setPrototypeOf(this,ut.prototype),this.name="MediaError",this.type=at.MEDIA_ERROR,this._originalMessage=t,this.code=e,this.fatal=!1,void 0!==(null===n||void 0===n?void 0:n.tracks)&&(null===n||void 0===n?void 0:n.tracks.length)>0&&(this.tracksInfo=n.tracks)}serialize(){return{name:this.name,code:this.code,reason:this._originalMessage,tracks:this.tracksInfo}}}class ct extends Error{constructor(e,t){super(st(e,t.message)),Object.setPrototypeOf(this,ct.prototype),this.name="NetworkError",this.type=at.NETWORK_ERROR,this.url=t.url,this.status=t.status,this.errorType=t.type,this._baseError=t,this.code=e,this.fatal=!1}isHttpError(e){return this.errorType===rt.ERROR_HTTP_CODE&&this.status===e}serialize(){return{name:this.name,code:this.code,baseError:this._baseError.serialize()}}}class dt extends Error{constructor(e,t){super(st(e,t)),Object.setPrototypeOf(this,dt.prototype),this.name="OtherError",this.type=at.OTHER_ERROR,this.code=e,this.fatal=!1,this._originalMessage=t}serialize(){return{name:this.name,code:this.code,reason:this._originalMessage}}}function ft(e){return(e instanceof lt||e instanceof ut||e instanceof dt||e instanceof ct)&&Object.keys(at).indexOf(e.type)>=0}function ht(e,{defaultCode:t,defaultReason:n}){if(ft(e))return e;const i=e instanceof Error?e.toString():n;return new dt(t,i)}function pt(){let e="",t=-1;return function(){return t++,t>=Number.MAX_SAFE_INTEGER&&(e+="0",t=0),e+String(t)}}function gt(e,t,n){if("function"===typeof Array.prototype.includes)return e.includes(t,n);const i=e.length>>>0;if(0===i)return!1;const r=0|n;let a=r>=0?Math.min(r,i-1):Math.max(i+r,0);const o=(e,t)=>e===t||"number"===typeof e&&"number"===typeof t&&isNaN(e)&&isNaN(t);while(a<i){if(o(e[a],t))return!0;a++}return!1}const mt=[];function vt(e){gt(mt,e)||(console.warn(e),mt.push(e))}function yt(e,t){if(e.length!==t.length)return!1;if(e===t)return!0;for(let n=e.length-1;n>=0;n--)if(e[n]!==t[n])return!1;return!0}const _t=["audio","video","text"];function bt(e){var t,n;const i=e.timeBounds;if(null===i.timeshiftDepth)return null!==(t=i.minimumSafePosition)&&void 0!==t?t:0;const{maximumTimeData:r}=i;let a;if(i.maximumTimeData.isLinear){const e=Te()-r.time;a=r.maximumSafePosition+e/1e3}else a=r.maximumSafePosition;const o=a-i.timeshiftDepth;return Math.max(null!==(n=i.minimumSafePosition)&&void 0!==n?n:0,o)}function Et(e){const{maximumTimeData:t}=e.timeBounds;if(!e.isLive||void 0===t.livePosition)return;if(!t.isLinear)return t.livePosition;const n=Te()-t.time;return t.livePosition+n/1e3}function Tt(e){const{maximumTimeData:t}=e.timeBounds;if(!t.isLinear)return t.maximumSafePosition;const n=Te()-t.time;return t.maximumSafePosition+n/1e3}function St(e,t){if(void 0===t)return xt(e).filter(e=>{return!0===e.isSupported});const n=e.adaptations[t];return void 0===n?[]:n.filter(e=>{return!0===e.isSupported})}function wt(e,t){let n=null;for(let i=e.periods.length-1;i>=0;i--){const r=e.periods[i];if(It(r,t,n))return r;n=r}}function At(e,t){const n=t.end;if(void 0===n)return null;const i=De(e.periods,e=>{return void 0===e.end||n<e.end});return void 0===i?null:i}function It(e,t,n){return t>=e.start&&(void 0===e.end||t<e.end)||t===e.end&&(null===n||n.start>e.end)}function xt(e){const t=e.adaptations;return ze(t).reduce((e,t)=>r(t)?e:e.concat(t),[])}function Rt(e,t){var n,i;const r={language:null!==(n=e.language)&&void 0!==n?n:"",normalized:null!==(i=e.normalizedLanguage)&&void 0!==i?i:"",audioDescription:!0===e.isAudioDescription,id:e.id,representations:(t?e.representations.filter(e=>!0===e.isSupported&&!1!==e.decipherable):e.representations).map(kt),label:e.label};return!0===e.isDub&&(r.dub=!0),r}function Ct(e){var t,n;return{language:null!==(t=e.language)&&void 0!==t?t:"",normalized:null!==(n=e.normalizedLanguage)&&void 0!==n?n:"",closedCaption:!0===e.isClosedCaption,id:e.id,label:e.label,forced:e.isForcedSubtitles}}function Dt(e,t){const n=void 0!==e.trickModeTracks?e.trickModeTracks.map(e=>{const n=(t?e.representations.filter(e=>!0===e.isSupported&&!1!==e.decipherable):e.representations).map(Mt),i={id:e.id,representations:n,isTrickModeTrack:!0};return!0===e.isSignInterpreted&&(i.signInterpreted=!0),i}):void 0,i={id:e.id,representations:(t?e.representations.filter(e=>!0===e.isSupported&&!1!==e.decipherable):e.representations).map(Mt),label:e.label};return!0===e.isSignInterpreted&&(i.signInterpreted=!0),!0===e.isTrickModeTrack&&(i.isTrickModeTrack=!0),void 0!==n&&(i.trickModeTracks=n),i}function kt(e){const{id:t,bitrate:n,codecs:i,isSpatialAudio:r,isSupported:a,decipherable:o}=e;return{id:t,bitrate:n,codec:null===i||void 0===i?void 0:i[0],isSpatialAudio:r,isCodecSupported:a,decipherable:o}}function Mt(e){const{id:t,bitrate:n,frameRate:i,width:r,height:a,codecs:o,hdrInfo:s,isSupported:l,decipherable:u}=e;return{id:t,bitrate:n,frameRate:i,width:r,height:a,codec:null===o||void 0===o?void 0:o[0],hdrInfo:s,isCodecSupported:l,decipherable:u}}function Lt(e){switch(e.type){case"audio":return{type:"audio",track:Rt(e,!1)};case"video":return{type:"video",track:Dt(e,!1)};case"text":return{type:"text",track:Ct(e)}}}function Pt(e){return new Function(`return (${e}(arguments[0], arguments[1]))`)}function Nt(e){return"string"===typeof e&&e.length>0}const Ot={aa:"aar",ab:"abk",ae:"ave",af:"afr",ak:"aka",am:"amh",an:"arg",ar:"ara",as:"asm",av:"ava",ay:"aym",az:"aze",ba:"bak",be:"bel",bg:"bul",bi:"bis",bm:"bam",bn:"ben",bo:"bod",br:"bre",bs:"bos",ca:"cat",ce:"che",ch:"cha",co:"cos",cr:"cre",cs:"ces",cu:"chu",cv:"chv",cy:"cym",da:"dan",de:"deu",dv:"div",dz:"dzo",ee:"ewe",el:"ell",en:"eng",eo:"epo",es:"spa",et:"est",eu:"eus",fa:"fas",ff:"ful",fi:"fin",fj:"fij",fo:"fao",fr:"fra",fy:"fry",ga:"gle",gd:"gla",gl:"glg",gn:"grn",gu:"guj",gv:"glv",ha:"hau",he:"heb",hi:"hin",ho:"hmo",hr:"hrv",ht:"hat",hu:"hun",hy:"hye",hz:"her",ia:"ina",id:"ind",ie:"ile",ig:"ibo",ii:"iii",ik:"ipk",io:"ido",is:"isl",it:"ita",iu:"iku",ja:"jpn",jv:"jav",ka:"kat",kg:"kon",ki:"kik",kj:"kua",kk:"kaz",kl:"kal",km:"khm",kn:"kan",ko:"kor",kr:"kau",ks:"kas",ku:"kur",kv:"kom",kw:"cor",ky:"kir",la:"lat",lb:"ltz",lg:"lug",li:"lim",ln:"lin",lo:"lao",lt:"lit",lu:"lub",lv:"lav",mg:"mlg",mh:"mah",mi:"mri",mk:"mkd",ml:"mal",mn:"mon",mr:"mar",ms:"msa",mt:"mlt",my:"mya",na:"nau",nb:"nob",nd:"nde",ne:"nep",ng:"ndo",nl:"nld",nn:"nno",no:"nor",nr:"nbl",nv:"nav",ny:"nya",oc:"oci",oj:"oji",om:"orm",or:"ori",os:"oss",pa:"pan",pi:"pli",pl:"pol",ps:"pus",pt:"por",qu:"que",rm:"roh",rn:"run",ro:"ron",ru:"rus",rw:"kin",sa:"san",sc:"srd",sd:"snd",se:"sme",sg:"sag",si:"sin",sk:"slk",sl:"slv",sm:"smo",sn:"sna",so:"som",sq:"sqi",sr:"srp",ss:"ssw",st:"sot",su:"sun",sv:"swe",sw:"swa",ta:"tam",te:"tel",tg:"tgk",th:"tha",ti:"tir",tk:"tuk",tl:"tgl",tn:"tsn",to:"ton",tr:"tur",ts:"tso",tt:"tat",tw:"twi",ty:"tah",ug:"uig",uk:"ukr",ur:"urd",uz:"uzb",ve:"ven",vi:"vie",vo:"vol",wa:"wln",wo:"wol",xh:"xho",yi:"yid",yo:"yor",za:"zha",zh:"zho",zu:"zul"};var Ft=Ot;const Ut={alb:"sqi",arm:"hye",baq:"eus",bur:"mya",chi:"zho",cze:"ces",dut:"nld",fre:"fra",geo:"kat",ger:"deu",gre:"ell",ice:"isl",mac:"mkd",mao:"mri",may:"msa",per:"fas",slo:"slk",rum:"ron",tib:"bod",wel:"cym"};var Bt=Ut;function Gt(e){if(r(e)||""===e)return"und";const t=(""+e).toLowerCase().split("-"),n=t[0],i=jt(n);return Nt(i)?i:e}function jt(e){let t;switch(e.length){case 2:t=Ft[e];break;case 3:t=Bt[e];break}return t}var Vt=Gt,Ht=Vt;const Kt={dashParsers:{wasm:null,native:null,fastJs:null},codecSupportProber:null,createDebugElement:null,directfile:null,decrypt:null,htmlTextDisplayer:null,htmlTextTracksParsers:{},mainThreadMediaSourceInit:null,multithread:null,nativeTextDisplayer:null,nativeTextTracksParsers:{},transports:{}};var zt=Kt,Zt=zt;const qt=pt();class Yt{constructor(e,t){var n,i,r,a,o;if(this.id=e.id,this.uniqueId=qt(),this.bitrate=e.bitrate,this.codecs=[],void 0!==e.isSpatialAudio&&(this.isSpatialAudio=e.isSpatialAudio),void 0!==e.height&&(this.height=e.height),void 0!==e.width&&(this.width=e.width),void 0!==e.mimeType&&(this.mimeType=e.mimeType),void 0!==e.contentProtections&&(this.contentProtections=e.contentProtections),void 0!==e.frameRate&&(this.frameRate=e.frameRate),void 0!==e.hdrInfo&&(this.hdrInfo=e.hdrInfo),this.cdnMetadata=e.cdnMetadata,this.index=e.index,"audio"===t||"video"===t)if(null!==Zt.codecSupportProber){if(void 0!==e.supplementalCodecs){const t=Zt.codecSupportProber.isSupported(null!==(n=this.mimeType)&&void 0!==n?n:"",null!==(i=e.supplementalCodecs)&&void 0!==i?i:"");!1!==t&&(this.codecs=[e.supplementalCodecs],!0===t&&(this.isSupported=!0))}!0!==this.isSupported&&(this.codecs.length>0?this.codecs.push(null!==(r=e.codecs)&&void 0!==r?r:""):(this.codecs=void 0===e.codecs?[]:[e.codecs],this.isSupported=Zt.codecSupportProber.isSupported(null!==(a=this.mimeType)&&void 0!==a?a:"",null!==(o=e.codecs)&&void 0!==o?o:"")))}else void 0!==e.supplementalCodecs&&this.codecs.push(e.supplementalCodecs),void 0!==e.codecs&&this.codecs.push(e.codecs);else void 0!==e.codecs&&this.codecs.push(e.codecs),this.isSupported=!0}refreshCodecSupport(e){var t;const n=null!==(t=this.mimeType)&&void 0!==t?t:"";let i=this.codecs;0===i.length&&(i=[""]);for(let r=0;r<i.length;r++)for(const t of e){const e=i[r];if(t.codec===e&&t.mimeType===n){if(t.result)return this.isSupported=!0,void(this.codecs=[e]);if(r===i.length)return this.isSupported=!1,void(this.codecs=[e])}}}getMimeTypeString(){var e,t,n;return`${null!==(e=this.mimeType)&&void 0!==e?e:""};codecs="${null!==(n=null===(t=this.codecs)||void 0===t?void 0:t[0])&&void 0!==n?n:""}"`}getEncryptionData(e){var t,n;const i=this.getAllEncryptionData(),r=[];for(let a=0;a<i.length;a++){let o=!1;const s=i[a];for(let i=0;i<s.values.length;i++)if(s.values[i].systemId.toLowerCase()===e.toLowerCase())if(o)r[r.length-1].values.push(s.values[i]);else{const e=null===(n=null===(t=this.contentProtections)||void 0===t?void 0:t.keyIds)||void 0===n?void 0:n.map(e=>e.keyId);r.push({type:s.type,keyIds:e,values:[s.values[i]]}),o=!0}}return r}getAllEncryptionData(){var e,t;if(void 0===this.contentProtections||0===this.contentProtections.initData.length)return[];const n=null===(t=null===(e=this.contentProtections)||void 0===e?void 0:e.keyIds)||void 0===t?void 0:t.map(e=>e.keyId);return this.contentProtections.initData.map(e=>{return{type:e.type,keyIds:n,values:e.values}})}addProtectionData(e,t,n){let i=!1;if(void 0===this.contentProtections)return this.contentProtections={keyIds:void 0!==t?[{keyId:t}]:[],initData:[{type:e,values:n}]},!0;if(void 0!==t){const e=this.contentProtections.keyIds;if(void 0===e)this.contentProtections.keyIds=[{keyId:t}];else{let n=!1;for(const i of e)yt(i.keyId,t)&&(n=!0);n||(j.warn("Manifest: found unanounced key id."),e.push({keyId:t}))}}const r=this.contentProtections.initData;for(let a=0;a<r.length;a++)if(r[a].type===e){const e=r[a].values;for(let t=0;t<n.length;t++){const r=n[t];let a;for(a=0;a<e.length;a++)if(r.systemId===e[a].systemId){if(yt(r.data,e[a].data))break;j.warn("Manifest: different init data for the same system ID")}a===e.length&&(e.push(r),i=!0)}return i}return this.contentProtections.initData.push({type:e,values:n}),!0}getMetadataSnapshot(){return{id:this.id,uniqueId:this.uniqueId,bitrate:this.bitrate,codecs:this.codecs,mimeType:this.mimeType,width:this.width,height:this.height,frameRate:this.frameRate,isSupported:this.isSupported,hdrInfo:this.hdrInfo,contentProtections:this.contentProtections,decipherable:this.decipherable}}}var Wt,$t=Yt;class Xt{constructor(e,t={}){const{trickModeTracks:n}=e,{representationFilter:i,isManuallyAdded:a}=t;this.id=e.id,this.type=e.type,void 0!==e.isTrickModeTrack&&(this.isTrickModeTrack=e.isTrickModeTrack),void 0!==e.language&&(this.language=e.language,this.normalizedLanguage=Ht(e.language)),void 0!==e.closedCaption&&(this.isClosedCaption=e.closedCaption),void 0!==e.audioDescription&&(this.isAudioDescription=e.audioDescription),void 0!==e.isDub&&(this.isDub=e.isDub),void 0!==e.forcedSubtitles&&(this.isForcedSubtitles=e.forcedSubtitles),void 0!==e.isSignInterpreted&&(this.isSignInterpreted=e.isSignInterpreted),void 0!==e.label&&(this.label=e.label),void 0!==n&&n.length>0&&(this.trickModeTracks=n.map(e=>new Xt(e)));const o=e.representations,s=[];let l;for(let u=0;u<o.length;u++){const e=new $t(o[u],this.type);let t=!0;if(!r(i)){const n={id:e.id,bitrate:e.bitrate,codecs:e.codecs,height:e.height,width:e.width,frameRate:e.frameRate,hdrInfo:e.hdrInfo};if(void 0!==e.contentProtections&&(n.contentProtections={},void 0!==e.contentProtections.keyIds)){const t=e.contentProtections.keyIds.map(({keyId:e})=>e);n.contentProtections.keyIds=t}t=i(n,{trackType:this.type,language:this.language,normalizedLanguage:this.normalizedLanguage,isClosedCaption:this.isClosedCaption,isDub:this.isDub,isAudioDescription:this.isAudioDescription,isSignInterpreted:this.isSignInterpreted})}t?(s.push(e),void 0===l&&(!0===e.isSupported?l=!0:!1===e.isSupported&&(l=!1))):j.debug("Filtering Representation due to representationFilter",this.type,`Adaptation: ${this.id}`,`Representation: ${e.id}`,`(${e.bitrate})`)}s.sort((e,t)=>e.bitrate-t.bitrate),this.representations=s,this.isSupported=l,this.manuallyAdded=!0===a}refreshCodecSupport(e){for(const t of this.representations)void 0===t.isSupported&&(t.refreshCodecSupport(e),!0!==this.isSupported&&!0===t.isSupported?this.isSupported=!0:void 0===this.isSupported&&!1===t.isSupported&&(this.isSupported=!1))}getRepresentation(e){return De(this.representations,({id:t})=>e===t)}getMetadataSnapshot(){const e=[],t=this.representations;for(const n of t)e.push(n.getMetadataSnapshot());return{id:this.id,type:this.type,isSupported:this.isSupported,language:this.language,isForcedSubtitles:this.isForcedSubtitles,isClosedCaption:this.isClosedCaption,isAudioDescription:this.isAudioDescription,isSignInterpreted:this.isSignInterpreted,normalizedLanguage:this.normalizedLanguage,representations:e,label:this.label,isDub:this.isDub}}}class Qt{constructor(e,t,n){if(this.id=e.id,this.adaptations=Object.keys(e.adaptations).reduce((i,a)=>{const o=e.adaptations[a];if(r(o))return i;const s=o.map(e=>{const i=new Xt(e,{representationFilter:n});return i.representations.length>0&&!1===i.isSupported&&t.push(i),i}).filter(e=>e.representations.length>0);if(s.every(e=>!1===e.isSupported)&&o.length>0&&("video"===a||"audio"===a))throw new ut("MANIFEST_INCOMPATIBLE_CODECS_ERROR","No supported "+a+" adaptations",{tracks:void 0});return s.length>0&&(i[a]=s),i},{}),!Array.isArray(this.adaptations.video)&&!Array.isArray(this.adaptations.audio))throw new ut("MANIFEST_PARSE_ERROR","No supported audio and video tracks.");this.duration=e.duration,this.start=e.start,r(this.duration)||r(this.start)||(this.end=this.start+this.duration),this.streamEvents=void 0===e.streamEvents?[]:e.streamEvents}refreshCodecSupport(e,t){Object.keys(this.adaptations).forEach(n=>{const i=this.adaptations[n];if(void 0===i)return;let r=!1;for(const a of i){const n=a.isSupported;a.refreshCodecSupport(e),!1!==n&&!1===a.isSupported&&t.push(a),!1===r?r=a.isSupported:void 0===r&&!0===a.isSupported&&(r=!0)}if(("video"===n||"audio"===n)&&!1===r)throw new ut("MANIFEST_INCOMPATIBLE_CODECS_ERROR","No supported "+n+" adaptations",{tracks:void 0})},{})}getAdaptations(){return xt(this)}getAdaptationsForType(e){const t=this.adaptations[e];return null!==t&&void 0!==t?t:[]}getAdaptation(e){return De(this.getAdaptations(),({id:t})=>e===t)}getSupportedAdaptations(e){return St(this,e)}containsTime(e,t){return It(this,e,t)}getMetadataSnapshot(){const e={},t=this.getAdaptations();for(const n of t){let t=e[n.type];void 0===t&&(t=[],e[n.type]=t),t.push(n.getMetadataSnapshot())}return{start:this.start,end:this.end,id:this.id,streamEvents:this.streamEvents,adaptations:e}}}function Jt(e,t,n){const i={updatedAdaptations:[],removedAdaptations:[],addedAdaptations:[]};e.start=t.start,e.end=t.end,e.duration=t.duration,e.streamEvents=t.streamEvents;const r=e.getAdaptations(),a=t.getAdaptations();for(let o=0;o<r.length;o++){const e=r[o],t=le(a,t=>t.id===e.id);if(-1===t){j.warn('Manifest: Adaptation "'+r[o].id+'" not found when merging.');const[e]=r.splice(o,1);o--,i.removedAdaptations.push({id:e.id,trackType:e.type})}else{const[r]=a.splice(t,1),o=[],s=[],l=[];i.updatedAdaptations.push({adaptation:e.id,trackType:e.type,updatedRepresentations:o,addedRepresentations:s,removedRepresentations:l});const u=e.representations,c=r.representations.slice();for(let e=0;e<u.length;e++){const t=u[e],i=le(c,e=>e.id===t.id);if(-1===i){j.warn(`Manifest: Representation "${u[e].id}" `+"not found when merging.");const[t]=u.splice(e,1);e--,l.push(t.id)}else{const[e]=c.splice(i,1);o.push(t.getMetadataSnapshot()),t.cdnMetadata=e.cdnMetadata,n===Wt.Full?t.index._replace(e.index):t.index._update(e.index)}}c.length>0&&(j.warn(`Manifest: ${c.length} new Representations `+"found when merging."),e.representations.push(...c),s.push(...c.map(e=>e.getMetadataSnapshot())))}}if(a.length>0){j.warn(`Manifest: ${a.length} new Adaptations `+"found when merging.");for(const t of a){const n=e.adaptations[t.type];void 0===n?e.adaptations[t.type]=[t]:n.push(t),i.addedAdaptations.push(t.getMetadataSnapshot())}}return i}function en(e,t){const n={updatedPeriods:[],addedPeriods:[],removedPeriods:[]};let i=0;for(let a=0;a<t.length;a++){const r=t[a];let o=i,s=e[o];while(void 0!==s&&s.id!==r.id)o++,s=e[o];if(void 0!==s){const l=Jt(s,r,Wt.Full);n.updatedPeriods.push({period:{id:s.id,start:s.start,end:s.end,duration:s.duration,streamEvents:s.streamEvents},result:l});const u=t.slice(i,a),c=o-i,d=e.splice(i,c,...u);n.removedPeriods.push(...d.map(e=>({id:e.id,start:e.start,end:e.end}))),n.addedPeriods.push(...u.map(e=>e.getMetadataSnapshot())),i=a+1}}if(i>e.length)return j.error("Manifest: error when updating Periods"),n;if(i<e.length){const t=e.splice(i,e.length-i);n.removedPeriods.push(...t.map(e=>({id:e.id,start:e.start,end:e.end})))}const r=t.slice(i,t.length);return r.length>0&&(e.push(...r),n.addedPeriods.push(...r.map(e=>e.getMetadataSnapshot()))),n}function tn(e,t){const n={updatedPeriods:[],addedPeriods:[],removedPeriods:[]};if(0===e.length)return e.splice(0,0,...t),n.addedPeriods.push(...t.map(e=>e.getMetadataSnapshot())),n;if(0===t.length)return n;const i=e[e.length-1];if(i.start<t[0].start){if(i.end!==t[0].start)throw new ut("MANIFEST_UPDATE_ERROR","Cannot perform partial update: not enough data");return e.push(...t),n.addedPeriods.push(...t.map(e=>e.getMetadataSnapshot())),n}const r=le(e,({id:e})=>e===t[0].id);if(r<0)throw new ut("MANIFEST_UPDATE_ERROR","Cannot perform partial update: incoherent data");const a=Jt(e[r],t[0],Wt.Partial);n.updatedPeriods.push({period:k(e[r].getMetadataSnapshot(),{adaptations:void 0}),result:a});let o=r+1;for(let s=1;s<t.length;s++){const i=t[s];let r=-1;for(let t=o;t<e.length;t++)if(i.id===e[t].id){r=t;break}if(r<0){let t=-1;for(let n=o;n<e.length;n++)if(i.start<e[n].start){t=n;break}const r=t-o,a=e.splice(o,r,i);n.addedPeriods.push(i.getMetadataSnapshot()),n.removedPeriods.push(...a.map(e=>({id:e.id,start:e.start,end:e.end})))}else{if(r>o){j.warn("Manifest: old Periods not found in new when updating, removing");const t=e.splice(o,r-o);n.removedPeriods.push(...t.map(e=>({id:e.id,start:e.start,end:e.end}))),r=o}const t=Jt(e[r],i,Wt.Full);n.updatedPeriods.push({period:k(e[r].getMetadataSnapshot(),{adaptations:void 0}),result:t})}o++}if(o<e.length){j.warn("Manifest: Ending Periods not found in new when updating, removing");const t=e.splice(o,e.length-o);n.removedPeriods.push(...t.map(e=>({id:e.id,start:e.start,end:e.end})))}return n}(function(e){e[e["Full"]=0]="Full",e[e["Partial"]=1]="Partial"})(Wt||(Wt={}));const nn=pt();class rn extends a{constructor(e,t,n){var i;super();const{representationFilter:r,manifestUpdateUrl:a}=t;this.manifestFormat=0,this.id=nn(),this.expired=null!==(i=e.expired)&&void 0!==i?i:null,this.transport=e.transportType,this.clockOffset=e.clockOffset;const o=[];if(this.periods=e.periods.map(e=>{const t=new Qt(e,o,r);return t}).sort((e,t)=>e.start-t.start),o.length>0){const e=new ut("MANIFEST_INCOMPATIBLE_CODECS_ERROR","An Adaptation contains only incompatible codecs.",{tracks:o.map(Lt)});n.push(e)}this.adaptations=void 0===this.periods[0]?{}:this.periods[0].adaptations,this.timeBounds=e.timeBounds,this.isDynamic=e.isDynamic,this.isLive=e.isLive,this.isLastPeriodKnown=e.isLastPeriodKnown,this.uris=void 0===e.uris?[]:e.uris,this.updateUrl=a,this.lifetime=e.lifetime,this.clockOffset=e.clockOffset,this.suggestedPresentationDelay=e.suggestedPresentationDelay,this.availabilityStartTime=e.availabilityStartTime,this.publishTime=e.publishTime}refreshCodecSupport(e){const t=[];for(const n of this.periods)n.refreshCodecSupport(e,t);return t.length>0?new ut("MANIFEST_INCOMPATIBLE_CODECS_ERROR","An Adaptation contains only incompatible codecs.",{tracks:t.map(Lt)}):null}getPeriod(e){return De(this.periods,t=>{return e===t.id})}getPeriodForTime(e){return wt(this,e)}getNextPeriod(e){return De(this.periods,t=>{return t.start>e})}getPeriodAfter(e){return At(this,e)}getUrls(){return this.uris}replace(e){this._performUpdate(e,Wt.Full)}update(e){this._performUpdate(e,Wt.Partial)}getMinimumSafePosition(){return bt(this)}getLivePosition(){return Et(this)}getMaximumSafePosition(){return Tt(this)}updateRepresentationsDeciperability(e){const t=an(this,e);t.length>0&&this.trigger("decipherabilityUpdate",t)}getAdaptations(){vt("manifest.getAdaptations() is deprecated. Please use manifest.period[].getAdaptations() instead");const e=this.periods[0];if(void 0===e)return[];const t=e.adaptations,n=[];for(const i in t)if(t.hasOwnProperty(i)){const e=t[i];n.push(...e)}return n}getAdaptationsForType(e){vt("manifest.getAdaptationsForType(type) is deprecated. Please use manifest.period[].getAdaptationsForType(type) instead");const t=this.periods[0];if(void 0===t)return[];const n=t.adaptations[e];return void 0===n?[]:n}getAdaptation(e){return vt("manifest.getAdaptation(id) is deprecated. Please use manifest.period[].getAdaptation(id) instead"),De(this.getAdaptations(),({id:t})=>e===t)}getMetadataSnapshot(){const e=[];for(const t of this.periods)e.push(t.getMetadataSnapshot());return{manifestFormat:1,id:this.id,periods:e,isDynamic:this.isDynamic,isLive:this.isLive,isLastPeriodKnown:this.isLastPeriodKnown,suggestedPresentationDelay:this.suggestedPresentationDelay,clockOffset:this.clockOffset,uris:this.uris,availabilityStartTime:this.availabilityStartTime,timeBounds:this.timeBounds}}_performUpdate(e,t){let n;if(this.availabilityStartTime=e.availabilityStartTime,this.expired=e.expired,this.isDynamic=e.isDynamic,this.isLive=e.isLive,this.isLastPeriodKnown=e.isLastPeriodKnown,this.lifetime=e.lifetime,this.clockOffset=e.clockOffset,this.suggestedPresentationDelay=e.suggestedPresentationDelay,this.transport=e.transport,this.publishTime=e.publishTime,t===Wt.Full)this.timeBounds=e.timeBounds,this.uris=e.uris,n=en(this.periods,e.periods);else{this.timeBounds.maximumTimeData=e.timeBounds.maximumTimeData,this.updateUrl=e.uris[0],n=tn(this.periods,e.periods);const t=this.getMinimumSafePosition();while(this.periods.length>0){const e=this.periods[0];if(void 0===e.end||e.end>t)break;this.periods.shift()}}this.adaptations=void 0===this.periods[0]?{}:this.periods[0].adaptations,this.trigger("manifestUpdate",n)}}function an(e,t){const n=[];for(const i of e.periods)for(const r of i.getAdaptations())for(const a of r.representations){const o={manifest:e,period:i,adaptation:r,representation:a},s=t(o);s!==a.decipherable&&(n.push(o),a.decipherable=s,j.debug(`Decipherability changed for "${a.id}"`,`(${a.bitrate})`,String(a.decipherable)))}return n}var on=rn;function sn(e){return e instanceof nt?new ct("PIPELINE_LOAD_ERROR",e):ht(e,{defaultCode:"PIPELINE_LOAD_ERROR",defaultReason:"Unknown error when fetching the Manifest"})}class ln extends Error{constructor(e,t,n){super(e),Object.setPrototypeOf(this,ln.prototype),this.name="CustomLoaderError",this.canRetry=t,this.xhr=n}}function un(e,t){let n;return new Promise((i,r)=>{if(null!==e.cancellationError)return r(e.cancellationError);let a=!1;function o(e){void 0!==n&&n(),r(e)}n=t(function(t){e.deregister(o),a=!0,i(t)},function(t){e.deregister(o),a=!0,r(t)}),a||e.register(o)})}function cn(e,t){return un(t,t=>{const n=setTimeout(()=>t(),e);return()=>clearTimeout(n)})}const dn=.3;function fn(e){const t=(2*Math.random()-1)*dn;return e*(t+1)}function hn(e){return e instanceof nt?e.type===rt.ERROR_HTTP_CODE?e.status>=500||404===e.status||415===e.status||412===e.status:e.type===rt.TIMEOUT||e.type===rt.ERROR_EVENT:e instanceof ln?"boolean"===typeof e.canRetry?e.canRetry:void 0!==e.xhr&&(e.xhr.status>=500||404===e.xhr.status||415===e.xhr.status||412===e.xhr.status):ft(e)&&"INTEGRITY_ERROR"===e.code}async function pn(e,t,n,i,r){if(null!==r.cancellationError)return Promise.reject(r.cancellationError);const{baseDelay:a,maxDelay:o,maxRetry:s,onRetry:l}=i;null!==e&&0===e.length&&j.warn("Fetchers: no CDN given to `scheduleRequestWithCdns`.");const u=new Map,c=d();if(void 0===c)throw new Error("No CDN to request");return f(c);function d(){if(null===e){const e=u.get(null);if(void 0!==e&&e.isBlacklisted)return;return null}if(null===t)return g(e);{const n=t.getCdnPreferenceForResource(e);return g(n)}}async function f(e){try{const i=await n(e,r);return i}catch(n){if(me.isCancellationError(n))throw n;null!==e&&null!==t&&t.downgradeCdn(e);let i=u.get(e);if(void 0===i?(i={errorCounter:1,blockedUntil:void 0,isBlacklisted:!1},u.set(e,i)):i.errorCounter++,!hn(n))return i.blockedUntil=void 0,i.isBlacklisted=!0,h(n);if(i.errorCounter>s)i.blockedUntil=void 0,i.isBlacklisted=!0;else{const e=i.errorCounter,t=Math.min(a*Math.pow(2,e-1),o),n=fn(t);i.blockedUntil=Te()+n}return h(n)}}async function h(e){const t=d();if(r.isCancelled())throw r.cancellationError;if(void 0===t)throw e;if(l(e),r.isCancelled())throw r.cancellationError;return p(t,e)}function p(e,n){const i=u.get(e);if(void 0===i||void 0===i.blockedUntil)return f(e);const a=Te(),o=i.blockedUntil-a;if(o<=0)return f(e);const s=new me,l=s.linkToSignal(r);return new Promise((i,a)=>{function u(e){l(),i(e)}function c(e){l(),a(e)}null===t||void 0===t||t.addEventListener("priorityChange",()=>{const t=d();if(r.isCancelled())throw r.cancellationError;if(void 0===t)return c(n);t!==e&&(s.cancel(),p(t,n).then(u,c))},s.signal),cn(o,s.signal).then(()=>f(e).then(u,c),F)})}function g(e){var t;if(0===u.size)return e[0];const n=Te();return null===(t=e.filter(e=>{var t;return!0!==(null===(t=u.get(e))||void 0===t?void 0:t.isBlacklisted)}).reduce((e,t)=>{var i;let r=null===(i=u.get(t))||void 0===i?void 0:i.blockedUntil;return void 0!==r&&r<=n&&(r=void 0),void 0===e?[t,r]:void 0===e[1]?e:void 0===r?[t,void 0]:r<e[1]?[t,r]:e},void 0))||void 0===t?void 0:t[0]}}function gn(e,t,n){return pn(null,null,e,t,n)}class mn extends a{constructor(e,t,n){super(),this.scheduleManualRefresh=F,this._manifestUrls=e,this._pipelines=t.manifest,this._settings=n,this._canceller=new me,this._isStarted=!1,this._isRefreshPending=!1,this._consecutiveUnsafeMode=0,this._prioritizedContentUrl=null}dispose(){this._canceller.cancel(),this.removeEventListener()}start(){if(this._isStarted)return;let e;this._isStarted=!0;const t=this._settings.initialManifest;e=t instanceof on?Promise.resolve({manifest:t}):void 0!==t?this.parse(t,{previousManifest:null,unsafeMode:!1},void 0):this._fetchManifest(void 0).then(e=>{return e.parse({previousManifest:null,unsafeMode:!1})}),e.then(e=>{this.trigger("manifestReady",e.manifest),this._canceller.isUsed()||this._recursivelyRefreshManifest(e.manifest,e)}).catch(e=>this._onFatalError(e))}updateContentUrls(e,t){var n;this._prioritizedContentUrl=null!==(n=null===e||void 0===e?void 0:e[0])&&void 0!==n?n:void 0,t&&this.scheduleManualRefresh({enablePartialRefresh:!1,delay:0,canUseUnsafeMode:!1})}async _fetchManifest(e){var t;const n=this._canceller.signal,i=this._settings,r=this._pipelines,a=null!==e&&void 0!==e?e:null===(t=this._manifestUrls)||void 0===t?void 0:t[0],o=this._getBackoffSetting(e=>{this.trigger("warning",sn(e))});try{const e=await s(a);return{parse:t=>{return this._parseLoadedManifest(e,t,a)}}}catch(e){throw sn(e)}function s(e){const{loadManifest:t}=r;let a=void 0===i.requestTimeout?O.getCurrent().DEFAULT_REQUEST_TIMEOUT:i.requestTimeout,s=void 0===i.connectionTimeout?O.getCurrent().DEFAULT_CONNECTION_TIMEOUT:i.connectionTimeout;a<0&&(a=void 0),s<0&&(s=void 0);const l=()=>t(e,{timeout:a,connectionTimeout:s},n);return gn(l,o,n)}}parse(e,t,n){return this._parseLoadedManifest({responseData:e,size:void 0,requestDuration:void 0},t,n)}async _parseLoadedManifest(e,t,n){var i;const r=Te(),a=this._canceller.signal,o=this.trigger.bind(this),{sendingTime:s,receivedTime:l}=e,u=this._getBackoffSetting(e=>{this.trigger("warning",sn(e))}),c=null!==n&&void 0!==n?n:null===(i=this._manifestUrls)||void 0===i?void 0:i[0],d={externalClockOffset:t.externalClockOffset,unsafeMode:t.unsafeMode,previousManifest:t.previousManifest,originalUrl:c};try{const t=this._pipelines.parseManifest(e,d,h,a,f);if(vn(t)){const{manifest:e,warnings:n}=await t;return p(e,n)}return p(t.manifest,t.warnings)}catch(e){const t=ht(e,{defaultCode:"PIPELINE_PARSE_ERROR",defaultReason:"Unknown error when parsing the Manifest"});throw t}async function f(e){try{const t=await gn(e,u,a);return t}catch(e){throw sn(e)}}function h(e){for(const t of e){if(a.isCancelled())return;const e=ht(t,{defaultCode:"PIPELINE_PARSE_ERROR",defaultReason:"Unknown error when parsing the Manifest"});o("warning",e)}}function p(e,t){h(t);const n=Te()-r;return j.info(`MF: Manifest parsed in ${n}ms`),{manifest:e,sendingTime:s,receivedTime:l,parsingTime:n}}}_getBackoffSetting(e){const{DEFAULT_MAX_MANIFEST_REQUEST_RETRY:t,INITIAL_BACKOFF_DELAY_BASE:n,MAX_BACKOFF_DELAY_BASE:i}=O.getCurrent(),{lowLatencyMode:r,maxRetry:a}=this._settings,o=r?n.LOW_LATENCY:n.REGULAR,s=r?i.LOW_LATENCY:i.REGULAR,l=null!==a&&void 0!==a?a:t;return{onRetry:e,baseDelay:o,maxDelay:s,maxRetry:l}}_recursivelyRefreshManifest(e,{sendingTime:t,parsingTime:n,updatingTime:i}){const{MAX_CONSECUTIVE_MANIFEST_PARSING_IN_UNSAFE_MODE:r,MIN_MANIFEST_PARSING_TIME_TO_ENTER_UNSAFE_MODE:a}=O.getCurrent(),o=void 0!==n?n+(null!==i&&void 0!==i?i:0):void 0;let s=!1;this._consecutiveUnsafeMode>0?s=this._consecutiveUnsafeMode<r:void 0!==o&&(s=o>=a);const l=void 0===t?0:Te()-t,u=Math.max(this._settings.minimumManifestUpdateInterval-l,0),c=new me;if(c.linkToSignal(this._canceller.signal),this.scheduleManualRefresh=(n=>{const{enablePartialRefresh:i,delay:r,canUseUnsafeMode:a}=n,o=a&&s,l=void 0===t?0:Te()-t,u=Math.max(this._settings.minimumManifestUpdateInterval-l,0),d=setTimeout(()=>{c.cancel(),this._triggerNextManifestRefresh(e,{enablePartialRefresh:i,unsafeMode:o})},Math.max((null!==r&&void 0!==r?r:0)-l,u));c.signal.register(()=>{clearTimeout(d)})}),null!==e.expired){const t=setTimeout(()=>{var t;null===(t=e.expired)||void 0===t||t.then(()=>{c.cancel(),this._triggerNextManifestRefresh(e,{enablePartialRefresh:!1,unsafeMode:s})},F)},u);c.signal.register(()=>{clearTimeout(t)})}if(void 0!==e.lifetime&&e.lifetime>=0){const t=1e3*e.lifetime-l;let n;void 0===o?n=t:e.lifetime<3&&o>=100?(n=Math.min(Math.max(3e3-l,Math.max(t,0)+o),6*t),j.info("MUS: Manifest update rythm is too frequent. Postponing next request.",t,n)):o>=1e3*e.lifetime/10?(n=Math.min(Math.max(t,0)+o,6*t),j.info("MUS: Manifest took too long to parse. Postponing next request",n,n)):n=t;const i=setTimeout(()=>{c.cancel(),this._triggerNextManifestRefresh(e,{enablePartialRefresh:!1,unsafeMode:s})},Math.max(n,u));c.signal.register(()=>{clearTimeout(i)})}}_triggerNextManifestRefresh(e,{enablePartialRefresh:t,unsafeMode:n}){const i=e.updateUrl;let r,a;null!==this._prioritizedContentUrl?(r=!0,a=this._prioritizedContentUrl,this._prioritizedContentUrl=null):(r=!t||void 0===i,a=r?e.getUrls()[0]:i);const o=e.clockOffset;n?(this._consecutiveUnsafeMode+=1,j.info('Init: Refreshing the Manifest in "unsafeMode" for the '+String(this._consecutiveUnsafeMode)+" consecutive time.")):this._consecutiveUnsafeMode>0&&(j.info('Init: Not parsing the Manifest in "unsafeMode" anymore after '+String(this._consecutiveUnsafeMode)+" consecutive times."),this._consecutiveUnsafeMode=0),this._isRefreshPending||(this._isRefreshPending=!0,this._fetchManifest(a).then(t=>t.parse({externalClockOffset:o,previousManifest:e,unsafeMode:n})).then(t=>{this._isRefreshPending=!1;const{manifest:n,sendingTime:i,parsingTime:a}=t,o=Te();if(r)e.replace(n);else try{e.update(n)}catch(t){const n=t instanceof Error?t.message:"unknown error";j.warn(`MUS: Attempt to update Manifest failed: ${n}`,"Re-downloading the Manifest fully");const{FAILED_PARTIAL_UPDATE_MANIFEST_REFRESH_DELAY:r}=O.getCurrent(),a=void 0===i?0:Te()-i,o=Math.max(this._settings.minimumManifestUpdateInterval-a,0);let s=F;const l=setTimeout(()=>{s(),this._triggerNextManifestRefresh(e,{enablePartialRefresh:!1,unsafeMode:!1})},Math.max(r-a,o));return void(s=this._canceller.signal.register(()=>{clearTimeout(l)}))}const s=Te()-o;this._recursivelyRefreshManifest(e,{sendingTime:i,parsingTime:a,updatingTime:s})}).catch(e=>{this._isRefreshPending=!1,this._onFatalError(e)}))}_onFatalError(e){this._canceller.isUsed()||(this.trigger("error",e),this.dispose())}}function vn(e){return e instanceof Promise}var yn=mn;class _n extends a{constructor(e){super(),this._downgradedCdnList={metadata:[],timeouts:[]},e.register(()=>{for(const e of this._downgradedCdnList.timeouts)clearTimeout(e);this._downgradedCdnList={metadata:[],timeouts:[]}})}getCdnPreferenceForResource(e){return e.length<=1?e:this._innerGetCdnPreferenceForResource(e)}downgradeCdn(e){const t=bn(this._downgradedCdnList.metadata,e);t>=0&&this._removeIndexFromDowngradeList(t);const{DEFAULT_CDN_DOWNGRADE_TIME:n}=O.getCurrent(),i=n;this._downgradedCdnList.metadata.push(e);const r=setTimeout(()=>{const t=bn(this._downgradedCdnList.metadata,e);t>=0&&this._removeIndexFromDowngradeList(t),this.trigger("priorityChange",null)},i);this._downgradedCdnList.timeouts.push(r),this.trigger("priorityChange",null)}_innerGetCdnPreferenceForResource(e){const[t,n]=e.reduce((e,t)=>{return this._downgradedCdnList.metadata.some(e=>e.id===t.id&&e.baseUrl===t.baseUrl)?e[1].push(t):e[0].push(t),e},[[],[]]);return t.concat(n)}_removeIndexFromDowngradeList(e){this._downgradedCdnList.metadata.splice(e,1);const t=this._downgradedCdnList.timeouts.splice(e,1);clearTimeout(t[0])}}function bn(e,t){return 0===e.length?-1:void 0!==t.id?le(e,e=>e.id===t.id):le(e,e=>e.baseUrl===t.baseUrl)}function En(e,t){const n=new WeakMap;return{createRequest(i,r,a,o){const s=e=>{return t(i,a,e)},l=e.create(s,r,a,o);return n.set(l,s),l},updatePriority(t,i){const r=n.get(t);void 0!==r?e.updatePriority(r,i):j.warn("Fetchers: Cannot update the priority of a request: task not found.")}}}function Tn(e,t){return e.segment.id===t.segment.id&&e.representation.uniqueId===t.representation.uniqueId}function Sn(e){if(r(e))return"";const{period:t,adaptation:n,representation:i,segment:a}=e;let o;return o=a.isInit?"init":a.complete?`${a.time}-${a.duration}`:`${a.time}`,`${n.type} P: ${t.id} A: ${n.id} `+`R: ${i.id} S: ${o}`}class wn{constructor(){this._cache=new WeakMap}add({representation:e,segment:t},n){t.isInit&&this._cache.set(e,n)}get({representation:e,segment:t}){if(t.isInit){const t=this._cache.get(e);if(void 0!==t)return t}return null}}var An=wn;const In=pt();function xn(e,t,n,i,a){let o;o=void 0===a.connectionTimeout||a.connectionTimeout<0?void 0:a.connectionTimeout;const s={timeout:a.requestTimeout<0?void 0:a.requestTimeout,connectionTimeout:o},l=gt(["audio","video"],e)?new An:void 0,{loadSegment:u,parseSegment:c}=t;return async function(e,t,o){var d,f,h;const{segment:p,adaptation:g,representation:m,manifest:v,period:y}=e,_=Sn(e),b=In();let E;const T=[];let S=0,w=!1;const A={segment:p,type:g.type,language:g.language,isLive:v.isLive,periodStart:y.start,periodEnd:y.end,mimeType:m.mimeType,codecs:m.codecs[0],manifestPublishTime:v.publishTime},I={onProgress(e){var t;void 0===E&&void 0!==e.totalSize&&e.size<e.totalSize&&(null===(t=i.onProgress)||void 0===t||t.call(i,{duration:e.duration,size:e.size,totalSize:e.totalSize,timestamp:Te(),id:b}))},onNewChunk(e){t.onChunk(D(e,!0))}},x=void 0!==l?l.get(e):null;if(null!==x)return j.debug("SF: Found wanted segment in cache",_),t.onChunk(D(x,!1)),Promise.resolve();j.debug("SF: Beginning request",_),null===(d=i.onRequestBegin)||void 0===d||d.call(i,{requestTimestamp:Te(),id:b,content:e}),o.register(R);try{const r=await pn(e.representation.cdnMetadata,n,C,k({onRetry:M},a),o);if("segment-loaded"===r.resultType){const n=r.resultData.responseData;void 0!==l&&l.add(e,r.resultData.responseData),t.onChunk(D(n,!1))}else"segment-created"===r.resultType&&t.onChunk(D(r.resultData,!1));j.debug("SF: Segment request ended with success",_),t.onAllChunksReceived(),"segment-created"!==r.resultType?(E=r.resultData,L()):E=null,o.isCancelled()||null===(f=i.onRequestEnd)||void 0===f||f.call(i,{id:b}),o.deregister(R)}catch(e){if(o.deregister(R),E=null,e instanceof ye)throw j.debug("SF: Segment request aborted",_),e;throw j.debug("SF: Segment request failed",_),null===(h=i.onRequestEnd)||void 0===h||h.call(i,{id:b}),sn(e)}function R(){var e;void 0===E&&(j.debug("SF: Segment request cancelled",_),E=null,null===(e=i.onRequestEnd)||void 0===e||e.call(i,{id:b}))}function C(e){return u(e,A,s,o,I)}function D(e,t){T.push(!1);const n=T.length-1;return function(i){const r={data:e,isChunked:t};try{const e=c(r,A,i);return T[n]||(S=void 0!==S&&"media"===e.segmentType&&null!==e.chunkInfos&&void 0!==e.chunkInfos.duration?S+e.chunkInfos.duration:void 0,T[n]=!0,L()),e}catch(e){throw ht(e,{defaultCode:"PIPELINE_PARSE_ERROR",defaultReason:"Unknown parsing error"})}}}function M(e){t.onRetry(sn(e))}function L(){var t;w||!r(E)&&void 0!==E.size&&void 0!==E.requestDuration&&T.length>0&&T.every(e=>e)&&(w=!0,null===(t=i.onMetrics)||void 0===t||t.call(i,{size:E.size,requestDuration:E.requestDuration,content:e,segmentDuration:S}))}}}function Rn({maxRetry:e,lowLatencyMode:t,requestTimeout:n,connectionTimeout:i}){const{DEFAULT_MAX_REQUESTS_RETRY_ON_ERROR:r,DEFAULT_REQUEST_TIMEOUT:a,DEFAULT_CONNECTION_TIMEOUT:o,INITIAL_BACKOFF_DELAY_BASE:s,MAX_BACKOFF_DELAY_BASE:l}=O.getCurrent();return{maxRetry:null!==e&&void 0!==e?e:r,baseDelay:t?s.LOW_LATENCY:s.REGULAR,maxDelay:t?l.LOW_LATENCY:l.REGULAR,requestTimeout:void 0===n?a:n,connectionTimeout:void 0===i?o:i}}class Cn{constructor({prioritySteps:e}){if(this._minPendingPriority=null,this._waitingQueue=[],this._pendingTasks=[],this._prioritySteps=e,this._prioritySteps.high>=this._prioritySteps.low)throw new Error("TP: the max high level priority should be given a lowerpriority number than the min low priority.")}create(e,t,n,i){let r;return un(i,(a,o)=>{const s=()=>{if(r.hasEnded)return;const e=()=>{u(),this._endTask(r)},t=t=>{n.beforeEnded(),e(),a(t)},s=t=>{e(),o(t)},l=new me,u=l.linkToSignal(i);r.interrupter=l,l.signal.register(()=>{r.interrupter=null,i.isCancelled()||n.beforeInterrupted()}),this._minPendingPriority=null===this._minPendingPriority?r.priority:Math.min(this._minPendingPriority,r.priority),this._pendingTasks.push(r),r.taskFn(l.signal).then(t).catch(e=>{!i.isCancelled()&&l.isUsed()&&e instanceof ye||s(e)})};return r={hasEnded:!1,priority:t,trigger:s,taskFn:e,interrupter:null},this._canBeStartedNow(r)?(r.trigger(),this._isRunningHighPriorityTasks()&&this._interruptCancellableTasks()):this._waitingQueue.push(r),()=>this._endTask(r)})}_endTask(e){e.hasEnded=!0;const t=Dn(e.taskFn,this._waitingQueue);if(t>=0)this._waitingQueue.splice(t,1);else{const t=Dn(e.taskFn,this._pendingTasks);if(t<0)return;this._pendingTasks.splice(t,1),this._pendingTasks.length>0?this._minPendingPriority===e.priority&&(this._minPendingPriority=Math.min(...this._pendingTasks.map(e=>e.priority))):this._minPendingPriority=null,this._loopThroughWaitingQueue()}}updatePriority(e,t){const n=Dn(e,this._waitingQueue);if(n>=0){const e=this._waitingQueue[n];if(e.priority===t)return;if(e.priority=t,!this._canBeStartedNow(e))return;return this._findAndRunWaitingQueueTask(n),void(this._isRunningHighPriorityTasks()&&this._interruptCancellableTasks())}const i=Dn(e,this._pendingTasks);if(i<0)return void j.warn("TP: request to update the priority of a non-existent task");const r=this._pendingTasks[i];if(r.priority===t)return;const a=r.priority;r.priority=t,null===this._minPendingPriority||t<this._minPendingPriority?this._minPendingPriority=t:this._minPendingPriority===a&&(1===this._pendingTasks.length?this._minPendingPriority=t:this._minPendingPriority=Math.min(...this._pendingTasks.map(e=>e.priority)),this._loopThroughWaitingQueue()),this._isRunningHighPriorityTasks()&&this._interruptCancellableTasks()}_loopThroughWaitingQueue(){const e=this._waitingQueue.reduce((e,t)=>{return null===e||e>t.priority?t.priority:e},null);if(!(null===e||null!==this._minPendingPriority&&this._minPendingPriority<e))for(let t=0;t<this._waitingQueue.length;t++){const n=null===this._minPendingPriority?e:Math.min(this._minPendingPriority,e),i=this._waitingQueue[t];i.priority<=n&&(this._findAndRunWaitingQueueTask(t),t--)}}_interruptCancellableTasks(){for(let e=0;e<this._pendingTasks.length;e++){const t=this._pendingTasks[e];if(t.priority>=this._prioritySteps.low)return this._interruptPendingTask(t),this._interruptCancellableTasks()}}_findAndRunWaitingQueueTask(e){if(e>=this._waitingQueue.length||e<0)return j.warn("TP : Tried to start a non existing task"),!1;const t=this._waitingQueue.splice(e,1)[0];return t.trigger(),!0}_interruptPendingTask(e){var t;const n=Dn(e.taskFn,this._pendingTasks);n<0?j.warn("TP: Interrupting a non-existent pending task. Aborting..."):(this._pendingTasks.splice(n,1),this._waitingQueue.push(e),0===this._pendingTasks.length?this._minPendingPriority=null:this._minPendingPriority===e.priority&&(this._minPendingPriority=Math.min(...this._pendingTasks.map(e=>e.priority))),null===(t=e.interrupter)||void 0===t||t.cancel())}_canBeStartedNow(e){return null===this._minPendingPriority||e.priority<=this._minPendingPriority}_isRunningHighPriorityTasks(){return null!==this._minPendingPriority&&this._minPendingPriority<=this._prioritySteps.high}}function Dn(e,t){return le(t,t=>t.taskFn===e)}class kn{constructor(e,t,n){const i=new _n(n),{MIN_CANCELABLE_PRIORITY:r,MAX_HIGH_PRIORITY_LEVEL:a}=O.getCurrent();this._transport=e,this._prioritizer=new Cn({prioritySteps:{high:a,low:r}}),this._cdnPrioritizer=i,this._backoffOptions=t}createSegmentFetcher(e,t){const n=Rn(this._backoffOptions),i=this._transport[e],r=xn(e,i,this._cdnPrioritizer,t,n);return En(this._prioritizer,r)}}var Mn=kn;class Ln{constructor(e){this._array=[],this._sortingFn=e}add(...e){e.sort(this._sortingFn);let t=0;for(let n=0;n<e.length;n++){const i=e[n];let r=!1;while(!r&&t<this._array.length)this._sortingFn(i,this._array[t])<0?(this._array.splice(t,0,i),r=!0):t++;r||this._array.push(i)}}length(){return this._array.length}get(e){if(e<0||e>=this._array.length)throw new Error("Invalid index.");return this._array[e]}toArray(){return this._array.slice()}findFirst(e){return De(this._array,e)}has(e){return gt(this._array,e)}removeElement(e){const t=this._array.indexOf(e);if(t>=0)return this._array.splice(t,1),t}head(){return this._array[0]}last(){return this._array[this._array.length-1]}shift(){return this._array.shift()}pop(){return this._array.pop()}}class Pn extends a{constructor(e,t,n){super(),this._canceller=new me,this._manifest=e,this._activeStreams=new Map,this._allBufferTypes=n,this._lastCurrentPeriodId=null;const i=new Nn(e);this._maximumPositionCalculator=i;const r=this._canceller.signal;t.listen(({position:t})=>{const n=t.getWanted();if(n<e.getMinimumSafePosition()){const e=new ut("MEDIA_TIME_BEFORE_MANIFEST","The current position is behind the earliest time announced in the Manifest.");this.trigger("warning",e)}else if(n>i.getMaximumAvailablePosition()){const e=new ut("MEDIA_TIME_AFTER_MANIFEST","The current position is after the latest time announced in the Manifest.");this.trigger("warning",e)}},{includeLastObservation:!0,clearSignal:r}),e.addEventListener("manifestUpdate",()=>{this.trigger("endingPositionChange",this._getManifestEndTime()),r.isCancelled()||this._checkEndOfStream()},r)}getCurrentEndingTime(){return this._getManifestEndTime()}onAdaptationChange(e,t,n){if(this._manifest.isLastPeriodKnown){const i=this._manifest.periods[this._manifest.periods.length-1];if(t.id===(null===i||void 0===i?void 0:i.id)&&("audio"===e||"video"===e)){"audio"===e?this._maximumPositionCalculator.updateLastAudioAdaptation(n):this._maximumPositionCalculator.updateLastVideoAdaptation(n);const t=this._maximumPositionCalculator.getEndingPosition(),i=void 0!==t?{isEnd:!0,endingPosition:t}:{isEnd:!1,endingPosition:this._maximumPositionCalculator.getMaximumAvailablePosition()};this.trigger("endingPositionChange",i)}}this._canceller.isUsed()||null===n&&this._addActivelyLoadedPeriod(t,e)}onRepresentationChange(e,t){this._addActivelyLoadedPeriod(t,e)}onPeriodCleared(e,t){this._removeActivelyLoadedPeriod(t,e)}onLastSegmentFinishedLoading(e){const t=this._lazilyCreateActiveStreamInfo(e);t.hasFinishedLoadingLastPeriod||(t.hasFinishedLoadingLastPeriod=!0,this._checkEndOfStream())}onLastSegmentLoadingResume(e){const t=this._lazilyCreateActiveStreamInfo(e);t.hasFinishedLoadingLastPeriod&&(t.hasFinishedLoadingLastPeriod=!1,this._checkEndOfStream())}dispose(){this.removeEventListener(),this._canceller.cancel()}_addActivelyLoadedPeriod(e,t){const n=this._lazilyCreateActiveStreamInfo(t);n.activePeriods.has(e)||(n.activePeriods.add(e),this._checkCurrentPeriod())}_removeActivelyLoadedPeriod(e,t){const n=this._activeStreams.get(t);void 0!==n&&n.activePeriods.has(e)&&(n.activePeriods.removeElement(e),this._checkCurrentPeriod())}_checkCurrentPeriod(){if(0===this._allBufferTypes.length)return;const e=this._activeStreams.get(this._allBufferTypes[0]);if(void 0!==e)for(const t of e.activePeriods.toArray()){let e=!0;for(const n of this._allBufferTypes){const i=this._activeStreams.get(n);if(void 0===i)return;const r=i.activePeriods.toArray(),a=r.some(e=>e.id===t.id);if(!a){e=!1;break}}if(e)return void(this._lastCurrentPeriodId!==t.id&&(this._lastCurrentPeriodId=t.id,this.trigger("periodChange",t)))}}_getManifestEndTime(){const e=this._maximumPositionCalculator.getEndingPosition();return void 0!==e?{isEnd:!0,endingPosition:e}:{isEnd:!1,endingPosition:this._maximumPositionCalculator.getMaximumAvailablePosition()}}_lazilyCreateActiveStreamInfo(e){let t=this._activeStreams.get(e);return void 0===t&&(t={activePeriods:new Ln((e,t)=>e.start-t.start),hasFinishedLoadingLastPeriod:!1},this._activeStreams.set(e,t)),t}_checkEndOfStream(){if(!this._manifest.isLastPeriodKnown)return;const e=this._allBufferTypes.every(e=>{const t=this._activeStreams.get(e);return void 0!==t&&t.hasFinishedLoadingLastPeriod});e?this.trigger("endOfStream",null):this.trigger("resumeStream",null)}}class Nn{constructor(e){this._manifest=e,this._lastAudioAdaptation=void 0,this._lastVideoAdaptation=void 0}updateLastAudioAdaptation(e){this._lastAudioAdaptation=e}updateLastVideoAdaptation(e){this._lastVideoAdaptation=e}getMaximumAvailablePosition(){if(this._manifest.isDynamic)return this._manifest.getMaximumSafePosition();if(void 0===this._lastVideoAdaptation||void 0===this._lastAudioAdaptation)return this._manifest.getMaximumSafePosition();if(null===this._lastAudioAdaptation){if(null===this._lastVideoAdaptation)return this._manifest.getMaximumSafePosition();{const e=On(this._lastVideoAdaptation);return"number"!==typeof e?this._manifest.getMaximumSafePosition():e}}if(null===this._lastVideoAdaptation){const e=On(this._lastAudioAdaptation);return"number"!==typeof e?this._manifest.getMaximumSafePosition():e}{const e=On(this._lastAudioAdaptation),t=On(this._lastVideoAdaptation);return"number"!==typeof e||"number"!==typeof t?this._manifest.getMaximumSafePosition():Math.min(e,t)}}getEndingPosition(){var e,t;if(!this._manifest.isDynamic)return this.getMaximumAvailablePosition();if(void 0!==this._lastVideoAdaptation&&void 0!==this._lastAudioAdaptation){if(null===this._lastAudioAdaptation)return null===this._lastVideoAdaptation?void 0:null!==(e=Fn(this._lastVideoAdaptation))&&void 0!==e?e:void 0;if(null===this._lastVideoAdaptation)return null!==(t=Fn(this._lastAudioAdaptation))&&void 0!==t?t:void 0;{const e=Fn(this._lastAudioAdaptation),t=Fn(this._lastVideoAdaptation);return"number"!==typeof e||"number"!==typeof t?void 0:Math.min(e,t)}}}}function On(e){const{representations:t}=e;let n,i=null;for(const a of t)if(a.index!==n){n=a.index;const e=a.index.getLastAvailablePosition();if(void 0===e)return;null!==e&&(i=r(i)?e:Math.min(i,e))}return i}function Fn(e){const{representations:t}=e;let n,i=null;for(let a=0;a<t.length;a++)if(t[a].index!==n){n=t[a].index;const e=t[a].index.getEnd();if(void 0===e)return;null!==e&&(i=r(i)?e:Math.min(i,e))}return i}function Un(e,t,n,i,r,a){a.register(()=>{t.interruptDurationSetting()});const o=new Pn(e,n,i.getBufferTypes());a.register(()=>{o.dispose()}),o.addEventListener("warning",e=>r.onWarning(e)),o.addEventListener("periodChange",e=>r.onPeriodChanged(e)),o.addEventListener("endingPositionChange",e=>{t.setDuration(e.endingPosition,e.isEnd)}),o.addEventListener("endOfStream",()=>{j.debug("Init: end-of-stream order received."),t.maintainEndOfStream()}),o.addEventListener("resumeStream",()=>{t.stopEndOfStream()});const s=o.getCurrentEndingTime();return t.setDuration(s.endingPosition,s.isEnd),o}class Bn{constructor(e){this._segmentSinksStore=e,this._currentFreezeTimestamp=null}needToReload(e){const{readyState:t,rebuffering:n,freezing:i}=e,r=void 0!==e.bufferGap&&isFinite(e.bufferGap)?e.bufferGap:0;if(r<6||null===n&&null===i||t>1)return this._currentFreezeTimestamp=null,!1;const a=Te();null===this._currentFreezeTimestamp&&(this._currentFreezeTimestamp=a);const o=null!==n&&a-n.timestamp>4e3,s=null!==i&&a-i.timestamp>4e3;if((o||s)&&Te()-this._currentFreezeTimestamp>4e3){const e=this._segmentSinksStore.getStatus("audio"),t=this._segmentSinksStore.getStatus("video");let n=!0,i=!0;for(const r of[e,t])if("initialized"===r.type)for(const e of r.value.getLastKnownInventory()){const{representation:t}=e.infos;if(!1===t.decipherable)return j.warn("Init: we have undecipherable segments left in the buffer, reloading"),this._currentFreezeTimestamp=null,!0;void 0!==t.contentProtections&&(i=!1,!0!==t.decipherable&&(n=!1))}if(!i&&n)return j.warn("Init: we are frozen despite only having decipherable segments left in the buffer, reloading"),this._currentFreezeTimestamp=null,!0}return!1}}class Gn{constructor(e,t){this._history=[],this._lifetime=e,this._maxHistoryLength=t}addBufferedSegment(e,t){const n=Te();this._history.push({date:n,buffered:t,context:e}),this._cleanHistory(n)}getHistoryFor(e){return this._history.filter(t=>Tn(t.context,e))}_cleanHistory(e){const t=e-this._lifetime;let n=0;for(const i of this._history){if(!(i.date<t))break;n++}if(n>0&&(this._history=this._history.splice(n)),this._history.length>this._maxHistoryLength){const e=this._history.length-this._maxHistoryLength;this._history=this._history.splice(e)}}}class jn{constructor(){const{BUFFERED_HISTORY_RETENTION_TIME:e,BUFFERED_HISTORY_MAXIMUM_ENTRIES:t}=O.getCurrent();this._inventory=[],this._bufferedHistory=new Gn(e,t)}reset(){this._inventory.length=0}synchronizeBuffered(e){var t,n,i,a,o,s,l;const u=this._inventory;let c=0,d=u[0];const{MINIMUM_SEGMENT_SIZE:f}=O.getCurrent(),h=null===d||void 0===d?void 0:d.infos.adaptation.type;if(j.hasLevel("DEBUG")){const t=e.map(e=>`${e.start}-${e.end}`).join(",");j.debug(`SI: synchronizing ${null!==h&&void 0!==h?h:"unknown"} buffered ranges:`,t)}const p=e.length;for(let r=0;r<p;r++){if(void 0===d)return;const g=e[r].start,m=e[r].end;if(m-g<f){j.warn("SI: skipped range when synchronizing because it was too small",h,g,m);continue}const v=c;while(void 0!==d&&(null!==(t=d.bufferedEnd)&&void 0!==t?t:d.end)-g<f)d=u[++c];let y=null;const _=c-v;if(_>0){const e=u[v+_-1];y={end:null!==(n=e.bufferedEnd)&&void 0!==n?n:e.end,precizeEnd:e.precizeEnd},j.debug(`SI: ${_} segments GCed.`,h);const t=u.splice(v,_);for(const n of t)void 0===n.bufferedStart&&void 0===n.bufferedEnd&&2!==n.status&&this._bufferedHistory.addBufferedSegment(n.infos,null);c=v}if(void 0===d)return;if(m-(null!==(i=d.bufferedStart)&&void 0!==i?i:d.start)>=f){if(Kn(d,g,y,h),c===u.length-1)return void zn(d,m,h);d=u[++c];let t=null!==(a=d.bufferedStart)&&void 0!==a?a:d.start,n=null!==(o=d.bufferedEnd)&&void 0!==o?o:d.end;const i=r<p-1?e[r+1].start:void 0;while(void 0!==d){if(m<t)break;if(m-t<f&&n-m>=f)break;if(void 0!==i&&m-t<n-i)break;const e=u[c-1];void 0===e.bufferedEnd&&(d.precizeStart?e.bufferedEnd=d.start:e.infos.segment.complete?e.bufferedEnd=e.end:e.bufferedEnd=d.start,j.debug("SI: calculating buffered end of contiguous segment",h,e.bufferedEnd,e.end)),d.bufferedStart=e.bufferedEnd,d=u[++c],void 0!==d&&(t=null!==(s=d.bufferedStart)&&void 0!==s?s:d.start,n=null!==(l=d.bufferedEnd)&&void 0!==l?l:d.end)}}const b=u[c-1];void 0!==b&&zn(b,m,h)}if(!r(d)){const{SEGMENT_SYNCHRONIZATION_DELAY:e}=O.getCurrent(),t=Te();for(let n=c;n<u.length;n++){const i=u[n];t-i.insertionTs>=e&&(j.debug("SI: A segment at the end has been completely GCed",h,`${i.start}-${i.end}`),void 0===i.bufferedStart&&void 0===i.bufferedEnd&&2!==i.status&&this._bufferedHistory.addBufferedSegment(i.infos,null),u.splice(n,1),n--)}}void 0!==h&&j.hasLevel("DEBUG")&&j.debug(`SI: current ${h} inventory timeline:\n`+Zn(this._inventory))}insertChunk({period:e,adaptation:t,representation:n,segment:i,chunkSize:r,start:a,end:o},s,l){if(i.isInit)return;const u=t.type;if(a>=o)return void j.warn("SI: Invalid chunked inserted: starts before it ends",u,a,o);const c=this._inventory,d={status:s?0:2,insertionTs:l,chunkSize:r,splitted:!1,start:a,end:o,precizeStart:!1,precizeEnd:!1,bufferedStart:void 0,bufferedEnd:void 0,infos:{segment:i,period:e,adaptation:t,representation:n}};for(let h=c.length-1;h>=0;h--){const e=c[h];if(e.start<=a){if(e.end<=a){j.debug("SI: Pushing segment strictly after previous one.",u,a,e.end),this._inventory.splice(h+1,0,d),h+=2;while(h<c.length&&c[h].start<d.end){if(c[h].end>d.end)return j.debug("SI: Segment pushed updates the start of the next one",u,d.end,c[h].start),c[h].start=d.end,c[h].bufferedStart=void 0,void(c[h].precizeStart=c[h].precizeStart&&d.precizeEnd);j.debug("SI: Segment pushed removes the next one",u,a,o,c[h].start,c[h].end),c.splice(h,1)}return}if(e.start===a){if(e.end<=o){j.debug("SI: Segment pushed replace another one",u,a,o,e.end),this._inventory.splice(h,1,d),h+=1;while(h<c.length&&c[h].start<d.end){if(c[h].end>d.end)return j.debug("SI: Segment pushed updates the start of the next one",u,d.end,c[h].start),c[h].start=d.end,c[h].bufferedStart=void 0,void(c[h].precizeStart=c[h].precizeStart&&d.precizeEnd);j.debug("SI: Segment pushed removes the next one",u,a,o,c[h].start,c[h].end),c.splice(h,1)}return}return j.debug("SI: Segment pushed ends before another with the same start",u,a,o,e.end),c.splice(h,0,d),e.start=d.end,e.bufferedStart=void 0,void(e.precizeStart=e.precizeStart&&d.precizeEnd)}if(e.end<=d.end){j.debug("SI: Segment pushed updates end of previous one",u,a,o,e.start,e.end),this._inventory.splice(h+1,0,d),e.end=d.start,e.bufferedEnd=void 0,e.precizeEnd=e.precizeEnd&&d.precizeStart,h+=2;while(h<c.length&&c[h].start<d.end){if(c[h].end>d.end)return j.debug("SI: Segment pushed updates the start of the next one",u,d.end,c[h].start),c[h].start=d.end,c[h].bufferedStart=void 0,void(c[h].precizeStart=c[h].precizeStart&&d.precizeEnd);j.debug("SI: Segment pushed removes the next one",u,a,o,c[h].start,c[h].end),c.splice(h,1)}return}{j.warn("SI: Segment pushed is contained in a previous one",u,a,o,e.start,e.end);const t={status:e.status,insertionTs:e.insertionTs,chunkSize:e.chunkSize,splitted:!0,start:d.end,end:e.end,precizeStart:e.precizeStart&&e.precizeEnd&&d.precizeEnd,precizeEnd:e.precizeEnd,bufferedStart:void 0,bufferedEnd:e.end,infos:e.infos};return e.end=d.start,e.splitted=!0,e.bufferedEnd=void 0,e.precizeEnd=e.precizeEnd&&d.precizeStart,c.splice(h+1,0,d),void c.splice(h+2,0,t)}}}const f=this._inventory[0];if(void 0===f)return j.debug("SI: first segment pushed",u,a,o),void this._inventory.push(d);if(!(f.start>=o)){if(f.end<=o){j.debug("SI: Segment pushed starts before and completely recovers the previous first one",u,a,o,f.start,f.end),this._inventory.splice(0,1,d);while(c.length>1&&c[1].start<d.end){if(c[1].end>d.end)return j.debug("SI: Segment pushed updates the start of the next one",u,d.end,c[1].start),c[1].start=d.end,c[1].bufferedStart=void 0,void(c[1].precizeStart=d.precizeEnd);j.debug("SI: Segment pushed removes the next one",u,a,o,c[1].start,c[1].end),c.splice(1,1)}return}return j.debug("SI: Segment pushed start of the next one",u,a,o,f.start,f.end),f.start=o,f.bufferedStart=void 0,f.precizeStart=d.precizeEnd,void this._inventory.splice(0,0,d)}j.debug("SI: Segment pushed comes before all previous ones",u,a,o,f.start),this._inventory.splice(0,0,d)}completeSegment(e){if(e.segment.isInit)return;const t=this._inventory,n=[];for(let i=0;i<t.length;i++)if(Tn(t[i].infos,e)){let r=!1;n.length>0&&(r=!0,1===n.length&&(j.warn("SI: Completed Segment is splitted.",e.segment.id,e.segment.time,e.segment.end),n[0].splitted=!0));const a=i;let o=t[i].chunkSize;i+=1;while(i<t.length&&Tn(t[i].infos,e)){const e=t[i].chunkSize;void 0!==o&&void 0!==e&&(o+=e),i++}const s=i-1,l=s-a,u=t[s].end,c=t[s].bufferedEnd;l>0&&(this._inventory.splice(a+1,l),i-=l),0===this._inventory[a].status&&(this._inventory[a].status=1),this._inventory[a].chunkSize=o,this._inventory[a].end=u,this._inventory[a].bufferedEnd=c,this._inventory[a].splitted=r,n.push(this._inventory[a])}if(0===n.length)j.warn("SI: Completed Segment not found",e.segment.id,e.segment.time);else for(const i of n)void 0!==i.bufferedStart&&void 0!==i.bufferedEnd?2!==i.status&&this._bufferedHistory.addBufferedSegment(i.infos,{start:i.bufferedStart,end:i.bufferedEnd}):j.debug("SI: buffered range not known after sync. Skipping history.",i.start,i.end)}getInventory(){return this._inventory}getHistoryFor(e){return this._bufferedHistory.getHistoryFor(e)}}function Vn(e){if(void 0===e.bufferedStart||1!==e.status)return!1;const{start:t,end:n}=e,i=n-t,{MAX_MANIFEST_BUFFERED_START_END_DIFFERENCE:r,MAX_MANIFEST_BUFFERED_DURATION_DIFFERENCE:a}=O.getCurrent();return Math.abs(t-e.bufferedStart)<=r&&(void 0===e.bufferedEnd||e.bufferedEnd>e.bufferedStart&&Math.abs(e.bufferedEnd-e.bufferedStart-i)<=Math.min(a,i/3))}function Hn(e){if(void 0===e.bufferedEnd||!e.infos.segment.complete||1!==e.status)return!1;const{start:t,end:n}=e,i=n-t,{MAX_MANIFEST_BUFFERED_START_END_DIFFERENCE:r,MAX_MANIFEST_BUFFERED_DURATION_DIFFERENCE:a}=O.getCurrent();return Math.abs(n-e.bufferedEnd)<=r&&void 0!==e.bufferedStart&&e.bufferedEnd>e.bufferedStart&&Math.abs(e.bufferedEnd-e.bufferedStart-i)<=Math.min(a,i/3)}function Kn(e,t,n,i){const{MAX_MANIFEST_BUFFERED_START_END_DIFFERENCE:r,MISSING_DATA_TRIGGER_SYNC_DELAY:a,SEGMENT_SYNCHRONIZATION_DELAY:o}=O.getCurrent();if(void 0!==e.bufferedStart)e.bufferedStart<t&&(j.debug("SI: Segment partially GCed at the start",i,e.bufferedStart,t),e.bufferedStart=t),!e.precizeStart&&Vn(e)&&(e.start=e.bufferedStart,e.precizeStart=!0);else if(e.precizeStart)j.debug("SI: buffered start is precize start",i,e.start),e.bufferedStart=e.start;else if(null!==n&&n.end>t&&(n.precizeEnd||e.start-n.end<=r))j.debug("SI: buffered start is end of previous segment",i,t,e.start,n.end),e.bufferedStart=n.end,Vn(e)&&(e.start=n.end,e.precizeStart=!0);else if(e.start-t<=r){const n=Te();if(e.start-t>=a&&n-e.insertionTs<o)return void j.debug("SI: Ignored bufferedStart synchronization",i,t,e.start,n-e.insertionTs);j.debug("SI: found true buffered start",i,t,e.start),e.bufferedStart=t,Vn(e)&&(e.start=t,e.precizeStart=!0)}else if(t<e.start)j.debug("SI: range start too far from expected start",i,t,e.start),e.bufferedStart=e.start;else{const n=Te();if(e.start-t>=a&&n-e.insertionTs<o)return void j.debug("SI: Ignored bufferedStart synchronization",i,t,e.start,n-e.insertionTs);j.debug("SI: Segment appears immediately garbage collected at the start",i,t,e.start),e.bufferedStart=t}}function zn(e,t,n){const{MAX_MANIFEST_BUFFERED_START_END_DIFFERENCE:i,MISSING_DATA_TRIGGER_SYNC_DELAY:r,SEGMENT_SYNCHRONIZATION_DELAY:a}=O.getCurrent();if(void 0!==e.bufferedEnd)e.bufferedEnd>t&&(j.debug("SI: Segment partially GCed at the end",n,e.bufferedEnd,t),e.bufferedEnd=t),!e.precizeEnd&&t-e.end<=i&&Hn(e)&&(e.precizeEnd=!0,e.end=t);else if(e.precizeEnd)j.debug("SI: buffered end is precize end",n,e.end),e.bufferedEnd=e.end;else if(t-e.end<=i||!e.infos.segment.complete){const i=Te();if(t-e.end>=r&&i-e.insertionTs<a)return void j.debug("SI: Ignored bufferedEnd synchronization",n,t,e.end,i-e.insertionTs);j.debug("SI: found true buffered end",n,t,e.end),e.bufferedEnd=t,Hn(e)&&(e.end=t,e.precizeEnd=!0)}else if(t>e.end)j.debug("SI: range end too far from expected end",n,t,e.end),e.bufferedEnd=e.end;else{const i=Te();if(t-e.end>=r&&i-e.insertionTs<a)return void j.debug("SI: Ignored bufferedEnd synchronization",n,t,e.end,i-e.insertionTs);j.debug("SI: Segment appears immediately garbage collected at the end",n,e.bufferedEnd,t),e.bufferedEnd=t}}function Zn(e){const t=1/60,n={},i=[];let r=null,a=null;function o(e){const t=String.fromCharCode(i.length+65);return i.push({letter:t,periodId:e.period.id,representationId:e.representation.id,bitrate:e.representation.bitrate}),t}let s="";for(let l=0;l<e.length;l++){const i=e[l];if(void 0!==i.bufferedStart&&void 0!==i.bufferedEnd){const e=i.infos.period.id,l=i.infos.representation.id,u=n[e];let c;void 0===u?(c=o(i.infos),n[e]={[l]:c}):void 0===u[l]?(c=o(i.infos),u[l]=c):c=u[l],null===r?s+=`${i.bufferedStart.toFixed(2)}|${c}|`:a===c?r.bufferedEnd+t<i.bufferedStart&&(s+=`${r.bufferedEnd.toFixed(2)} ~ `+`${i.bufferedStart.toFixed(2)}|${c}|`):s+=`${r.bufferedEnd.toFixed(2)} ~ `+`${i.bufferedStart.toFixed(2)}|${c}|`,r=i,a=c}}return null!==r&&(s+=String(r.end.toFixed(2))),i.forEach(e=>{var t;s+=`\n[${e.letter}] `+`P: ${e.periodId} || R: ${e.representationId}`+`(${null!==(t=e.bitrate)&&void 0!==t?t:"unknown bitrate"})`}),s}var qn,Yn=jn;class Wn{constructor(){this._segmentInventory=new Yn}synchronizeInventory(e){this._segmentInventory.synchronizeBuffered(e)}getLastKnownInventory(){return this._segmentInventory.getInventory()}getSegmentHistory(e){return this._segmentInventory.getHistoryFor(e)}}(function(e){e[e["Push"]=0]="Push",e[e["Remove"]=1]="Remove",e[e["SignalSegmentComplete"]=2]="SignalSegmentComplete"})(qn||(qn={}));class $n extends Wn{constructor(e,t,n){super(),j.info("AVSB: calling `mediaSource.addSourceBuffer`",t);const i=n.addSourceBuffer(e,t);this.bufferType=e,this._sourceBuffer=i,this._lastInitSegmentUniqueId=null,this.codec=t,this._initSegmentsMap=new Map,this._pendingOperations=[]}declareInitSegment(e,t){Xn(t),this._initSegmentsMap.set(e,t)}freeInitSegment(e){this._initSegmentsMap.delete(e)}async pushChunk(e){Xn(e.data.chunk),j.debug("AVSB: receiving order to push data to the SourceBuffer",this.bufferType,Sn(e.inventoryInfos));const t=this._getActualDataToPush(e.data);0===t.length&&t.push(new Uint8Array);const n=Promise.all(t.map(t=>{const{codec:n,timestampOffset:i,appendWindow:r}=e.data;return j.debug("AVSB: pushing segment",this.bufferType,Sn(e.inventoryInfos)),this._sourceBuffer.appendBuffer(t,{codec:n,timestampOffset:i,appendWindow:r})}));let i;this._addToOperationQueue(n,{type:qn.Push,value:e});try{i=await n}catch(t){throw this._segmentInventory.insertChunk(e.inventoryInfos,!1,Te()),t}null!==e.inventoryInfos&&this._segmentInventory.insertChunk(e.inventoryInfos,!0,Te());const r=i[i.length-1];return this._segmentInventory.synchronizeBuffered(r),r}async removeBuffer(e,t){j.debug("AVSB: receiving order to remove data from the SourceBuffer",this.bufferType,e,t);const n=this._sourceBuffer.remove(e,t);this._addToOperationQueue(n,{type:qn.Remove,value:{start:e,end:t}});const i=await n;return this._segmentInventory.synchronizeBuffered(i),i}async signalSegmentComplete(e){if(this._pendingOperations.length>0){const{promise:t}=this._pendingOperations[this._pendingOperations.length-1];this._addToOperationQueue(t,{type:qn.SignalSegmentComplete,value:e});try{await t}catch(e){}}this._segmentInventory.completeSegment(e)}getPendingOperations(){return this._pendingOperations.map(e=>e.operation)}dispose(){try{j.debug("AVSB: Calling `dispose` on the SourceBufferInterface"),this._sourceBuffer.dispose()}catch(e){j.debug(`AVSB: Failed to dispose a ${this.bufferType} SourceBufferInterface:`,e instanceof Error?e:"")}}_getActualDataToPush(e){const t=[];if(null!==e.initSegmentUniqueId&&!this._isLastInitSegment(e.initSegmentUniqueId)){let n=this._initSegmentsMap.get(e.initSegmentUniqueId);if(void 0===n)throw new Error("Invalid initialization segment uniqueId");const i=new ArrayBuffer(n.byteLength),r=new Uint8Array(i);r.set(n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer)),n=r,t.push(n),this._lastInitSegmentUniqueId=e.initSegmentUniqueId}return null!==e.chunk&&t.push(e.chunk),t}_isLastInitSegment(e){return null!==this._lastInitSegmentUniqueId&&this._lastInitSegmentUniqueId===e}_addToOperationQueue(e,t){const n={operation:t,promise:e};this._pendingOperations.push(n);const i=()=>{const e=this._pendingOperations.indexOf(n);e>=0&&this._pendingOperations.splice(e,1)};e.then(i,i)}}function Xn(e){}var Qn=$n;class Jn extends Wn{constructor(e){j.debug("HTSB: Creating TextSegmentSink"),super(),this.bufferType="text",this._sender=e,this._pendingOperations=[],this._sender.reset()}declareInitSegment(e){j.warn("HTSB: Declaring initialization segment for  Text SegmentSink",e)}freeInitSegment(e){j.warn("HTSB: Freeing initialization segment for  Text SegmentSink",e)}async pushChunk(e){const{data:t}=e;ei(t.chunk);const n=this._sender.pushTextData(Object.assign(Object.assign({},t),{chunk:t.chunk}));this._addToOperationQueue(n,{type:qn.Push,value:e});const i=await n;return null!==e.inventoryInfos&&this._segmentInventory.insertChunk(e.inventoryInfos,!0,Te()),this._segmentInventory.synchronizeBuffered(i),i}async removeBuffer(e,t){const n=this._sender.remove(e,t);this._addToOperationQueue(n,{type:qn.Remove,value:{start:e,end:t}});const i=await n;return this._segmentInventory.synchronizeBuffered(i),i}async signalSegmentComplete(e){if(this._pendingOperations.length>0){const{promise:t}=this._pendingOperations[this._pendingOperations.length-1];this._addToOperationQueue(t,{type:qn.SignalSegmentComplete,value:e});try{await t}catch(e){}}this._segmentInventory.completeSegment(e)}getPendingOperations(){return this._pendingOperations.map(e=>e.operation)}dispose(){j.debug("HTSB: Disposing TextSegmentSink"),this._sender.reset()}_addToOperationQueue(e,t){const n={operation:t,promise:e};this._pendingOperations.push(n);const i=()=>{const e=this._pendingOperations.indexOf(n);e>=0&&this._pendingOperations.splice(e,1)};e.then(i,i)}}function ei(e){}var ti=Jn;const ni=["audio","video","text"];class ii{static isNative(e){return ri(e)}constructor(e,t,n){this._mediaSource=e,this._textInterface=n,this._hasVideo=t,this._initializedSegmentSinks={},this._onNativeBufferAddedOrDisabled=[]}getBufferTypes(){const e=this.getNativeBufferTypes();return null!==this._textInterface&&e.push("text"),e}getNativeBufferTypes(){return this._hasVideo?["video","audio"]:["audio"]}getStatus(e){const t=this._initializedSegmentSinks[e];return void 0===t?{type:"uninitialized"}:null===t?{type:"disabled"}:{type:"initialized",value:t}}waitForUsableBuffers(e){return this._areNativeBuffersUsable()?Promise.resolve():un(e,e=>{let t;const n=()=>{const e=this._onNativeBufferAddedOrDisabled.indexOf(t);e>=0&&this._onNativeBufferAddedOrDisabled.splice(e,1)};return t=(()=>{this._areNativeBuffersUsable()&&(n(),e())}),this._onNativeBufferAddedOrDisabled.push(t),n})}disableSegmentSink(e){const t=this._initializedSegmentSinks[e];if(null!==t){if(void 0!==t)throw new Error("Cannot disable an active SegmentSink.");this._initializedSegmentSinks[e]=null,ii.isNative(e)&&this._onNativeBufferAddedOrDisabled.forEach(e=>e())}else j.warn(`SBS: The ${e} SegmentSink was already disabled.`)}createSegmentSink(e,t){const n=this._initializedSegmentSinks[e];if(ri(e)){if(!r(n))return n instanceof Qn&&n.codec!==t?j.warn("SB: Reusing native SegmentSink with codec",n.codec,"for codec",t):j.info("SB: Reusing native SegmentSink with codec",t),n;j.info("SB: Adding native SegmentSink with codec",t);const i="audio"===e?"audio":"video",a=new Qn(i,t,this._mediaSource);return this._initializedSegmentSinks[e]=a,this._onNativeBufferAddedOrDisabled.forEach(e=>e()),a}if(!r(n))return j.info("SB: Reusing a previous custom SegmentSink for the type",e),n;let i;if("text"===e){if(j.info("SB: Creating a new text SegmentSink"),null===this._textInterface)throw new Error("HTML Text track feature not activated");return i=new ti(this._textInterface),this._initializedSegmentSinks.text=i,i}throw j.error("SB: Unknown buffer type:",e),new ut("BUFFER_TYPE_UNKNOWN","The player wants to create a SegmentSink of an unknown type.")}disposeSegmentSink(e){const t=this._initializedSegmentSinks[e];r(t)?j.warn("SB: Trying to dispose a SegmentSink that does not exist"):(j.info("SB: Aborting SegmentSink",e),t.dispose(),delete this._initializedSegmentSinks[e])}disposeAll(){ni.forEach(e=>{"initialized"===this.getStatus(e).type&&this.disposeSegmentSink(e)})}_areNativeBuffersUsable(){const e=this.getNativeBufferTypes(),t=e.some(e=>void 0===this._initializedSegmentSinks[e]);if(t)return!1;const n=e.every(e=>null===this._initializedSegmentSinks[e]);return!n}createSegmentSinkMetricsForType(e){var t,n;return{bufferType:e,codec:null===(t=this._initializedSegmentSinks[e])||void 0===t?void 0:t.codec,segmentInventory:null===(n=this._initializedSegmentSinks[e])||void 0===n?void 0:n.getLastKnownInventory().map(e=>Object.assign(Object.assign({},e),{infos:ai(e.infos)}))}}getSegmentSinksMetrics(){return{segmentSinks:{audio:this.createSegmentSinkMetricsForType("audio"),video:this.createSegmentSinkMetricsForType("video"),text:this.createSegmentSinkMetricsForType("text")}}}}function ri(e){return"audio"===e||"video"===e}function ai(e){return{adaptation:e.adaptation.getMetadataSnapshot(),period:e.period.getMetadataSnapshot(),representation:e.representation.getMetadataSnapshot()}}var oi=ii;class si{constructor(e){this._weakMap=new WeakMap,this._fn=e}get(e){const t=this._weakMap.get(e);if(void 0===t){const t=this._fn(e);return this._weakMap.set(e,t),t}return t}destroy(e){this._weakMap.delete(e)}}function li({segmentSink:e,playbackObserver:t,maxBufferBehind:n,maxBufferAhead:i},r){let a,o=[];function s(){null!==o&&ui(e,a,o,n.getValue(),i.getValue(),r).catch(e=>{const t=e instanceof Error?e.message:"Unknown error";j.error("Could not run BufferGarbageCollector:",t)})}t.listen(t=>{a=t.position.getWanted(),o=t.buffered[e.bufferType],s()},{includeLastObservation:!0,clearSignal:r}),n.onUpdate(s,{clearSignal:r}),i.onUpdate(s,{clearSignal:r}),s()}async function ui(e,t,n,i,a,o){if(!isFinite(i)&&!isFinite(a))return Promise.resolve();const s=[],{innerRange:l,outerRanges:u}=te(n,t),c=()=>{if(isFinite(i)){for(const e of u)t-i>=e.end?s.push(e):t>=e.end&&t-i>e.start&&t-i<e.end&&s.push({start:e.start,end:t-i});r(l)||t-i>l.start&&s.push({start:l.start,end:t-i})}},d=()=>{if(isFinite(a)){for(const e of u)t+a<=e.start?s.push(e):t<=e.start&&t+a<e.end&&t+a>e.start&&s.push({start:t+a,end:e.end});r(l)||t+a<l.end&&s.push({start:t+a,end:l.end})}};c(),d();for(const r of s)if(r.start<r.end){if(j.debug("GC: cleaning range from SegmentSink",r.start,r.end),null!==o.cancellationError)throw o.cancellationError;await e.removeBuffer(r.start,r.end)}}class ci extends a{constructor(e,t,n,i){super(),this._content=e,this._currentCanceller=null,this._downloadQueue=t,this._initSegmentRequest=null,this._mediaSegmentRequest=null,this._segmentFetcher=n,this._initSegmentInfoRef=new de(void 0),this._mediaSegmentAwaitingInitMetadata=null,i||this._initSegmentInfoRef.setValue(null)}getRequestedInitSegment(){return null===this._initSegmentRequest?null:this._initSegmentRequest.segment}getRequestedMediaSegment(){return null===this._mediaSegmentRequest?null:this._mediaSegmentRequest.segment}start(){null===this._currentCanceller&&(this._currentCanceller=new me,this._downloadQueue.onUpdate(e=>{const{segmentQueue:t}=e;if(t.length>0&&t[0].segment.id===this._mediaSegmentAwaitingInitMetadata)return;const n=this._mediaSegmentRequest;if(0===t.length){if(null===n)return;return j.debug("Stream: no more media segment to request. Cancelling queue.",this._content.adaptation.type),void this._restartMediaSegmentDownloadingQueue()}if(null===n)return j.debug("Stream: Media segments now need to be requested. Starting queue.",this._content.adaptation.type,t.length),void this._restartMediaSegmentDownloadingQueue();{const e=t[0];return n.segment.id!==e.segment.id?(j.debug("Stream: Next media segment changed, cancelling previous",this._content.adaptation.type),void this._restartMediaSegmentDownloadingQueue()):void(n.priority!==e.priority&&(j.debug("Stream: Priority of next media segment changed, updating",this._content.adaptation.type,n.priority,e.priority),this._segmentFetcher.updatePriority(n.request,e.priority)))}},{emitCurrentValue:!0,clearSignal:this._currentCanceller.signal}),this._downloadQueue.onUpdate(e=>{var t;const n=this._initSegmentRequest;null===e.initSegment||null===n?(null===(t=e.initSegment)||void 0===t?void 0:t.segment.id)!==(null===n||void 0===n?void 0:n.segment.id)&&(null===e.initSegment&&j.debug("Stream: no more init segment to request. Cancelling queue.",this._content.adaptation.type),this._restartInitSegmentDownloadingQueue(e.initSegment)):e.initSegment.priority!==n.priority&&this._segmentFetcher.updatePriority(n.request,e.initSegment.priority)},{emitCurrentValue:!0,clearSignal:this._currentCanceller.signal}))}stop(){var e;null===(e=this._currentCanceller)||void 0===e||e.cancel(),this._currentCanceller=null}_restartMediaSegmentDownloadingQueue(){null!==this._mediaSegmentRequest&&this._mediaSegmentRequest.canceller.cancel();const{segmentQueue:e}=this._downloadQueue.getValue(),t=e[0],n=e=>{if(null!==this._currentCanceller&&this._currentCanceller.isUsed())return void(this._mediaSegmentRequest=null);if(void 0===e)return this._mediaSegmentRequest=null,void this.trigger("emptyQueue",null);const t=new me,i=null===this._currentCanceller?F:t.linkToSignal(this._currentCanceller.signal),{segment:r,priority:a}=e,o=k({segment:r},this._content);let s=!1,l=!1;t.signal.register(()=>{this._mediaSegmentRequest=null,s||(this._mediaSegmentAwaitingInitMetadata===r.id&&(this._mediaSegmentAwaitingInitMetadata=null),s=!0,l=!1)});const u=e=>{he("media"===e.segmentType,"Should have loaded a media segment."),this.trigger("parsedMediaSegment",k({},e,{segment:r}))},c=()=>{const e=this._downloadQueue.getValue().segmentQueue;if(0===e.length)return s=!0,void this.trigger("emptyQueue",null);e[0].segment.id===r.id&&e.shift(),s=!0,n(e[0])},d=this._segmentFetcher.createRequest(o,a,{onRetry:e=>{this.trigger("requestRetry",{segment:r,error:e})},beforeInterrupted(){j.info("Stream: segment request interrupted temporarly.",r.id,r.time)},onChunk:e=>{const n=this._initSegmentInfoRef.getValue();void 0!==n?u(e(null!==n&&void 0!==n?n:void 0)):(l=!0,this._initSegmentInfoRef.waitUntilDefined(t=>{u(e(null!==t&&void 0!==t?t:void 0))},{clearSignal:t.signal}))},onAllChunksReceived:()=>{l?(this._mediaSegmentAwaitingInitMetadata=r.id,this._initSegmentInfoRef.waitUntilDefined(()=>{this._mediaSegmentAwaitingInitMetadata=null,l=!1,this.trigger("fullyLoadedSegment",r)},{clearSignal:t.signal})):this.trigger("fullyLoadedSegment",r)},beforeEnded:()=>{i(),this._mediaSegmentRequest=null,l?this._initSegmentInfoRef.waitUntilDefined(c,{clearSignal:t.signal}):c()}},t.signal);d.catch(e=>{i(),s||(s=!0,this.stop(),this.trigger("error",e))}),this._mediaSegmentRequest={segment:r,priority:a,request:d,canceller:t}};n(t)}_restartInitSegmentDownloadingQueue(e){if(null!==this._currentCanceller&&this._currentCanceller.isUsed())return;if(null!==this._initSegmentRequest&&this._initSegmentRequest.canceller.cancel(),null===e)return;const t=new me,n=null===this._currentCanceller?F:t.linkToSignal(this._currentCanceller.signal),{segment:i,priority:r}=e,a=k({segment:i},this._content);let o=!1;const s=this._segmentFetcher.createRequest(a,r,{onRetry:e=>{this.trigger("requestRetry",{segment:i,error:e})},beforeInterrupted:()=>{j.info("Stream: init segment request interrupted temporarly.",i.id)},beforeEnded:()=>{n(),this._initSegmentRequest=null,o=!0},onChunk:e=>{var t;const n=e(void 0);he("init"===n.segmentType,"Should have loaded an init segment."),this.trigger("parsedInitSegment",k({},n,{segment:i})),"init"===n.segmentType&&this._initSegmentInfoRef.setValue(null!==(t=n.initTimescale)&&void 0!==t?t:null)},onAllChunksReceived:()=>{this.trigger("fullyLoadedSegment",i)}},t.signal);s.catch(e=>{n(),o||(o=!0,this.stop(),this.trigger("error",e))}),t.signal.register(()=>{this._initSegmentRequest=null,o||(o=!0)}),this._initSegmentRequest={segment:i,priority:r,request:s,canceller:t}}}function di(e,t,n,i,r){const{period:a,adaptation:o,representation:s}=e,l=fi(r,t);if(null===l){if(null===n){if(i&&void 0!==a.end&&t.end>=a.end)return{start:void 0,end:null};const e=s.index.checkDiscontinuity(t.start);if(null!==e)return{start:void 0,end:e}}return null}const u=r[l];if(void 0!==u.bufferedStart&&u.bufferedStart>t.start&&(null===n||u.infos.segment.end<=n)){const e=u.bufferedStart;return i||!1===s.index.awaitSegmentBetween(t.start,e)?(j.debug("RS: current discontinuity encountered",o.type,u.bufferedStart),{start:void 0,end:e}):null}const c=hi(r,t,l+1);if(null!==c){const e=r[c-1],t=r[c];if(null===n||t.infos.segment.end<=n){if(!i&&!1!==s.index.awaitSegmentBetween(e.infos.segment.end,t.infos.segment.time))return null;const n=e.bufferedEnd,r=t.bufferedStart;return j.debug("RS: future discontinuity encountered",o.type,n,r),{start:n,end:r}}}if(null===n){if(i&&void 0!==a.end){if(t.end<a.end)return null;const e=pi(r,a.end);if(null!==e){const t=r[e];if(void 0!==t.bufferedEnd&&t.bufferedEnd<a.end)return j.debug("RS: discontinuity encountered at the end of the current period",o.type,t.bufferedEnd,a.end),{start:t.bufferedEnd,end:null}}}if(void 0!==a.end&&t.end>=a.end)return null;for(let e=r.length-1;e>=0;e--){const n=r[e];if(void 0===n.bufferedStart)break;if(n.bufferedStart<t.end){if(void 0!==n.bufferedEnd&&n.bufferedEnd<t.end){const e=s.index.checkDiscontinuity(t.end);if(null!==e)return{start:n.bufferedEnd,end:e}}return null}}}return null}function fi(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(void 0===i.bufferedStart||void 0===i.bufferedEnd||i.bufferedStart>=t.end)return null;if(i.bufferedEnd>t.start)return n}return null}function hi(e,t,n){if(n<=0)return j.error("RS: Asked to check a discontinuity before the first chunk."),null;for(let i=n;i<e.length;i++){const n=e[i],r=e[i-1];if(void 0===n.bufferedStart||void 0===r.bufferedEnd||n.bufferedStart>=t.end)return null;if(n.bufferedStart-r.bufferedEnd>0)return i}return null}function pi(e,t){for(let n=e.length-1;n>=0;n--){const i=e[n];if(void 0===i.bufferedStart)return null;if(i.bufferedStart<t)return n}return null}function gi({bufferedSegments:e,content:t,currentPlaybackTime:n,fastSwitchThreshold:i,getBufferedHistory:r,neededRange:a,segmentsBeingPushed:o,maxBufferSize:s}){const{adaptation:l,representation:u}=t;let c=mi(e,o,s);const d=u.index.getSegments(a.start,a.end-a.start),f=e.filter(e=>!yi(e.infos,t,n,i)),h=wi(f,a,r),{MINIMUM_SEGMENT_SIZE:p,MIN_BUFFER_AHEAD:g}=O.getCurrent();let m=!1;const v=Math.min(1/60,p);let y=!1;const _=[],b=d.filter(e=>{const s=k({segment:e},t);if(o.length>0){const e=o.some(e=>Tn(s,e));if(e)return!1}const{duration:d,time:f,end:b}=e;if(e.isInit)return!0;if(m)return _.push(e),!1;if(e.complete&&d<p)return!1;if(o.length>0){const e=o.some(e=>{if(e.period.id!==t.period.id||e.adaptation.id!==t.adaptation.id)return!1;const{segment:r}=e;if(r.time-v>f)return!1;if(r.complete){if(r.end+v<b)return!1}else if(Math.abs(f-r.time)>f)return!1;return!yi(e,s,n,i)});if(e)return!1}for(let n=0;n<h.length;n++){const e=h[n],i=e.infos.period.id===t.period.id;if(1===e.status&&i){const t=e.infos.segment;if(f-t.time>-v)if(t.complete){if(t.end-b>-v)return!1}else if(Math.abs(f-t.time)<v)return!1}}const E=d*t.representation.bitrate;if(c-E<0&&(y=!0,f>a.start+g))return m=!0,_.push(e),!1;const T=r(s);if(T.length>1){const t=T[T.length-1],n=T[T.length-2];if(null===t.buffered&&null===n.buffered)return j.warn("Stream: Segment GCed multiple times in a row, ignoring it.","If this happens a lot and lead to unpleasant experience, please  check your device's available memory. If it's low when this message is emitted, you might want to update the RxPlayer's settings (`maxBufferAhead`, `maxVideoBufferSize` etc.) so less memory is used by regular media data buffering."+l.type,u.id,e.time),!1}for(let t=0;t<h.length;t++){const e=h[t];if(e.end+v>f){const n=e.start>f+v||vi(h,t).end<b-v;return n&&(c-=E),n}}return c-=E,!0});return{segmentsToLoad:b,segmentsOnHold:_,isBufferFull:y}}function mi(e,t,n){let i=8e3*n;return i-=t.reduce((e,t)=>{const{bitrate:n}=t.representation,{duration:i}=t.segment;return e+n*i},0),e.reduce((e,t)=>{return void 0!==t.chunkSize?e-8*t.chunkSize:e},i)}function vi(e,t){let n=t+1;const{MINIMUM_SEGMENT_SIZE:i}=O.getCurrent(),r=Math.min(1/60,i);while(n<e.length-1&&e[n-1].end+r>e[n].start)n++;return n--,e[n]}function yi(e,t,n,i){const{CONTENT_REPLACEMENT_PADDING:r}=O.getCurrent();if(e.period.id!==t.period.id)return!1;const{segment:a}=e;return!(a.time<n+r)&&(e.adaptation.id!==t.adaptation.id||_i(e.representation,t.representation,i))}function _i(e,t,n){const i=e.bitrate,{BITRATE_REBUFFERING_RATIO:r}=O.getCurrent();if(void 0===n){const e=i*r;return t.bitrate>e}return i<n&&t.bitrate>i}function bi(e,t,n){const{MAX_TIME_MISSING_FROM_COMPLETE_SEGMENT:i}=O.getCurrent();return void 0!==e.bufferedStart&&(!(null!==t&&void 0!==t.bufferedEnd&&e.bufferedStart-t.bufferedEnd<.1)&&(n<e.bufferedStart&&e.bufferedStart-e.start>i&&(j.info("Stream: The start of the wanted segment has been garbage collected",e.start,e.bufferedStart),!0)))}function Ei(e,t,n){const{MAX_TIME_MISSING_FROM_COMPLETE_SEGMENT:i}=O.getCurrent();return void 0!==e.bufferedEnd&&(!(null!==t&&void 0!==t.bufferedStart&&t.bufferedStart-e.bufferedEnd<.1)&&(n>e.bufferedEnd&&e.end-e.bufferedEnd>i&&(j.info("Stream: The end of the wanted segment has been garbage collected",e.end,e.bufferedEnd),!0)))}function Ti(e,t){var n,i;if(e.length<2)return!0;const r=e[e.length-1],a=null===(n=r.buffered)||void 0===n?void 0:n.start;if(void 0!==t&&void 0!==a&&t-a>.05)return!0;const o=e[e.length-2],s=null===(i=o.buffered)||void 0===i?void 0:i.start;return void 0===s||void 0===a||Math.abs(s-a)>.01}function Si(e,t){var n,i;if(e.length<2)return!0;const r=e[e.length-1],a=null===(n=r.buffered)||void 0===n?void 0:n.end;if(void 0!==t&&void 0!==a&&a-t>.05)return!0;const o=e[e.length-2],s=null===(i=o.buffered)||void 0===i?void 0:i.end;return void 0===s||void 0===a||Math.abs(s-a)>.01}function wi(e,t,n){return e.filter((e,i,r)=>{const a=0===i?null:r[i-1],o=i>=r.length-1?null:r[i+1];let s=null;if(bi(e,a,t.start)){if(s=n(e.infos),Ti(s,e.bufferedStart))return!1;j.debug("Stream: skipping segment gc-ed at the start",e.start,e.bufferedStart)}if(Ei(e,o,t.end)){if(s=null!==s&&void 0!==s?s:n(e.infos),Si(s,e.bufferedEnd))return!1;j.debug("Stream: skipping segment gc-ed at the end",e.end,e.bufferedEnd)}return!0})}function Ai(e,t){const n=e-t,{SEGMENT_PRIORITIES_STEPS:i}=O.getCurrent();for(let r=0;r<i.length;r++)if(n<i[r])return r;return i.length}function Ii(e,t,n,i,r,a,o){var s,l,u;const{representation:c}=e,d=null!==(l=null!==(s=n.getIsPaused())&&void 0!==s?s:n.getReference().getValue().paused.pending)&&void 0!==l?l:n.getReference().getValue().paused.last,f=null!==(u=n.getPlaybackRate())&&void 0!==u?u:n.getReference().getValue().speed;let h=t;(void 0===d||void 0===f||d||f<=0)&&(h-=.1);const p=xi(e,h,r),g=c.index.shouldRefresh(p.start,p.end),m=o.getPendingOperations().filter(e=>e.type===qn.SignalSegmentComplete).map(e=>e.value),v=o.getLastKnownInventory();let y=n.getCurrentTime();void 0===y&&(y=n.getReference().getValue().position.getWanted());const _=o.getSegmentHistory.bind(o),{segmentsToLoad:b,segmentsOnHold:E,isBufferFull:T}=gi({content:e,bufferedSegments:v,currentPlaybackTime:y,fastSwitchThreshold:i,getBufferedHistory:_,neededRange:p,segmentsBeingPushed:m,maxBufferSize:a}),S=b.map(e=>({priority:Ai(e.time,h),segment:e})),w=c.index.isInitialized()&&!c.index.isStillAwaitingFutureSegments()&&p.hasReachedPeriodEnd&&0===S.length&&0===E.length;let A=null;m.length>0&&(A=Math.min(...m.map(e=>e.segment.time))),E.length>0&&(A=null!==A?Math.min(A,E[0].time):E[0].time),S.length>0&&(A=null!==A?Math.min(A,S[0].segment.time):S[0].segment.time);const I=di(e,p,A,w,v);return{imminentDiscontinuity:I,hasFinishedLoading:w,neededSegments:S,isBufferFull:T,shouldRefreshManifest:g}}function xi(e,t,n){var i;let a;const{manifest:o,period:s,representation:l}=e,u=l.index.getLastAvailablePosition(),c=l.index;a=!r(u)&&oi.isNative(e.adaptation.type)&&t>=u&&c.isInitialized()&&!c.isStillAwaitingFutureSegments()&&Ri(o,s,t)?u-1:t-.1;const d=a+n;let f;return f=!(!l.index.isInitialized()||l.index.isStillAwaitingFutureSegments()||void 0===s.end)&&(void 0===u?d>=s.end:null===u||d>=u),{start:Math.max(a,s.start),end:Math.min(d,null!==(i=s.end)&&void 0!==i?i:1/0),hasReachedPeriodEnd:f}}function Ri(e,t,n){var i;const r=e.getPeriodAfter(t);return t.containsTime(n,r)&&e.isLastPeriodKnown&&t.id===(null===(i=e.periods[e.periods.length-1])||void 0===i?void 0:i.id)}class Ci extends Error{constructor(e,t,n){super(t),Object.setPrototypeOf(this,Ci.prototype),this.name="SourceBufferError",this.errorName=e,this.isBufferFull=n}serialize(){return{errorName:this.name,message:this.message,isBufferFull:this.isBufferFull}}toString(){return`${this.errorName}: ${this.message}`}}function Di(e){return new Promise(t=>{setTimeout(t,e)})}async function ki(e,t,n,i,r){try{return await t.pushChunk(n)}catch(a){if(r.isCancelled()&&a instanceof ye)throw a;if(!(a instanceof Ci)||!a.isBufferFull){const e=a instanceof Error?a.toString():"An unknown error happened when pushing content";throw new ut("BUFFER_APPEND_ERROR",e,{tracks:[Lt(n.inventoryInfos.adaptation)]})}const{position:o}=e.getReference().getValue(),s=o.getWanted();try{j.warn("Stream: Running garbage collector");const e=Math.max(s-5,0),a=s+i.getValue()+12;if(await t.removeBuffer(0,e),await t.removeBuffer(a,Number.MAX_VALUE),await Di(200),null!==r.cancellationError)throw r.cancellationError;return await t.pushChunk(n)}catch(e){if(e instanceof ye)throw e;const t=e instanceof Error?e.toString():"Could not clean the buffer";throw new ut("BUFFER_FULL_ERROR",t,{tracks:[Lt(n.inventoryInfos.adaptation)]})}}}async function Mi({playbackObserver:e,content:t,initSegmentUniqueId:n,segment:i,segmentSink:r,bufferGoal:a},o){if(null!==o.cancellationError)throw o.cancellationError;const s=t.representation.getMimeTypeString(),l={initSegmentUniqueId:n,chunk:null,timestampOffset:0,appendWindow:[void 0,void 0],codec:s},u=k({segment:i,chunkSize:void 0,start:0,end:0},t),c=await ki(e,r,{data:l,inventoryInfos:u},a,o);return{content:t,segment:i,buffered:c}}async function Li({playbackObserver:e,bufferGoal:t,content:n,initSegmentUniqueId:i,parsedSegment:r,segment:a,segmentSink:o},s){var l,u;if(null===r.chunkData)return null;if(null!==s.cancellationError)throw s.cancellationError;const{chunkData:c,chunkInfos:d,chunkOffset:f,chunkSize:h,appendWindow:p}=r,g=n.representation.getMimeTypeString(),{APPEND_WINDOW_SECURITIES:m}=O.getCurrent(),v=[void 0!==p[0]?Math.max(0,p[0]-m.START):void 0,void 0!==p[1]?p[1]+m.END:void 0],y={initSegmentUniqueId:i,chunk:c,timestampOffset:f,appendWindow:v,codec:g};let _=null!==(l=null===d||void 0===d?void 0:d.time)&&void 0!==l?l:a.time;const b=null!==(u=null===d||void 0===d?void 0:d.duration)&&void 0!==u?u:a.duration;let E=_+b;void 0!==v[0]&&(_=Math.max(_,v[0])),void 0!==v[1]&&(E=Math.min(E,v[1]));const T=k({segment:a,chunkSize:h,start:_,end:E},n),S=await ki(e,o,{data:y,inventoryInfos:T},t,s);return{content:n,segment:a,buffered:S}}function Pi({content:e,options:t,playbackObserver:n,segmentSink:i,segmentFetcher:r,terminate:a},o,s){const{period:l,adaptation:u,representation:c}=e,{bufferGoal:d,maxBufferSize:f,drmSystemId:h,fastSwitchThreshold:p}=t,g=u.type,m=new me;m.linkToSignal(s);const v=new me;v.linkToSignal(m.signal);const y={segment:c.index.getInitSegment(),uniqueId:null,isLoaded:!1};m.signal.register(()=>{null!==y.uniqueId&&i.freeInitSegment(y.uniqueId)});const _=new de({initSegment:null,segmentQueue:[]},v.signal),b=null!==y.segment;b||(y.isLoaded=!0);let E=!1;if(void 0!==h){const t=c.getEncryptionData(h);if(t.length>0&&t.every(e=>void 0!==e.keyIds)&&(E=!0,o.encryptionDataEncountered(t.map(t=>k({content:e},t))),m.isUsed()))return}const T=new ci(e,_,r,b);return T.addEventListener("error",e=>{v.signal.isCancelled()||(m.cancel(),o.error(e))}),T.addEventListener("parsedInitSegment",w),T.addEventListener("parsedMediaSegment",w),T.addEventListener("emptyQueue",S),T.addEventListener("requestRetry",e=>{if(o.warning(e.error),v.signal.isCancelled())return;const t=e.segment,{index:n}=c;!1===n.isSegmentStillAvailable(t)?S():n.canBeOutOfSyncError(e.error,t)&&o.manifestMightBeOufOfSync()}),T.addEventListener("fullyLoadedSegment",t=>{i.signalSegmentComplete(k({segment:t},e)).catch(A)}),T.start(),v.signal.register(()=>{T.removeEventListener(),T.stop()}),n.listen(S,{includeLastObservation:!1,clearSignal:v.signal}),e.manifest.addEventListener("manifestUpdate",S,v.signal),d.onUpdate(S,{emitCurrentValue:!1,clearSignal:v.signal}),f.onUpdate(S,{emitCurrentValue:!1,clearSignal:v.signal}),a.onUpdate(S,{emitCurrentValue:!1,clearSignal:v.signal}),void S();function S(){if(v.isUsed())return;const t=n.getReference().getValue(),r=t.position.getWanted(),s=Ii(e,r,n,p.getValue(),d.getValue(),f.getValue(),i),{neededSegments:u}=s;let h=null;if(c.index.isInitialized()){if(u.length>0&&!y.isLoaded&&null!==y.segment){const e=u[0].priority;h={segment:y.segment,priority:e}}}else if(null===y.segment)j.warn("Stream: Uninitialized index without an initialization segment");else if(y.isLoaded)j.warn("Stream: Uninitialized index with an already loaded initialization segment");else{const e=t.position.getWanted();h={segment:y.segment,priority:Ai(l.start,e)}}const m=a.getValue();if(null===m)_.setValue({initSegment:h,segmentQueue:u});else{if(m.urgent)return j.debug("Stream: Urgent switch, terminate now.",g),_.setValue({initSegment:null,segmentQueue:[]}),_.finish(),v.cancel(),void o.terminating();{const e=u[0],t=T.getRequestedInitSegment(),n=T.getRequestedMediaSegment(),i=null===n||void 0===e||n.id!==e.segment.id?[]:[e],r=null===t?null:h;if(_.setValue({initSegment:r,segmentQueue:i}),0===i.length&&null===r)return j.debug("Stream: No request left, terminate",g),_.finish(),v.cancel(),void o.terminating()}}if(o.streamStatusUpdate({period:l,position:t.position.getWanted(),bufferType:g,imminentDiscontinuity:s.imminentDiscontinuity,isEmptyStream:!1,hasFinishedLoading:s.hasFinishedLoading,neededSegments:s.neededSegments}),v.signal.isCancelled())return;const{UPTO_CURRENT_POSITION_CLEANUP:b}=O.getCurrent();if(s.isBufferFull){const e=Math.max(0,r-b);e>0&&i.removeBuffer(0,e).catch(A)}s.shouldRefreshManifest&&o.needsManifestRefresh()}function w(t){if(!m.isUsed()){for(const e of t.protectionData)c.addProtectionData(e.initDataType,e.keyId,e.initData);if(!E){const t=c.getAllEncryptionData();if(t.length>0&&(o.encryptionDataEncountered(t.map(t=>k({content:e},t))),E=!0,m.isUsed()))return}if("init"!==t.segmentType){const{inbandEvents:r,predictedSegments:a,needsManifestRefresh:s}=t;if(void 0!==a&&c.index.addPredictedSegments(a,t.segment),!0===s&&(o.needsManifestRefresh(),m.isUsed()))return;if(void 0!==r&&r.length>0&&(o.inbandEvent(r),m.isUsed()))return;const l=y.uniqueId;Li({playbackObserver:n,bufferGoal:d,content:e,initSegmentUniqueId:l,parsedSegment:t,segment:t.segment,segmentSink:i},m.signal).then(e=>{null!==e&&o.addedSegment(e)}).catch(A)}else{if(c.index.isInitialized()||void 0===t.segmentList||c.index.initialize(t.segmentList),y.isLoaded=!0,null!==t.initializationData){const r=c.uniqueId;y.uniqueId=r,i.declareInitSegment(r,t.initializationData),Mi({playbackObserver:n,bufferGoal:d,content:e,initSegmentUniqueId:r,segment:t.segment,segmentData:t.initializationData,segmentSink:i},m.signal).then(e=>{null!==e&&o.addedSegment(e)}).catch(A)}S()}}}function A(e){m.isUsed()&&e instanceof ye||(m.cancel(),o.error(e))}}var Ni=Pi;function Oi(e,t){for(let n=0;n<e.length;n++)if(e[n].infos.period.start>=t.start)return n>0?e[n-1]:null;return e.length>0?e[e.length-1]:null}function Fi(e,t){for(const n of e)if(n.infos.period.start>t.start)return n;return null}function Ui(e,t,n,i,r){var a,o,s,l;if("lazy"===n.switchingMode)return{type:"continue",value:void 0};const u=i.getLastKnownInventory(),c=[];for(const m of u)m.infos.period.id!==e.id||m.infos.adaptation.id===t.id&&gt(n.representationIds,m.infos.representation.id)||re(c,{start:null!==(a=m.bufferedStart)&&void 0!==a?a:m.start,end:null!==(o=m.bufferedEnd)&&void 0!==o?o:m.end});const d=i.getPendingOperations();for(const m of d)if(m.type===qn.Push){const i=m.value.inventoryInfos;if(i.period.id===e.id&&(i.adaptation.id!==t.id||!gt(n.representationIds,i.representation.id))){const e=i.segment.time,t=e+i.segment.duration;re(c,{start:e,end:t})}}if(0===c.length)return{type:"continue",value:void 0};if("reload"===n.switchingMode){const e=r.getReadyState();if(void 0===e||e>1)return{type:"needs-reload",value:void 0}}const f="direct"===n.switchingMode,h=[],p=Oi(u,e);if(null!==p&&(void 0===p.bufferedEnd||e.start-p.bufferedEnd<1)&&h.push({start:0,end:e.start+1}),!f){const{ADAP_REP_SWITCH_BUFFER_PADDINGS:e}=O.getCurrent(),n=t.type,i=null!==(s=e[n].before)&&void 0!==s?s:0,a=null!==(l=e[n].after)&&void 0!==l?l:0;let o=r.getCurrentTime();if(void 0===o){const e=r.getReference().getValue();o=e.position.getPolled()}h.push({start:o-i,end:o+a})}if(void 0!==e.end){const t=Fi(u,e);null!==t&&(void 0===t.bufferedStart||t.bufferedStart-e.end<1)&&h.push({start:e.end-1,end:Number.MAX_VALUE})}const g=se(c,h);return 0===g.length?{type:"continue",value:void 0}:f?{type:"flush-buffer",value:g}:{type:"clean-buffer",value:g}}function Bi({playbackObserver:e,content:t,options:n,representationEstimator:i,segmentSink:r,segmentFetcherCreator:a,wantedBufferAhead:o,maxVideoBufferSize:s},u,c){const{manifest:d,period:f,adaptation:h}=t,p=new me;p.linkToSignal(c);const g=new Map,m=new de(null,p.signal);let v;const y=t.representations.getValue().representationIds,_=t.adaptation.representations.filter(e=>gt(y,e.id)&&!1!==e.decipherable&&!1!==e.isSupported),b=new de(_,p.signal),{estimates:E,callbacks:T}=i({manifest:d,period:f,adaptation:h},m,b,e,p.signal),S=a.createSegmentFetcher(h.type,{onRequestBegin:T.requestBegin,onRequestEnd:T.requestEnd,onProgress:T.requestProgress,onMetrics:T.metrics}),w=new de(0);let A;return E.onUpdate(({bitrate:e,knownStableBitrate:t})=>{n.enableFastSwitching&&w.setValueIfChanged(t),void 0!==e&&e!==v&&(v=e,j.debug(`Stream: new ${h.type} bitrate estimate`,e),u.bitrateEstimateChange({type:h.type,bitrate:e}))},{emitCurrentValue:!0,clearSignal:p.signal}),void t.representations.onUpdate(e=>{void 0!==A&&A.cancel();const n=t.representations.getValue().representationIds,i=t.adaptation.representations.filter(e=>gt(n,e.id));b.setValueIfChanged(i),A=new me,A.linkToSignal(p.signal),I(e,A.signal).catch(e=>{!0===(null===A||void 0===A?void 0:A.isUsed())&&me.isCancellationError(e)||(p.cancel(),u.error(e))})},{clearSignal:p.signal,emitCurrentValue:!0});async function I(t,n){const i=Ui(f,h,t,r,e);switch(i.type){case"continue":break;case"needs-reload":return l(()=>{e.listen(()=>{if(n.isCancelled())return;const{DELTA_POSITION_AFTER_RELOAD:e}=O.getCurrent(),t=e.bitrateSwitch;return u.waitingMediaSourceReload({bufferType:h.type,period:f,timeOffset:t,stayInPeriod:!0})},{includeLastObservation:!0,clearSignal:n})});case"flush-buffer":case"clean-buffer":for(const e of i.value)if(await r.removeBuffer(e.start,e.end),n.isCancelled())return;if("flush-buffer"===i.type&&(u.needsBufferFlush(),n.isCancelled()))return;break;default:ge(i)}x(n)}function x(e){const t=new me;t.linkToSignal(e);const{representation:n}=E.getValue();if(null===n)return;const i=new de(null,t.signal);E.onUpdate(e=>{if(null!==e.representation&&e.representation.id!==n.id)return e.urgent?(j.info("Stream: urgent Representation switch",h.type),i.setValue({urgent:!0})):(j.info("Stream: slow Representation switch",h.type),i.setValue({urgent:!1}))},{clearSignal:t.signal,emitCurrentValue:!0});const r={type:h.type,adaptation:h,period:f,representation:n};if(m.setValue(n),p.isUsed())return;if(u.representationChange(r),p.isUsed())return;const a={streamStatusUpdate:u.streamStatusUpdate,encryptionDataEncountered:u.encryptionDataEncountered,manifestMightBeOufOfSync:u.manifestMightBeOufOfSync,needsManifestRefresh:u.needsManifestRefresh,inbandEvent:u.inbandEvent,warning:u.warning,error(e){p.cancel(),u.error(e)},addedSegment(e){T.addedSegment(e)},terminating(){if(!t.isUsed())return t.cancel(),x(e)}};R(n,i,a,e)}function R(t,i,a,l){const c=new me;c.linkToSignal(l);const m=ce(o,e=>{return e*C(t)},c.signal),v="video"===h.type?s:new de(1/0);j.info("Stream: changing representation",h.type,t.id,t.bitrate);const y=k({},a,{error(e){var n;const r=ht(e,{defaultCode:"NONE",defaultReason:"Unknown `RepresentationStream` error"});if("BUFFER_FULL_ERROR"!==r.code)a.error(e);else{const e=o.getValue(),s=null!==(n=g.get(t.id))&&void 0!==n?n:1,u=.7*s;if(u<=.05||e*u<=2)throw r;g.set(t.id,u),cn(4e3,p.signal).then(()=>{return R(t,i,a,l)}).catch(F)}},terminating(){c.cancel(),a.terminating()}});Ni({playbackObserver:e,content:{representation:t,adaptation:h,period:f,manifest:d},segmentSink:r,segmentFetcher:S,terminate:i,options:{bufferGoal:m,maxBufferSize:v,drmSystemId:n.drmSystemId,fastSwitchThreshold:w}},y,l),d.addEventListener("manifestUpdate",e=>{for(const n of e.updatedPeriods)if(n.period.id===f.id){for(const e of n.result.updatedAdaptations)if(e.adaptation===h.id)for(const n of e.removedRepresentations)if(n===t.id){if(l.isCancelled())return;return u.waitingMediaSourceReload({bufferType:h.type,period:f,timeOffset:0,stayInPeriod:!0})}}else if(n.period.start>f.start)break},l)}function C(e){const t=g.get(e.id),n=void 0!==t?t:1;return void 0===t&&g.set(e.id,n),n}}var Gi=Bi;function ji(e,t,n){if("function"===typeof String.prototype.startsWith)return e.startsWith(t,n);const i="number"===typeof n?Math.max(n,0):0;return e.substring(i,i+t.length)===t}function Vi(e,t){const[n,...i]=e.split(";"),[r,...a]=t.split(";");if(n!==r)return!1;const o=De(i,e=>ji(e,"codecs=")),s=De(a,e=>ji(e,"codecs="));if(void 0===o||void 0===s)return!1;const l=o.substring(7),u=s.substring(7);return l.split(".")[0]===u.split(".")[0]}var Hi=Vi;function Ki(e,t,n,i,r,a){var o,s,l,u;if(void 0!==e.codec&&"reload"===a.onCodecSwitch&&!zi(n,e.codec))return{type:"needs-reload",value:void 0};const c=e.getLastKnownInventory(),d=[];for(const v of c)v.infos.period.id===t.id&&v.infos.adaptation.id!==n.id&&re(d,{start:null!==(o=v.bufferedStart)&&void 0!==o?o:v.start,end:null!==(s=v.bufferedEnd)&&void 0!==s?s:v.end});const f=e.getPendingOperations();for(const v of f)if(v.type===qn.Push){const e=v.value.inventoryInfos;if(e.period.id===t.id&&e.adaptation.id!==n.id){const t=e.segment.time,n=t+e.segment.duration;re(d,{start:t,end:n})}}if(0===d.length)return{type:"continue",value:void 0};if("reload"===i){const e=r.getReadyState();if(void 0===e||e>1)return{type:"needs-reload",value:void 0}}const h="direct"===i,p=[],g=Oi(c,t);if(null!==g&&(void 0===g.bufferedEnd||t.start-g.bufferedEnd<1)&&p.push({start:0,end:t.start+1}),!h){const e=n.type,{ADAP_REP_SWITCH_BUFFER_PADDINGS:t}=O.getCurrent(),i=null!==(l=t[e].before)&&void 0!==l?l:0,a=null!==(u=t[e].after)&&void 0!==u?u:0;let o=r.getCurrentTime();if(void 0===o){const e=r.getReference().getValue();o=e.position.getPolled()}p.push({start:o-i,end:o+a})}if(void 0!==t.end){const e=Fi(c,t);null!==e&&(void 0===e.bufferedStart||e.bufferedStart-t.end<1)&&p.push({start:t.end-1,end:Number.MAX_VALUE})}const m=se(d,p);return 0===m.length?{type:"continue",value:void 0}:h&&"text"!==n.type?{type:"flush-buffer",value:m}:{type:"clean-buffer",value:m}}function zi(e,t){return e.representations.some(e=>!0===e.isSupported&&!1!==e.decipherable&&Hi(e.getMimeTypeString(),t))}function Zi({bufferType:e,content:t,garbageCollectors:n,playbackObserver:i,representationEstimator:r,segmentFetcherCreator:a,segmentSinksStore:o,options:s,wantedBufferAhead:u,maxVideoBufferSize:c},d,f){const{manifest:h,period:p}=t,g=new de(void 0,f);if(d.periodStreamReady({type:e,manifest:h,period:p,adaptationRef:g}),f.isCancelled())return;let m,v=!0;function y(t,n,l,f){const g=Wi(i,t.type);function m(t){if(!oi.isNative(e)){j.error(`Stream: ${e} Stream crashed. Aborting it.`,t instanceof Error?t:""),o.disposeSegmentSink(e);const n=ht(t,{defaultCode:"NONE",defaultReason:"Unknown `AdaptationStream` error"});if(d.warning(n),f.isCancelled())return;return $i(i,u,e,{period:p},d,f)}j.error(`Stream: ${e} Stream crashed. Stopping playback.`,t instanceof Error?t:""),d.error(t)}Gi({content:{manifest:h,period:p,adaptation:t,representations:n},options:s,playbackObserver:g,representationEstimator:r,segmentSink:l,segmentFetcherCreator:a,wantedBufferAhead:u,maxVideoBufferSize:c},Object.assign(Object.assign({},d),{error:m}),f)}function _(t,n,r){l(()=>{i.listen(()=>{r.isCancelled()||d.waitingMediaSourceReload({bufferType:e,period:p,timeOffset:t,stayInPeriod:n})},{includeLastObservation:!0,clearSignal:r})})}g.onUpdate(t=>{(async()=>{var r;if(void 0===t)return;const a=new me;if(a.linkToSignal(f),null===m||void 0===m||m.cancel(),m=a,null===t){j.info(`Stream: Set no ${e} Adaptation. P:`,p.start);const t=o.getStatus(e);if("initialized"===t.type){if(j.info(`Stream: Clearing previous ${e} SegmentSink`),oi.isNative(e))return _(0,!0,a.signal);{const e=null!==(r=p.end)&&void 0!==r?r:1/0;if(p.start>e)j.warn("Stream: Can't free buffer: period's start is after its end");else if(await t.value.removeBuffer(p.start,e),a.isUsed())return}}else if("uninitialized"===t.type&&(o.disableSegmentSink(e),a.isUsed()))return;if(d.adaptationChange({type:e,adaptation:null,period:p}),a.isUsed())return;return $i(i,u,e,{period:p},d,a.signal)}const l=p.adaptations[e],c=De(null!==l&&void 0!==l?l:[],e=>e.id===t.adaptationId);if(void 0===c)return m.cancel(),void j.warn("Stream: Unfound chosen Adaptation choice",t.adaptationId);const{DELTA_POSITION_AFTER_RELOAD:g}=O.getCurrent();let b,E=!1;if(v)b=0;else if(void 0!==t.relativeResumingPosition)b=t.relativeResumingPosition;else switch(E=!0,e){case"audio":b=g.trackSwitch.audio;break;case"video":b=g.trackSwitch.video;break;default:b=g.trackSwitch.other;break}if(v=!1,oi.isNative(e)&&"disabled"===o.getStatus(e).type)return _(b,!0,a.signal);h.addEventListener("manifestUpdate",e=>{for(const t of e.updatedPeriods)if(t.period.id===p.id){for(const e of t.result.removedAdaptations)if(e.id===c.id)return _(b,!0,a.signal)}else if(t.period.start>p.start)break},m.signal);const{representations:T}=t;if(j.info(`Stream: Updating ${e} adaptation`,`A: ${c.id}`,`P: ${p.start}`),d.adaptationChange({type:e,adaptation:c,period:p}),a.isUsed())return;const S=qi(o,e,c),w=Ki(S,p,c,t.switchingMode,i,s);if("needs-reload"===w.type)return _(b,!0,a.signal);if(await o.waitForUsableBuffers(a.signal),!a.isUsed()){if("flush-buffer"===w.type||"clean-buffer"===w.type){for(const{start:e,end:t}of w.value)if(await S.removeBuffer(e,t),a.isUsed())return;if("flush-buffer"===w.type&&(d.needsBufferFlush({relativeResumingPosition:b,relativePosHasBeenDefaulted:E}),a.isUsed()))return}n.get(S)(a.signal),y(c,T,S,a.signal)}})().catch(e=>{e instanceof ye||(null===m||void 0===m||m.cancel(),d.error(e))})},{clearSignal:f,emitCurrentValue:!0})}function qi(e,t,n){const i=e.getStatus(t);if("initialized"===i.type)return j.info("Stream: Reusing a previous SegmentSink for the type",t),i.value;const r=Yi(n);return e.createSegmentSink(t,r)}function Yi(e){const t=e.representations.filter(e=>{return!0===e.isSupported&&!1!==e.decipherable});if(0===t.length){const t=new ut("NO_PLAYABLE_REPRESENTATION","No Representation in the chosen "+e.type+" Adaptation can be played",{tracks:[Lt(e)]});throw t}return t[0].getMimeTypeString()}function Wi(e,t){return e.deriveReadOnlyObserver(function(e,n){const i=new de(r(),n);return e.onUpdate(a,{clearSignal:n,emitCurrentValue:!1}),i;function r(){const n=e.getValue(),i=n.buffered[t],r=null!==i?ie(i,n.position.getWanted()):0;return k({},n,{bufferGap:r,buffered:i})}function a(){i.setValue(r())}})}function $i(e,t,n,i,r,a){const{period:o}=i;let s=!1;function l(){const i=e.getReference().getValue(),a=t.getValue(),l=i.position.getWanted();void 0!==o.end&&l+a>=o.end&&(j.debug('Stream: full "empty" AdaptationStream',n),s=!0),r.streamStatusUpdate({period:o,bufferType:n,imminentDiscontinuity:null,position:l,isEmptyStream:!0,hasFinishedLoading:s,neededSegments:[]})}t.onUpdate(l,{emitCurrentValue:!1,clearSignal:a}),e.listen(l,{includeLastObservation:!1,clearSignal:a}),l()}var Xi=Zi;function Qi(e,t){if(0===t.length)return[];const n=[],i=e.getLastKnownInventory();for(let r=0;r<i.length;r++){const e=i[r],a=t.some(t=>{return e.infos.period.id===t.period.id&&e.infos.adaptation.id===t.adaptation.id&&e.infos.representation.id===t.representation.id});if(a){const{bufferedStart:t,bufferedEnd:i}=e;if(void 0===t||void 0===i)return j.warn("SO: No buffered start or end found from a segment."),[{start:0,end:Number.MAX_VALUE}];const r=n[n.length-1];void 0!==r&&r.end===t?r.end=i:n.push({start:t,end:i})}}return n}function Ji(e,t,n,i,a,o,s,u){const{manifest:c,initialPeriod:d}=e,{maxBufferAhead:f,maxBufferBehind:h,wantedBufferAhead:p,maxVideoBufferSize:g}=o,{MINIMUM_MAX_BUFFER_AHEAD:m,MAXIMUM_MAX_BUFFER_AHEAD:v,MAXIMUM_MAX_BUFFER_BEHIND:y}=O.getCurrent(),_=new si(e=>{var n,i;const{bufferType:r}=e,a=null!==(n=y[r])&&void 0!==n?n:1/0,o=null!==(i=v[r])&&void 0!==i?i:1/0;return n=>{li({segmentSink:e,playbackObserver:t,maxBufferBehind:ce(h,e=>Math.min(e,a),n),maxBufferAhead:ce(f,e=>{var t;const n=Math.max(e,null!==(t=m[r])&&void 0!==t?t:0);return Math.min(n,o)},n)},n)}});for(const r of i.getBufferTypes())b(r,d);function b(e,n){const a=new Ln((e,t)=>e.start-t.start);let o=!1,d=new me;return d.linkToSignal(u),t.listen(({position:t})=>{var n;const i=t.getWanted();if(!o||!h(i))return;j.info("Stream: Destroying all PeriodStreams due to out of bounds situation",e,i),o=!1;while(a.length()>0){const t=a.get(a.length()-1);a.removeElement(t),s.periodStreamCleared({type:e,manifest:c,period:t})}d.cancel(),d=new me,d.linkToSignal(u);const r=null!==(n=c.getPeriodForTime(i))&&void 0!==n?n:c.getNextPeriod(i);if(void 0===r)return j.warn("Stream: The wanted position is not found in the Manifest."),void(o=!0);f(r)},{clearSignal:u,includeLastObservation:!0}),c.addEventListener("decipherabilityUpdate",e=>{u.isCancelled()||p(e).catch(e=>{u.isCancelled()||(d.cancel(),s.error(e))})},u),f(n);function f(t){const n=Object.assign(Object.assign({},s),{waitingMediaSourceReload(e){const t=a.head();void 0===t||t.id!==e.period.id?s.lockedStream({bufferType:e.bufferType,period:e.period}):s.needsMediaSourceReload({timeOffset:e.timeOffset,minimumPosition:e.stayInPeriod?e.period.start:void 0,maximumPosition:e.stayInPeriod?e.period.end:void 0})},periodStreamReady(e){o=!0,a.add(e.period),s.periodStreamReady(e)},periodStreamCleared(e){a.removeElement(e.period),s.periodStreamCleared(e)},error(e){d.cancel(),s.error(e)}});E(e,t,n,d.signal)}function h(e){const t=a.head(),n=a.last();return void 0===t||void 0===n||(t.start>e||(r(n.end)?1/0:n.end)<e)}async function p(n){const r=i.getStatus(e),h=n.filter(t=>t.adaptation.type===e);if(0===h.length||"initialized"!==r.type||h.every(e=>!0===e.representation.decipherable))return;const p=r.value,g=h.filter(e=>void 0===e.representation.decipherable),m=h.filter(e=>!1===e.representation.decipherable),v=Qi(p,m),y=Qi(p,g);o=!1,j.info("Stream: Destroying all PeriodStreams for decipherability matters",e);while(a.length()>0){const t=a.get(a.length()-1);a.removeElement(t),s.periodStreamCleared({type:e,manifest:c,period:t})}d.cancel(),d=new me,d.linkToSignal(u);for(const{start:e,end:t}of[...v,...y]){if(u.isCancelled())return;if(e<t){if(u.isCancelled())return;await p.removeBuffer(e,t)}}l(()=>{if(u.isCancelled())return;const e=t.getReference().getValue();if(er(e,v)){if(s.needsDecipherabilityFlush(),u.isCancelled())return}else if(er(e,y)&&(s.needsBufferFlush(),u.isCancelled()))return;const n=e.position.getWanted(),i=c.getPeriodForTime(n);void 0!==i?f(i):s.error(new ut("MEDIA_TIME_NOT_FOUND","The wanted position is not found in the Manifest."))})}}function E(e,r,u,d){j.info("Stream: Creating new Stream for",e,r.start);let f=null;const h=new me;h.linkToSignal(d),t.listen(({position:t},n)=>{if(void 0!==r.end&&t.getWanted()>=r.end){const i=c.getPeriodAfter(r);if(r.containsTime(t.getWanted(),i))return;j.info("Stream: Destroying PeriodStream as the current playhead moved above it",e,r.start,t.getWanted(),r.end),n(),u.periodStreamCleared({type:e,manifest:c,period:r}),h.cancel()}},{clearSignal:d,includeLastObservation:!0});const m={bufferType:e,content:{manifest:c,period:r},garbageCollectors:_,maxVideoBufferSize:g,segmentFetcherCreator:a,segmentSinksStore:i,options:o,playbackObserver:t,representationEstimator:n,wantedBufferAhead:p},v=Object.assign(Object.assign({},u),{streamStatusUpdate(t){if(t.hasFinishedLoading){const e=c.getPeriodAfter(r);null!==e&&y(e)}else null!==f&&(j.info("Stream: Destroying next PeriodStream due to current one being active",e,f.period.start),u.periodStreamCleared({type:e,manifest:c,period:f.period}),f.canceller.cancel(),f=null);u.streamStatusUpdate(t)},error(e){null!==f&&(f.canceller.cancel(),f=null),h.cancel(),u.error(e)}});function y(t){if(null!==f){if(f.period.id===t.id)return;j.warn("Stream: Creating next `PeriodStream` while one was already created.",e,t.id,f.period.id),u.periodStreamCleared({type:e,manifest:c,period:f.period}),f.canceller.cancel()}const n=new me;n.linkToSignal(d),f={canceller:n,period:t},E(e,t,u,f.canceller.signal)}function b(t){c.addEventListener("manifestUpdate",n=>{for(const e of n.removedPeriods)if(e.id===r.id){if(c.periods.length>0&&c.periods[0].start<=e.start)return l(()=>{if(!t.isCancelled())return s.needsMediaSourceReload({timeOffset:0,minimumPosition:void 0,maximumPosition:void 0})})}else if(e.start>r.start)break;if(n.addedPeriods.length>0&&null!==f){const t=c.getPeriodAfter(r);null!==t&&f.period.id===t.id||(j.warn("Stream: Destroying next PeriodStream due to new one being added",e,f.period.start),u.periodStreamCleared({type:e,manifest:c,period:f.period}),f.canceller.cancel(),f=null)}},t)}Xi(m,v,h.signal),b(h.signal)}}function er(e,t){if(0===t.length)return!1;const n=e.position.getPolled();return e.speed>=0?t[t.length-1].end>=n-5:t[0].start<=n+5}var tr=Ji,nr=tr;const ir={createSync(e){return{syncValue:e,getValueAsAsync(){return Promise.resolve(e)}}},createAsync(e){let t=null;return e.then(e=>{t=e},F),{syncValue:t,getValueAsAsync(){return e}}}};var rr=ir;const ar=new WeakMap;var or={setState(e,t){ar.set(e,t)},getState(e){const t=ar.get(e);return void 0===t?null:t},clearState(e){ar.set(e,null)}};function sr(e){const t=or.getState(e);return null===t?null:[t.mediaKeySystemAccess.keySystem,t.mediaKeySystemAccess.getConfiguration()]}class lr extends a{}function ur(e,t){const n={audio:null,video:null,text:null};if(null!==t&&(n.text=t.getBufferedRanges()),null===e)return n;const i=De(e.sourceBuffers,e=>"audio"===e.type),r=De(e.sourceBuffers,e=>"video"===e.type),a=null===i||void 0===i?void 0:i.getBuffered();void 0!==a&&(n.audio=a);const o=null===r||void 0===r?void 0:r.getBuffered();return void 0!==o&&(n.video=o),n}function cr(e,{autoPlay:t,initialPlayPerformed:n,manifest:i,mediaSource:r,speed:a,textDisplayer:o},s){return e.deriveReadOnlyObserver(function(e,l){const u=new me;u.linkToSignal(l),u.linkToSignal(s);const c=new de(d(),u.signal);return a.onUpdate(f,{clearSignal:u.signal,emitCurrentValue:!1}),e.onUpdate(f,{clearSignal:u.signal,emitCurrentValue:!1}),c;function d(){const s=e.getValue(),l=a.getValue();return dr(s,i),{maximumPosition:Tt(i),bufferGap:s.bufferGap,position:s.position,buffered:ur(r,o),duration:s.duration,rebuffering:s.rebuffering,freezing:s.freezing,paused:{last:s.paused,pending:fr(n,t)},readyState:s.readyState,speed:l}}function f(){c.setValue(d())}})}function dr(e,t){if(!t.isDynamic||t.isLastPeriodKnown){const n=t.periods[t.periods.length-1];if(void 0!==n&&void 0!==n.end){const t=e.position.getWanted();if(t>=n.start&&t>=n.end-1){const t=e.buffered;(0===t.length||t.end(t.length-1)<e.duration-1)&&e.position.forceWantedPosition(n.end-1)}}}}function fr(e,t){return e.getValue()?void 0:!t}function hr(e){const{textTracks:t}=e;if(!r(t)){for(let e=0;e<t.length;e++)t[e].mode="disabled";if(e.hasChildNodes()){const{childNodes:t}=e;for(let n=t.length-1;n>=0;n--)if("track"===t[n].nodeName)try{e.removeChild(t[n])}catch(e){j.warn("Compat: Could not remove text track child from element.")}}}e.src="",e.removeAttribute("src")}const pr=o["a"],gr=void 0===pr?void 0:r(pr.MediaSource)?r(pr.MozMediaSource)?r(pr.WebKitMediaSource)?pr.MSMediaSource:pr.WebKitMediaSource:pr.MozMediaSource:pr.MediaSource;function mr(e,t){if("function"===typeof e.changeType){try{e.changeType(t)}catch(e){return j.warn("Could not call 'changeType' on the given SourceBuffer:",e instanceof Error?e:""),!1}return!0}return!1}const vr=["","webkit","moz","ms"];function yr(e,t){const n=document.createElement(e.tagName),i="on"+t;return i in n||(n.setAttribute(i,"return;"),"function"===typeof n[i])}function _r(e,t){return t.filter(t=>yr(e,t))[0]}function br(e,t){return e.reduce((e,n)=>e.concat((void 0===t?vr:t).map(e=>e+n)),[])}function Er(e,t){let n;const i=br(e,t);return(e,t,r)=>{if(!r.isCancelled()){if("undefined"!==typeof HTMLElement&&e instanceof HTMLElement){if("undefined"===typeof n&&(n=_r(e,i)),!Nt(n))return void 0;e.addEventListener(n,t),r.register(()=>{void 0!==n&&e.removeEventListener(n,t)})}i.forEach(n=>{let i=!1;"function"===typeof e.addEventListener?e.addEventListener(n,t):(i=!0,e["on"+n]=t),r.register(()=>{"function"===typeof e.removeEventListener&&e.removeEventListener(n,t),i&&delete e["on"+n]})})}}}function Tr(e){let t;const n=document;r(n.hidden)?r(n.mozHidden)?r(n.msHidden)?r(n.webkitHidden)||(t="webkit"):t="ms":t="moz":t="";const i=Nt(t)?t+"Hidden":"hidden",a=Nt(t)?t+"visibilitychange":"visibilitychange",o=document[i],s=new de(!o,e);return Br(document,a,()=>{const e=!document[i];s.setValueIfChanged(e)},e),s}function Sr(e,t){const n=e;if(!0===n.webkitSupportsPresentationMode&&"function"===typeof n.webkitSetPresentationMode){const e="picture-in-picture"===n.webkitPresentationMode,i=new de({isEnabled:e,pipWindow:null},t);return Br(n,"webkitpresentationmodechanged",()=>{const e="picture-in-picture"===n.webkitPresentationMode;i.setValue({isEnabled:e,pipWindow:null})},t),i}const i=document.pictureInPictureElement===n,r=new de({isEnabled:i,pipWindow:null},t);return Br(n,"enterpictureinpicture",e=>{var t;r.setValue({isEnabled:!0,pipWindow:null!==(t=e.pictureInPictureWindow)&&void 0!==t?t:null})},t),Br(n,"leavepictureinpicture",()=>{r.setValue({isEnabled:!1,pipWindow:null})},t),r}function wr(e,t){const n=Tr(t);let i;const r=new de(!0,t);return t.register(()=>{clearTimeout(i),i=void 0}),n.onUpdate(a,{clearSignal:t}),e.onUpdate(a,{clearSignal:t}),a(),r;function a(){if(clearTimeout(i),i=void 0,e.getValue().isEnabled||n.getValue())r.setValueIfChanged(!0);else{const{INACTIVITY_DELAY:e}=O.getCurrent();i=setTimeout(()=>{r.setValueIfChanged(!1)},e)}}}function Ar(e){var t,n;const i=r(o["a"].devicePixelRatio)||0===o["a"].devicePixelRatio?1:o["a"].devicePixelRatio,a=new de({width:null===(t=o["a"].screen)||void 0===t?void 0:t.width,height:null===(n=o["a"].screen)||void 0===n?void 0:n.height,pixelRatio:i},e),s=setInterval(l,2e4);return e.register(function(){clearInterval(s)}),a;function l(){const e=a.getValue();e.width===screen.width&&e.height===screen.height&&e.pixelRatio===i||a.setValue({width:screen.width,height:screen.height,pixelRatio:i})}}function Ir(e,t,n){const i=r(o["a"].devicePixelRatio)||0===o["a"].devicePixelRatio?1:o["a"].devicePixelRatio,a=new de({width:e.clientWidth,height:e.clientHeight,pixelRatio:i},n);let s=F;t.onUpdate(u,{clearSignal:n}),Br(o["a"],"resize",u,n),Br(e,"enterpictureinpicture",u,n),Br(e,"leavepictureinpicture",u,n);const l=setInterval(u,2e4);return u(),n.register(function(){s(),clearInterval(l)}),a;function u(){s();const n=t.getValue(),{pipWindow:o}=n;if(n.isEnabled)if(r(o)){const e=a.getValue();void 0===e.width&&void 0===e.height&&e.pixelRatio===i||a.setValue({width:void 0,height:void 0,pixelRatio:i})}else{const e=()=>{l()};o.addEventListener("resize",e),s=(()=>{o.removeEventListener("resize",e),s=F}),l()}else{const t=a.getValue();t.width===e.clientWidth&&t.height===e.clientHeight&&t.pixelRatio===i||a.setValue({width:e.clientWidth,height:e.clientHeight,pixelRatio:i})}function l(){const e=a.getValue();e.width===(null===o||void 0===o?void 0:o.width)&&e.height===(null===o||void 0===o?void 0:o.height)&&e.pixelRatio===i||a.setValue({width:null===o||void 0===o?void 0:o.width,height:null===o||void 0===o?void 0:o.height,pixelRatio:i})}}}Er(["loadedmetadata"]),Er(["timeupdate"]),Er(["addtrack"]),Er(["removetrack"]);const xr=Er(["sourceopen","webkitsourceopen"]),Rr=Er(["sourceclose","webkitsourceclose"]),Cr=Er(["sourceended","webkitsourceended"]),Dr=Er(["update"]),kr=Er(["removesourcebuffer"]),Mr=Er(["keymessage","message"]),Lr=Er(["keyadded","ready"]),Pr=Er(["keyerror","error"]),Nr=Er(["keystatuseschange"]),Or=Er(["seeking"]),Fr=Er(["seeked"]),Ur=Er(["ended"]);function Br(e,t,n,i){e.addEventListener(t,n),i.register(()=>{e.removeEventListener(t,n)})}function Gr(...e){const t=e.length;let n,i=-1,r=0;while(++i<t)n=e[i],r+="number"===typeof n?n:n.length;const a=new Uint8Array(r);let o=0;i=-1;while(++i<t)n=e[i],"number"===typeof n?o+=n:n.length>0&&(a.set(n,o),o+=n.length);return a}function jr(e,t){return(e[t+0]<<8)+(e[t+1]<<0)}function Vr(e,t){return 65536*e[t+0]+256*e[t+1]+e[t+2]}function Hr(e,t){return 16777216*e[t+0]+65536*e[t+1]+256*e[t+2]+e[t+3]}function Kr(e,t){return 4294967296*(16777216*e[t+0]+65536*e[t+1]+256*e[t+2]+e[t+3])+16777216*e[t+4]+65536*e[t+5]+256*e[t+6]+e[t+7]}function zr(e){return new Uint8Array([e>>>8&255,255&e])}function Zr(e){return new Uint8Array([e>>>24&255,e>>>16&255,e>>>8&255,255&e])}function qr(e){const t=e%4294967296,n=(e-t)/4294967296;return new Uint8Array([n>>>24&255,n>>>16&255,n>>>8&255,255&n,t>>>24&255,t>>>16&255,t>>>8&255,255&t])}function Yr(e,t){return(e[t+0]<<0)+(e[t+1]<<8)}function Wr(e,t){return e[t+0]+256*e[t+1]+65536*e[t+2]+16777216*e[t+3]}function $r(e){return new Uint8Array([255&e,e>>>8&255])}function Xr(e){return new Uint8Array([255&e,e>>>8&255,e>>>16&255,e>>>24&255])}function Qr(e){const t=[];for(let n=0;n<e.length;n++){const i=e[n];i.updating&&t.push(i)}return t}function Jr(e,t){if(j.debug("Init: Trying to call endOfStream"),"open"!==e.readyState)return void j.debug("Init: MediaSource not open, cancel endOfStream");const{sourceBuffers:n}=e,i=Qr(n);if(0===i.length){j.info("Init: Triggering end of stream");try{e.endOfStream()}catch(e){j.error("Unable to call endOfStream",e instanceof Error?e:new Error("Unknown error"))}return}j.debug("Init: Waiting SourceBuffers to be updated before calling endOfStream.");const r=new me;r.linkToSignal(t);for(const a of i)Dr(a,()=>{r.cancel(),Jr(e,t)},r.signal);kr(n,()=>{r.cancel(),Jr(e,t)},r.signal)}function ea(e,t){let n=new me;n.linkToSignal(t),xr(e,()=>{j.debug("Init: MediaSource re-opened while end-of-stream is active"),n.cancel(),n=new me,n.linkToSignal(t),Jr(e,n.signal)},t),Jr(e,n.signal)}function ta(){return S}const na=31536e3;class ia{constructor(e){this._mediaSource=e,this._currentMediaSourceDurationUpdateCanceller=null}updateDuration(e,t){null!==this._currentMediaSourceDurationUpdateCanceller&&this._currentMediaSourceDurationUpdateCanceller.cancel(),this._currentMediaSourceDurationUpdateCanceller=new me;const n=this._mediaSource,i=this._currentMediaSourceDurationUpdateCanceller.signal,r=oa(n,i);let a=new me;function o(){if(a.cancel(),!r.getValue())return;a=new me,a.linkToSignal(i);const o=aa(n.sourceBuffers,a.signal);let s=new me;return s.linkToSignal(a.signal),o.onUpdate(i=>{s.cancel(),s=new me,s.linkToSignal(a.signal),i||sa(n,e,t,s.signal)},{clearSignal:a.signal,emitCurrentValue:!0})}a.linkToSignal(i),r.onUpdate(o,{emitCurrentValue:!0,clearSignal:i})}stopUpdating(){null!==this._currentMediaSourceDurationUpdateCanceller&&(this._currentMediaSourceDurationUpdateCanceller.cancel(),this._currentMediaSourceDurationUpdateCanceller=null)}}function ra(e,t,n){let i=t;n||(i=ta()?1/0:la(t));let r=0;for(let a=0;a<e.sourceBuffers.length;a++){const t=e.sourceBuffers[a],n=t.buffered.length;n>0&&(r=Math.max(t.buffered.end(n-1)))}if(i===e.duration)return"success";if(r>i){if(r<e.duration)try{j.info("Init: Updating duration to what is currently buffered",r),e.duration=r}catch(e){return j.warn("Duration Updater: Can't update duration on the MediaSource.",e instanceof Error?e:""),"failed"}return"partial"}{const n=e.duration;try{if(j.info("Init: Updating duration",i),e.duration=i,"open"===e.readyState&&!isFinite(i)){const n=la(t);j.info("Init: calling `mediaSource.setLiveSeekableRange`",n),e.setLiveSeekableRange(0,n)}}catch(e){return j.warn("Duration Updater: Can't update duration on the MediaSource.",e instanceof Error?e:""),"failed"}const r=Math.abs(e.duration-i);if(r>=.1){const t=Math.abs(e.duration-n);return r<t?"partial":"failed"}return"success"}}function aa(e,t){if(0===e.length){const e=new de(!1);return e.finish(),e}const n=new de(!1,t);i();for(let r=0;r<e.length;r++){const n=e[r];n.addEventListener("updatestart",i),n.addEventListener("update",i),t.register(()=>{n.removeEventListener("updatestart",i),n.removeEventListener("update",i)})}return n;function i(){for(let t=0;t<e.length;t++){const i=e[t];if(i.updating)return void n.setValueIfChanged(!0)}n.setValueIfChanged(!1)}}function oa(e,t){const n=new de("open"===e.readyState,t);return xr(e,()=>{j.debug("Init: Reacting to MediaSource open in duration updater"),n.setValueIfChanged(!0)},t),Cr(e,()=>{j.debug("Init: Reacting to MediaSource ended in duration updater"),n.setValueIfChanged(!1)},t),Rr(e,()=>{j.debug("Init: Reacting to MediaSource close in duration updater"),n.setValueIfChanged(!1)},t),n}function sa(e,t,n,i){const r=ra(e,t,n);if("success"===r)return;const a=setTimeout(()=>{o(),sa(e,t,n,i)},2e3),o=i.register(()=>{clearTimeout(a)})}function la(e){return Math.max(Math.pow(2,32),e+na)}class ua extends a{constructor(e){if(super(),this.id=e,this.sourceBuffers=[],this._canceller=new me,r(gr))throw new ut("MEDIA_SOURCE_NOT_SUPPORTED","No MediaSource Object was found in the current browser.");j.info("Init: Creating MediaSource");const t=new gr;this.readyState=t.readyState;const n=t.handle;this.handle=r(n)?{type:"media-source",value:t}:{type:"handle",value:n},this._mediaSource=t,this._durationUpdater=new ia(t),this._endOfStreamCanceller=null,xr(t,()=>{this.readyState=t.readyState,this.trigger("mediaSourceOpen",null)},this._canceller.signal),Cr(t,()=>{this.readyState=t.readyState,this.trigger("mediaSourceEnded",null)},this._canceller.signal),Rr(t,()=>{this.readyState=t.readyState,this.trigger("mediaSourceClose",null)},this._canceller.signal)}addSourceBuffer(e,t){const n=this._mediaSource.addSourceBuffer(t),i=new ca(e,t,n);return this.sourceBuffers.push(i),i}setDuration(e,t){this._durationUpdater.updateDuration(e,t)}interruptDurationSetting(){this._durationUpdater.stopUpdating()}maintainEndOfStream(){null===this._endOfStreamCanceller&&(this._endOfStreamCanceller=new me,this._endOfStreamCanceller.linkToSignal(this._canceller.signal),j.debug("Init: end-of-stream order received."),ea(this._mediaSource,this._endOfStreamCanceller.signal))}stopEndOfStream(){null!==this._endOfStreamCanceller&&(j.debug("Init: resume-stream order received."),this._endOfStreamCanceller.cancel(),this._endOfStreamCanceller=null)}dispose(){this.sourceBuffers.forEach(e=>e.dispose()),this._canceller.cancel(),da(this._mediaSource)}}class ca{constructor(e,t,n){this.type=e,this.codec=t,this._canceller=new me,this._sourceBuffer=n,this._operationQueue=[],this._currentOperations=[];const i=e=>{let t;t=e instanceof Error?e:e.error instanceof Error?e.error:new Error("Unknown SourceBuffer Error");const n=this._currentOperations;if(this._currentOperations=[],0===n.length)j.error("SBI: error for an unknown operation",t);else{const e=new Ci(t.name,t.message,"QuotaExceededError"===t.name);for(const t of n)t.reject(e)}},r=()=>{const e=this._currentOperations;this._currentOperations=[];try{for(const t of e)t.resolve(X(this._sourceBuffer.buffered))}catch(t){for(const n of e)t instanceof Error&&"InvalidStateError"===t.name?n.resolve([]):n.reject(t)}this._performNextOperation()};n.addEventListener("error",i),n.addEventListener("updateend",r),this._canceller.signal.register(()=>{n.removeEventListener("error",i),n.removeEventListener("updateend",r)})}appendBuffer(...e){return j.debug("SBI: receiving order to push data to the SourceBuffer",this.type),this._addToQueue({operationName:0,params:e})}remove(e,t){return j.debug("SBI: receiving order to remove data from the SourceBuffer",this.type,e,t),this._addToQueue({operationName:1,params:[e,t]})}getBuffered(){try{return X(this._sourceBuffer.buffered)}catch(e){return j.error("Failed to get buffered time range of SourceBuffer",this.type,e instanceof Error?e:null),[]}}abort(){try{this._sourceBuffer.abort()}catch(e){j.debug("Init: Failed to abort SourceBuffer:",e instanceof Error?e:null)}this._emptyCurrentQueue()}dispose(){try{this._sourceBuffer.abort()}catch(e){}this._emptyCurrentQueue()}_emptyCurrentQueue(){const e=new ye;this._currentOperations.length>0&&(this._currentOperations.forEach(t=>{t.reject(e)}),this._currentOperations=[]),this._operationQueue.length>0&&(this._operationQueue.forEach(t=>{t.reject(e)}),this._operationQueue=[])}_addToQueue(e){return new Promise((t,n)=>{const i=0===this._operationQueue.length&&0===this._currentOperations.length,r=k({resolve:t,reject:n},e);this._operationQueue.push(r),i&&this._performNextOperation()})}_performNextOperation(){var e,t,n,i,r;if(0!==this._currentOperations.length||this._sourceBuffer.updating)return;const a=this._operationQueue.shift();if(void 0!==a)if(0===a.operationName){this._currentOperations=[{operationName:0,resolve:a.resolve,reject:a.reject}];const o=a.params[0],s=a.params[1];let l=o;if(this._operationQueue.length>0&&0===this._operationQueue[0].operationName){let a;a=o instanceof ArrayBuffer?new Uint8Array(o):o instanceof Uint8Array?o:new Uint8Array(o.buffer);const u=[a];while(0===(null===(e=this._operationQueue[0])||void 0===e?void 0:e.operationName)){const e=this._operationQueue[0],a=null!==(t=s.appendWindow)&&void 0!==t?t:[void 0,void 0],o=null!==(n=e.params[1].appendWindow)&&void 0!==n?n:[void 0,void 0],l=null!==(i=s.timestampOffset)&&void 0!==i?i:0,c=null!==(r=e.params[1].timestampOffset)&&void 0!==r?r:0;if(a[0]!==o[0]||a[1]!==o[1]||s.codec!==e.params[1].codec||l!==c)break;{const t=e.params[0];let n;n=t instanceof ArrayBuffer?new Uint8Array(t):t instanceof Uint8Array?t:new Uint8Array(t.buffer),u.push(n),this._operationQueue.splice(0,1),this._currentOperations.push({operationName:0,resolve:e.resolve,reject:e.reject})}}u.length>1&&(j.info(`MMSI: Merging ${u.length} segments together for perf`,this.type),l=Gr(...u))}try{this._appendBufferNow(l,s)}catch(e){const t=e instanceof Error?new Ci(e.name,e.message,"QuotaExceededError"===e.name):new Ci("Error","Unknown SourceBuffer Error during appendBuffer",!1);this._currentOperations.forEach(e=>{e.reject(t)}),this._currentOperations=[]}}else{this._currentOperations=[a];const[e,t]=a.params;j.debug("SBI: removing data from SourceBuffer",this.type,e,t);try{this._sourceBuffer.remove(e,t)}catch(e){const t=e instanceof Error?new Ci(e.name,e.message,!1):new Ci("Error","Unknown SourceBuffer Error during remove",!1);a.reject(t),this._currentOperations=[]}}}_appendBufferNow(e,t){const n=this._sourceBuffer,{codec:i,timestampOffset:r,appendWindow:a=[]}=t;if(void 0!==i&&i!==this.codec){j.debug("SBI: updating codec",i);const e=mr(n,i);e?this.codec=i:j.debug("SBI: could not update codec",i,this.codec)}if(void 0!==r&&n.timestampOffset!==r){const e=r;j.debug("SBI: updating timestampOffset",i,n.timestampOffset,e),n.timestampOffset=e}if(void 0===a[0])n.appendWindowStart>0&&(j.debug("SBI: re-setting `appendWindowStart` to `0`"),n.appendWindowStart=0);else if(a[0]!==n.appendWindowStart){if(a[0]>=n.appendWindowEnd){const e=a[0]+1;j.debug("SBI: pre-updating `appendWindowEnd`",e),n.appendWindowEnd=e}j.debug("SBI: setting `appendWindowStart`",a[0]),n.appendWindowStart=a[0]}void 0===a[1]?n.appendWindowEnd!==1/0&&(j.debug("SBI: re-setting `appendWindowEnd` to `Infinity`"),n.appendWindowEnd=1/0):a[1]!==n.appendWindowEnd&&(j.debug("SBI: setting `appendWindowEnd`",a[1]),n.appendWindowEnd=a[1]),j.debug("SBI: pushing segment",this.type),n.appendBuffer(e)}}function da(e){if("closed"!==e.readyState){const{readyState:t,sourceBuffers:n}=e;for(let i=n.length-1;i>=0;i--){const r=n[i];try{if("open"===t){j.info("Init: Aborting SourceBuffer before removing");try{r.abort()}catch(e){}}j.info("Init: Removing SourceBuffer from mediaSource"),e.removeSourceBuffer(r)}catch(e){}}n.length>0&&j.info("Init: Not all SourceBuffers could have been removed.")}}const fa=pt();function ha(e,t){if(null!==t&&e.src===t&&(j.info("Init: Clearing HTMLMediaElement's src"),hr(e)),null!==t)try{j.debug("Init: Revoking previous URL"),URL.revokeObjectURL(t)}catch(e){j.warn("Init: Error while revoking the media source URL",e instanceof Error?e:"")}}function pa(e,t){const n=Nt(e.src)?e.src:null;ha(e,n);const i=new ua(fa());return t.register(()=>{i.dispose()}),i}function ga(e,t){return un(t,n=>{const i=pa(e,t);if(i.addEventListener("mediaSourceOpen",()=>{j.info("Init: MediaSource opened"),n(i)},t),j.info("MTCI: Attaching MediaSource URL to the media element"),"handle"===i.handle.type)e.srcObject=i.handle.value,t.register(()=>{ha(e,null)});else{const n=URL.createObjectURL(i.handle.value);e.src=n,t.register(()=>{ha(e,n)})}})}function ma(e,t,n){var i;if(!r(n)){const t=bt(e),a=Tt(e);if(!r(n.position))return j.debug("Init: using startAt.minimumPosition"),Math.max(Math.min(n.position,a),t);if(!r(n.wallClockTime)){j.debug("Init: using startAt.wallClockTime");const i=void 0===e.availabilityStartTime?0:e.availabilityStartTime,r=n.wallClockTime-i;return Math.max(Math.min(r,a),t)}if(!r(n.fromFirstPosition)){j.debug("Init: using startAt.fromFirstPosition");const{fromFirstPosition:e}=n;return e<=0?t:Math.min(a,t+e)}if(!r(n.fromLastPosition)){j.debug("Init: using startAt.fromLastPosition");const{fromLastPosition:e}=n;return e>=0?a:Math.max(t,a+e)}if(!r(n.fromLivePosition)){j.debug("Init: using startAt.fromLivePosition");const r=null!==(i=Et(e))&&void 0!==i?i:a,{fromLivePosition:o}=n;return o>=0?r:Math.max(t,r+o)}if(!r(n.percentage)){j.debug("Init: using startAt.percentage");const{percentage:e}=n;if(e>100)return a;if(e<0)return t;const i=+e/100,r=a-t;return t+r*i}}const a=bt(e);if(e.isLive){const{suggestedPresentationDelay:n,clockOffset:i}=e,r=Tt(e);let o;const{DEFAULT_LIVE_GAP:s}=O.getCurrent();if(void 0===i)j.info("Init: no clock offset found for a live content, starting close to maximum available position"),o=r;else{j.info("Init: clock offset found for a live content, checking if we can start close to it");const t=void 0===e.availabilityStartTime?0:e.availabilityStartTime,n=(Te()+i)/1e3-t;o=Math.min(r,n)}const l=null!==n&&void 0!==n?n:t?s.LOW_LATENCY:s.DEFAULT;return j.debug(`Init: ${o} defined as the live time, applying a live gap`+` of ${l}`),Math.max(o-l,a)}return j.info("Init: starting at the minimum available position:",a),a}function va(){return m}function ya(e){return!e||!g}function _a(){return S}function ba(e,t,n,i){const r=new me;r.linkToSignal(i);const a=new de(!1,r.signal);return e.listen(e=>{if(null!==e.rebuffering||null!==e.freezing||0===e.readyState)return;if(!ya(n)){if(isNaN(t.duration))return;if(t.duration>0)return a.setValue(!0),void r.cancel()}const i=_a()?4:3;return e.readyState>=i&&(null!==e.currentRange||e.ended)&&(!va()||t.duration>0)?(a.setValue(!0),void r.cancel()):void 0},{includeLastObservation:!0,clearSignal:r.signal}),a}const Ea=!g;var Ta,Sa=Ea;function wa({mediaElement:e,playbackObserver:t,startTime:n,mustAutoPlay:i,isDirectfile:r,onWarning:a},o){const s=new de(!1,o),l=new Promise((l,u)=>{const c=o.register(e=>{u(e)});if(o.isCancelled())return;let d=!1;const f=e=>{t.setCurrentTime(e),d=!0};if(r&&"number"!==typeof n)t.listen((e,t)=>{if(e.readyState>=1){t();const e="number"===typeof n?n:n();0!==e&&(Sa?f(e):setTimeout(()=>{f(e)},0)),h()}},{includeLastObservation:!0,clearSignal:o});else{const e="number"===typeof n?n:n();0!==e&&f(e),h()}function h(){let n=!1;t.listen((t,i)=>{if(n||0===t.seeking&&"seeking"!==t.event&&"internal-seeking"!==t.event||(n=!0),(!d||n)&&0!==t.readyState){if(i(),va()&&0===e.duration){const e=new ut("MEDIA_ERR_NOT_LOADED_METADATA","Cannot load automatically: your browser falsely announced having loaded the content.");a(e)}o.isCancelled()||p()}},{includeLastObservation:!0,clearSignal:o})}function p(){t.listen((e,t)=>{0===e.seeking&&null===e.rebuffering&&e.readyState>=1&&(t(),g())},{includeLastObservation:!0,clearSignal:o})}function g(){var t;if(j.info("Init: Can begin to play content"),!i)return e.autoplay&&j.warn("Init: autoplay is enabled on HTML media element. Media will play as soon as possible."),s.setValue(!0),s.finish(),c(),l({type:"skipped"});if(e.ended)return j.warn("Init: autoplay is enabled but the video is ended. Skipping autoplay to prevent video to start again"),s.setValue(!0),s.finish(),c(),l({type:"skipped"});let n;try{n=null!==(t=e.play())&&void 0!==t?t:Promise.resolve()}catch(e){return c(),u(e)}n.then(()=>{if(!o.isCancelled())return s.setValue(!0),s.finish(),c(),l({type:"autoplay"})}).catch(e=>{if(c(),!o.isCancelled()){if(e instanceof Error&&"NotAllowedError"===e.name){j.warn("Init: Media element can't play. It may be due to browser auto-play policies.");const e=new ut("MEDIA_ERR_BLOCKED_AUTOPLAY","Cannot trigger auto-play automatically: your browser does not allow it.");if(a(e),o.isCancelled())return;return l({type:"autoplay-blocked"})}u(e)}})}});return{autoPlayResult:l,initialPlayPerformed:s}}function Aa(e,t,n,i,r){if(0===t.length)return u("No `keySystems` option given.");if(null===Zt.decrypt)return u("EME feature not activated.");const a=new me;a.linkToSignal(r);const o=new de({initializationState:{type:"uninitialized",value:null},drmSystemId:void 0},r),s=Zt.decrypt;if(!s.hasEmeApis())return u("EME API not available on the current page.");j.debug("Init: Creating ContentDecryptor");const l=new s(e,t);return l.addEventListener("stateChange",e=>{if(e===Ta.WaitingForAttachment){const t=new de(!1);t.onUpdate((t,n)=>{t&&(n(),e===Ta.WaitingForAttachment&&l.attach())},{clearSignal:a.signal}),o.setValue({initializationState:{type:"awaiting-media-link",value:{isMediaLinked:t}},drmSystemId:l.systemId})}else e===Ta.ReadyForContent&&(o.setValue({initializationState:{type:"initialized",value:null},drmSystemId:l.systemId}),l.removeEventListener("stateChange"))}),l.addEventListener("error",e=>{a.cancel(),i.onError(e)}),l.addEventListener("warning",e=>{i.onWarning(e)}),l.addEventListener("blackListProtectionData",e=>{i.onBlackListProtectionData(e)}),l.addEventListener("keyIdsCompatibilityUpdate",e=>{i.onKeyIdsCompatibilityUpdate(e)}),n.onUpdate(e=>{null!==e&&l.onInitializationData(e)},{clearSignal:a.signal}),a.signal.register(()=>{l.dispose()}),o;function u(e){n.onUpdate((t,n)=>{if(null===t)return;n();const r=new lt("MEDIA_IS_ENCRYPTED_ERROR",e);i.onError(r)},{clearSignal:r});const t=new de({initializationState:{type:"initialized",value:null},drmSystemId:void 0});return t.finish(),t}}(function(e){e[e["Initializing"]=0]="Initializing",e[e["WaitingForAttachment"]=1]="WaitingForAttachment",e[e["ReadyForContent"]=2]="ReadyForContent",e[e["Error"]=3]="Error",e[e["Disposed"]=4]="Disposed"})(Ta||(Ta={}));class Ia{constructor(e){this._displayer=e}pushTextData(e){try{return Promise.resolve(this._displayer.pushTextData(e))}catch(e){return Promise.reject(e)}}remove(e,t){try{return Promise.resolve(this._displayer.removeBuffer(e,t))}catch(e){return Promise.reject(e)}}reset(){this._displayer.reset()}stop(){this._displayer.stop()}}const xa=1/60;class Ra extends a{constructor(e,t,n){super(),this._playbackObserver=e,this._manifest=t,this._speed=n,this._discontinuitiesStore=[],this._isStarted=!1,this._canceller=new me}start(){if(this._isStarted)return;this._isStarted=!0;const e=new La(this._playbackObserver,this._speed);this._canceller.signal.register(()=>{e.dispose()});let t=null;this._playbackObserver.listen(n=>{const i=this._discontinuitiesStore,{buffered:r,position:a,readyState:o,rebuffering:s,freezing:l}=n,{BUFFER_DISCONTINUITY_THRESHOLD:u,FREEZING_STALLED_DELAY:c,UNFREEZING_SEEK_DELAY:d,UNFREEZING_DELTA_POSITION:f}=O.getCurrent();if(null!==l){const n=Te(),i=null===t?l.timestamp:t.attemptTimestamp;if(!a.isAwaitingFuturePosition()&&n-i>d&&(j.warn("Init: trying to seek to un-freeze player"),this._playbackObserver.setCurrentTime(this._playbackObserver.getCurrentTime()+f),t={attemptTimestamp:n}),n-l.timestamp>c)return null===s?e.stopRebuffering():e.startRebuffering(),void this.trigger("stalled","freezing")}else t=null;if(null===s){if(e.stopRebuffering(),1===o){let e;return e=0!==n.seeking?1===n.seeking?"internal-seek":"seeking":"not-ready",void this.trigger("stalled",e)}return void this.trigger("unstalled",null)}const h="seeking"===s.reason&&1===n.seeking?"internal-seek":s.reason;if(a.isAwaitingFuturePosition())return e.stopRebuffering(),j.debug("Init: let rebuffering happen as we're awaiting a future position"),void this.trigger("stalled",h);if(e.startRebuffering(),null===this._manifest)return void this.trigger("stalled",h);const{position:p}=s;if(null!==p&&void 0!==p&&this._speed.getValue()>0){const e=Ca(i,this._manifest,p);if(null!==e){const t=e+.001;if(!(t<=this._playbackObserver.getCurrentTime()))return j.warn("SA: skippable discontinuity found in the stream",a.getPolled(),t),this._playbackObserver.setCurrentTime(t),void this.trigger("warning",Ma(p,t));j.info("Init: position to seek already reached, no seeking",this._playbackObserver.getCurrentTime(),t)}}const g=null!==p&&void 0!==p?p:a.getPolled(),m=ee(r,g);if(this._speed.getValue()>0&&m<u){const e=g+m+xa;if(this._playbackObserver.getCurrentTime()<e)return j.warn("Init: discontinuity encountered inferior to the threshold",g,e,u),this._playbackObserver.setCurrentTime(e),void this.trigger("warning",Ma(g,e))}for(let e=this._manifest.periods.length-2;e>=0;e--){const t=this._manifest.periods[e];if(void 0!==t.end&&t.end<=g){if(this._manifest.periods[e+1].start>g&&this._manifest.periods[e+1].start>this._playbackObserver.getCurrentTime()){const t=this._manifest.periods[e+1];return this._playbackObserver.setCurrentTime(t.start),void this.trigger("warning",Ma(g,t.start))}break}}this.trigger("stalled",h)},{includeLastObservation:!0,clearSignal:this._canceller.signal})}updateDiscontinuityInfo(e){this._isStarted||this.start();const t=this._playbackObserver.getReference().getValue();ka(this._discontinuitiesStore,e,t)}onLockedStream(e,t){var n;this._isStarted||this.start();const i=this._playbackObserver.getReference().getValue();if(!i.rebuffering||i.paused||this._speed.getValue()<=0||"audio"!==e&&"video"!==e)return;const r=i.position.getWanted(),a=null!==(n=i.rebuffering.position)&&void 0!==n?n:r,o=t.start;r<o&&Math.abs(a-o)<1&&(j.warn("Init: rebuffering because of a future locked stream.\nTrying to unlock by seeking to the next Period"),this._playbackObserver.setCurrentTime(o+.001))}destroy(){this._canceller.cancel()}}function Ca(e,t,n){if(0===e.length)return null;let i=null;for(const r of e){const{period:e}=r;if(e.start>n)return i;let a;if(void 0===e.end||e.end>n){const{discontinuity:o,position:s}=r,{start:l,end:u}=o,c=null!==l&&void 0!==l?l:s;if(n>=c-xa)if(null===u){const n=At(t,e);null!==n?a=n.start+xa:j.warn("Init: discontinuity at Period's end but no next Period")}else n<u+xa&&(a=u+xa);void 0!==a&&(j.info("Init: discontinuity found",n,a),i=null!==i&&i>a?i:a)}}return i}function Da(e){return null!==e.discontinuity}function ka(e,t,n){const i=Math.min(n.position.getPolled(),n.position.getWanted());while(e.length>0&&void 0!==e[0].period.end&&e[0].period.end+10<i)e.shift();const{period:r,bufferType:a}=t;if("audio"===a||"video"===a){for(let n=0;n<e.length;n++)if(e[n].period.id===r.id){if(e[n].bufferType===a)return void(Da(t)?e[n]=t:e.splice(n,1))}else if(e[n].period.start>r.start)return void(Da(t)&&e.splice(n,0,t));Da(t)&&e.push(t)}}function Ma(e,t){return new ut("DISCONTINUITY_ENCOUNTERED","A discontinuity has been encountered at position "+String(e)+", seeked at position "+String(t))}class La{constructor(e,t){this._speedUpdateCanceller=new me,this._isRebuffering=!1,this._playbackObserver=e,this._isDisposed=!1,this._speed=t,this._updateSpeed()}startRebuffering(){this._isRebuffering||this._isDisposed||(this._isRebuffering=!0,this._speedUpdateCanceller.cancel(),j.info("Init: Pause playback to build buffer"),this._playbackObserver.setPlaybackRate(0))}stopRebuffering(){this._isRebuffering&&!this._isDisposed&&(this._isRebuffering=!1,this._speedUpdateCanceller=new me,this._updateSpeed())}dispose(){this._speedUpdateCanceller.cancel(),this._isDisposed=!0}_updateSpeed(){this._speed.onUpdate(e=>{j.info("Init: Resume playback speed",e),this._playbackObserver.setPlaybackRate(e)},{clearSignal:this._speedUpdateCanceller.signal,emitCurrentValue:!0})}}function Pa(e,t){return e.id===t.id&&e.start===t.start&&e.end===t.end}var Na=Pa;function Oa(e,t){const n=[],{periods:i}=t;for(const r of i){const{streamEvents:t}=r;t.forEach(({start:t,end:i,id:r,data:a})=>{for(const l of e)if(Na(l,{id:r,start:t,end:i}))return void n.push(l);let o;if(void 0!==a.value.element)o=a.value.element;else{if(void 0===a.value.xmlData)return;{let e=a.value.xmlData.namespaces.reduce((e,t)=>{return e+"xmlns:"+t.key+'="'+t.value+'" '},"<toremove ");e+=">";const t=(new DOMParser).parseFromString(e+a.value.xmlData.data+"</toremove>","application/xml").documentElement;o=t.children.length>0?t.children[0]:t.childNodes[0]}}const s={type:a.type,value:Object.assign(Object.assign({},a.value),{element:o})};if(void 0===i){const e={start:t,id:r,data:s,publicEvent:{start:t,data:s}};n.push(e)}else{const e={start:t,end:i,id:r,data:s,publicEvent:{start:t,end:i,data:s}};n.push(e)}})}return n}var Fa=Oa;class Ua extends a{constructor(e,t,n){super(),this._manifest=e,this._mediaElement=t,this._playbackObserver=n,this._canceller=null,this._scheduledEventsRef=new de([]),this._eventsBeingPlayed=new WeakMap}start(){if(null!==this._canceller)return;this._canceller=new me;const e=this._canceller.signal,t=this._playbackObserver,n=this._mediaElement;let i=!1,r=new me;r.linkToSignal(e),this._scheduledEventsRef.setValue(Fa([],this._manifest)),this._scheduledEventsRef.onUpdate(({length:a})=>{if(0===a)return void(i&&(r.cancel(),r=new me,r.linkToSignal(e),i=!1));if(i)return;i=!0;let o=c();const s=()=>{const e=c();this._emitStreamEvents(this._scheduledEventsRef.getValue(),o,e,r.signal),o=e},{STREAM_EVENT_EMITTER_POLL_INTERVAL:l}=O.getCurrent(),u=setInterval(s,l);function c(){const e=t.getReference().getValue(),i=n.currentTime,r=0!==e.seeking;return{currentTime:i,isSeeking:r}}t.listen(s,{includeLastObservation:!1,clearSignal:r.signal}),r.signal.register(()=>{clearInterval(u)})},{emitCurrentValue:!0,clearSignal:e})}onManifestUpdate(e){const t=this._scheduledEventsRef.getValue();this._scheduledEventsRef.setValue(Fa(t,e))}stop(){null!==this._canceller&&(this._canceller.cancel(),this._canceller=null)}_emitStreamEvents(e,t,n,i){const{currentTime:r}=t,{isSeeking:a,currentTime:o}=n,s=[],l=[];for(let u=0;u<e.length;u++){const t=e[u],n=t.start,i=Ba(t)?t.end:void 0,c=this._eventsBeingPlayed.has(t);c?(n>o||void 0!==i&&o>=i)&&(Ba(t)&&l.push(t.publicEvent),this._eventsBeingPlayed.delete(t)):n<=o&&void 0!==i&&o<i?(s.push({type:"stream-event",value:t.publicEvent}),this._eventsBeingPlayed.set(t,!0)):r<n&&o>=(null!==i&&void 0!==i?i:n)&&(a?s.push({type:"stream-event-skip",value:t.publicEvent}):(s.push({type:"stream-event",value:t.publicEvent}),Ba(t)&&l.push(t.publicEvent)))}if(s.length>0)for(const u of s)if("stream-event"===u.type?this.trigger("event",u.value):this.trigger("eventSkip",u.value),i.isCancelled())return;if(l.length>0)for(const u of l)if("function"===typeof u.onExit&&u.onExit(),i.isCancelled())return}}function Ba(e){return void 0!==e.end}var Ga=Ua;function ja(e,t,n){function i(){const n=e.error;let i,a;switch(r(n)||(i=n.code,a=n.message),i){case 1:return a=null!==a&&void 0!==a?a:"The fetching of the associated resource was aborted by the user's request.",t(new ut("MEDIA_ERR_ABORTED",a));case 2:return a=null!==a&&void 0!==a?a:"A network error occurred which prevented the media from being successfully fetched",t(new ut("MEDIA_ERR_NETWORK",a));case 3:return a=null!==a&&void 0!==a?a:"An error occurred while trying to decode the media resource",t(new ut("MEDIA_ERR_DECODE",a));case 4:return a=null!==a&&void 0!==a?a:"The media resource has been found to be unsuitable.",t(new ut("MEDIA_ERR_SRC_NOT_SUPPORTED",a));default:return a=null!==a&&void 0!==a?a:"The HTMLMediaElement errored due to an unknown reason.",t(new ut("MEDIA_ERR_UNKNOWN",a))}}n.isCancelled()||(e.addEventListener("error",i),n.register(()=>{e.removeEventListener("error",i)}))}class Va extends lr{constructor(e){super(),this._settings=e,this._initCanceller=new me,this._manifest=null;const t=void 0===e.url?void 0:[e.url];this._manifestFetcher=new yn(t,e.transport,e.manifestRequestSettings)}prepare(){null===this._manifest&&(this._manifest=rr.createAsync(un(this._initCanceller.signal,(e,t)=>{this._manifestFetcher.addEventListener("warning",e=>this.trigger("warning",e)),this._manifestFetcher.addEventListener("error",e=>{this.trigger("error",e),t(e)}),this._manifestFetcher.addEventListener("manifestReady",t=>{e(t)})})),this._manifestFetcher.start(),this._initCanceller.signal.register(()=>{this._manifestFetcher.dispose()}))}start(e,t){this.prepare(),ja(e,e=>this._onFatalError(e),this._initCanceller.signal);const n=new de(null,this._initCanceller.signal);this._initializeMediaSourceAndDecryption(e,n).then(i=>this._onInitialMediaSourceReady(e,i.mediaSource,t,i.drmSystemId,n,i.unlinkMediaSource)).catch(e=>{this._onFatalError(e)})}updateContentUrls(e,t){this._manifestFetcher.updateContentUrls(e,t)}dispose(){this._initCanceller.cancel()}_onFatalError(e){this._initCanceller.isUsed()||(this._initCanceller.cancel(),this.trigger("error",e))}_initializeMediaSourceAndDecryption(e,t){const n=this._initCanceller;return un(n.signal,i=>{const{keySystems:r}=this._settings,a=Aa(e,r,t,{onWarning:e=>this.trigger("warning",e),onError:e=>this._onFatalError(e),onBlackListProtectionData:e=>{(async()=>{var t;if(null===this._manifest)return;const n=null!==(t=this._manifest.syncValue)&&void 0!==t?t:await this._manifest.getValueAsAsync();Ka(n,e)})().catch(F)},onKeyIdsCompatibilityUpdate:e=>{(async()=>{var t;if(null===this._manifest)return;const n=null!==(t=this._manifest.syncValue)&&void 0!==t?t:await this._manifest.getValueAsAsync();Ha(n,e.whitelistedKeyIds,e.blacklistedKeyIds,e.delistedKeyIds)})().catch(F)}},n.signal);a.onUpdate((t,r)=>{if("uninitialized"===t.initializationState.type)return;r();const o=new me;o.linkToSignal(n.signal),ga(e,o.signal).then(e=>{const r=a.getValue();if("awaiting-media-link"===r.initializationState.type)r.initializationState.value.isMediaLinked.setValue(!0),a.onUpdate((t,n)=>{if("initialized"===t.initializationState.type)return n(),void i({mediaSource:e,drmSystemId:t.drmSystemId,unlinkMediaSource:o})},{emitCurrentValue:!0,clearSignal:n.signal});else if("initialized"===t.initializationState.type)return void i({mediaSource:e,drmSystemId:t.drmSystemId,unlinkMediaSource:o})}).catch(e=>{o.isUsed()||this._onFatalError(e)})},{emitCurrentValue:!0,clearSignal:n.signal})})}async _onInitialMediaSourceReady(e,t,n,i,r,a){var o;const{adaptiveOptions:s,autoPlay:l,bufferOptions:u,lowLatencyMode:c,segmentRequestOptions:d,speed:f,startAt:h,textTrackOptions:p,transport:g}=this._settings,m=this._initCanceller;let v;he(null!==this._manifest);try{v=null!==(o=this._manifest.syncValue)&&void 0!==o?o:await this._manifest.getValueAsAsync()}catch(e){return}v.addEventListener("manifestUpdate",e=>{this.trigger("manifestUpdate",e)},m.signal),v.addEventListener("decipherabilityUpdate",e=>{this.trigger("decipherabilityUpdate",e)},m.signal),j.debug("Init: Calculating initial time");const y=ma(v,c,h);j.debug("Init: Initial time calculated:",y);const _=tt(s),b=k({textTrackOptions:p,drmSystemId:i},u),E=new Mn(g,d,m.signal);if(this.trigger("manifestReady",v),m.isUsed())return;const T=this._startBufferingOnMediaSource.bind(this),S=this.trigger.bind(this),w=this._onFatalError.bind(this);function A(t,i,a,o){const s={mediaElement:e,playbackObserver:n,mediaSource:t,initialTime:i,autoPlay:a,manifest:v,representationEstimator:_,segmentFetcherCreator:E,speed:f,protectionRef:r,bufferOptions:b};function l(t){if(o.cancel(),m.isUsed())return;if(S("reloadingMediaSource",t),m.isUsed())return;const n=new me;n.linkToSignal(m.signal),ga(e,n.signal).then(e=>{A(e,t.position,t.autoPlay,n)}).catch(e=>{n.isUsed()||w(e)})}T(s,l,o.signal)}A(t,y,l,a)}_startBufferingOnMediaSource(e,t,n){var i;const{autoPlay:r,bufferOptions:a,initialTime:o,manifest:s,mediaElement:l,mediaSource:u,playbackObserver:c,protectionRef:d,representationEstimator:f,segmentFetcherCreator:h,speed:p}=e,g=null!==(i=s.getPeriodForTime(o))&&void 0!==i?i:s.getNextPeriod(o);if(void 0===g){const e=new ut("MEDIA_STARTING_TIME_NOT_FOUND","Wanted starting time not found in the Manifest.");return this._onFatalError(e)}let m=null,v=null;if("html"===this._settings.textTrackOptions.textTrackMode&&null!==Zt.htmlTextDisplayer?v=new Zt.htmlTextDisplayer(l,this._settings.textTrackOptions.textTrackElement):null!==Zt.nativeTextDisplayer&&(v=new Zt.nativeTextDisplayer(l)),null!==v){const e=new Ia(v);m=e,n.register(()=>{e.stop(),null===v||void 0===v||v.stop()})}const y=new oi(u,"VIDEO"===l.nodeName,m);n.register(()=>{y.disposeAll()});const{autoPlayResult:_,initialPlayPerformed:b}=wa({mediaElement:l,playbackObserver:c,startTime:o,mustAutoPlay:r,onWarning:e=>{this.trigger("warning",e)},isDirectfile:!1},n);if(n.isCancelled())return;b.onUpdate((e,t)=>{if(e){t();const e=new Ga(s,l,c);s.addEventListener("manifestUpdate",()=>{e.onManifestUpdate(s)},n),e.addEventListener("event",e=>{this.trigger("streamEvent",e)},n),e.addEventListener("eventSkip",e=>{this.trigger("streamEventSkip",e)},n),e.start(),n.register(()=>{e.stop()})}},{clearSignal:n,emitCurrentValue:!0});const E=cr(c,{autoPlay:r,manifest:s,mediaSource:u,textDisplayer:v,initialPlayPerformed:b,speed:p},n),T=this._createRebufferingController(c,s,p,n),S=new Bn(y);I&&s.addEventListener("decipherabilityUpdate",e=>{e.some(e=>!0!==e.representation.decipherable)&&C(0,void 0,void 0)},n),c.listen(e=>{if(S.needToReload(e)){let e;const n=c.getReference().getValue();e=n.position.isAwaitingFuturePosition()?n.position.getWanted():c.getCurrentTime();const i=b.getValue()?!c.getIsPaused():r;t({position:e,autoPlay:i})}},{clearSignal:n}),E.listen(e=>{["video","audio","text"].forEach(t=>{var n;const i=y.getStatus(t);"initialized"===i.type&&i.value.synchronizeInventory(null!==(n=e.buffered[t])&&void 0!==n?n:[])})},{clearSignal:n});const w=Un(s,u,E,y,{onWarning:e=>this.trigger("warning",e),onPeriodChanged:e=>this.trigger("activePeriodChanged",{period:e})},n);_.then(()=>{ba(c,l,!1,n).onUpdate((e,t)=>{e&&(t(),this.trigger("loaded",{getSegmentSinkMetrics:async()=>{return new Promise(e=>e(y.getSegmentSinksMetrics()))}}))},{emitCurrentValue:!0,clearSignal:n})}).catch(e=>{n.isCancelled()||this._onFatalError(e)});const A=this;function R(){return{needsBufferFlush:e=>{var t;let i;const r=c.getCurrentTime(),a=null!==(t=null===e||void 0===e?void 0:e.relativeResumingPosition)&&void 0!==t?t:0,o=Boolean(null===e||void 0===e?void 0:e.relativePosHasBeenDefaulted);i=0===a&&o?r+.001:r+a,c.setCurrentTime(i),c.listen((e,t)=>{(null!==e.currentRange||e.position.getPolled()>i+.1)&&(t(),c.setCurrentTime(e.position.getWanted()+.001))},{includeLastObservation:!1,clearSignal:n})},streamStatusUpdate(e){const{period:t,bufferType:i,imminentDiscontinuity:r,position:a}=e;if(T.updateDiscontinuityInfo({period:t,bufferType:i,discontinuity:r,position:a}),!n.isCancelled()&&s.isLastPeriodKnown&&e.period.id===s.periods[s.periods.length-1].id){const t=e.hasFinishedLoading||e.isEmptyStream;t?w.onLastSegmentFinishedLoading(e.bufferType):w.onLastSegmentLoadingResume(e.bufferType)}},needsManifestRefresh:()=>A._manifestFetcher.scheduleManualRefresh({enablePartialRefresh:!0,canUseUnsafeMode:!0}),manifestMightBeOufOfSync:()=>{const{OUT_OF_SYNC_MANIFEST_REFRESH_DELAY:e}=O.getCurrent();A._manifestFetcher.scheduleManualRefresh({enablePartialRefresh:!1,canUseUnsafeMode:!1,delay:e})},lockedStream:e=>T.onLockedStream(e.bufferType,e.period),adaptationChange:e=>{A.trigger("adaptationChange",e),n.isCancelled()||w.onAdaptationChange(e.type,e.period,e.adaptation)},representationChange:e=>{A.trigger("representationChange",e),n.isCancelled()||w.onRepresentationChange(e.type,e.period)},inbandEvent:e=>A.trigger("inbandEvents",e),warning:e=>A.trigger("warning",e),periodStreamReady:e=>A.trigger("periodStreamReady",e),periodStreamCleared:e=>{w.onPeriodCleared(e.type,e.period),n.isCancelled()||A.trigger("periodStreamCleared",e)},bitrateEstimateChange:e=>A.trigger("bitrateEstimateChange",e),needsMediaSourceReload:e=>{C(e.timeOffset,e.minimumPosition,e.maximumPosition)},needsDecipherabilityFlush(){var e,n,i,r;const a=sr(l);if(x(null===a||void 0===a?void 0:a[0])){const r=E.getReference().getValue(),a=r.position.isAwaitingFuturePosition()?r.position.getWanted():null!==(e=E.getCurrentTime())&&void 0!==e?e:r.position.getPolled(),o=null!==(i=null!==(n=r.paused.pending)&&void 0!==n?n:E.getIsPaused())&&void 0!==i?i:r.paused.last;t({position:a,autoPlay:!o})}else{const e=E.getReference().getValue(),t=e.position.isAwaitingFuturePosition()?e.position.getWanted():null!==(r=E.getCurrentTime())&&void 0!==r?r:e.position.getPolled();t+.001<e.duration?c.setCurrentTime(l.currentTime+.001):c.setCurrentTime(t)}},encryptionDataEncountered:e=>{for(const t of e)if(d.setValue(t),n.isCancelled())return},error:e=>A._onFatalError(e)}}function C(e,n,i){var r,a,o;const s=E.getReference().getValue(),l=s.position.isAwaitingFuturePosition()?s.position.getWanted():null!==(r=E.getCurrentTime())&&void 0!==r?r:s.position.getPolled(),u=null!==(o=null!==(a=s.paused.pending)&&void 0!==a?a:E.getIsPaused())&&void 0!==o?o:s.paused.last;let c=l+e;void 0!==n&&(c=Math.max(n,c)),void 0!==i&&(c=Math.min(i,c)),t({position:c,autoPlay:!u})}nr({manifest:s,initialPeriod:g},E,f,y,h,a,R(),n)}_createRebufferingController(e,t,n,i){const r=new Ra(e,t,n);return r.addEventListener("stalled",e=>this.trigger("stalled",e)),r.addEventListener("unstalled",()=>this.trigger("unstalled",null)),r.addEventListener("warning",e=>this.trigger("warning",e)),i.register(()=>r.destroy()),r.start(),r}}function Ha(e,t,n,i){e.updateRepresentationsDeciperability(e=>{const{representation:r}=e;if(void 0===r.contentProtections)return r.decipherable;const a=r.contentProtections.keyIds;if(void 0!==a)for(const o of a){for(const e of n)if(yt(e,o.keyId))return!1;for(const e of t)if(yt(e,o.keyId))return!0;for(const e of i)if(yt(e,o.keyId))return}return r.decipherable})}function Ka(e,t){e.updateRepresentationsDeciperability(e=>{var n,i;const r=e.representation;if(!1===r.decipherable)return!1;const a=null!==(i=null===(n=r.contentProtections)||void 0===n?void 0:n.initData)&&void 0!==i?i:[];for(const o of a)if(void 0===t.type||o.type===t.type){const e=t.values.getFormattedValues().every(e=>{return o.values.some(t=>{return(void 0===e.systemId||t.systemId===e.systemId)&&yt(t.data,e.data)})});if(e)return!1}return r.decipherable})}var za=n("01e1");const Za=200,qa=new Map;function Ya(e){if(r(gr))return za["a"]&&j.error("Compat: Cannot request codec support in a worker without MSE."),!1;if("function"===typeof gr.isTypeSupported){const t=qa.get(e);if(void 0!==t)return t;{const t=gr.isTypeSupported(e);return qa.size>=Za&&qa.clear(),qa.set(e,t),t}}return!0}const Wa=50;class $a{constructor(){this._cachedCodecSupport=new Map}isSupported(e,t){const n=`${null!==e&&void 0!==e?e:""};codecs="${null!==t&&void 0!==t?t:""}"`,i=this._cachedCodecSupport.get(n);if(void 0!==i)return i;this._cachedCodecSupport.size>=Wa&&this._cachedCodecSupport.clear();const r=Ya(n);return this._cachedCodecSupport.set(n,r),r}}const Xa=new $a;var Qa=Xa;function Ja(e,t){let n=e;for(const i of t){const e=eo(n,i);if(null===e)return null;n=e}return n}function eo(e,t){const n=io(e,t);return null!==n?e.subarray(n[1],n[2]):null}function to(e,t){const n=[];let i=e;while(1){const e=io(i,t);if(null===e)return n;he(0!==e[2]&&0!==i.length),n.push(i.subarray(e[1],e[2])),i=i.subarray(e[2])}}function no(e,t){const n=io(e,t);return null!==n?e.subarray(n[0],n[2]):null}function io(e,t){const n=e.length;let i,r,a=0,o=0;while(a+8<=n){if(r=a,o=Hr(e,r),r+=4,i=Hr(e,r),r+=4,0===o)o=n-a;else if(1===o){if(r+8>n)return null;o=Kr(e,r),r+=8}if(o<0)throw new Error("ISOBMFF: Size out of range");if(i===t)return 1970628964===t&&(r+=16),[a,r,a+o];a+=o}return null}function ro(e,t,n,i,r){const a=e.length;let o;for(let s=0;s<a;s+=o){let l=s;o=Hr(e,l),l+=4;const u=Hr(e,l);if(l+=4,0===o)o=a-s;else if(1===o){if(l+8>a)return;o=Kr(e,l),l+=8}if(1970628964===u&&l+16<=a&&Hr(e,l)===t&&Hr(e,l+4)===n&&Hr(e,l+8)===i&&Hr(e,l+12)===r)return l+=16,e.subarray(l,s+o)}}function ao(e){const t=e.length;if(t<8)return j.warn("ISOBMFF: box inferior to 8 bytes, cannot find offsets"),null;let n=0,i=Hr(e,n);n+=4;const r=Hr(e,n);if(n+=4,0===i)i=t;else if(1===i){if(n+8>t)return j.warn("ISOBMFF: box too short, cannot find offsets"),null;i=Kr(e,n),n+=8}if(i<0)throw new Error("ISOBMFF: Size out of range");return 1970628964===r&&(n+=16),[0,n,i]}function oo(e){const t=eo(e,1836019558);return null===t?null:eo(t,1953653094)}function so(e){const t=to(e,1836019558);return t.reduce((e,t)=>{const n=eo(t,1953653094);return null!==n&&e.push(n),e},[])}function lo(e){return eo(e,1835295092)}function uo(e){const t=eo(e,1836019574);if(null===t)return null;const n=eo(t,1953653099);return null===n?null:eo(n,1835297121)}function co(e,t=0){return eo(e.subarray(t),1701671783)}const fo=/^(?:[a-z]+:)?\/\//i,ho=/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/;function po(e){const t=e.lastIndexOf("/");if(t<0)return e.length;if(fo.test(e)){const n=e.indexOf("/");if(n>=0&&t===n+1)return e.length}const n=e.indexOf("?");return n>=0&&n<t?po(e.substring(0,n)):t+1}function go(e,t){const n=yo(e),i=yo(t);if(i.scheme)return _o(i);const r={scheme:n.scheme,authority:n.authority,path:"",query:i.query,fragment:i.fragment};return i.authority?(r.authority=i.authority,r.path=bo(i.path),_o(r)):(""===i.path?(r.path=n.path,i.query||(r.query=n.query)):ji(i.path,"/")?r.path=bo(i.path):r.path=bo(Eo(n,i.path)),_o(r))}const mo=new Map,vo=200;function yo(e){var t,n,i,r,a;if(mo.has(e))return mo.get(e);const o=e.match(ho);let s;return s=null===o?{scheme:"",authority:"",path:"",query:"",fragment:""}:{scheme:null!==(t=o[1])&&void 0!==t?t:"",authority:null!==(n=o[2])&&void 0!==n?n:"",path:null!==(i=o[3])&&void 0!==i?i:"",query:null!==(r=o[4])&&void 0!==r?r:"",fragment:null!==(a=o[5])&&void 0!==a?a:""},mo.size>=vo&&mo.clear(),mo.set(e,s),s}function _o(e){let t="";return e.scheme&&(t+=e.scheme+":"),e.authority&&(t+="//"+e.authority),t+=e.path,e.query&&(t+="?"+e.query),e.fragment&&(t+="#"+e.fragment),t}function bo(e){const t=e.split(/(?=\/)/),n=[];for(let i=0;i<t.length;i++){const e=t[i];".."!==e&&"."!==e&&""!==e&&("/.."!==e?"/."!==e?n.push(e):i===t.length-1&&n.push("/"):(n.pop(),i===t.length-1&&n.push("/")))}return n.join("")}function Eo(e,t){if(e.authority&&""===e.path)return"/"+t;const n=e.path;return n.substring(0,n.lastIndexOf("/")+1)+t}function To(...e){var t,n,i;const r=e.filter(e=>""!==e),a=r.length;if(0===a)return"";if(1===a)return null!==(t=r[0])&&void 0!==t?t:"";{const e=null!==(n=r[0])&&void 0!==n?n:"",t=null!==(i=r[1])&&void 0!==i?i:"",a=go(e,t),o=r.slice(2);return To(a,...o)}}var So=To;const wo="object"===typeof o["a"]&&"function"===typeof o["a"].TextDecoder,Ao="object"===typeof o["a"]&&"function"===typeof o["a"].TextEncoder;function Io(e){const t=new ArrayBuffer(2*e.length),n=new Uint8Array(t);for(let i=0;i<n.length;i+=2){const t=e.charCodeAt(i/2);n[i]=255&t,n[i+1]=t>>8&255}return n}function xo(e){if(wo)try{const t=new TextDecoder("utf-16le");return t.decode(e)}catch(e){const t=e instanceof Error?e:"";j.warn("Utils: could not use TextDecoder to parse UTF-16LE, fallbacking to another implementation",t)}let t="";for(let n=0;n<e.length;n+=2)t+=String.fromCharCode((e[n+1]<<8)+e[n]);return t}function Ro(e){if(Ao)try{const t=new TextEncoder;return t.encode(e)}catch(e){const t=e instanceof Error?e:"";j.warn("Utils: could not use TextEncoder to encode string into UTF-8, fallbacking to another implementation",t)}let t;const n=encodeURIComponent(e);if("function"===typeof unescape)t=unescape(n);else{const e=/[0-9a-fA-F]/,i=n.length;t="";for(let r=0;r<n.length;r++){let a=!1;if("%"===n[r])if(r<=i-6&&"u"===n[r+1]&&e.test(n[r+2])&&e.test(n[r+3])&&e.test(n[r+4])&&e.test(n[r+5])){const e=parseInt(n.substring(r+1,r+6),16);t+=String.fromCharCode(e),a=!0,r+=5}else if(r<=i-3&&e.test(n[r+1])&&e.test(n[r+2])){const e=parseInt(n.substring(r+1,r+3),16);t+=String.fromCharCode(e),a=!0,r+=2}a||(t+=n[r])}}const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=255&t.charCodeAt(r);return i}function Co(e){const t=16e3;let n="";for(let i=0;i<e.length;i+=t){const r=e.subarray(i,i+t);n+=String.fromCharCode.apply(null,r)}return n}function Do(e,t){const n=e.toString(16);return n.length>=t?n:new Array(t-n.length+1).join("0")+n}function ko(e){if(wo)try{const t=new TextDecoder;return t.decode(e)}catch(e){const t=e instanceof Error?e:"";j.warn("Utils: could not use TextDecoder to parse UTF-8, fallbacking to another implementation",t)}let t=e;239===t[0]&&187===t[1]&&191===t[2]&&(t=t.subarray(3));const n=Co(t);let i;if("function"===typeof escape)i=escape(n);else{const e=/[A-Za-z0-9*_\+-\.\/]/;i="";for(let t=0;t<n.length;t++)if(e.test(n[t]))i+=n[t];else{const e=n.charCodeAt(t);i+=e>=256?"%u"+Do(e,4):"%"+Do(e,2)}}return decodeURIComponent(i)}function Mo(e){const t=e.length,n=new Uint8Array(t/2);for(let i=0,r=0;i<t;i+=2,r++)n[r]=255&parseInt(e.substring(i,i+2),16);return n}function Lo(e,t=""){let n="";for(let i=0;i<e.byteLength;i++)n+=(e[i]>>>4).toString(16),n+=(15&e[i]).toString(16),t.length>0&&i<e.byteLength-1&&(n+=t);return n}function Po(e){he(16===e.length,"GUID length should be 16");const t=e[0],n=e[1],i=e[2],r=e[3],a=e[4],o=e[5],s=e[6],l=e[7],u=new Uint8Array(16);return u[0]=r,u[1]=i,u[2]=n,u[3]=t,u[4]=o,u[5]=a,u[6]=l,u[7]=s,u.set(e.subarray(8,16),8),u}function No(e,t){let n=t;while(n<e.length){const t=e[n];if(0===t)break;n+=1}const i=e.subarray(t,n);return{end:n+1,string:ko(i)}}const Oo=Math.pow(2,32)-1,Fo={};function Uo(e){if(void 0!==Fo[e])return Fo[e];const t=Ro(e);return Fo[e]=t,t}function Bo(e,t){const n=t.length+8;return n<=Oo?Gr(Zr(n),Uo(e),t):Gr(Zr(1),Uo(e),qr(n+8),t)}function Go(e,t){return Bo(e,Gr(...t))}function jo(e){const t=[];e.periods.forEach(n=>{const i=n.id;if(gt(t,i)){j.warn("Two periods with the same ID found. Updating.");const r=i+"-dup";n.id=r,jo(e),t.push(r)}else t.push(i);const{adaptations:r}=n,a=[];Object.keys(r).forEach(t=>{const n=r[t];void 0!==n&&n.forEach(t=>{const n=t.id;if(gt(a,n)){j.warn("Two adaptations with the same ID found. Updating.",n);const i=n+"-dup";t.id=i,jo(e),a.push(i)}else a.push(n);const i=[];t.representations.forEach(t=>{const n=t.id;if(gt(i,n)){j.warn("Two representations with the same ID found. Updating.",n);const r=`${n}-dup`;t.id=r,jo(e),i.push(r)}else i.push(n)})})})})}function Vo(e,t){let n;return n="AACH"===t?5:Nt(e)?(248&parseInt(e.substring(0,2),16))>>3:2,0===n?"mp4a.40.2":`mp4a.40.${n}`}function Ho(e){const t=/00000001\d7([0-9a-fA-F]{6})/.exec(e);return null!==t&&Nt(t[1])?"avc1."+t[1]:"avc1.4D401E"}function Ko(e){return e.reduce((t,n,i)=>{const r=n.getAttribute("d"),a=n.getAttribute("t"),o=n.getAttribute("r"),s=null!==o?+o-1:0;let l=null!==a?+a:void 0,u=null!==r?+r:void 0;if(0===i)l=void 0===l||isNaN(l)?0:l;else{const e=t[i-1];if(void 0===l||isNaN(l)){if(void 0===e.duration||isNaN(e.duration))throw new Error("Smooth: Invalid CNodes. Missing timestamp.");l=e.start+e.duration*(e.repeatCount+1)}}if(void 0===u||isNaN(u)){const n=e[i+1];if(void 0===n)return t;{const e=n.getAttribute("t"),t=Nt(e)?+e:null;if(null===t)throw new Error("Can't build index timeline from Smooth Manifest.");u=t-l}}return t.push({duration:u,start:l,repeatCount:s}),t},[])}const zo=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],Zo=[255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,62,255,255,255,63,52,53,54,55,56,57,58,59,60,61,255,255,255,0,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];function qo(e){if(e>=Zo.length)throw new Error("Unable to parse base64 string.");const t=Zo[e];if(255===t)throw new Error("Unable to parse base64 string.");return t}function Yo(e){let t,n="";const i=e.length;for(t=2;t<i;t+=3)n+=zo[e[t-2]>>2],n+=zo[(3&e[t-2])<<4|e[t-1]>>4],n+=zo[(15&e[t-1])<<2|e[t]>>6],n+=zo[63&e[t]];return t===i+1&&(n+=zo[e[t-2]>>2],n+=zo[(3&e[t-2])<<4],n+="=="),t===i&&(n+=zo[e[t-2]>>2],n+=zo[(3&e[t-2])<<4|e[t-1]>>4],n+=zo[(15&e[t-1])<<2],n+="="),n}function Wo(e){const t=e.length%4;let n=e;0!==t&&(j.warn("base64ToBytes: base64 given miss padding"),n+=3===t?"=":2===t?"==":"===");const i=n.indexOf("=");if(-1!==i&&i<n.length-2)throw new Error("Unable to parse base64 string.");const r=n.endsWith("==")?2:n.endsWith("=")?1:0,a=n.length,o=new Uint8Array(a/4*3);let s;for(let l=0,u=0;l<a;l+=4,u+=3)s=qo(n.charCodeAt(l))<<18|qo(n.charCodeAt(l+1))<<12|qo(n.charCodeAt(l+2))<<6|qo(n.charCodeAt(l+3)),o[u]=s>>16,o[u+1]=s>>8&255,o[u+2]=255&s;return o.subarray(0,o.length-r)}function $o(e){const t=Yr(e,8),n=xo(e.subarray(10,t+10)),i=(new DOMParser).parseFromString(n,"application/xml"),r=i.querySelector("KID");if(null===r)throw new Error("Cannot parse PlayReady private data: invalid XML");const a=null===r.textContent?"":r.textContent,o=Po(Wo(a));return Lo(o).toLowerCase()}function Xo(e){return[{systemId:"edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",privateData:Gr([8,1,18,16],e)}]}function Qo(e,t=Xo){if(null===e.firstElementChild||"ProtectionHeader"!==e.firstElementChild.nodeName)throw new Error("Protection should have ProtectionHeader child");const n=e.firstElementChild,i=Wo(null===n.textContent?"":n.textContent),r=$o(i),a=Mo(r),o=n.getAttribute("SystemID"),s=(null!==o?o:"").toLowerCase().replace(/\{|\}/g,"");return{keyId:a,keySystems:[{systemId:s,privateData:i}].concat(t(a))}}function Jo(e,t,n){const{repeatCount:i}=e;if(i>=0)return i;let a;return a=r(t)?void 0!==n?n:Number.MAX_VALUE:t.start,Math.ceil((a-e.start)/e.duration)-1}function es(e,t,n){const{start:i,duration:r}=e;if(r<=0)return i;const a=Jo(e,t,n);return i+(a+1)*r}function ts(e,t){var n;return e*t.timescale+(null!==(n=t.indexTimeOffset)&&void 0!==n?n:0)}function ns(e,t){var n;return(e-(null!==(n=t.indexTimeOffset)&&void 0!==n?n:0))/t.timescale}function is(e,t,n){return[e*n,(e+t)*n]}function rs(e,t){let n=0,i=e.length;while(n<i){const r=n+i>>>1;e[r].start<=t?n=r+1:i=r}return n-1}function as(e,t,n){const{timeline:i}=e,r=ts(t,e);if(r<0)return null;const a=rs(i,r);if(a<0||a>=i.length-1)return null;const o=i[a];if(o.duration<=0)return null;const s=i[a+1];if(void 0===s)return null;const l=s.start,u=es(o,s,n);return r>=u&&r<l?ns(l,e):null}function os(e,t,n){return e.replace(/\{bitrate\}/g,String(t)).replace(/{CustomAttributes}/g,n.length>0?n[0]:"")}function ss(e,t){return e.replace(/\{start time\}/g,String(t))}function ls(e,t,n){const i=t-e;return i>0?Math.floor(i/n):0}function us(e,t,n){const i=void 0===e||0===e?1:e;return{up:t*i,to:(t+n)*i}}function cs(e,t){let n=e.repeatCount;if(void 0!==e.duration&&n<0){const i=void 0!==t?t.start:1/0;n=Math.ceil((i-e.start)/e.duration)-1}return n}class ds{constructor(e){const{isLive:t,segmentPrivateInfos:n,media:i,sharedSmoothTimeline:r}=e;if(this._sharedSmoothTimeline=r,this._initSegmentInfos={bitsPerSample:n.bitsPerSample,channels:n.channels,codecPrivateData:n.codecPrivateData,packetSize:n.packetSize,samplingRate:n.samplingRate,timescale:r.timescale,height:n.height,width:n.width,protection:n.protection},this._isLive=t,this._media=i,0!==r.timeline.length&&t){const{timeline:e,validityTime:t}=r,n=e[e.length-1],i=es(n,null),a=t/1e3*r.timescale;this._scaledLiveGap=a-i}}getInitSegment(){return{id:"init",isInit:!0,privateInfos:{smoothInitSegment:this._initSegmentInfos},url:null,time:0,end:0,duration:0,timescale:1,complete:!0}}getSegments(e,t){this._refreshTimeline();const{timescale:n,timeline:i}=this._sharedSmoothTimeline,{up:r,to:a}=us(n,e,t),o=this._media;let s;const l=[],u=i.length,c=void 0===this._scaledLiveGap?void 0:Te()/1e3*n-this._scaledLiveGap;for(let d=0;d<u;d++){const e=i[d],{duration:t,start:u}=e,f=cs(e,i[d+1]);let h=ls(u,r,t),p=u+h*t;const g=t;while(p<a&&h<=f&&(void 0===c||p+g<=c)){const e=p,i=void 0!==s?s+h:void 0,r={id:String(p),isInit:!1,time:e/n,end:(e+t)/n,duration:t/n,timescale:1,number:i,url:ss(o,e),complete:!0,privateInfos:{smoothMediaSegment:{time:e,duration:t}}};l.push(r),h++,p=u+h*t}if(p>=a)return l;void 0!==s&&(s+=f+1)}return l}shouldRefresh(e,t){if(this._refreshTimeline(),!this._isLive)return!1;const{timeline:n,timescale:i}=this._sharedSmoothTimeline,r=n[n.length-1];if(void 0===r)return!1;const a=r.repeatCount,o=r.start+(a+1)*r.duration;if(t*i<o)return!1;if(e*i>=o)return!0;const s=r.start+a*r.duration;return e*i>s}getFirstAvailablePosition(){this._refreshTimeline();const{timeline:e,timescale:t}=this._sharedSmoothTimeline;return 0===e.length?null:e[0].start/t}getLastAvailablePosition(){this._refreshTimeline();const{timeline:e,timescale:t}=this._sharedSmoothTimeline;if(void 0===this._scaledLiveGap){const n=e[e.length-1];return es(n,null)/t}for(let n=e.length-1;n>=0;n--){const i=e[n],r=Te()/1e3*t,{start:a,duration:o,repeatCount:s}=i;for(let e=s;e>=0;e--){const n=a+o*(e+1),i=n;if(i<=r-this._scaledLiveGap)return n/t}}}getEnd(){if(!this._isLive)return this.getLastAvailablePosition()}awaitSegmentBetween(e,t){var n;if(he(e<=t),this.isStillAwaitingFutureSegments())return!1;const i=this.getLastAvailablePosition();return!(void 0!==i&&t<i)&&(t>(null!==(n=this.getFirstAvailablePosition())&&void 0!==n?n:0)&&void 0)}checkDiscontinuity(e){return this._refreshTimeline(),as(this._sharedSmoothTimeline,e,void 0)}isSegmentStillAvailable(e){if(e.isInit)return!0;this._refreshTimeline();const{timeline:t,timescale:n}=this._sharedSmoothTimeline;for(let i=0;i<t.length;i++){const r=t[i],a=r.start/n;if(a>e.time)return!1;if(a===e.time)return!0;if(r.repeatCount>=0&&void 0!==r.duration){const e=a-r.start,t=e/r.duration-1;return t%1===0&&t<=r.repeatCount}}return!1}canBeOutOfSyncError(e){return!!this._isLive&&(e instanceof ct&&(e.isHttpError(404)||e.isHttpError(412)))}_replace(e){this._initialScaledLastPosition=e._initialScaledLastPosition,this._scaledLiveGap=e._scaledLiveGap,this._sharedSmoothTimeline.replace(e._sharedSmoothTimeline)}_update(e){this._scaledLiveGap=e._scaledLiveGap,this._sharedSmoothTimeline.update(e._sharedSmoothTimeline)}isStillAwaitingFutureSegments(){return this._isLive}isInitialized(){return!0}initialize(){j.error("A `SmoothRepresentationIndex` does not need to be initialized")}addPredictedSegments(e,t){this._sharedSmoothTimeline.addPredictedSegments(e,t)}_refreshTimeline(){this._sharedSmoothTimeline.refresh()}}function fs(e,t){let n=0;while(e.length>0){const i=e[0];if(i.start>=t)return n;if(-1===i.repeatCount)return n;if(0===i.repeatCount)e.shift(),n+=1;else{const r=e[1];if(void 0!==r&&r.start<=t)e.shift(),n+=1;else{if(i.duration<=0)return n;let r=i.start+i.duration,a=1;while(r<t&&a<=i.repeatCount)r+=i.duration,a++;if(!(a>i.repeatCount)){const e=i.repeatCount-a;return i.start=r,i.repeatCount=e,n+=a,n}e.shift(),n=i.repeatCount+1}}}return n}function hs(e,t){if(0===e.length)return e.push(...t),!0;if(0===t.length)return!1;const n=e.length,i=t[0].start,r=e[n-1],a=es(r,t[0]);if(a<i)throw new ut("MANIFEST_UPDATE_ERROR","Cannot perform partial update: not enough data");for(let c=n-1;c>=0;c--){const r=e[c].start;if(r===i){const i=n-c;return e.splice(c,i,...t),!1}if(r<i){const r=e[c];if(r.start+r.duration>i)return j.warn("RepresentationIndex: Manifest update removed all previous segments"),e.splice(0,n,...t),!0;if(void 0===r.repeatCount||r.repeatCount<=0)return r.repeatCount<0&&(r.repeatCount=Math.floor((i-r.start)/r.duration)-1),e.splice(c+1,n-(c+1),...t),!1;const a=r.start+r.duration*(r.repeatCount+1);if(a<=i)return e.splice(c+1,n-(c+1),...t),!1;const o=(i-r.start)/r.duration-1;if(o%1===0&&r.duration===t[0].duration){const i=t[0].repeatCount<0?-1:t[0].repeatCount+o+1;return e.splice(c,n-c,...t),e[c].start=r.start,e[c].repeatCount=i,!1}return j.warn("RepresentationIndex: Manifest update removed previous segments"),e[c].repeatCount=Math.floor(o),e.splice(c+1,n-(c+1),...t),!1}}const o=e[e.length-1],s=t[t.length-1];if(void 0!==o.repeatCount&&o.repeatCount<0)return o.start>s.start?(j.warn("RepresentationIndex: The new index is older than the previous one"),!1):(j.warn('RepresentationIndex: The new index is "bigger" than the previous one'),e.splice(0,n,...t),!0);const l=o.start+o.duration*(o.repeatCount+1),u=s.start+s.duration*(s.repeatCount+1);return l>=u?(j.warn("RepresentationIndex: The new index is older than the previous one"),!1):(j.warn('RepresentationIndex: The new index is "bigger" than the previous one'),e.splice(0,n,...t),!0)}function ps(e,t,n,i){const r=e.length,a=e[r-1],o=n.timescale===t?{time:n.time,duration:n.duration}:{time:n.time/n.timescale*t,duration:n.duration/n.timescale*t},s=i.time===o.time;return!s&&(o.time>=es(a,null)&&(a.duration===o.duration?a.repeatCount++:e.push({duration:o.duration,start:o.time,repeatCount:0}),!0))}class gs{constructor(e){const{timeline:t,timescale:n,timeShiftBufferDepth:i,manifestReceivedTime:r}=e;this.timeline=t,this.timescale=n;const a=null!==r&&void 0!==r?r:Te();if(this.validityTime=a,this._timeShiftBufferDepth=i,0!==t.length){const e=t[t.length-1],n=es(e,null);this._initialScaledLastPosition=n}}refresh(){if(void 0===this._initialScaledLastPosition)return;const e=this._timeShiftBufferDepth,t=(Te()-this.validityTime)/1e3,n=t+this._initialScaledLastPosition/this.timescale;if(void 0!==e){const t=(n-e)*this.timescale;fs(this.timeline,t)}}replace(e){const t=this.timeline,n=e.timeline,i=this.timescale,r=e.timescale;if(this._initialScaledLastPosition=e._initialScaledLastPosition,this.validityTime=e.validityTime,0===t.length||0===n.length||i!==r)return;const a=t[t.length-1],o=n[n.length-1],s=es(o,null);if(!(es(a,null)<=s))for(let l=0;l<t.length;l++){const e=t[l],n=es(e,null);if(n===s)return void(this.timeline=this.timeline.concat(t.slice(l+1)));if(n>s){if(e.duration!==o.duration)return;const n=s-e.start;if(0===n)return j.warn("Smooth Parser: a discontinuity detected in the previous manifest has been resolved."),void(this.timeline=this.timeline.concat(t.slice(l)));if(n<0||n%e.duration!==0)return;const i=n/e.duration-1,r=e.repeatCount-i;if(r<0)return;o.repeatCount+=r;const a=t.slice(l+1);return void(this.timeline=this.timeline.concat(a))}}}update(e){hs(this.timeline,e.timeline),this._initialScaledLastPosition=e._initialScaledLastPosition,this.validityTime=e.validityTime}addPredictedSegments(e,t){var n;if(void 0!==(null===(n=t.privateInfos)||void 0===n?void 0:n.smoothMediaSegment)){this.refresh();for(let n=0;n<e.length;n++)ps(this.timeline,this.timescale,e[n],t.privateInfos.smoothMediaSegment)}else j.warn("Smooth Parser: should only encounter SmoothRepresentationIndex")}}function ms(e){return"boolean"===typeof e?e:"string"===typeof e&&"TRUE"===e.toUpperCase()}function vs(e,t,n){let i=e.firstElementChild,r=n;while(null!==i)r=t(r,i.nodeName,i),i=i.nextElementSibling;return r}const ys={audio:"audio/mp4",video:"video/mp4",text:"application/ttml+xml"},_s={AACL:"audio/mp4",AVC1:"video/mp4",H264:"video/mp4",TTML:"application/ttml+xml+mp4",DFXP:"application/ttml+xml+mp4"};function bs(e={}){const t=void 0===e.referenceDateTime?Date.UTC(1970,0,1,0,0,0,0)/1e3:e.referenceDateTime,n=void 0===e.minRepresentationBitrate?0:e.minRepresentationBitrate,{serverSyncInfos:i}=e,a=void 0!==i?i.serverTimestamp-i.clientTime:void 0;function o(e,t){const n=vs(e,(e,t,n)=>{return"CustomAttributes"===t&&e.push(...vs(n,(e,t,n)=>{if("Attribute"===t){const t=n.getAttribute("Name"),i=n.getAttribute("Value");null!==t&&null!==i&&e.push(t+"="+i)}return e},[])),e},[]);function i(t){const n=e.getAttribute(t);return null===n?void 0:n}switch(t){case"audio":{const e=i("AudioTag"),t=i("BitsPerSample"),r=i("Channels"),a=i("CodecPrivateData"),o=i("FourCC"),s=i("PacketSize"),l=i("SamplingRate"),u=i("Bitrate");let c=void 0===u?0:parseInt(u,10);if(c=isNaN(c)?0:c,void 0!==o&&void 0===_s[o]||void 0===a)return j.warn("Smooth parser: Unsupported audio codec. Ignoring quality level."),null;const d=Vo(a,o);return{audiotag:void 0!==e?parseInt(e,10):e,bitrate:c,bitsPerSample:void 0!==t?parseInt(t,10):t,channels:void 0!==r?parseInt(r,10):r,codecPrivateData:a,codecs:d,customAttributes:n,mimeType:void 0!==o?_s[o]:o,packetSize:void 0!==s?parseInt(s,10):s,samplingRate:void 0!==l?parseInt(l,10):l}}case"video":{const e=i("CodecPrivateData"),t=i("FourCC"),r=i("MaxWidth"),a=i("MaxHeight"),o=i("Bitrate");let s=void 0===o?0:parseInt(o,10);if(s=isNaN(s)?0:s,void 0!==t&&void 0===_s[t]||void 0===e)return j.warn("Smooth parser: Unsupported video codec. Ignoring quality level."),null;const l=Ho(e);return{bitrate:s,customAttributes:n,mimeType:void 0!==t?_s[t]:t,codecPrivateData:e,codecs:l,width:void 0!==r?parseInt(r,10):void 0,height:void 0!==a?parseInt(a,10):void 0}}case"text":{const e=i("CodecPrivateData"),t=i("FourCC"),r=i("Bitrate");let a=void 0===r?0:parseInt(r,10);return a=isNaN(a)?0:a,{bitrate:a,customAttributes:n,mimeType:void 0!==t?_s[t]:t,codecPrivateData:null!==e&&void 0!==e?e:""}}default:return j.error("Smooth Parser: Unrecognized StreamIndex type: "+t),null}}function s(e){const{root:t,timescale:i,baseUrl:a,protections:s,timeShiftBufferDepth:l,manifestReceivedTime:u,isLive:c}=e,d=t.getAttribute("Timescale");let f=null===d?i:+d;isNaN(f)&&(f=i);const h=t.getAttribute("Type");if(null===h)throw new Error("StreamIndex without type.");gt(_t,h)||j.warn("Smooth Parser: Unrecognized adaptation type:",h);const p=h,g=t.getAttribute("Subtype"),m=t.getAttribute("Language"),v=t.getAttribute("Url"),y=null===v?"":v;const{qualityLevels:_,cNodes:b}=vs(t,(e,t,i)=>{switch(t){case"QualityLevel":const r=o(i,p);if(null===r)return e;("video"!==p||r.bitrate>n)&&e.qualityLevels.push(r);break;case"c":e.cNodes.push(i);break}return e},{qualityLevels:[],cNodes:[]}),E=new gs({timeline:Ko(b),timescale:f,timeShiftBufferDepth:l,manifestReceivedTime:u});he(0!==_.length,"Adaptation should have at least one playable representation.");const T=p+(Nt(m)?"_"+m:""),S=_.map(e=>{const t=os(y,e.bitrate,e.customAttributes),n=Nt(e.mimeType)?e.mimeType:ys[p],i=e.codecs,o=T+"_"+(r(p)?"":p+"-")+(r(n)?"":n+"-")+(r(i)?"":i+"-")+String(e.bitrate),l=[];let u;s.length>0&&(u=s[0],s.forEach(e=>{const t=e.keyId;e.keySystems.forEach(e=>{l.push({keyId:t,systemId:e.systemId})})}));const d={bitsPerSample:e.bitsPerSample,channels:e.channels,codecPrivateData:e.codecPrivateData,packetSize:e.packetSize,samplingRate:e.samplingRate,height:e.height,width:e.width,protection:r(u)?void 0:{keyId:u.keyId}},f=new ds({isLive:c,sharedSmoothTimeline:E,media:t,segmentPrivateInfos:d}),h=k({},e,{index:f,cdnMetadata:[{baseUrl:a}],mimeType:n,codecs:i,id:o});if(l.length>0||void 0!==u){const e=void 0===u?[]:u.keySystems.map(e=>{const{systemId:t,privateData:n}=e,i=t.replace(/-/g,""),r=Es(i,n);return{systemId:i,data:r}});if(e.length>0){const t=[{type:"cenc",values:e}];h.contentProtections={keyIds:l,initData:t}}else h.contentProtections={keyIds:l,initData:[]}}return h});if("ADVT"===g)return null;const w={id:T,type:p,representations:S,language:null===m?void 0:m};return"text"===p&&"DESC"===g&&(w.closedCaption=!0),w}function l(n,i,o){let l="";if(void 0!==i){const e=po(i);l=i.substring(0,e)}const u=n.documentElement;if(r(u)||"SmoothStreamingMedia"!==u.nodeName)throw new Error("document root should be SmoothStreamingMedia");const c=u.getAttribute("MajorVersion"),d=u.getAttribute("MinorVersion");if(null===c||null===d||!/^[2]-[0-2]$/.test(c+"-"+d))throw new Error("Version should be 2.0, 2.1 or 2.2");const f=u.getAttribute("Timescale");let h=Nt(f)?+f:1e7;isNaN(h)&&(h=1e7);const{protections:p,adaptationNodes:g}=vs(u,(t,n,i)=>{switch(n){case"Protection":t.protections.push(Qo(i,e.keySystems));break;case"StreamIndex":t.adaptationNodes.push(i);break}return t},{adaptationNodes:[],protections:[]}),m={},v=ms(u.getAttribute("IsLive"));let y;if(v){const e=u.getAttribute("DVRWindowLength");null===e||isNaN(+e)||0===+e||(y=+e/h)}const _=g.reduce((e,t)=>{const n=s({root:t,baseUrl:l,timescale:h,protections:p,isLive:v,timeShiftBufferDepth:y,manifestReceivedTime:o});if(null===n)return e;const i=n.type,r=e[i];return void 0===r?e[i]=[n]:r.push(n),e},m);let b,E,T,S,w=null;const A=void 0!==_.video?_.video[0]:void 0,I=void 0!==_.audio?_.audio[0]:void 0;let x,R,C;if(void 0!==A||void 0!==I){const e=[],t=[];if(void 0!==A){const n=A.representations[0];if(void 0!==n){const i=n.index.getFirstAvailablePosition(),a=n.index.getLastAvailablePosition();r(i)||e.push(i),r(a)||t.push(a)}}if(void 0!==I){const n=I.representations[0];if(void 0!==n){const i=n.index.getFirstAvailablePosition(),a=n.index.getLastAvailablePosition();r(i)||e.push(i),r(a)||t.push(a)}}e.length>0&&(x=Math.max(...e)),t.length>0&&(R=Math.min(...t),C=Math.max(...t))}const D=u.getAttribute("Duration"),k=null!==D&&0!==+D?+D/h:void 0;if(v){b=e.suggestedPresentationDelay,E=t,T=null!==x&&void 0!==x?x:E;let n=C;void 0===n&&(n=Date.now()/1e3-E);let i=R;void 0===i&&(i=n),S={isLinear:!0,maximumSafePosition:i,livePosition:n,time:Te()},w=null!==y&&void 0!==y?y:null}else{T=null!==x&&void 0!==x?x:0;let e=R;void 0===e&&(e=void 0!==k?T+k:1/0),S={isLinear:!1,maximumSafePosition:e,livePosition:void 0,time:Te()}}const M=v?0:T,L=v?void 0:S.maximumSafePosition,P={availabilityStartTime:void 0===E?0:E,clockOffset:a,isLive:v,isDynamic:v,isLastPeriodKnown:!0,timeBounds:{minimumSafePosition:T,timeshiftDepth:w,maximumTimeData:S},periods:[{adaptations:_,duration:void 0!==L?L-M:k,end:L,id:"gen-smooth-period-0",start:M}],suggestedPresentationDelay:b,transportType:"smooth",uris:r(i)?[]:[i]};return jo(P),P}return l}function Es(e,t){if(32!==e.length)throw new Error("HSS: wrong system id length");const n=0;return Bo("pssh",Gr([n,0,0,0],Mo(e),Zr(t.length),t))}var Ts=bs,Ss=Ts;const ws="json";function As(e){const t={url:e.url,headers:e.headers,responseType:r(e.responseType)?ws:e.responseType,timeout:e.timeout,connectionTimeout:e.connectionTimeout};return new Promise((n,i)=>{const{onProgress:a,cancelSignal:o}=e,{url:s,headers:l,responseType:u,timeout:c,connectionTimeout:d}=t,f=new XMLHttpRequest;let h,p;if(f.open("GET",s,!0),void 0!==c&&(f.timeout=c,h=setTimeout(()=>{v(),i(new nt(s,f.status,it.TIMEOUT))},c+3e3)),void 0!==d&&(p=setTimeout(()=>{v(),f.readyState!==XMLHttpRequest.DONE&&f.abort(),i(new nt(s,f.status,it.TIMEOUT))},d)),f.responseType=u,"document"===f.responseType&&f.overrideMimeType("text/xml"),!r(l)){const e=l;for(const t in e)e.hasOwnProperty(t)&&f.setRequestHeader(t,e[t])}const g=Te();let m=null;if(void 0===o||(m=o.register(function(e){v(),f.readyState!==XMLHttpRequest.DONE&&f.abort(),i(e)}),!o.isCancelled())){if(f.onerror=function(){v(),i(new nt(s,f.status,it.ERROR_EVENT))},f.ontimeout=function(){v(),i(new nt(s,f.status,it.TIMEOUT))},void 0!==d&&(f.onreadystatechange=function(){f.readyState>=XMLHttpRequest.HEADERS_RECEIVED&&clearTimeout(p)}),void 0!==a&&(f.onprogress=function(e){const t=Te();a({url:s,duration:t-g,sendingTime:g,currentTime:t,size:e.loaded,totalSize:e.total})}),f.onload=function(e){if(f.readyState===XMLHttpRequest.DONE)if(v(),f.status>=200&&f.status<300){const t=Te(),a=f.response instanceof ArrayBuffer?f.response.byteLength:e.total,o=f.status,l=f.responseType,u=Nt(f.responseURL)?f.responseURL:s;let c;if(c="json"===l?"object"===typeof f.response?f.response:Is(f.responseText):f.response,r(c))return void i(new nt(s,f.status,it.PARSE_ERROR));n({status:o,url:u,responseType:l,sendingTime:g,receivedTime:t,requestDuration:t-g,size:a,responseData:c})}else i(new nt(s,f.status,it.ERROR_HTTP_CODE))},j.hasLevel("DEBUG")){let t="XHR: Sending GET "+s;void 0!==e.responseType&&(t+=" type="+e.responseType),void 0!==c&&(t+=" to="+String(c/1e3)),void 0!==d&&(t+=" cto="+String(d/1e3)),void 0!==(null===l||void 0===l?void 0:l.Range)&&(t+=" Range="+(null===l||void 0===l?void 0:l.Range)),j.debug(t)}f.send()}function v(){void 0!==h&&clearTimeout(h),void 0!==p&&clearTimeout(p),null!==m&&m()}})}function Is(e){try{return JSON.parse(e)}catch(e){return null}}var xs=As;function Rs(e,t){const n=e.length;let i=0;while(i+8<=n){let r=Hr(e,i);if(0===r)r=n-i;else if(1===r){if(i+16>n)return-1;r=Kr(e,i+8)}if(isNaN(r)||r<=0)return-1;const a=Hr(e,i+4);if(a===t)return i+r<=n?i:-1;i+=r}return-1}function Cs(e,t){if(t){const t=Rs(e,1718909296);if(t<0)throw new dt("INTEGRITY_ERROR","Incomplete `ftyp` box");const n=Rs(e,1836019574);if(n<0)throw new dt("INTEGRITY_ERROR","Incomplete `moov` box")}else{const t=Rs(e,1836019558);if(t<0)throw new dt("INTEGRITY_ERROR","Incomplete `moof` box");const n=Rs(e,1835295092);if(n<0)throw new dt("INTEGRITY_ERROR","Incomplete `mdat` box")}}function Ds(e,t){return(n,i,r)=>{return new Promise((a,o)=>{const s=Date.now()-Te();let l=!1;const u=e=>{if(l||r.isCancelled())return;l=!0,r.deregister(p);const t=void 0!==e.receivingTime?e.receivingTime-s:void 0,n=void 0!==e.sendingTime?e.sendingTime-s:void 0;a({responseData:e.data,size:e.size,requestDuration:e.duration,url:e.url,receivedTime:t,sendingTime:n})},c=e=>{var t,n;if(l||r.isCancelled())return;l=!0,r.deregister(p);const i=e,a=null!==(t=null===i||void 0===i?void 0:i.message)&&void 0!==t?t:"Unknown error when fetching the Manifest through a custom manifestLoader.",s=new ln(a,null!==(n=null===i||void 0===i?void 0:i.canRetry)&&void 0!==n&&n,null===i||void 0===i?void 0:i.xhr);o(s)},d=()=>{l||r.isCancelled()||(l=!0,r.deregister(p),t(n,i,r).then(a,o))},f={reject:c,resolve:u,fallback:d},h=e({url:n,timeout:i.timeout},f);function p(e){l||(l=!0,"function"===typeof h&&h(),o(e))}r.register(p)})}}function ks(e){return function(t,n,i){if(void 0===t)throw new Error("Cannot perform HTTP(s) request. URL not known");switch(e){case"arraybuffer":return xs({url:t,responseType:"arraybuffer",timeout:n.timeout,connectionTimeout:n.connectionTimeout,cancelSignal:i});case"text":return xs({url:t,responseType:"text",timeout:n.timeout,connectionTimeout:n.connectionTimeout,cancelSignal:i});case"document":return xs({url:t,responseType:"document",timeout:n.timeout,connectionTimeout:n.connectionTimeout,cancelSignal:i});default:ge(e)}}}function Ms({customManifestLoader:e},t){const n=ks(t);return"function"!==typeof e?n:Ds(e,n)}function Ls(e,t){const n=io(e,1936286840);if(null===n)return null;let i=t;const r=n[2]-n[0];let a=n[1];const o=e[a];a+=8;const s=Hr(e,a);let l;if(a+=4,0===o)l=Hr(e,a),a+=4,i+=Hr(e,a)+r,a+=4;else{if(1!==o)return null;l=Kr(e,a),a+=8,i+=Kr(e,a)+r,a+=8}const u=[];a+=2;let c=jr(e,a);a+=2;while(--c>=0){const t=Hr(e,a);a+=4;const n=(2147483648&t)>>>31,r=2147483647&t;if(1===n)throw new Error("sidx with reference_type `1` not yet implemented");const o=Hr(e,a);a+=4,a+=4,u.push({time:l,duration:o,timescale:s,range:[i,i+r-1]}),l+=o,i+=r}return u}function Ps(e){const t=oo(e);if(null===t)return;const n=eo(t,1952867444);if(null===n)return;const i=n[0];return 1===i?Kr(n,4):0===i?Hr(n,4):void 0}function Ns(e){const t=eo(e,1952868452);if(null===t)return;let n=1;const i=Vr(t,n);n+=3;const r=(1&i)>0,a=(2&i)>0,o=(8&i)>0;if(!o)return;n+=4,r&&(n+=8),a&&(n+=4);const s=Hr(t,n);return s}function Os(e){const t=so(e);if(0===t.length)return;let n=0;for(const i of t){const e=eo(i,1953658222);if(null===e)return;let t=0;const r=e[t];if(t+=1,r>1)return;const a=Vr(e,t);t+=3;const o=(256&a)>0;let s=0;if(!o&&(s=Ns(i),void 0===s))return;const l=(1&a)>0,u=(4&a)>0,c=(512&a)>0,d=(1024&a)>0,f=(2048&a)>0,h=Hr(e,t);t+=4,l&&(t+=4),u&&(t+=4);let p=h,g=0;while(p-- >0)o?(g+=Hr(e,t),t+=4):g+=s,c&&(t+=4),d&&(t+=4),f&&(t+=4);n+=g}return n}function Fs(e){const t=uo(e);if(null===t)return;const n=eo(t,1835296868);if(null===n)return;let i=0;const r=n[i];return i+=4,1===r?Hr(n,i+16):0===r?Hr(n,i+8):void 0}function Us(e){const t=e.length;if(t<4)throw new Error("Cannot update box length: box too short");const n=Hr(e,0);if(0===n){if(t>Oo){const n=new Uint8Array(t+8);return n.set(Zr(1),0),n.set(e.subarray(4,8),4),n.set(qr(t+8),8),n.set(e.subarray(8,t),16),n}return e.set(Zr(t),0),e}if(1===n){if(t<16)throw new Error("Cannot update box length: box too short");return e.set(qr(t),8),e}if(t<=Oo)return e.set(Zr(t),0),e;{const n=new Uint8Array(t+8);return n.set(Zr(1),0),n.set(e.subarray(4,8),4),n.set(qr(t+8),8),n.set(e.subarray(8,t),16),n}}function Bs(e){const t=[];let n=0;while(n<e.length){const i=co(e,n);if(null===i)break;const r=i.length;n+=r;const a=i[0];if(0!==a)j.warn("ISOBMFF: EMSG version "+a.toString()+" not supported.");else{let e=4;const{end:n,string:a}=No(i,e);e=n;const{end:o,string:s}=No(i,e);e=o;const l=Hr(i,e);e+=4;const u=Hr(i,e);e+=4;const c=Hr(i,e);e+=4;const d=Hr(i,e);e+=4;const f=i.subarray(e,r),h={schemeIdUri:a,value:s,timescale:l,presentationTimeDelta:u,eventDuration:c,id:d,messageData:f};t.push(h)}}if(0!==t.length)return t}function Gs(e){const t=Ja(e,[1836019574,1953653099,1835297121,1835626086,1937007212,1937011556]);if(null===t)return null;const n=t.subarray(8);let i=eo(n,1701733238),r=0;if(null===i?(r=28,i=eo(n,1701733217)):r=78,null===i)return null;const a=Ja(i.subarray(r),[1936289382,1935894633,1952804451]);if(null===a||a.byteLength<24)return null;const o=a.subarray(8,24);return o.every(e=>0===e)?null:o}function js(e){const t=ro(e,3565190898,3392751253,2387879627,2655430559);if(void 0===t)return[];const n=[],i=t[0],r=t[4];for(let a=0;a<r;a++){let e,r;1===i?(r=Kr(t,16*a+5),e=Kr(t,16*a+5+8)):(r=Hr(t,8*a+5),e=Hr(t,8*a+5+4)),n.push({time:r,duration:e})}return n}function Vs(e){const t=ro(e,1830656773,1121273062,2162299933,2952222642);if(void 0!==t)return{duration:Kr(t,12),time:Kr(t,4)}}function Hs(e,t,n,i,r){var a;const o=[];let s,l,u;if(r){const t=oo(e);null!==t?(u=js(t),l=Vs(t)):j.warn("smooth: could not find traf atom")}if(void 0!==u)for(let p=0;p<u.length;p++)o.push({time:u[p].time,duration:u[p].duration,timescale:n});if(void 0!==l)return s={time:l.time/n,duration:l.duration/n},{nextSegments:o,chunkInfos:s,scaledSegmentTime:l.time};if(t||!i.complete)return{nextSegments:o,chunkInfos:null,scaledSegmentTime:void 0};const c=i.duration*n,d=Math.min(.9*n,c/4),f=Os(e),h=void 0!==(null===(a=i.privateInfos)||void 0===a?void 0:a.smoothMediaSegment)?i.privateInfos.smoothMediaSegment.time:Math.round(i.time*n);return s=void 0!==f&&Math.abs(f-c)<=d?{time:i.time,duration:f/n}:{time:i.time,duration:i.duration},{nextSegments:o,chunkInfos:s,scaledSegmentTime:h}}function Ks(e){return"string"===typeof e&&e.indexOf("mp4")>=0}function zs(){return!f}function Zs(e,t,n,i,r,a,o){return Bo("avc1",Gr(6,zr(1),16,zr(e),zr(t),zr(n),2,zr(i),6,[0,1,r.length],Ro(r),31-r.length,zr(a),[255,255],o))}function qs(e,t,n,i,r,a,o,s){return Bo("encv",Gr(6,zr(1),16,zr(e),zr(t),zr(n),2,zr(i),6,[0,1,r.length],Ro(r),31-r.length,zr(a),[255,255],o,s))}function Ys(e,t,n,i,r,a){return Bo("mp4a",Gr(6,zr(e),8,zr(t),zr(n),2,zr(i),zr(r),2,a))}function Ws(e,t,n,i,r,a,o){return Bo("enca",Gr(6,zr(e),8,zr(t),zr(n),2,zr(i),zr(r),2,a,o))}function $s(e){return Bo("dref",Gr(7,[1],e))}function Xs(e,t){const n=Gr(...[Ro(e),[0,0,0,1]].concat(t.map(Ro)));return Bo("ftyp",n)}function Qs(e,t){return Bo("schm",Gr(4,Ro(e),Zr(t)))}function Js(e){return Bo("tfdt",Gr([1,0,0,0],qr(e)))}function el(){const e=new Uint8Array(12);return e[3]=1,Bo("vmhd",e)}function tl(e){return Bo("trex",Gr(4,Zr(e),[0,0,0,1],12))}function nl(e){return Bo("free",new Uint8Array(e-8))}function il(e,t){return Bo("esds",Gr(4,[3,25],zr(e),[0,4,17,64,21],11,[5,2],Mo(t),[6,1,2]))}function rl(e){return Bo("frma",Ro(e))}function al(e,t,n){let i;i=2===n?1:4===n?3:0;const r=e[1],a=e[2],o=e[3];return Bo("avcC",Gr([1,r,a,o,252|i,225],zr(e.length),e,[1],zr(t.length),t))}function ol(e){let t,n;switch(e){case"video":t="vide",n="VideoHandler";break;case"audio":t="soun",n="SoundHandler";break;default:t="hint",n="";break}return Bo("hdlr",Gr(8,Ro(t),12,Ro(n),1))}function sl(e){return Bo("mdhd",Gr(12,Zr(e),8))}function ll(e,t){return Bo("mvhd",Gr(12,Zr(e),4,[0,1],2,[1,0],10,[0,1],14,[0,1],14,[64,0,0,0],26,zr(t+1)))}function ul(e,t,n,i){return Bo("saio",Gr(4,[0,0,0,1],Zr(e.length+t.length+n.length+i.length+8+8+8+8)))}function cl(e){if(0===e.length)return Bo("saiz",new Uint8Array(0));const t=Hr(e,0),n=Hr(e,4),i=new Uint8Array(n+9);i.set(Zr(n),5);let r,a,o=9,s=8;while(s<e.length)s+=8,2===(2&t)?(a=2,r=jr(e,s),s+=6*r+2):(r=0,a=0),i[o]=6*r+8+a,o++;return Bo("saiz",i)}function dl(){return Bo("smhd",new Uint8Array(8))}function fl(e){const t=[7,[e.length]];return Bo("stsd",Gr(...t.concat(e)))}function hl(e,t,n){return Bo("tkhd",Gr(Zr(7),8,Zr(n),20,[1,0,0,0],[0,1,0,0],12,[0,1,0,0],12,[64,0,0,0],zr(e),2,zr(t),2))}function pl(e,t,n){return Bo("tenc",Gr(6,[e,t],n))}function gl(e,t,n,i,r){const a=[e,t,n];return void 0!==r&&a.push(Bo("senc",r),cl(r),ul(i,e,t,n)),Go("traf",a)}function ml(e,t){const n=io(e,1836019558);if(null===n)throw new Error("Smooth: Invalid ISOBMFF given");const i=e.subarray(n[1],n[2]),r=no(i,1835427940),a=eo(i,1953653094);if(null===a||null===r)throw new Error("Smooth: Invalid ISOBMFF given");const o=io(a,1952868452),s=io(a,1953658222);if(null===o||null===s)throw new Error("Smooth: Invalid ISOBMFF given");const l=a.subarray(o[0],o[2]),u=a.subarray(s[0],s[2]);l.set([0,0,0,1],o[1]-o[0]+4);const c=Js(t),d=vl(u,s[1]-s[0]),f=ro(a,2721664850,1520127764,2722393154,2086964724),h=gl(l,c,d,r,f),p=Go("moof",[r,h]),g=io(p,1836019558),m=io(h,1953653094),v=io(d,1953658222);if(null===g||null===m||null===v)throw new Error("Smooth: Invalid moof, trun or traf generation");const y=g[1]-g[0]+r.length+(m[1]-m[0])+l.length+c.length+(v[1]-v[0])+8,_=n[2]-n[0],b=p.length-_,E=io(e,1835295092);if(null===E)throw new Error("Smooth: Invalid ISOBMFF given");if(zs()&&(0===b||b<=-8)){const t=E[1];return p.set(Zr(t),y),e.set(p,n[0]),b<=-8&&e.set(nl(-b),p.length),e}{const t=E[1]+b;p.set(Zr(t),y);const i=new Uint8Array(e.length+b),r=e.subarray(0,n[0]),a=e.subarray(n[2],e.length);return i.set(r,0),i.set(p,r.length),i.set(a,r.length+p.length),i}}function vl(e,t){const n=(1&e[t+3])>0;if(n)return e;const i=new Uint8Array(e.length+4);return i.set(e.subarray(0,t+8),0),i[t+3]=1|i[t+3],i.set([0,0,0,0],t+8),i.set(e.subarray(t+8,e.length),t+12),Us(i)}function yl([e,t]){return t===1/0?`bytes=${e}-`:`bytes=${e}-${t}`}function _l(e,t,n){const i=[e,t,n];return Go("moov",i)}function bl(e,t,n,i,r,a){const o=Go("stbl",[n,Bo("stts",new Uint8Array(8)),Bo("stsc",new Uint8Array(8)),Bo("stsz",new Uint8Array(12)),Bo("stco",new Uint8Array(8))]),s=Bo("url ",new Uint8Array([0,0,0,1])),l=$s(s),u=Go("dinf",[l]),c=Go("minf",[i,u,o]),d=ol(t),f=sl(e),h=Go("mdia",[f,d,c]),p=hl(r,a,1),g=Go("trak",[p,h]),m=tl(1),v=Go("mvex",[m]),y=ll(e,1),_=_l(y,v,g),b=Xs("isom",["isom","iso2","iso6","avc1","dash"]);return Gr(b,_)}function El(e,t,n,i,r,a,o,s){const[,l,u]=o.split("00000001");if(void 0===l||void 0===u)throw new Error("Smooth: unsupported codec private data.");const c=Mo(l),d=Mo(u),f=al(c,d,a);let h;if(void 0===s){const e=Zs(t,n,i,r,"AVC Coding",24,f);h=fl([e])}else{const e=pl(1,8,s),a=Go("schi",[e]),o=Qs("cenc",65536),l=rl("avc1"),u=Go("sinf",[l,o,a]),c=qs(t,n,i,r,"AVC Coding",24,f,u);h=fl([c])}return bl(e,"video",h,el(),t,n)}const Tl=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];function Sl(e,t,n){const i=Tl.indexOf(t);let r;return r=(63&e)<<4,r=(r|31&i)<<4,r=(r|31&n)<<3,Lo(zr(r))}function wl(e,t,n,i,r,a,o){const s=0===a.length?Sl(2,r,t):a,l=il(1,s),u=(()=>{if(void 0===o){const e=Ys(1,t,n,i,r,l);return fl([e])}const e=pl(1,8,o),a=Go("schi",[e]),s=Qs("cenc",65536),u=rl("mp4a"),c=Go("sinf",[u,s,a]),d=Ws(1,t,n,i,r,l,c);return fl([d])})();return bl(e,"audio",u,dl(),0,0)}function Al(e,t,n,i,r,a){let o;const s=t.segment.range;return Array.isArray(s)&&(o={Range:yl(s)}),xs({url:e,responseType:"arraybuffer",headers:o,timeout:i.timeout,connectionTimeout:i.connectionTimeout,cancelSignal:r,onProgress:n.onProgress}).then(e=>{const n=Ks(t.mimeType);if(!n||!0!==a)return{resultType:"segment-loaded",resultData:e};const i=new Uint8Array(e.responseData);return Cs(i,t.segment.isInit),{resultType:"segment-loaded",resultData:Object.assign(Object.assign({},e),{responseData:i})}})}const Il=({checkMediaSegmentIntegrity:e,segmentLoader:t})=>(n,i,r,a,o)=>{const{segment:s}=i;if(s.isInit){if(void 0===s.privateInfos||void 0===s.privateInfos.smoothInitSegment)throw new Error("Smooth: Invalid segment format");const e=s.privateInfos.smoothInitSegment;let t;const{codecPrivateData:n,timescale:r,height:a,width:o,protection:l={keyId:void 0,keySystems:void 0}}=e;if(void 0===n)throw new Error("Smooth: no codec private data.");switch(i.type){case"video":t=El(r,null!==o&&void 0!==o?o:0,null!==a&&void 0!==a?a:0,72,72,4,n,l.keyId);break;case"audio":{const{channels:i=0,bitsPerSample:a=0,packetSize:o=0,samplingRate:s=0}=e;t=wl(r,i,a,o,s,n,l.keyId);break}default:0,t=new Uint8Array(0)}return Promise.resolve({resultType:"segment-created",resultData:t})}return null===n?Promise.resolve({resultType:"segment-created",resultData:null}):"function"!==typeof t?Al(n,i,o,r,a,e):new Promise((s,l)=>{let u=!1;const c=t=>{if(u||a.isCancelled())return;u=!0,a.deregister(y);const n=Ks(i.mimeType);n&&!0===e||s({resultType:"segment-loaded",resultData:{responseData:t.data,size:t.size,requestDuration:t.duration}});const r=t.data instanceof Uint8Array?t.data:new Uint8Array(t.data);Cs(r,i.segment.isInit),s({resultType:"segment-loaded",resultData:{responseData:r,size:t.size,requestDuration:t.duration}})},d=e=>{var t,n;if(u||a.isCancelled())return;u=!0,a.deregister(y);const i=e,r=null!==(t=null===i||void 0===i?void 0:i.message)&&void 0!==t?t:"Unknown error when fetching a Smooth segment through a custom segmentLoader.",o=new ln(r,null!==(n=null===i||void 0===i?void 0:i.canRetry)&&void 0!==n&&n,null===i||void 0===i?void 0:i.xhr);l(o)},f=e=>{u||a.isCancelled()||o.onProgress({duration:e.duration,size:e.size,totalSize:e.totalSize})},h=()=>{u||a.isCancelled()||(u=!0,a.deregister(y),Al(n,i,o,r,a,e).then(s,l))},p={reject:d,resolve:c,fallback:h,progress:f};let g;void 0!==i.segment.range&&(g=[i.segment.range],void 0!==i.segment.indexRange&&g.push(i.segment.indexRange));const m={isInit:i.segment.isInit,timeout:r.timeout,byteRanges:g,trackType:i.type,url:n},v=t(m,p);function y(e){u||(u=!0,u||"function"!==typeof v||v(),l(e))}a.register(y)})};var xl=Il;function Rl(e,t){return null===e?null:null===t.url?e.baseUrl:So(e.baseUrl,t.url)}var Cl=function(e){const t=Ss(e),n=xl(e),i={customManifestLoader:e.manifestLoader},r=Ms(i,"text"),a={loadManifest:r,parseManifest(n,i){var r;const a=null!==(r=n.url)&&void 0!==r?r:i.originalUrl,{receivedTime:o,responseData:s}=n,l="string"===typeof s?(new DOMParser).parseFromString(s,"text/xml"):s,u=t(l,a,o),c=[],d=new on(u,{representationFilter:e.representationFilter},c);return{manifest:d,url:a,warnings:c}}},o={loadSegment(e,t,i,r,a){const o=Rl(e,t.segment);return n(o,t,i,r,a)},parseSegment(e,t,n){var i,r;const{segment:a}=t,{data:o,isChunked:s}=e;if(null===o)return a.isInit?{segmentType:"init",initializationData:null,initializationDataSize:0,protectionData:[],initTimescale:void 0}:{segmentType:"media",chunkData:null,chunkInfos:null,chunkOffset:0,chunkSize:0,protectionData:[],appendWindow:[void 0,void 0]};const l=o instanceof Uint8Array?o:new Uint8Array(o);if(a.isInit){const e=null===(r=null===(i=a.privateInfos)||void 0===i?void 0:i.smoothInitSegment)||void 0===r?void 0:r.timescale;return{segmentType:"init",initializationData:o,initializationDataSize:o.byteLength,initTimescale:e,protectionData:[]}}const u=void 0!==n?Hs(l,s,n,a,t.isLive):null;if(null===u||null===u.chunkInfos||void 0===u.scaledSegmentTime)throw new Error("Smooth Segment without time information");const{nextSegments:c,chunkInfos:d,scaledSegmentTime:f}=u,h=ml(l,f),p=c.length>0?c:void 0;return{segmentType:"media",chunkData:h,chunkInfos:d,chunkOffset:0,chunkSize:h.length,protectionData:[],predictedSegments:p,appendWindow:[void 0,void 0]}}},s={loadSegment(t,n,i,r,a){const{segment:o}=n,s=Rl(t,o);if(o.isInit||null===s)return Promise.resolve({resultType:"segment-created",resultData:null});const l=Ks(n.mimeType);return l?xs({url:s,responseType:"arraybuffer",timeout:i.timeout,connectionTimeout:i.connectionTimeout,cancelSignal:r,onProgress:a.onProgress}).then(t=>{if(!0!==e.checkMediaSegmentIntegrity)return{resultType:"segment-loaded",resultData:t};const i=new Uint8Array(t.responseData);return Cs(i,n.segment.isInit),{resultType:"segment-loaded",resultData:Object.assign(Object.assign({},t),{responseData:i})}}):xs({url:s,responseType:"text",timeout:i.timeout,connectionTimeout:i.connectionTimeout,cancelSignal:r,onProgress:a.onProgress}).then(e=>({resultType:"segment-loaded",resultData:e}))},parseSegment(e,t,n){var i;const{segment:r,language:a,mimeType:o="",codecs:s=""}=t,l=Ks(t.mimeType),{data:u,isChunked:c}=e;let d,f;if(r.isInit)return{segmentType:"init",initializationData:null,initializationDataSize:0,protectionData:[],initTimescale:void 0};if(null===u)return{segmentType:"media",chunkData:null,chunkInfos:null,chunkOffset:0,chunkSize:0,protectionData:[],appendWindow:[void 0,void 0]};let h,p,g,m,v=null;if(l){let e;e="string"===typeof u?Ro(u):u instanceof Uint8Array?u:new Uint8Array(u),d=e.length;const a=void 0!==n?Hs(e,c,n,r,t.isLive):null;f=null===a||void 0===a?void 0:a.nextSegments,v=null!==(i=null===a||void 0===a?void 0:a.chunkInfos)&&void 0!==i?i:null,null===v?c?j.warn("Smooth: Unavailable time data for current text track."):(h=r.time,p=r.end):(h=v.time,p=void 0!==v.duration?v.time+v.duration:r.end);const l=s.toLowerCase();if("application/ttml+xml+mp4"===o||"stpp"===l||"stpp.ttml.im1t"===l)m="ttml";else{if("wvtt"!==l)throw new Error(`could not find a text-track parser for the type ${o}`);m="vtt"}const y=lo(e);g=null===y?"":ko(y)}else{let e;if(h=r.time,p=r.end,"string"!==typeof u){const t=u instanceof Uint8Array?u:new Uint8Array(u);d=t.length,e=ko(t)}else e=u;switch(o){case"application/x-sami":case"application/smil":m="sami";break;case"application/ttml+xml":m="ttml";break;case"text/vtt":m="vtt";break}if(void 0===m){const e=s.toLowerCase();if("srt"!==e)throw new Error(`could not find a text-track parser for the type ${o}`);m="srt"}g=e}const y=Array.isArray(f)&&f.length>0?f:void 0,_=null!==h&&void 0!==h?h:0;return{segmentType:"media",chunkData:{type:m,data:g,start:h,end:p,language:a},chunkSize:d,chunkInfos:v,chunkOffset:_,protectionData:[],predictedSegments:y,appendWindow:[void 0,void 0]}}};return{manifest:a,audio:o,video:o,text:s}},Dl=Cl;function kl(e){void 0===e.transports.smooth&&(e.transports.smooth=Dl),e.mainThreadMediaSourceInit=Va,e.codecSupportProber=Qa}class Ml{constructor(){this._refs=new Map,this._stored=[]}addReferences(e){for(const t of e)void 0!==t.attributes.refId&&this._refs.set(t.attributes.refId,t)}add(e,t){this._tryParsing(e,t,!1)||this._stored.push([e,t]),void 0!==t.attributes.refId&&(this._refs.set(t.attributes.refId,t),this._resolveStoredRefs(!1))}finalize(){this._resolveStoredRefs(!0)}_resolveStoredRefs(e){for(let t=this._stored.length-1;t>=0;t--){const[n,i]=this._stored[t];(this._tryParsing(n,i,e)||e)&&this._stored.splice(t,1)}return 0===this._stored.length}_tryParsing(e,t,n){if(void 0===t.attributes.ref)return Ll(e,t),!0;const i=this._getReferenced(t.attributes.ref);return void 0===i?(n&&(j.warn("DASH: forcing the parsing of a referencing ContentProtection"),Ll(e,t)),!1):(t.children.cencPssh.push(...i.children.cencPssh),void 0===t.attributes.keyId&&void 0!==i.attributes.keyId&&(t.attributes.keyId=i.attributes.keyId),void 0===t.attributes.schemeIdUri&&void 0!==i.attributes.schemeIdUri&&(t.attributes.schemeIdUri=i.attributes.schemeIdUri),void 0===t.attributes.value&&void 0!==i.attributes.value&&(t.attributes.value=i.attributes.value),Ll(e,t),!0)}_getReferenced(e){return this._refs.get(e)}}function Ll(e,t){let n;if(void 0!==t.attributes.schemeIdUri&&"urn:uuid:"===t.attributes.schemeIdUri.substring(0,9)&&(n=t.attributes.schemeIdUri.substring(9).replace(/-/g,"").toLowerCase()),void 0!==t.attributes.keyId&&t.attributes.keyId.length>0){const i={keyId:t.attributes.keyId,systemId:n};void 0===e.contentProtections?e.contentProtections={keyIds:[i],initData:[]}:void 0===e.contentProtections.keyIds?e.contentProtections.keyIds=[i]:e.contentProtections.keyIds.push(i)}if(void 0===n)return;const{cencPssh:i}=t.children,r=[];for(const o of i)r.push({systemId:n,data:o});if(0===r.length)return;if(void 0===e.contentProtections)return void(e.contentProtections={keyIds:[],initData:[{type:"cenc",values:r}]});const a=De(e.contentProtections.initData,e=>"cenc"===e.type);void 0===a?e.contentProtections.initData.push({type:"cenc",values:r}):a.values.push(...r)}function Pl(e){const t=Date.parse(e)-Te();if(!isNaN(t))return t;j.warn("DASH Parser: Invalid clock received: ",e)}function Nl(e){const t=e.children.utcTimings.filter(e=>("urn:mpeg:dash:utc:http-iso:2014"===e.schemeIdUri||"urn:mpeg:dash:utc:http-xsdate:2014"===e.schemeIdUri)&&void 0!==e.value);return t.length>0?t[0].value:void 0}function Ol(e){const{representations:t}=e;let n=null;for(let i=0;i<t.length;i++){const e=t[i].index.getLastAvailablePosition();if(void 0===e)return;null!==e&&(n=null===n?e:Math.min(n,e))}return null===n?null:n}function Fl(e){for(let t=e.length-1;t>=0;t--){const n=e[t].adaptations,i=void 0===n.audio?void 0:n.audio[0],r=void 0===n.video?void 0:n.video[0];if(void 0!==i||void 0!==r){let e=null,t=null;if(void 0!==i){const t=Ol(i);if(void 0===t)return{safe:void 0,unsafe:void 0};e=t}if(void 0!==r){const e=Ol(r);if(void 0===e)return{safe:void 0,unsafe:void 0};t=e}if(void 0!==i&&null===e||void 0!==r&&null===t)return j.info("Parser utils: found Period with no segment. ","Going to previous one to calculate last position"),{safe:void 0,unsafe:void 0};if(null!==t)return null!==e?{safe:Math.min(e,t),unsafe:Math.max(e,t)}:{safe:t,unsafe:t};if(null!==e)return{safe:e,unsafe:e}}}return{safe:void 0,unsafe:void 0}}function Ul(e){const{representations:t}=e;let n=null;for(let i=0;i<t.length;i++){const e=t[i].index.getFirstAvailablePosition();if(void 0===e)return;null!==e&&(n=null===n?e:Math.max(n,e))}return null===n?null:n}function Bl(e){for(let t=0;t<=e.length-1;t++){const n=e[t].adaptations,i=void 0===n.audio?void 0:n.audio[0],r=void 0===n.video?void 0:n.video[0];if(void 0!==i||void 0!==r){let e=null,t=null;if(void 0!==i){const t=Ul(i);if(void 0===t)return;e=t}if(void 0!==r){const e=Ul(r);if(void 0===e)return;t=e}if(void 0!==i&&null===e||void 0!==r&&null===t)return void j.info("Parser utils: found Period with no segment. ","Going to next one to calculate first position");if(null!==t)return null!==e?Math.max(e,t):t;if(null!==e)return e}}}function Gl(e){if(0===e.length)throw new Error("DASH Parser: no period available for a dynamic content");const t=Bl(e),n=Fl(e);return{minimumSafePosition:t,maximumSafePosition:n.safe,maximumUnsafePosition:n.unsafe}}class jl{constructor(e){this._isDynamic=e.isDynamic,this._timeShiftBufferDepth=e.isDynamic&&void 0!==e.timeShiftBufferDepth?e.timeShiftBufferDepth:null,this._serverTimestampOffset=e.serverTimestampOffset,this._availabilityStartTime=e.availabilityStartTime}setLastPosition(e,t){this._lastPosition=e,this._positionTime=t}lastPositionIsKnown(){return this._isDynamic?void 0!==this._positionTime&&void 0!==this._lastPosition:void 0!==this._lastPosition}getEstimatedMinimumSegmentTime(){var e;if(!this._isDynamic||null===this._timeShiftBufferDepth)return 0;const t=null!==(e=this.getEstimatedLiveEdge())&&void 0!==e?e:this.getEstimatedMaximumPosition(0);if(void 0===t)return;const n=t-this._timeShiftBufferDepth;return n}getEstimatedLiveEdge(){if(this._isDynamic&&void 0!==this._serverTimestampOffset)return(Te()+this._serverTimestampOffset)/1e3-this._availabilityStartTime}getEstimatedMaximumPosition(e){if(!this._isDynamic)return this._lastPosition;const t=this.getEstimatedLiveEdge();return void 0!==t&&e!==1/0?t+e:void 0!==this._positionTime&&void 0!==this._lastPosition?Math.max(this._lastPosition-this._positionTime+Te()/1e3,0):this._lastPosition}}function Vl(e,t){return"dynamic"!==e.type?0:r(e.availabilityStartTime)?null!==t&&void 0!==t?t:0:e.availabilityStartTime}function Hl(e,t){return"function"===typeof Array.prototype.flatMap?e.flatMap(t):e.reduce((e,n)=>{const i=t(n);return Array.isArray(i)?(e.push(...i),e):(e.push(i),e)},[])}function Kl(e){if(0===e.length)return[];const t=[e[0]];for(let n=1;n<e.length;n++){const i=e[n];let r=t[t.length-1];while(void 0===r.duration||r.start+r.duration>i.start){if(j.warn("DASH: Updating overlapping Periods.",null===r||void 0===r?void 0:r.start,i.start),r.duration=i.start-r.start,r.end=i.start,r.duration>0)break;if(t.pop(),0===t.length)break;r=t[t.length-1]}t.push(i)}return t}function zl(e,t){const n=[];return e.forEach((i,a)=>{let o,s;if(r(i.attributes.start))if(0===a)o=!t.isDynamic||r(t.availabilityStartTime)?0:t.availabilityStartTime;else{const e=n[n.length-1];if(r(e)||r(e.periodEnd))throw new Error("Missing start time when parsing periods.");o=e.periodEnd}else o=i.attributes.start;const l=e[a+1];r(i.attributes.duration)?a===e.length-1?s=t.duration:r(l.attributes.start)||(s=l.attributes.start-o):s=i.attributes.duration;const u=r(s)?void 0:o+s;n.push({periodStart:o,periodDuration:s,periodEnd:u})}),n}function Zl(e,t){for(const n of t){const{adaptation:t,trickModeAttachedAdaptationIds:i}=n;for(const n of i)for(const i of _t){const r=e[i];if(void 0!==r)for(const e of r)e.id===n&&(void 0===e.trickModeTracks&&(e.trickModeTracks=[]),e.trickModeTracks.push(t))}}}var ql=Zl;const Yl=["subtitle","caption"];function Wl(e,t,n,i){function r(e,t){const n=e.split("/")[0];return gt(_t,n)?n:"application/ttml+xml"===e?"text":"application/mp4"===e&&null!==t&&void 0!==De(t,e=>"urn:mpeg:dash:role:2011"===e.schemeIdUri&&gt(Yl,e.value))?"text":void 0}function a(e){switch(e.substring(0,3)){case"avc":case"hev":case"hvc":case"vp8":case"vp9":case"av1":return"video";case"vtt":return"text"}switch(e.substring(0,4)){case"mp4a":return"audio";case"wvtt":case"stpp":return"text"}}if(null!==t){const e=r(t,i);if(void 0!==e)return e}if(null!==n){const e=a(n);if(void 0!==e)return e}for(let o=0;o<e.length;o++){const t=e[o],{mimeType:n,codecs:s}=t.attributes;if(void 0!==n){const e=r(n,i);if(void 0!==e)return e}if(void 0!==s){const e=a(s);if(void 0!==e)return e}}}const $l=/[, ]+/g;function Xl(e){return Nt(e)?e.trim().replace($l,", "):""}function Ql(e){const[t,n,i,r,a,o,s,l]=e.split(".");if("vp08"!==t&&"vp09"!==t&&"vp10"!==t)return;let u,c,d;return(void 0!==r&&"10"===r||"12"===r)&&(u=parseInt(r,10)),void 0!==s&&("16"===s?c="pq":"18"===s&&(c="hlg")),void 0!==o&&void 0!==l&&"09"===o&&"09"===l&&(d="rec2020"),void 0!==u&&void 0!==c?{colorDepth:u,eotf:c,colorSpace:d}:void 0}function Jl(e,t){var n;const{initialization:i}=e,a={};return void 0!==t&&(a.isEMSGWhitelisted=t),{id:"init",isInit:!0,time:0,end:0,duration:0,timescale:1,range:r(i)?void 0:i.range,indexRange:e.indexRange,url:null!==(n=null===i||void 0===i?void 0:i.url)&&void 0!==n?n:null,complete:!0,privateInfos:a,timestampOffset:-e.indexTimeOffset/e.timescale}}function eu(e,t){const n=e.toString();if(n.length>=t)return n;const i=new Array(t+1).join("0")+n;return i.slice(-t)}function tu(e){return(t,n,i)=>{const r=Nt(i)?parseInt(i,10):1;return eu(String(e),r)}}function nu(e,t,n){return iu(e,t,n)}function iu(e,t,n){return-1===e.indexOf("$")?e:e.replace(/\$\$/g,"$").replace(/\$RepresentationID\$/g,String(t)).replace(/\$Bandwidth(\%0(\d+)d)?\$/g,tu(void 0===n?0:n))}function ru(e,t){return function(n){return-1===n.indexOf("$")?n:n.replace(/\$\$/g,"$").replace(/\$Number(\%0(\d+)d)?\$/g,(e,n,i)=>{if(void 0===t)throw new Error("Segment number not defined in a $Number$ scheme");return tu(t)(e,n,i)}).replace(/\$Time(\%0(\d+)d)?\$/g,(t,n,i)=>{if(void 0===e)throw new Error("Segment time not defined in a $Time$ scheme");return tu(e)(t,n,i)})}}function au(e,t,n){const i=n-e;return i>0?Math.floor(i/t):0}function ou(e,t,n,i,r,a){var o;const s=i.getEstimatedMaximumPosition(null!==(o=e.availabilityTimeOffset)&&void 0!==o?o:0),l=Math.min(t+n,null!==s&&void 0!==s?s:1/0),u=ts(t,e),c=ts(l,e),{timeline:d,timescale:f,segmentUrlTemplate:h,startNumber:p,endNumber:g}=e;let m=null!==p&&void 0!==p?p:1;const v=[],y=d.length;for(let _=0;_<y;_++){const t=d[_],{duration:n,start:i,range:o}=t;let l;l=void 0===s?r:Math.min(s*f,null!==r&&void 0!==r?r:1/0);const p=Jo(t,d[_+1],l),b=!1!==e.availabilityTimeComplete||_!==y-1&&0!==p;let E=au(i,n,u),T=i+E*n;while(T<c&&E<=p){const t=m+E;if(void 0!==g&&t>g)break;const r=null===h?null:ru(T,t)(h);let s=T-e.indexTimeOffset,l=n;s<0&&(l=n+s,s=0);const u={id:String(T),time:s/f,end:(s+l)/f,duration:l/f,isInit:!1,range:o,timescale:1,url:r,number:t,timestampOffset:-e.indexTimeOffset/f,complete:b,privateInfos:{isEMSGWhitelisted:a}};v.push(u),E++,T=i+E*n}if(T>=c)return v;if(m+=p+1,void 0!==g&&m>g)return v}return v}function su(e,t){if(t.timescale!==e.timescale){const{timescale:n}=e;e.timeline.push({start:t.time/t.timescale*n,duration:t.duration/t.timescale*n,repeatCount:void 0===t.count?0:t.count,range:t.range})}else e.timeline.push({start:t.time,duration:t.duration,repeatCount:void 0===t.count?0:t.count,range:t.range});return!0}class lu{constructor(e,t){var n,i,a,o;const{periodStart:s,periodEnd:l,representationId:u,representationBitrate:c,isEMSGWhitelisted:d}=t,f=null!==(n=e.timescale)&&void 0!==n?n:1,h=null!==(i=e.presentationTimeOffset)&&void 0!==i?i:0,p=h-s*f,g=void 0===(null===(a=e.initialization)||void 0===a?void 0:a.media)?null:nu(e.initialization.media,u,c),m=void 0===e.media?null:nu(e.media,u,c);let v;void 0!==e.initialization?v=e.initialization.range:void 0!==e.indexRange&&(v=[0,e.indexRange[0]-1]),this._index={indexRange:e.indexRange,indexTimeOffset:p,initialization:{url:g,range:v},segmentUrlTemplate:m,startNumber:e.startNumber,endNumber:e.endNumber,timeline:null!==(o=e.timeline)&&void 0!==o?o:[],timescale:f},this._manifestBoundsCalculator=t.manifestBoundsCalculator,this._scaledPeriodStart=ts(s,this._index),this._scaledPeriodEnd=r(l)?void 0:ts(l,this._index),this._isInitialized=this._index.timeline.length>0,this._isEMSGWhitelisted=d}getInitSegment(){return Jl(this._index,this._isEMSGWhitelisted)}getSegments(e,t){return ou(this._index,e,t,this._manifestBoundsCalculator,this._scaledPeriodEnd,this._isEMSGWhitelisted)}shouldRefresh(){return!1}getFirstAvailablePosition(){const e=this._index;return 0===e.timeline.length?null:ns(Math.max(this._scaledPeriodStart,e.timeline[0].start),e)}getLastAvailablePosition(){var e;const{timeline:t}=this._index;if(0===t.length)return null;const n=t[t.length-1],i=Math.min(es(n,null,this._scaledPeriodEnd),null!==(e=this._scaledPeriodEnd)&&void 0!==e?e:1/0);return ns(i,this._index)}getEnd(){return this.getLastAvailablePosition()}awaitSegmentBetween(){return!1}isSegmentStillAvailable(){return!0}checkDiscontinuity(){return null}canBeOutOfSyncError(){return!1}isStillAwaitingFutureSegments(){return!1}isInitialized(){return this._isInitialized}initialize(e){if(!this._isInitialized){for(let t=0;t<e.length;t++)su(this._index,e[t]);this._isInitialized=!0}}addPredictedSegments(){j.warn("Cannot add predicted segments to a `BaseRepresentationIndex`")}_replace(e){this._index=e._index,this._isInitialized=e._isInitialized,this._scaledPeriodEnd=e._scaledPeriodEnd,this._isEMSGWhitelisted=e._isEMSGWhitelisted}_update(){j.error("Base RepresentationIndex: Cannot update a SegmentList")}}class uu{constructor(e,t){var n,i,a;if(void 0===e.duration)throw new Error("Invalid SegmentList: no duration");const{periodStart:o,periodEnd:s,representationId:l,representationBitrate:u,isEMSGWhitelisted:c}=t;this._isEMSGWhitelisted=c,this._periodStart=o,this._periodEnd=s;const d=null!==(n=e.presentationTimeOffset)&&void 0!==n?n:0,f=null!==(i=e.timescale)&&void 0!==i?i:1,h=d-o*f,p=void 0===(null===(a=e.initialization)||void 0===a?void 0:a.media)?null:nu(e.initialization.media,l,u),g=e.list.map(e=>({url:void 0===e.media?null:nu(e.media,l,u),mediaRange:e.mediaRange}));this._index={list:g,timescale:f,duration:e.duration,indexTimeOffset:h,indexRange:e.indexRange,initialization:r(e.initialization)?void 0:{url:p,range:e.initialization.range}}}getInitSegment(){const e=Jl(this._index);return void 0===e.privateInfos&&(e.privateInfos={}),e.privateInfos.isEMSGWhitelisted=this._isEMSGWhitelisted,e}getSegments(e,t){const n=this._index,{duration:i,list:r,timescale:a}=n,o=i/a,s=e-this._periodStart,[l,u]=is(s,t,a),c=Math.min(r.length-1,Math.floor(u/i)),d=[];let f=Math.floor(l/i);while(f<=c){const e=r[f].mediaRange,t=r[f].url,i=f*o+this._periodStart,s={id:String(f),time:i,isInit:!1,range:e,duration:o,timescale:1,end:i+o,url:t,timestampOffset:-n.indexTimeOffset/a,complete:!0,privateInfos:{isEMSGWhitelisted:this._isEMSGWhitelisted}};d.push(s),f++}return d}shouldRefresh(e,t){return!1}getFirstAvailablePosition(){return this._periodStart}getLastAvailablePosition(){var e;const t=this._index,{duration:n,list:i}=t;return Math.min(i.length*n/t.timescale+this._periodStart,null!==(e=this._periodEnd)&&void 0!==e?e:1/0)}getEnd(){return this.getLastAvailablePosition()}awaitSegmentBetween(){return!1}isSegmentStillAvailable(){return!0}checkDiscontinuity(){return null}canBeOutOfSyncError(){return!1}isStillAwaitingFutureSegments(){return!1}isInitialized(){return!0}initialize(){j.error("A `ListRepresentationIndex` does not need to be initialized")}addPredictedSegments(){j.warn("Cannot add predicted segments to a `ListRepresentationIndex`")}_replace(e){this._index=e._index}_update(){j.error("A `ListRepresentationIndex` cannot be updated")}}function cu(e){return O.getCurrent().DEFAULT_MAXIMUM_TIME_ROUNDING_ERROR*e}function du(e,t,n){let i=e.start,a=e.duration;const o=e.repeatCount;return void 0===i&&(null===t?i=0:r(t.duration)||(i=t.start+t.duration*(t.repeatCount+1))),void 0!==a&&!isNaN(a)||null===n||void 0===n.start||isNaN(n.start)||void 0===i||isNaN(i)||(a=n.start-i),void 0===i||isNaN(i)||void 0===a||isNaN(a)||void 0!==o&&isNaN(o)?(j.warn('DASH: A "S" Element could not have been parsed.'),null):{start:i,duration:a,repeatCount:void 0===o?0:o}}function fu(e){const t={};for(const n of Object.keys(e.attributes)){const i=e.attributes[n];if(!r(i))switch(n){case"t":const e=parseInt(i,10);isNaN(e)?j.warn(`DASH: invalid t ("${i}")`):t.start=e;break;case"d":const r=parseInt(i,10);isNaN(r)?j.warn(`DASH: invalid d ("${i}")`):t.duration=r;break;case"r":const a=parseInt(i,10);isNaN(a)?j.warn(`DASH: invalid r ("${i}")`):t.repeatCount=a;break}}return t}function hu(e){const t={};for(let n=0;n<e.attributes.length;n++){const i=e.attributes[n];switch(i.name){case"t":const e=parseInt(i.value,10);isNaN(e)?j.warn(`DASH: invalid t ("${i.value}")`):t.start=e;break;case"d":const n=parseInt(i.value,10);isNaN(n)?j.warn(`DASH: invalid d ("${i.value}")`):t.duration=n;break;case"r":const r=parseInt(i.value,10);isNaN(r)?j.warn(`DASH: invalid r ("${i.value}")`):t.repeatCount=r;break}}return t}function pu(e){const t=[];if(Array.isArray(e))for(let i=0;i<e.length;i++)t.push(fu(e[i]));else for(let i=0;i<e.length;i++)t.push(hu(e[i]));const n=[];for(let i=0;i<t.length;i++){const e=t[i],r=void 0===n[n.length-1]?null:n[n.length-1],a=void 0===t[i+1]?null:t[i+1],o=du(e,r,a);null!==o&&n.push(o)}return n}function gu(e,t){if(0===e.length||0===t.length)return null;const n=e[0].start,i=Array.isArray(t)?t[0].attributes.t:t[0].getAttribute("t"),a=r(i)?null:parseInt(i,10);if(null===a||Number.isNaN(a))return null;if(n===a)return{prevSegmentsIdx:0,newElementsIdx:0,repeatNumberInPrevSegments:0,repeatNumberInNewElements:0};if(n<a){let t=e[0],n=0;while(1){if(t.repeatCount>0){const e=a-t.start;if(e%t.duration===0&&e/t.duration<=t.repeatCount){const i=e/t.duration;return{repeatNumberInPrevSegments:i,prevSegmentsIdx:n,newElementsIdx:0,repeatNumberInNewElements:0}}}if(n++,n>=e.length)return null;if(t=e[n],t.start===a)return{prevSegmentsIdx:n,newElementsIdx:0,repeatNumberInPrevSegments:0,repeatNumberInNewElements:0};if(t.start>a)return null}}else{let e=0,i=Array.isArray(t)?t[0]:null,o=Array.isArray(t)?null:t[0],s=a;while(1){const l=null!==i?i.attributes.d:null===o||void 0===o?void 0:o.getAttribute("d"),u=r(l)?null:parseInt(l,10);if(null===u||Number.isNaN(u))return null;const c=null!==i?i.attributes.r:null===o||void 0===o?void 0:o.getAttribute("r"),d=r(c)?null:parseInt(c,10);if(null!==d){if(Number.isNaN(d)||d<0)return null;if(d>0){const t=n-s;if(t%u===0&&t/u<=d){const n=t/u;return{repeatNumberInPrevSegments:0,repeatNumberInNewElements:n,prevSegmentsIdx:0,newElementsIdx:e}}}s+=u*(d+1)}else s+=u;if(e++,e>=t.length)return null;Array.isArray(t)?i=t[e]:o=t[e];const f=null!==i?i.attributes.t:null===o||void 0===o?void 0:o.getAttribute("t"),h=r(f)?null:parseInt(f,10);if(null!==h){if(Number.isNaN(h))return null;s=h}if(s===n)return{newElementsIdx:e,prevSegmentsIdx:0,repeatNumberInPrevSegments:0,repeatNumberInNewElements:0};if(s>a)return null}}}function mu(e,t){var n;const i=gu(t,e);if(null===i)return j.warn('DASH: Cannot perform "based" update. Common segment not found.'),pu(e);const{prevSegmentsIdx:r,newElementsIdx:a,repeatNumberInPrevSegments:o,repeatNumberInNewElements:s}=i,l=t.length-r,u=l+a-1;if(u>=e.length)return j.info('DASH: Cannot perform "based" update. New timeline too short'),pu(e);const c=t.slice(r);if(o>0){const e=c[0];e.start+=e.duration*o,c[0].repeatCount-=o}if(s>0&&0!==a)return j.info('DASH: Cannot perform "based" update. The new timeline has a different form.'),pu(e);const d=c[c.length-1],f=Array.isArray(e)?fu(e[u]):hu(e[u]),h=(null!==(n=f.repeatCount)&&void 0!==n?n:0)-s;if(f.duration!==d.duration||d.repeatCount>h)return j.info('DASH: Cannot perform "based" update. The new timeline has a different form at the beginning.'),pu(e);void 0!==f.repeatCount&&f.repeatCount>d.repeatCount&&(d.repeatCount=f.repeatCount);const p=[],g=[];if(Array.isArray(e))for(let m=u+1;m<e.length;m++)g.push(fu(e[m]));else for(let m=u+1;m<e.length;m++)g.push(hu(e[m]));for(let m=0;m<g.length;m++){const e=g[m],t=void 0===p[p.length-1]?d:p[p.length-1],n=void 0===g[m+1]?null:g[m+1],i=du(e,t,n);null!==i&&p.push(i)}return c.concat(p)}class vu{constructor(e,t){var n,i,a,o,s;if(!vu.isTimelineIndexArgument(e))throw new Error("The given index is not compatible with a TimelineRepresentationIndex.");const{availabilityTimeComplete:l,availabilityTimeOffset:u,manifestBoundsCalculator:c,isDynamic:d,isLastPeriod:f,representationId:h,representationBitrate:p,periodStart:g,periodEnd:m,isEMSGWhitelisted:v}=t,y=null!==(n=e.timescale)&&void 0!==n?n:1,_=null!==(i=e.presentationTimeOffset)&&void 0!==i?i:0,b=g*y,E=_-b;this._manifestBoundsCalculator=c,this._isEMSGWhitelisted=v,this._isLastPeriod=f,this._lastUpdate=null!==(a=t.receivedTime)&&void 0!==a?a:Te(),this._unsafelyBaseOnPreviousIndex=null,null!==t.unsafelyBaseOnPreviousRepresentation&&t.unsafelyBaseOnPreviousRepresentation.index instanceof vu&&(t.unsafelyBaseOnPreviousRepresentation.index._unsafelyBaseOnPreviousIndex=null,this._unsafelyBaseOnPreviousIndex=t.unsafelyBaseOnPreviousRepresentation.index),this._isDynamic=d,this._parseTimeline=null!==(o=e.timelineParser)&&void 0!==o?o:null;const T=void 0===(null===(s=e.initialization)||void 0===s?void 0:s.media)?null:nu(e.initialization.media,h,p),S=void 0===e.media?null:nu(e.media,h,p);let w;w=void 0===u&&void 0===l?1/0:null!==u&&void 0!==u?u:0,this._index={availabilityTimeComplete:null===l||void 0===l||l,availabilityTimeOffset:w,indexRange:e.indexRange,indexTimeOffset:E,initialization:r(e.initialization)?void 0:{url:T,range:e.initialization.range},segmentUrlTemplate:S,startNumber:e.startNumber,endNumber:e.endNumber,timeline:void 0===e.timeline?null:yu(e.timeline,e.startNumber,e.endNumber),timescale:y},this._scaledPeriodStart=ts(g,this._index),this._scaledPeriodEnd=void 0===m?void 0:ts(m,this._index)}getInitSegment(){return Jl(this._index,this._isEMSGWhitelisted)}getSegments(e,t){return this._refreshTimeline(),null===this._index.timeline&&(this._index.timeline=this._getTimeline()),ou(this._index,e,t,this._manifestBoundsCalculator,this._scaledPeriodEnd,this._isEMSGWhitelisted)}shouldRefresh(){return!1}getFirstAvailablePosition(){this._refreshTimeline(),null===this._index.timeline&&(this._index.timeline=this._getTimeline());const e=this._index.timeline;return 0===e.length?null:ns(Math.max(this._scaledPeriodStart,e[0].start),this._index)}getLastAvailablePosition(){var e;this._refreshTimeline(),null===this._index.timeline&&(this._index.timeline=this._getTimeline());const t=bu(this._index,this._manifestBoundsCalculator,this._scaledPeriodEnd);if(null===t)return null;const n=Math.min(t.end,null!==(e=this._scaledPeriodEnd)&&void 0!==e?e:1/0);return ns(n,this._index)}getEnd(){var e;if(this._isDynamic&&!this._isLastPeriod)return;if(this._refreshTimeline(),null===this._index.timeline&&(this._index.timeline=this._getTimeline()),this._index.timeline.length<=0)return null;const t=this._index.timeline[this._index.timeline.length-1],n=Math.min(es(t,null,this._scaledPeriodEnd),null!==(e=this._scaledPeriodEnd)&&void 0!==e?e:1/0);return ns(n,this._index)}awaitSegmentBetween(e,t){var n,i;if(he(e<=t),!this._isDynamic)return!1;this._refreshTimeline(),null===this._index.timeline&&(this._index.timeline=this._getTimeline());const{timescale:r,timeline:a}=this._index,o=cu(r),s=ts(t,this._index),l=bu(this._index,this._manifestBoundsCalculator,this._scaledPeriodEnd);if(null!==l){const e=Math.min(l.end,null!==(n=this._scaledPeriodEnd)&&void 0!==n?n:1/0),t=e+o;if(t>=Math.min(s,null!==(i=this._scaledPeriodEnd)&&void 0!==i?i:1/0))return!1}const u=ts(e,this._index);if(a.length>0&&null!==l&&!l.isLastOfTimeline){const e=a[a.length-1],t=es(e,null,this._scaledPeriodEnd),n=t+o;if(u<n+o)return!0}return!!this._isLastPeriod&&(void 0===this._scaledPeriodEnd?s+o>this._scaledPeriodStart&&void 0:u-o<this._scaledPeriodEnd&&s+o>this._scaledPeriodStart)}isSegmentStillAvailable(e){return!!e.isInit||(this._refreshTimeline(),null===this._index.timeline&&(this._index.timeline=this._getTimeline()),_u(e,this._index,this._manifestBoundsCalculator,this._scaledPeriodEnd))}checkDiscontinuity(e){this._refreshTimeline();let t=this._index.timeline;return null===t&&(t=this._getTimeline(),this._index.timeline=t),as({timeline:t,timescale:this._index.timescale,indexTimeOffset:this._index.indexTimeOffset},e,this._scaledPeriodEnd)}canBeOutOfSyncError(e){return!!this._isDynamic&&(e instanceof ct&&e.isHttpError(404))}_replace(e){this._parseTimeline=e._parseTimeline,this._index=e._index,this._isDynamic=e._isDynamic,this._scaledPeriodStart=e._scaledPeriodStart,this._scaledPeriodEnd=e._scaledPeriodEnd,this._lastUpdate=e._lastUpdate,this._manifestBoundsCalculator=e._manifestBoundsCalculator,this._isLastPeriod=e._isLastPeriod}_update(e){null===this._index.timeline&&(this._index.timeline=this._getTimeline()),null===e._index.timeline&&(e._index.timeline=e._getTimeline());const t=hs(this._index.timeline,e._index.timeline);t&&(this._index.startNumber=e._index.startNumber),this._index.availabilityTimeOffset=e._index.availabilityTimeOffset,this._index.availabilityTimeComplete=e._index.availabilityTimeComplete,this._index.endNumber=e._index.endNumber,this._isDynamic=e._isDynamic,this._scaledPeriodStart=e._scaledPeriodStart,this._scaledPeriodEnd=e._scaledPeriodEnd,this._lastUpdate=e._lastUpdate,this._isLastPeriod=e._isLastPeriod}isStillAwaitingFutureSegments(){var e;if(!this._isDynamic)return!1;this._refreshTimeline(),null===this._index.timeline&&(this._index.timeline=this._getTimeline());const{timeline:t}=this._index;if(0===t.length){if(void 0!==this._scaledPeriodEnd){const e=this._manifestBoundsCalculator.getEstimatedLiveEdge();if(void 0!==e&&ts(e,this._index)>this._scaledPeriodEnd)return!1}return this._isLastPeriod}const n=cu(this._index.timescale),i=bu(this._index,this._manifestBoundsCalculator,this._scaledPeriodEnd);if(null!==i&&!i.isLastOfTimeline){const t=Math.min(i.end,null!==(e=this._scaledPeriodEnd)&&void 0!==e?e:1/0);return!(void 0!==this._scaledPeriodEnd&&t+n>=this._scaledPeriodEnd)}if(!this._isLastPeriod)return!1;if(void 0===this._scaledPeriodEnd)return!0;const r=t[t.length-1],a=es(r,null,this._scaledPeriodEnd);return a+n<this._scaledPeriodEnd}isInitialized(){return!0}initialize(){j.error("A `TimelineRepresentationIndex` does not need to be initialized")}addPredictedSegments(){j.warn("Cannot add predicted segments to a `TimelineRepresentationIndex`")}static isTimelineIndexArgument(e){return"function"===typeof e.timelineParser||Array.isArray(e.timeline)}_refreshTimeline(){if(null===this._index.timeline&&(this._index.timeline=this._getTimeline()),!this._isDynamic)return;const e=this._manifestBoundsCalculator.getEstimatedMinimumSegmentTime();if(r(e))return;const t=ts(e,this._index),n=fs(this._index.timeline,t);void 0!==this._index.startNumber?this._index.startNumber+=n:void 0!==this._index.endNumber&&(this._index.startNumber=n+1)}_getTimeline(){if(null===this._parseTimeline)return null!==this._index.timeline?this._index.timeline:(j.error("DASH: Timeline already lazily parsed."),[]);const e=this._parseTimeline();this._parseTimeline=null;const{MIN_DASH_S_ELEMENTS_TO_PARSE_UNSAFELY:t}=O.getCurrent();if(null===this._unsafelyBaseOnPreviousIndex||e.length<t)return yu(pu(e),this._index.startNumber,this._index.endNumber);let n;return null===this._unsafelyBaseOnPreviousIndex._index.timeline?(n=this._unsafelyBaseOnPreviousIndex._getTimeline(),this._unsafelyBaseOnPreviousIndex._index.timeline=n):n=this._unsafelyBaseOnPreviousIndex._index.timeline,this._unsafelyBaseOnPreviousIndex=null,yu(mu(e,n),this._index.startNumber,this._index.endNumber)}}function yu(e,t,n){if(void 0===n)return e;let i=null!==t&&void 0!==t?t:1;for(let r=0;r<e.length;r++){const t=e[r];if(i+=t.repeatCount+1,i>n){if(i===n+1)return e.slice(0,r+1);{const a=e.slice(0,r),o=Object.assign({},t),s=i-t.repeatCount-1;return o.repeatCount=Math.max(0,n-s),a.push(o),a}}}return e}function _u(e,t,n,i){const a=bu(t,n,i);if(null===a)return!1;for(let o=0;o<t.timeline.length;o++){if(a.timelineIdx<o)return!1;const n=t.timeline[o],i=(n.start-t.indexTimeOffset)/t.timescale;if(i>e.time)return!1;if(i===e.time)return void 0===n.range?void 0===e.range:!r(e.range)&&n.range[0]===e.range[0]&&n.range[1]===e.range[1];if(n.repeatCount>=0&&void 0!==n.duration){const e=i-n.start,t=e/n.duration-1;return t%1===0&&t<=a.newRepeatCount}}return!1}function bu(e,t,n){if(e.timeline.length<=0)return null;if(e.availabilityTimeOffset===1/0){const t=e.timeline.length-1,i=e.timeline[t];return{isLastOfTimeline:!0,timelineIdx:t,newRepeatCount:i.repeatCount,end:es(i,null,n)}}const i=t.getEstimatedMaximumPosition(e.availabilityTimeOffset);if(void 0===i){const t=e.timeline.length-1,i=e.timeline[t];return{isLastOfTimeline:!0,timelineIdx:t,newRepeatCount:i.repeatCount,end:es(i,null,n)}}for(let r=e.timeline.length-1;r>=e.timeline.length;r--){const t=e.timeline[r],a=t.start+t.duration;if(ns(a,e)<=i){const o=es(t,e.timeline[r+1],n);if(ns(o,e)<=i)return{isLastOfTimeline:r===e.timeline.length-1,timelineIdx:r,newRepeatCount:t.repeatCount,end:a};{const n=ts(i,e),a=n-t.start,o=Math.floor(a/t.duration);return he(o>=1),{isLastOfTimeline:!1,timelineIdx:r,newRepeatCount:o-1,end:t.start+o*t.duration}}}}return null}var Eu=vu;class Tu{constructor(e,t){var n,i,a;const{availabilityTimeOffset:o,manifestBoundsCalculator:s,isDynamic:l,periodEnd:u,periodStart:c,representationId:d,representationBitrate:f,isEMSGWhitelisted:h}=t,p=null!==(n=e.timescale)&&void 0!==n?n:1;this._availabilityTimeOffset=o,this._manifestBoundsCalculator=s;const g=null!==(i=e.presentationTimeOffset)&&void 0!==i?i:0,m=c*p,v=g-m;if(void 0===e.duration)throw new Error("Invalid SegmentTemplate: no duration");const y=void 0===(null===(a=e.initialization)||void 0===a?void 0:a.media)?null:nu(e.initialization.media,d,f),_=void 0===e.media?null:nu(e.media,d,f);this._index={duration:e.duration,timescale:p,indexRange:e.indexRange,indexTimeOffset:v,initialization:r(e.initialization)?void 0:{url:y,range:e.initialization.range},url:_,presentationTimeOffset:g,startNumber:e.startNumber,endNumber:e.endNumber},this._isDynamic=l,this._periodStart=c,this._scaledRelativePeriodEnd=void 0===u?void 0:(u-c)*p,this._isEMSGWhitelisted=h}getInitSegment(){return Jl(this._index,this._isEMSGWhitelisted)}getSegments(e,t){const n=this._index,{duration:i,startNumber:a,endNumber:o,timescale:s,url:l}=n,u=this._periodStart*s,c=this._scaledRelativePeriodEnd,d=e*s-u,f=(e+t)*s-u,h=this._getFirstSegmentStart(),p=this._getLastSegmentStart();if(r(h)||r(p))return[];const g=Math.max(h,d),m=Math.min(p,f);if(m+i<=g)return[];const v=[],y=null!==a&&void 0!==a?a:1;let _=Math.floor(g/i);for(let b=_*i;b<=m;b+=i){const e=_+y;if(void 0!==o&&e>o)return v;const t=!r(c)&&b+i>c?c-b:i,a=b+u,d=b+this._index.presentationTimeOffset,f=null===l?null:ru(d,e)(l),h={id:String(e),number:e,time:a/s,end:(a+t)/s,duration:t/s,timescale:1,isInit:!1,scaledDuration:t/s,url:f,timestampOffset:-n.indexTimeOffset/s,complete:!0,privateInfos:{isEMSGWhitelisted:this._isEMSGWhitelisted}};v.push(h),_++}return v}getFirstAvailablePosition(){const e=this._getFirstSegmentStart();return r(e)?e:e/this._index.timescale+this._periodStart}getLastAvailablePosition(){const e=this._getLastSegmentStart();if(r(e))return e;const t=this._estimateRelativeScaledEnd(),n=Math.min(e+this._index.duration,null!==t&&void 0!==t?t:1/0);return n/this._index.timescale+this._periodStart}getEnd(){if(!this._isDynamic)return this.getLastAvailablePosition();const e=this._estimateRelativeScaledEnd();if(void 0===e)return;const{timescale:t}=this._index,n=e+this._periodStart*t;return n/t}awaitSegmentBetween(e,t){if(he(e<=t),!this._isDynamic)return!1;const{timescale:n}=this._index,i=cu(n),a=this._periodStart*n,o=e*n-a,s=t*n-a,l=this._getLastSegmentStart();if(r(l)){const e=this._estimateRelativeScaledEnd();return void 0===e?s+i>=0:s+i>=0&&o<e-i}const u=l+this._index.duration,c=this._estimateRelativeScaledEnd();return void 0===c?s>u-i:s>u-i&&o<c-i}shouldRefresh(){return!1}checkDiscontinuity(){return null}isSegmentStillAvailable(e){if(e.isInit)return!0;const t=this.getSegments(e.time,.1);return 0!==t.length&&(t[0].time===e.time&&t[0].end===e.end&&t[0].number===e.number)}canBeOutOfSyncError(){return!1}isStillAwaitingFutureSegments(){if(!this._isDynamic)return!1;const e=this._estimateRelativeScaledEnd();if(void 0===e)return!0;const{timescale:t}=this._index,n=this._getLastSegmentStart();if(r(n))return!0;const i=n+this._index.duration,a=cu(t);return i+a<e}isInitialized(){return!0}initialize(){j.error("A `TemplateRepresentationIndex` does not need to be initialized")}addPredictedSegments(){j.warn("Cannot add predicted segments to a `TemplateRepresentationIndex`")}_replace(e){this._index=e._index,this._isDynamic=e._isDynamic,this._periodStart=e._periodStart,this._scaledRelativePeriodEnd=e._scaledRelativePeriodEnd,this._manifestBoundsCalculator=e._manifestBoundsCalculator}_update(e){this._replace(e)}_getFirstSegmentStart(){var e;if(!this._isDynamic)return 0;if(0===this._scaledRelativePeriodEnd||void 0===this._scaledRelativePeriodEnd){const t=this._manifestBoundsCalculator.getEstimatedMaximumPosition(null!==(e=this._availabilityTimeOffset)&&void 0!==e?e:0);if(void 0!==t&&t<this._periodStart)return null}const{duration:t,timescale:n}=this._index,i=this._manifestBoundsCalculator.getEstimatedMinimumSegmentTime();if(void 0===i)return;const r=i>this._periodStart?(i-this._periodStart)*n:0,a=Math.floor(r/t);return a*t}_getLastSegmentStart(){var e,t;const{duration:n,timescale:i,endNumber:r,startNumber:a=1}=this._index;if(this._isDynamic){const t=this._manifestBoundsCalculator.getEstimatedLiveEdge();if(void 0!==t&&void 0!==this._scaledRelativePeriodEnd&&this._scaledRelativePeriodEnd<t-this._periodStart*this._index.timescale){let e=Math.ceil(this._scaledRelativePeriodEnd/n);return void 0!==r&&r-a+1<e&&(e=r-a+1),(e-1)*n}const o=this._manifestBoundsCalculator.getEstimatedMaximumPosition(null!==(e=this._availabilityTimeOffset)&&void 0!==e?e:0);if(void 0===o)return;const s=(o-this._periodStart)*i;if(s<0)return null;let l=Math.floor(s/n);return void 0!==r&&r-a+1<l&&(l=r-a+1),l<=0?null:(l-1)*n}{const e=null!==(t=this._scaledRelativePeriodEnd)&&void 0!==t?t:0;let o=Math.ceil(e/n);void 0!==r&&r-a+1<o&&(o=r-a+1);const s=(o-1)*n,l=O.getCurrent().MINIMUM_SEGMENT_SIZE*i;return void 0!==r||e-s>l||o<2?s:(o-2)*n}}_estimateRelativeScaledEnd(){var e,t;if(void 0!==this._index.endNumber){const n=this._index.endNumber-(null!==(e=this._index.startNumber)&&void 0!==e?e:1)+1;return Math.max(Math.min(n*this._index.duration,null!==(t=this._scaledRelativePeriodEnd)&&void 0!==t?t:1/0),0)}if(void 0!==this._scaledRelativePeriodEnd)return Math.max(this._scaledRelativePeriodEnd,0)}}function Su(e,t){var n,i,r;const{availabilityTimeOffset:a,manifestBoundsCalculator:o,isDynamic:s,end:l,start:u,receivedTime:c,unsafelyBaseOnPreviousRepresentation:d,inbandEventStreams:f,isLastPeriod:h}=t,p=e=>{return void 0!==f&&f.some(({schemeIdUri:t})=>t===e.schemeIdUri)},g={availabilityTimeComplete:void 0,availabilityTimeOffset:a,unsafelyBaseOnPreviousRepresentation:d,isEMSGWhitelisted:p,isLastPeriod:h,manifestBoundsCalculator:o,isDynamic:s,periodEnd:l,periodStart:u,receivedTime:c,representationBitrate:e.attributes.bitrate,representationId:e.attributes.id};let m;if(void 0!==e.children.segmentBase){const{segmentBase:t}=e.children;m=new lu(t,g)}else if(void 0!==e.children.segmentList){const{segmentList:t}=e.children;m=new uu(t,g)}else if(void 0!==e.children.segmentTemplate||t.parentSegmentTemplates.length>0){const a=t.parentSegmentTemplates.slice(),o=e.children.segmentTemplate;void 0!==o&&a.push(o);const s=k({},...a);void 0===s.availabilityTimeOffset&&void 0===t.availabilityTimeOffset||(g.availabilityTimeOffset=(null!==(n=s.availabilityTimeOffset)&&void 0!==n?n:0)+(null!==(i=t.availabilityTimeOffset)&&void 0!==i?i:0)),void 0===s.availabilityTimeComplete&&void 0===t.availabilityTimeComplete||(g.availabilityTimeComplete=null!==(r=s.availabilityTimeComplete)&&void 0!==r?r:t.availabilityTimeComplete),m=Eu.isTimelineIndexArgument(s)?new Eu(s,g):new Tu(s,g)}else{const e=t.adaptation.children;if(void 0!==e.segmentBase){const{segmentBase:t}=e;m=new lu(t,g)}else if(void 0!==e.segmentList){const{segmentList:t}=e;m=new uu(t,g)}else m=new Tu({duration:Number.MAX_VALUE,timescale:1,startNumber:0,media:""},g)}return m}function wu(e,t){var n;if(0===t.length)return e;const i=t.map(e=>{return{url:e.value}});if(0===e.length)return i;const r=[];for(let a=0;a<e.length;a++){const t=e[a];for(let e=0;e<i.length;e++){const a=i[e],o=So(t.url,a.url);r.push({url:o,serviceLocation:null!==(n=a.serviceLocation)&&void 0!==n?n:t.serviceLocation})}}return r}function Au(e,t){const n=[];if(void 0!==e.children.inbandEventStreams&&n.push(...e.children.inbandEventStreams),void 0!==t.children.inbandEventStreams&&n.push(...t.children.inbandEventStreams),0!==n.length)return n}function Iu({adaptationProfiles:e,essentialProperties:t,supplementalProperties:n,manifestProfiles:i,codecs:r}){const a=(null!==e&&void 0!==e?e:"")+(null!==i&&void 0!==i?i:"");if(-1!==a.indexOf("http://dashif.org/guidelines/dash-if-uhd#hevc-hdr-pq10")&&("hvc1.2.4.L153.B0"===r||"hev1.2.4.L153.B0"===r))return{colorDepth:10,eotf:"pq",colorSpace:"rec2020"};const o=De([...null!==t&&void 0!==t?t:[],...null!==n&&void 0!==n?n:[]],e=>"urn:mpeg:mpegB:cicp:TransferCharacteristics"===e.schemeIdUri);if(void 0!==o)switch(o.value){case"15":return;case"16":return{eotf:"pq"};case"18":return{eotf:"hlg"}}return void 0!==r&&/^vp(08|09|10)/.exec(r)?Ql(r):void 0}function xu(e,t,n){var i,r,a,o,s,l,u;const c=[];for(const d of e){let e=void 0!==d.attributes.id?d.attributes.id:String(d.attributes.bitrate)+(void 0!==d.attributes.height?`-${d.attributes.height}`:"")+(void 0!==d.attributes.width?`-${d.attributes.width}`:"")+(void 0!==d.attributes.mimeType?`-${d.attributes.mimeType}`:"")+(void 0!==d.attributes.codecs?`-${d.attributes.codecs}`:"");while(c.some(t=>t.id===e))e+="-dup";const f=null!==(r=null===(i=n.unsafelyBaseOnPreviousAdaptation)||void 0===i?void 0:i.getRepresentation(e))&&void 0!==r?r:null,h=Au(d,t),p=null!==(a=d.attributes.availabilityTimeComplete)&&void 0!==a?a:n.availabilityTimeComplete;let g;void 0===d.attributes.availabilityTimeOffset&&void 0===n.availabilityTimeOffset||(g=(null!==(o=d.attributes.availabilityTimeOffset)&&void 0!==o?o:0)+(null!==(s=n.availabilityTimeOffset)&&void 0!==s?s:0));const m=k({},n,{availabilityTimeOffset:g,availabilityTimeComplete:p,unsafelyBaseOnPreviousRepresentation:f,adaptation:t,inbandEventStreams:h}),v=Su(d,m);let y;void 0===d.attributes.bitrate?(j.warn("DASH: No usable bitrate found in the Representation."),y=0):y=d.attributes.bitrate;const _=wu(n.baseURLs,d.children.baseURLs),b=0===_.length?[{baseUrl:"",id:void 0}]:_.map(e=>({baseUrl:e.url,id:e.serviceLocation})),E={bitrate:y,cdnMetadata:b,index:v,id:e};let T,S;void 0!==d.children.supplementalProperties&&De(d.children.supplementalProperties,e=>"tag:dolby.com,2018:dash:EC3_ExtensionType:2018"===e.schemeIdUri&&"JOC"===e.value)&&(E.isSpatialAudio=!0),void 0!==d.attributes.codecs?T=d.attributes.codecs:void 0!==t.attributes.codecs&&(T=t.attributes.codecs),void 0!==T&&(T="mp4a.40.02"===T?"mp4a.40.2":T,E.codecs=T),void 0!==d.attributes.supplementalCodecs?S=d.attributes.supplementalCodecs:void 0!==t.attributes.supplementalCodecs&&(S=t.attributes.supplementalCodecs),void 0!==S&&(E.supplementalCodecs=Xl(S)),void 0!==d.attributes.frameRate?E.frameRate=d.attributes.frameRate:void 0!==t.attributes.frameRate&&(E.frameRate=t.attributes.frameRate),void 0!==d.attributes.height?E.height=d.attributes.height:void 0!==t.attributes.height&&(E.height=t.attributes.height),void 0!==d.attributes.mimeType?E.mimeType=d.attributes.mimeType:void 0!==t.attributes.mimeType&&(E.mimeType=t.attributes.mimeType),void 0!==d.attributes.width?E.width=d.attributes.width:void 0!==t.attributes.width&&(E.width=t.attributes.width);{const e=[...null!==(l=t.children.contentProtections)&&void 0!==l?l:[],...null!==(u=d.children.contentProtections)&&void 0!==u?u:[]];for(const t of e)n.contentProtectionParser.add(E,t)}E.hdrInfo=Iu({adaptationProfiles:t.attributes.profiles,supplementalProperties:t.children.supplementalProperties,essentialProperties:t.children.essentialProperties,manifestProfiles:n.manifestProfiles,codecs:T}),c.push(E)}return c}function Ru(e){if(void 0===e)return!1;const t="urn:tva:metadata:cs:AudioPurposeCS:2007"===e.schemeIdUri&&"1"===e.value,n="urn:mpeg:dash:role:2011"===e.schemeIdUri&&"description"===e.value;return t||n}function Cu(e,t){if(void 0!==e){const t=e.some(e=>"urn:tva:metadata:cs:AudioPurposeCS:2007"===e.schemeIdUri&&"2"===e.value);if(t)return!0}if(void 0!==t){const e=t.some(e=>"urn:mpeg:dash:role:2011"===e.schemeIdUri&&"caption"===e.value);if(e)return!0}return!1}function Du(e){return void 0!==e&&("urn:mpeg:dash:role:2011"===e.schemeIdUri&&"sign"===e.value)}function ku(e,t){if(Nt(e.attributes.id))return e.attributes.id;const{isClosedCaption:n,isForcedSubtitle:i,isAudioDescription:r,isSignInterpreted:a,isTrickModeTrack:o,type:s}=t;let l=s;return Nt(e.attributes.language)&&(l+=`-${e.attributes.language}`),!0===n&&(l+="-cc"),!0===i&&(l+="-cc"),!0===r&&(l+="-ad"),!0===a&&(l+="-si"),o&&(l+="-trickMode"),Nt(e.attributes.contentType)&&(l+=`-${e.attributes.contentType}`),Nt(e.attributes.codecs)&&(l+=`-${e.attributes.codecs}`),Nt(e.attributes.mimeType)&&(l+=`-${e.attributes.mimeType}`),void 0!==e.attributes.frameRate&&(l+=`-${String(e.attributes.frameRate)}`),l}function Mu(e){if(!r(e.children.supplementalProperties)){const{supplementalProperties:t}=e.children;for(const e of t)if("urn:mpeg:dash:adaptation-set-switching:2016"===e.schemeIdUri&&!r(e.value))return e.value.split(",").map(e=>e.trim()).filter(e=>e)}return[]}function Lu(e,t){var n,i,a,o,s,l,u;const c={video:[],audio:[],text:[]},d=[],f={},h=[];for(let g=0;g<e.length;g++){const p=e[g],m=p.children,{essentialProperties:v,roles:y,label:_}=m,b=Array.isArray(y)&&y.some(e=>"main"===e.value)&&y.some(e=>"urn:mpeg:dash:role:2011"===e.schemeIdUri),E=p.children.representations,T=null!==(n=p.attributes.availabilityTimeComplete)&&void 0!==n?n:t.availabilityTimeComplete;let S;void 0===p.attributes.availabilityTimeOffset&&void 0===t.availabilityTimeOffset||(S=(null!==(i=p.attributes.availabilityTimeOffset)&&void 0!==i?i:0)+(null!==(a=t.availabilityTimeOffset)&&void 0!==a?a:0));const w=p.attributes.mimeType,A=p.attributes.codecs,I=Wl(E,Nt(w)?w:null,Nt(A)?A:null,r(m.roles)?null:m.roles);if(void 0===I)continue;const x=null!==(o=p.attributes.selectionPriority)&&void 0!==o?o:1,R=p.attributes.id,C=Mu(p),D=[];void 0!==t.segmentTemplate&&D.push(t.segmentTemplate),void 0!==p.children.segmentTemplate&&D.push(p.children.segmentTemplate);const k={availabilityTimeComplete:T,availabilityTimeOffset:S,baseURLs:wu(t.baseURLs,m.baseURLs),contentProtectionParser:t.contentProtectionParser,manifestBoundsCalculator:t.manifestBoundsCalculator,end:t.end,isDynamic:t.isDynamic,isLastPeriod:t.isLastPeriod,manifestProfiles:t.manifestProfiles,parentSegmentTemplates:D,receivedTime:t.receivedTime,start:t.start,unsafelyBaseOnPreviousAdaptation:null},M=Array.isArray(v)?De(v,e=>{return"http://dashif.org/guidelines/trickmode"===e.schemeIdUri}):void 0,L=null===(s=null===M||void 0===M?void 0:M.value)||void 0===s?void 0:s.split(" "),P=void 0!==L,{accessibilities:N}=m;let O,F,U,B,G;void 0!==y&&y.some(e=>"dub"===e.value)&&(O=!0),F="text"===I&&Cu(N,y),"text"===I&&void 0!==y&&y.some(e=>"forced-subtitle"===e.value||"forced_subtitle"===e.value)&&(U=!0),"audio"!==I?B=!1:void 0!==N&&(B=N.some(Ru)),"video"!==I?G=!1:void 0!==N&&(G=N.some(Du));let V=ku(p,{isAudioDescription:B,isForcedSubtitle:U,isClosedCaption:F,isSignInterpreted:G,isTrickModeTrack:P,type:I});while(gt(h,V))V+="-dup";const H=V;h.push(V),k.unsafelyBaseOnPreviousAdaptation=null!==(u=null===(l=t.unsafelyBaseOnPreviousPeriod)||void 0===l?void 0:l.getAdaptation(V))&&void 0!==u?u:null;const K=xu(E,p,k),z={id:V,representations:K,type:I,isTrickModeTrack:P};if(r(p.attributes.language)||(z.language=p.attributes.language),r(F)||(z.closedCaption=F),r(B)||(z.audioDescription=B),!0===O&&(z.isDub=!0),void 0!==U&&(z.forcedSubtitles=U),!0===G&&(z.isSignInterpreted=!0),void 0!==_&&(z.label=_),void 0!==L)d.push({adaptation:z,trickModeAttachedAdaptationIds:L});else{let e=-1;for(const t of C){const n=f[t];if(void 0!==n&&n.newID!==H&&gt(n.adaptationSetSwitchingIDs,R)){e=le(c[I],e=>e[0].id===t);const n=c[I][e];if(void 0!==n&&n[0].audioDescription===z.audioDescription&&n[0].closedCaption===z.closedCaption&&n[0].language===z.language){j.info('DASH Parser: merging "switchable" AdaptationSets',R,t),n[0].representations.push(...z.representations),n[1]={priority:Math.max(x,n[1].priority),isMainAdaptation:b||n[1].isMainAdaptation,indexInMpd:Math.min(g,n[1].indexInMpd)};break}}}e<0&&c[I].push([z,{priority:x,isMainAdaptation:b,indexInMpd:g}])}!r(R)&&r(f[R])&&(f[R]={newID:H,adaptationSetSwitchingIDs:C})}const p=_t.reduce((e,t)=>{const n=c[t];return n.length>0&&(n.sort(Pu),e[t]=n.map(([e])=>e)),e},{});return c.video.sort(Pu),ql(p,d),p}function Pu(e,t){const n=t[1].priority-e[1].priority;return 0!==n?n:e[1].isMainAdaptation!==t[1].isMainAdaptation?e[1].isMainAdaptation?-1:1:e[1].indexInMpd-t[1].indexInMpd}const Nu=pt();function Ou(e,t){var n,i,a,o,s;const l=[],u=zl(e,t);if(u.length!==e.length)throw new Error("MPD parsing error: the time information are incoherent.");const{isDynamic:c,manifestBoundsCalculator:d}=t;c||r(t.duration)||d.setLastPosition(t.duration);for(let f=e.length-1;f>=0;f--){const h=f===e.length-1,p=e[f],g=t.xlinkInfos.get(p),m=wu(t.baseURLs,p.children.baseURLs),{periodStart:v,periodDuration:y,periodEnd:_}=u[f];let b;r(p.attributes.id)?(j.warn("DASH: No usable id found in the Period. Generating one."),b="gen-dash-period-"+Nu()):b=p.attributes.id;while(l.some(e=>e.id===b))b+="-dup";const E=void 0!==g?g.receivedTime:t.receivedTime,T=null!==(i=null===(n=t.unsafelyBaseOnPreviousManifest)||void 0===n?void 0:n.getPeriod(b))&&void 0!==i?i:null,S=p.attributes.availabilityTimeComplete,w=p.attributes.availabilityTimeOffset,{manifestProfiles:A,contentProtectionParser:I}=t,{segmentTemplate:x}=p.children;I.addReferences(null!==(a=p.children.contentProtections)&&void 0!==a?a:[]);const R={availabilityTimeComplete:S,availabilityTimeOffset:w,baseURLs:m,contentProtectionParser:I,manifestBoundsCalculator:d,end:_,isDynamic:c,isLastPeriod:h,manifestProfiles:A,receivedTime:E,segmentTemplate:x,start:v,unsafelyBaseOnPreviousPeriod:T},C=Lu(p.children.adaptations,R),D=(null!==(o=t.xmlNamespaces)&&void 0!==o?o:[]).concat(null!==(s=p.attributes.namespaces)&&void 0!==s?s:[]),k=Bu(p.children.eventStreams,v,D),M={id:b,start:v,end:_,duration:y,adaptations:C,streamEvents:k};if(l.unshift(M),!d.lastPositionIsKnown()){const e=Uu(C);if(c)if("number"===typeof e){const t=Te()/1e3;d.setLastPosition(e,t)}else{const e=Fu(t,v);if(void 0!==e){const[t,n]=e;d.setLastPosition(t,n)}}else"number"===typeof e&&d.setLastPosition(e)}}if(t.isDynamic&&!d.lastPositionIsKnown()){const e=Fu(t,0);if(void 0!==e){const[t,n]=e;d.setLastPosition(t,n)}}return Kl(l)}function Fu(e,t){if(r(e.clockOffset)){const n=Date.now()/1e3;if(n>=t){j.warn("DASH Parser: no clock synchronization mechanism found. Using the system clock instead.");const t=n-e.availabilityStartTime,i=Te()/1e3;return[t,i]}}else{const n=e.clockOffset/1e3-e.availabilityStartTime,i=Te()/1e3,r=i+n;if(r>=t)return[r,i]}}function Uu(e){let t=null,n=!0;const i=Ze(e).filter(e=>!r(e)),a=Hl(i,e=>e);for(const o of a){const e=o.representations;for(const i of e){const e=i.index.getLastAvailablePosition();null!==e&&(n=!1,"number"===typeof e&&(t=r(t)?e:Math.max(t,e)))}}return r(t)?n?null:void 0:t}function Bu(e,t,n){var i,r;const a=[];for(const o of e){const{schemeIdUri:e="",timescale:s=1}=o.attributes,l=n.concat(null!==(i=o.attributes.namespaces)&&void 0!==i?i:[]);for(const n of o.children.events)if(void 0!==n.eventStreamData){const i=(null!==(r=n.presentationTime)&&void 0!==r?r:0)/s+t,o=void 0===n.duration?void 0:i+n.duration/s;let u,c;if(!za["a"]&&n.eventStreamData instanceof Element)u=n.eventStreamData;else try{c={namespaces:l,data:"string"===typeof n.eventStreamData?n.eventStreamData:ko(new Uint8Array(n.eventStreamData))}}catch(e){j.error("DASH: Error while parsing event-stream:",e instanceof Error?e.message:"Unknown error")}a.push({start:i,end:o,id:n.id,data:{type:"dash-event-stream",value:{schemeIdUri:e,timescale:s,element:u,xmlData:c}}})}}return a}function Gu(e,t,n,i,a=new WeakMap){const{children:o,attributes:s}=e;if(r(t.externalClockOffset)){const a="dynamic"===s.type,l=De(o.utcTimings,e=>{return"urn:mpeg:dash:utc:direct:2014"===e.schemeIdUri&&!r(e.value)}),u=r(l)||r(l.value)?void 0:Pl(l.value),c=r(u)||isNaN(u)?void 0:u;if(r(c)||!0===i){if(a&&!0!==i){const i=Nl(e);if(!r(i)&&i.length>0)return{type:"needs-clock",value:{url:i,continue:function(i){return i.success?(t.externalClockOffset=Pl(i.data),Gu(e,t,n,!0)):(n.push(i.error),j.warn("DASH Parser: Error on fetching the clock ressource",i.error),Gu(e,t,n,!0))}}}}}else t.externalClockOffset=c}const l=[];for(let u=0;u<o.periods.length;u++){const{xlinkHref:e,xlinkActuate:t}=o.periods[u].attributes;r(e)||"onLoad"!==t||l.push({index:u,ressource:e})}return 0===l.length?ju(e,t,n,a):{type:"needs-xlinks",value:{xlinksUrls:l.map(({ressource:e})=>e),continue:function(r){if(r.length!==l.length)throw new Error("DASH parser: wrong number of loaded ressources.");for(let e=r.length-1;e>=0;e--){const t=l[e].index,{parsed:i,warnings:s,receivedTime:u,sendingTime:c,url:d}=r[e];s.length>0&&n.push(...s);for(const e of i)a.set(e,{receivedTime:u,sendingTime:c,url:d});o.periods.splice(t,1,...i)}return Gu(e,t,n,i,a)}}}}function ju(e,t,n,i){var a,o,s,l,u;const{children:c,attributes:d}=e,f="dynamic"===d.type,h=void 0!==t.url?[{url:t.url.substring(0,po(t.url))}]:[],p=wu(h,c.baseURLs),g=Vl(d,t.referenceDateTime),m=d.timeShiftBufferDepth,{externalClockOffset:v,unsafelyBaseOnPreviousManifest:y}=t,{externalClockOffset:_}=t,b=new jl({availabilityStartTime:g,isDynamic:f,timeShiftBufferDepth:m,serverTimestampOffset:_}),E=new Ml;E.addReferences(null!==(a=c.contentProtections)&&void 0!==a?a:[]);const T={availabilityStartTime:g,baseURLs:p,clockOffset:v,contentProtectionParser:E,duration:d.duration,isDynamic:f,manifestBoundsCalculator:b,manifestProfiles:e.attributes.profiles,receivedTime:t.manifestReceivedTime,timeShiftBufferDepth:m,unsafelyBaseOnPreviousManifest:y,xlinkInfos:i,xmlNamespaces:e.attributes.namespaces},S=Ou(c.periods,T);E.finalize();const w=d.duration;let A,I,x,R=null;void 0!==d.minimumUpdatePeriod&&d.minimumUpdatePeriod>=0&&(A=0===d.minimumUpdatePeriod?O.getCurrent().DASH_FALLBACK_LIFETIME_WHEN_MINIMUM_UPDATE_PERIOD_EQUAL_0:d.minimumUpdatePeriod);const{minimumSafePosition:C,maximumSafePosition:D,maximumUnsafePosition:k}=Gl(S),M=Te();if(f){let e;if(void 0!==D)e=D;else if(void 0===_)j.warn("DASH Parser: use system clock to define maximum position"),e=Date.now()/1e3-g;else{const t=Te()+_;e=t/1e3-g}let t=b.getEstimatedLiveEdge();void 0===t&&(t=void 0!==k?k:e),x={isLinear:!0,maximumSafePosition:e,livePosition:t,time:M},I=C,R=null!==m&&void 0!==m?m:null,null!==R&&void 0!==I&&t-I>R&&(R=t-I)}else{I=C,void 0===I&&(I=null!==(s=null===(o=S[0])||void 0===o?void 0:o.start)&&void 0!==s?s:0);let e=null!==w&&void 0!==w?w:1/0;if(void 0!==S[S.length-1]){const t=S[S.length-1],n=null!==(l=t.end)&&void 0!==l?l:void 0!==t.duration?t.start+t.duration:void 0;void 0!==n&&n<e&&(e=n)}void 0!==D&&D<e&&(e=D),x={isLinear:!1,maximumSafePosition:e,livePosition:void 0,time:M}}const L=!f||void 0===e.attributes.minimumUpdatePeriod&&(void 0!==(null===(u=S[S.length-1])||void 0===u?void 0:u.end)||void 0!==e.attributes.duration),P={availabilityStartTime:g,clockOffset:t.externalClockOffset,isDynamic:f,isLive:f,isLastPeriodKnown:L,periods:S,publishTime:d.publishTime,suggestedPresentationDelay:d.suggestedPresentationDelay,transportType:"dash",timeBounds:{minimumSafePosition:I,timeshiftDepth:R,maximumTimeData:x},lifetime:A,uris:r(t.url)?c.locations:[t.url,...c.locations]};return{type:"done",value:{parsed:P,warnings:n}}}var Vu=Gu;function Hu(e){const t=e.textContent,n=[];return null===t||0===t.length?[void 0,n]:[{value:t},n]}const Ku=/^P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,zu=/([0-9]+)-([0-9]+)/;function Zu(e,t){if("true"===e)return[!0,null];if("false"===e)return[!1,null];const n=new ic(`\`${t}\` property is not a boolean value but "${e}"`);return[!1,n]}function qu(e,t){const n=parseInt(e,10);if(isNaN(n)){const n=new ic(`\`${t}\` property is not an integer value but "${e}"`);return[null,n]}return[n,null]}function Yu(e,t){if("INF"===e)return[1/0,null];const n=parseFloat(e);if(isNaN(n)){const n=new ic(`\`${t}\` property is invalid: "${e}"`);return[null,n]}return[n,null]}function Wu(e,t){if("true"===e)return[!0,null];if("false"===e)return[!1,null];const n=parseInt(e,10);if(isNaN(n)){const n=new ic(`\`${t}\` property is not a boolean nor an integer but "${e}"`);return[null,n]}return[n,null]}function $u(e,t){const n=Date.parse(e);if(isNaN(n)){const n=new ic(`\`${t}\` is in an invalid date format: "${e}"`);return[null,n]}return[new Date(Date.parse(e)).getTime()/1e3,null]}function Xu(e,t){if(!Nt(e)){const e=new ic(`\`${t}\` property is empty`);return[0,e]}const n=Ku.exec(e);if(null===n){const n=new ic(`\`${t}\` property has an unrecognized format "${e}"`);return[null,n]}const i=365*parseFloat(Nt(n[2])?n[2]:"0")*24*60*60+30*parseFloat(Nt(n[4])?n[4]:"0")*24*60*60+24*parseFloat(Nt(n[6])?n[6]:"0")*60*60+60*parseFloat(Nt(n[8])?n[8]:"0")*60+60*parseFloat(Nt(n[10])?n[10]:"0")+parseFloat(Nt(n[12])?n[12]:"0");return[i,null]}function Qu(e,t){const n=zu.exec(e);if(null===n){const n=new ic(`\`${t}\` property has an unrecognized format "${e}"`);return[null,n]}return[[+n[1],+n[2]],null]}function Ju(e,t){try{return[Wo(e),null]}catch(n){const i=new ic(`\`${t}\` is not a valid base64 string: "${e}"`);return[null,i]}}function ec(e,t){const n=/^(\d+)\/(\d+)$/.exec(e);return null!==n?[+n[1]/+n[2],null]:Yu(e,t)}function tc(e){let t,n;for(let i=0;i<e.attributes.length;i++){const r=e.attributes[i];switch(r.name){case"schemeIdUri":t=r.value;break;case"value":n=r.value;break}}return{schemeIdUri:t,value:n}}function nc(e,t){return function(n,{asKey:i,parser:r,dashName:a}){const[o,s]=r(n,a);null!==s&&(j.warn(s.message),t.push(s)),null!==o&&(e[i]=o)}}class ic extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ic.prototype),this.name="MPDError"}}function rc(e){const t=[],n=[];for(let i=0;i<e.length;i++)if(e[i].nodeType===Node.ELEMENT_NODE){const r=e[i];if("cenc:pssh"===r.nodeName){const e=r.textContent;if(null!==e&&e.length>0){const[i,r]=Ju(e,"cenc:pssh");null!==r&&(j.warn(r.message),t.push(r)),null!==i&&n.push(i)}}}return[{cencPssh:n},t]}function ac(e){const t={};for(let n=0;n<e.attributes.length;n++){const i=e.attributes[n];switch(i.name){case"schemeIdUri":t.schemeIdUri=i.value;break;case"value":t.value=i.value;break;case"cenc:default_KID":t.keyId=Mo(i.value.replace(/-/g,""));break;case"ref":t.ref=i.value;break;case"refId":t.refId=i.value;break}}return t}function oc(e){const[t,n]=rc(e.childNodes),i=ac(e);return[{children:t,attributes:i},n]}function sc(e){const t={};for(let n=0;n<e.attributes.length;n++){const i=e.attributes[n];switch(i.name){case"id":t.id=i.value;break;case"lang":t.language=i.value;break;case"contentType":t.contentType=i.value;break;case"par":t.par=i.value;break}}return t}function lc(e){const t={},n=[],i=nc(t,n);for(let r=0;r<e.attributes.length;r++){const n=e.attributes[r];switch(n.name){case"range":i(n.value,{asKey:"range",parser:Qu,dashName:"range"});break;case"sourceURL":t.media=n.value;break}}return[t,n]}function uc(e){const t={};let n=[];const i=nc(t,n),r=e.childNodes;for(let a=0;a<r.length;a++)if(r[a].nodeType===Node.ELEMENT_NODE){const e=r[a];if("Initialization"===e.nodeName){const[i,r]=lc(e);t.initialization=i,n=n.concat(r)}}for(let a=0;a<e.attributes.length;a++){const t=e.attributes[a];switch(t.name){case"timescale":i(t.value,{asKey:"timescale",parser:qu,dashName:"timescale"});break;case"presentationTimeOffset":i(t.value,{asKey:"presentationTimeOffset",parser:Yu,dashName:"presentationTimeOffset"});break;case"indexRange":i(t.value,{asKey:"indexRange",parser:Qu,dashName:"indexRange"});break;case"indexRangeExact":i(t.value,{asKey:"indexRangeExact",parser:Zu,dashName:"indexRangeExact"});break;case"availabilityTimeOffset":i(t.value,{asKey:"availabilityTimeOffset",parser:Yu,dashName:"availabilityTimeOffset"});break;case"availabilityTimeComplete":i(t.value,{asKey:"availabilityTimeComplete",parser:Zu,dashName:"availabilityTimeComplete"});break;case"duration":i(t.value,{asKey:"duration",parser:qu,dashName:"duration"});break;case"startNumber":i(t.value,{asKey:"startNumber",parser:qu,dashName:"startNumber"});break;case"endNumber":i(t.value,{asKey:"endNumber",parser:qu,dashName:"endNumber"});break}}return[t,n]}function cc(e){const t={},n=[],i=nc(t,n);for(let r=0;r<e.attributes.length;r++){const n=e.attributes[r];switch(n.name){case"media":t.media=n.value;break;case"indexRange":i(n.value,{asKey:"indexRange",parser:Qu,dashName:"indexRange"});break;case"index":t.index=n.value;break;case"mediaRange":i(n.value,{asKey:"mediaRange",parser:Qu,dashName:"mediaRange"});break}}return[t,n]}function dc(e){const[t,n]=uc(e);let i=n;const r=[],a=e.childNodes;for(let s=0;s<a.length;s++)if(a[s].nodeType===Node.ELEMENT_NODE){const e=a[s];if("SegmentURL"===e.nodeName){const[t,n]=cc(e);r.push(t),i=i.concat(n)}}const o=k(t,{list:r});return[o,i]}function fc(e){let t=null;return function(){if(null===t){const n=e.getElementsByTagName("S");return t=n,n}return t}}function hc(e){const[t,n]=uc(e),i=n;let a;for(let r=0;r<e.childNodes.length;r++)if(e.childNodes[r].nodeType===Node.ELEMENT_NODE){const t=e.childNodes[r];"SegmentTimeline"===t.nodeName&&(a=fc(t))}const o=k({},t,{duration:t.duration,timelineParser:a}),s=nc(o,i);for(let l=0;l<e.attributes.length;l++){const t=e.attributes[l];switch(t.nodeName){case"initialization":r(o.initialization)&&(o.initialization={media:t.value});break;case"index":o.index=t.value;break;case"availabilityTimeOffset":s(t.value,{asKey:"availabilityTimeOffset",parser:Yu,dashName:"availabilityTimeOffset"});break;case"availabilityTimeComplete":s(t.value,{asKey:"availabilityTimeComplete",parser:Zu,dashName:"availabilityTimeComplete"});break;case"media":o.media=t.value;break;case"bitstreamSwitching":s(t.value,{asKey:"bitstreamSwitching",parser:Zu,dashName:"bitstreamSwitching"});break}}return[o,i]}function pc(e){const t={baseURLs:[]},n=[];let i=[];for(let a=0;a<e.length;a++)if(e[a].nodeType===Node.ELEMENT_NODE){const o=e[a];switch(o.nodeName){case"BaseURL":const[e,a]=Hu(o);void 0!==e&&t.baseURLs.push(e),i=i.concat(a);break;case"InbandEventStream":void 0===t.inbandEventStreams&&(t.inbandEventStreams=[]),t.inbandEventStreams.push(tc(o));break;case"SegmentBase":const[s,l]=uc(o);t.segmentBase=s,l.length>0&&(i=i.concat(l));break;case"SegmentList":const[u,c]=dc(o);i=i.concat(c),t.segmentList=u;break;case"SegmentTemplate":const[d,f]=hc(o);i=i.concat(f),t.segmentTemplate=d;break;case"ContentProtection":const[h,p]=oc(o);p.length>0&&(i=i.concat(p)),void 0!==h&&n.push(h);break;case"SupplementalProperty":r(t.supplementalProperties)?t.supplementalProperties=[tc(o)]:t.supplementalProperties.push(tc(o));break}}return n.length>0&&(t.contentProtections=n),[t,i]}function gc(e){const t={},n=[],i=nc(t,n);for(let r=0;r<e.attributes.length;r++){const n=e.attributes[r];switch(n.name){case"audioSamplingRate":t.audioSamplingRate=n.value;break;case"bandwidth":i(n.value,{asKey:"bitrate",parser:qu,dashName:"bandwidth"});break;case"codecs":t.codecs=n.value;break;case"codingDependency":i(n.value,{asKey:"codingDependency",parser:Zu,dashName:"codingDependency"});break;case"frameRate":i(n.value,{asKey:"frameRate",parser:ec,dashName:"frameRate"});break;case"height":i(n.value,{asKey:"height",parser:qu,dashName:"height"});break;case"id":t.id=n.value;break;case"maxPlayoutRate":i(n.value,{asKey:"maxPlayoutRate",parser:Yu,dashName:"maxPlayoutRate"});break;case"maximumSAPPeriod":i(n.value,{asKey:"maximumSAPPeriod",parser:Yu,dashName:"maximumSAPPeriod"});break;case"mimeType":t.mimeType=n.value;break;case"profiles":t.profiles=n.value;break;case"qualityRanking":i(n.value,{asKey:"qualityRanking",parser:qu,dashName:"qualityRanking"});break;case"scte214:supplementalCodecs":t.supplementalCodecs=n.value;break;case"segmentProfiles":t.segmentProfiles=n.value;break;case"width":i(n.value,{asKey:"width",parser:qu,dashName:"width"});break;case"availabilityTimeOffset":i(n.value,{asKey:"availabilityTimeOffset",parser:Yu,dashName:"availabilityTimeOffset"});break;case"availabilityTimeComplete":i(n.value,{asKey:"availabilityTimeComplete",parser:Zu,dashName:"availabilityTimeComplete"});break}}return void 0===t.bitrate&&n.push(new ic("No bitrate found on a Representation")),[t,n]}function mc(e){const[t,n]=pc(e.childNodes),[i,r]=gc(e),a=n.concat(r);return[{children:t,attributes:i},a]}function vc(e){const t={baseURLs:[],representations:[]},n=[];let i=[];for(let a=0;a<e.length;a++)if(e[a].nodeType===Node.ELEMENT_NODE){const o=e[a];switch(o.nodeName){case"Accessibility":void 0===t.accessibilities?t.accessibilities=[tc(o)]:t.accessibilities.push(tc(o));break;case"BaseURL":const[e,a]=Hu(o);void 0!==e&&t.baseURLs.push(e),a.length>0&&(i=i.concat(a));break;case"ContentComponent":t.contentComponent=sc(o);break;case"EssentialProperty":r(t.essentialProperties)?t.essentialProperties=[tc(o)]:t.essentialProperties.push(tc(o));break;case"InbandEventStream":void 0===t.inbandEventStreams&&(t.inbandEventStreams=[]),t.inbandEventStreams.push(tc(o));break;case"Label":const s=o.textContent;null!==s&&void 0!==s&&(t.label=s);break;case"Representation":const[l,u]=mc(o);t.representations.push(l),u.length>0&&(i=i.concat(u));break;case"Role":r(t.roles)?t.roles=[tc(o)]:t.roles.push(tc(o));break;case"SupplementalProperty":r(t.supplementalProperties)?t.supplementalProperties=[tc(o)]:t.supplementalProperties.push(tc(o));break;case"SegmentBase":const[c,d]=uc(o);t.segmentBase=c,d.length>0&&(i=i.concat(d));break;case"SegmentList":const[f,h]=dc(o);t.segmentList=f,h.length>0&&(i=i.concat(h));break;case"SegmentTemplate":const[p,g]=hc(o);t.segmentTemplate=p,g.length>0&&(i=i.concat(g));break;case"ContentProtection":const[m,v]=oc(o);v.length>0&&(i=i.concat(v)),void 0!==m&&n.push(m);break}}return n.length>0&&(t.contentProtections=n),[t,i]}function yc(e){const t={},n=[],i=nc(t,n);for(let r=0;r<e.attributes.length;r++){const n=e.attributes[r];switch(n.name){case"id":t.id=n.value;break;case"group":i(n.value,{asKey:"group",parser:qu,dashName:"group"});break;case"lang":t.language=n.value;break;case"contentType":t.contentType=n.value;break;case"par":t.par=n.value;break;case"minBandwidth":i(n.value,{asKey:"minBitrate",parser:qu,dashName:"minBandwidth"});break;case"maxBandwidth":i(n.value,{asKey:"maxBitrate",parser:qu,dashName:"maxBandwidth"});break;case"minWidth":i(n.value,{asKey:"minWidth",parser:qu,dashName:"minWidth"});break;case"maxWidth":i(n.value,{asKey:"maxWidth",parser:qu,dashName:"maxWidth"});break;case"minHeight":i(n.value,{asKey:"minHeight",parser:qu,dashName:"minHeight"});break;case"maxHeight":i(n.value,{asKey:"maxHeight",parser:qu,dashName:"maxHeight"});break;case"minFrameRate":i(n.value,{asKey:"minFrameRate",parser:ec,dashName:"minFrameRate"});break;case"maxFrameRate":i(n.value,{asKey:"maxFrameRate",parser:ec,dashName:"maxFrameRate"});break;case"selectionPriority":i(n.value,{asKey:"selectionPriority",parser:qu,dashName:"selectionPriority"});break;case"segmentAlignment":i(n.value,{asKey:"segmentAlignment",parser:Wu,dashName:"segmentAlignment"});break;case"subsegmentAlignment":i(n.value,{asKey:"subsegmentAlignment",parser:Wu,dashName:"subsegmentAlignment"});break;case"bitstreamSwitching":i(n.value,{asKey:"bitstreamSwitching",parser:Zu,dashName:"bitstreamSwitching"});break;case"audioSamplingRate":t.audioSamplingRate=n.value;break;case"codecs":t.codecs=n.value;break;case"scte214:supplementalCodecs":t.supplementalCodecs=n.value;break;case"codingDependency":i(n.value,{asKey:"codingDependency",parser:Zu,dashName:"codingDependency"});break;case"frameRate":i(n.value,{asKey:"frameRate",parser:ec,dashName:"frameRate"});break;case"height":i(n.value,{asKey:"height",parser:qu,dashName:"height"});break;case"maxPlayoutRate":i(n.value,{asKey:"maxPlayoutRate",parser:Yu,dashName:"maxPlayoutRate"});break;case"maximumSAPPeriod":i(n.value,{asKey:"maximumSAPPeriod",parser:Yu,dashName:"maximumSAPPeriod"});break;case"mimeType":t.mimeType=n.value;break;case"profiles":t.profiles=n.value;break;case"segmentProfiles":t.segmentProfiles=n.value;break;case"width":i(n.value,{asKey:"width",parser:qu,dashName:"width"});break;case"availabilityTimeOffset":i(n.value,{asKey:"availabilityTimeOffset",parser:Yu,dashName:"availabilityTimeOffset"});break;case"availabilityTimeComplete":i(n.value,{asKey:"availabilityTimeComplete",parser:Zu,dashName:"availabilityTimeComplete"});break}}return[t,n]}function _c(e){const t=e.childNodes,[n,i]=vc(t),[r,a]=yc(e),o=i.concat(a);return[{children:n,attributes:r},o]}function bc(e){const t={children:{events:[]},attributes:{}};let n=[];const i=nc(t.attributes,n);for(let r=0;r<e.attributes.length;r++){const n=e.attributes[r];switch(n.name){case"schemeIdUri":t.attributes.schemeIdUri=n.value;break;case"timescale":i(n.value,{asKey:"timescale",parser:qu,dashName:"timescale"});break;case"value":t.attributes.value=n.value;break}}for(let r=0;r<e.childNodes.length;r++)if(e.childNodes[r].nodeType===Node.ELEMENT_NODE){const i=e.childNodes[r];switch(i.nodeName){case"Event":const[e,r]=Ec(i);t.children.events.push(e),r.length>0&&(n=n.concat(r));break}}return[t,n]}function Ec(e){const t={eventStreamData:e},n=[],i=nc(t,n);for(let r=0;r<e.attributes.length;r++){const n=e.attributes[r];switch(n.name){case"presentationTime":i(n.value,{asKey:"presentationTime",parser:qu,dashName:"presentationTime"});break;case"duration":i(n.value,{asKey:"duration",parser:qu,dashName:"duration"});break;case"id":t.id=n.value;break}}return[t,n]}function Tc(e){const t=[],n=[];let i;const r=[];let a=[];const o=[];for(let s=0;s<e.length;s++)if(e[s].nodeType===Node.ELEMENT_NODE){const l=e[s];switch(l.nodeName){case"BaseURL":const[e,s]=Hu(l);void 0!==e&&t.push(e),a=a.concat(s);break;case"AdaptationSet":const[u,c]=_c(l);n.push(u),a=a.concat(c);break;case"EventStream":const[d,f]=bc(l);o.push(d),a=a.concat(f);break;case"SegmentTemplate":const[h,p]=hc(l);i=h,p.length>0&&(a=a.concat(p));break;case"ContentProtection":const[g,m]=oc(l);m.length>0&&(a=a.concat(m)),void 0!==g&&r.push(g);break}}return[{baseURLs:t,adaptations:n,eventStreams:o,segmentTemplate:i,contentProtections:r},a]}function Sc(e){const t={},n=[],i=nc(t,n);for(let r=0;r<e.attributes.length;r++){const n=e.attributes[r];switch(n.name){case"id":t.id=n.value;break;case"start":i(n.value,{asKey:"start",parser:Xu,dashName:"start"});break;case"duration":i(n.value,{asKey:"duration",parser:Xu,dashName:"duration"});break;case"bitstreamSwitching":i(n.value,{asKey:"bitstreamSwitching",parser:Zu,dashName:"bitstreamSwitching"});break;case"xlink:href":t.xlinkHref=n.value;break;case"xlink:actuate":t.xlinkActuate=n.value;break}}return[t,n]}function wc(e){const[t,n]=Tc(e.childNodes),[i,r]=Sc(e),a=n.concat(r);return[{children:t,attributes:i},a]}function Ac(e){const t=[],n=[],i=[],r=[],a=[];let o=[];for(let s=0;s<e.length;s++)if(e[s].nodeType===Node.ELEMENT_NODE){const l=e[s];switch(l.nodeName){case"BaseURL":const[e,s]=Hu(l);void 0!==e&&t.push(e),o=o.concat(s);break;case"Location":n.push(null===l.textContent?"":l.textContent);break;case"Period":const[u,c]=wc(l);i.push(u),o=o.concat(c);break;case"UTCTiming":const d=tc(l);r.push(d);break;case"ContentProtection":const[f,h]=oc(l);h.length>0&&(o=o.concat(h)),void 0!==f&&a.push(f);break}}return[{baseURLs:t,locations:n,periods:i,utcTimings:r,contentProtections:a},o]}function Ic(e){const t={},n=[],i=nc(t,n);for(let r=0;r<e.attributes.length;r++){const n=e.attributes[r];switch(n.name){case"id":t.id=n.value;break;case"profiles":t.profiles=n.value;break;case"type":t.type=n.value;break;case"availabilityStartTime":i(n.value,{asKey:"availabilityStartTime",parser:$u,dashName:"availabilityStartTime"});break;case"availabilityEndTime":i(n.value,{asKey:"availabilityEndTime",parser:$u,dashName:"availabilityEndTime"});break;case"publishTime":i(n.value,{asKey:"publishTime",parser:$u,dashName:"publishTime"});break;case"mediaPresentationDuration":i(n.value,{asKey:"duration",parser:Xu,dashName:"mediaPresentationDuration"});break;case"minimumUpdatePeriod":i(n.value,{asKey:"minimumUpdatePeriod",parser:Xu,dashName:"minimumUpdatePeriod"});break;case"minBufferTime":i(n.value,{asKey:"minBufferTime",parser:Xu,dashName:"minBufferTime"});break;case"timeShiftBufferDepth":i(n.value,{asKey:"timeShiftBufferDepth",parser:Xu,dashName:"timeShiftBufferDepth"});break;case"suggestedPresentationDelay":i(n.value,{asKey:"suggestedPresentationDelay",parser:Xu,dashName:"suggestedPresentationDelay"});break;case"maxSegmentDuration":i(n.value,{asKey:"maxSegmentDuration",parser:Xu,dashName:"maxSegmentDuration"});break;case"maxSubsegmentDuration":i(n.value,{asKey:"maxSubsegmentDuration",parser:Xu,dashName:"maxSubsegmentDuration"});break}}return[t,n]}function xc(e){const[t,n]=Ac(e.childNodes),[i,r]=Ic(e),a=n.concat(r);return[{children:t,attributes:i},a]}function Rc(e,t){const n=e.documentElement;if(r(n)||"MPD"!==n.nodeName)throw new Error("DASH Parser: document root should be MPD");const[i,a]=xc(n),o=Vu(i,t,a);return s(o);function s(e){return"done"===e.type?e:"needs-clock"===e.type?{type:"needs-resources",value:{urls:[e.value.url],format:"string",continue(t){if(1!==t.length)throw new Error("DASH parser: wrong number of loaded ressources.");const n=e.value.continue(t[0].responseData);return s(n)}}}:"needs-xlinks"===e.type?{type:"needs-resources",value:{urls:e.value.xlinksUrls,format:"string",continue(t){const n=[];for(let e=0;e<t.length;e++){const{responseData:i,receivedTime:a,sendingTime:o,url:s}=t[e];if(!i.success)throw i.error;const l="<root>"+i.data+"</root>",u=(new DOMParser).parseFromString(l,"text/xml");if(r(u)||0===u.children.length)throw new Error("DASH parser: Invalid external ressources");const c=u.children[0].children,d=[],f=[];for(let e=0;e<c.length;e++)if(c[e].nodeType===Node.ELEMENT_NODE){const[t,n]=wc(c[e]);f.push(...n),d.push(t)}n.push({url:s,receivedTime:a,sendingTime:o,parsed:d,warnings:f})}const i=e.value.continue(n);return s(i)}}}:void ge(e)}}var Cc=Rc;function Dc(e){const{referenceDateTime:t}=e,n=void 0!==e.serverSyncInfos?e.serverSyncInfos.serverTimestamp-e.serverSyncInfos.clientTime:void 0;return function(i,r,a,o,s){var l;const{responseData:u}=i,c=r.externalClockOffset,d=null!==(l=i.url)&&void 0!==l?l:r.originalUrl,f=null!==n&&void 0!==n?n:c,h=r.unsafeMode?r.previousManifest:null,p={unsafelyBaseOnPreviousManifest:h,url:d,referenceDateTime:t,externalClockOffset:f},g=Zt.dashParsers;if(null===g.wasm||"uninitialized"===g.wasm.status||"failure"===g.wasm.status)return j.debug("DASH: WASM MPD Parser not initialized. Running JS one."),m();{const e=Nc(u);if(!Oc(e))return j.info("DASH: MPD doesn't seem to be UTF-8-encoded. Running JS parser instead of the WASM one."),m();if("initialized"===g.wasm.status){j.debug("DASH: Running WASM MPD Parser.");const t=g.wasm.runWasmParser(e,p);return v(t)}{j.debug("DASH: Awaiting WASM initialization before parsing the MPD.");const t=g.wasm.waitForInitialization().catch(()=>{});return t.then(()=>{if(null===g.wasm||"initialized"!==g.wasm.status)return j.warn("DASH: WASM MPD parser initialization failed. Running JS parser instead"),m();j.debug("DASH: Running WASM MPD Parser.");const t=g.wasm.runWasmParser(e,p);return v(t)})}}function m(){if(null!==g.fastJs){const e=Lc(u),t=g.fastJs(e,p);return v(t)}if(null!==g.native){const e=Pc(u),t=g.native(e,p);return v(t)}throw new Error("No MPD parser is imported")}function v(t){if("done"===t.type){if(t.value.warnings.length>0&&a(t.value.warnings),o.isCancelled())return Promise.reject(o.cancellationError);const n=[],i=new on(t.value.parsed,e,n);return{manifest:i,url:d,warnings:n}}const{value:n}=t,i=n.urls.map(e=>{return s(()=>{const t=O.getCurrent().DEFAULT_REQUEST_TIMEOUT,i=O.getCurrent().DEFAULT_CONNECTION_TIMEOUT;return"string"===n.format?xs({url:e,responseType:"text",timeout:t,connectionTimeout:i,cancelSignal:o}):xs({url:e,responseType:"arraybuffer",timeout:t,connectionTimeout:i,cancelSignal:o})}).then(e=>{if("string"===n.format){if("string"!==typeof e.responseData)throw new Error("External DASH resources should have been a string");return k(e,{responseData:{success:!0,data:e.responseData}})}if(!(e.responseData instanceof ArrayBuffer))throw new Error("External DASH resources should have been ArrayBuffers");return k(e,{responseData:{success:!0,data:e.responseData}})},e=>{const t=ht(e,{defaultCode:"PIPELINE_PARSE_ERROR",defaultReason:"An unknown error occured when parsing ressources."});return k({},{size:void 0,requestDuration:void 0,responseData:{success:!1,error:t}})})});return Promise.all(i).then(e=>{return"string"===n.format?(kc(e),v(n.continue(e))):(Mc(e),v(n.continue(e)))})}}}function kc(e){}function Mc(e){}function Lc(e){if(e instanceof ArrayBuffer)return ko(new Uint8Array(e));if("string"===typeof e)return e;if(e instanceof Document)return e.documentElement.outerHTML;throw new Error("DASH Manifest Parser: Unrecognized Manifest format")}function Pc(e){if(e instanceof ArrayBuffer)return(new DOMParser).parseFromString(ko(new Uint8Array(e)),"text/xml");if("string"===typeof e)return(new DOMParser).parseFromString(e,"text/xml");if(e instanceof Document)return e;throw new Error("DASH Manifest Parser: Unrecognized Manifest format")}function Nc(e){if(e instanceof ArrayBuffer)return e;if("string"===typeof e)return Ro(e).buffer;if(e instanceof Document)return Ro(e.documentElement.innerHTML).buffer;throw new Error("DASH Manifest Parser: Unrecognized Manifest format")}function Oc(e){const t=new DataView(e);return 61371===t.getUint16(0)&&191===t.getUint8(2)||65279!==t.getUint16(0)&&65534!==t.getUint16(0)}const Fc="function"===typeof Headers?Headers:null,Uc="function"===typeof AbortController?AbortController:null;function Bc(e){var t,n;let i;if(!r(e.headers))if(r(Fc))i=e.headers;else{i=new Fc;const t=Object.keys(e.headers);for(let n=0;n<t.length;n++){const r=t[n];i.append(r,e.headers[r])}}j.debug("Fetch: Called with URL",e.url);let a=null,o=!1,s=!1;const l=Te(),u=r(Uc)?null:new Uc;function c(){r(u)?j.warn("Fetch: AbortController API not available."):u.abort()}let d,f;void 0!==e.timeout&&(d=setTimeout(()=>{o=!0,void 0!==f&&clearTimeout(f),c()},e.timeout)),void 0!==e.connectionTimeout&&(f=setTimeout(()=>{s=!0,void 0!==d&&clearTimeout(d),c()},e.connectionTimeout));const h=e.cancelSignal.register(function(e){a=e,c()}),p={method:"GET"};if(void 0!==i&&(p.headers=i),p.signal=r(u)?null:u.signal,j.hasLevel("DEBUG")){let i="FETCH: Sending GET "+e.url;void 0!==e.timeout&&(i+=" to="+String(e.timeout/1e3)),void 0!==e.connectionTimeout&&(i+=" cto="+String(e.connectionTimeout/1e3)),void 0!==(null===(t=e.headers)||void 0===t?void 0:t.Range)&&(i+=" Range="+(null===(n=e.headers)||void 0===n?void 0:n.Range)),j.debug(i)}return fetch(e.url,p).then(t=>{if(void 0!==f&&clearTimeout(f),t.status>=300)throw j.warn("Fetch: Request HTTP Error",t.status,t.url),new nt(t.url,t.status,it.ERROR_HTTP_CODE);if(r(t.body))throw new nt(t.url,t.status,it.PARSE_ERROR);const n=t.headers.get("Content-Length"),i=r(n)||isNaN(+n)?void 0:+n,a=t.body.getReader();let o=0;return s();async function s(){const n=await a.read();if(!n.done&&!r(n.value)){o+=n.value.byteLength;const r=Te(),a={url:t.url,currentTime:r,duration:r-l,sendingTime:l,chunkSize:n.value.byteLength,chunk:n.value.buffer,size:o,totalSize:i};return e.onData(a),s()}if(n.done){void 0!==d&&clearTimeout(d),h();const e=Te(),n=e-l;return{requestDuration:n,receivedTime:e,sendingTime:l,size:o,status:t.status,url:t.url}}return s()}}).catch(t=>{if(null!==a)throw a;if(h(),o)throw j.warn("Fetch: Request timed out."),new nt(e.url,0,it.TIMEOUT);if(s)throw j.warn("Fetch: Request connection timed out."),new nt(e.url,0,it.TIMEOUT);if(t instanceof nt)throw t;throw j.warn("Fetch: Request Error",t instanceof Error?t.toString():""),new nt(e.url,0,it.ERROR_EVENT)})}function Gc(){return"function"===typeof o["a"].fetch&&!r(Uc)&&!r(Fc)}function jc(e,t){return"audio"===e||"video"===e?"video/mp4"===t||"audio/mp4"===t?"mp4":"video/webm"===t||"audio/webm"===t?"webm":void 0:"text"===e&&"application/mp4"===t?"mp4":void 0}function Vc(e){return(t,n,i,r,a)=>{return new Promise((s,l)=>{const u=new me,c=u.linkToSignal(r);function d(){u.signal.deregister(l),c()}u.signal.register(l),e(t,n,i,u.signal,Object.assign(Object.assign({},a),{onNewChunk(e){try{o(e),a.onNewChunk(e)}catch(e){d(),u.cancel(),l(e)}}})).then(e=>{if(d(),!u.isUsed()){if("segment-loaded"===e.resultType)try{o(e.resultData.responseData)}catch(e){return void l(e)}s(e)}},e=>{d(),l(e)})});function o(e){(e instanceof ArrayBuffer||e instanceof Uint8Array)&&"mp4"===jc(n.type,n.mimeType)&&Cs(new Uint8Array(e),n.segment.isInit)}}}function Hc(e,t){return null===e?null:null===t.url?e.baseUrl:So(e.baseUrl,t.url)}function Kc(e,t,n,i,r){if(void 0===t.range)return xs({url:e,responseType:"arraybuffer",timeout:n.timeout,connectionTimeout:n.connectionTimeout,cancelSignal:i,onProgress:r.onProgress}).then(e=>({resultType:"segment-loaded",resultData:e}));if(void 0===t.indexRange)return xs({url:e,headers:{Range:yl(t.range)},responseType:"arraybuffer",timeout:n.timeout,connectionTimeout:n.connectionTimeout,cancelSignal:i,onProgress:r.onProgress}).then(e=>({resultType:"segment-loaded",resultData:e}));if(t.range[1]+1===t.indexRange[0])return xs({url:e,headers:{Range:yl([t.range[0],t.indexRange[1]])},responseType:"arraybuffer",timeout:n.timeout,connectionTimeout:n.connectionTimeout,cancelSignal:i,onProgress:r.onProgress}).then(e=>({resultType:"segment-loaded",resultData:e}));const a=xs({url:e,headers:{Range:yl(t.range)},responseType:"arraybuffer",timeout:n.timeout,connectionTimeout:n.connectionTimeout,cancelSignal:i,onProgress:r.onProgress}),o=xs({url:e,headers:{Range:yl(t.indexRange)},responseType:"arraybuffer",timeout:n.timeout,connectionTimeout:n.connectionTimeout,cancelSignal:i,onProgress:r.onProgress});return Promise.all([a,o]).then(([t,n])=>{const i=Gr(new Uint8Array(t.responseData),new Uint8Array(n.responseData)),r=Math.min(t.sendingTime,n.sendingTime),a=Math.max(t.receivedTime,n.receivedTime);return{resultType:"segment-loaded",resultData:{url:e,responseData:i,size:t.size+n.size,requestDuration:a-r,sendingTime:r,receivedTime:a}}})}function zc(e){let t=0;const n=[];let i=null;while(t<=e.length){if(t===e.length){i=null;break}i=e.subarray(t,1/0);const r=Rs(i,1836019558);if(r<0)break;const a=Hr(e,r+t),o=t+r+a;if(o>e.length)break;const s=Rs(i,1835295092);if(s<0)break;const l=Hr(e,s+t),u=t+s+l;if(u>e.length)break;const c=Math.max(o,u),d=e.subarray(t,c);n.push(d),t=c}return 0===n.length?[null,i]:[n,i]}function Zc(e,t,n,i,r){const{segment:a}=t,o=void 0!==a.range?{Range:yl(a.range)}:void 0;let s=null;function l(e){const t=new Uint8Array(e.chunk),n=null!==s?Gr(s,t):t,a=zc(n),o=a[0];s=a[1],null!==o&&(o.forEach(e=>{i.onNewChunk(e)}),r.isCancelled())||(i.onProgress({duration:e.duration,size:e.size,totalSize:e.totalSize}),r.isCancelled())}return Bc({url:e,headers:o,onData:l,timeout:n.timeout,connectionTimeout:n.connectionTimeout,cancelSignal:r}).then(e=>({resultType:"chunk-complete",resultData:e}))}function qc(e,t,n,i,r,a){if(t.segment.isInit)return Kc(e,t.segment,i,a,r);const o=jc(t.type,t.mimeType);if(n&&("mp4"===o||void 0===o)){if(Gc())return Zc(e,t,i,r,a);vt("DASH: Your browser does not have the fetch API. You will have a higher chance of rebuffering when playing close to the live edge")}const{segment:s}=t;return xs({url:e,responseType:"arraybuffer",headers:void 0!==s.range?{Range:yl(s.range)}:void 0,timeout:i.timeout,connectionTimeout:i.connectionTimeout,cancelSignal:a,onProgress:r.onProgress}).then(e=>({resultType:"segment-loaded",resultData:e}))}function Yc({lowLatencyMode:e,segmentLoader:t,checkMediaSegmentIntegrity:n}){return!0!==n?i:Vc(i);function i(n,i,r,a,o){const s=Hc(n,i.segment);return null===s?Promise.resolve({resultType:"segment-created",resultData:null}):e||void 0===t?qc(s,i,e,r,o,a):new Promise((n,l)=>{let u=!1;const c=e=>{u||a.isCancelled()||(u=!0,a.deregister(y),n({resultType:"segment-loaded",resultData:{responseData:e.data,size:e.size,requestDuration:e.duration}}))},d=e=>{var t,n;if(u||a.isCancelled())return;u=!0,a.deregister(y);const i=e,r=null!==(t=null===i||void 0===i?void 0:i.message)&&void 0!==t?t:"Unknown error when fetching a DASH segment through a custom segmentLoader.",o=new ln(r,null!==(n=null===i||void 0===i?void 0:i.canRetry)&&void 0!==n&&n,null===i||void 0===i?void 0:i.xhr);l(o)},f=e=>{u||a.isCancelled()||o.onProgress({duration:e.duration,size:e.size,totalSize:e.totalSize})},h=()=>{u||a.isCancelled()||(u=!0,a.deregister(y),qc(s,i,e,r,o,a).then(n,l))},p={reject:d,resolve:c,progress:f,fallback:h};let g;void 0!==i.segment.range&&(g=[i.segment.range],void 0!==i.segment.indexRange&&g.push(i.segment.indexRange));const m={isInit:i.segment.isInit,timeout:r.timeout,byteRanges:g,trackType:i.type,url:s},v=t(m,p);function y(e){u||(u=!0,"function"===typeof v&&v(),l(e))}a.register(y)})}}function Wc(e,t,n){return new Uint8Array(Array.prototype.slice.call(e,t,n))}function $c(e,t,n){return e.slice(t,n)}var Xc="function"===typeof Uint8Array.prototype.slice?$c:Wc;function Qc(e){let t=0;const n=eo(e,1836019574);if(null===n)return[];const i=[];while(t<n.length){let e;try{e=io(n,1886614376)}catch(e){const t=e instanceof Error?e:"";return j.warn("Error while removing PSSH from ISOBMFF",t),i}if(null===e)return i;const r=Xc(n,e[0],e[2]),a=Jc(r,e[1]-e[0]);void 0!==a&&i.push({systemId:a,data:r}),n[e[0]+4]=102,n[e[0]+5]=114,n[e[0]+6]=101,n[e[0]+7]=101,t=e[2]}return i}function Jc(e,t){if(e[t]>1)return void j.warn("ISOBMFF: un-handled PSSH version");const n=t+4;if(n+16>e.length)return;const i=Xc(e,n,n+16);return Lo(i)}const ed=408125543,td=357149030,nd=2807729,id=17545,rd=475249515,ad=187,od=179,sd=183,ld=241;function ud(e,t,n,[i,r]){let a=i;while(a<r){const i=pd(n,a);if(null===i)return null;const{value:r,length:o}=i,s=a+o,l=gd(n,s);if(null===l)return null;const{length:u,value:c}=l,d=s+u,f=d+c;if(r===e)return[d,f];if(t.length>0)for(let a=0;a<t.length;a++)if(r===t[a]){const i=t.slice(a+1,t.length);return ud(e,i,n,[d,f])}a=f}return null}function cd(e,t){const n=ud(nd,[ed,td],e,[t,e.length]);if(null===n)return null;const i=n[1]-n[0];return 1e9/yd(e,n[0],i)}function dd(e,t){const n=ud(id,[ed,td],e,[t,e.length]);if(null===n)return null;const i=n[1]-n[0];return 4===i?md(e,n[0]):8===i?vd(e,n[0]):null}function fd(e,t){const n=ud(ed,[],e,[t,e.length]);if(null===n)return null;const[i,r]=n,a=cd(e,i);if(null===a)return null;const o=dd(e,i);if(null===o)return null;const s=ud(rd,[],e,[i,r]);if(null===s)return null;const l=[];let u=s[0];while(u<s[1]){const t=ud(ad,[],e,[u,s[1]]);if(null===t)break;const n=ud(od,[],e,[t[0],t[1]]);if(null===n)return null;const r=yd(e,n[0],n[1]-n[0]),a=ud(ld,[sd],e,[t[0],t[1]]);if(null===a)return null;const o=yd(e,a[0],a[1]-a[0])+i;l.push({time:r,rangeStart:o}),u=t[1]}const c=[];for(let d=0;d<l.length;d++){const e=l[d];d===l.length-1?c.push({time:e.time,timescale:a,duration:0===d?o:o-e.time,range:[e.rangeStart,1/0]}):c.push({time:e.time,timescale:a,duration:l[d+1].time-e.time,range:[e.rangeStart,l[d+1].rangeStart-1]})}return c}function hd(e,t){for(let n=1;n<=8;n++)if(e[t]>=Math.pow(2,8-n))return n}function pd(e,t){const n=hd(e,t);if(void 0===n)return j.warn("webm: unrepresentable length"),null;if(t+n>e.length)return j.warn("webm: impossible length"),null;let i=0;for(let r=0;r<n;r++)i=e[t+r]*Math.pow(2,8*(n-r-1))+i;return{length:n,value:i}}function gd(e,t){const n=hd(e,t);if(void 0===n)return j.warn("webm: unrepresentable length"),null;if(t+n>e.length)return j.warn("webm: impossible length"),null;let i=(e[t]&(1<<8-n)-1)*Math.pow(2,8*(n-1));for(let r=1;r<n;r++)i=e[t+r]*Math.pow(2,8*(n-r-1))+i;return{length:n,value:i}}function md(e,t){return new DataView(e.buffer).getFloat32(t)}function vd(e,t){return new DataView(e.buffer).getFloat64(t)}function yd(e,t,n){let i=0;for(let r=0;r<n;r++)i=e[t+r]*Math.pow(2,8*(n-r-1))+i;return i}function _d(e,t,n,i){const r=Ps(e);if(void 0===r||void 0===i)return null;let a,o=void 0!==n.timestampOffset?r+n.timestampOffset*i:r,s=Os(e);if(o<0&&(void 0!==s&&(s+=o),o=0),t||!n.complete)return void 0===s&&j.warn("DASH: Chunked segments should indicate a duration through their trun boxes"),{time:o/i,duration:void 0!==s?s/i:void 0};const l=n.duration*i,u=Math.min(.9*i,l/4);return void 0!==s&&Math.abs(s-l)<=u&&(a=s),{time:o/i,duration:void 0!==a?a/i:a}}function bd(e,t){if(e.length<=0)return!1;const n=e.length;for(let i=0;i<n;i++){const n=e[i],r=t,{messageData:a}=n,o=ko(a),s=Date.parse(o);if(void 0===r||void 0===s||isNaN(s)||s>=r)return!0}return!1}function Ed(e,t){if(0===e.length)return;const{manifestRefreshEventsFromEMSGs:n,EMSGs:i}=e.reduce((e,t)=>{return"urn:mpeg:dash:event:2012"===t.schemeIdUri&&"1"===t.value?(void 0===e.manifestRefreshEventsFromEMSGs&&(e.manifestRefreshEventsFromEMSGs=[]),e.manifestRefreshEventsFromEMSGs.push(t)):(void 0===e.EMSGs&&(e.EMSGs=[]),e.EMSGs.push(t)),e},{manifestRefreshEventsFromEMSGs:void 0,EMSGs:void 0}),r=null===i||void 0===i?void 0:i.map(e=>({type:"emsg",value:e})),a=void 0!==t&&void 0!==n&&bd(n,t);return{inbandEvents:r,needsManifestRefresh:a}}function Td({__priv_patchLastSegmentInSidx:e}){return function(t,n,i){var a,o;const{segment:s,periodStart:l,periodEnd:u}=n,{data:c,isChunked:d}=t,f=[l,u];if(null===c)return s.isInit?{segmentType:"init",initializationData:null,initializationDataSize:0,protectionData:[],initTimescale:void 0}:{segmentType:"media",chunkData:null,chunkSize:0,chunkInfos:null,chunkOffset:0,protectionData:[],appendWindow:f};const h=c instanceof Uint8Array?c:new Uint8Array(c),p=jc(n.type,n.mimeType),g="mp4"===p||void 0===p,m=[];if(g){const e=Qc(h);let t;s.isInit&&(t=null!==(a=Gs(h))&&void 0!==a?a:void 0),(e.length>0||void 0!==t)&&m.push({initDataType:"cenc",keyId:t,initData:e})}if(!s.isInit){const e=g?_d(h,d,s,i):null,t=null!==(o=s.timestampOffset)&&void 0!==o?o:0;if(g){const i=Bs(h);if(void 0!==i){const r=i.filter(e=>{return void 0!==s.privateInfos&&void 0!==s.privateInfos.isEMSGWhitelisted&&s.privateInfos.isEMSGWhitelisted(e)}),a=Ed(r,n.manifestPublishTime);if(void 0!==a){const{needsManifestRefresh:n,inbandEvents:i}=a;return{segmentType:"media",chunkData:h,chunkSize:h.length,chunkInfos:e,chunkOffset:t,appendWindow:f,inbandEvents:i,protectionData:m,needsManifestRefresh:n}}}}return{segmentType:"media",chunkData:h,chunkSize:h.length,chunkInfos:e,chunkOffset:t,protectionData:m,appendWindow:f}}const{indexRange:v}=s;let y,_;if("webm"===p)y=fd(h,0);else if(g&&(y=Ls(h,Array.isArray(v)?v[0]:0),!0===e&&null!==y&&y.length>0)){const e=y[y.length-1];Array.isArray(e.range)&&(e.range[1]=1/0)}g?_=Fs(h):"webm"===p&&(_=cd(h,0));const b=r(_)?void 0:_;return{segmentType:"init",initializationData:h,initializationDataSize:h.length,protectionData:m,initTimescale:b,segmentList:null!==y&&void 0!==y?y:void 0}}}function Sd({lowLatencyMode:e,checkMediaSegmentIntegrity:t}){return!0!==t?n:Vc(n);function n(t,n,i,r,a){const{segment:o}=n,{range:s}=o,l=Hc(t,o);if(null===l)return Promise.resolve({resultType:"segment-created",resultData:null});if(o.isInit)return Kc(l,o,i,r,a);const u=jc(n.type,n.mimeType),c="mp4"===u||void 0===u;if(e&&c){if(Gc())return Zc(l,n,i,a,r);vt("DASH: Your browser does not have the fetch API. You will have a higher chance of rebuffering when playing close to the live edge")}return c?xs({url:l,responseType:"arraybuffer",headers:Array.isArray(s)?{Range:yl(s)}:null,timeout:i.timeout,connectionTimeout:i.connectionTimeout,onProgress:a.onProgress,cancelSignal:r}).then(e=>({resultType:"segment-loaded",resultData:e})):xs({url:l,responseType:"text",headers:Array.isArray(s)?{Range:yl(s)}:null,timeout:i.timeout,connectionTimeout:i.connectionTimeout,onProgress:a.onProgress,cancelSignal:r}).then(e=>({resultType:"segment-loaded",resultData:e}))}}function wd(e){const t=lo(e);return null===t?"":ko(t)}function Ad(e){if(void 0===e)throw new Error("Cannot parse subtitles: unknown format");switch(e.toLowerCase()){case"stpp":case"stpp.ttml.im1t":return"ttml";case"wvtt":return"vtt"}throw new Error("The codec used for the subtitles "+`"${e}" is not managed yet.`)}function Id(e,t){switch(t){case"application/ttml+xml":return"ttml";case"application/x-sami":case"application/smil":return"sami";case"text/vtt":return"vtt"}if(void 0!==e){const t=e.toLowerCase();if("srt"===t)return"srt"}throw new Error(`could not find a text-track parser for the type ${null!==t&&void 0!==t?t:""}`)}function xd({segment:e,language:t,codecs:n},i,r,a){if(e.isInit)return null;let o,s;null===r?a?(o=e.time,s=e.end):j.warn("Transport: Unavailable time data for current text track."):(o=r.time,void 0!==r.duration?s=o+r.duration:!a&&e.complete&&(s=o+e.duration));const l=Ad(n),u=wd(i);return{data:u,type:l,language:t,start:o,end:s}}function Rd(e,t,n){const{segment:i}=e;if(i.isInit)return null;let r,a;n?j.warn("Transport: Unavailable time data for current text track."):(r=i.time,i.complete&&(a=i.time+i.duration));const o=Id(e.codecs,e.mimeType);return{data:t,type:o,language:e.language,start:r,end:a}}function Cd(e,t,n,i,r){var a;const{segment:o}=n,{isInit:s,indexRange:l}=o;let u;if(u="string"===typeof e?Ro(e):e instanceof Uint8Array?e:new Uint8Array(e),s){const e=Ls(u,Array.isArray(l)?l[0]:0);if(!0===r&&null!==e&&e.length>0){const t=e[e.length-1];Array.isArray(t.range)&&(t.range[1]=1/0)}const t=Fs(u);return{segmentType:"init",initializationData:null,initializationDataSize:0,protectionData:[],initTimescale:t,segmentList:null!==e&&void 0!==e?e:void 0}}const c=_d(u,t,o,i),d=xd(n,u,c,t),f=null!==(a=o.timestampOffset)&&void 0!==a?a:0;return{segmentType:"media",chunkData:d,chunkSize:u.length,chunkInfos:c,chunkOffset:f,protectionData:[],appendWindow:[n.periodStart,n.periodEnd]}}function Dd(e,t,n){const{periodStart:i,periodEnd:r,segment:a}=n,{timestampOffset:o=0}=a;if(a.isInit)return{segmentType:"init",initializationData:null,initializationDataSize:0,protectionData:[],initTimescale:void 0};let s,l;if("string"!==typeof e){const t=e instanceof Uint8Array?e:new Uint8Array(e);s=ko(t),l=t.length}else s=e;const u=Rd(n,s,t);return{segmentType:"media",chunkData:u,chunkSize:l,chunkInfos:null,chunkOffset:o,protectionData:[],appendWindow:[i,r]}}function kd({__priv_patchLastSegmentInSidx:e}){return function(t,n,i){var r;const{periodStart:a,periodEnd:o,segment:s}=n,{data:l,isChunked:u}=t;if(null===l)return s.isInit?{segmentType:"init",initializationData:null,initializationDataSize:0,protectionData:[],initTimescale:void 0}:{segmentType:"media",chunkData:null,chunkSize:0,chunkInfos:null,chunkOffset:null!==(r=s.timestampOffset)&&void 0!==r?r:0,protectionData:[],appendWindow:[a,o]};const c=jc(n.type,n.mimeType);if("webm"===c)throw new Error("Text tracks with a WEBM container are not yet handled.");return"mp4"===c?Cd(l,u,n,i,e):Dd(l,u,n)}}var Md=function(e){const t=Ms({customManifestLoader:e.manifestLoader},Ld()?"text":"arraybuffer"),n=Dc(e),i=Yc(e),r=Td(e),a=Sd(e),o=kd(e);return{manifest:{loadManifest:t,parseManifest:n},audio:{loadSegment:i,parseSegment:r},video:{loadSegment:i,parseSegment:r},text:{loadSegment:a,parseSegment:o}}};function Ld(){return null!==Zt.dashParsers.wasm&&("initialized"===Zt.dashParsers.wasm.status||"initializing"===Zt.dashParsers.wasm.status)}var Pd=Md;function Nd(e){void 0===e.transports.dash&&(e.transports.dash=Pd),e.dashParsers.native=Cc,e.mainThreadMediaSourceInit=Va,e.codecSupportProber=Qa}class Od extends lr{constructor(e){super(),this._settings=e,this._initCanceller=new me}prepare(){}start(e,t){const n=this._initCanceller.signal,{keySystems:i,speed:r,url:a}=this._settings;hr(e);const o=new de(null);o.finish();const s=Aa(e,i,o,{onError:e=>this._onFatalError(e),onWarning:e=>this.trigger("warning",e),onBlackListProtectionData:F,onKeyIdsCompatibilityUpdate:F},n);ja(e,e=>this._onFatalError(e),n);const l=new Ra(t,null,r);l.addEventListener("stalled",e=>this.trigger("stalled",e)),l.addEventListener("unstalled",()=>this.trigger("unstalled",null)),l.addEventListener("warning",e=>this.trigger("warning",e)),n.register(()=>{l.destroy()}),l.start(),s.onUpdate((i,r)=>{"uninitialized"!==i.initializationState.type&&(r(),j.info("Setting URL to HTMLMediaElement",a),e.src=a,n.register(()=>{j.info("Init: Removing directfile src from media element",e.src),hr(e)}),"awaiting-media-link"===i.initializationState.type?(i.initializationState.value.isMediaLinked.setValue(!0),s.onUpdate((n,i)=>{"initialized"===n.initializationState.type&&(i(),this._seekAndPlay(e,t))},{emitCurrentValue:!0,clearSignal:n})):(he("initialized"===i.initializationState.type),this._seekAndPlay(e,t)))},{emitCurrentValue:!0,clearSignal:n})}updateContentUrls(e,t){throw new Error("Cannot update content URL of directfile contents")}dispose(){this._initCanceller.cancel()}_onFatalError(e){this._initCanceller.cancel(),this.trigger("error",e)}_seekAndPlay(e,t){const n=this._initCanceller.signal,{autoPlay:i,startAt:r}=this._settings,a=()=>{j.debug("Init: Calculating initial time");const t=Fd(e,r);return j.debug("Init: Initial time calculated:",t),t};wa({mediaElement:e,playbackObserver:t,startTime:a,mustAutoPlay:i,onWarning:e=>this.trigger("warning",e),isDirectfile:!0},n).autoPlayResult.then(()=>ba(t,e,!0,n).onUpdate((e,t)=>{e&&(t(),this.trigger("loaded",{getSegmentSinkMetrics:null}))},{emitCurrentValue:!0,clearSignal:n})).catch(e=>{n.isCancelled()||this._onFatalError(e)})}}function Fd(e,t){if(r(t))return 0;if(!r(t.position))return t.position;if(!r(t.wallClockTime))return t.wallClockTime;if(!r(t.fromFirstPosition))return t.fromFirstPosition;const n=e.duration;if("number"===typeof t.fromLastPosition)return r(n)||!isFinite(n)?(j.warn("startAt.fromLastPosition set but no known duration, beginning at 0."),0):Math.max(0,n+t.fromLastPosition);if("number"===typeof t.fromLivePosition){const i=e.seekable.length>0?e.seekable.end(0):n;return r(i)?(j.warn("startAt.fromLivePosition set but no known live position, beginning at 0."),0):Math.max(0,i+t.fromLivePosition)}if(!r(t.percentage)){if(r(n)||!isFinite(n))return j.warn("startAt.percentage set but no known duration, beginning at 0."),0;const{percentage:e}=t;if(e>=100)return n;if(e<=0)return 0;const i=+e/100;return n*i}return 0}function Ud(e,t){for(let n=0;n<e.length;n++)v&&n===t||(e[n].enabled=!1);return!(t<0||t>=e.length)&&(e[t].enabled=!0,!0)}function Bd(e,t){var n;if(t.length!==e.length)return!0;for(let i=0;i<t.length;i++)if(t[i].nativeTrack!==(null===(n=e[i])||void 0===n?void 0:n.nativeTrack))return!0;return!1}function Gd(e){var t;const n=[],i={};for(let r=0;r<e.length;r++){const a=e[r],o=""===a.language?"nolang":a.language,s=null!==(t=i[o])&&void 0!==t?t:1,l="gen_audio_"+o+"_"+s.toString();i[o]=s+1;const u={language:a.language,id:l,normalized:Ht(a.language),audioDescription:"descriptions"===a.kind||"description"===a.kind,representations:[]};n.push({track:u,nativeTrack:a})}return n}function jd(e){var t;const n=[],i={};for(let r=0;r<e.length;r++){const a=e[r],o=""===a.language?"nolang":a.language,s=null!==(t=i[o])&&void 0!==t?t:1,l="gen_text_"+o+"_"+s.toString();i[o]=s+1;const u="forced"===a.kind||void 0,c={language:a.language,forced:u,label:a.label,id:l,normalized:Ht(a.language),closedCaption:"captions"===a.kind};n.push({track:c,nativeTrack:a})}return n}function Vd(e){var t;const n=[],i={};for(let r=0;r<e.length;r++){const a=e[r],o=""===a.language?"nolang":a.language,s=null!==(t=i[o])&&void 0!==t?t:1,l="gen_video_"+o+"_"+s.toString();i[o]=s+1,n.push({track:{id:l,representations:[]},nativeTrack:a})}return n}class Hd extends a{constructor(e){var t,n,i;super(),this._nativeAudioTracks=e.audioTracks,this._nativeVideoTracks=e.videoTracks,this._nativeTextTracks=e.textTracks,this._audioTracks=void 0!==this._nativeAudioTracks?Gd(this._nativeAudioTracks):[],this._videoTracks=void 0!==this._nativeVideoTracks?Vd(this._nativeVideoTracks):[],this._textTracks=void 0!==this._nativeTextTracks?jd(this._nativeTextTracks):[],this._lastEmittedNativeAudioTrack=null===(t=this._getCurrentAudioTrack())||void 0===t?void 0:t.nativeTrack,this._lastEmittedNativeVideoTrack=null===(n=this._getCurrentVideoTrack())||void 0===n?void 0:n.nativeTrack,this._lastEmittedNativeTextTrack=null===(i=this._getCurrentTextTrack())||void 0===i?void 0:i.nativeTrack,this._handleNativeTracksCallbacks()}setAudioTrackById(e){for(let t=0;t<this._audioTracks.length;t++){const{track:n,nativeTrack:i}=this._audioTracks[t];if(n.id===e)return this._enableAudioTrackFromIndex(t),void(this._audioTrackLockedOn=i)}throw new Error("Audio track not found.")}disableTextTrack(){Kd(this._textTracks),this._textTrackLockedOn=null}setTextTrackById(e){let t=!1;for(let n=0;n<this._textTracks.length;n++){const{track:i,nativeTrack:r}=this._textTracks[n];i.id===e?(r.mode="showing",t=!0,this._textTrackLockedOn=r):"showing"!==r.mode&&"hidden"!==r.mode||(r.mode="disabled")}if(!t)throw new Error("Text track not found.")}disableVideoTrack(){Zd(this._videoTracks),this._videoTrackLockedOn=null}setVideoTrackById(e){for(let t=0;t<this._videoTracks.length;t++){const{track:n,nativeTrack:i}=this._videoTracks[t];if(n.id===e)return i.selected=!0,void(this._videoTrackLockedOn=i)}throw new Error("Video track not found.")}getChosenAudioTrack(){const e=this._getCurrentAudioTrack();return r(e)?e:e.track}getChosenTextTrack(){const e=this._getCurrentTextTrack();return r(e)?e:e.track}getChosenVideoTrack(){const e=this._getCurrentVideoTrack();return r(e)?e:e.track}getAvailableAudioTracks(){return this._audioTracks.map(({track:e,nativeTrack:t})=>{return{id:e.id,language:e.language,normalized:e.normalized,audioDescription:e.audioDescription,active:t.enabled,representations:e.representations}})}getAvailableTextTracks(){return this._textTracks.map(({track:e,nativeTrack:t})=>{return{id:e.id,label:e.label,forced:e.forced,language:e.language,normalized:e.normalized,closedCaption:e.closedCaption,active:"showing"===t.mode}})}getAvailableVideoTracks(){return this._videoTracks.map(({track:e,nativeTrack:t})=>{return{id:e.id,representations:e.representations,active:t.selected}})}dispose(){void 0!==this._nativeVideoTracks&&(this._nativeVideoTracks.onchange=null,this._nativeVideoTracks.onaddtrack=null,this._nativeVideoTracks.onremovetrack=null),void 0!==this._nativeAudioTracks&&(this._nativeAudioTracks.onchange=null,this._nativeAudioTracks.onaddtrack=null,this._nativeAudioTracks.onremovetrack=null),void 0!==this._nativeTextTracks&&(this._nativeTextTracks.onchange=null,this._nativeTextTracks.onaddtrack=null,this._nativeTextTracks.onremovetrack=null),this.removeEventListener()}_getCurrentAudioTrack(){if(void 0!==this._nativeAudioTracks){for(let e=0;e<this._audioTracks.length;e++){const t=this._audioTracks[e];if(t.nativeTrack.enabled)return t}return null}}_getCurrentVideoTrack(){if(void 0!==this._nativeVideoTracks){for(let e=0;e<this._videoTracks.length;e++){const t=this._videoTracks[e];if(t.nativeTrack.selected)return t}return null}}_getCurrentTextTrack(){if(void 0!==this._nativeTextTracks){for(let e=0;e<this._textTracks.length;e++){const t=this._textTracks[e];if("showing"===t.nativeTrack.mode)return t}return null}}_setPreviouslyLockedAudioTrack(){if(void 0!==this._audioTrackLockedOn)if(null===this._audioTrackLockedOn)for(let e=0;e<this._audioTracks.length;e++){const{nativeTrack:t}=this._audioTracks[e];t.enabled=!1}else for(let e=0;e<this._audioTracks.length;e++){const{nativeTrack:t}=this._audioTracks[e];if(t===this._audioTrackLockedOn)return void this._enableAudioTrackFromIndex(e)}}_setPreviouslyLockedTextTrack(){if(void 0!==this._textTrackLockedOn)if(null!==this._textTrackLockedOn)for(let e=0;e<this._textTracks.length;e++){const{nativeTrack:t}=this._textTracks[e];if(t===this._textTrackLockedOn)return zd(this._textTracks,t),void("showing"!==t.mode&&(t.mode="showing"))}else Kd(this._textTracks)}_setPreviouslyLockedVideoTrack(){if(void 0!==this._videoTrackLockedOn)if(null!==this._videoTrackLockedOn)for(let e=0;e<this._videoTracks.length;e++){const{nativeTrack:t}=this._videoTracks[e];if(t===this._videoTrackLockedOn)return void(t.selected=!0)}else Zd(this._videoTracks)}_handleNativeTracksCallbacks(){void 0!==this._nativeAudioTracks&&(this._nativeAudioTracks.onaddtrack=(()=>{var e,t;if(void 0!==this._nativeAudioTracks){const n=Gd(this._nativeAudioTracks);if(Bd(this._audioTracks,n)){this._audioTracks=n,this._setPreviouslyLockedAudioTrack(),this.trigger("availableAudioTracksChange",this.getAvailableAudioTracks());const i=this._getCurrentAudioTrack();(null===i||void 0===i?void 0:i.nativeTrack)!==this._lastEmittedNativeAudioTrack&&(this.trigger("audioTrackChange",null!==(e=null===i||void 0===i?void 0:i.track)&&void 0!==e?e:null),this._lastEmittedNativeAudioTrack=null!==(t=null===i||void 0===i?void 0:i.nativeTrack)&&void 0!==t?t:null)}}}),this._nativeAudioTracks.onremovetrack=(()=>{var e,t;if(void 0!==this._nativeAudioTracks){const n=Gd(this._nativeAudioTracks);if(Bd(this._audioTracks,n)){this._audioTracks=n,this.trigger("availableAudioTracksChange",this.getAvailableAudioTracks());const i=this._getCurrentAudioTrack();(null===i||void 0===i?void 0:i.nativeTrack)!==this._lastEmittedNativeAudioTrack&&(this.trigger("audioTrackChange",null!==(e=null===i||void 0===i?void 0:i.track)&&void 0!==e?e:null),this._lastEmittedNativeAudioTrack=null!==(t=null===i||void 0===i?void 0:i.nativeTrack)&&void 0!==t?t:null)}}}),this._nativeAudioTracks.onchange=(()=>{if(void 0!==this._audioTracks)for(let e=0;e<this._audioTracks.length;e++){const{track:t,nativeTrack:n}=this._audioTracks[e];if(n.enabled)return void(n!==this._lastEmittedNativeAudioTrack&&(this.trigger("audioTrackChange",t),this._lastEmittedNativeAudioTrack=n))}null!==this._lastEmittedNativeAudioTrack&&(this.trigger("audioTrackChange",null),this._lastEmittedNativeAudioTrack=null)})),void 0!==this._nativeTextTracks&&(this._nativeTextTracks.onaddtrack=(()=>{var e,t;if(void 0!==this._nativeTextTracks){const n=jd(this._nativeTextTracks);if(Bd(this._textTracks,n)){this._textTracks=n,this._setPreviouslyLockedTextTrack(),this.trigger("availableTextTracksChange",this.getAvailableTextTracks());const i=this._getCurrentTextTrack();(null===i||void 0===i?void 0:i.nativeTrack)!==this._lastEmittedNativeTextTrack&&(this.trigger("textTrackChange",null!==(e=null===i||void 0===i?void 0:i.track)&&void 0!==e?e:null),this._lastEmittedNativeTextTrack=null!==(t=null===i||void 0===i?void 0:i.nativeTrack)&&void 0!==t?t:null)}}}),this._nativeTextTracks.onremovetrack=(()=>{var e,t;if(void 0!==this._nativeTextTracks){const n=jd(this._nativeTextTracks);if(Bd(this._textTracks,n)){this._textTracks=n,this._setPreviouslyLockedTextTrack(),this.trigger("availableTextTracksChange",this.getAvailableTextTracks());const i=this._getCurrentTextTrack();(null===i||void 0===i?void 0:i.nativeTrack)!==this._lastEmittedNativeTextTrack&&(this.trigger("textTrackChange",null!==(e=null===i||void 0===i?void 0:i.track)&&void 0!==e?e:null),this._lastEmittedNativeTextTrack=null!==(t=null===i||void 0===i?void 0:i.nativeTrack)&&void 0!==t?t:null)}}}),this._nativeTextTracks.onchange=(()=>{if(void 0!==this._textTracks)for(let e=0;e<this._textTracks.length;e++){const{track:t,nativeTrack:n}=this._textTracks[e];if("showing"===n.mode)return void(n!==this._lastEmittedNativeTextTrack&&(this.trigger("textTrackChange",t),this._lastEmittedNativeTextTrack=n))}null!==this._lastEmittedNativeTextTrack&&(this.trigger("textTrackChange",null),this._lastEmittedNativeTextTrack=null)})),void 0!==this._nativeVideoTracks&&(this._nativeVideoTracks.onaddtrack=(()=>{var e,t;if(void 0!==this._nativeVideoTracks){const n=Vd(this._nativeVideoTracks);if(Bd(this._videoTracks,n)){this._videoTracks=n,this._setPreviouslyLockedVideoTrack(),this.trigger("availableVideoTracksChange",this.getAvailableVideoTracks());const i=this._getCurrentVideoTrack();(null===i||void 0===i?void 0:i.nativeTrack)!==this._lastEmittedNativeVideoTrack&&(this.trigger("videoTrackChange",null!==(e=null===i||void 0===i?void 0:i.track)&&void 0!==e?e:null),this._lastEmittedNativeVideoTrack=null!==(t=null===i||void 0===i?void 0:i.nativeTrack)&&void 0!==t?t:null)}}}),this._nativeVideoTracks.onremovetrack=(()=>{var e,t;if(void 0!==this._nativeVideoTracks){const n=Vd(this._nativeVideoTracks);if(Bd(this._videoTracks,n)){this._videoTracks=n,this._setPreviouslyLockedVideoTrack(),this.trigger("availableVideoTracksChange",this.getAvailableVideoTracks());const i=this._getCurrentVideoTrack();(null===i||void 0===i?void 0:i.nativeTrack)!==this._lastEmittedNativeVideoTrack&&(this.trigger("videoTrackChange",null!==(e=null===i||void 0===i?void 0:i.track)&&void 0!==e?e:null),this._lastEmittedNativeVideoTrack=null!==(t=null===i||void 0===i?void 0:i.nativeTrack)&&void 0!==t?t:null)}}}),this._nativeVideoTracks.onchange=(()=>{if(void 0!==this._videoTracks)for(let e=0;e<this._videoTracks.length;e++){const{track:t,nativeTrack:n}=this._videoTracks[e];if(n.selected)return void(n!==this._lastEmittedNativeVideoTrack&&(this.trigger("videoTrackChange",t),this._lastEmittedNativeVideoTrack=n))}null!==this._lastEmittedNativeVideoTrack&&(this.trigger("videoTrackChange",null),this._lastEmittedNativeVideoTrack=null)}))}_enableAudioTrackFromIndex(e){Ud(this._audioTracks.map(({nativeTrack:e})=>e),e)}}function Kd(e){for(let t=0;t<e.length;t++){const{nativeTrack:n}=e[t];n.mode="disabled"}}function zd(e,t){for(let n=0;n<e.length;n++){const{nativeTrack:i}=e[n];i===t||"showing"!==i.mode&&"hidden"!==i.mode||(i.mode="disabled")}}function Zd(e){for(let t=0;t<e.length;t++){const{nativeTrack:n}=e[t];n.selected=!1}}function qd(e){e.directfile={initDirectFile:Od,mediaElementTracksStore:Hd}}let Yd;const{WebKitMediaKeys:Wd}=o["a"];function $d(){return(p||g)&&void 0!==Yd}void 0!==Wd&&"function"===typeof Wd.isTypeSupported&&"function"===typeof Wd.prototype.createSession&&"function"===typeof HTMLMediaElement.prototype.webkitSetMediaKeys&&(Yd=Wd);class Xd{constructor(e,t,n){this._keyType=e,this._mediaKeys=t,this._configuration=n}get keySystem(){return this._keyType}createMediaKeys(){return new Promise(e=>e(this._mediaKeys))}getConfiguration(){return this._configuration}}let Qd;const{MSMediaKeys:Jd}=o["a"];function ef(e){try{const t=e();return"object"===typeof t&&null!==t&&"function"===typeof t.then?t:Promise.resolve(t)}catch(e){return Promise.reject(e)}}void 0!==Jd&&void 0!==Jd.prototype&&"function"===typeof Jd.isTypeSupported&&"function"===typeof Jd.prototype.createSession&&(Qd=Jd);class tf extends a{constructor(e){super(),this.expiration=NaN,this.keyStatuses=new Map,this._mk=e,this._sessionClosingCanceller=new me,this.closed=new Promise(e=>{this._sessionClosingCanceller.signal.register(()=>e())}),this.update=(e=>{return new Promise((t,n)=>{if(void 0===this._ss)return n("MediaKeySession not set.");try{t(this._ss.update(e,""))}catch(e){n(e)}})})}generateRequest(e,t){return new Promise(e=>{let n;n=t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer),this._ss=this._mk.createSession("video/mp4",n),Mr(this._ss,e=>{var t;this.trigger(null!==(t=e.type)&&void 0!==t?t:"message",e)},this._sessionClosingCanceller.signal),Lr(this._ss,e=>{var t;this.trigger(null!==(t=e.type)&&void 0!==t?t:"keyadded",e)},this._sessionClosingCanceller.signal),Pr(this._ss,e=>{var t;this.trigger(null!==(t=e.type)&&void 0!==t?t:"keyerror",e)},this._sessionClosingCanceller.signal),e()})}close(){return new Promise(e=>{r(this._ss)||(this._ss.close(),this._ss=void 0),this._sessionClosingCanceller.cancel(),e()})}load(){return Promise.resolve(!1)}remove(){return Promise.resolve()}get sessionId(){var e,t;return null!==(t=null===(e=this._ss)||void 0===e?void 0:e.sessionId)&&void 0!==t?t:""}}class nf{constructor(e){if(void 0===Qd)throw new Error("No MSMediaKeys API.");this._mediaKeys=new Qd(e)}_setVideo(e){return ef(()=>{this._videoElement=e,void 0!==this._videoElement.msSetMediaKeys&&this._videoElement.msSetMediaKeys(this._mediaKeys)})}createSession(){if(void 0===this._videoElement||void 0===this._mediaKeys)throw new Error("Video not attached to the MediaKeys");return new tf(this._mediaKeys)}setServerCertificate(){throw new Error("Server certificate is not implemented in your browser")}}function rf(){const e=(e,t)=>{if(void 0===Qd)throw new Error("No MSMediaKeys API.");return void 0!==t?Qd.isTypeSupported(e,t):Qd.isTypeSupported(e)},t=e=>new nf(e),n=(e,t)=>{if(null===t)return Promise.resolve(void 0);if(!(t instanceof nf))throw new Error("Custom setMediaKeys is supposed to be called with IE11 custom MediaKeys.");return t._setVideo(e)};return{isTypeSupported:e,createCustomMediaKeys:t,setMediaKeys:n}}let af;const{MozMediaKeys:of}=o["a"];function sf(){const e=(e,t)=>{if(void 0===af)throw new Error("No MozMediaKeys API.");return void 0!==t?af.isTypeSupported(e,t):af.isTypeSupported(e)},t=e=>{if(void 0===af)throw new Error("No MozMediaKeys API.");return new af(e)},n=(e,t)=>{return ef(()=>{const n=e;if(void 0===n.mozSetMediaKeys||"function"!==typeof n.mozSetMediaKeys)throw new Error("Can't set video on MozMediaKeys.");return n.mozSetMediaKeys(t)})};return{isTypeSupported:e,createCustomMediaKeys:t,setMediaKeys:n}}function lf(e){return"function"===typeof(null===e||void 0===e?void 0:e.webkitGenerateKeyRequest)}void 0!==of&&void 0!==of.prototype&&"function"===typeof of.isTypeSupported&&"function"===typeof of.prototype.createSession&&(af=of);class uf extends a{constructor(e,t){super(),this._vid=e,this._key=t,this.sessionId="",this._closeSession=F,this.keyStatuses=new Map,this.expiration=NaN;const n=e=>{this.trigger(e.type,e)};this.closed=new Promise(t=>{this._closeSession=(()=>{["keymessage","message","keyadded","ready","keyerror","error"].forEach(t=>{e.removeEventListener(t,n),e.removeEventListener(`webkit${t}`,n)}),t()})}),["keymessage","message","keyadded","ready","keyerror","error"].forEach(t=>{e.addEventListener(t,n),e.addEventListener(`webkit${t}`,n)})}update(e){return new Promise((t,n)=>{try{if(this._key.indexOf("clearkey")>=0){const n=e instanceof ArrayBuffer?new Uint8Array(e):e,i=JSON.parse(ko(n)),r=Wo(i.keys[0].k),a=Wo(i.keys[0].kid);t(this._vid.webkitAddKey(this._key,r,a,""))}else t(this._vid.webkitAddKey(this._key,e,null,""))}catch(e){n(e)}})}generateRequest(e,t){return new Promise(e=>{this._vid.webkitGenerateKeyRequest(this._key,t),e()})}close(){return new Promise(e=>{this._closeSession(),e()})}load(){return Promise.resolve(!1)}remove(){return Promise.resolve()}}class cf{constructor(e){this._keySystem=e}_setVideo(e){return ef(()=>{if(!lf(e))throw new Error("Video not attached to the MediaKeys");this._videoElement=e})}createSession(){if(r(this._videoElement))throw new Error("Video not attached to the MediaKeys");return new uf(this._videoElement,this._keySystem)}setServerCertificate(){throw new Error("Server certificate is not implemented in your browser")}}function df(){const e=function(e){let t=document.querySelector("video");return r(t)&&(t=document.createElement("video")),!r(t)&&"function"===typeof t.canPlayType&&!!t.canPlayType("video/mp4",e)},t=e=>new cf(e),n=(e,t)=>{if(null===t)return Promise.resolve(void 0);if(!(t instanceof cf))throw new Error("Custom setMediaKeys is supposed to be called with old webkit custom MediaKeys.");return t._setVideo(e)};return{isTypeSupported:e,createCustomMediaKeys:t,setMediaKeys:n}}function ff(e,t){const n=e instanceof Uint8Array?e:new Uint8Array(e),i=t instanceof Uint8Array?t:new Uint8Array(t),r=Wr(n,0);if(r+4!==n.length)throw new Error("Unsupported WebKit initData.");const a=xo(n),o=a.indexOf("skd://"),s=o>-1?a.substring(o+6):a,l=Io(s);let u=0;const c=new Uint8Array(n.byteLength+4+l.byteLength+4+i.byteLength);return c.set(n),u+=n.length,c.set(Xr(l.byteLength),u),u+=4,c.set(l,u),u+=l.byteLength,c.set(Xr(i.byteLength),u),u+=4,c.set(i,u),c}function hf(e){return ji(e,"com.apple.fps")}function pf(e,t){const n=e;return ef(()=>{if(void 0===n.webkitSetMediaKeys)throw new Error("No webKitMediaKeys API.");n.webkitSetMediaKeys(t)})}class gf extends a{constructor(e,t,n){super(),this._serverCertificate=n,this._videoElement=e,this._keyType=t,this._unbindSession=F,this._closeSession=F,this.closed=new Promise(e=>{this._closeSession=e}),this.keyStatuses=new Map,this.expiration=NaN}update(e){return new Promise((t,n)=>{if(void 0===this._nativeSession||void 0===this._nativeSession.update||"function"!==typeof this._nativeSession.update)return n("Unavailable WebKit key session.");try{let i;i=e instanceof ArrayBuffer?new Uint8Array(e):e instanceof Uint8Array?e:new Uint8Array(e.buffer),t(this._nativeSession.update(i))}catch(e){n(e)}})}generateRequest(e,t){return new Promise(e=>{var n;const i=this._videoElement;if(void 0===(null===(n=i.webkitKeys)||void 0===n?void 0:n.createSession))throw new Error("No WebKitMediaKeys API.");let r;if(hf(this._keyType)){if(void 0===this._serverCertificate)throw new Error("A server certificate is needed for creating fairplay session.");r=ff(t,this._serverCertificate)}else r=t;const a=i.webkitKeys.createSession("video/mp4",r);if(void 0===a||null===a)throw new Error("Impossible to get the key sessions");this._listenEvent(a),this._nativeSession=a,e()})}close(){return new Promise((e,t)=>{this._unbindSession(),this._closeSession(),void 0!==this._nativeSession?(this._nativeSession.close(),e()):t("No session to close.")})}load(){return Promise.resolve(!1)}remove(){return Promise.resolve()}get sessionId(){var e,t;return null!==(t=null===(e=this._nativeSession)||void 0===e?void 0:e.sessionId)&&void 0!==t?t:""}_listenEvent(e){this._unbindSession();const t=e=>{this.trigger(e.type,e)};["keymessage","message","keyadded","ready","keyerror","error"].forEach(n=>{e.addEventListener(n,t),e.addEventListener(`webkit${n}`,t)}),this._unbindSession=(()=>{["keymessage","message","keyadded","ready","keyerror","error"].forEach(n=>{e.removeEventListener(n,t),e.removeEventListener(`webkit${n}`,t)})})}}class mf{constructor(e){if(void 0===Yd)throw new Error("No WebKitMediaKeys API.");this._keyType=e,this._mediaKeys=new Yd(e)}_setVideo(e){if(this._videoElement=e,void 0===this._videoElement)throw new Error("Video not attached to the MediaKeys");return pf(this._videoElement,this._mediaKeys)}createSession(){if(void 0===this._videoElement||void 0===this._mediaKeys)throw new Error("Video not attached to the MediaKeys");return new gf(this._videoElement,this._keyType,this._serverCertificate)}setServerCertificate(e){return this._serverCertificate=e,Promise.resolve()}}function vf(){if(void 0===Yd)throw new Error("No WebKitMediaKeys API.");const e=Yd.isTypeSupported,t=e=>new mf(e),n=(e,t)=>{if(null===t)return pf(e,t);if(!(t instanceof mf))throw new Error("Custom setMediaKeys is supposed to be called with webkit custom MediaKeys.");return t._setVideo(e)};return{isTypeSupported:e,createCustomMediaKeys:t,setMediaKeys:n}}const yf=bf("auto");var _f=yf;function bf(e){var t;let n,i,a,l=Ef;if("standard"!==e&&("auto"!==e||$d())||!s["a"]&&r(navigator.requestMediaKeySystemAccess)){let s,u;if("webkit"===e&&void 0!==Yd){i=Er(["needkey"]);const e=vf();s=e.isTypeSupported,u=e.createCustomMediaKeys,l=e.setMediaKeys,a="webkit"}else if(lf(null===(t=o["a"].HTMLVideoElement)||void 0===t?void 0:t.prototype)){i=Er(["needkey"]);const e=df();s=e.isTypeSupported,u=e.createCustomMediaKeys,l=e.setMediaKeys,a="older-webkit"}else if(void 0!==Yd){i=Er(["needkey"]);const e=vf();s=e.isTypeSupported,u=e.createCustomMediaKeys,l=e.setMediaKeys,a="webkit"}else if(d&&void 0!==Qd){i=Er(["encrypted","needkey"]);const e=rf();s=e.isTypeSupported,u=e.createCustomMediaKeys,l=e.setMediaKeys,a="ms"}else if(void 0!==af){i=Er(["encrypted","needkey"]);const e=sf();s=e.isTypeSupported,u=e.createCustomMediaKeys,l=e.setMediaKeys,a="moz"}else{i=Er(["encrypted","needkey"]);const e=o["a"].MediaKeys,t=()=>{if(void 0===e)throw new ut("MEDIA_KEYS_NOT_SUPPORTED","No `MediaKeys` implementation found in the current browser.");if("undefined"===typeof e.isTypeSupported){const e="This browser seems to be unable to play encrypted contents currently.Note: Some browsers do not allow decryption in some situations, like when not using HTTPS.";throw new Error(e)}};s=(n=>{return t(),he("function"===typeof e.isTypeSupported),e.isTypeSupported(n)}),u=(n=>{return t(),new e(n)}),a="unknown"}n=function(e,t){if(!s(e))return Promise.reject(new Error("Unsupported key type"));for(let n=0;n<t.length;n++){const i=t[n],{videoCapabilities:a,audioCapabilities:o,initDataTypes:s,distinctiveIdentifier:l}=i;let c=!0;if(c=c&&(r(s)||s.some(e=>"cenc"===e)),c=c&&"required"!==l,c){const t={initDataTypes:["cenc"],distinctiveIdentifier:"not-allowed",persistentState:"required",sessionTypes:["temporary","persistent-license"]};void 0!==a&&(t.videoCapabilities=a),void 0!==o&&(t.audioCapabilities=o);const n=u(e);return Promise.resolve(new Xd(e,n,t))}}return Promise.reject(new Error("Unsupported configuration"))}}else n=((...e)=>navigator.requestMediaKeySystemAccess(...e)),i=Er(["encrypted"]),a="standard";return{requestMediaKeySystemAccess:n,onEncrypted:i,setMediaKeys:l,implementation:a}}function Ef(e,t){try{let n;const i=e;return"function"===typeof i.setMediaKeys?n=i.setMediaKeys(t):"function"===typeof i.webkitSetMediaKeys?n=i.webkitSetMediaKeys(t):"function"===typeof i.mozSetMediaKeys?n=i.mozSetMediaKeys(t):"function"===typeof i.msSetMediaKeys&&null!==t&&(n=i.msSetMediaKeys(t)),"object"===typeof n&&null!==n&&"function"===typeof n.then?n:Promise.resolve(n)}catch(e){return Promise.reject(e)}}var Tf=_f;const Sf=Hr(Ro("pssh"),0);function wf(e){const t=[];let n=0;while(n<e.length){if(e.length<n+8||Hr(e,n+4)!==Sf)return j.warn("Compat: Unrecognized initialization data. Use as is."),[{systemId:void 0,data:e}];const i=Hr(new Uint8Array(e),n);if(n+i>e.length)return j.warn("Compat: Unrecognized initialization data. Use as is."),[{systemId:void 0,data:e}];const r=e.subarray(n,n+i),a=Jc(r,8),o={systemId:a,data:r};Af(t,o)?j.warn("Compat: Duplicated PSSH found in initialization data, removing it."):t.push(o),n+=i}return n!==e.length?(j.warn("Compat: Unrecognized initialization data. Use as is."),[{systemId:void 0,data:e}]):t}function Af(e,t){for(let n=0;n<e.length;n++){const i=e[n];if((void 0===t.systemId||void 0===i.systemId||t.systemId===i.systemId)&&yt(t.data,i.data))return!0}return!1}function If(e){const{initData:t,initDataType:n}=e;if(r(t))return j.warn("Compat: No init data found on media encrypted event."),null;const i=new Uint8Array(t),a=wf(i);return{type:n,values:a}}function xf(){return y}function Rf(e,t,n){const i=e.setMediaKeys(t,n).then(()=>{j.info("Compat: MediaKeys updated with success")}).catch(e=>{if(null!==n)throw j.error("Compat: Could not update MediaKeys",e instanceof Error?e:"Unknown Error"),e;j.error("Compat: Could not reset MediaKeys",e instanceof Error?e:"Unknown Error")});return xf()?i:Promise.race([i,Di(1e3)])}function Cf(e){var t;const n=or.getState(e);return or.setState(e,null),Rf(null!==(t=null===n||void 0===n?void 0:n.emeImplementation)&&void 0!==t?t:Tf,e,null)}async function Df(e,{emeImplementation:t,keySystemOptions:n,loadedSessionsStore:i,mediaKeySystemAccess:r,mediaKeys:a},o){const s=or.getState(e),l=null!==s&&s.loadedSessionsStore!==i?s.loadedSessionsStore.closeAllSessions():Promise.resolve();if(await l,o.isCancelled())throw o.cancellationError;if(or.setState(e,{emeImplementation:t,keySystemOptions:n,mediaKeySystemAccess:r,mediaKeys:a,loadedSessionsStore:i}),e.mediaKeys!==a)return j.info("DRM: Attaching MediaKeys to the media element"),Rf(t,e,a).then(()=>{j.info("DRM: MediaKeys attached with success")}).catch(e=>{const t=e instanceof Error?e.toString():"Unknown Error";throw new lt("MEDIA_KEYS_ATTACHMENT_ERROR","Could not attach the MediaKeys to the media element: "+t)})}function kf(e){if(""===e.sessionId)return!1;const t=e.keyStatuses,n=[];return t.forEach(e=>{n.push(e)}),n.length<=0?(j.debug("DRM: isSessionUsable: MediaKeySession given has an empty keyStatuses",e.sessionId),!1):gt(n,"expired")?(j.debug("DRM: isSessionUsable: MediaKeySession given has an expired key",e.sessionId),!1):gt(n,"internal-error")?(j.debug("DRM: isSessionUsable: MediaKeySession given has a key with an internal-error",e.sessionId),!1):(j.debug("DRM: isSessionUsable: MediaKeySession is usable",e.sessionId),!0)}function Mf(e,t,n,i){const{loadedSessionsStore:r,persistentSessionsStore:a}=e;return"temporary"===n?Lf(r,t):null===a?(j.warn("DRM: Cannot create persistent MediaKeySession, PersistentSessionsStore not created."),Lf(r,t)):Pf(r,a,t,i)}function Lf(e,t){j.info("DRM: Creating a new temporary session");const n=e.createSession(t,"temporary");return Promise.resolve({type:"created-session",value:n})}async function Pf(e,t,n,i){if(null!==i.cancellationError)throw i.cancellationError;j.info("DRM: Creating persistent MediaKeySession");const r=e.createSession(n,"persistent-license"),a=t.getAndReuse(n);if(null===a)return{type:"created-session",value:r};try{const i=await e.loadPersistentSession(r.mediaKeySession,a.sessionId);if(!i){j.warn("DRM: No data stored for the loaded session"),t.delete(a.sessionId),e.removeSessionWithoutClosingIt(r.mediaKeySession);const i=e.createSession(n,"persistent-license");return{type:"created-session",value:i}}return i&&kf(r.mediaKeySession)?(t.add(n,n.keyIds,r.mediaKeySession),j.info("DRM: Succeeded to load persistent session."),{type:"loaded-persistent-session",value:r}):(j.warn("DRM: Previous persistent session not usable anymore."),o())}catch(e){return j.warn("DRM: Unable to load persistent session: "+(e instanceof Error?e.toString():"Unknown Error")),o()}async function o(){if(null!==i.cancellationError)throw i.cancellationError;j.info("DRM: Removing previous persistent session.");const a=t.get(n);null!==a&&t.delete(a.sessionId);try{await e.closeSession(r.mediaKeySession)}catch(t){if(""!==r.mediaKeySession.sessionId)throw t;e.removeSessionWithoutClosingIt(r.mediaKeySession)}if(null!==i.cancellationError)throw i.cancellationError;const o=e.createSession(n,"persistent-license");return{type:"created-session",value:o}}}async function Nf(e,t){if(t<0||t>=e.getLength())return;j.info("DRM: LSS cache limit exceeded",t,e.getLength());const n=[],i=e.getAll().slice(),r=i.length-t;for(let a=0;a<r;a++){const t=i[a];n.push(e.closeSession(t.mediaKeySession))}await Promise.all(n)}async function Of(e,t,n,i,r){let a=null;const{loadedSessionsStore:o,persistentSessionsStore:s}=t,l=o.reuse(e);if(null!==l){if(a=l.mediaKeySession,kf(a))return j.info("DRM: Reuse loaded session",a.sessionId),{type:"loaded-open-session",value:{mediaKeySession:a,sessionType:l.sessionType,keySessionRecord:l.keySessionRecord}};null!==s&&""!==l.mediaKeySession.sessionId&&s.delete(l.mediaKeySession.sessionId)}if(null!==a&&(await o.closeSession(a),null!==r.cancellationError))throw r.cancellationError;if(await Nf(o,i),null!==r.cancellationError)throw r.cancellationError;const u=await Mf(t,e,n,r);return{type:u.type,value:{mediaKeySession:u.value.mediaKeySession,sessionType:u.value.sessionType,keySessionRecord:u.value.keySessionRecord}}}function Ff(){return!y&&!E}function Uf(e){return!c||-1===e.indexOf("playready")}const Bf='<WRMHEADER xmlns="http://schemas.microsoft.com/DRM/2007/03/PlayReadyHeader" version="4.0.0.0"><DATA><PROTECTINFO><KEYLEN>16</KEYLEN><ALGID>AESCTR</ALGID></PROTECTINFO><KID>ckB07BNLskeUq0qd83fTbA==</KID><DS_ID>yYIPDBca1kmMfL60IsfgAQ==</DS_ID><CUSTOMATTRIBUTES xmlns=""><encryptionref>312_4024_2018127108</encryptionref></CUSTOMATTRIBUTES><CHECKSUM>U/tsUYRgMzw=</CHECKSUM></DATA></WRMHEADER>';function Gf(e){const t=Io(e),n=$r(t.length),i=new Uint8Array([1,0]),r=new Uint8Array([1,0]),a=Xr(t.length+6),o=Gr(a,r,i,n,t),s=Mo("9a04f07998404286ab92e65be0885f95");return jf(o,s)}function jf(e,t){const n=Ro("pssh"),i=new Uint8Array([0,0,0,0]),r=Zr(e.length),a=Zr(32+e.length);return Gr(a,n,i,t,r,e)}function Vf(){return d}function Hf(e,t,n){const i=t.getConfiguration();if(Vf()||r(i))return null;const a=e.filter(e=>{return e.type===n.type&&(!!(r(e.persistentLicenseConfig)&&"required"!==e.persistentState||"required"===i.persistentState)&&("required"!==e.distinctiveIdentifier||"required"===i.distinctiveIdentifier))})[0];return void 0!==a?{keySystemOptions:a,keySystemAccess:t}:null}function Kf(e){const{EME_KEY_SYSTEMS:t}=O.getCurrent();for(const n of Object.keys(t))if(gt(t[n],e))return n}function zf(e){const{keyName:t,keyType:n,keySystemOptions:i}=e,a=["temporary"];let o="optional",s="optional";r(i.persistentLicenseConfig)||(o="required",a.push("persistent-license")),r(i.persistentState)||(o=i.persistentState),r(i.distinctiveIdentifier)||(s=i.distinctiveIdentifier);const{EME_DEFAULT_AUDIO_CODECS:l,EME_DEFAULT_VIDEO_CODECS:u,EME_DEFAULT_WIDEVINE_ROBUSTNESSES:c,EME_DEFAULT_PLAYREADY_RECOMMENDATION_ROBUSTNESSES:d}=O.getCurrent();let f,h;const{audioCapabilitiesConfig:p,videoCapabilitiesConfig:g}=i;if("full"===(null===p||void 0===p?void 0:p.type))f=p.value;else{let e;e="robustness"===(null===p||void 0===p?void 0:p.type)?p.value:"widevine"===t?c:"com.microsoft.playready.recommendation"===n?d:[],0===e.length&&e.push(void 0);const i="contentType"===(null===p||void 0===p?void 0:p.type)?p.value:l;f=Hl(e,e=>i.map(t=>{return void 0!==e?{contentType:t,robustness:e}:{contentType:t}}))}if("full"===(null===g||void 0===g?void 0:g.type))h=g.value;else{let e;e="robustness"===(null===g||void 0===g?void 0:g.type)?g.value:"widevine"===t?c:"com.microsoft.playready.recommendation"===n?d:[],0===e.length&&e.push(void 0);const i="contentType"===(null===g||void 0===g?void 0:g.type)?g.value:u;h=Hl(e,e=>i.map(t=>{return void 0!==e?{contentType:t,robustness:e}:{contentType:t}}))}const m={initDataTypes:["cenc"],videoCapabilities:h,audioCapabilities:f,distinctiveIdentifier:s,persistentState:o,sessionTypes:a};return[m,Object.assign(Object.assign({},m),{audioCapabilities:void 0,videoCapabilities:void 0})]}function Zf(e,t,n){j.info("DRM: Searching for compatible MediaKeySystemAccess");const i=or.getState(e);if(null!==i&&Tf.implementation===i.emeImplementation.implementation){const e=Hf(t,i.mediaKeySystemAccess,i.keySystemOptions);if(null!==e)return j.info("DRM: Found cached compatible keySystem"),Promise.resolve({type:"reuse-media-key-system-access",value:{mediaKeySystemAccess:e.keySystemAccess,options:e.keySystemOptions}})}const a=t.reduce((e,t)=>{const{EME_KEY_SYSTEMS:n}=O.getCurrent(),i=n[t.type];let a;if(r(i)){const e=Kf(t.type),n=t.type;a=[{keyName:e,keyType:n,keySystemOptions:t}]}else a=i.map(e=>{const n=t.type;return{keyName:n,keyType:e,keySystemOptions:t}});return e.concat(a)},[]);return o(0);async function o(e){if(e>=a.length)throw new lt("INCOMPATIBLE_KEYSYSTEMS","No key system compatible with your wanted configuration has been found in the current browser.");if(r(Tf.requestMediaKeySystemAccess))throw new Error("requestMediaKeySystemAccess is not implemented in your browser.");const t=a[e],{keyType:i,keySystemOptions:s}=t,l=zf(t);j.debug(`DRM: Request keysystem access ${i},`+`${e+1} of ${a.length}`);try{const t=await qf(i,l);return j.info("DRM: Found compatible keysystem",i,e+1),{type:"create-media-key-system-access",value:{options:s,mediaKeySystemAccess:t}}}catch(t){if(j.debug("DRM: Rejected access to keysystem",i,e+1),null!==n.cancellationError)throw n.cancellationError;return o(e+1)}}}async function qf(e,t){const n=await Tf.requestMediaKeySystemAccess(e,t);if(!Uf(e))try{const e=await n.createMediaKeys(),t=e.createSession(),i=Gf(Bf);await t.generateRequest("cenc",i)}catch(e){throw j.debug("DRM: KeySystemAccess was granted but it is not usable"),e}return n}function Yf(e){j.info("Compat: Trying to move CENC PSSH from init data at the end of it.");let t=!1,n=new Uint8Array,i=new Uint8Array,r=0;while(r<e.length){if(e.length<r+8||Hr(e,r+4)!==Sf)throw j.warn("Compat: unrecognized initialization data. Cannot patch it."),new Error("Compat: unrecognized initialization data. Cannot patch it.");const a=Hr(new Uint8Array(e),r);if(r+a>e.length)throw j.warn("Compat: unrecognized initialization data. Cannot patch it."),new Error("Compat: unrecognized initialization data. Cannot patch it.");const o=e.subarray(r,r+a);if(16===e[r+12]&&119===e[r+13]&&239===e[r+14]&&236===e[r+15]&&192===e[r+16]&&178===e[r+17]&&77===e[r+18]&&2===e[r+19]&&172===e[r+20]&&227===e[r+21]&&60===e[r+22]&&30===e[r+23]&&82===e[r+24]&&226===e[r+25]&&251===e[r+26]&&75===e[r+27]){const e=ao(o),i=null===e?void 0:o[e[1]];j.info("Compat: CENC PSSH found with version",i),void 0===i?j.warn("Compat: could not read version of CENC PSSH"):t===(1===i)?n=Gr(n,o):1===i?(j.warn("Compat: cenc version 1 encountered, removing every other cenc pssh box."),n=o,t=!0):j.warn("Compat: filtering out cenc pssh box with wrong version",i)}else i=Gr(i,o);r+=a}if(r!==e.length)throw j.warn("Compat: unrecognized initialization data. Cannot patch it."),new Error("Compat: unrecognized initialization data. Cannot patch it.");return Gr(i,n)}function Wf(e,t,n){let i;j.debug("Compat: Calling generateRequest on the MediaKeySession");try{i=Yf(n)}catch(e){i=n}const r=null!==t&&void 0!==t?t:"";return e.generateRequest(r,i).catch(t=>{if(""!==r||!(t instanceof TypeError))throw t;return j.warn('Compat: error while calling `generateRequest` with an empty initialization data type. Retrying with a default "cenc" value.',t),e.generateRequest("cenc",i)})}const $f=100;async function Xf(e,t){j.info("DRM: Load persisted session",t);const n=await e.load(t);return!n||e.keyStatuses.size>0?n:new Promise(t=>{e.addEventListener("keystatuseschange",r);const i=setTimeout(r,$f);function r(){a(),t(n)}function a(){clearTimeout(i),e.removeEventListener("keystatuseschange",r)}})}function Qf(e){const t=new me;return Promise.race([e.close().then(()=>{t.cancel()}),e.closed.then(()=>{t.cancel()}),n()]);async function n(){try{await cn(1e3,t.signal),await i()}catch(e){if(e instanceof ye)return;const t=e instanceof Error?e.message:"Unknown error made it impossible to close the session";j.error(`DRM: ${t}`)}}async function i(){try{await e.update(new Uint8Array(1))}catch(e){if(t.isUsed())return;if(e instanceof Error&&"The session is already closed."===e.message)return;await cn(1e3,t.signal)}if(!t.isUsed())throw new Error("Compat: Couldn't know if session is closed")}}function Jf(e,t){for(const n of e){const e=t.some(e=>yt(e,n));if(!e)return!1}return!0}function eh(e,t){for(const n of e){const e=t.some(e=>yt(e,n));if(e)return!0}return!1}class th{constructor(e){this._initializationData=e,this._keyIds=null}associateKeyIds(e){null===this._keyIds&&(this._keyIds=[]);const t=Array.from(e);for(const n of t)this.isAssociatedWithKeyId(n)||this._keyIds.push(n)}isAssociatedWithKeyId(e){if(null===this._keyIds)return!1;for(const t of this._keyIds)if(yt(t,e))return!0;return!1}getAssociatedKeyIds(){return null===this._keyIds?[]:this._keyIds}isCompatibleWith(e){const{keyIds:t}=e;if(void 0!==t&&t.length>0){if(null!==this._keyIds&&Jf(t,this._keyIds))return!0;if(void 0!==this._initializationData.keyIds)return Jf(t,this._initializationData.keyIds)}return this._checkInitializationDataCompatibility(e)}_checkInitializationDataCompatibility(e){return void 0!==e.keyIds&&e.keyIds.length>0&&void 0!==this._initializationData.keyIds?Jf(e.keyIds,this._initializationData.keyIds):this._initializationData.type===e.type&&this._initializationData.values.isCompatibleWith(e.values)}}class nh{constructor(e){this._mediaKeys=e,this._storage=[]}createSession(e,t){const n=new th(e);j.debug("DRM-LSS: calling `createSession`",t);const i=this._mediaKeys.createSession(t),a={mediaKeySession:i,sessionType:t,keySessionRecord:n,isGeneratingRequest:!1,isLoadingPersistentSession:!1,closingStatus:{type:"none"}};return r(i.closed)||i.closed.then(()=>{j.info("DRM-LSS: session was closed, removing it.",i.sessionId);const e=this.getIndex(n);e>=0&&this._storage[e].mediaKeySession===i&&this._storage.splice(e,1)}).catch(e=>{j.warn(`DRM-LSS: MediaKeySession.closed rejected: ${e}`)}),this._storage.push(Object.assign({},a)),j.debug("DRM-LSS: MediaKeySession added",a.sessionType,this._storage.length),a}reuse(e){for(let t=this._storage.length-1;t>=0;t--){const n=this._storage[t];if(n.keySessionRecord.isCompatibleWith(e))return this._storage.splice(t,1),this._storage.push(n),j.debug("DRM-LSS: Reusing session:",n.mediaKeySession.sessionId,n.sessionType),Object.assign({},n)}return null}getEntryForSession(e){for(let t=this._storage.length-1;t>=0;t--){const n=this._storage[t];if(n.mediaKeySession===e)return Object.assign({},n)}return null}async generateLicenseRequest(e,t,n){let i;for(const r of this._storage)if(r.mediaKeySession===e){i=r;break}if(void 0===i)return j.error("DRM-LSS: generateRequest error. No MediaKeySession found with the given initData and initDataType"),Wf(e,t,n);if(i.isGeneratingRequest=!0,"none"!==i.closingStatus.type)throw new Error("The `MediaKeySession` is being closed.");try{await Wf(e,t,n)}catch(e){if(void 0===i)throw e;throw i.isGeneratingRequest=!1,"awaiting"===i.closingStatus.type&&i.closingStatus.start(),e}void 0!==i&&(i.isGeneratingRequest=!1,"awaiting"===i.closingStatus.type&&i.closingStatus.start())}async loadPersistentSession(e,t){let n,i;for(const r of this._storage)if(r.mediaKeySession===e){n=r;break}if(void 0===n)return j.error("DRM-LSS: loadPersistentSession error. No MediaKeySession found with the given initData and initDataType"),Xf(e,t);if(n.isLoadingPersistentSession=!0,"none"!==n.closingStatus.type)throw new Error("The `MediaKeySession` is being closed.");try{i=await Xf(e,t)}catch(e){if(void 0===n)throw e;throw n.isLoadingPersistentSession=!1,"awaiting"===n.closingStatus.type&&n.closingStatus.start(),e}return void 0===n?i:(n.isLoadingPersistentSession=!1,"awaiting"===n.closingStatus.type&&n.closingStatus.start(),i)}async closeSession(e){let t;for(const n of this._storage)if(n.mediaKeySession===e){t=n;break}return void 0===t?(j.warn("DRM-LSS: No MediaKeySession found with the given initData and initDataType"),Promise.resolve(!1)):this._closeEntry(t)}getLength(){return this._storage.length}getAll(){return this._storage}async closeAllSessions(){const e=this._storage;j.debug("DRM-LSS: Closing all current MediaKeySessions",e.length),this._storage=[];const t=e.map(e=>this._closeEntry(e));await Promise.all(t)}removeSessionWithoutClosingIt(e){he(""===e.sessionId,"Initialized `MediaKeySession`s should always be properly closed");for(let t=this._storage.length-1;t>=0;t--){const n=this._storage[t];if(n.mediaKeySession===e)return j.debug("DRM-LSS: Removing session without closing it",e.sessionId),this._storage.splice(t,1),!0}return!1}getIndex(e){for(let t=0;t<this._storage.length;t++){const n=this._storage[t];if(n.keySessionRecord===e)return t}return-1}async _closeEntry(e){const{mediaKeySession:t}=e;return new Promise((n,i)=>{function r(){void 0!==e&&(e.closingStatus={type:"pending"}),ih(t).then(()=>{void 0!==e&&(e.closingStatus={type:"done"}),n(!0)}).catch(t=>{void 0!==e&&(e.closingStatus={type:"failed"}),i(t)})}void 0!==e&&(e.isLoadingPersistentSession||e.isGeneratingRequest)?e.closingStatus={type:"awaiting",start:r}:r()})}}async function ih(e){j.debug("DRM: Trying to close a MediaKeySession",e.sessionId);try{return await Qf(e),void j.debug("DRM: Succeeded to close MediaKeySession")}catch(e){return void j.error("DRM: Could not close MediaKeySession: "+(e instanceof Error?e.toString():"Unknown error"))}}function rh(e){let t,n=0;for(let i=0;i<e.length;i++)t=e[i],n=(n<<5)-n+t,n&=n;return n}class ah{constructor(e){this.initData=e}toJSON(){return Yo(this.initData)}static decode(e){return Wo(e)}}function oh(e,t){var n,i;return null!==(i=null!==(n=sh(e,t))&&void 0!==n?n:sh(t,e))&&void 0!==i&&i}function sh(e,t){if(0===e.length)return!1;if(t.length<e.length)return null;const n=e[0];let i=0,r=0;for(;r<t.length;r++){const a=t[r];if(a.systemId!==n.systemId)continue;if(a.hash!==n.hash)return!1;let o,s;if(o=n.data instanceof Uint8Array?n.data:"string"===typeof n.data?ah.decode(n.data):n.data.initData,s=a.data instanceof Uint8Array?a.data:"string"===typeof a.data?ah.decode(a.data):a.data.initData,!yt(o,s))return!1;if(t.length-r<e.length)return null;for(i=1;i<e.length;i++){const n=e[i];for(r+=1;r<t.length;r++){const e=t[r];if(n.systemId!==e.systemId)continue;if(n.hash!==e.hash)return!1;let i,a;if(i=n.data instanceof Uint8Array?n.data:"string"===typeof n.data?ah.decode(n.data):n.data.initData,a=e.data instanceof Uint8Array?e.data:"string"===typeof e.data?ah.decode(e.data):e.data.initData,!yt(i,a))return!1;break}if(i===t.length)return null}return!0}return null}function lh(e){pe(e,{save:"function",load:"function"},"persistentLicenseConfig")}class uh{constructor(e){lh(e),this._entries=[],this._storage=e;try{let e=this._storage.load();Array.isArray(e)||(e=[]),this._entries=e}catch(e){j.warn("DRM-PSS: Could not get entries from license storage",e instanceof Error?e:""),this.dispose()}}getLength(){return this._entries.length}getAll(){return this._entries}get(e){const t=this._getIndex(e);return-1===t?null:this._entries[t]}getAndReuse(e){const t=this._getIndex(e);if(-1===t)return null;const n=this._entries.splice(t,1)[0];return this._entries.push(n),n}add(e,t,n){var i;if(r(n)||!Nt(n.sessionId))return void j.warn("DRM-PSS: Invalid Persisten Session given.");const{sessionId:a}=n,o=this._getIndex(e);if(o>=0){const e=void 0===t?3:4,n=this._entries[o],r=null!==(i=n.version)&&void 0!==i?i:-1;if(r>=e&&a===n.sessionId)return;j.info("DRM-PSS: Updating session info.",a),this._entries.splice(o,1)}else j.info("DRM-PSS: Add new session",a);const s=ch(e.values.getFormattedValues());void 0===t?this._entries.push({version:3,sessionId:a,values:s,initDataType:e.type}):this._entries.push({version:4,sessionId:a,keyIds:t.map(e=>new ah(e)),values:s,initDataType:e.type}),this._save()}delete(e){let t=-1;for(let i=0;i<this._entries.length;i++){const n=this._entries[i];if(n.sessionId===e){t=i;break}}if(-1===t)return void j.warn("DRM-PSS: initData to delete not found.");const n=this._entries[t];j.warn("DRM-PSS: Delete session from store",n.sessionId),this._entries.splice(t,1),this._save()}deleteOldSessions(e){j.info(`DRM-PSS: Deleting last ${e} sessions.`),e<=0||(e<=this._entries.length?this._entries.splice(0,e):(j.warn("DRM-PSS: Asked to remove more information that it contains",e,this._entries.length),this._entries=[]),this._save())}dispose(){this._entries=[],this._save()}_getIndex(e){let t=null;function n(){if(null===t){const n=e.values.constructRequestData();t={initData:n,initDataHash:rh(n)}}return t}for(let i=0;i<this._entries.length;i++){const t=this._entries[i];if(t.initDataType===e.type)switch(t.version){case 4:if(void 0!==e.keyIds){const n=e.keyIds.every(e=>{const n=Yo(e);for(const i of t.keyIds)if("string"===typeof i){if(n===i)return!0}else if(yt(i.initData,e))return!0;return!1});if(n)return i}else{const n=e.values.getFormattedValues();if(oh(n,t.values))return i}break;case 3:const r=e.values.getFormattedValues();if(oh(r,t.values))return i;break;case 2:{const{initData:e,initDataHash:r}=n();if(t.initDataHash===r)try{const n="string"===typeof t.initData?ah.decode(t.initData):t.initData.initData;if(yt(n,e))return i}catch(e){j.warn("DRM-PSS: Could not decode initialization data.",e instanceof Error?e:"")}break}case 1:{const{initData:e,initDataHash:r}=n();if(t.initDataHash===r){if("undefined"===typeof t.initData.length)return i;if(yt(t.initData,e))return i}break}default:{const{initDataHash:e}=n();if(t.initData===e)return i}}}return-1}_save(){try{this._storage.save(this._entries)}catch(e){const t=e instanceof Error?e:void 0;j.warn("DRM-PSS: Could not save MediaKeySession information",t)}}}function ch(e){return e.map(({systemId:e,data:t,hash:n})=>({systemId:e,hash:n,data:new ah(t)}))}const dh=new WeakMap;var fh={prepare(e){dh.set(e,null)},set(e,t){const n=t instanceof Uint8Array?t:new Uint8Array(t instanceof ArrayBuffer?t:t.buffer),i=rh(n);dh.set(e,{hash:i,serverCertificate:n})},hasOne(e){const t=dh.get(e);return void 0!==t&&(null!==t||void 0)},has(e,t){const n=dh.get(e);if(void 0===n||null===n)return!1;const{hash:i,serverCertificate:r}=n,a=t instanceof Uint8Array?t:new Uint8Array(t instanceof ArrayBuffer?t:t.buffer),o=rh(a);if(o!==i||r.length!==a.length)return!1;for(let s=0;s<r.length;s++)if(r[s]!==a[s])return!1;return!0}};function hh(e){const{persistentLicenseConfig:t}=e;return r(t)?null:(j.debug("DRM: Set the given license storage"),new uh(t))}async function ph(e,t,n){const i=await Zf(e,t,n);if(null!==n.cancellationError)throw n.cancellationError;const{options:a,mediaKeySystemAccess:o}=i.value,s=or.getState(e),l=hh(a);if(Ff()&&null!==s&&"reuse-media-key-system-access"===i.type){const{mediaKeys:e,loadedSessionsStore:t}=s;if(!1===fh.hasOne(e)||!r(a.serverCertificate)&&fh.has(e,a.serverCertificate))return{mediaKeys:e,mediaKeySystemAccess:o,stores:{loadedSessionsStore:t,persistentSessionsStore:l},options:a}}const u=await gh(o);j.info("DRM: MediaKeys created with success");const c=new nh(u);return{mediaKeys:u,mediaKeySystemAccess:o,stores:{loadedSessionsStore:c,persistentSessionsStore:l},options:a}}async function gh(e){j.info("DRM: Calling createMediaKeys on the MediaKeySystemAccess");try{const t=await e.createMediaKeys();return t}catch(e){const t=e instanceof Error?e.message:"Unknown error when creating MediaKeys.";throw new lt("CREATE_MEDIA_KEYS_ERROR",t)}}async function mh(e,t,n){const i=await ph(e,t,n),{mediaKeys:r}=i,a=null!==e.mediaKeys&&void 0!==e.mediaKeys&&r!==e.mediaKeys;return a&&(j.debug("DRM: Disabling old MediaKeys"),await Cf(e)),i}function vh(e,t,n){const{baseDelay:i,maxDelay:a,totalRetry:o,shouldRetry:s,onRetry:l}=t;let u=0;return c();async function c(){if(null!==n.cancellationError)throw n.cancellationError;try{const t=await e();return t}catch(e){if(null!==n.cancellationError)throw n.cancellationError;if(!r(s)&&!s(e)||u++>=o)throw e;"function"===typeof l&&l(e,u);const t=yh(i,u,a);await Di(t);const d=c();return d}}}function yh(e,t,n){const i=e*Math.pow(2,t-1),r=fn(i);return Math.min(r,n)}function _h(e,t){return-1!==e.indexOf("playready")&&(f||c)?Po(t):t}class bh extends Error{constructor(e){super(e.message),Object.setPrototypeOf(this,bh.prototype),this.reason=e}}const Eh={EXPIRED:"expired",INTERNAL_ERROR:"internal-error",OUTPUT_RESTRICTED:"output-restricted"};function Th(e,t,n){const{onKeyInternalError:i,onKeyOutputRestricted:r,onKeyExpiration:a}=t,o=[],s=[],l=[];let u;return e.keyStatuses.forEach((e,t)=>{const[u,c]=(()=>{return"string"===typeof e?[e,t]:[t,e]})(),d=_h(n,new Uint8Array(c)),f={keyId:d.buffer,keyStatus:u};switch(j.hasLevel("DEBUG")&&j.debug(`DRM: key status update (${Lo(d)}): ${u}`),u){case Eh.EXPIRED:{const e=new lt("KEY_STATUS_CHANGE_ERROR",`A decryption key expired (${Lo(d)})`,{keyStatuses:[f,...l]});if("error"===a||void 0===a)throw e;switch(a){case"close-session":throw new bh(e);case"fallback":o.push(d);break;default:"continue"===a||void 0===a?s.push(d):ge(a);break}l.push(f);break}case Eh.INTERNAL_ERROR:{const e=new lt("KEY_STATUS_CHANGE_ERROR",`A "${u}" status has been encountered (${Lo(d)})`,{keyStatuses:[f,...l]});switch(i){case void 0:case"error":throw e;case"close-session":throw new bh(e);case"fallback":o.push(d);break;case"continue":s.push(d);break;default:if(void 0===i)throw e;ge(i)}l.push(f);break}case Eh.OUTPUT_RESTRICTED:{const e=new lt("KEY_STATUS_CHANGE_ERROR",`A "${u}" status has been encountered (${Lo(d)})`,{keyStatuses:[f,...l]});switch(r){case void 0:case"error":throw e;case"fallback":o.push(d);break;case"continue":s.push(d);break;default:if(void 0===r)throw e;ge(r)}l.push(f);break}default:s.push(d);break}}),l.length>0&&(u=new lt("KEY_STATUS_CHANGE_ERROR","One or several problematic key statuses have been encountered",{keyStatuses:l})),{warning:u,blacklistedKeyIds:o,whitelistedKeyIds:s}}function Sh(e,t,n,i,a){j.info("DRM: Binding session events",e.sessionId);const{getLicenseConfig:o={}}=t,s=new me;return s.linkToSignal(a),r(e.closed)||e.closed.then(()=>s.cancel()).catch(e=>{a.isCancelled()||(s.cancel(),i.onError(e))}),Pr(e,e=>{s.cancel(),i.onError(new lt("KEY_ERROR",e.type))},s.signal),Nr(e,()=>{j.info("DRM: keystatuseschange event received",e.sessionId);try{l()}catch(e){if(a.isCancelled()||s.isUsed()&&e instanceof ve)return;s.cancel(),i.onError(e)}},s.signal),Mr(e,t=>{const n=t,a=new Uint8Array(n.message),l=Nt(n.messageType)?n.messageType:"license-request";j.info(`DRM: Received message event, type ${l}`,e.sessionId);const d=c(o.retry);vh(()=>u(a,l),d,s.signal).then(t=>{if(s.isUsed())return Promise.resolve();if(r(t))j.info("DRM: No license given, skipping session.update");else try{return Ah(e,t)}catch(e){s.cancel(),i.onError(e)}}).catch(e=>{if(s.isUsed())return;s.cancel();const t=wh(e);if(!r(e)){const{fallbackOnLastTry:n}=e;if(!0===n)return j.warn("DRM: Last `getLicense` attempt failed. Blacklisting the current session."),void i.onError(new Ih(t))}i.onError(t)})},s.signal),j.info("DRM: transmitting current keystatuses",e.sessionId),void l();function l(){if(s.isUsed()||0===e.keyStatuses.size)return;const{warning:r,blacklistedKeyIds:a,whitelistedKeyIds:o}=Th(e,t,n);void 0!==r&&(i.onWarning(r),s.isUsed())||i.onKeyUpdate({whitelistedKeyIds:o,blacklistedKeyIds:a})}function u(e,n){let i;return new Promise((a,s)=>{try{j.debug("DRM: Calling `getLicense`",n);const a=t.getLicense(e,n),c=r(o.timeout)?1e4:o.timeout;c>=0&&(i=setTimeout(()=>{s(new xh(`"getLicense" timeout exceeded (${c} ms)`))},c)),Promise.resolve(a).then(l,u)}catch(e){u(e)}function l(e){void 0!==i&&clearTimeout(i),a(e)}function u(e){void 0!==i&&clearTimeout(i),s(e)}})}function c(e){return{totalRetry:null!==e&&void 0!==e?e:2,baseDelay:200,maxDelay:3e3,shouldRetry:e=>e instanceof xh||r(e)||!0!==e.noRetry,onRetry:e=>i.onWarning(wh(e))}}}function wh(e){if(e instanceof xh)return new lt("KEY_LOAD_TIMEOUT","The license server took too much time to respond.");const t=new lt("KEY_LOAD_ERROR","An error occured when calling `getLicense`.");return!r(e)&&Nt(e.message)&&(t.message=e.message),t}async function Ah(e,t){j.info("DRM: Updating MediaKeySession with message");try{await e.update(t)}catch(e){const t=e instanceof Error?e.toString():"`session.update` failed";throw new lt("KEY_UPDATE_ERROR",t)}j.info("DRM: MediaKeySession update succeeded.")}class Ih extends Error{constructor(e){super(e.message),Object.setPrototypeOf(this,Ih.prototype),this.sessionError=e}}class xh extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Ih.prototype),this.message=e}}async function Rh(e,t){try{const n=await e.setServerCertificate(t);return n}catch(e){j.warn("DRM: mediaKeys.setServerCertificate returned an error",e instanceof Error?e:"");const t=e instanceof Error?e.toString():"`setServerCertificate` error";throw new lt("LICENSE_SERVER_CERTIFICATE_ERROR",t)}}async function Ch(e,t){if(!0===fh.hasOne(e))return j.info("DRM: The MediaKeys already has a server certificate, skipping..."),{type:"already-has-one"};if("function"!==typeof e.setServerCertificate)return j.warn("DRM: Could not set the server certificate. mediaKeys.setServerCertificate is not a function"),{type:"method-not-implemented"};j.info("DRM: Setting server certificate on the MediaKeys"),fh.prepare(e);try{const n=await Rh(e,t);return fh.set(e,t),{type:"success",value:n}}catch(e){const t=ft(e)?e:new lt("LICENSE_SERVER_CERTIFICATE_ERROR","Unknown error when setting the server certificate.");return{type:"error",value:t}}}function Dh(e,t){if(isNaN(t)||t<0||t>=e.getLength())return;const n=e.getLength(),i=n-t;j.info("DRM: Too many stored persistent sessions, removing some.",n,i),e.deleteOldSessions(i)}function kh(e){return ji(e,"com.microsoft.playready")||"com.chromecast.playready"===e||"com.youtube.playready"===e?"9a04f07998404286ab92e65be0885f95":"com.widevine.alpha"===e?"edef8ba979d64acea3c827dcd51d21ed":ji(e,"com.apple.fps")?"94ce86fb07ff4f43adb893d2fa968ca2":ji(e,"com.nagra.")?"adb41c242dbf4a6d958b4457c0d27b95":void 0}class Mh{constructor(e){this._innerValues=e,this._lazyFormattedValues=null}constructRequestData(){return Gr(...this._innerValues.map(e=>e.data))}isCompatibleWith(e){const t=e instanceof Mh?e.getFormattedValues():e;return oh(this.getFormattedValues(),t)}getFormattedValues(){return null===this._lazyFormattedValues&&(this._lazyFormattedValues=Lh(this._innerValues)),this._lazyFormattedValues}}function Lh(e){return e.slice().sort((e,t)=>{return e.systemId===t.systemId?0:void 0===e.systemId?1:void 0===t.systemId?-1:e.systemId<t.systemId?-1:1}).map(({systemId:e,data:t})=>({systemId:e,data:t,hash:rh(t)}))}class Ph extends a{static hasEmeApis(){return!r(Tf.requestMediaKeySystemAccess)}constructor(e,t){super(),j.debug("DRM: Starting ContentDecryptor logic.");const n=new me;this._currentSessions=[],this._canceller=n,this._initDataQueue=[],this._stateData={state:Ta.Initializing,isMediaKeysAttached:0,isInitDataQueueLocked:!0,data:null},this.error=null,Tf.onEncrypted(e,e=>{j.debug("DRM: Encrypted event received from media element.");const t=If(e);null!==t&&this.onInitializationData(t)},n.signal),mh(e,t,n.signal).then(t=>{const{options:n,mediaKeySystemAccess:i}=t;let a;(r(n.persistentLicenseConfig)||!0===n.persistentLicenseConfig.disableRetroCompatibility)&&(a=kh(i.keySystem)),this.systemId=a,this._stateData.state===Ta.Initializing&&(this._stateData={state:Ta.WaitingForAttachment,isInitDataQueueLocked:!0,isMediaKeysAttached:0,data:{mediaKeysInfo:t,mediaElement:e}},this.trigger("stateChange",this._stateData.state))}).catch(e=>{this._onFatalError(e)})}getState(){return this._stateData.state}attach(){if(this._stateData.state!==Ta.WaitingForAttachment)throw new Error("`attach` should only be called when in the WaitingForAttachment state");if(0!==this._stateData.isMediaKeysAttached)return void j.warn("DRM: ContentDecryptor's `attach` method called more than once.");const{mediaElement:e,mediaKeysInfo:t}=this._stateData.data,{options:n,mediaKeys:i,mediaKeySystemAccess:a,stores:o}=t,s=!0===n.disableMediaKeysAttachmentLock;if(s&&(this._stateData={state:Ta.ReadyForContent,isInitDataQueueLocked:!0,isMediaKeysAttached:1,data:{mediaKeysInfo:t,mediaElement:e}},this.trigger("stateChange",this._stateData.state),this._isStopped()))return;this._stateData.isMediaKeysAttached=1;const l={emeImplementation:Tf,loadedSessionsStore:o.loadedSessionsStore,mediaKeySystemAccess:a,mediaKeys:i,keySystemOptions:n};j.debug("DRM: Attaching current MediaKeys"),Df(e,l,this._canceller.signal).then(async()=>{this._stateData.isMediaKeysAttached=2;const{serverCertificate:e}=n;if(!r(e)){const t=await Ch(i,e);"error"===t.type&&this.trigger("warning",t.value)}if(this._isStopped())return;const a=this._stateData.state;this._stateData={state:Ta.ReadyForContent,isMediaKeysAttached:2,isInitDataQueueLocked:!1,data:{mediaKeysData:t}},a!==Ta.ReadyForContent&&this.trigger("stateChange",Ta.ReadyForContent),this._isStopped()||this._processCurrentInitDataQueue()}).catch(e=>{this._onFatalError(e)})}dispose(){this.removeEventListener(),this._stateData={state:Ta.Disposed,isMediaKeysAttached:void 0,isInitDataQueueLocked:void 0,data:null},this._canceller.cancel(),this.trigger("stateChange",this._stateData.state)}onInitializationData(e){if(!1!==this._stateData.isInitDataQueueLocked){if(this._isStopped())throw new Error("ContentDecryptor either disposed or stopped.");return void this._initDataQueue.push(e)}const{mediaKeysData:t}=this._stateData.data,n=Object.assign(Object.assign({},e),{values:new Mh(e.values)});this._processInitializationData(n,t).catch(e=>{this._onFatalError(e)})}async _processInitializationData(e,t){var n,i,a;j.hasLevel("DEBUG")&&j.debug("DRM: processing init data",null===(n=e.content)||void 0===n?void 0:n.adaptation.type,null===(i=e.content)||void 0===i?void 0:i.representation.bitrate,(null!==(a=e.keyIds)&&void 0!==a?a:[]).map(e=>Lo(e)).join(", "));const{mediaKeySystemAccess:o,stores:s,options:l}=t;if(this._tryToUseAlreadyCreatedSession(e,t)||this._isStopped())return;if("content"===l.singleLicensePer){const t=De(this._currentSessions,e=>"created-session"===e.source);if(void 0!==t){const n=e.keyIds;if(void 0===n)return void(void 0===e.content?j.warn("DRM: Unable to fallback from a non-decipherable quality."):(j.debug("DRM: Blacklisting new init data (due to singleLicensePer content policy)"),this.trigger("blackListProtectionData",e)));if(t.record.associateKeyIds(n),void 0===e.content)j.warn("DRM: Unable to fallback from a non-decipherable quality.");else{if(j.hasLevel("DEBUG")){const e=n.reduce((e,t)=>`${e}, ${Lo(t)}`,"");j.debug("DRM: Blacklisting new key ids",e)}this.trigger("keyIdsCompatibilityUpdate",{whitelistedKeyIds:[],blacklistedKeyIds:n,delistedKeyIds:[]})}return}}else if("periods"===l.singleLicensePer&&void 0!==e.content){const{period:t}=e.content,n=this._currentSessions.filter(e=>"created-session"===e.source),i=new Set;jh(i,t);for(const e of n){const t=Array.from(i);for(const n of t)if(e.record.isAssociatedWithKeyId(n)){e.record.associateKeyIds(i.values());for(const n of t)e.keyStatuses.whitelisted.some(e=>yt(e,n))||e.keyStatuses.blacklisted.some(e=>yt(e,n))||e.keyStatuses.blacklisted.push(n);return j.hasLevel("DEBUG")&&j.debug("DRM: Session already created for",Lo(n),'under singleLicensePer "periods" policy'),void this.trigger("keyIdsCompatibilityUpdate",{whitelistedKeyIds:e.keyStatuses.whitelisted,blacklistedKeyIds:e.keyStatuses.blacklisted,delistedKeyIds:[]})}}}let u;this._lockInitDataQueue(),r(l.persistentLicenseConfig)?u="temporary":Nh(o)?u="persistent-license":(j.warn('DRM: Cannot create "persistent-license" session: not supported'),u="temporary");const{EME_DEFAULT_MAX_SIMULTANEOUS_MEDIA_KEY_SESSIONS:c,EME_MAX_STORED_PERSISTENT_SESSION_INFORMATION:d}=O.getCurrent(),f="number"===typeof l.maxSessionCacheSize?l.maxSessionCacheSize:c,h=await Of(e,s,u,f,this._canceller.signal);if(this._isStopped())return;const p={record:h.value.keySessionRecord,source:h.type,keyStatuses:{whitelisted:[],blacklisted:[]},blacklistedSessionError:null};this._currentSessions.push(p);const{mediaKeySession:g,sessionType:m}=h.value;let v=!1;if(Sh(g,l,o.keySystem,{onKeyUpdate:t=>{const n=Bh(e,p.record,l.singleLicensePer,"created-session"===p.source,t.whitelistedKeyIds,t.blacklistedKeyIds);if(p.record.associateKeyIds(n.whitelisted),p.record.associateKeyIds(n.blacklisted),p.keyStatuses={whitelisted:n.whitelisted,blacklisted:n.blacklisted},0!==p.record.getAssociatedKeyIds().length&&"persistent-license"===m&&null!==s.persistentSessionsStore&&!v){const{persistentSessionsStore:t}=s;Dh(t,d-1),t.add(e,p.record.getAssociatedKeyIds(),g),v=!0}void 0!==e.content&&this.trigger("keyIdsCompatibilityUpdate",{whitelistedKeyIds:n.whitelisted,blacklistedKeyIds:n.blacklisted,delistedKeyIds:[]}),this._unlockInitDataQueue()},onWarning:e=>{this.trigger("warning",e)},onError:t=>{var n;if(t instanceof bh){j.warn("DRM: A session's closing condition has been triggered"),this._lockInitDataQueue();const i=this._currentSessions.indexOf(p);return i>=0&&this._currentSessions.splice(i),void 0!==e.content&&this.trigger("keyIdsCompatibilityUpdate",{whitelistedKeyIds:[],blacklistedKeyIds:[],delistedKeyIds:p.record.getAssociatedKeyIds()}),null===(n=s.persistentSessionsStore)||void 0===n||n.delete(g.sessionId),s.loadedSessionsStore.closeSession(g).catch(e=>{const t=e instanceof Error?e:"unknown error";j.warn("DRM: failed to close expired session",t)}).then(()=>this._unlockInitDataQueue()).catch(e=>this._onFatalError(e)),void(this._isStopped()||this.trigger("warning",t.reason))}t instanceof Ih?(p.blacklistedSessionError=t,void 0!==e.content&&(j.info("DRM: blacklisting Representations based on protection data."),this.trigger("blackListProtectionData",e)),this._unlockInitDataQueue()):this._onFatalError(t)}},this._canceller.signal),void 0!==l.singleLicensePer&&"init-data"!==l.singleLicensePer||this._unlockInitDataQueue(),"created-session"===h.type){const t=e.values.constructRequestData();try{await s.loadedSessionsStore.generateLicenseRequest(g,e.type,t)}catch(e){const t=s.loadedSessionsStore.getEntryForSession(g);if(null===t||"none"!==t.closingStatus.type){const e=this._currentSessions.indexOf(p);return e>=0&&this._currentSessions.splice(e,1),Promise.resolve()}throw new lt("KEY_GENERATE_REQUEST_ERROR",e instanceof Error?e.toString():"Unknown error")}}return Promise.resolve()}_tryToUseAlreadyCreatedSession(e,t){const{stores:n,options:i}=t,a=De(this._currentSessions,t=>t.record.isCompatibleWith(e));if(void 0===a)return!1;const o=a.blacklistedSessionError;if(!r(o))return void 0===e.type||void 0===e.content?(j.error("DRM: This initialization data has already been blacklisted but the current content is not known."),!0):(j.info("DRM: This initialization data has already been blacklisted. Blacklisting the related content."),this.trigger("blackListProtectionData",e),!0);if(void 0!==e.keyIds){let t;if(void 0===i.singleLicensePer||"init-data"===i.singleLicensePer){const{blacklisted:n}=a.keyStatuses;t=eh(e.keyIds,n)}else{const{whitelisted:n}=a.keyStatuses;t=!Jf(e.keyIds,n)}if(t)return void 0===e.content?(j.error("DRM: Cannot forbid key id, the content is unknown."),!0):(j.info("DRM: Current initialization data is linked to blacklisted keys. Marking Representations as not decipherable"),this.trigger("keyIdsCompatibilityUpdate",{whitelistedKeyIds:[],blacklistedKeyIds:e.keyIds,delistedKeyIds:[]}),!0)}const s=n.loadedSessionsStore.reuse(e);if(null!==s)return j.debug("DRM: Init data already processed. Skipping it."),!0;const l=this._currentSessions.indexOf(a);return-1===l?j.error("DRM: Unable to remove processed init data: not found."):(j.debug("DRM: A session from a processed init data is not available anymore. Re-processing it."),this._currentSessions.splice(l,1)),!1}_onFatalError(e){if(this._canceller.isUsed())return;const t=e instanceof Error?e:new dt("NONE","Unknown decryption error");this.error=t,this._initDataQueue.length=0,this._stateData={state:Ta.Error,isMediaKeysAttached:void 0,isInitDataQueueLocked:void 0,data:null},this._canceller.cancel(),this.trigger("error",t),this._stateData.state===Ta.Error&&this.trigger("stateChange",this._stateData.state)}_isStopped(){return this._stateData.state===Ta.Disposed||this._stateData.state===Ta.Error}_processCurrentInitDataQueue(){while(!1===this._stateData.isInitDataQueueLocked){const e=this._initDataQueue.shift();if(void 0===e)return;this.onInitializationData(e)}}_lockInitDataQueue(){!1===this._stateData.isInitDataQueueLocked&&(this._stateData.isInitDataQueueLocked=!0)}_unlockInitDataQueue(){2===this._stateData.isMediaKeysAttached?(this._stateData.isInitDataQueueLocked=!1,this._processCurrentInitDataQueue()):j.error("DRM: Trying to unlock in the wrong state")}}function Nh(e){const{sessionTypes:t}=e.getConfiguration();return void 0!==t&&gt(t,"persistent-license")}function Oh(e,t){return e.filter(e=>{return!t.some(t=>yt(t,e))})}function Fh(e,t){const n=e.getAssociatedKeyIds(),i=Oh(n,t);return i.length>0&&j.hasLevel("DEBUG")&&j.debug("DRM: KeySessionRecord's keys missing in the license, blacklisting them",i.map(e=>Lo(e)).join(", ")),i}function Uh(e,t){let n=[];const{keyIds:i}=e;return void 0!==i&&(n=Oh(i,t)),n.length>0&&j.hasLevel("DEBUG")&&j.debug("DRM: init data keys missing in the license, blacklisting them",n.map(e=>Lo(e)).join(", ")),n}function Bh(e,t,n,i,r,a){var o;const s=[...r,...a],l=Fh(t,s),u=s.concat(l);if(void 0!==n&&"init-data"!==n){const t=Uh(e,u);u.push(...t);const{content:r}=e;if(i&&void 0!==r)if("content"===n){const e=new Set,{manifest:t}=r;for(const n of t.periods)jh(e,n);Gh(e,u)}else if("periods"===n){const{manifest:t}=r;for(const n of t.periods){const t=new Set;if(jh(t,n),(null===(o=e.content)||void 0===o?void 0:o.period.id)===n.id)Gh(t,u);else{const e=Array.from(t);for(const n of e){const e=u.some(e=>yt(e,n));if(e){Gh(t,u);break}}}}}}return{whitelisted:r,blacklisted:u.slice(r.length)}}function Gh(e,t){const n=Array.from(e.values());for(const i of n){const e=t.some(e=>yt(e,i));e||t.push(i)}}function jh(e,t){const n=t.adaptations,i=ze(n).reduce((e,t)=>r(t)?e:e.concat(t),[]);for(const r of i)for(const t of r.representations)if(void 0!==t.contentProtections&&void 0!==t.contentProtections.keyIds)for(const n of t.contentProtections.keyIds)e.add(n.keyId)}var Vh=Ph;function Hh(e){e.decrypt=Vh}function Kh(e){var t;let n,i;const r="subtitles";if(f){const i=e.textTracks.length;n=i>0?e.textTracks[i-1]:e.addTextTrack(r),n.mode=null!==(t=n.SHOWING)&&void 0!==t?t:"showing"}else i=document.createElement("track"),e.appendChild(i),n=i.track,i.kind=r,n.mode="showing";return{track:n,trackElement:i}}function zh(e,t){const{activeCues:n}=e;if(null===n)return!1;for(let i=0;i<n.length;i++)if(n[i]===t)return!0;return!1}function Zh(e,t){if(h&&zh(e,t)){const n=e.mode;e.mode="hidden";try{e.removeCue(t)}catch(e){j.warn("Compat: Could not remove cue from text track.")}e.mode=n}else try{e.removeCue(t)}catch(e){j.warn("Compat: Could not remove cue from text track.")}}class qh{constructor(){this._ranges=[],this.length=0}insert(e,t){re(this._ranges,{start:e,end:t}),this.length=this._ranges.length}remove(e,t){const n=[];e>0&&n.push({start:0,end:e}),t<1/0&&n.push({start:t,end:1/0}),this._ranges=oe(this._ranges,n),this.length=this._ranges.length}start(e){if(e>=this._ranges.length)throw new Error("INDEX_SIZE_ERROR");return this._ranges[e].start}end(e){if(e>=this._ranges.length)throw new Error("INDEX_SIZE_ERROR");return this._ranges[e].end}}function Yh(e,t,n,i){j.debug("NTSB: Finding parser for native text tracks:",e);const r=Zt.nativeTextTracksParsers[e];if("function"!==typeof r)throw new Error("no parser found for the given text track");j.debug("NTSB: Parser found, parsing...");const a=r(t,n,i);return j.debug("NTSB: Parsed successfully!",a.length),a}class Wh{constructor(e){j.debug("NTD: Creating NativeTextDisplayer");const{track:t,trackElement:n}=Kh(e);this._buffered=new qh,this._videoElement=e,this._track=t,this._trackElement=n}pushTextData(e){var t,n;if(j.debug("NTD: Appending new native text tracks"),null===e.chunk)return X(this._buffered);const{timestampOffset:i,appendWindow:r,chunk:a}=e,{start:o,end:s,data:l,type:u,language:c}=a,d=null!==(t=r[0])&&void 0!==t?t:0,f=null!==(n=r[1])&&void 0!==n?n:1/0,h=Yh(u,l,i,c);if(0!==d&&f!==1/0){let e=0;while(e<h.length&&h[e].endTime<=d)e++;h.splice(0,e),e=0;while(e<h.length&&h[e].startTime<d)h[e].startTime=d,e++;e=h.length-1;while(e>=0&&h[e].startTime>=f)e--;h.splice(e,h.length),e=h.length-1;while(e>=0&&h[e].endTime>f)h[e].endTime=f,e--}let p,g;if(void 0!==o)p=Math.max(d,o);else{if(h.length<=0)return j.warn("NTD: Current text tracks have no cues nor start time. Aborting"),X(this._buffered);j.warn("NTD: No start time given. Guessing from cues."),p=h[0].startTime}if(void 0!==s)g=Math.min(f,s);else{if(h.length<=0)return j.warn("NTD: Current text tracks have no cues nor end time. Aborting"),X(this._buffered);j.warn("NTD: No end time given. Guessing from cues."),g=h[h.length-1].endTime}if(g<=p)return j.warn("NTD: Invalid text track appended: ","the start time is inferior or equal to the end time."),X(this._buffered);if(h.length>0){const e=h[0],t=this._track.cues;null!==t&&t.length>0&&e.startTime<t[t.length-1].startTime&&this._removeData(e.startTime,1/0);for(const n of h)this._track.addCue(n)}return this._buffered.insert(p,g),X(this._buffered)}removeBuffer(e,t){return this._removeData(e,t),X(this._buffered)}getBufferedRanges(){return X(this._buffered)}reset(){j.debug("NTD: Aborting NativeTextDisplayer"),this._removeData(0,1/0);const{_trackElement:e,_videoElement:t}=this;if(void 0!==e&&t.hasChildNodes())try{t.removeChild(e)}catch(e){j.warn("NTD: Can't remove track element from the video")}const n=this._track.mode;this._track.mode="disabled",this._track.mode=n,void 0!==this._trackElement&&(this._trackElement.innerHTML="")}stop(){j.debug("NTD: Aborting NativeTextDisplayer"),this._removeData(0,1/0);const{_trackElement:e,_videoElement:t}=this;if(void 0!==e&&t.hasChildNodes())try{t.removeChild(e)}catch(e){j.warn("NTD: Can't remove track element from the video")}this._track.mode="disabled",void 0!==this._trackElement&&(this._trackElement.innerHTML="")}_removeData(e,t){j.debug("NTD: Removing native text track data",e,t);const n=this._track,i=n.cues;if(null!==i)for(let r=i.length-1;r>=0;r--){const a=i[r],{startTime:o,endTime:s}=a;o>=e&&o<=t&&s<=t&&Zh(n,a)}this._buffered.remove(e,t)}}var $h=Wh;const Xh=/(\d+) (\d+)/;function Qh(e){const t=e.getAttribute("ttp:frameRate"),n=e.getAttribute("ttp:subFramRate"),i=e.getAttribute("ttp:tickRate"),r=e.getAttribute("ttp:frameRateMultiplier"),a=e.getAttribute("xml:space"),o=e.getAttribute("ttp:cellResolution");let s={columns:32,rows:15};if(null!==o){const e=Xh.exec(o);if(null===e||e.length<3)j.warn("TTML Parser: Invalid cellResolution");else{const t=parseInt(e[1],10),n=parseInt(e[2],10);isNaN(t)||isNaN(n)?j.warn("TTML Parser: Invalid cellResolution"):s={columns:t,rows:n}}}if(Nt(a)&&"default"!==a&&"preserve"!==a)throw new Error("Invalid spacing style");let l=Number(t);(isNaN(l)||l<=0)&&(l=30);let u=Number(n);(isNaN(u)||u<=0)&&(u=1);let c=Number(i);(isNaN(c)||c<=0)&&(c=void 0);let d=l;const f=null!==u&&void 0!==u?u:1,h=null!==a&&void 0!==a?a:"default",p=null!==c&&void 0!==c?c:l*u;if(null!==r){const e=/^(\d+) (\d+)$/g.exec(r);if(null!==e){const t=Number(e[1]),n=Number(e[2]),i=t/n;d=l*i}}return{cellResolution:s,tickRate:p,frameRate:d,subFrameRate:f,spaceStyle:h}}function Jh(e,t,n,i){const r={},a=e.slice();for(let o=0;o<=t.length-1;o++){const e=t[o];if(void 0!==e){let t,o;if(e.nodeType===Node.ELEMENT_NODE){const n=e;for(let e=0;e<=n.attributes.length-1;e++){const i=n.attributes[e],s=i.name;if("style"===s)t=i.value;else if("region"===s)o=i.value;else{const t=s.substring(4);if(gt(a,t)&&(r[t]=i.value,a.splice(e,1),0===a.length))return r}}}if(Nt(t)){const e=De(n,e=>e.id===t);if(void 0!==e)for(let t=0;t<=a.length-1;t++){const n=a[t];if(!Nt(r[n])&&Nt(e.style[n])){if(r[n]=e.style[n],a.splice(t,1),0===a.length)return r;t--}}}if(Nt(o)){const e=De(i,e=>e.id===o);if(void 0!==e)for(let t=0;t<=a.length-1;t++){const n=a[t];if(!Nt(r[n])&&Nt(e.style[n])){if(r[n]=e.style[n],a.splice(t,1),0===a.length)return r;t--}}}}}return r}function ep(e){if(e.nodeType!==Node.ELEMENT_NODE)return{};const t=e,n={};for(let i=0;i<=t.attributes.length-1;i++){const e=t.attributes[i];if(ji(e.name,"tts")){const t=e.name.substring(4);n[t]=e.value}}return n}function tp(e){const t=[];function n(i,r){t.push(r);for(let a=0;a<i.extendsStyles.length;a++){const r=i.extendsStyles[a],o=le(e,e=>e.id===r);if(o<0)j.warn("TTML Parser: unknown style inheritance: "+r);else{const r=e[o];gt(t,o)?j.warn("TTML Parser: infinite style inheritance loop avoided"):n(r,o),i.style=k({},r.style,i.style)}}i.extendsStyles.length=0}for(let i=0;i<e.length;i++)n(e[i],i),t.length=0}function np(e,t){if(!(e.parentNode instanceof Element))return[];function n(e){const i=[];e.tagName.toLowerCase()===t.toLowerCase()&&i.push(e);const r=e.parentNode;return r instanceof Element&&i.push(...n(r)),i}return n(e.parentNode)}function ip(e){let t=np(e,"div");if(0===t.length){const n=np(e,"tt:div");n.length>0&&(t=n)}return t}function rp(e){const t=e.getElementsByTagName("body");if(t.length>0)return t[0];const n=e.getElementsByTagName("tt:body");return n.length>0?n[0]:null}function ap(e){const t=e.getElementsByTagName("style");if(t.length>0)return t;const n=e.getElementsByTagName("tt:style");return n.length>0?n:t}function op(e){const t=e.getElementsByTagName("region");if(t.length>0)return t;const n=e.getElementsByTagName("tt:region");return n.length>0?n:t}function sp(e){const t=e.getElementsByTagName("p");if(t.length>0)return t;const n=e.getElementsByTagName("tt:p");return n.length>0?n:t}function lp(e){return"br"===e.nodeName||"tt:br"===e.nodeName}function up(e){return"span"===e.nodeName||"tt:span"===e.nodeName}const cp=["align","backgroundColor","color","direction","display","displayAlign","extent","fontFamily","fontSize","fontStyle","fontWeight","lineHeight","opacity","origin","overflow","padding","textAlign","textDecoration","textOutline","unicodeBidi","visibility","wrapOption","writingMode"];function dp(e,t){const n=[],i=(new DOMParser).parseFromString(e,"text/xml");if(null!==i&&void 0!==i){const e=i.getElementsByTagName("tt");let r=e[0];if(void 0===r){const e=i.getElementsByTagNameNS("*","tt");if(r=e[0],void 0===r)throw new Error("invalid XML")}const a=rp(r),o=ap(r),s=op(r),l=sp(r),u=Qh(r),c=[];for(let t=0;t<=o.length-1;t++){const e=o[t];if(e instanceof Element){const t=e.getAttribute("xml:id");if(null!==t){const n=e.getAttribute("style"),i=null===n?[]:n.split(" ");c.push({id:t,style:ep(e),extendsStyles:i})}}}tp(c);const d=[];for(let t=0;t<=s.length-1;t++){const e=s[t];if(e instanceof Element){const t=e.getAttribute("xml:id");if(null!==t){let n=ep(e);const i=e.getAttribute("style");if(Nt(i)){const e=De(c,e=>e.id===i);void 0!==e&&(n=k({},e.style,n))}d.push({id:t,style:n,extendsStyles:[]})}}}const f=Jh(cp,null!==a?[a]:[],c,d),h=null!==a?a.getAttribute("xml:space"):void 0,p="default"===h||"default"===u.spaceStyle;for(let i=0;i<l.length;i++){const e=l[i];if(e instanceof Element){const i=ip(e),r=k({},f,Jh(cp,[e,...i],c,d)),o=e.getAttribute("xml:space"),s=Nt(o)?"default"===o:p,l={paragraph:e,timeOffset:t,idStyles:c,regionStyles:d,body:a,paragraphStyle:r,ttParams:u,shouldTrimWhiteSpace:s};null!==l&&n.push(l)}}}return n}function fp(e){return"function"===typeof o["a"].VTTCue&&e instanceof o["a"].VTTCue}function hp(e,t,n){if(e>=t)return j.warn(`Compat: Invalid cue times: ${e} - ${t}`),null;if(r(o["a"].VTTCue)){if(r(o["a"].TextTrackCue))throw new Error("VTT cues not supported in your target");return new TextTrackCue(e,t,n)}return new VTTCue(e,t,n)}const pp=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,gp=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,mp=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,vp=/^(\d*\.?\d*)f$/,yp=/^(\d*\.?\d*)t$/,_p=/^(?:(\d*\.?\d*)h)?(?:(\d*\.?\d*)m)?(?:(\d*\.?\d*)s)?(?:(\d*\.?\d*)ms)?$/,bp=/^(\d{1,2}|100)% (\d{1,2}|100)%$/,Ep=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%|rh|rw)$/,Tp=/^#([0-9A-f]{2})([0-9A-f]{2})([0-9A-f]{2})([0-9A-f]{2})$/,Sp=/^#([0-9A-f])([0-9A-f])([0-9A-f])([0-9A-f])$/,wp=/^rgb\( *(\d+) *, *(\d+) *, *(\d+) *\)/,Ap=/^rgba\( *(\d+) *, *(\d+) *, *(\d+) *, *(\d+) *\)/;function Ip(e,t){return pp.test(e)?Cp(t,e):gp.test(e)?Dp(gp,e):mp.test(e)?Dp(mp,e):vp.test(e)?xp(t,e):yp.test(e)?Rp(t,e):_p.test(e)?Dp(_p,e):void 0}function xp(e,t){const n=vp.exec(t),i=Number(n[1]);return i/e.frameRate}function Rp(e,t){const n=yp.exec(t),i=Number(n[1]);return i/e.tickRate}function Cp(e,t){const n=pp.exec(t),i=Number(n[1]),r=Number(n[2]);let a=Number(n[3]),o=Number(n[4]),s=Number(n[5]);return isNaN(s)&&(s=0),o+=s/e.subFrameRate,a+=o/e.frameRate,a+60*r+3600*i}function Dp(e,t){const n=e.exec(t);if(null===n||""===n[0])return null;let i=Number(n[1]);isNaN(i)&&(i=0);let r=Number(n[2]);isNaN(r)&&(r=0);let a=Number(n[3]);isNaN(a)&&(a=0);let o=Number(n[4]);return isNaN(o)&&(o=0),o/1e3+a+60*r+3600*i}var kp=Ip;function Mp(e,t){const n=e.getAttribute("begin"),i=e.getAttribute("dur"),a=e.getAttribute("end"),o=Nt(n)?kp(n,t):null,s=Nt(i)?kp(i,t):null,l=Nt(a)?kp(a,t):null;if(r(o)||r(l)&&r(s))throw new Error("Invalid text cue");const u=r(l)?o+s:l;return{start:o,end:u}}const Lp={left:"start",center:"center",right:"end",start:"start",end:"end"},Pp={left:"line-left",center:"center",right:"line-right"};function Np(e){const{paragraph:t,timeOffset:n,paragraphStyle:i,ttParams:r,shouldTrimWhiteSpace:a}=e;if(!t.hasAttribute("begin")&&!t.hasAttribute("end")&&/^\s*$/.test(null===t.textContent?"":t.textContent))return null;const{start:o,end:s}=Mp(t,r),l=Op(t,a),u=hp(o+n,s+n,l);return null===u?null:(fp(u)&&Fp(u,i),u)}function Op(e,t){function n(e,t){const i=e.childNodes;let r="";for(let a=0;a<i.length;a++){const e=i[a];if("#text"===e.nodeName){let n=e.textContent;if(null===n&&(n=""),t){let e=n.trim();e=e.replace(/\s+/g," "),n=e}const i=n.replace(/&|\u0026/g,"&amp;").replace(/<|\u003C/g,"&lt;").replace(/>|\u2265/g,"&gt;").replace(/\u200E/g,"&lrm;").replace(/\u200F/g,"&rlm;").replace(/\u00A0/g,"&nbsp;");r+=i}else if(lp(e))r+="\n";else if(up(e)&&e.nodeType===Node.ELEMENT_NODE&&e.childNodes.length>0){const i=e.getAttribute("xml:space"),a=Nt(i)?"default"===i:t;r+=n(e,a)}}return r}return n(e,t)}function Fp(e,t){const n=t.extent;if(Nt(n)){const t=bp.exec(n);r(t)||(e.size=Number(t[1]))}const i=t.writingMode;switch(i){case"tb":case"tblr":e.vertical="lr";break;case"tbrl":e.vertical="rl";break;default:break}const a=t.origin;if(Nt(a)){const e=bp.exec(a);r(e)}const o=t.align;if(Nt(o)){e.align=o,"center"===o&&("center"!==e.align&&(e.align="middle"),e.position="auto");const t=Pp[o];e.positionAlign=void 0===t?"":t;const n=Lp[o];e.lineAlign=void 0===n?"":n}}function Up(e,t){const n=dp(e,t),i=[];for(let r=0;r<n.length;r++){const e=n[r],t=Np(e);null!==t&&i.push(t)}return i}var Bp=Up;function Gp(e){e.nativeTextTracksParsers.ttml=Bp,e.nativeTextDisplayer=$h}const jp=/&#([0-9]+);/g,Vp=/<br>/gi,Hp=/<style[^>]*>([\s\S]*?)<\/style[^>]*>/i,Kp=/\s*<p (?:class=([^>]+))?>(.*)/i,zp=/<sync[^>]+?start="?([0-9]*)"?[^0-9]/i;function Zp(e){const t=[];for(let n=0;n<e.length;n++){const{start:i,end:a,text:o}=e[n];if(Nt(o)&&!r(a)){const e=hp(i,a,o);null!==e&&t.push(e)}}return t}function qp(e){const t=/\.(\S+)\s*{([^}]*)}/gi,n={};let i=t.exec(e);while(Array.isArray(i)){const a=i[1],o=Yp(i[2],"lang");r(a)||r(o)||(n[o]=a),i=t.exec(e)}return n}function Yp(e,t){const n=new RegExp("\\s*"+t+":\\s*(\\S+);","i").exec(e);return Array.isArray(n)?n[1]:null}function Wp(e){return e.replace(Vp,"\n").replace(jp,(e,t)=>String.fromCharCode(Number(t)))}function $p(e,t,n){const i=/<sync[ >]/gi,r=/<sync[ >]|<\/body>/gi,a=[],o=Hp.exec(e),s=null!==o?o[1]:"";let l,u;r.exec(e);const c=qp(s);let d;if(Nt(n)&&(d=c[n],void 0===d))throw new Error(`sami: could not find lang ${n} in CSS`);while(1){if(l=i.exec(e),u=r.exec(e),null===l&&null===u)break;if(null===l||null===u||l.index>=u.index)throw new Error("parse error");const t=e.slice(l.index,u.index),n=zp.exec(t);if(null===n)throw new Error("parse error (sync time attribute)");const a=+n[1];if(isNaN(a))throw new Error("parse error (sync time attribute NaN)");f(t.split("\n"),a/1e3)}return Zp(a);function f(e,n){let i,r=e.length;while(--r>=0){if(i=Kp.exec(e[r]),null===i)continue;const[,o,s]=i;d===o&&("&nbsp;"===s?a[a.length-1].end=n:a.push({text:Wp(s),start:n+t}))}}}var Xp=$p;function Qp(e){e.nativeTextTracksParsers.sami=Xp,e.nativeTextDisplayer=$h}function Jp(e){let t=0;while(t<e.length){if(""===e[t])return t+1;t++}return t}function eg(e,t){return"string"===typeof e[t]&&/^STYLE( .*)?$/g.test(e[t])&&(void 0===e[t+1]||e[t+1].indexOf("--\x3e")<0)}function tg(e,t){return"string"===typeof e[t]&&/^NOTE( .*)?$/g.test(e[t])&&(void 0===e[t+1]||e[t+1].indexOf("--\x3e")<0)}function ng(e,t){return"string"===typeof e[t]&&/^REGION( .*)?$/g.test(e[t])&&(void 0===e[t+1]||e[t+1].indexOf("--\x3e")<0)}function ig(e,t){const n=e[t];if(void 0===n||""===n||eg(e,t)||ng(e,t)||tg(e,t))return!1;if(n.indexOf("--\x3e")>=0)return!0;const i=e[t+1];return void 0!==i&&i.indexOf("--\x3e")>=0}function rg(e,t){let n=t+1;while(Nt(e[n]))n++;return n}function ag(e,t){const n=[];for(let i=t;i<e.length;i++)if(ig(e,i)){const t=rg(e,i);n.push(e.slice(i,t)),i=t}else if(Nt(e[i]))while(Nt(e[i]))i++;return n}function og(e){const t=e.split(":").reverse();if(Nt(t[2])||Nt(t[1])){const e=Nt(t[2])?parseInt(t[2],10):0,n=parseInt(t[1],10),i=parseFloat(t[0].replace(",","."));if(isNaN(e)||isNaN(n)||isNaN(i))return;return 60*e*60+60*n+i}}function sg(e){const t=e.split(/ |\t/);return t.reduce((e,t)=>{const n=t.split(":");return 2===n.length&&(e[n[0]]=n[1]),e},{})}function lg(e){const t=/^([\d:.]+)[ |\t]+-->[ |\t]+([\d:.]+)[ |\t]*(.*)$/,n=t.exec(e);if(null===n)return null;const i=og(n[1]),r=og(n[2]);if(void 0===i||void 0===r)return null;const a=sg(n[3]);return{start:i,end:r,settings:a}}function ug(e,t){const n=/-->/;let i,r,a;if(n.test(e[0]))i=e[0],r=e.slice(1,e.length);else{if(!n.test(e[1]))return null;a=e[0],i=e[1],r=e.slice(2,e.length)}const o=lg(i);if(null===o)return null;const{start:s,end:l,settings:u}=o;return{start:s+t,end:l+t,settings:u,payload:r,header:a}}function cg(e,t){if(!Nt(e.vertical)||"rl"!==e.vertical&&"lr"!==e.vertical||(t.vertical=e.vertical),Nt(e.line)){const n=/^(\d+(\.\d+)?)%(,([a-z]+))?/,i=n.exec(e.line);if(Array.isArray(i))t.line=Number(i[1]),t.snapToLines=!1,gt(["start","center","end"],i[4])&&(t.lineAlign=i[4]);else{const n=/^(-?\d+)(,([a-z]+))?/,i=n.exec(e.line);Array.isArray(i)&&(t.line=Number(i[1]),t.snapToLines=!0,gt(["start","center","end"],i[3])&&(t.lineAlign=i[3]))}}if(Nt(e.position)){const n=/^([\d\.]+)%(?:,(line-left|line-right|center))?$/,i=n.exec(e.position);if(Array.isArray(i)&&i.length>=2){const e=parseInt(i[1],10);isNaN(e)||(t.position=e,void 0!==i[2]&&(t.positionAlign=i[2]))}}Nt(e.size)&&(t.size=e.size),"string"===typeof e.align&&gt(["start","center","end","left"],e.align)&&(t.align=e.align)}function dg(e){const{start:t,end:n,payload:i}=e,r=i.join("\n");return hp(t,n,r)}function fg(e,t){const n=e.split(/\r\n|\n|\r/);if(!/^WEBVTT($| |\t)/.test(n[0]))throw new Error("Can't parse WebVTT: Invalid file.");const i=Jp(n),r=ag(n,i),a=[];for(let o=0;o<r.length;o++){const e=ug(r[o],t);if(null!==e){const t=dg(e);null!==t&&(fp(t)&&cg(e.settings,t),a.push(t))}}return a}var hg=fg;function pg(e){e.nativeTextTracksParsers.vtt=hg,e.nativeTextDisplayer=$h}function gg(e,t){let n=t+1;while(Nt(e[n]))n++;return n}function mg(e){const t=[];for(let n=0;n<e.length;n++)if(Nt(e[n])){const i=gg(e,n),r=e.slice(n,i);r.length>0&&(1===r.length?r[0].indexOf("--\x3e")>=0&&t.push(r):(r[1].indexOf("--\x3e")>=0||r[0].indexOf("--\x3e")>=0)&&t.push(r)),n=i}return t}function vg(e){const t=e.split(":");if(Nt(t[2])){const e=parseInt(t[0],10),n=parseInt(t[1],10),i=parseFloat(t[2].replace(",","."));if(isNaN(e)||isNaN(n)||isNaN(i))return;return 60*e*60+60*n+i}}function yg(e,t){if(0===e.length)return null;let n,i,r=[];if(Nt(e[1])&&-1!==e[1].indexOf("--\x3e")&&([n,i]=e[1].split("--\x3e").map(e=>e.trim()),r=e.slice(2,e.length)),Nt(n)&&Nt(i)||([n,i]=e[0].split("--\x3e").map(e=>e.trim()),r=e.slice(1,e.length)),!Nt(n)||!Nt(i))return null;const a=vg(n),o=vg(i);return void 0===a||void 0===o?null:{start:a+t,end:o+t,payload:r}}function _g(e,t){const n=e.split(/\r\n|\n|\r/),i=mg(n),r=[];for(let a=0;a<i.length;a++){const e=yg(i[a],t);if(null!==e){const t=bg(e);null!==t&&r.push(t)}}return r}function bg(e){const{start:t,end:n,payload:i}=e,r=i.join("\n");return hp(t,n,r)}function Eg(e){e.nativeTextTracksParsers.srt=_g,e.nativeTextDisplayer=$h}const Tg=o["a"].ResizeObserver;function Sg(e,t,n){const{height:i,width:r}=e.getBoundingClientRect(),a=new de({height:i,width:r},n);let o=i,s=r;if(void 0!==Tg){const t=new Tg(e=>{if(0===e.length)return void j.error("Compat: Resized but no observed element.");const t=e[0],{height:n,width:i}=t.contentRect;n===o&&i===s||(o=n,s=i,a.setValue({height:n,width:i}))});t.observe(e),n.register(()=>{t.disconnect()})}else{const i=setInterval(()=>{const{height:t,width:n}=e.getBoundingClientRect();t===o&&n===s||(o=t,s=n,a.setValue({height:t,width:n}))},t);n.register(()=>{clearInterval(i)})}return a}function wg(e,t,n,i){j.debug("HTSB: Finding parser for html text tracks:",e);const r=Zt.htmlTextTracksParsers[e];if("function"!==typeof r)throw new Error("no parser found for the given text track");j.debug("HTSB: Parser found, parsing...");const a=r(t,n,i);return j.debug("HTTB: Parsed successfully!",a.length),a}const Ag=.2;function Ig(e,t,n=Ag){return Math.abs(e-t)<=Math.min(n,Ag)}const xg=.05;function Rg(e,t){const n=e.end-e.start,i=t.end-t.start,r=Math.abs(e.start-t.start),a=Math.min(n,i,Ag);return r/a<=xg}function Cg(e,t){for(let n=e.length-1;n>=0;n--){const i=e[n];if(i.start<t)return e.slice(0,n+1)}return[]}function Dg(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(i.end>t)return e.slice(n,e.length)}return[]}function kg(e,t,n){const i=Math.max(e.start,t),r=Cg(e.cues,t),a={start:e.start,end:i,cues:r},o=Math.min(n,e.end),s=Dg(e.cues,n),l={start:o,end:e.end,cues:s};return[a,l]}const Mg=.001,Lg=5;class Pg{constructor(){this._cuesBuffer=[]}isEmpty(){return 0===this._cuesBuffer.length}get(e){const t=this._cuesBuffer,n=[];for(let i=t.length-1;i>=0;i--){const r=t[i];if(e<r.end&&e>=r.start){const t=r.cues;for(const i of t)e>=i.start&&e<i.end&&n.push(i.element);if(0===n.length&&t.length>0)for(const i of t)(Ig(e,i.start,Mg)||Ig(e,i.end,Mg))&&n.push(i.element);return n}}return[]}remove(e,t){const n=Math.max(e,t),i=this._cuesBuffer;for(let r=0;r<i.length;r++)if(i[r].end>e){const t=i[r];if(t.start>=n)return;if(t.end>=n){if(e<=t.start)t.cues=Dg(t.cues,n),t.start=n;else{const[a,o]=kg(t,e,n);this._cuesBuffer[r]=a,i.splice(r+1,0,o)}return}t.start>=e?(i.splice(r,1),r--):(t.cues=Cg(t.cues,e),t.end=Math.max(e,t.start))}}insert(e,t,n){const i=this._cuesBuffer,r={start:t,end:n,cues:e},a=Math.abs(t-n)/Lg;function o(e){const t=i[e];void 0===t||Ig(r.end,t.end,a)?i[e]=r:t.start>=r.end?i.splice(e,0,r):(t.cues=Dg(t.cues,r.end),t.start=r.end,i.splice(e,0,r))}for(let s=0;s<i.length;s++){let e=i[s];if(t<e.end){if(Rg(r,e)){if(Ig(n,e.end,a))return void(i[s]=r);if(n<e.end)return e.cues=Dg(e.cues,n),e.start=n,void i.splice(s,0,r);do{i.splice(s,1),e=i[s]}while(void 0!==e&&n>e.end);return void o(s)}if(t<e.start){if(n<e.start)return void i.splice(s,0,r);if(Ig(n,e.start,a))return e.start=n,void i.splice(s,0,r);if(Ig(n,e.end,a))return void i.splice(s,1,r);if(n<e.end)return e.cues=Dg(e.cues,n),e.start=n,void i.splice(s,0,r);do{i.splice(s,1),e=i[s]}while(void 0!==e&&n>e.end);return void o(s)}if(Ig(e.end,n,a))return e.cues=Cg(e.cues,t),e.end=t,void i.splice(s+1,0,r);if(e.end>n){const[a,o]=kg(e,t,n);return this._cuesBuffer[s]=a,i.splice(s+1,0,r),void i.splice(s+2,0,o)}{e.cues=Cg(e.cues,t),e.end=t;const r=s+1;e=i[r];while(void 0!==e&&n>e.end)i.splice(r,1),e=i[r];return void o(r)}}}if(i.length){const e=i[i.length-1];Ig(e.end,t,a)&&(e.end=t)}i.push(r)}}function Ng(e,t,n,i){const r=[t/n.columns,e/n.rows],a=i.getElementsByClassName("proportional-style");for(let o=0;o<a.length;o++){const e=a[o];if(e instanceof HTMLElement){const t=e.getAttribute("data-proportional-font-size");null===t||isNaN(+t)||(e.style.fontSize=String(+t*r[1])+"px");const n=e.getAttribute("data-proportional-width");null===n||isNaN(+n)||(e.style.width=String(+n*r[0])+"px");const i=e.getAttribute("data-proportional-height");null===i||isNaN(+i)||(e.style.height=String(+i*r[1])+"px");const a=e.getAttribute("data-proportional-line-height");null===a||isNaN(+a)||(e.style.lineHeight=String(+a*r[1])+"px");const o=e.getAttribute("data-proportional-left");null===o||isNaN(+o)||(e.style.left=String(+o*r[0])+"px");const s=e.getAttribute("data-proportional-top");null===s||isNaN(+s)||(e.style.top=String(+s*r[1])+"px");const l=e.getAttribute("data-proportional-padding-top");null===l||isNaN(+l)||(e.style.paddingTop=String(+l*r[1])+"px");const u=e.getAttribute("data-proportional-padding-bottom");null===u||isNaN(+u)||(e.style.paddingBottom=String(+u*r[1])+"px");const c=e.getAttribute("data-proportional-padding-left");null===c||isNaN(+c)||(e.style.paddingLeft=String(+c*r[0])+"px");const d=e.getAttribute("data-proportional-padding-right");null===d||isNaN(+d)||(e.style.paddingRight=String(+d*r[0])+"px")}}return a.length>0}function Og(e,t){try{e.removeChild(t)}catch(e){j.warn("HTD: Can't remove text track: not in the element.")}}function Fg(e){const t=e.getAttribute("data-resolution-rows"),n=e.getAttribute("data-resolution-columns");if(null===t||null===n)return null;const i=parseInt(t,10),r=parseInt(n,10);return null===i||null===r?null:{rows:i,columns:r}}class Ug{constructor(e,t){j.debug("HTD: Creating HTMLTextDisplayer"),this._buffered=new qh,this._videoElement=e,this._textTrackElement=t,this._sizeUpdateCanceller=new me,this._subtitlesIntervalCanceller=new me,this._buffer=new Pg,this._currentCues=[],this._isAutoRefreshing=!1}pushTextData(e){var t,n;j.debug("HTD: Appending new html text tracks");const{timestampOffset:i,appendWindow:r,chunk:a}=e;if(null===a)return X(this._buffered);const{start:o,end:s,data:l,type:u,language:c}=a,d=null!==(t=r[0])&&void 0!==t?t:0,f=null!==(n=r[1])&&void 0!==n?n:1/0,h=wg(u,l,i,c);if(0!==d&&f!==1/0){let e=0;while(e<h.length&&h[e].end<=d)e++;h.splice(0,e),e=0;while(e<h.length&&h[e].start<d)h[e].start=d,e++;e=h.length-1;while(e>=0&&h[e].start>=f)e--;h.splice(e,h.length),e=h.length-1;while(e>=0&&h[e].end>f)h[e].end=f,e--}let p,g;if(void 0!==o)p=Math.max(d,o);else{if(h.length<=0)return j.warn("HTD: Current text tracks have no cues nor start time. Aborting"),X(this._buffered);j.warn("HTD: No start time given. Guessing from cues."),p=h[0].start}if(void 0!==s)g=Math.min(f,s);else{if(h.length<=0)return j.warn("HTD: Current text tracks have no cues nor end time. Aborting"),X(this._buffered);j.warn("HTD: No end time given. Guessing from cues."),g=h[h.length-1].end}return g<=p?(j.warn("HTD: Invalid text track appended: ","the start time is inferior or equal to the end time."),X(this._buffered)):(this._buffer.insert(h,p,g),this._buffered.insert(p,g),this._isAutoRefreshing||this._buffer.isEmpty()||this.autoRefreshSubtitles(this._subtitlesIntervalCanceller.signal),X(this._buffered))}removeBuffer(e,t){return j.debug("HTD: Removing html text track data",e,t),this._buffer.remove(e,t),this._buffered.remove(e,t),this._isAutoRefreshing&&this._buffer.isEmpty()&&(this.refreshSubtitles(),this._isAutoRefreshing=!1,this._subtitlesIntervalCanceller.cancel(),this._subtitlesIntervalCanceller=new me),X(this._buffered)}getBufferedRanges(){return X(this._buffered)}reset(){j.debug("HTD: Resetting HTMLTextDisplayer"),this.stop(),this._subtitlesIntervalCanceller=new me}stop(){this._subtitlesIntervalCanceller.isUsed()||(j.debug("HTD: Stopping HTMLTextDisplayer"),this._disableCurrentCues(),this._buffer.remove(0,1/0),this._buffered.remove(0,1/0),this._isAutoRefreshing=!1,this._subtitlesIntervalCanceller.cancel())}_disableCurrentCues(){if(this._sizeUpdateCanceller.cancel(),this._currentCues.length>0){for(const e of this._currentCues)Og(this._textTrackElement,e.element);this._currentCues=[]}}_displayCues(e){const t=this._currentCues.length===e.length&&this._currentCues.every((t,n)=>t.element===e[n]);if(t)return;this._sizeUpdateCanceller.cancel();for(const i of this._currentCues)Og(this._textTrackElement,i.element);this._currentCues=[];for(const i of e){const e=Fg(i);this._currentCues.push({element:i,resolution:e}),this._textTrackElement.appendChild(i)}const n=this._currentCues.filter(e=>null!==e.resolution);if(n.length>0){this._sizeUpdateCanceller=new me,this._sizeUpdateCanceller.linkToSignal(this._subtitlesIntervalCanceller.signal);const{TEXT_TRACK_SIZE_CHECKS_INTERVAL:e}=O.getCurrent(),t=Sg(this._textTrackElement,e,this._sizeUpdateCanceller.signal);t.onUpdate(({height:e,width:t})=>{for(const i of n){const{resolution:n,element:r}=i;Ng(e,t,n,r)}},{clearSignal:this._sizeUpdateCanceller.signal,emitCurrentValue:!0})}}autoRefreshSubtitles(e){if(this._isAutoRefreshing||e.isCancelled())return;let t=null;const{MAXIMUM_HTML_TEXT_TRACK_UPDATE_INTERVAL:n}=O.getCurrent(),i=()=>{this._isAutoRefreshing=!1,null!==t&&(t.cancel(),t=null)},r=()=>{i(),this._isAutoRefreshing=!0,t=new me,t.linkToSignal(e);const r=setInterval(()=>this.refreshSubtitles(),n);t.signal.register(()=>{clearInterval(r)}),this.refreshSubtitles()};Or(this._videoElement,()=>{i(),this._disableCurrentCues()},e),Fr(this._videoElement,r,e),Ur(this._videoElement,r,e),r()}refreshSubtitles(){const{MAXIMUM_HTML_TEXT_TRACK_UPDATE_INTERVAL:e}=O.getCurrent();let t;t=this._videoElement.paused||this._videoElement.playbackRate<=0?this._videoElement.currentTime:Math.max(this._videoElement.currentTime+e/1e3/2,0);const n=this._buffer.get(t);0===n.length?this._disableCurrentCues():this._displayCues(n)}}var Bg=Ug;function Gg(e){return void 0===e.extent&&void 0===e.origin&&void 0===e.displayAlign&&void 0===e.display&&void 0===e.textAlign&&void 0===e.fontSize}function jg(e){e.extent="70% 20%",e.fontSize="1c",e.origin="15% 80%",e.displayAlign="before",e.textAlign="center"}let Vg;function Hg(e,t){if(void 0===Vg&&(Vg=void 0!==e.classList&&"function"===typeof e.classList.add),Vg)e.classList.add(t);else{const n=" "+e.className+" ";n.indexOf(" "+t+" ")<0&&(e.className+=" "+t)}}function Kg(e,t){const n=t.trim();if("auto"===n)return;const i=n.split(" ");if(2!==i.length)return;const r=Ep.exec(i[0]),a=Ep.exec(i[1]);null!==r&&null!==a&&("px"===r[2]||"%"===r[2]||"em"===r[2]?e.style.width=r[1]+r[2]:"c"===r[2]?(Hg(e,"proportional-style"),e.setAttribute("data-proportional-width",r[1])):j.warn("TTML Parser: unhandled extent unit:",r[2]),"px"===a[2]||"%"===a[2]||"em"===a[2]?e.style.height=a[1]+a[2]:"c"===a[2]?(Hg(e,"proportional-style"),e.setAttribute("data-proportional-height",a[1])):j.warn("TTML Parser: unhandled extent unit:",a[2]))}function zg(e,t){const n=t.trim(),i=n.split(" ");if(0===i.length)return;const r=Ep.exec(i[0]);if(null!==r)if("px"===r[2]||"em"===r[2])e.style.fontSize=r[1]+r[2];else if("c"===r[2])e.style.position="relative",Hg(e,"proportional-style"),e.setAttribute("data-proportional-font-size",r[1]);else if("%"===r[2]){const t=Number(r[1]);isNaN(t)?j.warn('TTML Parser: could not parse fontSize value "'+r[1]+'" into a number'):(e.style.position="relative",Hg(e,"proportional-style"),e.setAttribute("data-proportional-font-size",String(t/100)))}else j.warn("TTML Parser: unhandled fontSize unit:",r[2])}function Zg(e,t){const n=t.trim(),i=n.split(" ");if("auto"===n)return;const r=Ep.exec(i[0]);null!==r&&("px"===r[2]||"%"===r[2]||"em"===r[2]?e.style.lineHeight=r[1]+r[2]:"c"===r[2]?(Hg(e,"proportional-style"),e.setAttribute("data-proportional-line-height",r[1])):j.warn("TTML Parser: unhandled lineHeight unit:",r[2]))}function qg(e,t){const n=t.trim();if("auto"===n)return;const i=n.split(" ");if(2!==i.length)return;const r=Ep.exec(i[0]),a=Ep.exec(i[1]);null!==r&&null!==a&&("px"===r[2]||"%"===r[2]||"em"===r[2]?e.style.left=r[1]+r[2]:"c"===r[2]?(Hg(e,"proportional-style"),e.setAttribute("data-proportional-left",r[1])):j.warn("TTML Parser: unhandled origin unit:",r[2]),"px"===a[2]||"%"===a[2]||"em"===a[2]?e.style.top=a[1]+a[2]:"c"===a[2]?(Hg(e,"proportional-style"),e.setAttribute("data-proportional-top",a[1])):j.warn("TTML Parser: unhandled origin unit:",a[2]))}function Yg(e,t){const n=t.trim(),i=n.split(" ");if(i.length<1)return;const r=Ep.exec(i[0]);if(null===r)return;if("px"===r[2]||"%"===r[2]||"em"===r[2]){const t=r[1]+r[2];1===i.length?e.style.padding=t:2===i.length?(e.style.paddingTop=t,e.style.paddingBottom=t):e.style.paddingTop=t}else"c"===r[2]?(Hg(e,"proportional-style"),1===i.length?(e.setAttribute("data-proportional-padding-top",r[1]),e.setAttribute("data-proportional-padding-bottom",r[1]),e.setAttribute("data-proportional-padding-left",r[1]),e.setAttribute("data-proportional-padding-right",r[1])):2===i.length?(e.setAttribute("data-proportional-padding-top",r[1]),e.setAttribute("data-proportional-padding-bottom",r[1])):e.setAttribute("data-proportional-padding-top",r[1])):j.warn("TTML Parser: unhandled padding unit:",r[2]);if(1===i.length)return;const a=Ep.exec(i[1]);if(null===a)return;if("px"===a[2]||"%"===a[2]||"em"===a[2]){const t=a[1]+a[2];i.length<4?(e.style.paddingLeft=t,e.style.paddingRight=t):e.style.paddingRight=t}else"c"===a[2]?(Hg(e,"proportional-style"),i.length<4?(e.setAttribute("data-proportional-padding-left",a[1]),e.setAttribute("data-proportional-padding-right",a[1])):e.setAttribute("data-proportional-padding-right",a[1])):j.warn("TTML Parser: unhandled padding unit:",a[2]);if(2===i.length)return;const o=Ep.exec(i[2]);if(null===o)return;if("px"===o[2]||"%"===o[2]||"em"===o[2]){const t=o[1]+o[2];e.style.paddingBottom=t}else"c"===o[2]?(Hg(e,"proportional-style"),e.setAttribute("data-proportional-padding-bottom",o[1])):j.warn("TTML Parser: unhandled padding unit:",o[2]);if(3===i.length)return;const s=Ep.exec(i[3]);if(null!==s)if("px"===s[2]||"%"===s[2]||"em"===s[2]){const t=s[1]+s[2];e.style.paddingLeft=t}else"c"===s[2]?(Hg(e,"proportional-style"),e.setAttribute("data-proportional-padding-left",s[1])):j.warn("TTML Parser: unhandled padding unit:",s[2])}function Wg(e,t){let n=t;return Nt(t)&&t.trim().endsWith("%")&&(n=t.trim().slice(0,-1),n=(parseInt(n,10)/100).toString()+"em"),`-1px -1px ${n} ${e},`+`1px -1px ${n} ${e},`+`-1px 1px ${n} ${e},`+`1px 1px ${n} ${e}`}function $g(e){let t;return t=Tp.exec(e),r(t)?(t=Sp.exec(e),r(t)?(t=wp.exec(e),r(t)?(t=Ap.exec(e),r(t)?e:"rgba("+String(+t[1])+","+String(+t[2])+","+String(+t[3])+","+String(+t[4]/255)+")"):"rgb("+String(+t[1])+","+String(+t[2])+","+String(+t[3])+")"):"rgba("+String(parseInt(t[1]+t[1],16))+","+String(parseInt(t[2]+t[2],16))+","+String(parseInt(t[3]+t[3],16))+","+String(parseInt(t[4]+t[4],16)/255)+")"):"rgba("+String(parseInt(t[1],16))+","+String(parseInt(t[2],16))+","+String(parseInt(t[3],16))+","+String(parseInt(t[4],16)/255)+")"}const Xg=["color","direction","display","fontFamily","fontSize","fontStyle","fontWeight","textDecoration","textOutline","unicodeBidi","visibility","wrapOption"];function Qg(e,t,n){const i=t.color;Nt(i)&&(e.style.color=$g(i));const r=t.backgroundColor;Nt(r)&&(e.style.backgroundColor=$g(r));const a=t.textOutline;if(Nt(a)){const t=a.trim().replace(/\s+/g," ").split(" "),n=t.length;if(3===n){const n=$g(t[0]),i=t[1];e.style.textShadow=Wg(n,i)}else if(Nt(i)&&1===n){const n=t[0];e.style.textShadow=Wg(i,n)}else if(2===n){const n=/^[#A-Z]/i.test(t[0]),r=/^[0-9]/.test(t[0]);if(n!==r)if(n){const n=$g(t[0]),i=t[1];e.style.textShadow=Wg(n,i)}else if(Nt(i)){const n=t[0];e.style.textShadow=Wg(i,n)}}}const o=t.textDecoration;if(Nt(o))switch(o){case"noUnderline":case"noLineThrough":case"noOverline":e.style.textDecoration="none";break;case"lineThrough":e.style.textDecoration="line-through";break;default:e.style.textDecoration=o;break}const s=t.fontFamily;if(Nt(s))switch(s){case"proportionalSansSerif":e.style.fontFamily="Arial, Helvetica, Liberation Sans, sans-serif";break;case"monospaceSansSerif":case"sansSerif":e.style.fontFamily="sans-serif";break;case"monospaceSerif":case"default":e.style.fontFamily="Courier New, Liberation Mono, monospace";break;case"proportionalSerif":e.style.fontFamily="serif";break;default:e.style.fontFamily=s}const l=t.fontStyle;Nt(l)&&(e.style.fontStyle=l);const u=t.fontWeight;Nt(u)&&(e.style.fontWeight=u);const c=t.fontSize;Nt(c)?zg(e,c):(Hg(e,"proportional-style"),e.setAttribute("data-proportional-font-size","1"));const d=t.direction;Nt(d)&&(e.style.direction=d);const f=t.unicodeBidi;if(Nt(f))switch(f){case"bidiOverride":e.style.unicodeBidi="bidi-override";break;case"embed":e.style.unicodeBidi="embed";break;default:e.style.unicodeBidi="normal"}const h=t.visibility;Nt(h)&&(e.style.visibility=h);const p=t.display;"none"===p&&(e.style.display="none");const g=t.wrapOption;e.style.whiteSpace="noWrap"===g?n?"nowrap":"pre":n?"normal":"pre-wrap"}function Jg(e,t){e.style.color="white",e.style.position="absolute";const n=t.extent;Nt(n)&&Kg(e,n);const i=t.writingMode;Nt(i);const r=t.overflow;e.style.overflow=Nt(r)?r:"hidden";const a=t.padding;Nt(a)&&Yg(e,a);const o=t.origin;Nt(o)&&qg(e,o);const s=t.displayAlign;if(Nt(s))switch(e.style.display="flex",e.style.flexDirection="column",s){case"before":e.style.justifyContent="flex-start";break;case"center":e.style.justifyContent="center";break;case"after":e.style.justifyContent="flex-end";break}const l=t.opacity;Nt(l)&&(e.style.opacity=l);const u=t.visibility;Nt(u)&&(e.style.visibility=u);const c=t.display;"none"===c&&(e.style.display="none")}function em(e,t){e.style.margin="0px",Hg(e,"proportional-style"),e.setAttribute("data-proportional-font-size","1");const n=t.backgroundColor;Nt(n)&&(e.style.backgroundColor=$g(n));const i=t.lineHeight;Nt(i)&&Zg(e,i);const r=t.textAlign;if(Nt(r))switch(r){case"center":e.style.textAlign="center";break;case"left":case"start":e.style.textAlign="left";break;case"right":case"end":e.style.textAlign="right";break}}function tm(e,t,n){const i=document.createElement("span");let r=null===e.textContent?"":e.textContent;if(n){let e=r.trim();e=e.replace(/\s+/g," "),r=e}const a=document.createTextNode(r);return i.appendChild(a),i.className="rxp-texttrack-span",Qg(i,t,n),i}function nm(e,t,n,i,r){function a(e,i,r,o){const s=e.childNodes,l=[];for(let u=0;u<s.length;u++){const e=s[u];if("#text"===e.nodeName){const{backgroundColor:a}=Jh(["backgroundColor"],r,n,t);Nt(a)?i.backgroundColor=a:delete i.backgroundColor;const s=tm(e,i,o);l.push(s)}else if(lp(e)){const e=document.createElement("BR");l.push(e)}else if(up(e)&&e.nodeType===Node.ELEMENT_NODE&&e.childNodes.length>0){const s=e.getAttribute("xml:space"),u=Nt(s)?"default"===s:o,c=k({},i,Jh(Xg,[e],n,t));l.push(...a(e,c,[e,...r],u))}}return l}return a(e,k({},i),[],r)}function im(e,t,n,i,r,{cellResolution:a,shouldTrimWhiteSpace:o}){const s=ip(e),l=document.createElement("DIV");if(l.className="rxp-texttrack-region",l.setAttribute("data-resolution-columns",String(a.columns)),l.setAttribute("data-resolution-rows",String(a.rows)),Jg(l,r),null!==t){const{bodyBackgroundColor:e}=Jh(["backgroundColor"],[...s,t],i,n);Nt(e)&&(l.style.backgroundColor=$g(e))}const u=document.createElement("p");u.className="rxp-texttrack-p",em(u,r);const c=nm(e,n,i,r,o);for(let d=0;d<c.length;d++)u.appendChild(c[d]);return l.appendChild(u),l}function rm(e){const{paragraph:t,ttParams:n,body:i,regionStyles:r,idStyles:a,paragraphStyle:o,timeOffset:s,shouldTrimWhiteSpace:l}=e;if(!t.hasAttribute("begin")&&!t.hasAttribute("end")&&/^\s*$/.test(null===t.textContent?"":t.textContent))return null;const{cellResolution:u}=n,{start:c,end:d}=Mp(t,n),f=im(t,i,r,a,o,{cellResolution:u,shouldTrimWhiteSpace:l});return{start:c+s,end:d+s,element:f}}function am(e,t){const n=dp(e,t),i=[];for(let r=0;r<n.length;r++){const{paragraphStyle:e}=n[r];Gg(e)&&jg(e);const t=rm(n[r]);null!==t&&i.push(t)}return i}var om=am;function sm(e){e.htmlTextTracksParsers.ttml=om,e.htmlTextDisplayer=Bg}const lm=/&#([0-9]+);/g,um=/<br>/gi,cm=/<style[^>]*>([\s\S]*?)<\/style[^>]*>/i,dm=/\s*<p (?:class=([^>]+))?>(.*)/i,fm=/<sync[^>]+?start="?([0-9]*)"?[^0-9]/i;function hm(e){const t=/\.(\S+)\s*{([^}]*)}/gi,n={};let i=t.exec(e);while(null!==i){const a=i[1],o=gm(i[2],"lang");r(a)||r(o)||(n[o]=a),i=t.exec(e)}return n}function pm(e){const t=/p\s*{([^}]*)}/gi,n=t.exec(e);return null===n?"":n[1]}function gm(e,t){const n=new RegExp("\\s*"+t+":\\s*(\\S+);","i").exec(e);return Array.isArray(n)?n[1]:null}function mm(e){return e.replace(lm,(e,t)=>String.fromCharCode(Number(t)))}function vm(e,t,n){const i=/<sync[ >]/gi,r=/<sync[ >]|<\/body>/gi,a=[],o=cm.exec(e),s=Array.isArray(o)?o[1]:"";let l,u;r.exec(e);const c=hm(s),d=pm(s);let f;if(Nt(n)&&(f=c[n],void 0===f))throw new Error(`sami: could not find lang ${n} in CSS`);while(1){if(l=i.exec(e),u=r.exec(e),null===l&&null===u)break;if(null===l||null===u||l.index>=u.index)throw new Error("parse error");const t=e.slice(l.index,u.index),n=fm.exec(t);if(!Array.isArray(n))throw new Error("parse error (sync time attribute)");const a=+n[1];if(isNaN(a))throw new Error("parse error (sync time attribute NaN)");h(t.split("\n"),a/1e3)}return a;function h(e,n){let i=e.length;while(--i>=0){const r=dm.exec(e[i]);if(!Array.isArray(r))continue;const[,o,s]=r;if(f===o)if("&nbsp;"===s)a[a.length-1].end=n;else{const e=document.createElement("DIV");e.className="rxp-texttrack-region";const i=document.createElement("DIV");i.className="rxp-texttrack-div",i.style.position="absolute",i.style.bottom="0",i.style.width="100%",i.style.color="#fff",i.style.textShadow="-1px -1px 0 #000,1px -1px 0 #000,-1px 1px 0 #000,1px 1px 0 #000";const r=document.createElement("div");r.className="rxp-texttrack-p",Nt(d)&&(r.style.cssText=d);const o=s.split(um);for(let t=0;t<o.length;t++){0!==t&&r.appendChild(document.createElement("BR"));const e=document.createElement("SPAN");e.className="rxp-texttrack-span",e.textContent=mm(o[t]),r.appendChild(e)}i.appendChild(r),e.appendChild(i),a.push({element:e,start:n+t,end:-1})}}}}var ym=vm;function _m(e){e.htmlTextTracksParsers.sami=ym,e.htmlTextDisplayer=Bg}function bm(e,t){const n=[];for(let i=t;i<e.length;i++)if(eg(e,i)){const t=i;i++;while(Nt(e[i]))i++;const r=e.slice(t,i);n.push(r)}else if(Nt(e[i]))while(Nt(e[i]))i++;return n}const Em={white:"#ffffff",lime:"#00ff00",cyan:"#00ffff",red:"#ff0000",yellow:"#ffff00",magenta:"#ff00ff",blue:"#0000ff",black:"#000000"};function Tm(){return Object.keys(Em).reduce((e,t)=>{return e[t]=`color: ${Em[t]};`,e[`bg_${t}`]=`background-color: ${Em[t]};`,e},{})}function Sm(e){const t=Tm();let n="";return e.forEach(e=>{if(e.length>=2)for(let i=1;i<e.length;i++){let r=e[i];if(Array.isArray(/::cue {/.exec(r))){r=e[++i];while(Nt(r)&&!Array.isArray(/}/.exec(r))&&0!==r.length)n+=r,r=e[++i]}else{const n=[];let a=/::cue\(\.?(.*?)\)(?:,| {)/.exec(r);while(Nt(r)&&Array.isArray(a))n.push(a[1]),r=e[++i],a=/::cue\(\.?(.*?)\)(?:,| {)/.exec(r);let o="";while(Nt(r)&&!Array.isArray(/}/.exec(r))&&0!==r.length)o+=r,r=e[++i];n.forEach(e=>{const n=t[e];void 0===n?t[e]=o:t[e]+=o})}}}),{classes:t,global:n}}function wm(e,t){const n=["u","i","b"],i=["u","i","b","c","#text"],r=e.nodeName.toLowerCase().split(".")[0];let a;if(gt(i,r))if("#text"===r){const t=e.wholeText.split("\n");a=document.createElement("span");for(let e=0;e<t.length;e++)if(e>0&&a.appendChild(document.createElement("br")),t[e].length>0){const n=document.createTextNode(t[e]);a.appendChild(n)}}else{const i=e.nodeName.toLowerCase().split("."),o=[];if(i.forEach(e=>{Nt(t[e])&&o.push(t[e])}),0!==o.length){const e=document.createAttribute("style");o.forEach(t=>{e.value+=t});const t=gt(n,r)?r:"span";a=document.createElement(t),a.setAttributeNode(e)}else{const e=gt(n,r)?r:"span";a=document.createElement(e)}for(let n=0;n<e.childNodes.length;n++){const i=wm(e.childNodes[n],t);a.appendChild(i)}}else{a=document.createElement("span");for(let n=0;n<e.childNodes.length;n++){const i=wm(e.childNodes[n],t);a.appendChild(i)}}return a}function Am(e,t){const n=e.replace(/<[0-9]{2}:[0-9]{2}.[0-9]{3}>/,"").replace(/<([u,i,b,c])(\..*?)?(?: .*?)?>(.*?)<\/\1>/g,"<$1$2>$3</$1$2>"),i=(new DOMParser).parseFromString(n,"text/html"),r=i.body.childNodes,a=[];for(let o=0;o<r.length;o++)a.push(wm(r[o],t));return a}function Im(e){const t=document.createAttribute("style");return t.value=xm(e),t}const xm=e=>{const t=void 0!==e&&0!==Ze(e).length;if(!t)return"text-align:center";const n=km(e),i=Pm(e);return"position: absolute;margin: 0;"+`transform: translate(${n.offset}%,${i.offset}%);`+`width: ${Um(e.size)}%;`+`left: ${n.position}%;`+`top: ${null!==i.position?`${i.position}%`:"auto"};`+`text-align: ${Fm(e.align)};`};var Rm,Cm,Dm;(function(e){e["LINE_LEFT"]="line-left",e["CENTER"]="center",e["LINE_RIGHT"]="line-right"})(Rm||(Rm={})),function(e){e["LEFT"]="left",e["CENTER"]="center",e["RIGHT"]="right"}(Cm||(Cm={})),function(e){e["START"]="start",e["CENTER"]="center",e["END"]="end"}(Dm||(Dm={}));const km=e=>{return{position:Mm(e),offset:Lm(e)}},Mm=e=>{const t=Gm(e.position);if(null!==t)return t;const n=Fm(e.align),i={[Cm.LEFT]:0,[Cm.CENTER]:50,[Cm.RIGHT]:100};return i[n]},Lm=e=>{const t=e=>{const t=/,(line-left|line-right|center)/,n=t.exec(e);return!Array.isArray(n)||n.length<2?null:n[1]},n={[Rm.LINE_LEFT]:0,[Rm.CENTER]:-50,[Rm.LINE_RIGHT]:-100},i=void 0!==e.position?t(e.position):null;if(null!==i)return n[i];const r={[Cm.LEFT]:0,[Cm.CENTER]:-50,[Cm.RIGHT]:-100},a=void 0!==e.align?Fm(e.align):Cm.CENTER;return r[a]},Pm=e=>{return{position:Nm(e.line),offset:Om(e.line)}},Nm=e=>{return Gm(e)},Om=e=>{const t=e=>{const t=/,(start|center|end)/,n=t.exec(e);return!Array.isArray(n)||n.length<2?null:n[1]},n={[Dm.START]:0,[Dm.CENTER]:-50,[Dm.END]:-100};if(void 0===e)return n[Dm.START];const i=t(e);return null!==i?n[i]:n[Dm.START]},Fm=e=>{switch(e){case"left":case"start":return"left";case"right":case"end":return"right";default:return"center"}},Um=e=>{const t=100;return Bm(e,t)},Bm=(e,t)=>{const n=Gm(e);return null!==n?n:t},Gm=e=>{if(void 0===e)return null;const t=/^([\d.]+)%/,n=t.exec(e);return!Array.isArray(n)||n.length<2?null:parseInt(n[1],10)};function jm(e,t){const{start:n,end:i,settings:r,header:a,payload:o}=e,s=document.createElement("div"),l=document.createAttribute("style");l.value="width:100%;height:100%;display:flex;flex-direction:column;justify-content:flex-end;align-items:center;",s.setAttributeNode(l);const u=document.createElement("p"),c=Im(r);u.setAttributeNode(c);const d=document.createElement("span"),f=document.createAttribute("style");f.value="background-color:rgba(0,0,0,0.8);color:white;",d.setAttributeNode(f);const{global:h,classes:p}=t,g=Nt(a)?p[a]:void 0,m=[h,g].filter(e=>void 0!==e).join("");return f.value+=m,d.setAttributeNode(f),Am(o.join("\n"),p).forEach(e=>{d.appendChild(e)}),s.appendChild(u),u.appendChild(d),{start:n,end:i,element:s}}function Vm(e,t){const n=/\r\n|\n|\r/g,i=e.split(n),r=[];if(null===/^WEBVTT( |\t|\n|\r|$)/.exec(i[0]))throw new Error("Can't parse WebVTT: Invalid File.");const a=Jp(i),o=bm(i,a),s=ag(i,a),l=Sm(o);for(let u=0;u<s.length;u++){const e=ug(s[u],t);if(null!==e){const t=jm(e,l);r.push(t)}}return r}var Hm=Vm;function Km(e){e.htmlTextTracksParsers.vtt=Hm,e.htmlTextDisplayer=Bg}function zm(e,t){const n=e.split(/\r\n|\n|\r/),i=mg(n),r=[];for(let a=0;a<i.length;a++){const e=yg(i[a],t);if(null!==e){const t=Zm(e);null!==t&&r.push(t)}}return r}function Zm(e){const{start:t,end:n,payload:i}=e,r=document.createElement("div");r.className="rxp-texttrack-p",r.style.fontSize="28px",r.style.position="absolute",r.style.bottom="5%",r.style.width="100%",r.style.textAlign="center",r.style.color="#fff",r.style.textShadow="-1px -1px 2px #000,1px -1px 2px #000,-1px 1px 2px #000,1px 1px 2px #000";for(let a=0;a<i.length;a++){0!==a&&r.appendChild(document.createElement("br"));const e=qm(i[a]);r.appendChild(e)}return{start:t,end:n,element:r}}function qm(e){const t=document.createElement("div");t.innerHTML=e;const n=function(e){const t=e.childNodes,i=document.createElement("span");i.className="rxp-texttrack-span";for(let r=0;r<t.length;r++){const e=t[r];if("#text"===e.nodeName){const t=e.wholeText.split("\n");for(let e=0;e<t.length;e++)if(0!==e&&i.appendChild(document.createElement("br")),t[e].length>0){const n=document.createTextNode(t[e]);i.appendChild(n)}}else if("B"===e.nodeName){const t=n(e);t.style.fontWeight="bold",i.appendChild(t)}else if("I"===e.nodeName){const t=n(e);t.style.fontStyle="italic",i.appendChild(t)}else if("U"===e.nodeName){const t=n(e);t.style.textDecoration="underline",i.appendChild(t)}else if(Ym(e)&&"string"===typeof e.color){const t=n(e);t.style.color=e.color,i.appendChild(t)}else{const t=n(e);i.appendChild(t)}}return i};return n(t)}function Ym(e){return"FONT"===e.nodeName&&"color"in e}function Wm(e){e.htmlTextTracksParsers.srt=zm,e.htmlTextDisplayer=Bg}function $m(){if(!h)return j.warn("Compat: Can't access Firefox version on no firefox browser."),null;const e=navigator.userAgent,t=/Firefox\/([0-9]+)\./.exec(e);if(null===t)return-1;const n=parseInt(t[1],10);return isNaN(n)?-1:n}function Xm(){if(!h)return!0;const e=$m();if(null===e||e<67)return!0;const t=null===HTMLVideoElement||void 0===HTMLVideoElement?void 0:HTMLVideoElement.prototype;return void 0!==(null===t||void 0===t?void 0:t.requirePictureInPicture)}function Qm(e){const t=e;if("function"===typeof t.getStartDate){const e=t.getStartDate();if("object"===typeof e&&null!==e){const t=+e;if(!isNaN(t))return t/1e3}else if("number"===typeof e&&!isNaN(e))return e}}const Jm="function"===typeof MediaSource&&!0===MediaSource.canConstructInDedicatedWorker;var ev=Jm;function tv(){return T&&"object"===typeof Worker||"function"===typeof Worker}class nv extends Error{constructor(e,t){super(st(e,t)),Object.setPrototypeOf(this,nv.prototype),this.name="WorkerInitializationError",this.type="WORKER_INITIALIZATION_ERROR",this.code=e}}function iv(e){for(let t=0;t<e.length;t++){const n=e[t];if("function"===typeof n)n(zt);else{if(r(n)||"function"!==typeof n._addFeature)throw new Error("Unrecognized feature");n._addFeature(zt)}}}const rv=v;var av=rv;function ov(e,t,n){const i=t(e.getReference(),n);return{getCurrentTime(){return e.getCurrentTime()},getReadyState(){return e.getReadyState()},getPlaybackRate(){return e.getPlaybackRate()},getIsPaused(){return e.getIsPaused()},getReference(){return i},listen(e,t){var r;n.isCancelled()||!0===(null===(r=null===t||void 0===t?void 0:t.clearSignal)||void 0===r?void 0:r.isCancelled())||i.onUpdate(e,{clearSignal:null===t||void 0===t?void 0:t.clearSignal,emitCurrentValue:null===t||void 0===t?void 0:t.includeLastObservation})},deriveReadOnlyObserver(e){return ov(this,e,n)}}}class sv{constructor(e,t){this._last=e,this._wanted=t}serialize(){return[this._last,this._wanted]}getPolled(){return this._last}getWanted(){var e;return null!==(e=this._wanted)&&void 0!==e?e:this._last}forceWantedPosition(e){this._wanted=e}isAwaitingFuturePosition(){return null!==this._wanted}}const lv=["canplay","ended","play","pause","seeking","seeked","loadedmetadata","ratechange"];class uv{constructor(e,t){this._internalSeeksIncoming=[],this._mediaElement=e,this._withMediaSource=t.withMediaSource,this._lowLatencyMode=t.lowLatencyMode,this._canceller=new me,this._observationRef=this._createSharedReference(),this._expectedSeekingPosition=null,this._pendingSeek=null;const n=()=>{if(null!==this._pendingSeek){const e=this._pendingSeek;this._pendingSeek=null,this._actuallySetCurrentTime(e)}};e.addEventListener("loadedmetadata",n),this._canceller.signal.register(()=>{e.removeEventListener("loadedmetadata",n)})}stop(){this._canceller.cancel()}getCurrentTime(){return this._mediaElement.currentTime}getPlaybackRate(){return this._mediaElement.playbackRate}getIsPaused(){return this._mediaElement.paused}setCurrentTime(e){this._mediaElement.readyState>=1?this._actuallySetCurrentTime(e):(this._internalSeeksIncoming=[],this._pendingSeek=e,this._generateObservationForEvent("manual"))}setPlaybackRate(e){this._mediaElement.playbackRate=e}getReadyState(){return this._mediaElement.readyState}getReference(){return this._observationRef}listen(e,t){var n;if(this._canceller.isUsed()||!0===(null===(n=null===t||void 0===t?void 0:t.clearSignal)||void 0===n?void 0:n.isCancelled()))return F;this._observationRef.onUpdate(e,{clearSignal:null===t||void 0===t?void 0:t.clearSignal,emitCurrentValue:null===t||void 0===t?void 0:t.includeLastObservation})}deriveReadOnlyObserver(e){return ov(this,e,this._canceller.signal)}_actuallySetCurrentTime(e){j.info("API: Seeking internally",e),this._internalSeeksIncoming.push(e),this._mediaElement.currentTime=e}_createSharedReference(){if(void 0!==this._observationRef)return this._observationRef;const{SAMPLING_INTERVAL_MEDIASOURCE:e,SAMPLING_INTERVAL_LOW_LATENCY:t,SAMPLING_INTERVAL_NO_MEDIASOURCE:n}=O.getCurrent(),i=new de(this._getCurrentObservation("init"),this._canceller.signal);let r;r=this._lowLatencyMode?t:this._withMediaSource?e:n;const a=()=>{this._generateObservationForEvent("timeupdate")};let o=setInterval(a,r);const s=lv.map(e=>{const t=()=>{l(),this._generateObservationForEvent(e)};return this._mediaElement.addEventListener(e,t),()=>{this._mediaElement.removeEventListener(e,t)}});return this._canceller.signal.register(()=>{clearInterval(o),s.forEach(e=>e()),i.finish()}),i;function l(){clearInterval(o),o=setInterval(a,r)}}_getCurrentObservation(e){var t,n;let i=e;const r=void 0===this._observationRef?mv(this._mediaElement):this._observationRef.getValue();let a=!1,o=this._pendingSeek;const s=fv(this._mediaElement),{buffered:l,readyState:u,position:c,seeking:d}=s;if("seeking"===i)if(this._internalSeeksIncoming.length>0){a=!0,i="internal-seeking";const e=this._internalSeeksIncoming.shift();this._expectedSeekingPosition=av?Math.max(c,null!==e&&void 0!==e?e:0):c}else this._expectedSeekingPosition=c;else d?this._expectedSeekingPosition=Math.max(c,null!==(t=this._expectedSeekingPosition)&&void 0!==t?t:0):av&&null!==this._expectedSeekingPosition&&c<this._expectedSeekingPosition?o=this._expectedSeekingPosition:this._expectedSeekingPosition=null;d&&1===r.seeking&&"seeking"!==e&&(a=!0);const f=null!==(n=this._expectedSeekingPosition)&&void 0!==n?n:c;let h,p;!this._withMediaSource&&0===l.length&&u>=3?(h=void 0,p=void 0):(h=Q(l,f),p=null!==h?h.end-f:1/0);const g=hv({previousObservation:r,currentObservation:s,basePosition:f,observationEvent:i,lowLatencyMode:this._lowLatencyMode,withMediaSource:this._withMediaSource,bufferGap:p,currentRange:h}),m=pv(r,s,i,p);let v;v=a?1:d?2:0;const y=k({},s,{position:new sv(s.position,o),event:i,seeking:v,rebuffering:g,freezing:m,bufferGap:p,currentRange:h});return j.hasLevel("DEBUG")&&j.debug("API: current media element state tick","event",y.event,"position",y.position.getPolled(),"seeking",y.seeking,"internalSeek",a,"rebuffering",null!==y.rebuffering,"freezing",null!==y.freezing,"ended",y.ended,"paused",y.paused,"playbackRate",y.playbackRate,"readyState",y.readyState,"pendingPosition",o),y}_generateObservationForEvent(e){const t=this._getCurrentObservation(e);j.hasLevel("DEBUG")&&j.debug("API: current playback timeline:\n"+gv(t.buffered,t.position.getPolled()),`\n${e}`),this._observationRef.setValue(t)}}function cv(e,t){if(null===e)return 0;const n=t?"LOW_LATENCY":"DEFAULT",{RESUME_GAP_AFTER_SEEKING:i,RESUME_GAP_AFTER_NOT_ENOUGH_DATA:r,RESUME_GAP_AFTER_BUFFERING:a}=O.getCurrent();switch(e.reason){case"seeking":return i[n];case"not-ready":return r[n];case"buffering":return a[n]}}function dv(e,t,n,i,r){const{REBUFFERING_GAP:a}=O.getCurrent(),o=r?"LOW_LATENCY":"DEFAULT";return void 0===t?n&&Math.abs(i-e)<=a[o]:null!==t&&i-t.end<=a[o]}function fv(e){const{buffered:t,currentTime:n,duration:i,ended:r,paused:a,playbackRate:o,readyState:s,seeking:l}=e;return{buffered:t,position:n,duration:i,ended:r,paused:a,playbackRate:o,readyState:s,seeking:l}}function hv({previousObservation:e,currentObservation:t,basePosition:n,observationEvent:i,withMediaSource:r,lowLatencyMode:a,bufferGap:o,currentRange:s}){const{REBUFFERING_GAP:l}=O.getCurrent(),{position:u,duration:c,paused:d,readyState:f,ended:h}=t,{rebuffering:p,event:g,position:m}=e,v=dv(n,s,h,c,a),y=f>=1&&"loadedmetadata"!==i&&null===p&&!(v||h);let _,b,E=null;const T=a?l.LOW_LATENCY:l.DEFAULT;if(r){if(y)o===1/0?(_=!0,E=n):void 0===o?f<3&&(_=!0,E=void 0):o<=T&&(_=!0,E=n+o);else if(null!==p){const e=cv(p,a);!0!==_&&null!==p&&f>1&&(v||h||void 0!==o&&isFinite(o)&&o>e)||void 0===o&&f>=3?b=!0:void 0===o?E=void 0:o===1/0?E=n:o<=e&&(E=n+o)}}else y&&(!d&&"timeupdate"===i&&"timeupdate"===g&&u===m.getPolled()||"seeking"===i&&(o===1/0||void 0===o&&f<3))?_=!0:null!==p&&("seeking"!==i&&u!==m.getPolled()||"canplay"===i||void 0===o&&f>=3||void 0!==o&&o<1/0&&(o>cv(p,a)||v||h))&&(b=!0);if(!0===b)return null;if(!0===_||null!==p){let e;return e="seeking"===i||null!==p&&"seeking"===p.reason?"seeking":t.seeking?"seeking":1===f?"not-ready":"buffering",null!==p&&p.reason===e?{reason:p.reason,timestamp:p.timestamp,position:E}:{reason:e,timestamp:Te(),position:E}}return null}function pv(e,t,n,i){const{MINIMUM_BUFFER_AMOUNT_BEFORE_FREEZING:r}=O.getCurrent();return e.freezing?t.ended||t.paused||0===t.readyState||0===t.playbackRate||e.position.getPolled()!==t.position?null:e.freezing:"timeupdate"===n&&void 0!==i&&i>r&&!t.ended&&!t.paused&&t.readyState>=1&&0!==t.playbackRate&&t.position===e.position.getPolled()?{timestamp:Te()}:null}function gv(e,t){let n="",i="";for(let r=0;r<e.length;r++){const a=e.start(r),o=e.end(r),s=a.toFixed(2),l=o.toFixed(2),u=(o-a).toFixed(2),c=`${s}|==${u}==|${l}`;if(n+=c,0===i.length&&o>t){const e=n.length-Math.floor(c.length/2);i=" ".repeat(e)+`^${t}`}if(r<e.length-1){const a=e.start(r+1),s=(a-o).toFixed(2),l=` ~${s}~ `;if(n+=l,0===i.length&&t<a){const e=n.length-Math.floor(l.length/2);i=" ".repeat(e)+`^${t}`}}}return 0===i.length&&(i=" ".repeat(n.length)+`^${t}`),n+"\n"+i}function mv(e){const t=fv(e);return k(t,{rebuffering:null,event:"init",seeking:0,position:new sv(t.position,null),freezing:null,bufferGap:0,currentRange:null})}async function vv(e){const t=or.getState(e);if(null===t)return;j.info("DRM: Disposing of the current MediaKeys");const{loadedSessionsStore:n}=t;return or.clearState(e),await n.closeAllSessions(),Rf(t.emeImplementation,e,null)}function yv(){return d}function _v(e){if(j.info("DRM: Clearing-up DRM session."),yv())return j.info("DRM: disposing current MediaKeys."),vv(e);const t=or.getState(e);return null!==t&&!0===t.keySystemOptions.closeSessionsOnStop?(j.info("DRM: closing all current sessions."),t.loadedSessionsStore.closeAllSessions()):(j.info("DRM: Nothing to clear. Returning right away. No state =",null===t),Promise.resolve())}class bv extends a{constructor(e){super(),this._canceller=new me,this._adaptationRef=e,this._updateToken=!1,this.refresh=F}start(e){if(this._updateToken=!0,null===e)return this._lastEmitted=null,this._updateToken=!1,void this._adaptationRef.setValue(null);const t=this._constructLockedRepresentationsReference(e);this._updateToken&&(this._lastEmitted={adaptation:e.adaptation,switchingMode:e.switchingMode,lockedRepresentations:null},this._updateToken=!1,this._adaptationRef.setValue({adaptationId:e.adaptation.id,switchingMode:e.switchingMode,representations:t,relativeResumingPosition:void 0}))}updateTrack(e){if(this._updateToken=!0,null===e){if(null===this._lastEmitted)return;return this._updateToken=!1,this._canceller.cancel(),this._canceller=new me,this._lastEmitted=null,void this._adaptationRef.setValue(null)}const{adaptation:t,switchingMode:n,relativeResumingPosition:i}=e;this._canceller.cancel(),this._canceller=new me;const r=this._constructLockedRepresentationsReference(e);this._updateToken&&(this._lastEmitted={adaptation:t,switchingMode:n,lockedRepresentations:null},this._updateToken=!1,this._adaptationRef.setValue({adaptationId:t.id,switchingMode:n,representations:r,relativeResumingPosition:i}))}_constructLockedRepresentationsReference(e){const t=new de({representationIds:[],switchingMode:"lazy"}),n=this;return this.refresh=i,this._canceller.signal.register(r),e.lockedRepresentations.onUpdate(i,{clearSignal:this._canceller.signal,emitCurrentValue:!1}),i(),t;function i(){const i=e.lockedRepresentations.getValue();let r,a;if(null===i)a=e.adaptation.representations.filter(e=>{return!0===e.isSupported&&!1!==e.decipherable}),r="lazy";else{const{representationIds:t}=i;r=i.switchingMode;const o=e.adaptation.representations.filter(e=>gt(t,e.id));if(a=o.filter(e=>!0===e.isSupported&&!1!==e.decipherable),0===a.length)return void n.trigger("noPlayableLockedRepresentation",null)}if(a.length<=0)return e.adaptation.isSupported=!1,void n.trigger("noPlayableRepresentation",null);const o=t.getValue(),s=a.map(e=>e.id).slice().sort();if(s.length===o.representationIds.length){for(let e=0;e<s.length;e++)if(o.representationIds[e]!==s[e])return void t.setValue({representationIds:s,switchingMode:r})}else t.setValue({representationIds:s,switchingMode:r})}function r(){n.refresh=F}}dispose(){this.removeEventListener(),this._canceller.cancel(),this._adaptationRef.finish()}}class Ev extends a{constructor(e){var t;super(),this._storedPeriodInfo=[],this._isDisposed=!1,this._cachedPeriodInfo=new WeakMap,this._isTrickModeTrackEnabled=e.preferTrickModeTracks,this._defaultAudioTrackSwitchingMode=null!==(t=e.defaultAudioTrackSwitchingMode)&&void 0!==t?t:O.getCurrent().DEFAULT_AUDIO_TRACK_SWITCHING_MODE}getAvailablePeriods(){return this._storedPeriodInfo.reduce((e,t)=>{return t.isPeriodAdvertised&&e.push(xv(t.period)),e},[])}onManifestUpdate(e){var t,n,i,r,a,o;const{DEFAULT_VIDEO_TRACK_SWITCHING_MODE:s}=O.getCurrent(),{periods:l}=e;const u=[];let c=0;for(let d=0;d<this._storedPeriodInfo.length;d++){const e=this._storedPeriodInfo[d].period,r=l[c];if(void 0===r)for(let t=this._storedPeriodInfo.length-1;t>=d;t--)this._storedPeriodInfo[t].inManifest=!1,wv(this._storedPeriodInfo[t])&&this._removePeriodObject(t);else if(e===r){c++;const e=this._storedPeriodInfo[d].text.storedSettings;if(null!==e){const n=St(r,"text"),i=n.some(t=>t.id===e.adaptation.id);if(!i){j.warn("TS: Chosen text Adaptation not available anymore");const e=this._storedPeriodInfo[d];if(e.text.storedSettings=null,this.trigger("trackUpdate",{period:xv(r),trackType:"text",reason:"missing"}),this._isDisposed)return;const n=Sv(this._storedPeriodInfo,e.period.id);void 0!==n&&null===n.text.storedSettings&&(null===(t=n.text.dispatcher)||void 0===t||t.updateTrack(null))}}const a=this._storedPeriodInfo[d].video.storedSettings;if(null!==a){const e=St(r,"video"),t=e.some(e=>e.id===a.adaptation.id);if(!t){j.warn("TS: Chosen video Adaptation not available anymore");const t=this._storedPeriodInfo[d];let i;if(0===e.length)i=null;else{const t=e[0],n=Av(t,this._isTrickModeTrackEnabled),r=new de(null);i={adaptationBase:t,adaptation:n,switchingMode:s,lockedRepresentations:r}}if(t.video.storedSettings=i,this.trigger("trackUpdate",{period:xv(r),trackType:"video",reason:"missing"}),this._isDisposed)return;const a=Sv(this._storedPeriodInfo,t.period.id);void 0!==a&&a.video.storedSettings===i&&(null===(n=a.video.dispatcher)||void 0===n||n.updateTrack(i))}}const o=this._storedPeriodInfo[d].audio.storedSettings;if(null!==o){const e=St(r,"audio"),t=e.some(e=>e.id===o.adaptation.id);if(!t){j.warn("TS: Chosen audio Adaptation not available anymore");const t=this._storedPeriodInfo[d],n=0===e.length?null:{adaptation:e[0],switchingMode:this._defaultAudioTrackSwitchingMode,lockedRepresentations:new de(null)};if(t.audio.storedSettings=n,this.trigger("trackUpdate",{period:xv(r),trackType:"audio",reason:"missing"}),this._isDisposed)return;const a=Sv(this._storedPeriodInfo,t.period.id);void 0!==a&&a.audio.storedSettings===n&&(null===(i=a.audio.dispatcher)||void 0===i||i.updateTrack(n))}}}else if(e.start<=r.start)this._storedPeriodInfo[d].inManifest=!1,wv(this._storedPeriodInfo[d])&&(this._removePeriodObject(d),d--);else{const e=Iv(r,!0,this._isTrickModeTrackEnabled,this._defaultAudioTrackSwitchingMode);this._storedPeriodInfo.splice(d,0,e),u.push(e),c++}}if(c<l.length){const e=l.slice(c).map(e=>Iv(e,!0,this._isTrickModeTrackEnabled,this._defaultAudioTrackSwitchingMode));this._storedPeriodInfo.push(...e),u.push(...e)}for(const d of this._storedPeriodInfo)null===(r=d.audio.dispatcher)||void 0===r||r.refresh(),null===(a=d.video.dispatcher)||void 0===a||a.refresh(),null===(o=d.text.dispatcher)||void 0===o||o.refresh()}onDecipherabilityUpdates(){var e,t,n;for(const i of this._storedPeriodInfo)null===(e=i.audio.dispatcher)||void 0===e||e.refresh(),null===(t=i.video.dispatcher)||void 0===t||t.refresh(),null===(n=i.text.dispatcher)||void 0===n||n.refresh()}addTrackReference(e,t,n){let i=Sv(this._storedPeriodInfo,t.id);if(void 0===i){i=Iv(t,!1,this._isTrickModeTrackEnabled,this._defaultAudioTrackSwitchingMode);let e=!1;for(let n=0;n<this._storedPeriodInfo.length;n++)this._storedPeriodInfo[n].period.start>t.start&&(this._storedPeriodInfo.splice(n,0,i),e=!0);e||this._storedPeriodInfo.push(i)}if(!i.isPeriodAdvertised&&(i.isPeriodAdvertised=!0,this.trigger("newAvailablePeriods",[{id:t.id,start:t.start,end:t.end}]),this._isDisposed))return;if(null!==i[e].dispatcher)return void j.error(`TS: Subject already added for ${e} `+`and Period ${t.start}`);const a=i[e].storedSettings,o=new bv(n);i[e].dispatcher=o,o.addEventListener("noPlayableRepresentation",()=>{var n,i,a,o;const s=De(null!==(n=t.adaptations[e])&&void 0!==n?n:[],e=>{if(!1===e.isSupported)return!1;const t=e.representations.filter(e=>!0===e.isSupported&&!1!==e.decipherable);return t.length>0});if(void 0===s){const t=new ut("NO_PLAYABLE_REPRESENTATION",`No ${e} Representation can be played`,{tracks:void 0});return this.trigger("error",t),void this.dispose()}let l=null===(i=Sv(this._storedPeriodInfo,t.id))||void 0===i?void 0:i[e];if(r(l))return;const u="audio"===e?this._defaultAudioTrackSwitchingMode:"reload",c={adaptation:s,switchingMode:u,lockedRepresentations:new de(null)};l.storedSettings=c,this.trigger("trackUpdate",{period:xv(t),trackType:e,reason:"no-playable-representation"}),this._isDisposed||(l=null===(a=Sv(this._storedPeriodInfo,t.id))||void 0===a?void 0:a[e],r(l)||l.storedSettings!==c||null===(o=l.dispatcher)||void 0===o||o.updateTrack(c))}),o.addEventListener("noPlayableLockedRepresentation",()=>{null===a||void 0===a||a.lockedRepresentations.setValue(null),this.trigger("brokenRepresentationsLock",{period:{id:t.id,start:t.start,end:t.end},trackType:e})}),o.start(a)}removeTrackReference(e,t){const n=Tv(this._storedPeriodInfo,t);if(void 0===n)return void j.warn(`TS: ${e} not found for period`,t.start);const i=this._storedPeriodInfo[n],r=i[e];null!==(null===r||void 0===r?void 0:r.dispatcher)?(r.dispatcher.dispose(),r.dispatcher=null,wv(i)&&this._removePeriodObject(n)):j.warn(`TS: TrackDispatcher already removed for ${e} `+`and Period ${t.start}`)}getPeriodObjectFromPeriod(e){const t=Sv(this._storedPeriodInfo,e.id);return void 0===t&&void 0!==e?this._cachedPeriodInfo.get(e):t}getPeriodObjectFromId(e){return Sv(this._storedPeriodInfo,e)}disableVideoTrickModeTracks(){this._isTrickModeTrackEnabled&&(this._isTrickModeTrackEnabled=!1,this._resetVideoTrackChoices("trickmode-disabled"))}enableVideoTrickModeTracks(){this._isTrickModeTrackEnabled||(this._isTrickModeTrackEnabled=!0,this._resetVideoTrackChoices("trickmode-enabled"))}resetPeriodObjects(){var e,t,n;for(let i=this._storedPeriodInfo.length-1;i>=0;i--){const r=this._storedPeriodInfo[i];null===(e=r.audio.dispatcher)||void 0===e||e.dispose(),r.audio.dispatcher=null,null===(t=r.video.dispatcher)||void 0===t||t.dispose(),r.video.dispatcher=null,null===(n=r.text.dispatcher)||void 0===n||n.dispose(),r.text.dispatcher=null,r.inManifest||this._removePeriodObject(i)}}isTrickModeEnabled(){return this._isTrickModeTrackEnabled}setAudioTrack(e){const{periodRef:t,trackId:n,switchingMode:i,lockedRepresentations:r,relativeResumingPosition:a}=e;return this._setAudioOrTextTrack({bufferType:"audio",periodRef:t,trackId:n,switchingMode:null!==i&&void 0!==i?i:this._defaultAudioTrackSwitchingMode,lockedRepresentations:r,relativeResumingPosition:a})}setTextTrack(e,t){return this._setAudioOrTextTrack({bufferType:"text",periodRef:e,trackId:t,switchingMode:"direct",lockedRepresentations:null,relativeResumingPosition:void 0})}_setAudioOrTextTrack({bufferType:e,periodRef:t,trackId:n,switchingMode:i,lockedRepresentations:r,relativeResumingPosition:a}){var o,s;const l=t.period,u=De(null!==(o=l.adaptations[e])&&void 0!==o?o:[],({id:e,isSupported:t})=>!0===t&&e===n);if(void 0===u)throw new Error(`Wanted ${e} track not found.`);const c=t[e];let d;if(null===r)d=new de(null);else{const t=this._getRepresentationsToLock(u,r),n="audio"===e?this._defaultAudioTrackSwitchingMode:"direct";d=new de({representationIds:t,switchingMode:n})}const f={adaptation:u,switchingMode:i,lockedRepresentations:d,relativeResumingPosition:a};if(c.storedSettings=f,this.trigger("trackUpdate",{period:xv(l),trackType:e,reason:"manual"}),this._isDisposed)return;const h=Sv(this._storedPeriodInfo,l.id);void 0!==h&&h[e].storedSettings===f&&(null===(s=h[e].dispatcher)||void 0===s||s.updateTrack(f))}setVideoTrack(e){var t,n;const{periodRef:i,trackId:r,switchingMode:a,lockedRepresentations:o,relativeResumingPosition:s}=e,l=i.period,u=De(null!==(t=l.adaptations.video)&&void 0!==t?t:[],({id:e,isSupported:t})=>!0===t&&e===r);if(void 0===u)throw new Error("Wanted video track not found.");const{DEFAULT_VIDEO_TRACK_SWITCHING_MODE:c}=O.getCurrent(),d=i.video,f=Av(u,this._isTrickModeTrackEnabled);let h;if(null===o)h=new de(null);else{const e=this._getRepresentationsToLock(u,o),t=c;h=new de({representationIds:e,switchingMode:t})}const p={adaptationBase:u,switchingMode:null!==a&&void 0!==a?a:c,adaptation:f,relativeResumingPosition:s,lockedRepresentations:h};if(d.storedSettings=p,this.trigger("trackUpdate",{period:xv(l),trackType:"video",reason:"manual"}),this._isDisposed)return;const g=Sv(this._storedPeriodInfo,l.id);void 0!==g&&g.video.storedSettings===p&&(null===(n=g.video.dispatcher)||void 0===n||n.updateTrack(p))}disableTrack(e,t){var n,i;const r=e[t];if(null===r.storedSettings)return;if("text"!==t&&(null===(n=e[t].storedSettings)||void 0===n||n.lockedRepresentations.finish()),r.storedSettings=null,this.trigger("trackUpdate",{period:xv(e.period),trackType:t,reason:"manual"}),this._isDisposed)return;const a=Sv(this._storedPeriodInfo,e.period.id);void 0!==a&&null===a[t].storedSettings&&(null===(i=a[t].dispatcher)||void 0===i||i.updateTrack(null))}getChosenAudioTrack(e){return null===e.audio.storedSettings?null:Rt(e.audio.storedSettings.adaptation,!0)}getChosenTextTrack(e){return null===e.text.storedSettings?null:Ct(e.text.storedSettings.adaptation)}getChosenVideoTrack(e){return null===e.video.storedSettings?null:Dt(e.video.storedSettings.adaptation,!0)}getAvailableAudioTracks(e){const t=e.audio.storedSettings,n=null!==t?t.adaptation.id:null,i=St(e.period,"audio");return i.map(e=>{const t=null!==n&&n===e.id;return k(Rt(e,!0),{active:t})})}getAvailableTextTracks(e){const t=e.text.storedSettings,n=null!==t?t.adaptation.id:null,i=St(e.period,"text");return i.map(e=>{const t=null!==n&&n===e.id;return k(Ct(e),{active:t})})}getAvailableVideoTracks(e){const t=e.video.storedSettings,n=null===t?void 0:t.adaptation.id,i=St(e.period,"video");return i.map(e=>{const t=null!==n&&n===e.id,i=Dt(e,!0),r=void 0!==i.trickModeTracks?i.trickModeTracks.map(e=>{const t=null!==n&&n===e.id;return k(e,{active:t})}):[],a=k(i,{active:t});return void 0!==r&&(a.trickModeTracks=r),a})}getLockedAudioRepresentations(e){const{storedSettings:t}=e.audio;if(null===t)return null;const n=t.lockedRepresentations.getValue();return null===n?null:n.representationIds}getLockedVideoRepresentations(e){const{storedSettings:t}=e.video;if(null===t)return null;const n=t.lockedRepresentations.getValue();return null===n?null:n.representationIds}lockAudioRepresentations(e,t){var n;const{storedSettings:i}=e.audio;if(null===i)return;const{DEFAULT_AUDIO_REPRESENTATIONS_SWITCHING_MODE:r}=O.getCurrent(),a=this._getRepresentationsToLock(i.adaptation,t.representations),o=null!==(n=t.switchingMode)&&void 0!==n?n:r;i.lockedRepresentations.setValue({representationIds:a,switchingMode:o})}lockVideoRepresentations(e,t){var n;const{storedSettings:i}=e.video;if(null===i)return;const{DEFAULT_VIDEO_REPRESENTATIONS_SWITCHING_MODE:r}=O.getCurrent(),a=this._getRepresentationsToLock(i.adaptation,t.representations),o=null!==(n=t.switchingMode)&&void 0!==n?n:r;i.lockedRepresentations.setValue({representationIds:a,switchingMode:o})}unlockAudioRepresentations(e){const{storedSettings:t}=e.audio;null!==t&&null!==t.lockedRepresentations.getValue()&&t.lockedRepresentations.setValue(null)}unlockVideoRepresentations(e){const{storedSettings:t}=e.video;null!==t&&null!==t.lockedRepresentations.getValue()&&t.lockedRepresentations.setValue(null)}dispose(){this._isDisposed=!0;while(1){const e=this._storedPeriodInfo.pop();if(void 0===e)return;e.isRemoved=!0}}_resetVideoTrackChoices(e){var t;for(let i=0;i<this._storedPeriodInfo.length;i++){const e=this._storedPeriodInfo[i];if(null!==e.video.storedSettings){const t=e.video.storedSettings.adaptationBase;if(null!==t){const n=Av(t,this._isTrickModeTrackEnabled);e.video.storedSettings.adaptationBase=t,e.video.storedSettings.adaptation=n}}}const n=this._storedPeriodInfo.slice();for(let i=0;i<n.length;i++){const r=n[i].period,a=n[i].video,o=a.storedSettings;if(this.trigger("trackUpdate",{period:xv(r),trackType:"video",reason:e}),this._isDisposed)return;const s=Sv(this._storedPeriodInfo,r.id);void 0!==s&&s.video.storedSettings===o&&(null===(t=s.video.dispatcher)||void 0===t||t.updateTrack(o))}}_removePeriodObject(e){const t=this._storedPeriodInfo[e];this._storedPeriodInfo[e].isRemoved=!0,this._storedPeriodInfo.splice(e,1),this._cachedPeriodInfo.set(t.period,t)}_getRepresentationsToLock(e,t){const n=t.reduce((t,n)=>{const i=De(e.representations,e=>{return e.id===n});return void 0===i?j.warn("API: Wanted locked Representation not found."):t.push(i.id),t},[]);if(0===n.length)throw new Error("Cannot lock Representations: None of the given Representation id are found");return n}}function Tv(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(i.period.id===t.id)return n}}function Sv(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(i.period.id===t)return i}}function wv(e){var t,n,i;return!e.inManifest&&null===(null===(t=e.text)||void 0===t?void 0:t.dispatcher)&&null===(null===(n=e.audio)||void 0===n?void 0:n.dispatcher)&&null===(null===(i=e.video)||void 0===i?void 0:i.dispatcher)}function Av(e,t){var n;return t&&void 0!==(null===(n=e.trickModeTracks)||void 0===n?void 0:n[0])?e.trickModeTracks[0]:e}function Iv(e,t,n,i){var r,a;const o=St(e,"audio")[0],s=St(e,"video")[0],l=Av(s,n),{DEFAULT_VIDEO_TRACK_SWITCHING_MODE:u}=O.getCurrent(),c=void 0!==o?{adaptation:o,switchingMode:i,lockedRepresentations:new de(null)}:null,d=void 0!==l?{adaptation:l,adaptationBase:s,switchingMode:u,lockedRepresentations:new de(null)}:null;let f=null;const h=(null!==(r=e.adaptations.text)&&void 0!==r?r:[]).filter(e=>!0===e.isForcedSubtitles);if(h.length>0){if(null!==o&&void 0!==o){const e=De(h,e=>e.normalizedLanguage===o.normalizedLanguage);void 0!==e&&(f=e)}null===f&&(f=null!==(a=De(h,e=>void 0===e.normalizedLanguage))&&void 0!==a?a:null)}let p=null;return null!==f&&(p={adaptation:f,switchingMode:"direct",lockedRepresentations:new de(null)}),{period:e,inManifest:t,isPeriodAdvertised:!1,isRemoved:!1,audio:{storedSettings:c,dispatcher:null},video:{storedSettings:d,dispatcher:null},text:{storedSettings:p,dispatcher:null}}}function xv(e){return{start:e.start,end:e.end,id:e.id}}var Rv=Ev;function Cv(e){let t,n,i,a,o,s;const{DEFAULT_BASE_BANDWIDTH:l,DEFAULT_VIDEO_RESOLUTION_LIMIT:u,DEFAULT_MAX_BUFFER_AHEAD:c,DEFAULT_MAX_BUFFER_BEHIND:d,DEFAULT_MAX_VIDEO_BUFFER_SIZE:f,DEFAULT_THROTTLE_VIDEO_BITRATE_WHEN_HIDDEN:h,DEFAULT_WANTED_BUFFER_AHEAD:p}=O.getCurrent();if(r(e.maxBufferAhead))t=c;else if(t=Number(e.maxBufferAhead),isNaN(t))throw new Error("Invalid maxBufferAhead parameter. Should be a number.");if(r(e.maxBufferBehind))n=d;else if(n=Number(e.maxBufferBehind),isNaN(n))throw new Error("Invalid maxBufferBehind parameter. Should be a number.");if(r(e.wantedBufferAhead))i=p;else if(i=Number(e.wantedBufferAhead),isNaN(i))throw new Error("Invalid wantedBufferAhead parameter. Should be a number.");if(r(e.maxVideoBufferSize))a=f;else if(a=Number(e.maxVideoBufferSize),isNaN(a))throw new Error("Invalid maxVideoBufferSize parameter. Should be a number.");const g=r(e.videoResolutionLimit)?u:e.videoResolutionLimit,m=r(e.throttleVideoBitrateWhenHidden)?h:!!e.throttleVideoBitrateWhenHidden;if(r(e.videoElement))o=document.createElement("video");else{if(!(e.videoElement instanceof HTMLMediaElement))throw new Error("Invalid videoElement parameter. Should be a HTMLMediaElement.");o=e.videoElement}if(r(e.baseBandwidth))s=l;else if(s=Number(e.baseBandwidth),isNaN(s))throw new Error("Invalid baseBandwidth parameter. Should be a number.");return{maxBufferAhead:t,maxBufferBehind:n,videoResolutionLimit:g,videoElement:o,wantedBufferAhead:i,maxVideoBufferSize:a,throttleVideoBitrateWhenHidden:m,baseBandwidth:s}}function Dv(e){var t,n,i,r;if(null===e||"object"!==typeof e&&void 0!==e)throw new Error("API: reload - Invalid options format.");if(null===(null===e||void 0===e?void 0:e.reloadAt)||"object"!==typeof(null===e||void 0===e?void 0:e.reloadAt)&&void 0!==(null===e||void 0===e?void 0:e.reloadAt))throw new Error("API: reload - Invalid 'reloadAt' option format.");if("number"!==typeof(null===(t=null===e||void 0===e?void 0:e.reloadAt)||void 0===t?void 0:t.position)&&void 0!==(null===(n=null===e||void 0===e?void 0:e.reloadAt)||void 0===n?void 0:n.position))throw new Error("API: reload - Invalid 'reloadAt.position' option format.");if("number"!==typeof(null===(i=null===e||void 0===e?void 0:e.reloadAt)||void 0===i?void 0:i.relative)&&void 0!==(null===(r=null===e||void 0===e?void 0:e.reloadAt)||void 0===r?void 0:r.relative))throw new Error("API: reload - Invalid 'reloadAt.relative' option format.");if(!Array.isArray(null===e||void 0===e?void 0:e.keySystems)&&void 0!==(null===e||void 0===e?void 0:e.keySystems))throw new Error("API: reload - Invalid 'keySystems' option format.");if(void 0!==(null===e||void 0===e?void 0:e.autoPlay)&&"boolean"!==typeof e.autoPlay)throw new Error("API: reload - Invalid 'autoPlay' option format.")}function kv(e){var t,n,i;let a,o,s,l,u,c,d;const{DEFAULT_AUTO_PLAY:f,DEFAULT_CODEC_SWITCHING_BEHAVIOR:h,DEFAULT_ENABLE_FAST_SWITCHING:p,DEFAULT_TEXT_TRACK_MODE:g}=O.getCurrent();if(r(e))throw new Error("No option set on loadVideo");if(r(e.url)){if(r(e.initialManifest)&&r(e.manifestLoader))throw new Error("Unable to load a content: no url set on loadVideo.\nPlease provide at least either an `url` argument, a `initialManifest` option or a `manifestLoader` option so the RxPlayer can load the content.")}else a=String(e.url);if(r(e.transport))throw new Error("No transport set on loadVideo");o=String(e.transport);const m=r(e.autoPlay)?f:!!e.autoPlay;if(r(e.keySystems))s=[];else{s=Array.isArray(e.keySystems)?e.keySystems:[e.keySystems];for(const e of s)if("string"!==typeof e.type||"function"!==typeof e.getLicense)throw new Error("Invalid key system given: Missing type string or getLicense callback")}const v=void 0!==e.lowLatencyMode&&!!e.lowLatencyMode,y=e.initialManifest,_=null!==(t=e.minimumManifestUpdateInterval)&&void 0!==t?t:0;let b=null!==(n=e.defaultAudioTrackSwitchingMode)&&void 0!==n?n:void 0;void 0===b||gt(["seamless","direct","reload"],b)||(j.warn("The `defaultAudioTrackSwitchingMode` loadVideo option must match one of the following strategy name:\n- `seamless`\n- `direct`\n- `reload`"),b=void 0);let E=r(e.onCodecSwitch)?h:e.onCodecSwitch;if(gt(["continue","reload"],E)||(j.warn("The `onCodecSwitch` loadVideo option must match one of the following string:\n- `continue`\n- `reload`\nIf badly set, "+h+" will be used as default"),E=h),r(e.textTrackMode))l=g;else{if("native"!==e.textTrackMode&&"html"!==e.textTrackMode)throw new Error("Invalid textTrackMode.");l=e.textTrackMode}if("html"===l){if(r(e.textTrackElement))throw new Error('You have to provide a textTrackElement in "html" textTrackMode.');if(!(e.textTrackElement instanceof HTMLElement))throw new Error("textTrackElement should be an HTMLElement.");c=e.textTrackElement}else r(e.textTrackElement)||j.warn('API: You have set a textTrackElement without being in an "html" textTrackMode. It will be ignored.');if(r(e.mode))u="auto";else{if(!gt(["auto","multithread","main"],e.mode))throw new Error("Invalid `mode` option.");u=e.mode}const T=r(e.enableFastSwitching)?p:e.enableFastSwitching;if(!r(e.startAt))if("wallClockTime"in e.startAt&&e.startAt.wallClockTime instanceof Date){const t=e.startAt.wallClockTime.getTime()/1e3;d=k({},e.startAt,{wallClockTime:t})}else d=e.startAt;const S=null!==(i=e.requestConfig)&&void 0!==i?i:{};return{__priv_patchLastSegmentInSidx:e.__priv_patchLastSegmentInSidx,__priv_manifestUpdateUrl:e.__priv_manifestUpdateUrl,checkMediaSegmentIntegrity:e.checkMediaSegmentIntegrity,autoPlay:m,defaultAudioTrackSwitchingMode:b,enableFastSwitching:T,initialManifest:y,keySystems:s,lowLatencyMode:v,manifestLoader:e.manifestLoader,minimumManifestUpdateInterval:_,requestConfig:S,onCodecSwitch:E,referenceDateTime:e.referenceDateTime,representationFilter:e.representationFilter,segmentLoader:e.segmentLoader,serverSyncInfos:e.serverSyncInfos,startAt:d,textTrackElement:c,textTrackMode:l,transport:o,mode:u,url:a}}function Mv(e,t,n,i,r){if(r.isCancelled()||null===e)return;let a=2===t.getReference().getValue().seeking;a&&(n(),r.isCancelled())||t.listen(e=>{"seeking"===e.event?(a=!0,n()):a&&"seeked"===e.event&&(a=!1,i())},{includeLastObservation:!0,clearSignal:r})}function Lv(e,t,n,i){i.isCancelled()||null===e||(e.addEventListener("play",t),e.addEventListener("pause",n),i.register(()=>{e.removeEventListener("play",t),e.removeEventListener("pause",n)}))}function Pv(e,t,n,i){const r=new de("LOADING",i);e.addEventListener("loaded",()=>{if("LOADING"===r.getValue()){if(r.setValue("LOADED"),!i.isCancelled()){const e=Nv(t,null);"PAUSED"!==e&&r.setValue(e)}}else"RELOADING"===r.getValue()?r.setValue(Nv(t,null)):o(null)},i),e.addEventListener("reloadingMediaSource",()=>{Ov(r.getValue())&&r.setValueIfChanged("RELOADING")},i);let a=null;return e.addEventListener("stalled",e=>{e!==a&&(o(e),a=e)},i),e.addEventListener("unstalled",()=>{null!==a&&(o(null),a=null)},i),n.listen(e=>{gt(["seeking","ended","play","pause"],e.event)&&o(a)},{clearSignal:i}),r;function o(e){if(!Ov(r.getValue()))return;const n=Nv(t,e),i=r.getValue();"LOADED"===i&&"PAUSED"===n||r.setValueIfChanged(n)}}function Nv(e,t){const{FORCED_ENDED_THRESHOLD:n}=O.getCurrent();if(e.ended)return"ENDED";if(null!==t){const i=Math.abs(e.duration-e.currentTime);return!r(n)&&i<n?"ENDED":"seeking"===t?"SEEKING":"freezing"===t?"FREEZING":"BUFFERING"}return e.paused?"PAUSED":"PLAYING"}function Ov(e){return"LOADING"!==e&&"RELOADING"!==e&&"STOPPED"!==e}const Fv=pt(),Uv=["manifestLoader","segmentLoader"];class Bv extends a{static get ErrorTypes(){return at}static get ErrorCodes(){return ot}static get LogLevel(){return j.getLevel()}static set LogLevel(e){j.setLevel(e)}static addFeatures(e){iv(e)}static _priv_registerVideoElement(e){if(Bv._priv_currentlyUsedVideoElements.has(e)){const e="The video element is already attached to another RxPlayer instance.\nMake sure to dispose the previous instance with player.dispose() before creating a new player instance attaching that video element.";console.warn(e)}Bv._priv_currentlyUsedVideoElements.add(e)}static _priv_deregisterVideoElement(e){Bv._priv_currentlyUsedVideoElements.has(e)&&Bv._priv_currentlyUsedVideoElements.delete(e)}constructor(e={}){super();const{baseBandwidth:t,videoResolutionLimit:n,maxBufferAhead:i,maxBufferBehind:r,throttleVideoBitrateWhenHidden:a,videoElement:o,wantedBufferAhead:s,maxVideoBufferSize:l}=Cv(e);o.preload="auto",this.version="4.1.0",this.log=j,this.state="STOPPED",this.videoElement=o,Bv._priv_registerVideoElement(this.videoElement);const u=new me;this._destroyCanceller=u,this._priv_pictureInPictureRef=Sr(o,u.signal),this._priv_speed=new de(o.playbackRate,this._destroyCanceller.signal),this._priv_preferTrickModeTracks=!1,this._priv_contentLock=new de(!1,this._destroyCanceller.signal),this._priv_bufferOptions={wantedBufferAhead:new de(s,this._destroyCanceller.signal),maxBufferAhead:new de(i,this._destroyCanceller.signal),maxBufferBehind:new de(r,this._destroyCanceller.signal),maxVideoBufferSize:new de(l,this._destroyCanceller.signal)},this._priv_bitrateInfos={lastBitrates:{audio:t,video:t}},this._priv_throttleVideoBitrateWhenHidden=a,this._priv_videoResolutionLimit=n,this._priv_currentError=null,this._priv_contentInfos=null,this._priv_contentEventsMemory={},this._priv_reloadingMetadata={},this._priv_lastAutoPlay=!1,this._priv_worker=null,this._priv_segmentSinkMetricsCallback=null;const c=()=>{this.trigger("volumeChange",{volume:o.volume,muted:o.muted})};o.addEventListener("volumechange",c),u.signal.register(()=>{o.removeEventListener("volumechange",c)})}attachWorker(e){return new Promise((t,n)=>{var r;if(!tv())return j.warn("API: Cannot rely on a WebWorker: Worker API unavailable"),n(new nv("INCOMPATIBLE_ERROR","Worker unavailable"));if("string"===typeof e.workerUrl)this._priv_worker=new Worker(e.workerUrl);else{const t=URL.createObjectURL(e.workerUrl);this._priv_worker=new Worker(t),URL.revokeObjectURL(t)}this._priv_worker.onerror=(e=>{null!==this._priv_worker&&(this._priv_worker.terminate(),this._priv_worker=null),j.error("API: Unexpected worker error",e.error instanceof Error?e.error:void 0),n(new nv("UNKNOWN_ERROR",'Unexpected Worker "error" event'))});const a=e=>{const i=e.data;"init-error"===i.type?(j.warn("API: Processing InitError worker message: detaching worker"),null!==this._priv_worker&&(this._priv_worker.removeEventListener("message",a),this._priv_worker.terminate(),this._priv_worker=null),n(new nv("SETUP_ERROR","Worker parser initialization failed: "+i.value.errorMessage))):"init-success"===i.type&&(j.info("API: InitSuccess received from worker."),null!==this._priv_worker&&this._priv_worker.removeEventListener("message",a),t())};this._priv_worker.addEventListener("message",a),j.debug("---\x3e Sending To Worker:","init"),this._priv_worker.postMessage({type:"init",value:{dashWasmUrl:e.dashWasmUrl,logLevel:j.getLevel(),sendBackLogs:i(),date:Date.now(),timestamp:Te(),hasVideo:"video"===(null===(r=this.videoElement)||void 0===r?void 0:r.nodeName.toLowerCase()),hasMseInWorker:ev}}),j.addEventListener("onLogLevelChange",e=>{null!==this._priv_worker&&(j.debug("---\x3e Sending To Worker:","log-level-update"),this._priv_worker.postMessage({type:"log-level-update",value:{logLevel:e,sendBackLogs:i()}}))},this._destroyCanceller.signal)})}getCurrentModeInformation(){return null===this._priv_contentInfos?null:{isDirectFile:this._priv_contentInfos.isDirectFile,useWorker:this._priv_contentInfos.useWorker}}addEventListener(e,t){return super.addEventListener(e,t)}stop(){null!==this._priv_contentInfos&&this._priv_contentInfos.currentContentCanceller.cancel(),this._priv_cleanUpCurrentContentState(),"STOPPED"!==this.state&&this._priv_setPlayerState("STOPPED")}dispose(){this.stop(),null!==this.videoElement&&(Bv._priv_deregisterVideoElement(this.videoElement),vv(this.videoElement).catch(e=>{const t=e instanceof Error?e.message:"Unknown error";j.error("API: Could not dispose decryption resources: "+t)})),this._destroyCanceller.cancel(),this._priv_reloadingMetadata={},this.videoElement=null,null!==this._priv_worker&&(this._priv_worker.terminate(),this._priv_worker=null)}loadVideo(e){const t=kv(e);j.info("API: Calling loadvideo",t.url,t.transport),this._priv_reloadingMetadata={options:t},this._priv_initializeContentPlayback(t),this._priv_lastAutoPlay=t.autoPlay}reload(e){var t,n,i;const{options:r,manifest:a,reloadPosition:o,reloadInPause:s}=this._priv_reloadingMetadata;if(void 0===r)throw new Error("API: Can't reload without having previously loaded a content.");let l,u,c;if(Dv(e),void 0!==(null===(t=null===e||void 0===e?void 0:e.reloadAt)||void 0===t?void 0:t.position))l={position:e.reloadAt.position};else if(void 0!==(null===(n=null===e||void 0===e?void 0:e.reloadAt)||void 0===n?void 0:n.relative)){if(void 0===o)throw new Error("Can't reload to a relative position when previous content was not loaded.");l={position:e.reloadAt.relative+o}}else void 0!==o&&(l={position:o});void 0!==(null===e||void 0===e?void 0:e.autoPlay)?u=e.autoPlay:void 0!==s&&(u=!s),void 0!==(null===e||void 0===e?void 0:e.keySystems)?c=e.keySystems:void 0!==(null===(i=this._priv_reloadingMetadata.options)||void 0===i?void 0:i.keySystems)&&(c=this._priv_reloadingMetadata.options.keySystems);const d=Object.assign(Object.assign({},r),{initialManifest:a});void 0!==l&&(d.startAt=l),void 0!==u&&(d.autoPlay=u),void 0!==c&&(d.keySystems=c),this._priv_initializeContentPlayback(d)}createDebugElement(e){if(null===Zt.createDebugElement)throw new Error("Feature `DEBUG_ELEMENT` not added to the RxPlayer");const t=new me;return Zt.createDebugElement(e,this,t.signal),{dispose(){t.cancel()}}}_priv_initializeContentPlayback(e){var t,n,i,a,o,s;const{autoPlay:l,defaultAudioTrackSwitchingMode:u,enableFastSwitching:c,initialManifest:d,keySystems:f,lowLatencyMode:h,minimumManifestUpdateInterval:p,requestConfig:g,onCodecSwitch:m,startAt:v,transport:y,checkMediaSegmentIntegrity:_,manifestLoader:b,referenceDateTime:E,segmentLoader:T,serverSyncInfos:S,mode:w,__priv_manifestUpdateUrl:A,__priv_patchLastSegmentInSidx:I,url:x}=e;if(null===this.videoElement)throw new Error("the attached video element is disposed");const R="directfile"===y,C=new me,D=this.videoElement;let M,L=!1,P=null;if(R){if(null===Zt.directfile)throw this.stop(),this._priv_currentError=null,new Error("DirectFile feature not activated in your build.");if(r(x))throw new Error("No URL for a DirectFile content");if(j.info("API: Initializing DirectFile mode in the main thread"),P=this._priv_initializeMediaElementTracksStore(C.signal),C.isUsed())return;M=new Zt.directfile.initDirectFile({autoPlay:l,keySystems:f,speed:this._priv_speed,startAt:v,url:x})}else{const u={lowLatencyMode:h,maxRetry:null===(t=g.manifest)||void 0===t?void 0:t.maxRetry,requestTimeout:null===(n=g.manifest)||void 0===n?void 0:n.timeout,connectionTimeout:null===(i=g.manifest)||void 0===i?void 0:i.connectionTimeout,minimumManifestUpdateInterval:p,initialManifest:d},R=Xm(),P={throttleBitrate:{},limitResolution:{}};this._priv_throttleVideoBitrateWhenHidden&&(R?P.throttleBitrate={video:ce(wr(this._priv_pictureInPictureRef,C.signal),e=>e?1/0:0,C.signal)}:j.warn("API: Can't apply throttleVideoBitrateWhenHidden because browser can't be trusted for visibility.")),"videoElement"===this._priv_videoResolutionLimit?R?P.limitResolution={video:Ir(D,this._priv_pictureInPictureRef,C.signal)}:j.warn("API: Can't apply videoResolutionLimit because browser can't be trusted for video size."):"screen"===this._priv_videoResolutionLimit&&(P.limitResolution={video:Ar(C.signal)});const N={initialBitrates:this._priv_bitrateInfos.lastBitrates,lowLatencyMode:h,throttlers:P},O="native"===e.textTrackMode?{textTrackMode:"native"}:{textTrackMode:"html",textTrackElement:e.textTrackElement},F=k({enableFastSwitching:c,onCodecSwitch:m},this._priv_bufferOptions),U={lowLatencyMode:h,maxRetry:null===(a=g.segment)||void 0===a?void 0:a.maxRetry,requestTimeout:null===(o=g.segment)||void 0===o?void 0:o.timeout,connectionTimeout:null===(s=g.segment)||void 0===s?void 0:s.connectionTimeout},B=null!==Zt.multithread&&null!==this._priv_worker&&"dash"===y&&Uv.every(t=>r(e[t]))&&"function"!==typeof e.representationFilter;if("main"===w||"auto"===w&&!B){if(null===Zt.mainThreadMediaSourceInit)throw new Error("Cannot load video, neither in a WebWorker nor with the `MEDIA_SOURCE_MAIN` feature");const t=Zt.transports[y];if("function"!==typeof t)throw this.stop(),this._priv_currentError=null,new Error(`transport "${y}" not supported`);const n="string"===typeof e.representationFilter?Pt(e.representationFilter):e.representationFilter;j.info("API: Initializing MediaSource mode in the main thread");const i=t({lowLatencyMode:h,checkMediaSegmentIntegrity:_,manifestLoader:b,referenceDateTime:E,representationFilter:n,segmentLoader:T,serverSyncInfos:S,__priv_manifestUpdateUrl:A,__priv_patchLastSegmentInSidx:I});M=new Zt.mainThreadMediaSourceInit({adaptiveOptions:N,autoPlay:l,bufferOptions:F,keySystems:f,lowLatencyMode:h,transport:i,manifestRequestSettings:u,segmentRequestOptions:U,speed:this._priv_speed,startAt:v,textTrackOptions:O,url:x})}else{if(null===Zt.multithread)throw new Error("Cannot load video in multithread mode: `MULTI_THREAD` feature not imported.");if(null===this._priv_worker)throw new Error("Cannot load video in multithread mode: `attachWorker` method not called.");he("function"!==typeof e.representationFilter),L=!0,j.info("API: Initializing MediaSource mode in a WebWorker");const t={lowLatencyMode:h,checkMediaSegmentIntegrity:_,referenceDateTime:E,serverSyncInfos:S,manifestLoader:void 0,segmentLoader:void 0,representationFilter:e.representationFilter,__priv_manifestUpdateUrl:A,__priv_patchLastSegmentInSidx:I};M=new Zt.multithread.init({adaptiveOptions:N,autoPlay:l,bufferOptions:F,keySystems:f,lowLatencyMode:h,transportOptions:t,manifestRequestSettings:u,segmentRequestOptions:U,speed:this._priv_speed,startAt:v,textTrackOptions:O,worker:this._priv_worker,url:x})}}const N={contentId:Fv(),originalUrl:x,currentContentCanceller:C,defaultAudioTrackSwitchingMode:u,initializer:M,isDirectFile:R,manifest:null,currentPeriod:null,activeAdaptations:null,activeRepresentations:null,tracksStore:null,mediaElementTracksStore:P,useWorker:L};M.addEventListener("error",e=>{this._priv_onFatalError(e,N)}),M.addEventListener("warning",e=>{const t=ht(e,{defaultCode:"NONE",defaultReason:"An unknown error happened."});j.warn("API: Sending warning:",t),this.trigger("warning",t)}),M.addEventListener("reloadingMediaSource",e=>{null!==N.tracksStore&&N.tracksStore.resetPeriodObjects(),this._priv_segmentSinkMetricsCallback=null,this._priv_lastAutoPlay=e.autoPlay}),M.addEventListener("inbandEvents",e=>this.trigger("inbandEvents",e)),M.addEventListener("streamEvent",e=>this.trigger("streamEvent",e)),M.addEventListener("streamEventSkip",e=>this.trigger("streamEventSkip",e)),M.addEventListener("activePeriodChanged",e=>this._priv_onActivePeriodChanged(N,e)),M.addEventListener("periodStreamReady",e=>this._priv_onPeriodStreamReady(N,e)),M.addEventListener("periodStreamCleared",e=>this._priv_onPeriodStreamCleared(N,e)),M.addEventListener("representationChange",e=>this._priv_onRepresentationChange(N,e)),M.addEventListener("adaptationChange",e=>this._priv_onAdaptationChange(N,e)),M.addEventListener("bitrateEstimateChange",e=>this._priv_onBitrateEstimateChange(e)),M.addEventListener("manifestReady",e=>this._priv_onManifestReady(N,e)),M.addEventListener("manifestUpdate",e=>this._priv_onManifestUpdate(N,e)),M.addEventListener("decipherabilityUpdate",e=>this._priv_onDecipherabilityUpdate(N,e)),M.addEventListener("loaded",e=>{this._priv_segmentSinkMetricsCallback=e.getSegmentSinkMetrics}),M.prepare(),this.stop();const O=new uv(D,{withMediaSource:!R,lowLatencyMode:h});C.signal.register(()=>{O.stop()});const F=Pv(M,D,O,C.signal);C.signal.register(()=>{M.dispose()});const U=e=>{switch(e){case"STOPPED":case"RELOADING":case"LOADING":break;case"ENDED":this._priv_reloadingMetadata.reloadInPause=!0,this._priv_reloadingMetadata.reloadPosition=O.getReference().getValue().position.getPolled();break;default:const t=O.getReference().getValue();this._priv_reloadingMetadata.reloadInPause=t.paused,this._priv_reloadingMetadata.reloadPosition=t.position.getWanted();break}};let B=null;const G=e=>{null!==B&&(B.cancel(),B=null),F.onUpdate((t,n)=>{Ov(t)&&(n(),null!==B&&B.cancel(),B=new me,B.linkToSignal(C.signal),e!==!D.paused&&(D.paused?this.trigger("pause",null):this.trigger("play",null)),Lv(D,()=>this.trigger("play",null),()=>this.trigger("pause",null),C.signal))},{emitCurrentValue:!1,clearSignal:C.signal})};G(l),M.addEventListener("reloadingMediaSource",e=>{G(e.autoPlay)}),this._priv_currentError=null,this._priv_contentInfos=N;let V=null;F.onUpdate(e=>{U(e),this._priv_setPlayerState(e),C.isUsed()||(null!==V?Ov(this.state)||(V.cancel(),V=null):Ov(this.state)&&(V=new me,V.linkToSignal(C.signal),Mv(D,O,()=>this.trigger("seeking",null),()=>this.trigger("seeked",null),V.signal)))},{emitCurrentValue:!0,clearSignal:C.signal}),O.listen(e=>{U(this.state),this._priv_triggerPositionUpdate(N,e)},{clearSignal:C.signal}),C.signal.register(()=>{M.removeEventListener()}),this._priv_contentLock.onUpdate((e,t)=>{e||(t(),M.start(D,O))},{emitCurrentValue:!0,clearSignal:C.signal})}getError(){return this._priv_currentError}getVideoElement(){return this.videoElement}getPlayerState(){return this.state}isContentLoaded(){return!gt(["LOADING","RELOADING","STOPPED"],this.state)}isBuffering(){return gt(["BUFFERING","SEEKING","LOADING","RELOADING"],this.state)}isPaused(){return!this.videoElement||(gt(["LOADING","RELOADING"],this.state)?!this._priv_lastAutoPlay:this.videoElement.paused)}isLive(){if(null===this._priv_contentInfos)return!1;const{isDirectFile:e,manifest:t}=this._priv_contentInfos;return!e&&null!==t&&t.isLive}areTrickModeTracksEnabled(){return this._priv_preferTrickModeTracks}getContentUrls(){if(null===this._priv_contentInfos)return;const{isDirectFile:e,manifest:t,originalUrl:n}=this._priv_contentInfos;return e?void 0===n?void 0:[n]:null!==t?t.uris:void 0}updateContentUrls(e,t){if(null===this._priv_contentInfos)throw new Error("No content loaded");const n=!0===(null===t||void 0===t?void 0:t.refresh);this._priv_contentInfos.initializer.updateContentUrls(e,n)}getMediaDuration(){if(null===this.videoElement)throw new Error("Disposed player");return this.videoElement.duration}getCurrentBufferGap(){if(null===this.videoElement)throw new Error("Disposed player");const e=this.videoElement,t=ne(e.buffered,e.currentTime);return t===1/0?0:t}getWallClockTime(){if(null===this.videoElement)throw new Error("Disposed player");if(null===this._priv_contentInfos)return this.videoElement.currentTime;const{isDirectFile:e,manifest:t}=this._priv_contentInfos;if(e){const e=Qm(this.videoElement);return(null!==e&&void 0!==e?e:0)+this.videoElement.currentTime}if(null!==t){const e=this.videoElement.currentTime,n=void 0!==t.availabilityStartTime?t.availabilityStartTime:0;return e+n}return 0}getPosition(){if(null===this.videoElement)throw new Error("Disposed player");return this.videoElement.currentTime}getLastStoredContentPosition(){return this._priv_reloadingMetadata.reloadPosition}getPlaybackRate(){return this._priv_speed.getValue()}setPlaybackRate(e,t){var n;e!==this._priv_speed.getValue()&&this._priv_speed.setValue(e);const i=null===t||void 0===t?void 0:t.preferTrickModeTracks;if("boolean"!==typeof i)return;this._priv_preferTrickModeTracks=i;const a=null===(n=this._priv_contentInfos)||void 0===n?void 0:n.tracksStore;r(a)||(i&&!a.isTrickModeEnabled()?a.enableVideoTrickModeTracks():!i&&a.isTrickModeEnabled()&&a.disableVideoTrickModeTracks())}getVideoRepresentation(){const e=this.__priv_getCurrentRepresentations();if(null!==e)return e.video}getAudioRepresentation(){const e=this.__priv_getCurrentRepresentations();if(null!==e)return e.audio}play(){if(null===this.videoElement)throw new Error("Disposed player");const e=this.videoElement.play();return r(e)||"function"!==typeof e.catch?Promise.resolve():e.catch(e=>{if("NotAllowedError"===e.name){const t=new ut("MEDIA_ERR_PLAY_NOT_ALLOWED",e.toString());this.trigger("warning",t)}throw e})}pause(){if(null===this.videoElement)throw new Error("Disposed player");this.videoElement.pause()}seekTo(e){var t;if(null===this.videoElement)throw new Error("Disposed player");if(null===this._priv_contentInfos)throw new Error("player: no content loaded");const{isDirectFile:n,manifest:i}=this._priv_contentInfos;if(!n&&null===i)throw new Error("player: the content did not load yet");let a;if("number"===typeof e)a=e;else if("object"===typeof e){const o=e,s=this.videoElement.currentTime;if(r(o.relative))if(r(o.position)){if(r(o.wallClockTime))throw new Error('invalid time object. You must set one of the following properties: "relative", "position" or "wallClockTime"');if(null!==i)a=o.wallClockTime-(null!==(t=i.availabilityStartTime)&&void 0!==t?t:0);else if(n&&null!==this.videoElement){const e=Qm(this.videoElement);void 0!==e&&(a=o.wallClockTime-e)}void 0===a&&(a=o.wallClockTime)}else a=o.position;else a=s+o.relative}if(void 0===a)throw new Error("invalid time given");return j.info("API: API Seek to",a),this.videoElement.currentTime=a,a}getVolume(){if(null===this.videoElement)throw new Error("Disposed player");return this.videoElement.volume}setVolume(e){if(null===this.videoElement)throw new Error("Disposed player");const t=this.videoElement;e!==t.volume&&(t.volume=e)}isMute(){var e;return!0===(null===(e=this.videoElement)||void 0===e?void 0:e.muted)}mute(){if(null===this.videoElement)throw new Error("Disposed player");this.videoElement.muted||(this.videoElement.muted=!0)}unMute(){if(null===this.videoElement)throw new Error("Disposed player");this.videoElement.muted&&(this.videoElement.muted=!1)}setMaxBufferBehind(e){this._priv_bufferOptions.maxBufferBehind.setValue(e)}setMaxBufferAhead(e){this._priv_bufferOptions.maxBufferAhead.setValue(e)}setWantedBufferAhead(e){this._priv_bufferOptions.wantedBufferAhead.setValue(e)}setMaxVideoBufferSize(e){this._priv_bufferOptions.maxVideoBufferSize.setValue(e)}getMaxBufferBehind(){return this._priv_bufferOptions.maxBufferBehind.getValue()}getMaxBufferAhead(){return this._priv_bufferOptions.maxBufferAhead.getValue()}getWantedBufferAhead(){return this._priv_bufferOptions.wantedBufferAhead.getValue()}getMaxVideoBufferSize(){return this._priv_bufferOptions.maxVideoBufferSize.getValue()}getCurrentPeriod(){var e;const t=null===(e=this._priv_contentInfos)||void 0===e?void 0:e.currentPeriod;return r(t)?null:{id:t.id,start:t.start,end:t.end}}getKeySystemConfiguration(){if(null===this.videoElement)throw new Error("Disposed player");const e=sr(this.videoElement);return null===e?null:{keySystem:e[0],configuration:e[1]}}getAvailablePeriods(){if(null===this._priv_contentInfos)return[];const{isDirectFile:e,tracksStore:t}=this._priv_contentInfos;return e?[]:null===t?[]:t.getAvailablePeriods().slice()}getAvailableAudioTracks(e){var t;if(null===this._priv_contentInfos)return[];const{isDirectFile:n,mediaElementTracksStore:i}=this._priv_contentInfos;return n?null!==(t=null===i||void 0===i?void 0:i.getAvailableAudioTracks())&&void 0!==t?t:[]:this._priv_callTracksStoreGetterSetter(e,[],(e,t)=>{var n;return null!==(n=e.getAvailableAudioTracks(t))&&void 0!==n?n:[]})}getAvailableTextTracks(e){var t;if(null===this._priv_contentInfos)return[];const{isDirectFile:n,mediaElementTracksStore:i}=this._priv_contentInfos;return n?null!==(t=null===i||void 0===i?void 0:i.getAvailableTextTracks())&&void 0!==t?t:[]:this._priv_callTracksStoreGetterSetter(e,[],(e,t)=>{var n;return null!==(n=e.getAvailableTextTracks(t))&&void 0!==n?n:[]})}getAvailableVideoTracks(e){var t;if(null===this._priv_contentInfos)return[];const{isDirectFile:n,mediaElementTracksStore:i}=this._priv_contentInfos;return n?null!==(t=null===i||void 0===i?void 0:i.getAvailableVideoTracks())&&void 0!==t?t:[]:this._priv_callTracksStoreGetterSetter(e,[],(e,t)=>{var n;return null!==(n=e.getAvailableVideoTracks(t))&&void 0!==n?n:[]})}getAudioTrack(e){if(null===this._priv_contentInfos)return;const{isDirectFile:t,mediaElementTracksStore:n}=this._priv_contentInfos;if(t){if(null===n)return;return n.getChosenAudioTrack()}return this._priv_callTracksStoreGetterSetter(e,void 0,(e,t)=>e.getChosenAudioTrack(t))}getTextTrack(e){if(null===this._priv_contentInfos)return;const{isDirectFile:t,mediaElementTracksStore:n}=this._priv_contentInfos;if(t){if(null===n)return;return n.getChosenTextTrack()}return this._priv_callTracksStoreGetterSetter(e,void 0,(e,t)=>e.getChosenTextTrack(t))}getVideoTrack(e){if(null===this._priv_contentInfos)return;const{isDirectFile:t,mediaElementTracksStore:n}=this._priv_contentInfos;if(t){if(null===n)return;return n.getChosenVideoTrack()}return this._priv_callTracksStoreGetterSetter(e,void 0,(e,t)=>e.getChosenVideoTrack(t))}setAudioTrack(e){var t;if(null===this._priv_contentInfos)throw new Error("No content loaded");const{isDirectFile:n,mediaElementTracksStore:i}=this._priv_contentInfos;if(n)try{const t="string"===typeof e?e:e.trackId;return void(null===i||void 0===i||i.setAudioTrackById(t))}catch(e){throw new Error("player: unknown audio track")}let r,a,o,s,l=null;return"string"===typeof e?a=e:(a=e.trackId,r=e.periodId,o=e.switchingMode,l=null!==(t=e.lockedRepresentations)&&void 0!==t?t:null,s=e.relativeResumingPosition),this._priv_callTracksStoreGetterSetter(r,void 0,(e,t)=>e.setAudioTrack({periodRef:t,trackId:a,switchingMode:o,lockedRepresentations:l,relativeResumingPosition:s}))}setTextTrack(e){if(null===this._priv_contentInfos)throw new Error("No content loaded");const{isDirectFile:t,mediaElementTracksStore:n}=this._priv_contentInfos;if(t)try{const t="string"===typeof e?e:e.trackId;return void(null===n||void 0===n||n.setTextTrackById(t))}catch(e){throw new Error("player: unknown text track")}let i,r;return"string"===typeof e?r=e:(r=e.trackId,i=e.periodId),this._priv_callTracksStoreGetterSetter(i,void 0,(e,t)=>e.setTextTrack(t,r))}disableTextTrack(e){if(null===this._priv_contentInfos)return;const{isDirectFile:t,mediaElementTracksStore:n}=this._priv_contentInfos;if(!t)return this._priv_callTracksStoreGetterSetter(e,void 0,(e,t)=>e.disableTrack(t,"text"));null===n||void 0===n||n.disableTextTrack()}setVideoTrack(e){var t;if(null===this._priv_contentInfos)throw new Error("No content loaded");const{isDirectFile:n,mediaElementTracksStore:i}=this._priv_contentInfos;if(n)try{const t="string"===typeof e?e:e.trackId;return void(null===i||void 0===i||i.setVideoTrackById(t))}catch(e){throw new Error("player: unknown video track")}let r,a,o,s,l=null;return"string"===typeof e?a=e:(a=e.trackId,r=e.periodId,o=e.switchingMode,l=null!==(t=e.lockedRepresentations)&&void 0!==t?t:null,s=e.relativeResumingPosition),this._priv_callTracksStoreGetterSetter(r,void 0,(e,t)=>e.setVideoTrack({periodRef:t,trackId:a,switchingMode:o,lockedRepresentations:l,relativeResumingPosition:s}))}disableVideoTrack(e){if(null===this._priv_contentInfos)return;const{isDirectFile:t,mediaElementTracksStore:n}=this._priv_contentInfos;return t&&null!==n?n.disableVideoTrack():this._priv_callTracksStoreGetterSetter(e,void 0,(e,t)=>e.disableTrack(t,"video"))}lockVideoRepresentations(e){if(null===this._priv_contentInfos)throw new Error("No content loaded");const{isDirectFile:t}=this._priv_contentInfos;if(t)throw new Error("Cannot lock video Representations in directfile mode.");let n,i,r;return Array.isArray(e)?(n=e,i=void 0):(n=e.representations,i=e.periodId,r=e.switchingMode),this._priv_callTracksStoreGetterSetter(i,void 0,(e,t)=>e.lockVideoRepresentations(t,{representations:n,switchingMode:r}))}lockAudioRepresentations(e){if(null===this._priv_contentInfos)throw new Error("No content loaded");const{isDirectFile:t}=this._priv_contentInfos;if(t)throw new Error("Cannot lock audio Representations in directfile mode.");let n,i,r;return Array.isArray(e)?(n=e,i=void 0):(n=e.representations,i=e.periodId,r=e.switchingMode),this._priv_callTracksStoreGetterSetter(i,void 0,(e,t)=>e.lockAudioRepresentations(t,{representations:n,switchingMode:r}))}getLockedVideoRepresentations(e){if(null===this._priv_contentInfos)return null;const{isDirectFile:t}=this._priv_contentInfos;return t?null:this._priv_callTracksStoreGetterSetter(e,null,(e,t)=>e.getLockedVideoRepresentations(t))}getLockedAudioRepresentations(e){if(null===this._priv_contentInfos)return null;const{isDirectFile:t}=this._priv_contentInfos;return t?null:this._priv_callTracksStoreGetterSetter(e,null,(e,t)=>e.getLockedAudioRepresentations(t))}unlockVideoRepresentations(e){if(null===this._priv_contentInfos)return;const{isDirectFile:t}=this._priv_contentInfos;return t?void 0:this._priv_callTracksStoreGetterSetter(e,void 0,(e,t)=>e.unlockVideoRepresentations(t))}unlockAudioRepresentations(e){if(null===this._priv_contentInfos)return;const{isDirectFile:t}=this._priv_contentInfos;return t?void 0:this._priv_callTracksStoreGetterSetter(e,void 0,(e,t)=>e.unlockAudioRepresentations(t))}getMinimumPosition(){if(null===this._priv_contentInfos)return null;if(this._priv_contentInfos.isDirectFile)return 0;const{manifest:e}=this._priv_contentInfos;return null!==e?bt(e):null}getLivePosition(){if(null===this._priv_contentInfos)return null;const{isDirectFile:e,manifest:t}=this._priv_contentInfos;return e?void 0:!0!==(null===t||void 0===t?void 0:t.isLive)?null:Et(t)}getMaximumPosition(){if(null===this._priv_contentInfos)return null;const{isDirectFile:e,manifest:t}=this._priv_contentInfos;if(e){if(null===this.videoElement)throw new Error("Disposed player");return this.videoElement.duration}return null!==t?t.isDynamic||null===this.videoElement?Tt(t):this.videoElement.duration:null}async __priv_getSegmentSinkMetrics(){return null===this._priv_segmentSinkMetricsCallback?void 0:this._priv_segmentSinkMetricsCallback()}__priv_getManifest(){return null===this._priv_contentInfos?null:this._priv_contentInfos.manifest}__priv_getCurrentAdaptation(){if(null===this._priv_contentInfos)return null;const{currentPeriod:e,activeAdaptations:t}=this._priv_contentInfos;return null===e||null===t||r(t[e.id])?null:t[e.id]}__priv_getCurrentRepresentations(){if(null===this._priv_contentInfos)return null;const{currentPeriod:e,activeRepresentations:t}=this._priv_contentInfos;return null===e||null===t||r(t[e.id])?null:t[e.id]}_priv_cleanUpCurrentContentState(){var e,t,n,i;j.debug("Locking `contentLock` to clean-up the current content."),this._priv_contentLock.setValue(!0),null===(t=null===(e=this._priv_contentInfos)||void 0===e?void 0:e.tracksStore)||void 0===t||t.dispose(),null===(i=null===(n=this._priv_contentInfos)||void 0===n?void 0:n.mediaElementTracksStore)||void 0===i||i.dispose(),this._priv_contentInfos=null,this._priv_segmentSinkMetricsCallback=null,this._priv_contentEventsMemory={};const a=()=>{null!==this.videoElement&&(j.debug("Unlocking `contentLock`. Next content can begin."),this._priv_contentLock.setValue(!1))};r(this.videoElement)?a():_v(this.videoElement).then(()=>{j.debug("API: DRM session cleaned-up with success!"),a()},e=>{j.error("API: An error arised when trying to clean-up the DRM session:"+(e instanceof Error?e.toString():"Unknown Error")),a()})}_priv_onManifestReady(e,t){var n;if(e.contentId!==(null===(n=this._priv_contentInfos)||void 0===n?void 0:n.contentId))return;e.manifest=t,0===t.manifestFormat&&(this._priv_reloadingMetadata.manifest=t);const i=new Rv({preferTrickModeTracks:this._priv_preferTrickModeTracks,defaultAudioTrackSwitchingMode:e.defaultAudioTrackSwitchingMode});e.tracksStore=i,i.addEventListener("newAvailablePeriods",e=>{this.trigger("newAvailablePeriods",e)}),i.addEventListener("brokenRepresentationsLock",e=>{this.trigger("brokenRepresentationsLock",e)}),i.addEventListener("trackUpdate",e=>{var t,n;this.trigger("trackUpdate",e);const i=null!==(n=null===(t=this._priv_contentInfos)||void 0===t?void 0:t.currentPeriod)&&void 0!==n?n:void 0;"no-playable-representation"===e.reason&&e.period.id===(null===i||void 0===i?void 0:i.id)&&this._priv_onAvailableTracksMayHaveChanged(e.trackType)}),e.tracksStore.addEventListener("warning",e=>{this.trigger("warning",e)}),e.tracksStore.addEventListener("error",t=>{this._priv_onFatalError(t,e)}),e.tracksStore.onManifestUpdate(t)}_priv_onManifestUpdate(e,t){var n,i,a;if(null===this._priv_contentInfos||null===this._priv_contentInfos.manifest)return;r(null===e||void 0===e?void 0:e.tracksStore)||e.tracksStore.onManifestUpdate(this._priv_contentInfos.manifest);const o=null!==(i=null===(n=this._priv_contentInfos)||void 0===n?void 0:n.currentPeriod)&&void 0!==i?i:void 0,s=null===(a=this._priv_contentInfos)||void 0===a?void 0:a.tracksStore;if(void 0!==o&&!r(s))for(const r of t.updatedPeriods)if(r.period.id===o.id&&(r.result.addedAdaptations.length>0||r.result.removedAdaptations.length>0)){const e=s.getPeriodObjectFromPeriod(o);if(void 0===e)return;this._priv_onAvailableTracksMayHaveChanged("audio"),this._priv_onAvailableTracksMayHaveChanged("text"),this._priv_onAvailableTracksMayHaveChanged("video")}}_priv_onDecipherabilityUpdate(e,t){if(null===e||null===e.manifest)return;r(null===e||void 0===e?void 0:e.tracksStore)||e.tracksStore.onDecipherabilityUpdates();const n=t.reduce((t,n)=>{var i,r,a;const o=void 0!==De(t,e=>e[0].id===n.period.id&&e[1]===n.adaptation.type);if(!o){const o=e.tracksStore;if(null===o)return t;let s=!1;const l=o.getPeriodObjectFromPeriod(n.period);if(void 0===l)return t;switch(n.adaptation.type){case"audio":s=(null===(i=o.getChosenAudioTrack(l))||void 0===i?void 0:i.id)===n.adaptation.id;break;case"video":s=(null===(r=o.getChosenVideoTrack(l))||void 0===r?void 0:r.id)===n.adaptation.id;break;case"text":s=(null===(a=o.getChosenTextTrack(l))||void 0===a?void 0:a.id)===n.adaptation.id;break}s&&t.push([n.period,n.adaptation.type])}return t},[]);for(const[i,r]of n)this._priv_triggerEventIfNotStopped("representationListUpdate",{period:{start:i.start,end:i.end,id:i.id},trackType:r,reason:"decipherability-update"},e.currentContentCanceller.signal)}_priv_onActivePeriodChanged(e,{period:t}){var n,i,a,o,s,l;if(e.contentId!==(null===(n=this._priv_contentInfos)||void 0===n?void 0:n.contentId))return;e.currentPeriod=t;const u=e.currentContentCanceller.signal;this._priv_contentEventsMemory.periodChange!==t&&(this._priv_contentEventsMemory.periodChange=t,this._priv_triggerEventIfNotStopped("periodChange",{start:t.start,end:t.end,id:t.id},u)),this._priv_triggerEventIfNotStopped("availableAudioTracksChange",this.getAvailableAudioTracks(),u),this._priv_triggerEventIfNotStopped("availableTextTracksChange",this.getAvailableTextTracks(),u),this._priv_triggerEventIfNotStopped("availableVideoTracksChange",this.getAvailableVideoTracks(),u);const c=null===(i=this._priv_contentInfos)||void 0===i?void 0:i.tracksStore;if(r(c))this._priv_triggerEventIfNotStopped("audioTrackChange",null,u),this._priv_triggerEventIfNotStopped("textTrackChange",null,u),this._priv_triggerEventIfNotStopped("videoTrackChange",null,u);else{const e=c.getPeriodObjectFromPeriod(t);if(e){const t=c.getChosenAudioTrack(e);this._priv_triggerEventIfNotStopped("audioTrackChange",t,u);const n=c.getChosenTextTrack(e);this._priv_triggerEventIfNotStopped("textTrackChange",n,u);const i=c.getChosenVideoTrack(e);this._priv_triggerEventIfNotStopped("videoTrackChange",i,u)}}const d=null!==(o=null===(a=this.__priv_getCurrentRepresentations())||void 0===a?void 0:a.audio)&&void 0!==o?o:null;this._priv_triggerEventIfNotStopped("audioRepresentationChange",d,u);const f=null!==(l=null===(s=this.__priv_getCurrentRepresentations())||void 0===s?void 0:s.video)&&void 0!==l?l:null;this._priv_triggerEventIfNotStopped("videoRepresentationChange",f,u)}_priv_onPeriodStreamReady(e,t){var n;if(e.contentId!==(null===(n=this._priv_contentInfos)||void 0===n?void 0:n.contentId))return;const{type:i,period:a,adaptationRef:o}=t,s=e.tracksStore;switch(i){case"video":case"audio":case"text":r(s)?(j.error(`API: TracksStore not instanciated for a new ${i} period`),o.setValue(null)):s.addTrackReference(i,a,o);break;default:ge(i)}}_priv_onPeriodStreamCleared(e,t){var n;if(e.contentId!==(null===(n=this._priv_contentInfos)||void 0===n?void 0:n.contentId))return;const{type:i,period:a}=t,o=e.tracksStore;switch(i){case"audio":case"text":case"video":r(o)||o.removeTrackReference(i,a);break}const{activeAdaptations:s,activeRepresentations:l}=e;if(!r(s)&&!r(s[a.id])){const e=s[a.id];delete e[i],0===Object.keys(e).length&&delete s[a.id]}if(!r(l)&&!r(l[a.id])){const e=l[a.id];delete e[i],0===Object.keys(e).length&&delete l[a.id]}}_priv_onAdaptationChange(e,{type:t,adaptation:n,period:i}){var a;if(e.contentId!==(null===(a=this._priv_contentInfos)||void 0===a?void 0:a.contentId))return;null===e.activeAdaptations&&(e.activeAdaptations={});const{activeAdaptations:o,currentPeriod:s}=e,l=o[i.id];r(l)?o[i.id]={[t]:n}:l[t]=n;const{tracksStore:u}=e,c=e.currentContentCanceller.signal;if(null!==u&&null!==s&&!r(i)&&i.id===s.id){const e=u.getPeriodObjectFromPeriod(i);if(void 0===e)return;switch(t){case"audio":const n=u.getChosenAudioTrack(e);this._priv_triggerEventIfNotStopped("audioTrackChange",n,c);break;case"text":const i=u.getChosenTextTrack(e);this._priv_triggerEventIfNotStopped("textTrackChange",i,c);break;case"video":const r=u.getChosenVideoTrack(e);this._priv_triggerEventIfNotStopped("videoTrackChange",r,c);break}}}_priv_onRepresentationChange(e,{type:t,period:n,representation:i}){var a;if(e.contentId!==(null===(a=this._priv_contentInfos)||void 0===a?void 0:a.contentId))return;null===e.activeRepresentations&&(e.activeRepresentations={});const{activeRepresentations:o,currentPeriod:s}=e,l=o[n.id];if(r(l)?o[n.id]={[t]:i}:l[t]=i,!r(n)&&null!==s&&s.id===n.id){const e=this._priv_contentInfos.currentContentCanceller.signal;"video"===t?this._priv_triggerEventIfNotStopped("videoRepresentationChange",i,e):"audio"===t&&this._priv_triggerEventIfNotStopped("audioRepresentationChange",i,e)}}_priv_onBitrateEstimateChange({type:e,bitrate:t}){void 0!==t&&(this._priv_bitrateInfos.lastBitrates[e]=t),this.trigger("__priv_bitrateEstimateChange",{type:e,bitrate:t})}_priv_setPlayerState(e){this.state!==e&&(this.state=e,j.info("API: playerStateChange event",e),this.trigger("playerStateChange",e))}_priv_triggerPositionUpdate(e,t){var n,i;if(e.contentId!==(null===(n=this._priv_contentInfos)||void 0===n?void 0:n.contentId))return;const{isDirectFile:a,manifest:o}=e;if(!a&&null===o||r(t))return;const s=null!==o?Tt(o):void 0,l={position:t.position.getPolled(),duration:t.duration,playbackRate:t.playbackRate,maximumPosition:s,bufferGap:void 0!==t.bufferGap&&isFinite(t.bufferGap)?t.bufferGap:0};if(null!==o&&o.isLive&&t.position.getPolled()>0){const e=null!==(i=o.availabilityStartTime)&&void 0!==i?i:0;l.wallClockTime=t.position.getPolled()+e;const n=Et(o);void 0!==n&&(l.liveGap=n-t.position.getPolled())}else if(a&&null!==this.videoElement){const e=Qm(this.videoElement);void 0!==e&&(l.wallClockTime=e+t.position.getPolled())}this.trigger("positionUpdate",l)}_priv_triggerEventIfNotStopped(e,t,n){n.isCancelled()||this.trigger(e,t)}_priv_initializeMediaElementTracksStore(e){var t,n,i;he(null!==Zt.directfile,"Initializing `MediaElementTracksStore` without Directfile feature"),he(null!==this.videoElement,"Initializing `MediaElementTracksStore` on a disposed RxPlayer");const r=new Zt.directfile.mediaElementTracksStore(this.videoElement);return this._priv_triggerEventIfNotStopped("availableAudioTracksChange",r.getAvailableAudioTracks(),e),this._priv_triggerEventIfNotStopped("availableVideoTracksChange",r.getAvailableVideoTracks(),e),this._priv_triggerEventIfNotStopped("availableTextTracksChange",r.getAvailableTextTracks(),e),this._priv_triggerEventIfNotStopped("audioTrackChange",null!==(t=r.getChosenAudioTrack())&&void 0!==t?t:null,e),this._priv_triggerEventIfNotStopped("textTrackChange",null!==(n=r.getChosenTextTrack())&&void 0!==n?n:null,e),this._priv_triggerEventIfNotStopped("videoTrackChange",null!==(i=r.getChosenVideoTrack())&&void 0!==i?i:null,e),r.addEventListener("availableVideoTracksChange",e=>this.trigger("availableVideoTracksChange",e)),r.addEventListener("availableAudioTracksChange",e=>this.trigger("availableAudioTracksChange",e)),r.addEventListener("availableTextTracksChange",e=>this.trigger("availableTextTracksChange",e)),r.addEventListener("audioTrackChange",e=>this.trigger("audioTrackChange",e)),r.addEventListener("videoTrackChange",e=>this.trigger("videoTrackChange",e)),r.addEventListener("textTrackChange",e=>this.trigger("textTrackChange",e)),r}_priv_callTracksStoreGetterSetter(e,t,n){var i,r;if(null===this._priv_contentInfos||null===this._priv_contentInfos.tracksStore)return j.warn("API: Trying to call track API too soon"),t;const{tracksStore:a}=this._priv_contentInfos,o=null!==(r=null===(i=this._priv_contentInfos)||void 0===i?void 0:i.currentPeriod)&&void 0!==r?r:void 0,s=null!==e&&void 0!==e?e:null===o||void 0===o?void 0:o.id;if(void 0===s)return t;const l=s===(null===o||void 0===o?void 0:o.id)?a.getPeriodObjectFromPeriod(o):a.getPeriodObjectFromId(s);return void 0===l?t:n(a,l)}_priv_onAvailableTracksMayHaveChanged(e,t){const n=this._priv_contentInfos;if(null===n)return;const{currentPeriod:i,tracksStore:a,currentContentCanceller:o}=n,s=o.signal;if(r(i)||null===a)return;const l=null!==t&&void 0!==t?t:a.getPeriodObjectFromPeriod(i);if(void 0!==l)switch(e){case"video":const t=a.getAvailableVideoTracks(l);this._priv_triggerEventIfNotStopped("availableVideoTracksChange",null!==t&&void 0!==t?t:[],s);break;case"audio":const n=a.getAvailableAudioTracks(l);this._priv_triggerEventIfNotStopped("availableAudioTracksChange",null!==n&&void 0!==n?n:[],s);break;case"text":const i=a.getAvailableTextTracks(l);this._priv_triggerEventIfNotStopped("availableTextTracksChange",null!==i&&void 0!==i?i:[],s);break;default:ge(e)}}_priv_onFatalError(e,t){const n=ht(e,{defaultCode:"NONE",defaultReason:"An unknown error stopped content playback."});n.fatal=!0,t.currentContentCanceller.cancel(),this._priv_cleanUpCurrentContentState(),this._priv_currentError=n,j.error("API: The player stopped because of an error",n),this._priv_setPlayerState("STOPPED"),this._priv_currentError===n&&this.trigger("error",n)}}Bv._priv_currentlyUsedVideoElements=new WeakSet,Bv.version="4.1.0";var Gv=Bv,jv=Gv;u(),jv.addFeatures([kl,Nd,qd,Hh,Gp,Qp,pg,Eg,sm,_m,Km,Wm]),i()&&j.setLevel("DEBUG");t["a"]=jv;"boolean"===typeof __GLOBAL_SCOPE__&&__GLOBAL_SCOPE__&&(o["a"].RxPlayer=jv)},"133d":function(e,t,n){var i=n("6d8b"),r=n("e0d3");function a(e,t){var n,a=[],o=e.seriesIndex;if(null==o||!(n=t.getSeriesByIndex(o)))return{point:[]};var s=n.getData(),l=r.queryDataIndex(s,e);if(null==l||l<0||i.isArray(l))return{point:[]};var u=s.getItemGraphicEl(l),c=n.coordinateSystem;if(n.getTooltipPosition)a=n.getTooltipPosition(l)||[];else if(c&&c.dataToPoint)a=c.dataToPoint(s.getValues(i.map(c.dimensions,function(e){return s.mapDimension(e)}),l,!0))||[];else if(u){var d=u.getBoundingRect().clone();d.applyTransform(u.transform),a=[d.x+d.width/2,d.y+d.height/2]}return{point:a,el:u}}e.exports=a},1418:function(e,t,n){var i=n("6d8b"),r=n("a15a"),a=r.createSymbol,o=n("2306"),s=n("3842"),l=s.parsePercent,u=n("c775"),c=u.getDefaultLabel;function d(e,t,n){o.Group.call(this),this.updateData(e,t,n)}var f=d.prototype,h=d.getSymbolSize=function(e,t){var n=e.getItemVisual(t,"symbolSize");return n instanceof Array?n.slice():[+n,+n]};function p(e){return[e[0]/2,e[1]/2]}function g(e,t){this.parent.drift(e,t)}f._createSymbol=function(e,t,n,i,r){this.removeAll();var o=t.getItemVisual(n,"color"),s=a(e,-1,-1,2,2,o,r);s.attr({z2:100,culling:!0,scale:p(i)}),s.drift=g,this._symbolType=e,this.add(s)},f.stopSymbolAnimation=function(e){this.childAt(0).stopAnimation(e)},f.getSymbolPath=function(){return this.childAt(0)},f.getScale=function(){return this.childAt(0).scale},f.highlight=function(){this.childAt(0).trigger("emphasis")},f.downplay=function(){this.childAt(0).trigger("normal")},f.setZ=function(e,t){var n=this.childAt(0);n.zlevel=e,n.z=t},f.setDraggable=function(e){var t=this.childAt(0);t.draggable=e,t.cursor=e?"move":"pointer"},f.updateData=function(e,t,n){this.silent=!1;var i=e.getItemVisual(t,"symbol")||"circle",r=e.hostModel,a=h(e,t),s=i!==this._symbolType;if(s){var l=e.getItemVisual(t,"symbolKeepAspect");this._createSymbol(i,e,t,a,l)}else{var u=this.childAt(0);u.silent=!1,o.updateProps(u,{scale:p(a)},r,t)}if(this._updateCommon(e,t,a,n),s){u=this.childAt(0);var c=n&&n.fadeIn,d={scale:u.scale.slice()};c&&(d.style={opacity:u.style.opacity}),u.scale=[0,0],c&&(u.style.opacity=0),o.initProps(u,d,r,t)}this._seriesModel=r};var m=["itemStyle"],v=["emphasis","itemStyle"],y=["label"],_=["emphasis","label"];f._updateCommon=function(e,t,n,r){var a=this.childAt(0),s=e.hostModel,u=e.getItemVisual(t,"color");"image"!==a.type&&a.useStyle({strokeNoScale:!0});var d=r&&r.itemStyle,f=r&&r.hoverItemStyle,h=r&&r.symbolRotate,g=r&&r.symbolOffset,b=r&&r.labelModel,E=r&&r.hoverLabelModel,T=r&&r.hoverAnimation,S=r&&r.cursorStyle;if(!r||e.hasItemOption){var w=r&&r.itemModel?r.itemModel:e.getItemModel(t);d=w.getModel(m).getItemStyle(["color"]),f=w.getModel(v).getItemStyle(),h=w.getShallow("symbolRotate"),g=w.getShallow("symbolOffset"),b=w.getModel(y),E=w.getModel(_),T=w.getShallow("hoverAnimation"),S=w.getShallow("cursor")}else f=i.extend({},f);var A=a.style;a.attr("rotation",(h||0)*Math.PI/180||0),g&&a.attr("position",[l(g[0],n[0]),l(g[1],n[1])]),S&&a.attr("cursor",S),a.setColor(u,r&&r.symbolInnerColor),a.setStyle(d);var I=e.getItemVisual(t,"opacity");null!=I&&(A.opacity=I);var x=e.getItemVisual(t,"liftZ"),R=a.__z2Origin;null!=x?null==R&&(a.__z2Origin=a.z2,a.z2+=x):null!=R&&(a.z2=R,a.__z2Origin=null);var C=r&&r.useNameLabel;function D(t,n){return C?e.getName(t):c(e,t)}o.setLabelStyle(A,f,b,E,{labelFetcher:s,labelDataIndex:t,defaultText:D,isRectText:!0,autoColor:u}),a.off("mouseover").off("mouseout").off("emphasis").off("normal"),a.hoverStyle=f,o.setHoverStyle(a);var k=p(n);if(T&&s.isAnimationEnabled()){var M=function(){if(!this.incremental){var e=k[1]/k[0];this.animateTo({scale:[Math.max(1.1*k[0],k[0]+3),Math.max(1.1*k[1],k[1]+3*e)]},400,"elasticOut")}},L=function(){this.incremental||this.animateTo({scale:k},400,"elasticOut")};a.on("mouseover",M).on("mouseout",L).on("emphasis",M).on("normal",L)}},f.fadeOut=function(e,t){var n=this.childAt(0);this.silent=n.silent=!0,(!t||!t.keepLabel)&&(n.style.text=null),o.updateProps(n,{style:{opacity:0},scale:[0,0]},this._seriesModel,this.dataIndex,e)},i.inherits(d,o.Group);var b=d;e.exports=b},1495:function(e,t,n){var i=n("86cc"),r=n("cb7c"),a=n("0d58");e.exports=n("9e1e")?Object.defineProperties:function(e,t){r(e);var n,o=a(t),s=o.length,l=0;while(s>l)i.f(e,n=o[l++],t[n]);return e}},1548:function(e,t,n){var i=n("6d8b"),r=n("3301"),a=n("697e"),o=n("2023"),s=n("4319"),l=n("f934");l.getLayoutRect;t.getLayoutRect=l.getLayoutRect;var u=n("ee1a"),c=u.enableDataStack,d=u.isDimensionStacked,f=u.getStackedDimension,h=n("862d");t.completeDimensions=h;var p=n("b1d4");t.createDimensions=p;var g=n("a15a");function m(e){return r(e.getSource(),e)}t.createSymbol=g.createSymbol;var v={isDimensionStacked:d,enableDataStack:c,getStackedDimension:f};function y(e,t){var n=t;s.isInstance(t)||(n=new s(t),i.mixin(n,o));var r=a.createScaleByModel(n);return r.setExtent(e[0],e[1]),a.niceScaleExtent(r,n),r}function _(e){i.mixin(e,o)}t.createList=m,t.dataStack=v,t.createScale=y,t.mixinAxisModelCommonMethods=_},1687:function(e,t){var n="undefined"===typeof Float32Array?Array:Float32Array;function i(){var e=new n(6);return r(e),e}function r(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function a(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function o(e,t,n){var i=t[0]*n[0]+t[2]*n[1],r=t[1]*n[0]+t[3]*n[1],a=t[0]*n[2]+t[2]*n[3],o=t[1]*n[2]+t[3]*n[3],s=t[0]*n[4]+t[2]*n[5]+t[4],l=t[1]*n[4]+t[3]*n[5]+t[5];return e[0]=i,e[1]=r,e[2]=a,e[3]=o,e[4]=s,e[5]=l,e}function s(e,t,n){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4]+n[0],e[5]=t[5]+n[1],e}function l(e,t,n){var i=t[0],r=t[2],a=t[4],o=t[1],s=t[3],l=t[5],u=Math.sin(n),c=Math.cos(n);return e[0]=i*c+o*u,e[1]=-i*u+o*c,e[2]=r*c+s*u,e[3]=-r*u+c*s,e[4]=c*a+u*l,e[5]=c*l-u*a,e}function u(e,t,n){var i=n[0],r=n[1];return e[0]=t[0]*i,e[1]=t[1]*r,e[2]=t[2]*i,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*r,e}function c(e,t){var n=t[0],i=t[2],r=t[4],a=t[1],o=t[3],s=t[5],l=n*o-a*i;return l?(l=1/l,e[0]=o*l,e[1]=-a*l,e[2]=-i*l,e[3]=n*l,e[4]=(i*s-o*r)*l,e[5]=(a*r-n*s)*l,e):null}function d(e){var t=i();return a(t,e),t}t.create=i,t.identity=r,t.copy=a,t.mul=o,t.translate=s,t.rotate=l,t.scale=u,t.invert=c,t.clone=d},"17b8":function(e,t,n){var i=n("3014"),r=i.extend({type:"series.bar",dependencies:["grid","polar"],brushSelector:"rect",getProgressive:function(){return!!this.get("large")&&this.get("progressive")},getProgressiveThreshold:function(){var e=this.get("progressiveThreshold"),t=this.get("largeThreshold");return t>e&&(e=t),e}});e.exports=r},"17d6":function(e,t,n){var i=n("6d8b"),r=n("22d1"),a=n("e0d3"),o=a.makeInner,s=o(),l=i.each;function u(e,t,n){if(!r.node){var i=t.getZr();s(i).records||(s(i).records={}),c(i,t);var a=s(i).records[e]||(s(i).records[e]={});a.handler=n}}function c(e,t){function n(n,i){e.on(n,function(n){var r=p(t);l(s(e).records,function(e){e&&i(e,n,r.dispatchAction)}),d(r.pendings,t)})}s(e).initialized||(s(e).initialized=!0,n("click",i.curry(h,"click")),n("mousemove",i.curry(h,"mousemove")),n("globalout",f))}function d(e,t){var n,i=e.showTip.length,r=e.hideTip.length;i?n=e.showTip[i-1]:r&&(n=e.hideTip[r-1]),n&&(n.dispatchAction=null,t.dispatchAction(n))}function f(e,t,n){e.handler("leave",null,n)}function h(e,t,n,i){t.handler(e,n,i)}function p(e){var t={showTip:[],hideTip:[]},n=function(i){var r=t[i.type];r?r.push(i):(i.dispatchAction=n,e.dispatchAction(i))};return{dispatchAction:n,pendings:t}}function g(e,t){if(!r.node){var n=t.getZr(),i=(s(n).records||{})[e];i&&(s(n).records[e]=null)}}t.register=u,t.unregister=g},"18c0":function(e,t,n){var i=n("6d8b"),r=n("e0d8"),a=n("8e43"),o=r.prototype,s=r.extend({type:"ordinal",init:function(e,t){e&&!i.isArray(e)||(e=new a({categories:e})),this._ordinalMeta=e,this._extent=t||[0,e.categories.length-1]},parse:function(e){return"string"===typeof e?this._ordinalMeta.getOrdinal(e):Math.round(e)},contain:function(e){return e=this.parse(e),o.contain.call(this,e)&&null!=this._ordinalMeta.categories[e]},normalize:function(e){return o.normalize.call(this,this.parse(e))},scale:function(e){return Math.round(o.scale.call(this,e))},getTicks:function(){var e=[],t=this._extent,n=t[0];while(n<=t[1])e.push(n),n++;return e},getLabel:function(e){if(!this.isBlank())return this._ordinalMeta.categories[e]},count:function(){return this._extent[1]-this._extent[0]+1},unionExtentFromData:function(e,t){this.unionExtent(e.getApproximateExtent(t))},getOrdinalMeta:function(){return this._ordinalMeta},niceTicks:i.noop,niceExtent:i.noop});s.create=function(){return new s};var l=s;e.exports=l},1991:function(e,t,n){var i,r,a,o=n("9b43"),s=n("31f4"),l=n("fab2"),u=n("230e"),c=n("7726"),d=c.process,f=c.setImmediate,h=c.clearImmediate,p=c.MessageChannel,g=c.Dispatch,m=0,v={},y="onreadystatechange",_=function(){var e=+this;if(v.hasOwnProperty(e)){var t=v[e];delete v[e],t()}},b=function(e){_.call(e.data)};f&&h||(f=function(e){var t=[],n=1;while(arguments.length>n)t.push(arguments[n++]);return v[++m]=function(){s("function"==typeof e?e:Function(e),t)},i(m),m},h=function(e){delete v[e]},"process"==n("2d95")(d)?i=function(e){d.nextTick(o(_,e,1))}:g&&g.now?i=function(e){g.now(o(_,e,1))}:p?(r=new p,a=r.port2,r.port1.onmessage=b,i=o(a.postMessage,a,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(i=function(e){c.postMessage(e+"","*")},c.addEventListener("message",b,!1)):i=y in u("script")?function(e){l.appendChild(u("script"))[y]=function(){l.removeChild(this),_.call(e)}}:function(e){setTimeout(o(_,e,1),0)}),e.exports={set:f,clear:h}},"19eb":function(e,t,n){var i=n("6d8b"),r=n("2b61"),a=n("d5b7"),o=n("9e2e");function s(e){for(var t in e=e||{},a.call(this,e),e)e.hasOwnProperty(t)&&"style"!==t&&(this[t]=e[t]);this.style=new r(e.style,this),this._rect=null,this.__clipPaths=[]}s.prototype={constructor:s,type:"displayable",__dirty:!0,invisible:!1,z:0,z2:0,zlevel:0,draggable:!1,dragging:!1,silent:!1,culling:!1,cursor:"pointer",rectHover:!1,progressive:!1,incremental:!1,inplace:!1,beforeBrush:function(e){},afterBrush:function(e){},brush:function(e,t){},getBoundingRect:function(){},contain:function(e,t){return this.rectContain(e,t)},traverse:function(e,t){e.call(t,this)},rectContain:function(e,t){var n=this.transformCoordToLocal(e,t),i=this.getBoundingRect();return i.contain(n[0],n[1])},dirty:function(){this.__dirty=!0,this._rect=null,this.__zr&&this.__zr.refresh()},animateStyle:function(e){return this.animate("style",e)},attrKV:function(e,t){"style"!==e?a.prototype.attrKV.call(this,e,t):this.style.set(t)},setStyle:function(e,t){return this.style.set(e,t),this.dirty(!1),this},useStyle:function(e){return this.style=new r(e,this),this.dirty(!1),this}},i.inherits(s,a),i.mixin(s,o);var l=s;e.exports=l},"1fa8":function(e,t,n){var i=n("cb7c");e.exports=function(e,t,n,r){try{return r?t(i(n)[0],n[1]):t(n)}catch(t){var a=e["return"];throw void 0!==a&&i(a.call(e)),t}}},"1fab":function(e,t){var n=Array.prototype.slice,i=function(){this._$handlers={}};i.prototype={constructor:i,one:function(e,t,n){var i=this._$handlers;if(!t||!e)return this;i[e]||(i[e]=[]);for(var r=0;r<i[e].length;r++)if(i[e][r].h===t)return this;return i[e].push({h:t,one:!0,ctx:n||this}),this},on:function(e,t,n){var i=this._$handlers;if(!t||!e)return this;i[e]||(i[e]=[]);for(var r=0;r<i[e].length;r++)if(i[e][r].h===t)return this;return i[e].push({h:t,one:!1,ctx:n||this}),this},isSilent:function(e){var t=this._$handlers;return t[e]&&t[e].length},off:function(e,t){var n=this._$handlers;if(!e)return this._$handlers={},this;if(t){if(n[e]){for(var i=[],r=0,a=n[e].length;r<a;r++)n[e][r]["h"]!=t&&i.push(n[e][r]);n[e]=i}n[e]&&0===n[e].length&&delete n[e]}else delete n[e];return this},trigger:function(e){if(this._$handlers[e]){var t=arguments,i=t.length;i>3&&(t=n.call(t,1));for(var r=this._$handlers[e],a=r.length,o=0;o<a;){switch(i){case 1:r[o]["h"].call(r[o]["ctx"]);break;case 2:r[o]["h"].call(r[o]["ctx"],t[1]);break;case 3:r[o]["h"].call(r[o]["ctx"],t[1],t[2]);break;default:r[o]["h"].apply(r[o]["ctx"],t);break}r[o]["one"]?(r.splice(o,1),a--):o++}}return this},triggerWithContext:function(e){if(this._$handlers[e]){var t=arguments,i=t.length;i>4&&(t=n.call(t,1,t.length-1));for(var r=t[t.length-1],a=this._$handlers[e],o=a.length,s=0;s<o;){switch(i){case 1:a[s]["h"].call(r);break;case 2:a[s]["h"].call(r,t[1]);break;case 3:a[s]["h"].call(r,t[1],t[2]);break;default:a[s]["h"].apply(r,t);break}a[s]["one"]?(a.splice(s,1),o--):s++}}return this}};var r=i;e.exports=r},"1fb5":function(e,t,n){"use strict";t.byteLength=c,t.toByteArray=f,t.fromByteArray=g;for(var i=[],r=[],a="undefined"!==typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=o.length;s<l;++s)i[s]=o[s],r[o.charCodeAt(s)]=s;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");-1===n&&(n=t);var i=n===t?0:4-n%4;return[n,i]}function c(e){var t=u(e),n=t[0],i=t[1];return 3*(n+i)/4-i}function d(e,t,n){return 3*(t+n)/4-n}function f(e){for(var t,n=u(e),i=n[0],o=n[1],s=new a(d(e,i,o)),l=0,c=o>0?i-4:i,f=0;f<c;f+=4)t=r[e.charCodeAt(f)]<<18|r[e.charCodeAt(f+1)]<<12|r[e.charCodeAt(f+2)]<<6|r[e.charCodeAt(f+3)],s[l++]=t>>16&255,s[l++]=t>>8&255,s[l++]=255&t;return 2===o&&(t=r[e.charCodeAt(f)]<<2|r[e.charCodeAt(f+1)]>>4,s[l++]=255&t),1===o&&(t=r[e.charCodeAt(f)]<<10|r[e.charCodeAt(f+1)]<<4|r[e.charCodeAt(f+2)]>>2,s[l++]=t>>8&255,s[l++]=255&t),s}function h(e){return i[e>>18&63]+i[e>>12&63]+i[e>>6&63]+i[63&e]}function p(e,t,n){for(var i,r=[],a=t;a<n;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),r.push(h(i));return r.join("")}function g(e){for(var t,n=e.length,r=n%3,a=[],o=16383,s=0,l=n-r;s<l;s+=o)a.push(p(e,s,s+o>l?l:s+o));return 1===r?(t=e[n-1],a.push(i[t>>2]+i[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],a.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"=")),a.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},2023:function(e,t,n){var i=n("6d8b"),r=(n("697e"),{getMin:function(e){var t=this.option,n=e||null==t.rangeStart?t.min:t.rangeStart;return this.axis&&null!=n&&"dataMin"!==n&&"function"!==typeof n&&!i.eqNaN(n)&&(n=this.axis.scale.parse(n)),n},getMax:function(e){var t=this.option,n=e||null==t.rangeEnd?t.max:t.rangeEnd;return this.axis&&null!=n&&"dataMax"!==n&&"function"!==typeof n&&!i.eqNaN(n)&&(n=this.axis.scale.parse(n)),n},getNeedCrossZero:function(){var e=this.option;return null==e.rangeStart&&null==e.rangeEnd&&!e.scale},getCoordSysModel:i.noop,setRange:function(e,t){this.option.rangeStart=e,this.option.rangeEnd=t},resetRange:function(){this.option.rangeStart=this.option.rangeEnd=null}});e.exports=r},2039:function(e,t,n){var i=n("6d8b"),r={};function a(){this._coordinateSystems=[]}a.prototype={constructor:a,create:function(e,t){var n=[];i.each(r,function(i,r){var a=i.create(e,t);n=n.concat(a||[])}),this._coordinateSystems=n},update:function(e,t){i.each(this._coordinateSystems,function(n){n.update&&n.update(e,t)})},getCoordinateSystems:function(){return this._coordinateSystems.slice()}},a.register=function(e,t){r[e]=t},a.get=function(e){return r[e]};var o=a;e.exports=o},"20c8":function(e,t,n){var i=n("4a3f"),r=n("401b"),a=n("e263"),o=n("9850"),s=n("2cf4"),l=s.devicePixelRatio,u={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},c=[],d=[],f=[],h=[],p=Math.min,g=Math.max,m=Math.cos,v=Math.sin,y=Math.sqrt,_=Math.abs,b="undefined"!=typeof Float32Array,E=function(e){this._saveData=!e,this._saveData&&(this.data=[]),this._ctx=null};E.prototype={constructor:E,_xi:0,_yi:0,_x0:0,_y0:0,_ux:0,_uy:0,_len:0,_lineDash:null,_dashOffset:0,_dashIdx:0,_dashSum:0,setScale:function(e,t){this._ux=_(1/l/e)||0,this._uy=_(1/l/t)||0},getContext:function(){return this._ctx},beginPath:function(e){return this._ctx=e,e&&e.beginPath(),e&&(this.dpr=e.dpr),this._saveData&&(this._len=0),this._lineDash&&(this._lineDash=null,this._dashOffset=0),this},moveTo:function(e,t){return this.addData(u.M,e,t),this._ctx&&this._ctx.moveTo(e,t),this._x0=e,this._y0=t,this._xi=e,this._yi=t,this},lineTo:function(e,t){var n=_(e-this._xi)>this._ux||_(t-this._yi)>this._uy||this._len<5;return this.addData(u.L,e,t),this._ctx&&n&&(this._needsDash()?this._dashedLineTo(e,t):this._ctx.lineTo(e,t)),n&&(this._xi=e,this._yi=t),this},bezierCurveTo:function(e,t,n,i,r,a){return this.addData(u.C,e,t,n,i,r,a),this._ctx&&(this._needsDash()?this._dashedBezierTo(e,t,n,i,r,a):this._ctx.bezierCurveTo(e,t,n,i,r,a)),this._xi=r,this._yi=a,this},quadraticCurveTo:function(e,t,n,i){return this.addData(u.Q,e,t,n,i),this._ctx&&(this._needsDash()?this._dashedQuadraticTo(e,t,n,i):this._ctx.quadraticCurveTo(e,t,n,i)),this._xi=n,this._yi=i,this},arc:function(e,t,n,i,r,a){return this.addData(u.A,e,t,n,n,i,r-i,0,a?0:1),this._ctx&&this._ctx.arc(e,t,n,i,r,a),this._xi=m(r)*n+e,this._yi=v(r)*n+e,this},arcTo:function(e,t,n,i,r){return this._ctx&&this._ctx.arcTo(e,t,n,i,r),this},rect:function(e,t,n,i){return this._ctx&&this._ctx.rect(e,t,n,i),this.addData(u.R,e,t,n,i),this},closePath:function(){this.addData(u.Z);var e=this._ctx,t=this._x0,n=this._y0;return e&&(this._needsDash()&&this._dashedLineTo(t,n),e.closePath()),this._xi=t,this._yi=n,this},fill:function(e){e&&e.fill(),this.toStatic()},stroke:function(e){e&&e.stroke(),this.toStatic()},setLineDash:function(e){if(e instanceof Array){this._lineDash=e,this._dashIdx=0;for(var t=0,n=0;n<e.length;n++)t+=e[n];this._dashSum=t}return this},setLineDashOffset:function(e){return this._dashOffset=e,this},len:function(){return this._len},setData:function(e){var t=e.length;this.data&&this.data.length==t||!b||(this.data=new Float32Array(t));for(var n=0;n<t;n++)this.data[n]=e[n];this._len=t},appendPath:function(e){e instanceof Array||(e=[e]);for(var t=e.length,n=0,i=this._len,r=0;r<t;r++)n+=e[r].len();b&&this.data instanceof Float32Array&&(this.data=new Float32Array(i+n));for(r=0;r<t;r++)for(var a=e[r].data,o=0;o<a.length;o++)this.data[i++]=a[o];this._len=i},addData:function(e){if(this._saveData){var t=this.data;this._len+arguments.length>t.length&&(this._expandData(),t=this.data);for(var n=0;n<arguments.length;n++)t[this._len++]=arguments[n];this._prevCmd=e}},_expandData:function(){if(!(this.data instanceof Array)){for(var e=[],t=0;t<this._len;t++)e[t]=this.data[t];this.data=e}},_needsDash:function(){return this._lineDash},_dashedLineTo:function(e,t){var n,i,r=this._dashSum,a=this._dashOffset,o=this._lineDash,s=this._ctx,l=this._xi,u=this._yi,c=e-l,d=t-u,f=y(c*c+d*d),h=l,m=u,v=o.length;c/=f,d/=f,a<0&&(a=r+a),a%=r,h-=a*c,m-=a*d;while(c>0&&h<=e||c<0&&h>=e||0==c&&(d>0&&m<=t||d<0&&m>=t))i=this._dashIdx,n=o[i],h+=c*n,m+=d*n,this._dashIdx=(i+1)%v,c>0&&h<l||c<0&&h>l||d>0&&m<u||d<0&&m>u||s[i%2?"moveTo":"lineTo"](c>=0?p(h,e):g(h,e),d>=0?p(m,t):g(m,t));c=h-e,d=m-t,this._dashOffset=-y(c*c+d*d)},_dashedBezierTo:function(e,t,n,r,a,o){var s,l,u,c,d,f=this._dashSum,h=this._dashOffset,p=this._lineDash,g=this._ctx,m=this._xi,v=this._yi,_=i.cubicAt,b=0,E=this._dashIdx,T=p.length,S=0;for(h<0&&(h=f+h),h%=f,s=0;s<1;s+=.1)l=_(m,e,n,a,s+.1)-_(m,e,n,a,s),u=_(v,t,r,o,s+.1)-_(v,t,r,o,s),b+=y(l*l+u*u);for(;E<T;E++)if(S+=p[E],S>h)break;s=(S-h)/b;while(s<=1)c=_(m,e,n,a,s),d=_(v,t,r,o,s),E%2?g.moveTo(c,d):g.lineTo(c,d),s+=p[E]/b,E=(E+1)%T;E%2!==0&&g.lineTo(a,o),l=a-c,u=o-d,this._dashOffset=-y(l*l+u*u)},_dashedQuadraticTo:function(e,t,n,i){var r=n,a=i;n=(n+2*e)/3,i=(i+2*t)/3,e=(this._xi+2*e)/3,t=(this._yi+2*t)/3,this._dashedBezierTo(e,t,n,i,r,a)},toStatic:function(){var e=this.data;e instanceof Array&&(e.length=this._len,b&&(this.data=new Float32Array(e)))},getBoundingRect:function(){c[0]=c[1]=f[0]=f[1]=Number.MAX_VALUE,d[0]=d[1]=h[0]=h[1]=-Number.MAX_VALUE;for(var e=this.data,t=0,n=0,i=0,s=0,l=0;l<e.length;){var p=e[l++];switch(1==l&&(t=e[l],n=e[l+1],i=t,s=n),p){case u.M:i=e[l++],s=e[l++],t=i,n=s,f[0]=i,f[1]=s,h[0]=i,h[1]=s;break;case u.L:a.fromLine(t,n,e[l],e[l+1],f,h),t=e[l++],n=e[l++];break;case u.C:a.fromCubic(t,n,e[l++],e[l++],e[l++],e[l++],e[l],e[l+1],f,h),t=e[l++],n=e[l++];break;case u.Q:a.fromQuadratic(t,n,e[l++],e[l++],e[l],e[l+1],f,h),t=e[l++],n=e[l++];break;case u.A:var g=e[l++],y=e[l++],_=e[l++],b=e[l++],E=e[l++],T=e[l++]+E,S=(e[l++],1-e[l++]);1==l&&(i=m(E)*_+g,s=v(E)*b+y),a.fromArc(g,y,_,b,E,T,S,f,h),t=m(T)*_+g,n=v(T)*b+y;break;case u.R:i=t=e[l++],s=n=e[l++];var w=e[l++],A=e[l++];a.fromLine(i,s,i+w,s+A,f,h);break;case u.Z:t=i,n=s;break}r.min(c,c,f),r.max(d,d,h)}return 0===l&&(c[0]=c[1]=d[0]=d[1]=0),new o(c[0],c[1],d[0]-c[0],d[1]-c[1])},rebuildPath:function(e){for(var t,n,i,r,a,o,s=this.data,l=this._ux,c=this._uy,d=this._len,f=0;f<d;){var h=s[f++];switch(1==f&&(i=s[f],r=s[f+1],t=i,n=r),h){case u.M:t=i=s[f++],n=r=s[f++],e.moveTo(i,r);break;case u.L:a=s[f++],o=s[f++],(_(a-i)>l||_(o-r)>c||f===d-1)&&(e.lineTo(a,o),i=a,r=o);break;case u.C:e.bezierCurveTo(s[f++],s[f++],s[f++],s[f++],s[f++],s[f++]),i=s[f-2],r=s[f-1];break;case u.Q:e.quadraticCurveTo(s[f++],s[f++],s[f++],s[f++]),i=s[f-2],r=s[f-1];break;case u.A:var p=s[f++],g=s[f++],y=s[f++],b=s[f++],E=s[f++],T=s[f++],S=s[f++],w=s[f++],A=y>b?y:b,I=y>b?1:y/b,x=y>b?b/y:1,R=Math.abs(y-b)>.001,C=E+T;R?(e.translate(p,g),e.rotate(S),e.scale(I,x),e.arc(0,0,A,E,C,1-w),e.scale(1/I,1/x),e.rotate(-S),e.translate(-p,-g)):e.arc(p,g,A,E,C,1-w),1==f&&(t=m(E)*y+p,n=v(E)*b+g),i=m(C)*y+p,r=v(C)*b+g;break;case u.R:t=i=s[f],n=r=s[f+1],e.rect(s[f++],s[f++],s[f++],s[f++]);break;case u.Z:e.closePath(),i=t,r=n}}}},E.CMD=u;var T=E;e.exports=T},2145:function(e,t){var n={};function i(e,t){n[e]=t}function r(e){return n[e]}t.register=i,t.get=r},"214f":function(e,t,n){"use strict";var i=n("32e9"),r=n("2aba"),a=n("79e5"),o=n("be13"),s=n("2b4c");e.exports=function(e,t,n){var l=s(e),u=n(o,l,""[e]),c=u[0],d=u[1];a(function(){var t={};return t[l]=function(){return 7},7!=""[e](t)})&&(r(String.prototype,e,c),i(RegExp.prototype,l,2==t?function(e,t){return d.call(e,this,t)}:function(e){return d.call(e,this)}))}},"216a":function(e,t,n){var i=n("6d8b"),r=n("3842"),a=n("eda2"),o=n("944e"),s=n("89e3"),l=s.prototype,u=Math.ceil,c=Math.floor,d=1e3,f=60*d,h=60*f,p=24*h,g=function(e,t,n,i){while(n<i){var r=n+i>>>1;e[r][1]<t?n=r+1:i=r}return n},m=s.extend({type:"time",getLabel:function(e){var t=this._stepLvl,n=new Date(e);return a.formatTime(t[0],n,this.getSetting("useUTC"))},niceExtent:function(e){var t=this._extent;if(t[0]===t[1]&&(t[0]-=p,t[1]+=p),t[1]===-1/0&&t[0]===1/0){var n=new Date;t[1]=+new Date(n.getFullYear(),n.getMonth(),n.getDate()),t[0]=t[1]-p}this.niceTicks(e.splitNumber,e.minInterval,e.maxInterval);var i=this._interval;e.fixMin||(t[0]=r.round(c(t[0]/i)*i)),e.fixMax||(t[1]=r.round(u(t[1]/i)*i))},niceTicks:function(e,t,n){e=e||10;var i=this._extent,a=i[1]-i[0],s=a/e;null!=t&&s<t&&(s=t),null!=n&&s>n&&(s=n);var l=v.length,d=g(v,s,0,l),f=v[Math.min(d,l-1)],h=f[1];if("year"===f[0]){var p=a/h,m=r.nice(p/e,!0);h*=m}var y=this.getSetting("useUTC")?0:60*new Date(+i[0]||+i[1]).getTimezoneOffset()*1e3,_=[Math.round(u((i[0]-y)/h)*h+y),Math.round(c((i[1]-y)/h)*h+y)];o.fixExtent(_,i),this._stepLvl=f,this._interval=h,this._niceExtent=_},parse:function(e){return+r.parseDate(e)}});i.each(["contain","normalize"],function(e){m.prototype[e]=function(t){return l[e].call(this,this.parse(t))}});var v=[["hh:mm:ss",d],["hh:mm:ss",5*d],["hh:mm:ss",10*d],["hh:mm:ss",15*d],["hh:mm:ss",30*d],["hh:mm\nMM-dd",f],["hh:mm\nMM-dd",5*f],["hh:mm\nMM-dd",10*f],["hh:mm\nMM-dd",15*f],["hh:mm\nMM-dd",30*f],["hh:mm\nMM-dd",h],["hh:mm\nMM-dd",2*h],["hh:mm\nMM-dd",6*h],["hh:mm\nMM-dd",12*h],["MM-dd\nyyyy",p],["MM-dd\nyyyy",2*p],["MM-dd\nyyyy",3*p],["MM-dd\nyyyy",4*p],["MM-dd\nyyyy",5*p],["MM-dd\nyyyy",6*p],["week",7*p],["MM-dd\nyyyy",10*p],["week",14*p],["week",21*p],["month",31*p],["week",42*p],["month",62*p],["week",42*p],["quarter",380*p/4],["month",31*p*4],["month",31*p*5],["half-year",380*p/2],["month",31*p*8],["month",31*p*10],["year",380*p]];m.create=function(e){return new m({useUTC:e.ecModel.get("useUTC")})};var y=m;e.exports=y},"217b":function(e,t,n){var i=n("4e08"),r=(i.__DEV__,n("3301")),a=n("4f85"),o=a.extend({type:"series.line",dependencies:["grid","polar"],getInitialData:function(e,t){return r(this.getSource(),this)},defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,hoverAnimation:!0,clipOverflow:!0,label:{position:"top"},lineStyle:{width:2,type:"solid"},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:4,symbolRotate:null,showSymbol:!0,showAllSymbol:"auto",connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:1/0}});e.exports=o},"22d1":function(e,t){var n={};n="object"===typeof wx&&"function"===typeof wx.getSystemInfoSync?{browser:{},os:{},node:!1,wxa:!0,canvasSupported:!0,svgSupported:!1,touchEventsSupported:!0}:"undefined"===typeof document&&"undefined"!==typeof self?{browser:{},os:{},node:!1,worker:!0,canvasSupported:!0}:"undefined"===typeof navigator?{browser:{},os:{},node:!0,worker:!1,canvasSupported:!0,svgSupported:!0}:r(navigator.userAgent);var i=n;function r(e){var t={},n={},i=e.match(/Firefox\/([\d.]+)/),r=e.match(/MSIE\s([\d.]+)/)||e.match(/Trident\/.+?rv:(([\d.]+))/),a=e.match(/Edge\/([\d.]+)/),o=/micromessenger/i.test(e);return i&&(n.firefox=!0,n.version=i[1]),r&&(n.ie=!0,n.version=r[1]),a&&(n.edge=!0,n.version=a[1]),o&&(n.weChat=!0),{browser:n,os:t,node:!1,canvasSupported:!!document.createElement("canvas").getContext,svgSupported:"undefined"!==typeof SVGRect,touchEventsSupported:"ontouchstart"in window&&!n.ie&&!n.edge,pointerEventsSupported:"onpointerdown"in window&&(n.edge||n.ie&&n.version>=11)}}e.exports=i},2306:function(e,t,n){var i=n("6d8b"),r=n("342d"),a=n("41ef"),o=n("1687"),s=n("401b"),l=n("cbe5"),u=n("0cde"),c=n("0da8");t.Image=c;var d=n("e1fc");t.Group=d;var f=n("76a5");t.Text=f;var h=n("d9fc");t.Circle=h;var p=n("4aa2");t.Sector=p;var g=n("4573");t.Ring=g;var m=n("87b1");t.Polygon=m;var v=n("d498");t.Polyline=v;var y=n("c7a2");t.Rect=y;var _=n("cb11");t.Line=_;var b=n("ac0f");t.BezierCurve=b;var E=n("8d32");t.Arc=E;var T=n("d4c6");t.CompoundPath=T;var S=n("48a9");t.LinearGradient=S;var w=n("dded");t.RadialGradient=w;var A=n("9850");t.BoundingRect=A;var I=n("392f");t.IncrementalDisplayable=I;var x=Math.round,R=Math.max,C=Math.min,D={};function k(e){return l.extend(e)}function M(e,t){return r.extendFromString(e,t)}function L(e,t,n,i){var a=r.createFromString(e,t),o=a.getBoundingRect();return n&&("center"===i&&(n=N(n,o)),F(a,n)),a}function P(e,t,n){var i=new c({style:{image:e,x:t.x,y:t.y,width:t.width,height:t.height},onload:function(e){if("center"===n){var r={width:e.width,height:e.height};i.setStyle(N(t,r))}}});return i}function N(e,t){var n,i=t.width/t.height,r=e.height*i;r<=e.width?n=e.height:(r=e.width,n=r/i);var a=e.x+e.width/2,o=e.y+e.height/2;return{x:a-r/2,y:o-n/2,width:r,height:n}}var O=r.mergePath;function F(e,t){if(e.applyTransform){var n=e.getBoundingRect(),i=n.calculateTransform(t);e.applyTransform(i)}}function U(e){var t=e.shape,n=e.style.lineWidth;return x(2*t.x1)===x(2*t.x2)&&(t.x1=t.x2=G(t.x1,n,!0)),x(2*t.y1)===x(2*t.y2)&&(t.y1=t.y2=G(t.y1,n,!0)),e}function B(e){var t=e.shape,n=e.style.lineWidth,i=t.x,r=t.y,a=t.width,o=t.height;return t.x=G(t.x,n,!0),t.y=G(t.y,n,!0),t.width=Math.max(G(i+a,n,!1)-t.x,0===a?0:1),t.height=Math.max(G(r+o,n,!1)-t.y,0===o?0:1),e}function G(e,t,n){var i=x(2*e);return(i+x(t))%2===0?i/2:(i+(n?1:-1))/2}function j(e){return null!=e&&"none"!=e}function V(e){return"string"===typeof e?a.lift(e,-.1):e}function H(e){if(e.__hoverStlDirty){var t=e.style.stroke,n=e.style.fill,i=e.__hoverStl;i.fill=i.fill||(j(n)?V(n):null),i.stroke=i.stroke||(j(t)?V(t):null);var r={};for(var a in i)null!=i[a]&&(r[a]=e.style[a]);e.__normalStl=r,e.__hoverStlDirty=!1}}function K(e){if(!e.__isHover){if(H(e),e.useHoverLayer)e.__zr&&e.__zr.addHover(e,e.__hoverStl);else{var t=e.style,n=t.insideRollbackOpt;n&&le(t),t.extendFrom(e.__hoverStl),n&&(se(t,t.insideOriginalTextPosition,n),null==t.textFill&&(t.textFill=n.autoColor)),e.dirty(!1),e.z2+=1}e.__isHover=!0}}function z(e){if(e.__isHover){var t=e.__normalStl;e.useHoverLayer?e.__zr&&e.__zr.removeHover(e):(t&&e.setStyle(t),e.z2-=1),e.__isHover=!1}}function Z(e){"group"===e.type?e.traverse(function(e){"group"!==e.type&&K(e)}):K(e)}function q(e){"group"===e.type?e.traverse(function(e){"group"!==e.type&&z(e)}):z(e)}function Y(e,t){e.__hoverStl=e.hoverStyle||t||{},e.__hoverStlDirty=!0,e.__isHover&&H(e)}function W(e){this.__hoverSilentOnTouch&&e.zrByTouch||!this.__isEmphasis&&Z(this)}function $(e){this.__hoverSilentOnTouch&&e.zrByTouch||!this.__isEmphasis&&q(this)}function X(){this.__isEmphasis=!0,Z(this)}function Q(){this.__isEmphasis=!1,q(this)}function J(e,t,n){e.__hoverSilentOnTouch=n&&n.hoverSilentOnTouch,"group"===e.type?e.traverse(function(e){"group"!==e.type&&Y(e,t)}):Y(e,t),e.on("mouseover",W).on("mouseout",$),e.on("emphasis",X).on("normal",Q)}function ee(e,t,n,r,a,o,s){a=a||D;var l,u=a.labelFetcher,c=a.labelDataIndex,d=a.labelDimIndex,f=n.getShallow("show"),h=r.getShallow("show");(f||h)&&(u&&(l=u.getFormattedLabel(c,"normal",null,d)),null==l&&(l=i.isFunction(a.defaultText)?a.defaultText(c,a):a.defaultText));var p=f?l:null,g=h?i.retrieve2(u?u.getFormattedLabel(c,"emphasis",null,d):null,l):null;null==p&&null==g||(te(e,n,o,a),te(t,r,s,a,!0)),e.text=p,t.text=g}function te(e,t,n,r,a){return ie(e,t,r,a),n&&i.extend(e,n),e.host&&e.host.dirty&&e.host.dirty(!1),e}function ne(e,t,n){var i,r={isRectText:!0};!1===n?i=!0:r.autoColor=n,ie(e,t,r,i),e.host&&e.host.dirty&&e.host.dirty(!1)}function ie(e,t,n,r){if(n=n||D,n.isRectText){var a=t.getShallow("position")||(r?null:"inside");"outside"===a&&(a="top"),e.textPosition=a,e.textOffset=t.getShallow("offset");var o=t.getShallow("rotate");null!=o&&(o*=Math.PI/180),e.textRotation=o,e.textDistance=i.retrieve2(t.getShallow("distance"),r?null:5)}var s,l=t.ecModel,u=l&&l.option.textStyle,c=re(t);if(c)for(var d in s={},c)if(c.hasOwnProperty(d)){var f=t.getModel(["rich",d]);ae(s[d]={},f,u,n,r)}return e.rich=s,ae(e,t,u,n,r,!0),n.forceRich&&!n.textStyle&&(n.textStyle={}),e}function re(e){var t;while(e&&e!==e.ecModel){var n=(e.option||D).rich;if(n)for(var i in t=t||{},n)n.hasOwnProperty(i)&&(t[i]=1);e=e.parentModel}return t}function ae(e,t,n,r,a,o){if(n=!a&&n||D,e.textFill=oe(t.getShallow("color"),r)||n.color,e.textStroke=oe(t.getShallow("textBorderColor"),r)||n.textBorderColor,e.textStrokeWidth=i.retrieve2(t.getShallow("textBorderWidth"),n.textBorderWidth),!a){if(o){var s=e.textPosition;e.insideRollback=se(e,s,r),e.insideOriginalTextPosition=s,e.insideRollbackOpt=r}null==e.textFill&&(e.textFill=r.autoColor)}e.fontStyle=t.getShallow("fontStyle")||n.fontStyle,e.fontWeight=t.getShallow("fontWeight")||n.fontWeight,e.fontSize=t.getShallow("fontSize")||n.fontSize,e.fontFamily=t.getShallow("fontFamily")||n.fontFamily,e.textAlign=t.getShallow("align"),e.textVerticalAlign=t.getShallow("verticalAlign")||t.getShallow("baseline"),e.textLineHeight=t.getShallow("lineHeight"),e.textWidth=t.getShallow("width"),e.textHeight=t.getShallow("height"),e.textTag=t.getShallow("tag"),o&&r.disableBox||(e.textBackgroundColor=oe(t.getShallow("backgroundColor"),r),e.textPadding=t.getShallow("padding"),e.textBorderColor=oe(t.getShallow("borderColor"),r),e.textBorderWidth=t.getShallow("borderWidth"),e.textBorderRadius=t.getShallow("borderRadius"),e.textBoxShadowColor=t.getShallow("shadowColor"),e.textBoxShadowBlur=t.getShallow("shadowBlur"),e.textBoxShadowOffsetX=t.getShallow("shadowOffsetX"),e.textBoxShadowOffsetY=t.getShallow("shadowOffsetY")),e.textShadowColor=t.getShallow("textShadowColor")||n.textShadowColor,e.textShadowBlur=t.getShallow("textShadowBlur")||n.textShadowBlur,e.textShadowOffsetX=t.getShallow("textShadowOffsetX")||n.textShadowOffsetX,e.textShadowOffsetY=t.getShallow("textShadowOffsetY")||n.textShadowOffsetY}function oe(e,t){return"auto"!==e?e:t&&t.autoColor?t.autoColor:null}function se(e,t,n){var i,r=n.useInsideStyle;return null==e.textFill&&!1!==r&&(!0===r||n.isRectText&&t&&"string"===typeof t&&t.indexOf("inside")>=0)&&(i={textFill:null,textStroke:e.textStroke,textStrokeWidth:e.textStrokeWidth},e.textFill="#fff",null==e.textStroke&&(e.textStroke=n.autoColor,null==e.textStrokeWidth&&(e.textStrokeWidth=2))),i}function le(e){var t=e.insideRollback;t&&(e.textFill=t.textFill,e.textStroke=t.textStroke,e.textStrokeWidth=t.textStrokeWidth)}function ue(e,t){var n=t||t.getModel("textStyle");return i.trim([e.fontStyle||n&&n.getShallow("fontStyle")||"",e.fontWeight||n&&n.getShallow("fontWeight")||"",(e.fontSize||n&&n.getShallow("fontSize")||12)+"px",e.fontFamily||n&&n.getShallow("fontFamily")||"sans-serif"].join(" "))}function ce(e,t,n,i,r,a){"function"===typeof r&&(a=r,r=null);var o=i&&i.isAnimationEnabled();if(o){var s=e?"Update":"",l=i.getShallow("animationDuration"+s),u=i.getShallow("animationEasing"+s),c=i.getShallow("animationDelay"+s);"function"===typeof c&&(c=c(r,i.getAnimationDelayParams?i.getAnimationDelayParams(t,r):null)),"function"===typeof l&&(l=l(r)),l>0?t.animateTo(n,l,c||0,u,a,!!a):(t.stopAnimation(),t.attr(n),a&&a())}else t.stopAnimation(),t.attr(n),a&&a()}function de(e,t,n,i,r){ce(!0,e,t,n,i,r)}function fe(e,t,n,i,r){ce(!1,e,t,n,i,r)}function he(e,t){var n=o.identity([]);while(e&&e!==t)o.mul(n,e.getLocalTransform(),n),e=e.parent;return n}function pe(e,t,n){return t&&!i.isArrayLike(t)&&(t=u.getLocalTransform(t)),n&&(t=o.invert([],t)),s.applyTransform([],e,t)}function ge(e,t,n){var i=0===t[4]||0===t[5]||0===t[0]?1:Math.abs(2*t[4]/t[0]),r=0===t[4]||0===t[5]||0===t[2]?1:Math.abs(2*t[4]/t[2]),a=["left"===e?-i:"right"===e?i:0,"top"===e?-r:"bottom"===e?r:0];return a=pe(a,t,n),Math.abs(a[0])>Math.abs(a[1])?a[0]>0?"right":"left":a[1]>0?"bottom":"top"}function me(e,t,n,r){if(e&&t){var a=o(e);t.traverse(function(e){if(!e.isGroup&&e.anid){var t=a[e.anid];if(t){var i=l(e);e.attr(l(t)),de(e,i,n,e.dataIndex)}}})}function o(e){var t={};return e.traverse(function(e){!e.isGroup&&e.anid&&(t[e.anid]=e)}),t}function l(e){var t={position:s.clone(e.position),rotation:e.rotation};return e.shape&&(t.shape=i.extend({},e.shape)),t}}function ve(e,t){return i.map(e,function(e){var n=e[0];n=R(n,t.x),n=C(n,t.x+t.width);var i=e[1];return i=R(i,t.y),i=C(i,t.y+t.height),[n,i]})}function ye(e,t){var n=R(e.x,t.x),i=C(e.x+e.width,t.x+t.width),r=R(e.y,t.y),a=C(e.y+e.height,t.y+t.height);if(i>=n&&a>=r)return{x:n,y:r,width:i-n,height:a-r}}function _e(e,t,n){t=i.extend({rectHover:!0},t);var r=t.style={strokeNoScale:!0};if(n=n||{x:-1,y:-1,width:2,height:2},e)return 0===e.indexOf("image://")?(r.image=e.slice(8),i.defaults(r,n),new c(t)):L(e.replace("path://",""),t,n,"center")}t.extendShape=k,t.extendPath=M,t.makePath=L,t.makeImage=P,t.mergePath=O,t.resizePath=F,t.subPixelOptimizeLine=U,t.subPixelOptimizeRect=B,t.subPixelOptimize=G,t.setHoverStyle=J,t.setLabelStyle=ee,t.setTextStyle=te,t.setText=ne,t.getFont=ue,t.updateProps=de,t.initProps=fe,t.getTransform=he,t.applyTransform=pe,t.transformDirection=ge,t.groupTransition=me,t.clipPointsByRect=ve,t.clipRectByRect=ye,t.createIcon=_e},"230e":function(e,t,n){var i=n("d3f4"),r=n("7726").document,a=i(r)&&i(r.createElement);e.exports=function(e){return a?r.createElement(e):{}}},"23c6":function(e,t,n){var i=n("2d95"),r=n("2b4c")("toStringTag"),a="Arguments"==i(function(){return arguments}()),o=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,n,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=o(t=Object(e),r))?n:a?i(t):"Object"==(s=i(t))&&"function"==typeof t.callee?"Arguments":s}},"26e1":function(e,t,n){var i=n("6d8b"),r=n("e0d3"),a=i.each,o=i.isObject,s=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"];function l(e){var t=e&&e.itemStyle;if(t)for(var n=0,r=s.length;n<r;n++){var a=s[n],o=t.normal,l=t.emphasis;o&&o[a]&&(e[a]=e[a]||{},e[a].normal?i.merge(e[a].normal,o[a]):e[a].normal=o[a],o[a]=null),l&&l[a]&&(e[a]=e[a]||{},e[a].emphasis?i.merge(e[a].emphasis,l[a]):e[a].emphasis=l[a],l[a]=null)}}function u(e,t,n){if(e&&e[t]&&(e[t].normal||e[t].emphasis)){var r=e[t].normal,a=e[t].emphasis;r&&(n?(e[t].normal=e[t].emphasis=null,i.defaults(e[t],r)):e[t]=r),a&&(e.emphasis=e.emphasis||{},e.emphasis[t]=a)}}function c(e){u(e,"itemStyle"),u(e,"lineStyle"),u(e,"areaStyle"),u(e,"label"),u(e,"labelLine"),u(e,"upperLabel"),u(e,"edgeLabel")}function d(e,t){var n=o(e)&&e[t],i=o(n)&&n.textStyle;if(i)for(var a=0,s=r.TEXT_STYLE_OPTIONS.length;a<s;a++){t=r.TEXT_STYLE_OPTIONS[a];i.hasOwnProperty(t)&&(n[t]=i[t])}}function f(e){e&&(c(e),d(e,"label"),e.emphasis&&d(e.emphasis,"label"))}function h(e){if(o(e)){l(e),c(e),d(e,"label"),d(e,"upperLabel"),d(e,"edgeLabel"),e.emphasis&&(d(e.emphasis,"label"),d(e.emphasis,"upperLabel"),d(e.emphasis,"edgeLabel"));var t=e.markPoint;t&&(l(t),f(t));var n=e.markLine;n&&(l(n),f(n));var r=e.markArea;r&&f(r);var a=e.data;if("graph"===e.type){a=a||e.nodes;var s=e.links||e.edges;if(s&&!i.isTypedArray(s))for(var h=0;h<s.length;h++)f(s[h]);i.each(e.categories,function(e){c(e)})}if(a&&!i.isTypedArray(a))for(h=0;h<a.length;h++)f(a[h]);t=e.markPoint;if(t&&t.data){var p=t.data;for(h=0;h<p.length;h++)f(p[h])}n=e.markLine;if(n&&n.data){var g=n.data;for(h=0;h<g.length;h++)i.isArray(g[h])?(f(g[h][0]),f(g[h][1])):f(g[h])}"gauge"===e.type?(d(e,"axisLabel"),d(e,"title"),d(e,"detail")):"treemap"===e.type?(u(e.breadcrumb,"itemStyle"),i.each(e.levels,function(e){c(e)})):"tree"===e.type&&c(e.leaves)}}function p(e){return i.isArray(e)?e:e?[e]:[]}function g(e){return(i.isArray(e)?e[0]:e)||{}}function m(e,t){a(p(e.series),function(e){o(e)&&h(e)});var n=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","parallelAxis","radar"];t&&n.push("valueAxis","categoryAxis","logAxis","timeAxis"),a(n,function(t){a(p(e[t]),function(e){e&&(d(e,"axisLabel"),d(e.axisPointer,"label"))})}),a(p(e.parallel),function(e){var t=e&&e.parallelAxisDefault;d(t,"axisLabel"),d(t&&t.axisPointer,"label")}),a(p(e.calendar),function(e){u(e,"itemStyle"),d(e,"dayLabel"),d(e,"monthLabel"),d(e,"yearLabel")}),a(p(e.radar),function(e){d(e,"name")}),a(p(e.geo),function(e){o(e)&&(f(e),a(p(e.regions),function(e){f(e)}))}),a(p(e.timeline),function(e){f(e),u(e,"label"),u(e,"itemStyle"),u(e,"controlStyle",!0);var t=e.data;i.isArray(t)&&i.each(t,function(e){i.isObject(e)&&(u(e,"label"),u(e,"itemStyle"))})}),a(p(e.toolbox),function(e){u(e,"iconStyle"),a(e.feature,function(e){u(e,"iconStyle")})}),d(g(e.axisPointer),"label"),d(g(e.tooltip).axisPointer,"label")}e.exports=m},"27ee":function(e,t,n){var i=n("23c6"),r=n("2b4c")("iterator"),a=n("84f2");e.exports=n("8378").getIteratorMethod=function(e){if(void 0!=e)return e[r]||e["@@iterator"]||a[i(e)]}},"282b":function(e,t,n){var i=n("6d8b");function r(e){for(var t=0;t<e.length;t++)e[t][1]||(e[t][1]=e[t][0]);return function(t,n,r){for(var a={},o=0;o<e.length;o++){var s=e[o][1];if(!(n&&i.indexOf(n,s)>=0||r&&i.indexOf(r,s)<0)){var l=t.getShallow(s);null!=l&&(a[e[o][0]]=l)}}return a}}e.exports=r},2877:function(e,t,n){"use strict";function i(e,t,n,i,r,a,o,s){var l,u="function"===typeof e?e.options:e;if(t&&(u.render=t,u.staticRenderFns=n,u._compiled=!0),i&&(u.functional=!0),a&&(u._scopeId="data-v-"+a),o?(l=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(o)},u._ssrRegister=l):r&&(l=s?function(){r.call(this,this.$root.$options.shadowRoot)}:r),l)if(u.functional){u._injectStyles=l;var c=u.render;u.render=function(e,t){return l.call(t),c(e,t)}}else{var d=u.beforeCreate;u.beforeCreate=d?[].concat(d,l):[l]}return{exports:e,options:u}}n.d(t,"a",function(){return i})},"29a8":function(e,t){var n={toolbox:{brush:{title:{rect:"",polygon:"",lineX:"",lineY:"",keep:"",clear:""}},dataView:{title:"",lang:["","",""]},dataZoom:{title:{zoom:"",back:""}},magicType:{title:{line:"",bar:"",stack:"",tiled:""}},restore:{title:""},saveAsImage:{title:"",lang:[""]}},series:{typeNames:{pie:"",bar:"",line:"",scatter:"",effectScatter:"",radar:"",tree:"",treemap:"",boxplot:"",candlestick:"K",k:"K",heatmap:"",map:"",parallel:"",lines:"",graph:"",sankey:"",funnel:"",gauge:"",pictorialBar:"",themeRiver:"",sunburst:""}},aria:{general:{withTitle:"{title}",withoutTitle:""},series:{single:{prefix:"",withName:"{seriesType}{seriesName}",withoutName:"{seriesType}"},multiple:{prefix:"{seriesCount}",withName:"{seriesId}{seriesName}{seriesType}",withoutName:"{seriesId}{seriesType}",separator:{middle:"",end:""}}},data:{allData:"",partialData:"{displayCnt}",withName:"{name}{value}",withoutName:"{value}",separator:{middle:"",end:""}}}};e.exports=n},"2aba":function(e,t,n){var i=n("7726"),r=n("32e9"),a=n("69a8"),o=n("ca5a")("src"),s="toString",l=Function[s],u=(""+l).split(s);n("8378").inspectSource=function(e){return l.call(e)},(e.exports=function(e,t,n,s){var l="function"==typeof n;l&&(a(n,"name")||r(n,"name",t)),e[t]!==n&&(l&&(a(n,o)||r(n,o,e[t]?""+e[t]:u.join(String(t)))),e===i?e[t]=n:s?e[t]?e[t]=n:r(e,t,n):(delete e[t],r(e,t,n)))})(Function.prototype,s,function(){return"function"==typeof this&&this[o]||l.call(this)})},"2aeb":function(e,t,n){var i=n("cb7c"),r=n("1495"),a=n("e11e"),o=n("613b")("IE_PROTO"),s=function(){},l="prototype",u=function(){var e,t=n("230e")("iframe"),i=a.length,r="<",o=">";t.style.display="none",n("fab2").appendChild(t),t.src="javascript:",e=t.contentWindow.document,e.open(),e.write(r+"script"+o+"document.F=Object"+r+"/script"+o),e.close(),u=e.F;while(i--)delete u[l][a[i]];return u()};e.exports=Object.create||function(e,t){var n;return null!==e?(s[l]=i(e),n=new s,s[l]=null,n[o]=e):n=u(),void 0===t?n:r(n,t)}},"2b0e":function(e,t,n){"use strict";(function(e){
/*!
 * Vue.js v2.5.17
 * (c) 2014-2018 Evan You
 * Released under the MIT License.
 */
var n=Object.freeze({});function i(e){return void 0===e||null===e}function r(e){return void 0!==e&&null!==e}function a(e){return!0===e}function o(e){return!1===e}function s(e){return"string"===typeof e||"number"===typeof e||"symbol"===typeof e||"boolean"===typeof e}function l(e){return null!==e&&"object"===typeof e}var u=Object.prototype.toString;function c(e){return"[object Object]"===u.call(e)}function d(e){return"[object RegExp]"===u.call(e)}function f(e){var t=parseFloat(String(e));return t>=0&&Math.floor(t)===t&&isFinite(e)}function h(e){return null==e?"":"object"===typeof e?JSON.stringify(e,null,2):String(e)}function p(e){var t=parseFloat(e);return isNaN(t)?e:t}function g(e,t){for(var n=Object.create(null),i=e.split(","),r=0;r<i.length;r++)n[i[r]]=!0;return t?function(e){return n[e.toLowerCase()]}:function(e){return n[e]}}g("slot,component",!0);var m=g("key,ref,slot,slot-scope,is");function v(e,t){if(e.length){var n=e.indexOf(t);if(n>-1)return e.splice(n,1)}}var y=Object.prototype.hasOwnProperty;function _(e,t){return y.call(e,t)}function b(e){var t=Object.create(null);return function(n){var i=t[n];return i||(t[n]=e(n))}}var E=/-(\w)/g,T=b(function(e){return e.replace(E,function(e,t){return t?t.toUpperCase():""})}),S=b(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}),w=/\B([A-Z])/g,A=b(function(e){return e.replace(w,"-$1").toLowerCase()});function I(e,t){function n(n){var i=arguments.length;return i?i>1?e.apply(t,arguments):e.call(t,n):e.call(t)}return n._length=e.length,n}function x(e,t){return e.bind(t)}var R=Function.prototype.bind?x:I;function C(e,t){t=t||0;var n=e.length-t,i=new Array(n);while(n--)i[n]=e[n+t];return i}function D(e,t){for(var n in t)e[n]=t[n];return e}function k(e){for(var t={},n=0;n<e.length;n++)e[n]&&D(t,e[n]);return t}function M(e,t,n){}var L=function(e,t,n){return!1},P=function(e){return e};function N(e,t){if(e===t)return!0;var n=l(e),i=l(t);if(!n||!i)return!n&&!i&&String(e)===String(t);try{var r=Array.isArray(e),a=Array.isArray(t);if(r&&a)return e.length===t.length&&e.every(function(e,n){return N(e,t[n])});if(r||a)return!1;var o=Object.keys(e),s=Object.keys(t);return o.length===s.length&&o.every(function(n){return N(e[n],t[n])})}catch(e){return!1}}function O(e,t){for(var n=0;n<e.length;n++)if(N(e[n],t))return n;return-1}function F(e){var t=!1;return function(){t||(t=!0,e.apply(this,arguments))}}var U="data-server-rendered",B=["component","directive","filter"],G=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured"],j={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:L,isReservedAttr:L,isUnknownElement:L,getTagNamespace:M,parsePlatformTagName:P,mustUseProp:L,_lifecycleHooks:G};function V(e){var t=(e+"").charCodeAt(0);return 36===t||95===t}function H(e,t,n,i){Object.defineProperty(e,t,{value:n,enumerable:!!i,writable:!0,configurable:!0})}var K=/[^\w.$]/;function z(e){if(!K.test(e)){var t=e.split(".");return function(e){for(var n=0;n<t.length;n++){if(!e)return;e=e[t[n]]}return e}}}var Z,q="__proto__"in{},Y="undefined"!==typeof window,W="undefined"!==typeof WXEnvironment&&!!WXEnvironment.platform,$=W&&WXEnvironment.platform.toLowerCase(),X=Y&&window.navigator.userAgent.toLowerCase(),Q=X&&/msie|trident/.test(X),J=X&&X.indexOf("msie 9.0")>0,ee=X&&X.indexOf("edge/")>0,te=(X&&X.indexOf("android"),X&&/iphone|ipad|ipod|ios/.test(X)||"ios"===$),ne=(X&&/chrome\/\d+/.test(X),{}.watch),ie=!1;if(Y)try{var re={};Object.defineProperty(re,"passive",{get:function(){ie=!0}}),window.addEventListener("test-passive",null,re)}catch(e){}var ae=function(){return void 0===Z&&(Z=!Y&&!W&&"undefined"!==typeof e&&"server"===e["process"].env.VUE_ENV),Z},oe=Y&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function se(e){return"function"===typeof e&&/native code/.test(e.toString())}var le,ue="undefined"!==typeof Symbol&&se(Symbol)&&"undefined"!==typeof Reflect&&se(Reflect.ownKeys);le="undefined"!==typeof Set&&se(Set)?Set:function(){function e(){this.set=Object.create(null)}return e.prototype.has=function(e){return!0===this.set[e]},e.prototype.add=function(e){this.set[e]=!0},e.prototype.clear=function(){this.set=Object.create(null)},e}();var ce=M,de=0,fe=function(){this.id=de++,this.subs=[]};fe.prototype.addSub=function(e){this.subs.push(e)},fe.prototype.removeSub=function(e){v(this.subs,e)},fe.prototype.depend=function(){fe.target&&fe.target.addDep(this)},fe.prototype.notify=function(){for(var e=this.subs.slice(),t=0,n=e.length;t<n;t++)e[t].update()},fe.target=null;var he=[];function pe(e){fe.target&&he.push(fe.target),fe.target=e}function ge(){fe.target=he.pop()}var me=function(e,t,n,i,r,a,o,s){this.tag=e,this.data=t,this.children=n,this.text=i,this.elm=r,this.ns=void 0,this.context=a,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=t&&t.key,this.componentOptions=o,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=s,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1},ve={child:{configurable:!0}};ve.child.get=function(){return this.componentInstance},Object.defineProperties(me.prototype,ve);var ye=function(e){void 0===e&&(e="");var t=new me;return t.text=e,t.isComment=!0,t};function _e(e){return new me(void 0,void 0,void 0,String(e))}function be(e){var t=new me(e.tag,e.data,e.children,e.text,e.elm,e.context,e.componentOptions,e.asyncFactory);return t.ns=e.ns,t.isStatic=e.isStatic,t.key=e.key,t.isComment=e.isComment,t.fnContext=e.fnContext,t.fnOptions=e.fnOptions,t.fnScopeId=e.fnScopeId,t.isCloned=!0,t}var Ee=Array.prototype,Te=Object.create(Ee),Se=["push","pop","shift","unshift","splice","sort","reverse"];Se.forEach(function(e){var t=Ee[e];H(Te,e,function(){var n=[],i=arguments.length;while(i--)n[i]=arguments[i];var r,a=t.apply(this,n),o=this.__ob__;switch(e){case"push":case"unshift":r=n;break;case"splice":r=n.slice(2);break}return r&&o.observeArray(r),o.dep.notify(),a})});var we=Object.getOwnPropertyNames(Te),Ae=!0;function Ie(e){Ae=e}var xe=function(e){if(this.value=e,this.dep=new fe,this.vmCount=0,H(e,"__ob__",this),Array.isArray(e)){var t=q?Re:Ce;t(e,Te,we),this.observeArray(e)}else this.walk(e)};function Re(e,t,n){e.__proto__=t}function Ce(e,t,n){for(var i=0,r=n.length;i<r;i++){var a=n[i];H(e,a,t[a])}}function De(e,t){var n;if(l(e)&&!(e instanceof me))return _(e,"__ob__")&&e.__ob__ instanceof xe?n=e.__ob__:Ae&&!ae()&&(Array.isArray(e)||c(e))&&Object.isExtensible(e)&&!e._isVue&&(n=new xe(e)),t&&n&&n.vmCount++,n}function ke(e,t,n,i,r){var a=new fe,o=Object.getOwnPropertyDescriptor(e,t);if(!o||!1!==o.configurable){var s=o&&o.get;s||2!==arguments.length||(n=e[t]);var l=o&&o.set,u=!r&&De(n);Object.defineProperty(e,t,{enumerable:!0,configurable:!0,get:function(){var t=s?s.call(e):n;return fe.target&&(a.depend(),u&&(u.dep.depend(),Array.isArray(t)&&Pe(t))),t},set:function(t){var i=s?s.call(e):n;t===i||t!==t&&i!==i||(l?l.call(e,t):n=t,u=!r&&De(t),a.notify())}})}}function Me(e,t,n){if(Array.isArray(e)&&f(t))return e.length=Math.max(e.length,t),e.splice(t,1,n),n;if(t in e&&!(t in Object.prototype))return e[t]=n,n;var i=e.__ob__;return e._isVue||i&&i.vmCount?n:i?(ke(i.value,t,n),i.dep.notify(),n):(e[t]=n,n)}function Le(e,t){if(Array.isArray(e)&&f(t))e.splice(t,1);else{var n=e.__ob__;e._isVue||n&&n.vmCount||_(e,t)&&(delete e[t],n&&n.dep.notify())}}function Pe(e){for(var t=void 0,n=0,i=e.length;n<i;n++)t=e[n],t&&t.__ob__&&t.__ob__.dep.depend(),Array.isArray(t)&&Pe(t)}xe.prototype.walk=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)ke(e,t[n])},xe.prototype.observeArray=function(e){for(var t=0,n=e.length;t<n;t++)De(e[t])};var Ne=j.optionMergeStrategies;function Oe(e,t){if(!t)return e;for(var n,i,r,a=Object.keys(t),o=0;o<a.length;o++)n=a[o],i=e[n],r=t[n],_(e,n)?c(i)&&c(r)&&Oe(i,r):Me(e,n,r);return e}function Fe(e,t,n){return n?function(){var i="function"===typeof t?t.call(n,n):t,r="function"===typeof e?e.call(n,n):e;return i?Oe(i,r):r}:t?e?function(){return Oe("function"===typeof t?t.call(this,this):t,"function"===typeof e?e.call(this,this):e)}:t:e}function Ue(e,t){return t?e?e.concat(t):Array.isArray(t)?t:[t]:e}function Be(e,t,n,i){var r=Object.create(e||null);return t?D(r,t):r}Ne.data=function(e,t,n){return n?Fe(e,t,n):t&&"function"!==typeof t?e:Fe(e,t)},G.forEach(function(e){Ne[e]=Ue}),B.forEach(function(e){Ne[e+"s"]=Be}),Ne.watch=function(e,t,n,i){if(e===ne&&(e=void 0),t===ne&&(t=void 0),!t)return Object.create(e||null);if(!e)return t;var r={};for(var a in D(r,e),t){var o=r[a],s=t[a];o&&!Array.isArray(o)&&(o=[o]),r[a]=o?o.concat(s):Array.isArray(s)?s:[s]}return r},Ne.props=Ne.methods=Ne.inject=Ne.computed=function(e,t,n,i){if(!e)return t;var r=Object.create(null);return D(r,e),t&&D(r,t),r},Ne.provide=Fe;var Ge=function(e,t){return void 0===t?e:t};function je(e,t){var n=e.props;if(n){var i,r,a,o={};if(Array.isArray(n)){i=n.length;while(i--)r=n[i],"string"===typeof r&&(a=T(r),o[a]={type:null})}else if(c(n))for(var s in n)r=n[s],a=T(s),o[a]=c(r)?r:{type:r};else 0;e.props=o}}function Ve(e,t){var n=e.inject;if(n){var i=e.inject={};if(Array.isArray(n))for(var r=0;r<n.length;r++)i[n[r]]={from:n[r]};else if(c(n))for(var a in n){var o=n[a];i[a]=c(o)?D({from:a},o):{from:o}}else 0}}function He(e){var t=e.directives;if(t)for(var n in t){var i=t[n];"function"===typeof i&&(t[n]={bind:i,update:i})}}function Ke(e,t,n){"function"===typeof t&&(t=t.options),je(t,n),Ve(t,n),He(t);var i=t.extends;if(i&&(e=Ke(e,i,n)),t.mixins)for(var r=0,a=t.mixins.length;r<a;r++)e=Ke(e,t.mixins[r],n);var o,s={};for(o in e)l(o);for(o in t)_(e,o)||l(o);function l(i){var r=Ne[i]||Ge;s[i]=r(e[i],t[i],n,i)}return s}function ze(e,t,n,i){if("string"===typeof n){var r=e[t];if(_(r,n))return r[n];var a=T(n);if(_(r,a))return r[a];var o=S(a);if(_(r,o))return r[o];var s=r[n]||r[a]||r[o];return s}}function Ze(e,t,n,i){var r=t[e],a=!_(n,e),o=n[e],s=$e(Boolean,r.type);if(s>-1)if(a&&!_(r,"default"))o=!1;else if(""===o||o===A(e)){var l=$e(String,r.type);(l<0||s<l)&&(o=!0)}if(void 0===o){o=qe(i,r,e);var u=Ae;Ie(!0),De(o),Ie(u)}return o}function qe(e,t,n){if(_(t,"default")){var i=t.default;return e&&e.$options.propsData&&void 0===e.$options.propsData[n]&&void 0!==e._props[n]?e._props[n]:"function"===typeof i&&"Function"!==Ye(t.type)?i.call(e):i}}function Ye(e){var t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:""}function We(e,t){return Ye(e)===Ye(t)}function $e(e,t){if(!Array.isArray(t))return We(t,e)?0:-1;for(var n=0,i=t.length;n<i;n++)if(We(t[n],e))return n;return-1}function Xe(e,t,n){if(t){var i=t;while(i=i.$parent){var r=i.$options.errorCaptured;if(r)for(var a=0;a<r.length;a++)try{var o=!1===r[a].call(i,e,t,n);if(o)return}catch(e){Qe(e,i,"errorCaptured hook")}}}Qe(e,t,n)}function Qe(e,t,n){if(j.errorHandler)try{return j.errorHandler.call(null,e,t,n)}catch(e){Je(e,null,"config.errorHandler")}Je(e,t,n)}function Je(e,t,n){if(!Y&&!W||"undefined"===typeof console)throw e;console.error(e)}var et,tt,nt=[],it=!1;function rt(){it=!1;var e=nt.slice(0);nt.length=0;for(var t=0;t<e.length;t++)e[t]()}var at=!1;if("undefined"!==typeof setImmediate&&se(setImmediate))tt=function(){setImmediate(rt)};else if("undefined"===typeof MessageChannel||!se(MessageChannel)&&"[object MessageChannelConstructor]"!==MessageChannel.toString())tt=function(){setTimeout(rt,0)};else{var ot=new MessageChannel,st=ot.port2;ot.port1.onmessage=rt,tt=function(){st.postMessage(1)}}if("undefined"!==typeof Promise&&se(Promise)){var lt=Promise.resolve();et=function(){lt.then(rt),te&&setTimeout(M)}}else et=tt;function ut(e){return e._withTask||(e._withTask=function(){at=!0;var t=e.apply(null,arguments);return at=!1,t})}function ct(e,t){var n;if(nt.push(function(){if(e)try{e.call(t)}catch(e){Xe(e,t,"nextTick")}else n&&n(t)}),it||(it=!0,at?tt():et()),!e&&"undefined"!==typeof Promise)return new Promise(function(e){n=e})}var dt=new le;function ft(e){ht(e,dt),dt.clear()}function ht(e,t){var n,i,r=Array.isArray(e);if(!(!r&&!l(e)||Object.isFrozen(e)||e instanceof me)){if(e.__ob__){var a=e.__ob__.dep.id;if(t.has(a))return;t.add(a)}if(r){n=e.length;while(n--)ht(e[n],t)}else{i=Object.keys(e),n=i.length;while(n--)ht(e[i[n]],t)}}}var pt,gt=b(function(e){var t="&"===e.charAt(0);e=t?e.slice(1):e;var n="~"===e.charAt(0);e=n?e.slice(1):e;var i="!"===e.charAt(0);return e=i?e.slice(1):e,{name:e,once:n,capture:i,passive:t}});function mt(e){function t(){var e=arguments,n=t.fns;if(!Array.isArray(n))return n.apply(null,arguments);for(var i=n.slice(),r=0;r<i.length;r++)i[r].apply(null,e)}return t.fns=e,t}function vt(e,t,n,r,a){var o,s,l,u;for(o in e)s=e[o],l=t[o],u=gt(o),i(s)||(i(l)?(i(s.fns)&&(s=e[o]=mt(s)),n(u.name,s,u.once,u.capture,u.passive,u.params)):s!==l&&(l.fns=s,e[o]=l));for(o in t)i(e[o])&&(u=gt(o),r(u.name,t[o],u.capture))}function yt(e,t,n){var o;e instanceof me&&(e=e.data.hook||(e.data.hook={}));var s=e[t];function l(){n.apply(this,arguments),v(o.fns,l)}i(s)?o=mt([l]):r(s.fns)&&a(s.merged)?(o=s,o.fns.push(l)):o=mt([s,l]),o.merged=!0,e[t]=o}function _t(e,t,n){var a=t.options.props;if(!i(a)){var o={},s=e.attrs,l=e.props;if(r(s)||r(l))for(var u in a){var c=A(u);bt(o,l,u,c,!0)||bt(o,s,u,c,!1)}return o}}function bt(e,t,n,i,a){if(r(t)){if(_(t,n))return e[n]=t[n],a||delete t[n],!0;if(_(t,i))return e[n]=t[i],a||delete t[i],!0}return!1}function Et(e){for(var t=0;t<e.length;t++)if(Array.isArray(e[t]))return Array.prototype.concat.apply([],e);return e}function Tt(e){return s(e)?[_e(e)]:Array.isArray(e)?wt(e):void 0}function St(e){return r(e)&&r(e.text)&&o(e.isComment)}function wt(e,t){var n,o,l,u,c=[];for(n=0;n<e.length;n++)o=e[n],i(o)||"boolean"===typeof o||(l=c.length-1,u=c[l],Array.isArray(o)?o.length>0&&(o=wt(o,(t||"")+"_"+n),St(o[0])&&St(u)&&(c[l]=_e(u.text+o[0].text),o.shift()),c.push.apply(c,o)):s(o)?St(u)?c[l]=_e(u.text+o):""!==o&&c.push(_e(o)):St(o)&&St(u)?c[l]=_e(u.text+o.text):(a(e._isVList)&&r(o.tag)&&i(o.key)&&r(t)&&(o.key="__vlist"+t+"_"+n+"__"),c.push(o)));return c}function At(e,t){return(e.__esModule||ue&&"Module"===e[Symbol.toStringTag])&&(e=e.default),l(e)?t.extend(e):e}function It(e,t,n,i,r){var a=ye();return a.asyncFactory=e,a.asyncMeta={data:t,context:n,children:i,tag:r},a}function xt(e,t,n){if(a(e.error)&&r(e.errorComp))return e.errorComp;if(r(e.resolved))return e.resolved;if(a(e.loading)&&r(e.loadingComp))return e.loadingComp;if(!r(e.contexts)){var o=e.contexts=[n],s=!0,u=function(){for(var e=0,t=o.length;e<t;e++)o[e].$forceUpdate()},c=F(function(n){e.resolved=At(n,t),s||u()}),d=F(function(t){r(e.errorComp)&&(e.error=!0,u())}),f=e(c,d);return l(f)&&("function"===typeof f.then?i(e.resolved)&&f.then(c,d):r(f.component)&&"function"===typeof f.component.then&&(f.component.then(c,d),r(f.error)&&(e.errorComp=At(f.error,t)),r(f.loading)&&(e.loadingComp=At(f.loading,t),0===f.delay?e.loading=!0:setTimeout(function(){i(e.resolved)&&i(e.error)&&(e.loading=!0,u())},f.delay||200)),r(f.timeout)&&setTimeout(function(){i(e.resolved)&&d(null)},f.timeout))),s=!1,e.loading?e.loadingComp:e.resolved}e.contexts.push(n)}function Rt(e){return e.isComment&&e.asyncFactory}function Ct(e){if(Array.isArray(e))for(var t=0;t<e.length;t++){var n=e[t];if(r(n)&&(r(n.componentOptions)||Rt(n)))return n}}function Dt(e){e._events=Object.create(null),e._hasHookEvent=!1;var t=e.$options._parentListeners;t&&Lt(e,t)}function kt(e,t,n){n?pt.$once(e,t):pt.$on(e,t)}function Mt(e,t){pt.$off(e,t)}function Lt(e,t,n){pt=e,vt(t,n||{},kt,Mt,e),pt=void 0}function Pt(e){var t=/^hook:/;e.prototype.$on=function(e,n){var i=this,r=this;if(Array.isArray(e))for(var a=0,o=e.length;a<o;a++)i.$on(e[a],n);else(r._events[e]||(r._events[e]=[])).push(n),t.test(e)&&(r._hasHookEvent=!0);return r},e.prototype.$once=function(e,t){var n=this;function i(){n.$off(e,i),t.apply(n,arguments)}return i.fn=t,n.$on(e,i),n},e.prototype.$off=function(e,t){var n=this,i=this;if(!arguments.length)return i._events=Object.create(null),i;if(Array.isArray(e)){for(var r=0,a=e.length;r<a;r++)n.$off(e[r],t);return i}var o=i._events[e];if(!o)return i;if(!t)return i._events[e]=null,i;if(t){var s,l=o.length;while(l--)if(s=o[l],s===t||s.fn===t){o.splice(l,1);break}}return i},e.prototype.$emit=function(e){var t=this,n=t._events[e];if(n){n=n.length>1?C(n):n;for(var i=C(arguments,1),r=0,a=n.length;r<a;r++)try{n[r].apply(t,i)}catch(n){Xe(n,t,'event handler for "'+e+'"')}}return t}}function Nt(e,t){var n={};if(!e)return n;for(var i=0,r=e.length;i<r;i++){var a=e[i],o=a.data;if(o&&o.attrs&&o.attrs.slot&&delete o.attrs.slot,a.context!==t&&a.fnContext!==t||!o||null==o.slot)(n.default||(n.default=[])).push(a);else{var s=o.slot,l=n[s]||(n[s]=[]);"template"===a.tag?l.push.apply(l,a.children||[]):l.push(a)}}for(var u in n)n[u].every(Ot)&&delete n[u];return n}function Ot(e){return e.isComment&&!e.asyncFactory||" "===e.text}function Ft(e,t){t=t||{};for(var n=0;n<e.length;n++)Array.isArray(e[n])?Ft(e[n],t):t[e[n].key]=e[n].fn;return t}var Ut=null;function Bt(e){var t=e.$options,n=t.parent;if(n&&!t.abstract){while(n.$options.abstract&&n.$parent)n=n.$parent;n.$children.push(e)}e.$parent=n,e.$root=n?n.$root:e,e.$children=[],e.$refs={},e._watcher=null,e._inactive=null,e._directInactive=!1,e._isMounted=!1,e._isDestroyed=!1,e._isBeingDestroyed=!1}function Gt(e){e.prototype._update=function(e,t){var n=this;n._isMounted&&Zt(n,"beforeUpdate");var i=n.$el,r=n._vnode,a=Ut;Ut=n,n._vnode=e,r?n.$el=n.__patch__(r,e):(n.$el=n.__patch__(n.$el,e,t,!1,n.$options._parentElm,n.$options._refElm),n.$options._parentElm=n.$options._refElm=null),Ut=a,i&&(i.__vue__=null),n.$el&&(n.$el.__vue__=n),n.$vnode&&n.$parent&&n.$vnode===n.$parent._vnode&&(n.$parent.$el=n.$el)},e.prototype.$forceUpdate=function(){var e=this;e._watcher&&e._watcher.update()},e.prototype.$destroy=function(){var e=this;if(!e._isBeingDestroyed){Zt(e,"beforeDestroy"),e._isBeingDestroyed=!0;var t=e.$parent;!t||t._isBeingDestroyed||e.$options.abstract||v(t.$children,e),e._watcher&&e._watcher.teardown();var n=e._watchers.length;while(n--)e._watchers[n].teardown();e._data.__ob__&&e._data.__ob__.vmCount--,e._isDestroyed=!0,e.__patch__(e._vnode,null),Zt(e,"destroyed"),e.$off(),e.$el&&(e.$el.__vue__=null),e.$vnode&&(e.$vnode.parent=null)}}}function jt(e,t,n){var i;return e.$el=t,e.$options.render||(e.$options.render=ye),Zt(e,"beforeMount"),i=function(){e._update(e._render(),n)},new sn(e,i,M,null,!0),n=!1,null==e.$vnode&&(e._isMounted=!0,Zt(e,"mounted")),e}function Vt(e,t,i,r,a){var o=!!(a||e.$options._renderChildren||r.data.scopedSlots||e.$scopedSlots!==n);if(e.$options._parentVnode=r,e.$vnode=r,e._vnode&&(e._vnode.parent=r),e.$options._renderChildren=a,e.$attrs=r.data.attrs||n,e.$listeners=i||n,t&&e.$options.props){Ie(!1);for(var s=e._props,l=e.$options._propKeys||[],u=0;u<l.length;u++){var c=l[u],d=e.$options.props;s[c]=Ze(c,d,t,e)}Ie(!0),e.$options.propsData=t}i=i||n;var f=e.$options._parentListeners;e.$options._parentListeners=i,Lt(e,i,f),o&&(e.$slots=Nt(a,r.context),e.$forceUpdate())}function Ht(e){while(e&&(e=e.$parent))if(e._inactive)return!0;return!1}function Kt(e,t){if(t){if(e._directInactive=!1,Ht(e))return}else if(e._directInactive)return;if(e._inactive||null===e._inactive){e._inactive=!1;for(var n=0;n<e.$children.length;n++)Kt(e.$children[n]);Zt(e,"activated")}}function zt(e,t){if((!t||(e._directInactive=!0,!Ht(e)))&&!e._inactive){e._inactive=!0;for(var n=0;n<e.$children.length;n++)zt(e.$children[n]);Zt(e,"deactivated")}}function Zt(e,t){pe();var n=e.$options[t];if(n)for(var i=0,r=n.length;i<r;i++)try{n[i].call(e)}catch(n){Xe(n,e,t+" hook")}e._hasHookEvent&&e.$emit("hook:"+t),ge()}var qt=[],Yt=[],Wt={},$t=!1,Xt=!1,Qt=0;function Jt(){Qt=qt.length=Yt.length=0,Wt={},$t=Xt=!1}function en(){var e,t;for(Xt=!0,qt.sort(function(e,t){return e.id-t.id}),Qt=0;Qt<qt.length;Qt++)e=qt[Qt],t=e.id,Wt[t]=null,e.run();var n=Yt.slice(),i=qt.slice();Jt(),rn(n),tn(i),oe&&j.devtools&&oe.emit("flush")}function tn(e){var t=e.length;while(t--){var n=e[t],i=n.vm;i._watcher===n&&i._isMounted&&Zt(i,"updated")}}function nn(e){e._inactive=!1,Yt.push(e)}function rn(e){for(var t=0;t<e.length;t++)e[t]._inactive=!0,Kt(e[t],!0)}function an(e){var t=e.id;if(null==Wt[t]){if(Wt[t]=!0,Xt){var n=qt.length-1;while(n>Qt&&qt[n].id>e.id)n--;qt.splice(n+1,0,e)}else qt.push(e);$t||($t=!0,ct(en))}}var on=0,sn=function(e,t,n,i,r){this.vm=e,r&&(e._watcher=this),e._watchers.push(this),i?(this.deep=!!i.deep,this.user=!!i.user,this.lazy=!!i.lazy,this.sync=!!i.sync):this.deep=this.user=this.lazy=this.sync=!1,this.cb=n,this.id=++on,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new le,this.newDepIds=new le,this.expression="","function"===typeof t?this.getter=t:(this.getter=z(t),this.getter||(this.getter=function(){})),this.value=this.lazy?void 0:this.get()};sn.prototype.get=function(){var e;pe(this);var t=this.vm;try{e=this.getter.call(t,t)}catch(e){if(!this.user)throw e;Xe(e,t,'getter for watcher "'+this.expression+'"')}finally{this.deep&&ft(e),ge(),this.cleanupDeps()}return e},sn.prototype.addDep=function(e){var t=e.id;this.newDepIds.has(t)||(this.newDepIds.add(t),this.newDeps.push(e),this.depIds.has(t)||e.addSub(this))},sn.prototype.cleanupDeps=function(){var e=this,t=this.deps.length;while(t--){var n=e.deps[t];e.newDepIds.has(n.id)||n.removeSub(e)}var i=this.depIds;this.depIds=this.newDepIds,this.newDepIds=i,this.newDepIds.clear(),i=this.deps,this.deps=this.newDeps,this.newDeps=i,this.newDeps.length=0},sn.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():an(this)},sn.prototype.run=function(){if(this.active){var e=this.get();if(e!==this.value||l(e)||this.deep){var t=this.value;if(this.value=e,this.user)try{this.cb.call(this.vm,e,t)}catch(e){Xe(e,this.vm,'callback for watcher "'+this.expression+'"')}else this.cb.call(this.vm,e,t)}}},sn.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},sn.prototype.depend=function(){var e=this,t=this.deps.length;while(t--)e.deps[t].depend()},sn.prototype.teardown=function(){var e=this;if(this.active){this.vm._isBeingDestroyed||v(this.vm._watchers,this);var t=this.deps.length;while(t--)e.deps[t].removeSub(e);this.active=!1}};var ln={enumerable:!0,configurable:!0,get:M,set:M};function un(e,t,n){ln.get=function(){return this[t][n]},ln.set=function(e){this[t][n]=e},Object.defineProperty(e,n,ln)}function cn(e){e._watchers=[];var t=e.$options;t.props&&dn(e,t.props),t.methods&&yn(e,t.methods),t.data?fn(e):De(e._data={},!0),t.computed&&gn(e,t.computed),t.watch&&t.watch!==ne&&_n(e,t.watch)}function dn(e,t){var n=e.$options.propsData||{},i=e._props={},r=e.$options._propKeys=[],a=!e.$parent;a||Ie(!1);var o=function(a){r.push(a);var o=Ze(a,t,n,e);ke(i,a,o),a in e||un(e,"_props",a)};for(var s in t)o(s);Ie(!0)}function fn(e){var t=e.$options.data;t=e._data="function"===typeof t?hn(t,e):t||{},c(t)||(t={});var n=Object.keys(t),i=e.$options.props,r=(e.$options.methods,n.length);while(r--){var a=n[r];0,i&&_(i,a)||V(a)||un(e,"_data",a)}De(t,!0)}function hn(e,t){pe();try{return e.call(t,t)}catch(e){return Xe(e,t,"data()"),{}}finally{ge()}}var pn={lazy:!0};function gn(e,t){var n=e._computedWatchers=Object.create(null),i=ae();for(var r in t){var a=t[r],o="function"===typeof a?a:a.get;0,i||(n[r]=new sn(e,o||M,M,pn)),r in e||mn(e,r,a)}}function mn(e,t,n){var i=!ae();"function"===typeof n?(ln.get=i?vn(t):n,ln.set=M):(ln.get=n.get?i&&!1!==n.cache?vn(t):n.get:M,ln.set=n.set?n.set:M),Object.defineProperty(e,t,ln)}function vn(e){return function(){var t=this._computedWatchers&&this._computedWatchers[e];if(t)return t.dirty&&t.evaluate(),fe.target&&t.depend(),t.value}}function yn(e,t){e.$options.props;for(var n in t)e[n]=null==t[n]?M:R(t[n],e)}function _n(e,t){for(var n in t){var i=t[n];if(Array.isArray(i))for(var r=0;r<i.length;r++)bn(e,n,i[r]);else bn(e,n,i)}}function bn(e,t,n,i){return c(n)&&(i=n,n=n.handler),"string"===typeof n&&(n=e[n]),e.$watch(t,n,i)}function En(e){var t={get:function(){return this._data}},n={get:function(){return this._props}};Object.defineProperty(e.prototype,"$data",t),Object.defineProperty(e.prototype,"$props",n),e.prototype.$set=Me,e.prototype.$delete=Le,e.prototype.$watch=function(e,t,n){var i=this;if(c(t))return bn(i,e,t,n);n=n||{},n.user=!0;var r=new sn(i,e,t,n);return n.immediate&&t.call(i,r.value),function(){r.teardown()}}}function Tn(e){var t=e.$options.provide;t&&(e._provided="function"===typeof t?t.call(e):t)}function Sn(e){var t=wn(e.$options.inject,e);t&&(Ie(!1),Object.keys(t).forEach(function(n){ke(e,n,t[n])}),Ie(!0))}function wn(e,t){if(e){for(var n=Object.create(null),i=ue?Reflect.ownKeys(e).filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}):Object.keys(e),r=0;r<i.length;r++){var a=i[r],o=e[a].from,s=t;while(s){if(s._provided&&_(s._provided,o)){n[a]=s._provided[o];break}s=s.$parent}if(!s)if("default"in e[a]){var l=e[a].default;n[a]="function"===typeof l?l.call(t):l}else 0}return n}}function An(e,t){var n,i,a,o,s;if(Array.isArray(e)||"string"===typeof e)for(n=new Array(e.length),i=0,a=e.length;i<a;i++)n[i]=t(e[i],i);else if("number"===typeof e)for(n=new Array(e),i=0;i<e;i++)n[i]=t(i+1,i);else if(l(e))for(o=Object.keys(e),n=new Array(o.length),i=0,a=o.length;i<a;i++)s=o[i],n[i]=t(e[s],s,i);return r(n)&&(n._isVList=!0),n}function In(e,t,n,i){var r,a=this.$scopedSlots[e];if(a)n=n||{},i&&(n=D(D({},i),n)),r=a(n)||t;else{var o=this.$slots[e];o&&(o._rendered=!0),r=o||t}var s=n&&n.slot;return s?this.$createElement("template",{slot:s},r):r}function xn(e){return ze(this.$options,"filters",e,!0)||P}function Rn(e,t){return Array.isArray(e)?-1===e.indexOf(t):e!==t}function Cn(e,t,n,i,r){var a=j.keyCodes[t]||n;return r&&i&&!j.keyCodes[t]?Rn(r,i):a?Rn(a,e):i?A(i)!==t:void 0}function Dn(e,t,n,i,r){if(n)if(l(n)){var a;Array.isArray(n)&&(n=k(n));var o=function(o){if("class"===o||"style"===o||m(o))a=e;else{var s=e.attrs&&e.attrs.type;a=i||j.mustUseProp(t,s,o)?e.domProps||(e.domProps={}):e.attrs||(e.attrs={})}if(!(o in a)&&(a[o]=n[o],r)){var l=e.on||(e.on={});l["update:"+o]=function(e){n[o]=e}}};for(var s in n)o(s)}else;return e}function kn(e,t){var n=this._staticTrees||(this._staticTrees=[]),i=n[e];return i&&!t?i:(i=n[e]=this.$options.staticRenderFns[e].call(this._renderProxy,null,this),Ln(i,"__static__"+e,!1),i)}function Mn(e,t,n){return Ln(e,"__once__"+t+(n?"_"+n:""),!0),e}function Ln(e,t,n){if(Array.isArray(e))for(var i=0;i<e.length;i++)e[i]&&"string"!==typeof e[i]&&Pn(e[i],t+"_"+i,n);else Pn(e,t,n)}function Pn(e,t,n){e.isStatic=!0,e.key=t,e.isOnce=n}function Nn(e,t){if(t)if(c(t)){var n=e.on=e.on?D({},e.on):{};for(var i in t){var r=n[i],a=t[i];n[i]=r?[].concat(r,a):a}}else;return e}function On(e){e._o=Mn,e._n=p,e._s=h,e._l=An,e._t=In,e._q=N,e._i=O,e._m=kn,e._f=xn,e._k=Cn,e._b=Dn,e._v=_e,e._e=ye,e._u=Ft,e._g=Nn}function Fn(e,t,i,r,o){var s,l=o.options;_(r,"_uid")?(s=Object.create(r),s._original=r):(s=r,r=r._original);var u=a(l._compiled),c=!u;this.data=e,this.props=t,this.children=i,this.parent=r,this.listeners=e.on||n,this.injections=wn(l.inject,r),this.slots=function(){return Nt(i,r)},u&&(this.$options=l,this.$slots=this.slots(),this.$scopedSlots=e.scopedSlots||n),l._scopeId?this._c=function(e,t,n,i){var a=Wn(s,e,t,n,i,c);return a&&!Array.isArray(a)&&(a.fnScopeId=l._scopeId,a.fnContext=r),a}:this._c=function(e,t,n,i){return Wn(s,e,t,n,i,c)}}function Un(e,t,i,a,o){var s=e.options,l={},u=s.props;if(r(u))for(var c in u)l[c]=Ze(c,u,t||n);else r(i.attrs)&&Gn(l,i.attrs),r(i.props)&&Gn(l,i.props);var d=new Fn(i,l,o,a,e),f=s.render.call(null,d._c,d);if(f instanceof me)return Bn(f,i,d.parent,s);if(Array.isArray(f)){for(var h=Tt(f)||[],p=new Array(h.length),g=0;g<h.length;g++)p[g]=Bn(h[g],i,d.parent,s);return p}}function Bn(e,t,n,i){var r=be(e);return r.fnContext=n,r.fnOptions=i,t.slot&&((r.data||(r.data={})).slot=t.slot),r}function Gn(e,t){for(var n in t)e[T(n)]=t[n]}On(Fn.prototype);var jn={init:function(e,t,n,i){if(e.componentInstance&&!e.componentInstance._isDestroyed&&e.data.keepAlive){var r=e;jn.prepatch(r,r)}else{var a=e.componentInstance=Kn(e,Ut,n,i);a.$mount(t?e.elm:void 0,t)}},prepatch:function(e,t){var n=t.componentOptions,i=t.componentInstance=e.componentInstance;Vt(i,n.propsData,n.listeners,t,n.children)},insert:function(e){var t=e.context,n=e.componentInstance;n._isMounted||(n._isMounted=!0,Zt(n,"mounted")),e.data.keepAlive&&(t._isMounted?nn(n):Kt(n,!0))},destroy:function(e){var t=e.componentInstance;t._isDestroyed||(e.data.keepAlive?zt(t,!0):t.$destroy())}},Vn=Object.keys(jn);function Hn(e,t,n,o,s){if(!i(e)){var u=n.$options._base;if(l(e)&&(e=u.extend(e)),"function"===typeof e){var c;if(i(e.cid)&&(c=e,e=xt(c,u,n),void 0===e))return It(c,t,n,o,s);t=t||{},ri(e),r(t.model)&&Zn(e.options,t);var d=_t(t,e,s);if(a(e.options.functional))return Un(e,d,t,n,o);var f=t.on;if(t.on=t.nativeOn,a(e.options.abstract)){var h=t.slot;t={},h&&(t.slot=h)}zn(t);var p=e.options.name||s,g=new me("vue-component-"+e.cid+(p?"-"+p:""),t,void 0,void 0,void 0,n,{Ctor:e,propsData:d,listeners:f,tag:s,children:o},c);return g}}}function Kn(e,t,n,i){var a={_isComponent:!0,parent:t,_parentVnode:e,_parentElm:n||null,_refElm:i||null},o=e.data.inlineTemplate;return r(o)&&(a.render=o.render,a.staticRenderFns=o.staticRenderFns),new e.componentOptions.Ctor(a)}function zn(e){for(var t=e.hook||(e.hook={}),n=0;n<Vn.length;n++){var i=Vn[n];t[i]=jn[i]}}function Zn(e,t){var n=e.model&&e.model.prop||"value",i=e.model&&e.model.event||"input";(t.props||(t.props={}))[n]=t.model.value;var a=t.on||(t.on={});r(a[i])?a[i]=[t.model.callback].concat(a[i]):a[i]=t.model.callback}var qn=1,Yn=2;function Wn(e,t,n,i,r,o){return(Array.isArray(n)||s(n))&&(r=i,i=n,n=void 0),a(o)&&(r=Yn),$n(e,t,n,i,r)}function $n(e,t,n,i,a){if(r(n)&&r(n.__ob__))return ye();if(r(n)&&r(n.is)&&(t=n.is),!t)return ye();var o,s,l;(Array.isArray(i)&&"function"===typeof i[0]&&(n=n||{},n.scopedSlots={default:i[0]},i.length=0),a===Yn?i=Tt(i):a===qn&&(i=Et(i)),"string"===typeof t)?(s=e.$vnode&&e.$vnode.ns||j.getTagNamespace(t),o=j.isReservedTag(t)?new me(j.parsePlatformTagName(t),n,i,void 0,void 0,e):r(l=ze(e.$options,"components",t))?Hn(l,n,e,i,t):new me(t,n,i,void 0,void 0,e)):o=Hn(t,n,e,i);return Array.isArray(o)?o:r(o)?(r(s)&&Xn(o,s),r(n)&&Qn(n),o):ye()}function Xn(e,t,n){if(e.ns=t,"foreignObject"===e.tag&&(t=void 0,n=!0),r(e.children))for(var o=0,s=e.children.length;o<s;o++){var l=e.children[o];r(l.tag)&&(i(l.ns)||a(n)&&"svg"!==l.tag)&&Xn(l,t,n)}}function Qn(e){l(e.style)&&ft(e.style),l(e.class)&&ft(e.class)}function Jn(e){e._vnode=null,e._staticTrees=null;var t=e.$options,i=e.$vnode=t._parentVnode,r=i&&i.context;e.$slots=Nt(t._renderChildren,r),e.$scopedSlots=n,e._c=function(t,n,i,r){return Wn(e,t,n,i,r,!1)},e.$createElement=function(t,n,i,r){return Wn(e,t,n,i,r,!0)};var a=i&&i.data;ke(e,"$attrs",a&&a.attrs||n,null,!0),ke(e,"$listeners",t._parentListeners||n,null,!0)}function ei(e){On(e.prototype),e.prototype.$nextTick=function(e){return ct(e,this)},e.prototype._render=function(){var e,t=this,i=t.$options,r=i.render,a=i._parentVnode;a&&(t.$scopedSlots=a.data.scopedSlots||n),t.$vnode=a;try{e=r.call(t._renderProxy,t.$createElement)}catch(n){Xe(n,t,"render"),e=t._vnode}return e instanceof me||(e=ye()),e.parent=a,e}}var ti=0;function ni(e){e.prototype._init=function(e){var t=this;t._uid=ti++,t._isVue=!0,e&&e._isComponent?ii(t,e):t.$options=Ke(ri(t.constructor),e||{},t),t._renderProxy=t,t._self=t,Bt(t),Dt(t),Jn(t),Zt(t,"beforeCreate"),Sn(t),cn(t),Tn(t),Zt(t,"created"),t.$options.el&&t.$mount(t.$options.el)}}function ii(e,t){var n=e.$options=Object.create(e.constructor.options),i=t._parentVnode;n.parent=t.parent,n._parentVnode=i,n._parentElm=t._parentElm,n._refElm=t._refElm;var r=i.componentOptions;n.propsData=r.propsData,n._parentListeners=r.listeners,n._renderChildren=r.children,n._componentTag=r.tag,t.render&&(n.render=t.render,n.staticRenderFns=t.staticRenderFns)}function ri(e){var t=e.options;if(e.super){var n=ri(e.super),i=e.superOptions;if(n!==i){e.superOptions=n;var r=ai(e);r&&D(e.extendOptions,r),t=e.options=Ke(n,e.extendOptions),t.name&&(t.components[t.name]=e)}}return t}function ai(e){var t,n=e.options,i=e.extendOptions,r=e.sealedOptions;for(var a in n)n[a]!==r[a]&&(t||(t={}),t[a]=oi(n[a],i[a],r[a]));return t}function oi(e,t,n){if(Array.isArray(e)){var i=[];n=Array.isArray(n)?n:[n],t=Array.isArray(t)?t:[t];for(var r=0;r<e.length;r++)(t.indexOf(e[r])>=0||n.indexOf(e[r])<0)&&i.push(e[r]);return i}return e}function si(e){this._init(e)}function li(e){e.use=function(e){var t=this._installedPlugins||(this._installedPlugins=[]);if(t.indexOf(e)>-1)return this;var n=C(arguments,1);return n.unshift(this),"function"===typeof e.install?e.install.apply(e,n):"function"===typeof e&&e.apply(null,n),t.push(e),this}}function ui(e){e.mixin=function(e){return this.options=Ke(this.options,e),this}}function ci(e){e.cid=0;var t=1;e.extend=function(e){e=e||{};var n=this,i=n.cid,r=e._Ctor||(e._Ctor={});if(r[i])return r[i];var a=e.name||n.options.name;var o=function(e){this._init(e)};return o.prototype=Object.create(n.prototype),o.prototype.constructor=o,o.cid=t++,o.options=Ke(n.options,e),o["super"]=n,o.options.props&&di(o),o.options.computed&&fi(o),o.extend=n.extend,o.mixin=n.mixin,o.use=n.use,B.forEach(function(e){o[e]=n[e]}),a&&(o.options.components[a]=o),o.superOptions=n.options,o.extendOptions=e,o.sealedOptions=D({},o.options),r[i]=o,o}}function di(e){var t=e.options.props;for(var n in t)un(e.prototype,"_props",n)}function fi(e){var t=e.options.computed;for(var n in t)mn(e.prototype,n,t[n])}function hi(e){B.forEach(function(t){e[t]=function(e,n){return n?("component"===t&&c(n)&&(n.name=n.name||e,n=this.options._base.extend(n)),"directive"===t&&"function"===typeof n&&(n={bind:n,update:n}),this.options[t+"s"][e]=n,n):this.options[t+"s"][e]}})}function pi(e){return e&&(e.Ctor.options.name||e.tag)}function gi(e,t){return Array.isArray(e)?e.indexOf(t)>-1:"string"===typeof e?e.split(",").indexOf(t)>-1:!!d(e)&&e.test(t)}function mi(e,t){var n=e.cache,i=e.keys,r=e._vnode;for(var a in n){var o=n[a];if(o){var s=pi(o.componentOptions);s&&!t(s)&&vi(n,a,i,r)}}}function vi(e,t,n,i){var r=e[t];!r||i&&r.tag===i.tag||r.componentInstance.$destroy(),e[t]=null,v(n,t)}ni(si),En(si),Pt(si),Gt(si),ei(si);var yi=[String,RegExp,Array],_i={name:"keep-alive",abstract:!0,props:{include:yi,exclude:yi,max:[String,Number]},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){var e=this;for(var t in e.cache)vi(e.cache,t,e.keys)},mounted:function(){var e=this;this.$watch("include",function(t){mi(e,function(e){return gi(t,e)})}),this.$watch("exclude",function(t){mi(e,function(e){return!gi(t,e)})})},render:function(){var e=this.$slots.default,t=Ct(e),n=t&&t.componentOptions;if(n){var i=pi(n),r=this,a=r.include,o=r.exclude;if(a&&(!i||!gi(a,i))||o&&i&&gi(o,i))return t;var s=this,l=s.cache,u=s.keys,c=null==t.key?n.Ctor.cid+(n.tag?"::"+n.tag:""):t.key;l[c]?(t.componentInstance=l[c].componentInstance,v(u,c),u.push(c)):(l[c]=t,u.push(c),this.max&&u.length>parseInt(this.max)&&vi(l,u[0],u,this._vnode)),t.data.keepAlive=!0}return t||e&&e[0]}},bi={KeepAlive:_i};function Ei(e){var t={get:function(){return j}};Object.defineProperty(e,"config",t),e.util={warn:ce,extend:D,mergeOptions:Ke,defineReactive:ke},e.set=Me,e.delete=Le,e.nextTick=ct,e.options=Object.create(null),B.forEach(function(t){e.options[t+"s"]=Object.create(null)}),e.options._base=e,D(e.options.components,bi),li(e),ui(e),ci(e),hi(e)}Ei(si),Object.defineProperty(si.prototype,"$isServer",{get:ae}),Object.defineProperty(si.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(si,"FunctionalRenderContext",{value:Fn}),si.version="2.5.17";var Ti=g("style,class"),Si=g("input,textarea,option,select,progress"),wi=function(e,t,n){return"value"===n&&Si(e)&&"button"!==t||"selected"===n&&"option"===e||"checked"===n&&"input"===e||"muted"===n&&"video"===e},Ai=g("contenteditable,draggable,spellcheck"),Ii=g("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,translate,truespeed,typemustmatch,visible"),xi="http://www.w3.org/1999/xlink",Ri=function(e){return":"===e.charAt(5)&&"xlink"===e.slice(0,5)},Ci=function(e){return Ri(e)?e.slice(6,e.length):""},Di=function(e){return null==e||!1===e};function ki(e){var t=e.data,n=e,i=e;while(r(i.componentInstance))i=i.componentInstance._vnode,i&&i.data&&(t=Mi(i.data,t));while(r(n=n.parent))n&&n.data&&(t=Mi(t,n.data));return Li(t.staticClass,t.class)}function Mi(e,t){return{staticClass:Pi(e.staticClass,t.staticClass),class:r(e.class)?[e.class,t.class]:t.class}}function Li(e,t){return r(e)||r(t)?Pi(e,Ni(t)):""}function Pi(e,t){return e?t?e+" "+t:e:t||""}function Ni(e){return Array.isArray(e)?Oi(e):l(e)?Fi(e):"string"===typeof e?e:""}function Oi(e){for(var t,n="",i=0,a=e.length;i<a;i++)r(t=Ni(e[i]))&&""!==t&&(n&&(n+=" "),n+=t);return n}function Fi(e){var t="";for(var n in e)e[n]&&(t&&(t+=" "),t+=n);return t}var Ui={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},Bi=g("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),Gi=g("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignObject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),ji=function(e){return Bi(e)||Gi(e)};function Vi(e){return Gi(e)?"svg":"math"===e?"math":void 0}var Hi=Object.create(null);function Ki(e){if(!Y)return!0;if(ji(e))return!1;if(e=e.toLowerCase(),null!=Hi[e])return Hi[e];var t=document.createElement(e);return e.indexOf("-")>-1?Hi[e]=t.constructor===window.HTMLUnknownElement||t.constructor===window.HTMLElement:Hi[e]=/HTMLUnknownElement/.test(t.toString())}var zi=g("text,number,password,search,email,tel,url");function Zi(e){if("string"===typeof e){var t=document.querySelector(e);return t||document.createElement("div")}return e}function qi(e,t){var n=document.createElement(e);return"select"!==e?n:(t.data&&t.data.attrs&&void 0!==t.data.attrs.multiple&&n.setAttribute("multiple","multiple"),n)}function Yi(e,t){return document.createElementNS(Ui[e],t)}function Wi(e){return document.createTextNode(e)}function $i(e){return document.createComment(e)}function Xi(e,t,n){e.insertBefore(t,n)}function Qi(e,t){e.removeChild(t)}function Ji(e,t){e.appendChild(t)}function er(e){return e.parentNode}function tr(e){return e.nextSibling}function nr(e){return e.tagName}function ir(e,t){e.textContent=t}function rr(e,t){e.setAttribute(t,"")}var ar=Object.freeze({createElement:qi,createElementNS:Yi,createTextNode:Wi,createComment:$i,insertBefore:Xi,removeChild:Qi,appendChild:Ji,parentNode:er,nextSibling:tr,tagName:nr,setTextContent:ir,setStyleScope:rr}),or={create:function(e,t){sr(t)},update:function(e,t){e.data.ref!==t.data.ref&&(sr(e,!0),sr(t))},destroy:function(e){sr(e,!0)}};function sr(e,t){var n=e.data.ref;if(r(n)){var i=e.context,a=e.componentInstance||e.elm,o=i.$refs;t?Array.isArray(o[n])?v(o[n],a):o[n]===a&&(o[n]=void 0):e.data.refInFor?Array.isArray(o[n])?o[n].indexOf(a)<0&&o[n].push(a):o[n]=[a]:o[n]=a}}var lr=new me("",{},[]),ur=["create","activate","update","remove","destroy"];function cr(e,t){return e.key===t.key&&(e.tag===t.tag&&e.isComment===t.isComment&&r(e.data)===r(t.data)&&dr(e,t)||a(e.isAsyncPlaceholder)&&e.asyncFactory===t.asyncFactory&&i(t.asyncFactory.error))}function dr(e,t){if("input"!==e.tag)return!0;var n,i=r(n=e.data)&&r(n=n.attrs)&&n.type,a=r(n=t.data)&&r(n=n.attrs)&&n.type;return i===a||zi(i)&&zi(a)}function fr(e,t,n){var i,a,o={};for(i=t;i<=n;++i)a=e[i].key,r(a)&&(o[a]=i);return o}function hr(e){var t,n,o={},l=e.modules,u=e.nodeOps;for(t=0;t<ur.length;++t)for(o[ur[t]]=[],n=0;n<l.length;++n)r(l[n][ur[t]])&&o[ur[t]].push(l[n][ur[t]]);function c(e){return new me(u.tagName(e).toLowerCase(),{},[],void 0,e)}function d(e,t){function n(){0===--n.listeners&&f(e)}return n.listeners=t,n}function f(e){var t=u.parentNode(e);r(t)&&u.removeChild(t,e)}function h(e,t,n,i,o,s,l){if(r(e.elm)&&r(s)&&(e=s[l]=be(e)),e.isRootInsert=!o,!p(e,t,n,i)){var c=e.data,d=e.children,f=e.tag;r(f)?(e.elm=e.ns?u.createElementNS(e.ns,f):u.createElement(f,e),T(e),_(e,d,t),r(c)&&E(e,t),y(n,e.elm,i)):a(e.isComment)?(e.elm=u.createComment(e.text),y(n,e.elm,i)):(e.elm=u.createTextNode(e.text),y(n,e.elm,i))}}function p(e,t,n,i){var o=e.data;if(r(o)){var s=r(e.componentInstance)&&o.keepAlive;if(r(o=o.hook)&&r(o=o.init)&&o(e,!1,n,i),r(e.componentInstance))return m(e,t),a(s)&&v(e,t,n,i),!0}}function m(e,t){r(e.data.pendingInsert)&&(t.push.apply(t,e.data.pendingInsert),e.data.pendingInsert=null),e.elm=e.componentInstance.$el,b(e)?(E(e,t),T(e)):(sr(e),t.push(e))}function v(e,t,n,i){var a,s=e;while(s.componentInstance)if(s=s.componentInstance._vnode,r(a=s.data)&&r(a=a.transition)){for(a=0;a<o.activate.length;++a)o.activate[a](lr,s);t.push(s);break}y(n,e.elm,i)}function y(e,t,n){r(e)&&(r(n)?n.parentNode===e&&u.insertBefore(e,t,n):u.appendChild(e,t))}function _(e,t,n){if(Array.isArray(t)){0;for(var i=0;i<t.length;++i)h(t[i],n,e.elm,null,!0,t,i)}else s(e.text)&&u.appendChild(e.elm,u.createTextNode(String(e.text)))}function b(e){while(e.componentInstance)e=e.componentInstance._vnode;return r(e.tag)}function E(e,n){for(var i=0;i<o.create.length;++i)o.create[i](lr,e);t=e.data.hook,r(t)&&(r(t.create)&&t.create(lr,e),r(t.insert)&&n.push(e))}function T(e){var t;if(r(t=e.fnScopeId))u.setStyleScope(e.elm,t);else{var n=e;while(n)r(t=n.context)&&r(t=t.$options._scopeId)&&u.setStyleScope(e.elm,t),n=n.parent}r(t=Ut)&&t!==e.context&&t!==e.fnContext&&r(t=t.$options._scopeId)&&u.setStyleScope(e.elm,t)}function S(e,t,n,i,r,a){for(;i<=r;++i)h(n[i],a,e,t,!1,n,i)}function w(e){var t,n,i=e.data;if(r(i))for(r(t=i.hook)&&r(t=t.destroy)&&t(e),t=0;t<o.destroy.length;++t)o.destroy[t](e);if(r(t=e.children))for(n=0;n<e.children.length;++n)w(e.children[n])}function A(e,t,n,i){for(;n<=i;++n){var a=t[n];r(a)&&(r(a.tag)?(I(a),w(a)):f(a.elm))}}function I(e,t){if(r(t)||r(e.data)){var n,i=o.remove.length+1;for(r(t)?t.listeners+=i:t=d(e.elm,i),r(n=e.componentInstance)&&r(n=n._vnode)&&r(n.data)&&I(n,t),n=0;n<o.remove.length;++n)o.remove[n](e,t);r(n=e.data.hook)&&r(n=n.remove)?n(e,t):t()}else f(e.elm)}function x(e,t,n,a,o){var s,l,c,d,f=0,p=0,g=t.length-1,m=t[0],v=t[g],y=n.length-1,_=n[0],b=n[y],E=!o;while(f<=g&&p<=y)i(m)?m=t[++f]:i(v)?v=t[--g]:cr(m,_)?(C(m,_,a),m=t[++f],_=n[++p]):cr(v,b)?(C(v,b,a),v=t[--g],b=n[--y]):cr(m,b)?(C(m,b,a),E&&u.insertBefore(e,m.elm,u.nextSibling(v.elm)),m=t[++f],b=n[--y]):cr(v,_)?(C(v,_,a),E&&u.insertBefore(e,v.elm,m.elm),v=t[--g],_=n[++p]):(i(s)&&(s=fr(t,f,g)),l=r(_.key)?s[_.key]:R(_,t,f,g),i(l)?h(_,a,e,m.elm,!1,n,p):(c=t[l],cr(c,_)?(C(c,_,a),t[l]=void 0,E&&u.insertBefore(e,c.elm,m.elm)):h(_,a,e,m.elm,!1,n,p)),_=n[++p]);f>g?(d=i(n[y+1])?null:n[y+1].elm,S(e,d,n,p,y,a)):p>y&&A(e,t,f,g)}function R(e,t,n,i){for(var a=n;a<i;a++){var o=t[a];if(r(o)&&cr(e,o))return a}}function C(e,t,n,s){if(e!==t){var l=t.elm=e.elm;if(a(e.isAsyncPlaceholder))r(t.asyncFactory.resolved)?M(e.elm,t,n):t.isAsyncPlaceholder=!0;else if(a(t.isStatic)&&a(e.isStatic)&&t.key===e.key&&(a(t.isCloned)||a(t.isOnce)))t.componentInstance=e.componentInstance;else{var c,d=t.data;r(d)&&r(c=d.hook)&&r(c=c.prepatch)&&c(e,t);var f=e.children,h=t.children;if(r(d)&&b(t)){for(c=0;c<o.update.length;++c)o.update[c](e,t);r(c=d.hook)&&r(c=c.update)&&c(e,t)}i(t.text)?r(f)&&r(h)?f!==h&&x(l,f,h,n,s):r(h)?(r(e.text)&&u.setTextContent(l,""),S(l,null,h,0,h.length-1,n)):r(f)?A(l,f,0,f.length-1):r(e.text)&&u.setTextContent(l,""):e.text!==t.text&&u.setTextContent(l,t.text),r(d)&&r(c=d.hook)&&r(c=c.postpatch)&&c(e,t)}}}function D(e,t,n){if(a(n)&&r(e.parent))e.parent.data.pendingInsert=t;else for(var i=0;i<t.length;++i)t[i].data.hook.insert(t[i])}var k=g("attrs,class,staticClass,staticStyle,key");function M(e,t,n,i){var o,s=t.tag,l=t.data,u=t.children;if(i=i||l&&l.pre,t.elm=e,a(t.isComment)&&r(t.asyncFactory))return t.isAsyncPlaceholder=!0,!0;if(r(l)&&(r(o=l.hook)&&r(o=o.init)&&o(t,!0),r(o=t.componentInstance)))return m(t,n),!0;if(r(s)){if(r(u))if(e.hasChildNodes())if(r(o=l)&&r(o=o.domProps)&&r(o=o.innerHTML)){if(o!==e.innerHTML)return!1}else{for(var c=!0,d=e.firstChild,f=0;f<u.length;f++){if(!d||!M(d,u[f],n,i)){c=!1;break}d=d.nextSibling}if(!c||d)return!1}else _(t,u,n);if(r(l)){var h=!1;for(var p in l)if(!k(p)){h=!0,E(t,n);break}!h&&l["class"]&&ft(l["class"])}}else e.data!==t.text&&(e.data=t.text);return!0}return function(e,t,n,s,l,d){if(!i(t)){var f=!1,p=[];if(i(e))f=!0,h(t,p,l,d);else{var g=r(e.nodeType);if(!g&&cr(e,t))C(e,t,p,s);else{if(g){if(1===e.nodeType&&e.hasAttribute(U)&&(e.removeAttribute(U),n=!0),a(n)&&M(e,t,p))return D(t,p,!0),e;e=c(e)}var m=e.elm,v=u.parentNode(m);if(h(t,p,m._leaveCb?null:v,u.nextSibling(m)),r(t.parent)){var y=t.parent,_=b(t);while(y){for(var E=0;E<o.destroy.length;++E)o.destroy[E](y);if(y.elm=t.elm,_){for(var T=0;T<o.create.length;++T)o.create[T](lr,y);var S=y.data.hook.insert;if(S.merged)for(var I=1;I<S.fns.length;I++)S.fns[I]()}else sr(y);y=y.parent}}r(v)?A(v,[e],0,0):r(e.tag)&&w(e)}}return D(t,p,f),t.elm}r(e)&&w(e)}}var pr={create:gr,update:gr,destroy:function(e){gr(e,lr)}};function gr(e,t){(e.data.directives||t.data.directives)&&mr(e,t)}function mr(e,t){var n,i,r,a=e===lr,o=t===lr,s=yr(e.data.directives,e.context),l=yr(t.data.directives,t.context),u=[],c=[];for(n in l)i=s[n],r=l[n],i?(r.oldValue=i.value,br(r,"update",t,e),r.def&&r.def.componentUpdated&&c.push(r)):(br(r,"bind",t,e),r.def&&r.def.inserted&&u.push(r));if(u.length){var d=function(){for(var n=0;n<u.length;n++)br(u[n],"inserted",t,e)};a?yt(t,"insert",d):d()}if(c.length&&yt(t,"postpatch",function(){for(var n=0;n<c.length;n++)br(c[n],"componentUpdated",t,e)}),!a)for(n in s)l[n]||br(s[n],"unbind",e,e,o)}var vr=Object.create(null);function yr(e,t){var n,i,r=Object.create(null);if(!e)return r;for(n=0;n<e.length;n++)i=e[n],i.modifiers||(i.modifiers=vr),r[_r(i)]=i,i.def=ze(t.$options,"directives",i.name,!0);return r}function _r(e){return e.rawName||e.name+"."+Object.keys(e.modifiers||{}).join(".")}function br(e,t,n,i,r){var a=e.def&&e.def[t];if(a)try{a(n.elm,e,n,i,r)}catch(i){Xe(i,n.context,"directive "+e.name+" "+t+" hook")}}var Er=[or,pr];function Tr(e,t){var n=t.componentOptions;if((!r(n)||!1!==n.Ctor.options.inheritAttrs)&&(!i(e.data.attrs)||!i(t.data.attrs))){var a,o,s,l=t.elm,u=e.data.attrs||{},c=t.data.attrs||{};for(a in r(c.__ob__)&&(c=t.data.attrs=D({},c)),c)o=c[a],s=u[a],s!==o&&Sr(l,a,o);for(a in(Q||ee)&&c.value!==u.value&&Sr(l,"value",c.value),u)i(c[a])&&(Ri(a)?l.removeAttributeNS(xi,Ci(a)):Ai(a)||l.removeAttribute(a))}}function Sr(e,t,n){e.tagName.indexOf("-")>-1?wr(e,t,n):Ii(t)?Di(n)?e.removeAttribute(t):(n="allowfullscreen"===t&&"EMBED"===e.tagName?"true":t,e.setAttribute(t,n)):Ai(t)?e.setAttribute(t,Di(n)||"false"===n?"false":"true"):Ri(t)?Di(n)?e.removeAttributeNS(xi,Ci(t)):e.setAttributeNS(xi,t,n):wr(e,t,n)}function wr(e,t,n){if(Di(n))e.removeAttribute(t);else{if(Q&&!J&&"TEXTAREA"===e.tagName&&"placeholder"===t&&!e.__ieph){var i=function(t){t.stopImmediatePropagation(),e.removeEventListener("input",i)};e.addEventListener("input",i),e.__ieph=!0}e.setAttribute(t,n)}}var Ar={create:Tr,update:Tr};function Ir(e,t){var n=t.elm,a=t.data,o=e.data;if(!(i(a.staticClass)&&i(a.class)&&(i(o)||i(o.staticClass)&&i(o.class)))){var s=ki(t),l=n._transitionClasses;r(l)&&(s=Pi(s,Ni(l))),s!==n._prevClass&&(n.setAttribute("class",s),n._prevClass=s)}}var xr,Rr={create:Ir,update:Ir},Cr="__r",Dr="__c";function kr(e){if(r(e[Cr])){var t=Q?"change":"input";e[t]=[].concat(e[Cr],e[t]||[]),delete e[Cr]}r(e[Dr])&&(e.change=[].concat(e[Dr],e.change||[]),delete e[Dr])}function Mr(e,t,n){var i=xr;return function r(){var a=e.apply(null,arguments);null!==a&&Pr(t,r,n,i)}}function Lr(e,t,n,i,r){t=ut(t),n&&(t=Mr(t,e,i)),xr.addEventListener(e,t,ie?{capture:i,passive:r}:i)}function Pr(e,t,n,i){(i||xr).removeEventListener(e,t._withTask||t,n)}function Nr(e,t){if(!i(e.data.on)||!i(t.data.on)){var n=t.data.on||{},r=e.data.on||{};xr=t.elm,kr(n),vt(n,r,Lr,Pr,t.context),xr=void 0}}var Or={create:Nr,update:Nr};function Fr(e,t){if(!i(e.data.domProps)||!i(t.data.domProps)){var n,a,o=t.elm,s=e.data.domProps||{},l=t.data.domProps||{};for(n in r(l.__ob__)&&(l=t.data.domProps=D({},l)),s)i(l[n])&&(o[n]="");for(n in l){if(a=l[n],"textContent"===n||"innerHTML"===n){if(t.children&&(t.children.length=0),a===s[n])continue;1===o.childNodes.length&&o.removeChild(o.childNodes[0])}if("value"===n){o._value=a;var u=i(a)?"":String(a);Ur(o,u)&&(o.value=u)}else o[n]=a}}}function Ur(e,t){return!e.composing&&("OPTION"===e.tagName||Br(e,t)||Gr(e,t))}function Br(e,t){var n=!0;try{n=document.activeElement!==e}catch(e){}return n&&e.value!==t}function Gr(e,t){var n=e.value,i=e._vModifiers;if(r(i)){if(i.lazy)return!1;if(i.number)return p(n)!==p(t);if(i.trim)return n.trim()!==t.trim()}return n!==t}var jr={create:Fr,update:Fr},Vr=b(function(e){var t={},n=/;(?![^(]*\))/g,i=/:(.+)/;return e.split(n).forEach(function(e){if(e){var n=e.split(i);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t});function Hr(e){var t=Kr(e.style);return e.staticStyle?D(e.staticStyle,t):t}function Kr(e){return Array.isArray(e)?k(e):"string"===typeof e?Vr(e):e}function zr(e,t){var n,i={};if(t){var r=e;while(r.componentInstance)r=r.componentInstance._vnode,r&&r.data&&(n=Hr(r.data))&&D(i,n)}(n=Hr(e.data))&&D(i,n);var a=e;while(a=a.parent)a.data&&(n=Hr(a.data))&&D(i,n);return i}var Zr,qr=/^--/,Yr=/\s*!important$/,Wr=function(e,t,n){if(qr.test(t))e.style.setProperty(t,n);else if(Yr.test(n))e.style.setProperty(t,n.replace(Yr,""),"important");else{var i=Xr(t);if(Array.isArray(n))for(var r=0,a=n.length;r<a;r++)e.style[i]=n[r];else e.style[i]=n}},$r=["Webkit","Moz","ms"],Xr=b(function(e){if(Zr=Zr||document.createElement("div").style,e=T(e),"filter"!==e&&e in Zr)return e;for(var t=e.charAt(0).toUpperCase()+e.slice(1),n=0;n<$r.length;n++){var i=$r[n]+t;if(i in Zr)return i}});function Qr(e,t){var n=t.data,a=e.data;if(!(i(n.staticStyle)&&i(n.style)&&i(a.staticStyle)&&i(a.style))){var o,s,l=t.elm,u=a.staticStyle,c=a.normalizedStyle||a.style||{},d=u||c,f=Kr(t.data.style)||{};t.data.normalizedStyle=r(f.__ob__)?D({},f):f;var h=zr(t,!0);for(s in d)i(h[s])&&Wr(l,s,"");for(s in h)o=h[s],o!==d[s]&&Wr(l,s,null==o?"":o)}}var Jr={create:Qr,update:Qr};function ea(e,t){if(t&&(t=t.trim()))if(e.classList)t.indexOf(" ")>-1?t.split(/\s+/).forEach(function(t){return e.classList.add(t)}):e.classList.add(t);else{var n=" "+(e.getAttribute("class")||"")+" ";n.indexOf(" "+t+" ")<0&&e.setAttribute("class",(n+t).trim())}}function ta(e,t){if(t&&(t=t.trim()))if(e.classList)t.indexOf(" ")>-1?t.split(/\s+/).forEach(function(t){return e.classList.remove(t)}):e.classList.remove(t),e.classList.length||e.removeAttribute("class");else{var n=" "+(e.getAttribute("class")||"")+" ",i=" "+t+" ";while(n.indexOf(i)>=0)n=n.replace(i," ");n=n.trim(),n?e.setAttribute("class",n):e.removeAttribute("class")}}function na(e){if(e){if("object"===typeof e){var t={};return!1!==e.css&&D(t,ia(e.name||"v")),D(t,e),t}return"string"===typeof e?ia(e):void 0}}var ia=b(function(e){return{enterClass:e+"-enter",enterToClass:e+"-enter-to",enterActiveClass:e+"-enter-active",leaveClass:e+"-leave",leaveToClass:e+"-leave-to",leaveActiveClass:e+"-leave-active"}}),ra=Y&&!J,aa="transition",oa="animation",sa="transition",la="transitionend",ua="animation",ca="animationend";ra&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(sa="WebkitTransition",la="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(ua="WebkitAnimation",ca="webkitAnimationEnd"));var da=Y?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(e){return e()};function fa(e){da(function(){da(e)})}function ha(e,t){var n=e._transitionClasses||(e._transitionClasses=[]);n.indexOf(t)<0&&(n.push(t),ea(e,t))}function pa(e,t){e._transitionClasses&&v(e._transitionClasses,t),ta(e,t)}function ga(e,t,n){var i=va(e,t),r=i.type,a=i.timeout,o=i.propCount;if(!r)return n();var s=r===aa?la:ca,l=0,u=function(){e.removeEventListener(s,c),n()},c=function(t){t.target===e&&++l>=o&&u()};setTimeout(function(){l<o&&u()},a+1),e.addEventListener(s,c)}var ma=/\b(transform|all)(,|$)/;function va(e,t){var n,i=window.getComputedStyle(e),r=i[sa+"Delay"].split(", "),a=i[sa+"Duration"].split(", "),o=ya(r,a),s=i[ua+"Delay"].split(", "),l=i[ua+"Duration"].split(", "),u=ya(s,l),c=0,d=0;t===aa?o>0&&(n=aa,c=o,d=a.length):t===oa?u>0&&(n=oa,c=u,d=l.length):(c=Math.max(o,u),n=c>0?o>u?aa:oa:null,d=n?n===aa?a.length:l.length:0);var f=n===aa&&ma.test(i[sa+"Property"]);return{type:n,timeout:c,propCount:d,hasTransform:f}}function ya(e,t){while(e.length<t.length)e=e.concat(e);return Math.max.apply(null,t.map(function(t,n){return _a(t)+_a(e[n])}))}function _a(e){return 1e3*Number(e.slice(0,-1))}function ba(e,t){var n=e.elm;r(n._leaveCb)&&(n._leaveCb.cancelled=!0,n._leaveCb());var a=na(e.data.transition);if(!i(a)&&!r(n._enterCb)&&1===n.nodeType){var o=a.css,s=a.type,u=a.enterClass,c=a.enterToClass,d=a.enterActiveClass,f=a.appearClass,h=a.appearToClass,g=a.appearActiveClass,m=a.beforeEnter,v=a.enter,y=a.afterEnter,_=a.enterCancelled,b=a.beforeAppear,E=a.appear,T=a.afterAppear,S=a.appearCancelled,w=a.duration,A=Ut,I=Ut.$vnode;while(I&&I.parent)I=I.parent,A=I.context;var x=!A._isMounted||!e.isRootInsert;if(!x||E||""===E){var R=x&&f?f:u,C=x&&g?g:d,D=x&&h?h:c,k=x&&b||m,M=x&&"function"===typeof E?E:v,L=x&&T||y,P=x&&S||_,N=p(l(w)?w.enter:w);0;var O=!1!==o&&!J,U=Sa(M),B=n._enterCb=F(function(){O&&(pa(n,D),pa(n,C)),B.cancelled?(O&&pa(n,R),P&&P(n)):L&&L(n),n._enterCb=null});e.data.show||yt(e,"insert",function(){var t=n.parentNode,i=t&&t._pending&&t._pending[e.key];i&&i.tag===e.tag&&i.elm._leaveCb&&i.elm._leaveCb(),M&&M(n,B)}),k&&k(n),O&&(ha(n,R),ha(n,C),fa(function(){pa(n,R),B.cancelled||(ha(n,D),U||(Ta(N)?setTimeout(B,N):ga(n,s,B)))})),e.data.show&&(t&&t(),M&&M(n,B)),O||U||B()}}}function Ea(e,t){var n=e.elm;r(n._enterCb)&&(n._enterCb.cancelled=!0,n._enterCb());var a=na(e.data.transition);if(i(a)||1!==n.nodeType)return t();if(!r(n._leaveCb)){var o=a.css,s=a.type,u=a.leaveClass,c=a.leaveToClass,d=a.leaveActiveClass,f=a.beforeLeave,h=a.leave,g=a.afterLeave,m=a.leaveCancelled,v=a.delayLeave,y=a.duration,_=!1!==o&&!J,b=Sa(h),E=p(l(y)?y.leave:y);0;var T=n._leaveCb=F(function(){n.parentNode&&n.parentNode._pending&&(n.parentNode._pending[e.key]=null),_&&(pa(n,c),pa(n,d)),T.cancelled?(_&&pa(n,u),m&&m(n)):(t(),g&&g(n)),n._leaveCb=null});v?v(S):S()}function S(){T.cancelled||(e.data.show||((n.parentNode._pending||(n.parentNode._pending={}))[e.key]=e),f&&f(n),_&&(ha(n,u),ha(n,d),fa(function(){pa(n,u),T.cancelled||(ha(n,c),b||(Ta(E)?setTimeout(T,E):ga(n,s,T)))})),h&&h(n,T),_||b||T())}}function Ta(e){return"number"===typeof e&&!isNaN(e)}function Sa(e){if(i(e))return!1;var t=e.fns;return r(t)?Sa(Array.isArray(t)?t[0]:t):(e._length||e.length)>1}function wa(e,t){!0!==t.data.show&&ba(t)}var Aa=Y?{create:wa,activate:wa,remove:function(e,t){!0!==e.data.show?Ea(e,t):t()}}:{},Ia=[Ar,Rr,Or,jr,Jr,Aa],xa=Ia.concat(Er),Ra=hr({nodeOps:ar,modules:xa});J&&document.addEventListener("selectionchange",function(){var e=document.activeElement;e&&e.vmodel&&Oa(e,"input")});var Ca={inserted:function(e,t,n,i){"select"===n.tag?(i.elm&&!i.elm._vOptions?yt(n,"postpatch",function(){Ca.componentUpdated(e,t,n)}):Da(e,t,n.context),e._vOptions=[].map.call(e.options,La)):("textarea"===n.tag||zi(e.type))&&(e._vModifiers=t.modifiers,t.modifiers.lazy||(e.addEventListener("compositionstart",Pa),e.addEventListener("compositionend",Na),e.addEventListener("change",Na),J&&(e.vmodel=!0)))},componentUpdated:function(e,t,n){if("select"===n.tag){Da(e,t,n.context);var i=e._vOptions,r=e._vOptions=[].map.call(e.options,La);if(r.some(function(e,t){return!N(e,i[t])})){var a=e.multiple?t.value.some(function(e){return Ma(e,r)}):t.value!==t.oldValue&&Ma(t.value,r);a&&Oa(e,"change")}}}};function Da(e,t,n){ka(e,t,n),(Q||ee)&&setTimeout(function(){ka(e,t,n)},0)}function ka(e,t,n){var i=t.value,r=e.multiple;if(!r||Array.isArray(i)){for(var a,o,s=0,l=e.options.length;s<l;s++)if(o=e.options[s],r)a=O(i,La(o))>-1,o.selected!==a&&(o.selected=a);else if(N(La(o),i))return void(e.selectedIndex!==s&&(e.selectedIndex=s));r||(e.selectedIndex=-1)}}function Ma(e,t){return t.every(function(t){return!N(t,e)})}function La(e){return"_value"in e?e._value:e.value}function Pa(e){e.target.composing=!0}function Na(e){e.target.composing&&(e.target.composing=!1,Oa(e.target,"input"))}function Oa(e,t){var n=document.createEvent("HTMLEvents");n.initEvent(t,!0,!0),e.dispatchEvent(n)}function Fa(e){return!e.componentInstance||e.data&&e.data.transition?e:Fa(e.componentInstance._vnode)}var Ua={bind:function(e,t,n){var i=t.value;n=Fa(n);var r=n.data&&n.data.transition,a=e.__vOriginalDisplay="none"===e.style.display?"":e.style.display;i&&r?(n.data.show=!0,ba(n,function(){e.style.display=a})):e.style.display=i?a:"none"},update:function(e,t,n){var i=t.value,r=t.oldValue;if(!i!==!r){n=Fa(n);var a=n.data&&n.data.transition;a?(n.data.show=!0,i?ba(n,function(){e.style.display=e.__vOriginalDisplay}):Ea(n,function(){e.style.display="none"})):e.style.display=i?e.__vOriginalDisplay:"none"}},unbind:function(e,t,n,i,r){r||(e.style.display=e.__vOriginalDisplay)}},Ba={model:Ca,show:Ua},Ga={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function ja(e){var t=e&&e.componentOptions;return t&&t.Ctor.options.abstract?ja(Ct(t.children)):e}function Va(e){var t={},n=e.$options;for(var i in n.propsData)t[i]=e[i];var r=n._parentListeners;for(var a in r)t[T(a)]=r[a];return t}function Ha(e,t){if(/\d-keep-alive$/.test(t.tag))return e("keep-alive",{props:t.componentOptions.propsData})}function Ka(e){while(e=e.parent)if(e.data.transition)return!0}function za(e,t){return t.key===e.key&&t.tag===e.tag}var Za={name:"transition",props:Ga,abstract:!0,render:function(e){var t=this,n=this.$slots.default;if(n&&(n=n.filter(function(e){return e.tag||Rt(e)}),n.length)){0;var i=this.mode;0;var r=n[0];if(Ka(this.$vnode))return r;var a=ja(r);if(!a)return r;if(this._leaving)return Ha(e,r);var o="__transition-"+this._uid+"-";a.key=null==a.key?a.isComment?o+"comment":o+a.tag:s(a.key)?0===String(a.key).indexOf(o)?a.key:o+a.key:a.key;var l=(a.data||(a.data={})).transition=Va(this),u=this._vnode,c=ja(u);if(a.data.directives&&a.data.directives.some(function(e){return"show"===e.name})&&(a.data.show=!0),c&&c.data&&!za(a,c)&&!Rt(c)&&(!c.componentInstance||!c.componentInstance._vnode.isComment)){var d=c.data.transition=D({},l);if("out-in"===i)return this._leaving=!0,yt(d,"afterLeave",function(){t._leaving=!1,t.$forceUpdate()}),Ha(e,r);if("in-out"===i){if(Rt(a))return u;var f,h=function(){f()};yt(l,"afterEnter",h),yt(l,"enterCancelled",h),yt(d,"delayLeave",function(e){f=e})}}return r}}},qa=D({tag:String,moveClass:String},Ga);delete qa.mode;var Ya={props:qa,render:function(e){for(var t=this.tag||this.$vnode.data.tag||"span",n=Object.create(null),i=this.prevChildren=this.children,r=this.$slots.default||[],a=this.children=[],o=Va(this),s=0;s<r.length;s++){var l=r[s];if(l.tag)if(null!=l.key&&0!==String(l.key).indexOf("__vlist"))a.push(l),n[l.key]=l,(l.data||(l.data={})).transition=o;else;}if(i){for(var u=[],c=[],d=0;d<i.length;d++){var f=i[d];f.data.transition=o,f.data.pos=f.elm.getBoundingClientRect(),n[f.key]?u.push(f):c.push(f)}this.kept=e(t,null,u),this.removed=c}return e(t,null,a)},beforeUpdate:function(){this.__patch__(this._vnode,this.kept,!1,!0),this._vnode=this.kept},updated:function(){var e=this.prevChildren,t=this.moveClass||(this.name||"v")+"-move";e.length&&this.hasMove(e[0].elm,t)&&(e.forEach(Wa),e.forEach($a),e.forEach(Xa),this._reflow=document.body.offsetHeight,e.forEach(function(e){if(e.data.moved){var n=e.elm,i=n.style;ha(n,t),i.transform=i.WebkitTransform=i.transitionDuration="",n.addEventListener(la,n._moveCb=function e(i){i&&!/transform$/.test(i.propertyName)||(n.removeEventListener(la,e),n._moveCb=null,pa(n,t))})}}))},methods:{hasMove:function(e,t){if(!ra)return!1;if(this._hasMove)return this._hasMove;var n=e.cloneNode();e._transitionClasses&&e._transitionClasses.forEach(function(e){ta(n,e)}),ea(n,t),n.style.display="none",this.$el.appendChild(n);var i=va(n);return this.$el.removeChild(n),this._hasMove=i.hasTransform}}};function Wa(e){e.elm._moveCb&&e.elm._moveCb(),e.elm._enterCb&&e.elm._enterCb()}function $a(e){e.data.newPos=e.elm.getBoundingClientRect()}function Xa(e){var t=e.data.pos,n=e.data.newPos,i=t.left-n.left,r=t.top-n.top;if(i||r){e.data.moved=!0;var a=e.elm.style;a.transform=a.WebkitTransform="translate("+i+"px,"+r+"px)",a.transitionDuration="0s"}}var Qa={Transition:Za,TransitionGroup:Ya};si.config.mustUseProp=wi,si.config.isReservedTag=ji,si.config.isReservedAttr=Ti,si.config.getTagNamespace=Vi,si.config.isUnknownElement=Ki,D(si.options.directives,Ba),D(si.options.components,Qa),si.prototype.__patch__=Y?Ra:M,si.prototype.$mount=function(e,t){return e=e&&Y?Zi(e):void 0,jt(this,e,t)},Y&&setTimeout(function(){j.devtools&&oe&&oe.emit("init",si)},0),t["a"]=si}).call(this,n("c8ba"))},"2b17":function(e,t,n){var i=n("4e08"),r=(i.__DEV__,n("6d8b")),a=(r.isTypedArray,r.extend),o=(r.assert,r.each),s=r.isObject,l=n("e0d3"),u=l.getDataItemValue,c=l.isDataItemOption,d=n("3842"),f=d.parseDate,h=n("ec6f"),p=n("93d0"),g=p.SOURCE_FORMAT_TYPED_ARRAY,m=p.SOURCE_FORMAT_ARRAY_ROWS,v=p.SOURCE_FORMAT_ORIGINAL,y=p.SOURCE_FORMAT_OBJECT_ROWS;function _(e,t){h.isInstance(e)||(e=h.seriesDataToSource(e)),this._source=e;var n=this._data=e.data,i=e.sourceFormat;i===g&&(this._offset=0,this._dimSize=t,this._data=n);var r=E[i===m?i+"_"+e.seriesLayoutBy:i];a(this,r)}var b=_.prototype;b.pure=!1,b.persistent=!0,b.getSource=function(){return this._source};var E={arrayRows_column:{pure:!0,count:function(){return Math.max(0,this._data.length-this._source.startIndex)},getItem:function(e){return this._data[e+this._source.startIndex]},appendData:w},arrayRows_row:{pure:!0,count:function(){var e=this._data[0];return e?Math.max(0,e.length-this._source.startIndex):0},getItem:function(e){e+=this._source.startIndex;for(var t=[],n=this._data,i=0;i<n.length;i++){var r=n[i];t.push(r?r[e]:null)}return t},appendData:function(){throw new Error('Do not support appendData when set seriesLayoutBy: "row".')}},objectRows:{pure:!0,count:T,getItem:S,appendData:w},keyedColumns:{pure:!0,count:function(){var e=this._source.dimensionsDefine[0].name,t=this._data[e];return t?t.length:0},getItem:function(e){for(var t=[],n=this._source.dimensionsDefine,i=0;i<n.length;i++){var r=this._data[n[i].name];t.push(r?r[e]:null)}return t},appendData:function(e){var t=this._data;o(e,function(e,n){for(var i=t[n]||(t[n]=[]),r=0;r<(e||[]).length;r++)i.push(e[r])})}},original:{count:T,getItem:S,appendData:w},typedArray:{persistent:!1,pure:!0,count:function(){return this._data?this._data.length/this._dimSize:0},getItem:function(e,t){e-=this._offset,t=t||[];for(var n=this._dimSize*e,i=0;i<this._dimSize;i++)t[i]=this._data[n+i];return t},appendData:function(e){this._data=e},clean:function(){this._offset+=this.count(),this._data=null}}};function T(){return this._data.length}function S(e){return this._data[e]}function w(e){for(var t=0;t<e.length;t++)this._data.push(e[t])}var A={arrayRows:I,objectRows:function(e,t,n,i){return null!=n?e[i]:e},keyedColumns:I,original:function(e,t,n,i){var r=u(e);return null!=n&&r instanceof Array?r[n]:r},typedArray:I};function I(e,t,n,i){return null!=n?e[n]:e}var x={arrayRows:R,objectRows:function(e,t,n,i){return C(e[t],this._dimensionInfos[t])},keyedColumns:R,original:function(e,t,n,i){var r=e&&(null==e.value?e:e.value);return!this._rawData.pure&&c(e)&&(this.hasItemOption=!0),C(r instanceof Array?r[i]:r,this._dimensionInfos[t])},typedArray:function(e,t,n,i){return e[i]}};function R(e,t,n,i){return C(e[i],this._dimensionInfos[t])}function C(e,t){var n=t&&t.type;if("ordinal"===n){var i=t&&t.ordinalMeta;return i?i.parseAndCollect(e):e}return"time"===n&&"number"!==typeof e&&null!=e&&"-"!==e&&(e=+f(e)),null==e||""===e?NaN:+e}function D(e,t,n){if(e){var i=e.getRawDataItem(t);if(null!=i){var r,a,o=e.getProvider().getSource().sourceFormat,s=e.getDimensionInfo(n);return s&&(r=s.name,a=s.index),A[o](i,t,a,r)}}}function k(e,t,n){if(e){var i=e.getProvider().getSource().sourceFormat;if(i===v||i===y){var r=e.getRawDataItem(t);return i!==v||s(r)||(r=null),r?r[n]:void 0}}}t.DefaultDataProvider=_,t.defaultDimValueGetters=x,t.retrieveRawValue=D,t.retrieveRawAttr=k},"2b4c":function(e,t,n){var i=n("5537")("wks"),r=n("ca5a"),a=n("7726").Symbol,o="function"==typeof a,s=e.exports=function(e){return i[e]||(i[e]=o&&a[e]||(o?a:r)("Symbol."+e))};s.store=i},"2b61":function(e,t,n){var i=n("7d6d"),r=[["shadowBlur",0],["shadowOffsetX",0],["shadowOffsetY",0],["shadowColor","#000"],["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]],a=function(e,t){this.extendFrom(e,!1),this.host=t};function o(e,t,n){var i=null==t.x?0:t.x,r=null==t.x2?1:t.x2,a=null==t.y?0:t.y,o=null==t.y2?0:t.y2;t.global||(i=i*n.width+n.x,r=r*n.width+n.x,a=a*n.height+n.y,o=o*n.height+n.y),i=isNaN(i)?0:i,r=isNaN(r)?1:r,a=isNaN(a)?0:a,o=isNaN(o)?0:o;var s=e.createLinearGradient(i,a,r,o);return s}function s(e,t,n){var i=n.width,r=n.height,a=Math.min(i,r),o=null==t.x?.5:t.x,s=null==t.y?.5:t.y,l=null==t.r?.5:t.r;t.global||(o=o*i+n.x,s=s*r+n.y,l*=a);var u=e.createRadialGradient(o,s,0,o,s,l);return u}a.prototype={constructor:a,host:null,fill:"#000",stroke:null,opacity:1,lineDash:null,lineDashOffset:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,lineWidth:1,strokeNoScale:!1,text:null,font:null,textFont:null,fontStyle:null,fontWeight:null,fontSize:null,fontFamily:null,textTag:null,textFill:"#000",textStroke:null,textWidth:null,textHeight:null,textStrokeWidth:0,textLineHeight:null,textPosition:"inside",textRect:null,textOffset:null,textAlign:null,textVerticalAlign:null,textDistance:5,textShadowColor:"transparent",textShadowBlur:0,textShadowOffsetX:0,textShadowOffsetY:0,textBoxShadowColor:"transparent",textBoxShadowBlur:0,textBoxShadowOffsetX:0,textBoxShadowOffsetY:0,transformText:!1,textRotation:0,textOrigin:null,textBackgroundColor:null,textBorderColor:null,textBorderWidth:0,textBorderRadius:0,textPadding:null,rich:null,truncate:null,blend:null,bind:function(e,t,n){for(var a=this,o=n&&n.style,s=!o,l=0;l<r.length;l++){var u=r[l],c=u[0];(s||a[c]!==o[c])&&(e[c]=i(e,c,a[c]||u[1]))}if((s||a.fill!==o.fill)&&(e.fillStyle=a.fill),(s||a.stroke!==o.stroke)&&(e.strokeStyle=a.stroke),(s||a.opacity!==o.opacity)&&(e.globalAlpha=null==a.opacity?1:a.opacity),(s||a.blend!==o.blend)&&(e.globalCompositeOperation=a.blend||"source-over"),this.hasStroke()){var d=a.lineWidth;e.lineWidth=d/(this.strokeNoScale&&t&&t.getLineScale?t.getLineScale():1)}},hasFill:function(){var e=this.fill;return null!=e&&"none"!==e},hasStroke:function(){var e=this.stroke;return null!=e&&"none"!==e&&this.lineWidth>0},extendFrom:function(e,t){if(e)for(var n in e)!e.hasOwnProperty(n)||!0!==t&&(!1===t?this.hasOwnProperty(n):null==e[n])||(this[n]=e[n])},set:function(e,t){"string"===typeof e?this[e]=t:this.extendFrom(e,!0)},clone:function(){var e=new this.constructor;return e.extendFrom(this,!0),e},getGradient:function(e,t,n){for(var i="radial"===t.type?s:o,r=i(e,t,n),a=t.colorStops,l=0;l<a.length;l++)r.addColorStop(a[l].offset,a[l].color);return r}};for(var l=a.prototype,u=0;u<r.length;u++){var c=r[u];c[0]in l||(l[c[0]]=c[1])}a.getGradient=l.getGradient;var d=a;e.exports=d},"2c17":function(e,t,n){var i=n("3eba"),r=n("6d8b"),a=r.createHashMap,o=r.each;i.registerProcessor({getTargetSeries:function(e){var t=a();return e.eachComponent("dataZoom",function(e){e.eachTargetAxis(function(e,n,i){var r=i.getAxisProxy(e.name,n);o(r.getTargetSeriesModels(),function(e){t.set(e.uid,e)})})}),t},modifyOutputEnd:!0,overallReset:function(e,t){e.eachComponent("dataZoom",function(e){e.eachTargetAxis(function(e,n,i){i.getAxisProxy(e.name,n).reset(i,t)}),e.eachTargetAxis(function(e,n,i){i.getAxisProxy(e.name,n).filterData(i,t)})}),e.eachComponent("dataZoom",function(e){var t=e.findRepresentativeAxisProxy(),n=t.getDataPercentWindow(),i=t.getDataValueWindow();e.setRawRange({start:n[0],end:n[1],startValue:i[0],endValue:i[1]},!0)})}})},"2cf4":function(e,t){var n=1;"undefined"!==typeof window&&(n=Math.max(window.devicePixelRatio||1,1));var i=0,r=n;t.debugMode=i,t.devicePixelRatio=r},"2d00":function(e,t){e.exports=!1},"2d95":function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},"2f45":function(e,t,n){var i=n("6d8b"),r=i.each,a=i.createHashMap,o=(i.assert,n("4e08")),s=(o.__DEV__,a(["tooltip","label","itemName","itemId","seriesName"]));function l(e){var t={},n=t.encode={},i=a(),o=[],l=[];r(e.dimensions,function(t){var r=e.getDimensionInfo(t),a=r.coordDim;if(a){var u=n[a];n.hasOwnProperty(a)||(u=n[a]=[]),u[r.coordDimIndex]=t,r.isExtraCoord||(i.set(a,1),c(r.type)&&(o[0]=t)),r.defaultTooltip&&l.push(t)}s.each(function(e,t){var i=n[t];n.hasOwnProperty(t)||(i=n[t]=[]);var a=r.otherDims[t];null!=a&&!1!==a&&(i[a]=r.name)})});var u=[],d={};i.each(function(e,t){var i=n[t];d[t]=i[0],u=u.concat(i)}),t.dataDimsOnCoord=u,t.encodeFirstDimNotExtra=d;var f=n.label;f&&f.length&&(o=f.slice());var h=n.tooltip;return h&&h.length?l=h.slice():l.length||(l=o.slice()),n.defaultedLabel=o,n.defaultedTooltip=l,t}function u(e){return"category"===e?"ordinal":"time"===e?"time":"float"}function c(e){return!("ordinal"===e||"time"===e)}t.OTHER_DIMENSIONS=s,t.summarizeDimensions=l,t.getDimensionTypeByAxis=u},3014:function(e,t,n){var i=n("4f85"),r=n("3301"),a=i.extend({type:"series.__base_bar__",getInitialData:function(e,t){return r(this.getSource(),this)},getMarkerPosition:function(e){var t=this.coordinateSystem;if(t){var n=t.dataToPoint(t.clampData(e)),i=this.getData(),r=i.getLayout("offset"),a=i.getLayout("size"),o=t.getBaseAxis().isHorizontal()?0:1;return n[o]+=r+a/2,n}return[NaN,NaN]},defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,barMinAngle:0,large:!1,largeThreshold:400,progressive:5e3,progressiveChunkMode:"mod",itemStyle:{},emphasis:{}}});e.exports=a},"30a3":function(e,t,n){var i=n("6d8b"),r=n("607d"),a=r.Dispatcher,o=n("98b7"),s=n("06ad"),l=function(e){e=e||{},this.stage=e.stage||{},this.onframe=e.onframe||function(){},this._clips=[],this._running=!1,this._time,this._pausedTime,this._pauseStart,this._paused=!1,a.call(this)};l.prototype={constructor:l,addClip:function(e){this._clips.push(e)},addAnimator:function(e){e.animation=this;for(var t=e.getClips(),n=0;n<t.length;n++)this.addClip(t[n])},removeClip:function(e){var t=i.indexOf(this._clips,e);t>=0&&this._clips.splice(t,1)},removeAnimator:function(e){for(var t=e.getClips(),n=0;n<t.length;n++)this.removeClip(t[n]);e.animation=null},_update:function(){for(var e=(new Date).getTime()-this._pausedTime,t=e-this._time,n=this._clips,i=n.length,r=[],a=[],o=0;o<i;o++){var s=n[o],l=s.step(e,t);l&&(r.push(l),a.push(s))}for(o=0;o<i;)n[o]._needsRemove?(n[o]=n[i-1],n.pop(),i--):o++;i=r.length;for(o=0;o<i;o++)a[o].fire(r[o]);this._time=e,this.onframe(t),this.trigger("frame",t),this.stage.update&&this.stage.update()},_startLoop:function(){var e=this;function t(){e._running&&(o(t),!e._paused&&e._update())}this._running=!0,o(t)},start:function(){this._time=(new Date).getTime(),this._pausedTime=0,this._startLoop()},stop:function(){this._running=!1},pause:function(){this._paused||(this._pauseStart=(new Date).getTime(),this._paused=!0)},resume:function(){this._paused&&(this._pausedTime+=(new Date).getTime()-this._pauseStart,this._paused=!1)},clear:function(){this._clips=[]},isFinished:function(){return!this._clips.length},animate:function(e,t){t=t||{};var n=new s(e,t.loop,t.getter,t.setter);return this.addAnimator(n),n}},i.mixin(l,a);var u=l;e.exports=u},"31f4":function(e,t){e.exports=function(e,t,n){var i=void 0===n;switch(t.length){case 0:return i?e():e.call(n);case 1:return i?e(t[0]):e.call(n,t[0]);case 2:return i?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return i?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return i?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},"32e9":function(e,t,n){var i=n("86cc"),r=n("4630");e.exports=n("9e1e")?function(e,t,n){return i.f(e,t,r(1,n))}:function(e,t,n){return e[t]=n,e}},3301:function(e,t,n){var i=n("6d8b"),r=n("6179"),a=n("b1d4"),o=n("93d0"),s=o.SOURCE_FORMAT_ORIGINAL,l=n("2f45"),u=l.getDimensionTypeByAxis,c=n("e0d3"),d=c.getDataItemValue,f=n("2039"),h=n("8b7f"),p=h.getCoordSysDefineBySeries,g=n("ec6f"),m=n("ee1a"),v=m.enableDataStack;function y(e,t,n){n=n||{},g.isInstance(e)||(e=g.seriesDataToSource(e));var o,s=t.get("coordinateSystem"),l=f.get(s),c=p(t);c&&(o=i.map(c.coordSysDims,function(e){var t={name:e},n=c.axisMap.get(e);if(n){var i=n.get("type");t.type=u(i)}return t})),o||(o=l&&(l.getDimensionsInfo?l.getDimensionsInfo():l.dimensions.slice())||["x","y"]);var d,h,m=a(e,{coordDimensions:o,generateCoord:n.generateCoord});c&&i.each(m,function(e,t){var n=e.coordDim,i=c.categoryAxisMap.get(n);i&&(null==d&&(d=t),e.ordinalMeta=i.getOrdinalMeta()),null!=e.otherDims.itemName&&(h=!0)}),h||null==d||(m[d].otherDims.itemName=0);var y=v(t,m),b=new r(m,t);b.setCalculationInfo(y);var E=null!=d&&_(e)?function(e,t,n,i){return i===d?n:this.defaultDimValueGetter(e,t,n,i)}:null;return b.hasItemOption=!1,b.initData(e,null,E),b}function _(e){if(e.sourceFormat===s){var t=b(e.data||[]);return null!=t&&!i.isArray(d(t))}}function b(e){var t=0;while(t<e.length&&null==e[t])t++;return e[t]}var E=y;e.exports=E},"33a4":function(e,t,n){var i=n("84f2"),r=n("2b4c")("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||a[r]===e)}},"342d":function(e,t,n){var i=n("cbe5"),r=n("20c8"),a=n("ee84"),o=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"],s=Math.sqrt,l=Math.sin,u=Math.cos,c=Math.PI,d=function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])},f=function(e,t){return(e[0]*t[0]+e[1]*t[1])/(d(e)*d(t))},h=function(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(f(e,t))};function p(e,t,n,i,r,a,o,d,p,g,m){var v=p*(c/180),y=u(v)*(e-n)/2+l(v)*(t-i)/2,_=-1*l(v)*(e-n)/2+u(v)*(t-i)/2,b=y*y/(o*o)+_*_/(d*d);b>1&&(o*=s(b),d*=s(b));var E=(r===a?-1:1)*s((o*o*(d*d)-o*o*(_*_)-d*d*(y*y))/(o*o*(_*_)+d*d*(y*y)))||0,T=E*o*_/d,S=E*-d*y/o,w=(e+n)/2+u(v)*T-l(v)*S,A=(t+i)/2+l(v)*T+u(v)*S,I=h([1,0],[(y-T)/o,(_-S)/d]),x=[(y-T)/o,(_-S)/d],R=[(-1*y-T)/o,(-1*_-S)/d],C=h(x,R);f(x,R)<=-1&&(C=c),f(x,R)>=1&&(C=0),0===a&&C>0&&(C-=2*c),1===a&&C<0&&(C+=2*c),m.addData(g,w,A,o,d,I,C,v,a)}function g(e){if(!e)return[];var t,n=e.replace(/-/g," -").replace(/  /g," ").replace(/ /g,",").replace(/,,/g,",");for(t=0;t<o.length;t++)n=n.replace(new RegExp(o[t],"g"),"|"+o[t]);var i,a=n.split("|"),s=0,l=0,u=new r,c=r.CMD;for(t=1;t<a.length;t++){var d,f=a[t],h=f.charAt(0),g=0,m=f.slice(1).replace(/e,-/g,"e-").split(",");m.length>0&&""===m[0]&&m.shift();for(var v=0;v<m.length;v++)m[v]=parseFloat(m[v]);while(g<m.length&&!isNaN(m[g])){if(isNaN(m[0]))break;var y,_,b,E,T,S,w,A=s,I=l;switch(h){case"l":s+=m[g++],l+=m[g++],d=c.L,u.addData(d,s,l);break;case"L":s=m[g++],l=m[g++],d=c.L,u.addData(d,s,l);break;case"m":s+=m[g++],l+=m[g++],d=c.M,u.addData(d,s,l),h="l";break;case"M":s=m[g++],l=m[g++],d=c.M,u.addData(d,s,l),h="L";break;case"h":s+=m[g++],d=c.L,u.addData(d,s,l);break;case"H":s=m[g++],d=c.L,u.addData(d,s,l);break;case"v":l+=m[g++],d=c.L,u.addData(d,s,l);break;case"V":l=m[g++],d=c.L,u.addData(d,s,l);break;case"C":d=c.C,u.addData(d,m[g++],m[g++],m[g++],m[g++],m[g++],m[g++]),s=m[g-2],l=m[g-1];break;case"c":d=c.C,u.addData(d,m[g++]+s,m[g++]+l,m[g++]+s,m[g++]+l,m[g++]+s,m[g++]+l),s+=m[g-2],l+=m[g-1];break;case"S":y=s,_=l;var x=u.len(),R=u.data;i===c.C&&(y+=s-R[x-4],_+=l-R[x-3]),d=c.C,A=m[g++],I=m[g++],s=m[g++],l=m[g++],u.addData(d,y,_,A,I,s,l);break;case"s":y=s,_=l;x=u.len(),R=u.data;i===c.C&&(y+=s-R[x-4],_+=l-R[x-3]),d=c.C,A=s+m[g++],I=l+m[g++],s+=m[g++],l+=m[g++],u.addData(d,y,_,A,I,s,l);break;case"Q":A=m[g++],I=m[g++],s=m[g++],l=m[g++],d=c.Q,u.addData(d,A,I,s,l);break;case"q":A=m[g++]+s,I=m[g++]+l,s+=m[g++],l+=m[g++],d=c.Q,u.addData(d,A,I,s,l);break;case"T":y=s,_=l;x=u.len(),R=u.data;i===c.Q&&(y+=s-R[x-4],_+=l-R[x-3]),s=m[g++],l=m[g++],d=c.Q,u.addData(d,y,_,s,l);break;case"t":y=s,_=l;x=u.len(),R=u.data;i===c.Q&&(y+=s-R[x-4],_+=l-R[x-3]),s+=m[g++],l+=m[g++],d=c.Q,u.addData(d,y,_,s,l);break;case"A":b=m[g++],E=m[g++],T=m[g++],S=m[g++],w=m[g++],A=s,I=l,s=m[g++],l=m[g++],d=c.A,p(A,I,s,l,S,w,b,E,T,d,u);break;case"a":b=m[g++],E=m[g++],T=m[g++],S=m[g++],w=m[g++],A=s,I=l,s+=m[g++],l+=m[g++],d=c.A,p(A,I,s,l,S,w,b,E,T,d,u);break}}"z"!==h&&"Z"!==h||(d=c.Z,u.addData(d)),i=d}return u.toStatic(),u}function m(e,t){var n=g(e);return t=t||{},t.buildPath=function(e){if(e.setData){e.setData(n.data);var t=e.getContext();t&&e.rebuildPath(t)}else{t=e;n.rebuildPath(t)}},t.applyTransform=function(e){a(n,e),this.dirty(!0)},t}function v(e,t){return new i(m(e,t))}function y(e,t){return i.extend(m(e,t))}function _(e,t){for(var n=[],r=e.length,a=0;a<r;a++){var o=e[a];o.path||o.createPathProxy(),o.__dirtyPath&&o.buildPath(o.path,o.shape,!0),n.push(o.path)}var s=new i(t);return s.createPathProxy(),s.buildPath=function(e){e.appendPath(n);var t=e.getContext();t&&e.rebuildPath(t)},s}t.createFromString=v,t.extendFromString=y,t.mergePath=_},3842:function(e,t,n){var i=n("6d8b"),r=1e-4;function a(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")}function o(e,t,n,i){var r=t[1]-t[0],a=n[1]-n[0];if(0===r)return 0===a?n[0]:(n[0]+n[1])/2;if(i)if(r>0){if(e<=t[0])return n[0];if(e>=t[1])return n[1]}else{if(e>=t[0])return n[0];if(e<=t[1])return n[1]}else{if(e===t[0])return n[0];if(e===t[1])return n[1]}return(e-t[0])/r*a+n[0]}function s(e,t){switch(e){case"center":case"middle":e="50%";break;case"left":case"top":e="0%";break;case"right":case"bottom":e="100%";break}return"string"===typeof e?a(e).match(/%$/)?parseFloat(e)/100*t:parseFloat(e):null==e?NaN:+e}function l(e,t,n){return null==t&&(t=10),t=Math.min(Math.max(0,t),20),e=(+e).toFixed(t),n?e:+e}function u(e){return e.sort(function(e,t){return e-t}),e}function c(e){if(e=+e,isNaN(e))return 0;var t=1,n=0;while(Math.round(e*t)/t!==e)t*=10,n++;return n}function d(e){var t=e.toString(),n=t.indexOf("e");if(n>0){var i=+t.slice(n+1);return i<0?-i:0}var r=t.indexOf(".");return r<0?0:t.length-1-r}function f(e,t){var n=Math.log,i=Math.LN10,r=Math.floor(n(e[1]-e[0])/i),a=Math.round(n(Math.abs(t[1]-t[0]))/i),o=Math.min(Math.max(-r+a,0),20);return isFinite(o)?o:20}function h(e,t,n){if(!e[t])return 0;var r=i.reduce(e,function(e,t){return e+(isNaN(t)?0:t)},0);if(0===r)return 0;var a=Math.pow(10,n),o=i.map(e,function(e){return(isNaN(e)?0:e)/r*a*100}),s=100*a,l=i.map(o,function(e){return Math.floor(e)}),u=i.reduce(l,function(e,t){return e+t},0),c=i.map(o,function(e,t){return e-l[t]});while(u<s){for(var d=Number.NEGATIVE_INFINITY,f=null,h=0,p=c.length;h<p;++h)c[h]>d&&(d=c[h],f=h);++l[f],c[f]=0,++u}return l[t]/a}var p=9007199254740991;function g(e){var t=2*Math.PI;return(e%t+t)%t}function m(e){return e>-r&&e<r}var v=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d\d)(?::(\d\d)(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function y(e){if(e instanceof Date)return e;if("string"===typeof e){var t=v.exec(e);if(!t)return new Date(NaN);if(t[8]){var n=+t[4]||0;return"Z"!==t[8].toUpperCase()&&(n-=t[8].slice(0,3)),new Date(Date.UTC(+t[1],+(t[2]||1)-1,+t[3]||1,n,+(t[5]||0),+t[6]||0,+t[7]||0))}return new Date(+t[1],+(t[2]||1)-1,+t[3]||1,+t[4]||0,+(t[5]||0),+t[6]||0,+t[7]||0)}return null==e?new Date(NaN):new Date(Math.round(e))}function _(e){return Math.pow(10,b(e))}function b(e){return Math.floor(Math.log(e)/Math.LN10)}function E(e,t){var n,i=b(e),r=Math.pow(10,i),a=e/r;return n=t?a<1.5?1:a<2.5?2:a<4?3:a<7?5:10:a<1?1:a<2?2:a<3?3:a<5?5:10,e=n*r,i>=-20?+e.toFixed(i<0?-i:0):e}function T(e){e.sort(function(e,t){return s(e,t,0)?-1:1});for(var t=-1/0,n=1,i=0;i<e.length;){for(var r=e[i].interval,a=e[i].close,o=0;o<2;o++)r[o]<=t&&(r[o]=t,a[o]=o?1:1-n),t=r[o],n=a[o];r[0]===r[1]&&a[0]*a[1]!==1?e.splice(i,1):i++}return e;function s(e,t,n){return e.interval[n]<t.interval[n]||e.interval[n]===t.interval[n]&&(e.close[n]-t.close[n]===(n?-1:1)||!n&&s(e,t,1))}}function S(e){return e-parseFloat(e)>=0}t.linearMap=o,t.parsePercent=s,t.round=l,t.asc=u,t.getPrecision=c,t.getPrecisionSafe=d,t.getPixelPrecision=f,t.getPercentWithPrecision=h,t.MAX_SAFE_INTEGER=p,t.remRadian=g,t.isRadianAroundZero=m,t.parseDate=y,t.quantity=_,t.nice=E,t.reformIntervals=T,t.isNumeric=S},3846:function(e,t,n){n("9e1e")&&"g"!=/./g.flags&&n("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:n("0bfb")})},"386d":function(e,t,n){n("214f")("search",1,function(e,t,n){return[function(n){"use strict";var i=e(this),r=void 0==n?void 0:n[t];return void 0!==r?r.call(n,i):new RegExp(n)[t](String(i))},n]})},"38a2":function(e,t,n){var i=n("2b17"),r=i.retrieveRawValue,a=n("eda2"),o=a.getTooltipMarker,s=a.formatTpl,l=/\{@(.+?)\}/g,u={getDataParams:function(e,t){var n=this.getData(t),i=this.getRawValue(e,t),r=n.getRawIndex(e),a=n.getName(e),s=n.getRawDataItem(e),l=n.getItemVisual(e,"color");return{componentType:this.mainType,componentSubType:this.subType,seriesType:"series"===this.mainType?this.subType:null,seriesIndex:this.seriesIndex,seriesId:this.id,seriesName:this.name,name:a,dataIndex:r,data:s,dataType:t,value:i,color:l,marker:o(l),$vars:["seriesName","name","value"]}},getFormattedLabel:function(e,t,n,i,a){t=t||"normal";var o=this.getData(n),u=o.getItemModel(e),c=this.getDataParams(e,n);null!=i&&c.value instanceof Array&&(c.value=c.value[i]);var d=u.get("normal"===t?[a||"label","formatter"]:[t,a||"label","formatter"]);if("function"===typeof d)return c.status=t,d(c);if("string"===typeof d){var f=s(d,c);return f.replace(l,function(t,n){var i=n.length;return"["===n.charAt(0)&&"]"===n.charAt(i-1)&&(n=+n.slice(1,i-1)),r(o,e,n)})}},getRawValue:function(e,t){return r(this.getData(t),e)},formatTooltip:function(){}};e.exports=u},"38fd":function(e,t,n){var i=n("69a8"),r=n("4bf8"),a=n("613b")("IE_PROTO"),o=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=r(e),i(e,a)?e[a]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?o:null}},3901:function(e,t,n){var i=n("282b"),r=i([["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]),a={getLineStyle:function(e){var t=r(this,e),n=this.getLineDash(t.lineWidth);return n&&(t.lineDash=n),t},getLineDash:function(e){null==e&&(e=1);var t=this.get("type"),n=Math.max(e,2),i=4*e;return"solid"===t||null==t?null:"dashed"===t?[i,i]:[n,n]}};e.exports=a},"392f":function(e,t,n){var i=n("6d8b"),r=i.inherits,a=n("19eb"),o=n("9850");function s(e){a.call(this,e),this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.notClear=!0}s.prototype.incremental=!0,s.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.dirty(),this.notClear=!1},s.prototype.addDisplayable=function(e,t){t?this._temporaryDisplayables.push(e):this._displayables.push(e),this.dirty()},s.prototype.addDisplayables=function(e,t){t=t||!1;for(var n=0;n<e.length;n++)this.addDisplayable(e[n],t)},s.prototype.eachPendingDisplayable=function(e){for(var t=this._cursor;t<this._displayables.length;t++)e&&e(this._displayables[t]);for(t=0;t<this._temporaryDisplayables.length;t++)e&&e(this._temporaryDisplayables[t])},s.prototype.update=function(){this.updateTransform();for(var e=this._cursor;e<this._displayables.length;e++){var t=this._displayables[e];t.parent=this,t.update(),t.parent=null}for(e=0;e<this._temporaryDisplayables.length;e++){t=this._temporaryDisplayables[e];t.parent=this,t.update(),t.parent=null}},s.prototype.brush=function(e,t){for(var n=this._cursor;n<this._displayables.length;n++){var i=this._displayables[n];i.beforeBrush&&i.beforeBrush(e),i.brush(e,n===this._cursor?null:this._displayables[n-1]),i.afterBrush&&i.afterBrush(e)}this._cursor=n;for(n=0;n<this._temporaryDisplayables.length;n++){i=this._temporaryDisplayables[n];i.beforeBrush&&i.beforeBrush(e),i.brush(e,0===n?null:this._temporaryDisplayables[n-1]),i.afterBrush&&i.afterBrush(e)}this._temporaryDisplayables=[],this.notClear=!0};var l=[];s.prototype.getBoundingRect=function(){if(!this._rect){for(var e=new o(1/0,1/0,-1/0,-1/0),t=0;t<this._displayables.length;t++){var n=this._displayables[t],i=n.getBoundingRect().clone();n.needLocalTransform()&&i.applyTransform(n.getLocalTransform(l)),e.union(i)}this._rect=e}return this._rect},s.prototype.contain=function(e,t){var n=this.transformCoordToLocal(e,t),i=this.getBoundingRect();if(i.contain(n[0],n[1]))for(var r=0;r<this._displayables.length;r++){var a=this._displayables[r];if(a.contain(e,t))return!0}return!1},r(s,a);var u=s;e.exports=u},"3a56":function(e,t,n){var i=n("4e08"),r=(i.__DEV__,n("3eba")),a=n("6d8b"),o=n("22d1"),s=n("e0d3"),l=n("50e5"),u=n("cc39"),c=a.each,d=l.eachAxisDim,f=r.extendComponentModel({type:"dataZoom",dependencies:["xAxis","yAxis","zAxis","radiusAxis","angleAxis","singleAxis","series"],defaultOption:{zlevel:0,z:4,orient:null,xAxisIndex:null,yAxisIndex:null,filterMode:"filter",throttle:null,start:0,end:100,startValue:null,endValue:null,minSpan:null,maxSpan:null,minValueSpan:null,maxValueSpan:null,rangeMode:null},init:function(e,t,n){this._dataIntervalByAxis={},this._dataInfo={},this._axisProxies={},this.textStyleModel,this._autoThrottle=!0,this._rangePropMode=["percent","percent"];var i=h(e);this.mergeDefaultAndTheme(e,n),this.doInit(i)},mergeOption:function(e){var t=h(e);a.merge(this.option,e,!0),this.doInit(t)},doInit:function(e){var t=this.option;o.canvasSupported||(t.realtime=!1),this._setDefaultThrottle(e),p(this,e),c([["start","startValue"],["end","endValue"]],function(e,n){"value"===this._rangePropMode[n]&&(t[e[0]]=null)},this),this.textStyleModel=this.getModel("textStyle"),this._resetTarget(),this._giveAxisProxies()},_giveAxisProxies:function(){var e=this._axisProxies;this.eachTargetAxis(function(t,n,i,r){var a=this.dependentModels[t.axis][n],o=a.__dzAxisProxy||(a.__dzAxisProxy=new u(t.name,n,this,r));e[t.name+"_"+n]=o},this)},_resetTarget:function(){var e=this.option,t=this._judgeAutoMode();d(function(t){var n=t.axisIndex;e[n]=s.normalizeToArray(e[n])},this),"axisIndex"===t?this._autoSetAxisIndex():"orient"===t&&this._autoSetOrient()},_judgeAutoMode:function(){var e=this.option,t=!1;d(function(n){null!=e[n.axisIndex]&&(t=!0)},this);var n=e.orient;return null==n&&t?"orient":t?void 0:(null==n&&(e.orient="horizontal"),"axisIndex")},_autoSetAxisIndex:function(){var e=!0,t=this.get("orient",!0),n=this.option,i=this.dependentModels;if(e){var r="vertical"===t?"y":"x";i[r+"Axis"].length?(n[r+"AxisIndex"]=[0],e=!1):c(i.singleAxis,function(i){e&&i.get("orient",!0)===t&&(n.singleAxisIndex=[i.componentIndex],e=!1)})}e&&d(function(t){if(e){var i=[],r=this.dependentModels[t.axis];if(r.length&&!i.length)for(var a=0,o=r.length;a<o;a++)"category"===r[a].get("type")&&i.push(a);n[t.axisIndex]=i,i.length&&(e=!1)}},this),e&&this.ecModel.eachSeries(function(e){this._isSeriesHasAllAxesTypeOf(e,"value")&&d(function(t){var i=n[t.axisIndex],r=e.get(t.axisIndex),o=e.get(t.axisId),s=e.ecModel.queryComponents({mainType:t.axis,index:r,id:o})[0];r=s.componentIndex,a.indexOf(i,r)<0&&i.push(r)})},this)},_autoSetOrient:function(){var e;this.eachTargetAxis(function(t){!e&&(e=t.name)},this),this.option.orient="y"===e?"vertical":"horizontal"},_isSeriesHasAllAxesTypeOf:function(e,t){var n=!0;return d(function(i){var r=e.get(i.axisIndex),a=this.dependentModels[i.axis][r];a&&a.get("type")===t||(n=!1)},this),n},_setDefaultThrottle:function(e){if(e.hasOwnProperty("throttle")&&(this._autoThrottle=!1),this._autoThrottle){var t=this.ecModel.option;this.option.throttle=t.animation&&t.animationDurationUpdate>0?100:20}},getFirstTargetAxisModel:function(){var e;return d(function(t){if(null==e){var n=this.get(t.axisIndex);n.length&&(e=this.dependentModels[t.axis][n[0]])}},this),e},eachTargetAxis:function(e,t){var n=this.ecModel;d(function(i){c(this.get(i.axisIndex),function(r){e.call(t,i,r,this,n)},this)},this)},getAxisProxy:function(e,t){return this._axisProxies[e+"_"+t]},getAxisModel:function(e,t){var n=this.getAxisProxy(e,t);return n&&n.getAxisModel()},setRawRange:function(e,t){var n=this.option;c([["start","startValue"],["end","endValue"]],function(t){null==e[t[0]]&&null==e[t[1]]||(n[t[0]]=e[t[0]],n[t[1]]=e[t[1]])},this),!t&&p(this,e)},getPercentRange:function(){var e=this.findRepresentativeAxisProxy();if(e)return e.getDataPercentWindow()},getValueRange:function(e,t){if(null!=e||null!=t)return this.getAxisProxy(e,t).getDataValueWindow();var n=this.findRepresentativeAxisProxy();return n?n.getDataValueWindow():void 0},findRepresentativeAxisProxy:function(e){if(e)return e.__dzAxisProxy;var t=this._axisProxies;for(var n in t)if(t.hasOwnProperty(n)&&t[n].hostedBy(this))return t[n];for(var n in t)if(t.hasOwnProperty(n)&&!t[n].hostedBy(this))return t[n]},getRangePropMode:function(){return this._rangePropMode.slice()}});function h(e){var t={};return c(["start","end","startValue","endValue","throttle"],function(n){e.hasOwnProperty(n)&&(t[n]=e[n])}),t}function p(e,t){var n=e._rangePropMode,i=e.get("rangeMode");c([["start","startValue"],["end","endValue"]],function(e,r){var a=null!=t[e[0]],o=null!=t[e[1]];a&&!o?n[r]="percent":!a&&o?n[r]="value":i?n[r]=i[r]:a&&(n[r]="percent")})}var g=f;e.exports=g},"3b2b":function(e,t,n){var i=n("7726"),r=n("5dbc"),a=n("86cc").f,o=n("9093").f,s=n("aae3"),l=n("0bfb"),u=i.RegExp,c=u,d=u.prototype,f=/a/g,h=/a/g,p=new u(f)!==f;if(n("9e1e")&&(!p||n("79e5")(function(){return h[n("2b4c")("match")]=!1,u(f)!=f||u(h)==h||"/a/i"!=u(f,"i")}))){u=function(e,t){var n=this instanceof u,i=s(e),a=void 0===t;return!n&&i&&e.constructor===u&&a?e:r(p?new c(i&&!a?e.source:e,t):c((i=e instanceof u)?e.source:e,i&&a?l.call(e):t),n?this:d,u)};for(var g=function(e){e in u||a(u,e,{configurable:!0,get:function(){return c[e]},set:function(t){c[e]=t}})},m=o(c),v=0;m.length>v;)g(m[v++]);d.constructor=u,u.prototype=d,n("2aba")(i,"RegExp",u)}n("7a56")("RegExp")},"3eba":function(e,t,n){var i=n("4e08"),r=(i.__DEV__,n("697e7")),a=n("6d8b"),o=n("41ef"),s=n("22d1"),l=n("04f6"),u=n("1fab"),c=n("7e63"),d=n("843e"),f=n("2039"),h=n("ca98"),p=n("fb05"),g=n("d15d"),m=n("6cb7"),v=n("4f85"),y=n("b12f"),_=n("e887"),b=n("2306"),E=n("e0d3"),T=n("88b3"),S=T.throttle,w=n("fd63"),A=n("b809"),I=n("998c"),x=n("69ff"),R=n("c533"),C=n("f219");n("0352");var D=a.assert,k=a.each,M=a.isFunction,L=a.isObject,P=m.parseClassType,N="4.1.0",O={zrender:"4.0.4"},F=1,U=1e3,B=5e3,G=1e3,j=2e3,V=3e3,H=4e3,K=5e3,z={PROCESSOR:{FILTER:U,STATISTIC:B},VISUAL:{LAYOUT:G,GLOBAL:j,CHART:V,COMPONENT:H,BRUSH:K}},Z="__flagInMainProcess",q="__optionUpdated",Y=/^[a-zA-Z0-9_]+$/;function W(e){return function(t,n,i){t=t&&t.toLowerCase(),u.prototype[e].call(this,t,n,i)}}function $(){u.call(this)}function X(e,t,n){n=n||{},"string"===typeof t&&(t=Ae[t]),this.id,this.group,this._dom=e;var i="canvas",o=this._zr=r.init(e,{renderer:n.renderer||i,devicePixelRatio:n.devicePixelRatio,width:n.width,height:n.height});this._throttledZrFlush=S(a.bind(o.flush,o),17);t=a.clone(t);t&&p(t,!0),this._theme=t,this._chartsViews=[],this._chartsMap={},this._componentsViews=[],this._componentsMap={},this._coordSysMgr=new f;var s=this._api=ye(this);function c(e,t){return e.__prio-t.__prio}l(we,c),l(Ee,c),this._scheduler=new x(this,s,Ee,we),u.call(this),this._messageCenter=new $,this._initEvents(),this.resize=a.bind(this.resize,this),this._pendingActions=[],o.animation.on("frame",this._onframe,this),se(o,this),a.setAsPrimitive(this)}$.prototype.on=W("on"),$.prototype.off=W("off"),$.prototype.one=W("one"),a.mixin($,u);var Q=X.prototype;function J(e,t,n){var i,r=this._model,a=this._coordSysMgr.getCoordinateSystems();t=E.parseFinder(r,t);for(var o=0;o<a.length;o++){var s=a[o];if(s[e]&&null!=(i=s[e](r,t,n)))return i}}Q._onframe=function(){if(!this._disposed){var e=this._scheduler;if(this[q]){var t=this[q].silent;this[Z]=!0,te(this),ee.update.call(this),this[Z]=!1,this[q]=!1,ae.call(this,t),oe.call(this,t)}else if(e.unfinished){var n=F,i=this._model,r=this._api;e.unfinished=!1;do{var a=+new Date;e.performSeriesTasks(i),e.performDataProcessorTasks(i),ie(this,i),e.performVisualTasks(i),fe(this,this._model,r,"remain"),n-=+new Date-a}while(n>0&&e.unfinished);e.unfinished||this._zr.flush()}}},Q.getDom=function(){return this._dom},Q.getZr=function(){return this._zr},Q.setOption=function(e,t,n){var i;if(L(t)&&(n=t.lazyUpdate,i=t.silent,t=t.notMerge),this[Z]=!0,!this._model||t){var r=new h(this._api),a=this._theme,o=this._model=new c(null,null,a,r);o.scheduler=this._scheduler,o.init(null,null,a,r)}this._model.setOption(e,Te),n?(this[q]={silent:i},this[Z]=!1):(te(this),ee.update.call(this),this._zr.flush(),this[q]=!1,this[Z]=!1,ae.call(this,i),oe.call(this,i))},Q.setTheme=function(){console.log("ECharts#setTheme() is DEPRECATED in ECharts 3.0")},Q.getModel=function(){return this._model},Q.getOption=function(){return this._model&&this._model.getOption()},Q.getWidth=function(){return this._zr.getWidth()},Q.getHeight=function(){return this._zr.getHeight()},Q.getDevicePixelRatio=function(){return this._zr.painter.dpr||window.devicePixelRatio||1},Q.getRenderedCanvas=function(e){if(s.canvasSupported){e=e||{},e.pixelRatio=e.pixelRatio||1,e.backgroundColor=e.backgroundColor||this._model.get("backgroundColor");var t=this._zr;return t.painter.getRenderedCanvas(e)}},Q.getSvgDataUrl=function(){if(s.svgSupported){var e=this._zr,t=e.storage.getDisplayList();return a.each(t,function(e){e.stopAnimation(!0)}),e.painter.pathToDataUrl()}},Q.getDataURL=function(e){e=e||{};var t=e.excludeComponents,n=this._model,i=[],r=this;k(t,function(e){n.eachComponent({mainType:e},function(e){var t=r._componentsMap[e.__viewId];t.group.ignore||(i.push(t),t.group.ignore=!0)})});var a="svg"===this._zr.painter.getType()?this.getSvgDataUrl():this.getRenderedCanvas(e).toDataURL("image/"+(e&&e.type||"png"));return k(i,function(e){e.group.ignore=!1}),a},Q.getConnectedDataURL=function(e){if(s.canvasSupported){var t=this.group,n=Math.min,i=Math.max,o=1/0;if(Re[t]){var l=o,u=o,c=-o,d=-o,f=[],h=e&&e.pixelRatio||1;a.each(xe,function(r,o){if(r.group===t){var s=r.getRenderedCanvas(a.clone(e)),h=r.getDom().getBoundingClientRect();l=n(h.left,l),u=n(h.top,u),c=i(h.right,c),d=i(h.bottom,d),f.push({dom:s,left:h.left,top:h.top})}}),l*=h,u*=h,c*=h,d*=h;var p=c-l,g=d-u,m=a.createCanvas();m.width=p,m.height=g;var v=r.init(m);return k(f,function(e){var t=new b.Image({style:{x:e.left*h-l,y:e.top*h-u,image:e.dom}});v.add(t)}),v.refreshImmediately(),m.toDataURL("image/"+(e&&e.type||"png"))}return this.getDataURL(e)}},Q.convertToPixel=a.curry(J,"convertToPixel"),Q.convertFromPixel=a.curry(J,"convertFromPixel"),Q.containPixel=function(e,t){var n,i=this._model;return e=E.parseFinder(i,e),a.each(e,function(e,i){i.indexOf("Models")>=0&&a.each(e,function(e){var r=e.coordinateSystem;if(r&&r.containPoint)n|=!!r.containPoint(t);else if("seriesModels"===i){var a=this._chartsMap[e.__viewId];a&&a.containPoint&&(n|=a.containPoint(t,e))}},this)},this),!!n},Q.getVisual=function(e,t){var n=this._model;e=E.parseFinder(n,e,{defaultMainType:"series"});var i=e.seriesModel,r=i.getData(),a=e.hasOwnProperty("dataIndexInside")?e.dataIndexInside:e.hasOwnProperty("dataIndex")?r.indexOfRawIndex(e.dataIndex):null;return null!=a?r.getItemVisual(a,t):r.getVisual(t)},Q.getViewOfComponentModel=function(e){return this._componentsMap[e.__viewId]},Q.getViewOfSeriesModel=function(e){return this._chartsMap[e.__viewId]};var ee={prepareAndUpdate:function(e){te(this),ee.update.call(this,e)},update:function(e){var t=this._model,n=this._api,i=this._zr,r=this._coordSysMgr,a=this._scheduler;if(t){a.restoreData(t,e),a.performSeriesTasks(t),r.create(t,n),a.performDataProcessorTasks(t,e),ie(this,t),r.update(t,n),ue(t),a.performVisualTasks(t,e),ce(this,t,n,e);var l=t.get("backgroundColor")||"transparent";if(s.canvasSupported)i.setBackgroundColor(l);else{var u=o.parse(l);l=o.stringify(u,"rgb"),0===u[3]&&(l="transparent")}he(t,n)}},updateTransform:function(e){var t=this._model,n=this,i=this._api;if(t){var r=[];t.eachComponent(function(a,o){var s=n.getViewOfComponentModel(o);if(s&&s.__alive)if(s.updateTransform){var l=s.updateTransform(o,t,i,e);l&&l.update&&r.push(s)}else r.push(s)});var o=a.createHashMap();t.eachSeries(function(r){var a=n._chartsMap[r.__viewId];if(a.updateTransform){var s=a.updateTransform(r,t,i,e);s&&s.update&&o.set(r.uid,1)}else o.set(r.uid,1)}),ue(t),this._scheduler.performVisualTasks(t,e,{setDirty:!0,dirtyMap:o}),fe(n,t,i,e,o),he(t,this._api)}},updateView:function(e){var t=this._model;t&&(_.markUpdateMethod(e,"updateView"),ue(t),this._scheduler.performVisualTasks(t,e,{setDirty:!0}),ce(this,this._model,this._api,e),he(t,this._api))},updateVisual:function(e){ee.update.call(this,e)},updateLayout:function(e){ee.update.call(this,e)}};function te(e){var t=e._model,n=e._scheduler;n.restorePipelines(t),n.prepareStageTasks(),le(e,"component",t,n),le(e,"chart",t,n),n.plan()}function ne(e,t,n,i,r){var o=e._model;if(i){var s={};s[i+"Id"]=n[i+"Id"],s[i+"Index"]=n[i+"Index"],s[i+"Name"]=n[i+"Name"];var l={mainType:i,query:s};r&&(l.subType=r);var u=n.excludeSeriesId;null!=u&&(u=a.createHashMap(E.normalizeToArray(u))),o&&o.eachComponent(l,function(t){u&&null!=u.get(t.id)||c(e["series"===i?"_chartsMap":"_componentsMap"][t.__viewId])},e)}else k(e._componentsViews.concat(e._chartsViews),c);function c(i){i&&i.__alive&&i[t]&&i[t](i.__model,o,e._api,n)}}function ie(e,t){var n=e._chartsMap,i=e._scheduler;t.eachSeries(function(e){i.updateStreamModes(e,n[e.__viewId])})}function re(e,t){var n=e.type,i=e.escapeConnect,r=_e[n],o=r.actionInfo,s=(o.update||"update").split(":"),l=s.pop();s=null!=s[0]&&P(s[0]),this[Z]=!0;var u=[e],c=!1;e.batch&&(c=!0,u=a.map(e.batch,function(t){return t=a.defaults(a.extend({},t),e),t.batch=null,t}));var d,f=[],h="highlight"===n||"downplay"===n;k(u,function(e){d=r.action(e,this._model,this._api),d=d||a.extend({},e),d.type=o.event||d.type,f.push(d),h?ne(this,l,e,"series"):s&&ne(this,l,e,s.main,s.sub)},this),"none"===l||h||s||(this[q]?(te(this),ee.update.call(this,e),this[q]=!1):ee[l].call(this,e)),d=c?{type:o.event||n,escapeConnect:i,batch:f}:f[0],this[Z]=!1,!t&&this._messageCenter.trigger(d.type,d)}function ae(e){var t=this._pendingActions;while(t.length){var n=t.shift();re.call(this,n,e)}}function oe(e){!e&&this.trigger("updated")}function se(e,t){e.on("rendered",function(){t.trigger("rendered"),!e.animation.isFinished()||t[q]||t._scheduler.unfinished||t._pendingActions.length||t.trigger("finished")})}function le(e,t,n,i){for(var r="component"===t,a=r?e._componentsViews:e._chartsViews,o=r?e._componentsMap:e._chartsMap,s=e._zr,l=e._api,u=0;u<a.length;u++)a[u].__alive=!1;function c(e){var t="_ec_"+e.id+"_"+e.type,u=o[t];if(!u){var c=P(e.type),d=r?y.getClass(c.main,c.sub):_.getClass(c.sub);u=new d,u.init(n,l),o[t]=u,a.push(u),s.add(u.group)}e.__viewId=u.__id=t,u.__alive=!0,u.__model=e,u.group.__ecComponentInfo={mainType:e.mainType,index:e.componentIndex},!r&&i.prepareView(u,e,n,l)}r?n.eachComponent(function(e,t){"series"!==e&&c(t)}):n.eachSeries(c);for(u=0;u<a.length;){var d=a[u];d.__alive?u++:(!r&&d.renderTask.dispose(),s.remove(d.group),d.dispose(n,l),a.splice(u,1),delete o[d.__id],d.__id=d.group.__ecComponentInfo=null)}}function ue(e){e.clearColorPalette(),e.eachSeries(function(e){e.clearColorPalette()})}function ce(e,t,n,i){de(e,t,n,i),k(e._chartsViews,function(e){e.__alive=!1}),fe(e,t,n,i),k(e._chartsViews,function(e){e.__alive||e.remove(t,n)})}function de(e,t,n,i,r){k(r||e._componentsViews,function(e){var r=e.__model;e.render(r,t,n,i),ve(r,e)})}function fe(e,t,n,i,r){var a,o=e._scheduler;t.eachSeries(function(t){var n=e._chartsMap[t.__viewId];n.__alive=!0;var s=n.renderTask;o.updatePayload(s,i),r&&r.get(t.uid)&&s.dirty(),a|=s.perform(o.getPerformArgs(s)),n.group.silent=!!t.get("silent"),ve(t,n),me(t,n)}),o.unfinished|=a,ge(e._zr,t),A(e._zr.dom,t)}function he(e,t){k(Se,function(n){n(e,t)})}Q.resize=function(e){this._zr.resize(e);var t=this._model;if(this._loadingFX&&this._loadingFX.resize(),t){var n=t.resetOption("media"),i=e&&e.silent;this[Z]=!0,n&&te(this),ee.update.call(this),this[Z]=!1,ae.call(this,i),oe.call(this,i)}},Q.showLoading=function(e,t){if(L(e)&&(t=e,e=""),e=e||"default",this.hideLoading(),Ie[e]){var n=Ie[e](this._api,t),i=this._zr;this._loadingFX=n,i.add(n)}},Q.hideLoading=function(){this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null},Q.makeActionFromEvent=function(e){var t=a.extend({},e);return t.type=be[e.type],t},Q.dispatchAction=function(e,t){L(t)||(t={silent:!!t}),_e[e.type]&&this._model&&(this[Z]?this._pendingActions.push(e):(re.call(this,e,t.silent),t.flush?this._zr.flush(!0):!1!==t.flush&&s.browser.weChat&&this._throttledZrFlush(),ae.call(this,t.silent),oe.call(this,t.silent)))},Q.appendData=function(e){var t=e.seriesIndex,n=this.getModel(),i=n.getSeriesByIndex(t);i.appendData(e),this._scheduler.unfinished=!0},Q.on=W("on"),Q.off=W("off"),Q.one=W("one");var pe=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"];function ge(e,t){var n=e.storage,i=0;n.traverse(function(e){e.isGroup||i++}),i>t.get("hoverLayerThreshold")&&!s.node&&n.traverse(function(e){e.isGroup||(e.useHoverLayer=!0)})}function me(e,t){var n=e.get("blendMode")||null;t.group.traverse(function(e){e.isGroup||e.style.blend!==n&&e.setStyle("blend",n),e.eachPendingDisplayable&&e.eachPendingDisplayable(function(e){e.setStyle("blend",n)})})}function ve(e,t){var n=e.get("z"),i=e.get("zlevel");t.group.traverse(function(e){"group"!==e.type&&(null!=n&&(e.z=n),null!=i&&(e.zlevel=i))})}function ye(e){var t=e._coordSysMgr;return a.extend(new d(e),{getCoordinateSystems:a.bind(t.getCoordinateSystems,t),getComponentByElement:function(t){while(t){var n=t.__ecComponentInfo;if(null!=n)return e._model.getComponent(n.mainType,n.index);t=t.parent}}})}Q._initEvents=function(){k(pe,function(e){this._zr.on(e,function(t){var n,i=this.getModel(),r=t.target;if("globalout"===e)n={};else if(r&&null!=r.dataIndex){var o=r.dataModel||i.getSeriesByIndex(r.seriesIndex);n=o&&o.getDataParams(r.dataIndex,r.dataType)||{}}else r&&r.eventData&&(n=a.extend({},r.eventData));n&&(n.event=t,n.type=e,this.trigger(e,n))},this)},this),k(be,function(e,t){this._messageCenter.on(t,function(e){this.trigger(t,e)},this)},this)},Q.isDisposed=function(){return this._disposed},Q.clear=function(){this.setOption({series:[]},!0)},Q.dispose=function(){if(!this._disposed){this._disposed=!0,E.setAttribute(this.getDom(),ke,"");var e=this._api,t=this._model;k(this._componentsViews,function(n){n.dispose(t,e)}),k(this._chartsViews,function(n){n.dispose(t,e)}),this._zr.dispose(),delete xe[this.id]}},a.mixin(X,u);var _e={},be={},Ee=[],Te=[],Se=[],we=[],Ae={},Ie={},xe={},Re={},Ce=new Date-0,De=new Date-0,ke="_echarts_instance_",Me={};function Le(e){var t=0,n=1,i=2,r="__connectUpdateStatus";function a(e,t){for(var n=0;n<e.length;n++){var i=e[n];i[r]=t}}k(be,function(o,s){e._messageCenter.on(s,function(o){if(Re[e.group]&&e[r]!==t){if(o&&o.escapeConnect)return;var s=e.makeActionFromEvent(o),l=[];k(xe,function(t){t!==e&&t.group===e.group&&l.push(t)}),a(l,t),k(l,function(e){e[r]!==n&&e.dispatchAction(s)}),a(l,i)}})})}function Pe(e,t,n){var i=Be(e);if(i)return i;var r=new X(e,t,n);return r.id="ec_"+Ce++,xe[r.id]=r,E.setAttribute(e,ke,r.id),Le(r),r}function Ne(e){if(a.isArray(e)){var t=e;e=null,k(t,function(t){null!=t.group&&(e=t.group)}),e=e||"g_"+De++,k(t,function(t){t.group=e})}return Re[e]=!0,e}function Oe(e){Re[e]=!1}var Fe=Oe;function Ue(e){"string"===typeof e?e=xe[e]:e instanceof X||(e=Be(e)),e instanceof X&&!e.isDisposed()&&e.dispose()}function Be(e){return xe[E.getAttribute(e,ke)]}function Ge(e){return xe[e]}function je(e,t){Ae[e]=t}function Ve(e){Te.push(e)}function He(e,t){$e(Ee,e,t,U)}function Ke(e){Se.push(e)}function ze(e,t,n){"function"===typeof t&&(n=t,t="");var i=L(e)?e.type:[e,e={event:t}][0];e.event=(e.event||i).toLowerCase(),t=e.event,D(Y.test(i)&&Y.test(t)),_e[i]||(_e[i]={action:n,actionInfo:e}),be[t]=i}function Ze(e,t){f.register(e,t)}function qe(e){var t=f.get(e);if(t)return t.getDimensionsInfo?t.getDimensionsInfo():t.dimensions.slice()}function Ye(e,t){$e(we,e,t,G,"layout")}function We(e,t){$e(we,e,t,V,"visual")}function $e(e,t,n,i,r){(M(t)||L(t))&&(n=t,t=i);var a=x.wrapStageHandler(n,r);return a.__prio=t,a.__raw=n,e.push(a),a}function Xe(e,t){Ie[e]=t}function Qe(e){return m.extend(e)}function Je(e){return y.extend(e)}function et(e){return v.extend(e)}function tt(e){return _.extend(e)}function nt(e){a.$override("createCanvas",e)}function it(e,t,n){t.geoJson&&!t.features&&(n=t.specialAreas,t=t.geoJson),"string"===typeof t&&(t="undefined"!==typeof JSON&&JSON.parse?JSON.parse(t):new Function("return ("+t+");")()),Me[e]={geoJson:t,specialAreas:n}}function rt(e){return Me[e]}We(j,w),Ve(p),He(B,g),Xe("default",I),ze({type:"highlight",event:"highlight",update:"highlight"},a.noop),ze({type:"downplay",event:"downplay",update:"downplay"},a.noop),je("light",R),je("dark",C);var at={};t.version=N,t.dependencies=O,t.PRIORITY=z,t.init=Pe,t.connect=Ne,t.disConnect=Oe,t.disconnect=Fe,t.dispose=Ue,t.getInstanceByDom=Be,t.getInstanceById=Ge,t.registerTheme=je,t.registerPreprocessor=Ve,t.registerProcessor=He,t.registerPostUpdate=Ke,t.registerAction=ze,t.registerCoordinateSystem=Ze,t.getCoordinateSystemDimensions=qe,t.registerLayout=Ye,t.registerVisual=We,t.registerLoading=Xe,t.extendComponentModel=Qe,t.extendComponentView=Je,t.extendSeriesModel=et,t.extendChartView=tt,t.setCanvasCreator=nt,t.registerMap=it,t.getMap=rt,t.dataTool=at;var ot=n("b719");(function(){for(var e in ot)ot.hasOwnProperty(e)&&(t[e]=ot[e])})()},"401b":function(e,t){var n="undefined"===typeof Float32Array?Array:Float32Array;function i(e,t){var i=new n(2);return null==e&&(e=0),null==t&&(t=0),i[0]=e,i[1]=t,i}function r(e,t){return e[0]=t[0],e[1]=t[1],e}function a(e){var t=new n(2);return t[0]=e[0],t[1]=e[1],t}function o(e,t,n){return e[0]=t,e[1]=n,e}function s(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function l(e,t,n,i){return e[0]=t[0]+n[0]*i,e[1]=t[1]+n[1]*i,e}function u(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}function c(e){return Math.sqrt(f(e))}var d=c;function f(e){return e[0]*e[0]+e[1]*e[1]}var h=f;function p(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e}function g(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e}function m(e,t){return e[0]*t[0]+e[1]*t[1]}function v(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e}function y(e,t){var n=c(t);return 0===n?(e[0]=0,e[1]=0):(e[0]=t[0]/n,e[1]=t[1]/n),e}function _(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))}var b=_;function E(e,t){return(e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])}var T=E;function S(e,t){return e[0]=-t[0],e[1]=-t[1],e}function w(e,t,n,i){return e[0]=t[0]+i*(n[0]-t[0]),e[1]=t[1]+i*(n[1]-t[1]),e}function A(e,t,n){var i=t[0],r=t[1];return e[0]=n[0]*i+n[2]*r+n[4],e[1]=n[1]*i+n[3]*r+n[5],e}function I(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e}function x(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e}t.create=i,t.copy=r,t.clone=a,t.set=o,t.add=s,t.scaleAndAdd=l,t.sub=u,t.len=c,t.length=d,t.lenSquare=f,t.lengthSquare=h,t.mul=p,t.div=g,t.dot=m,t.scale=v,t.normalize=y,t.distance=_,t.dist=b,t.distanceSquare=E,t.distSquare=T,t.negate=S,t.lerp=w,t.applyTransform=A,t.min=I,t.max=x},"414c":function(e,t,n){var i=n("3a56"),r=i.extend({type:"dataZoom.select"});e.exports=r},"41a0":function(e,t,n){"use strict";var i=n("2aeb"),r=n("4630"),a=n("7f20"),o={};n("32e9")(o,n("2b4c")("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=i(o,{next:r(1,n)}),a(e,t+" Iterator")}},"41ef":function(e,t,n){var i=n("d51b"),r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function a(e){return e=Math.round(e),e<0?0:e>255?255:e}function o(e){return e=Math.round(e),e<0?0:e>360?360:e}function s(e){return e<0?0:e>1?1:e}function l(e){return e.length&&"%"===e.charAt(e.length-1)?a(parseFloat(e)/100*255):a(parseInt(e,10))}function u(e){return e.length&&"%"===e.charAt(e.length-1)?s(parseFloat(e)/100):s(parseFloat(e))}function c(e,t,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?e+(t-e)*n*6:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}function d(e,t,n){return e+(t-e)*n}function f(e,t,n,i,r){return e[0]=t,e[1]=n,e[2]=i,e[3]=r,e}function h(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}var p=new i(20),g=null;function m(e,t){g&&h(g,t),g=p.put(e,g||t.slice())}function v(e,t){if(e){t=t||[];var n=p.get(e);if(n)return h(t,n);e+="";var i=e.replace(/ /g,"").toLowerCase();if(i in r)return h(t,r[i]),m(e,t),t;if("#"!==i.charAt(0)){var a=i.indexOf("("),o=i.indexOf(")");if(-1!==a&&o+1===i.length){var s=i.substr(0,a),c=i.substr(a+1,o-(a+1)).split(","),d=1;switch(s){case"rgba":if(4!==c.length)return void f(t,0,0,0,1);d=u(c.pop());case"rgb":return 3!==c.length?void f(t,0,0,0,1):(f(t,l(c[0]),l(c[1]),l(c[2]),d),m(e,t),t);case"hsla":return 4!==c.length?void f(t,0,0,0,1):(c[3]=u(c[3]),y(c,t),m(e,t),t);case"hsl":return 3!==c.length?void f(t,0,0,0,1):(y(c,t),m(e,t),t);default:return}}f(t,0,0,0,1)}else{if(4===i.length){var g=parseInt(i.substr(1),16);return g>=0&&g<=4095?(f(t,(3840&g)>>4|(3840&g)>>8,240&g|(240&g)>>4,15&g|(15&g)<<4,1),m(e,t),t):void f(t,0,0,0,1)}if(7===i.length){g=parseInt(i.substr(1),16);return g>=0&&g<=16777215?(f(t,(16711680&g)>>16,(65280&g)>>8,255&g,1),m(e,t),t):void f(t,0,0,0,1)}}}}function y(e,t){var n=(parseFloat(e[0])%360+360)%360/360,i=u(e[1]),r=u(e[2]),o=r<=.5?r*(i+1):r+i-r*i,s=2*r-o;return t=t||[],f(t,a(255*c(s,o,n+1/3)),a(255*c(s,o,n)),a(255*c(s,o,n-1/3)),1),4===e.length&&(t[3]=e[3]),t}function _(e){if(e){var t,n,i=e[0]/255,r=e[1]/255,a=e[2]/255,o=Math.min(i,r,a),s=Math.max(i,r,a),l=s-o,u=(s+o)/2;if(0===l)t=0,n=0;else{n=u<.5?l/(s+o):l/(2-s-o);var c=((s-i)/6+l/2)/l,d=((s-r)/6+l/2)/l,f=((s-a)/6+l/2)/l;i===s?t=f-d:r===s?t=1/3+c-f:a===s&&(t=2/3+d-c),t<0&&(t+=1),t>1&&(t-=1)}var h=[360*t,n,u];return null!=e[3]&&h.push(e[3]),h}}function b(e,t){var n=v(e);if(n){for(var i=0;i<3;i++)n[i]=t<0?n[i]*(1-t)|0:(255-n[i])*t+n[i]|0,n[i]>255?n[i]=255:e[i]<0&&(n[i]=0);return R(n,4===n.length?"rgba":"rgb")}}function E(e){var t=v(e);if(t)return((1<<24)+(t[0]<<16)+(t[1]<<8)+ +t[2]).toString(16).slice(1)}function T(e,t,n){if(t&&t.length&&e>=0&&e<=1){n=n||[];var i=e*(t.length-1),r=Math.floor(i),o=Math.ceil(i),l=t[r],u=t[o],c=i-r;return n[0]=a(d(l[0],u[0],c)),n[1]=a(d(l[1],u[1],c)),n[2]=a(d(l[2],u[2],c)),n[3]=s(d(l[3],u[3],c)),n}}var S=T;function w(e,t,n){if(t&&t.length&&e>=0&&e<=1){var i=e*(t.length-1),r=Math.floor(i),o=Math.ceil(i),l=v(t[r]),u=v(t[o]),c=i-r,f=R([a(d(l[0],u[0],c)),a(d(l[1],u[1],c)),a(d(l[2],u[2],c)),s(d(l[3],u[3],c))],"rgba");return n?{color:f,leftIndex:r,rightIndex:o,value:i}:f}}var A=w;function I(e,t,n,i){if(e=v(e),e)return e=_(e),null!=t&&(e[0]=o(t)),null!=n&&(e[1]=u(n)),null!=i&&(e[2]=u(i)),R(y(e),"rgba")}function x(e,t){if(e=v(e),e&&null!=t)return e[3]=s(t),R(e,"rgba")}function R(e,t){if(e&&e.length){var n=e[0]+","+e[1]+","+e[2];return"rgba"!==t&&"hsva"!==t&&"hsla"!==t||(n+=","+e[3]),t+"("+n+")"}}t.parse=v,t.lift=b,t.toHex=E,t.fastLerp=T,t.fastMapToColor=S,t.lerp=w,t.mapToColor=A,t.modifyHSL=I,t.modifyAlpha=x,t.stringify=R},"42e5":function(e,t){var n=function(e){this.colorStops=e||[]};n.prototype={constructor:n,addColorStop:function(e,t){this.colorStops.push({offset:e,color:t})}};var i=n;e.exports=i},"42f6":function(e,t,n){var i=n("3eba"),r=n("6d8b"),a=n("22d1"),o=n("07d7"),s=n("eda2"),l=n("3842"),u=n("2306"),c=n("133d"),d=n("f934"),f=n("4319"),h=n("17d6"),p=n("697e"),g=n("ff2e"),m=r.bind,v=r.each,y=l.parsePercent,_=new u.Rect({shape:{x:-1,y:-1,width:2,height:2}}),b=i.extendComponentView({type:"tooltip",init:function(e,t){if(!a.node){var n=new o(t.getDom(),t);this._tooltipContent=n}},render:function(e,t,n){if(!a.node&&!a.wxa){this.group.removeAll(),this._tooltipModel=e,this._ecModel=t,this._api=n,this._lastDataByCoordSys=null,this._alwaysShowContent=e.get("alwaysShowContent");var i=this._tooltipContent;i.update(),i.setEnterable(e.get("enterable")),this._initGlobalListener(),this._keepShow()}},_initGlobalListener:function(){var e=this._tooltipModel,t=e.get("triggerOn");h.register("itemTooltip",this._api,m(function(e,n,i){"none"!==t&&(t.indexOf(e)>=0?this._tryShow(n,i):"leave"===e&&this._hide(i))},this))},_keepShow:function(){var e=this._tooltipModel,t=this._ecModel,n=this._api;if(null!=this._lastX&&null!=this._lastY&&"none"!==e.get("triggerOn")){var i=this;clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout(function(){i.manuallyShowTip(e,t,n,{x:i._lastX,y:i._lastY})})}},manuallyShowTip:function(e,t,n,i){if(i.from!==this.uid&&!a.node){var r=T(i,n);this._ticket="";var o=i.dataByCoordSys;if(i.tooltip&&null!=i.x&&null!=i.y){var s=_;s.position=[i.x,i.y],s.update(),s.tooltip=i.tooltip,this._tryShow({offsetX:i.x,offsetY:i.y,target:s},r)}else if(o)this._tryShow({offsetX:i.x,offsetY:i.y,position:i.position,event:{},dataByCoordSys:i.dataByCoordSys,tooltipOption:i.tooltipOption},r);else if(null!=i.seriesIndex){if(this._manuallyAxisShowTip(e,t,n,i))return;var l=c(i,t),u=l.point[0],d=l.point[1];null!=u&&null!=d&&this._tryShow({offsetX:u,offsetY:d,position:i.position,target:l.el,event:{}},r)}else null!=i.x&&null!=i.y&&(n.dispatchAction({type:"updateAxisPointer",x:i.x,y:i.y}),this._tryShow({offsetX:i.x,offsetY:i.y,position:i.position,target:n.getZr().findHover(i.x,i.y).target,event:{}},r))}},manuallyHideTip:function(e,t,n,i){var r=this._tooltipContent;!this._alwaysShowContent&&this._tooltipModel&&r.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=null,i.from!==this.uid&&this._hide(T(i,n))},_manuallyAxisShowTip:function(e,t,n,i){var r=i.seriesIndex,a=i.dataIndex,o=t.getComponent("axisPointer").coordSysAxesInfo;if(null!=r&&null!=a&&null!=o){var s=t.getSeriesByIndex(r);if(s){var l=s.getData();e=E([l.getItemModel(a),s,(s.coordinateSystem||{}).model,e]);if("axis"===e.get("trigger"))return n.dispatchAction({type:"updateAxisPointer",seriesIndex:r,dataIndex:a,position:i.position}),!0}}},_tryShow:function(e,t){var n=e.target,i=this._tooltipModel;if(i){this._lastX=e.offsetX,this._lastY=e.offsetY;var r=e.dataByCoordSys;r&&r.length?this._showAxisTooltip(r,e):n&&null!=n.dataIndex?(this._lastDataByCoordSys=null,this._showSeriesItemTooltip(e,n,t)):n&&n.tooltip?(this._lastDataByCoordSys=null,this._showComponentItemTooltip(e,n,t)):(this._lastDataByCoordSys=null,this._hide(t))}},_showOrMove:function(e,t){var n=e.get("showDelay");t=r.bind(t,this),clearTimeout(this._showTimout),n>0?this._showTimout=setTimeout(t,n):t()},_showAxisTooltip:function(e,t){var n=this._ecModel,i=this._tooltipModel,a=[t.offsetX,t.offsetY],o=[],l=[],u=E([t.tooltipOption,i]);v(e,function(e){v(e.dataByAxis,function(e){var t=n.getComponent(e.axisDim+"Axis",e.axisIndex),i=e.value,a=[];if(t&&null!=i){var u=g.getValueLabel(i,t.axis,n,e.seriesDataIndices,e.valueLabelOpt);r.each(e.seriesDataIndices,function(r){var o=n.getSeriesByIndex(r.seriesIndex),s=r.dataIndexInside,c=o&&o.getDataParams(s);c.axisDim=e.axisDim,c.axisIndex=e.axisIndex,c.axisType=e.axisType,c.axisId=e.axisId,c.axisValue=p.getAxisRawValue(t.axis,i),c.axisValueLabel=u,c&&(l.push(c),a.push(o.formatTooltip(s,!0)))});var c=u;o.push((c?s.encodeHTML(c)+"<br />":"")+a.join("<br />"))}})},this),o.reverse(),o=o.join("<br /><br />");var c=t.position;this._showOrMove(u,function(){this._updateContentNotChangedOnAxis(e)?this._updatePosition(u,c,a[0],a[1],this._tooltipContent,l):this._showTooltipContent(u,o,l,Math.random(),a[0],a[1],c)})},_showSeriesItemTooltip:function(e,t,n){var i=this._ecModel,r=t.seriesIndex,a=i.getSeriesByIndex(r),o=t.dataModel||a,s=t.dataIndex,l=t.dataType,u=o.getData(),c=E([u.getItemModel(s),o,a&&(a.coordinateSystem||{}).model,this._tooltipModel]),d=c.get("trigger");if(null==d||"item"===d){var f=o.getDataParams(s,l),h=o.formatTooltip(s,!1,l),p="item_"+o.name+"_"+s;this._showOrMove(c,function(){this._showTooltipContent(c,h,f,p,e.offsetX,e.offsetY,e.position,e.target)}),n({type:"showTip",dataIndexInside:s,dataIndex:u.getRawIndex(s),seriesIndex:r,from:this.uid})}},_showComponentItemTooltip:function(e,t,n){var i=t.tooltip;if("string"===typeof i){var r=i;i={content:r,formatter:r}}var a=new f(i,this._tooltipModel,this._ecModel),o=a.get("content"),s=Math.random();this._showOrMove(a,function(){this._showTooltipContent(a,o,a.get("formatterParams")||{},s,e.offsetX,e.offsetY,e.position,t)}),n({type:"showTip",from:this.uid})},_showTooltipContent:function(e,t,n,i,r,a,o,l){if(this._ticket="",e.get("showContent")&&e.get("show")){var u=this._tooltipContent,c=e.get("formatter");o=o||e.get("position");var d=t;if(c&&"string"===typeof c)d=s.formatTpl(c,n,!0);else if("function"===typeof c){var f=m(function(t,i){t===this._ticket&&(u.setContent(i),this._updatePosition(e,o,r,a,u,n,l))},this);this._ticket=i,d=c(n,i,f)}u.setContent(d),u.show(e),this._updatePosition(e,o,r,a,u,n,l)}},_updatePosition:function(e,t,n,i,a,o,s){var l=this._api.getWidth(),u=this._api.getHeight();t=t||e.get("position");var c=a.getSize(),f=e.get("align"),h=e.get("verticalAlign"),p=s&&s.getBoundingRect().clone();if(s&&p.applyTransform(s.transform),"function"===typeof t&&(t=t([n,i],o,a.el,p,{viewSize:[l,u],contentSize:c.slice()})),r.isArray(t))n=y(t[0],l),i=y(t[1],u);else if(r.isObject(t)){t.width=c[0],t.height=c[1];var g=d.getLayoutRect(t,{width:l,height:u});n=g.x,i=g.y,f=null,h=null}else if("string"===typeof t&&s){var m=I(t,p,c);n=m[0],i=m[1]}else{m=S(n,i,a.el,l,u,f?null:20,h?null:20);n=m[0],i=m[1]}if(f&&(n-=x(f)?c[0]/2:"right"===f?c[0]:0),h&&(i-=x(h)?c[1]/2:"bottom"===h?c[1]:0),e.get("confine")){m=w(n,i,a.el,l,u);n=m[0],i=m[1]}a.moveTo(n,i)},_updateContentNotChangedOnAxis:function(e){var t=this._lastDataByCoordSys,n=!!t&&t.length===e.length;return n&&v(t,function(t,i){var r=t.dataByAxis||{},a=e[i]||{},o=a.dataByAxis||[];n&=r.length===o.length,n&&v(r,function(e,t){var i=o[t]||{},r=e.seriesDataIndices||[],a=i.seriesDataIndices||[];n&=e.value===i.value&&e.axisType===i.axisType&&e.axisId===i.axisId&&r.length===a.length,n&&v(r,function(e,t){var i=a[t];n&=e.seriesIndex===i.seriesIndex&&e.dataIndex===i.dataIndex})})}),this._lastDataByCoordSys=e,!!n},_hide:function(e){this._lastDataByCoordSys=null,e({type:"hideTip",from:this.uid})},dispose:function(e,t){a.node||a.wxa||(this._tooltipContent.hide(),h.unregister("itemTooltip",t))}});function E(e){var t=e.pop();while(e.length){var n=e.pop();n&&(f.isInstance(n)&&(n=n.get("tooltip",!0)),"string"===typeof n&&(n={formatter:n}),t=new f(n,t,t.ecModel))}return t}function T(e,t){return e.dispatchAction||r.bind(t.dispatchAction,t)}function S(e,t,n,i,r,a,o){var s=A(n),l=s.width,u=s.height;return null!=a&&(e+l+a>i?e-=l+a:e+=a),null!=o&&(t+u+o>r?t-=u+o:t+=o),[e,t]}function w(e,t,n,i,r){var a=A(n),o=a.width,s=a.height;return e=Math.min(e+o,i)-o,t=Math.min(t+s,r)-s,e=Math.max(e,0),t=Math.max(t,0),[e,t]}function A(e){var t=e.clientWidth,n=e.clientHeight;if(document.defaultView&&document.defaultView.getComputedStyle){var i=document.defaultView.getComputedStyle(e);i&&(t+=parseInt(i.paddingLeft,10)+parseInt(i.paddingRight,10)+parseInt(i.borderLeftWidth,10)+parseInt(i.borderRightWidth,10),n+=parseInt(i.paddingTop,10)+parseInt(i.paddingBottom,10)+parseInt(i.borderTopWidth,10)+parseInt(i.borderBottomWidth,10))}return{width:t,height:n}}function I(e,t,n){var i=n[0],r=n[1],a=5,o=0,s=0,l=t.width,u=t.height;switch(e){case"inside":o=t.x+l/2-i/2,s=t.y+u/2-r/2;break;case"top":o=t.x+l/2-i/2,s=t.y-r-a;break;case"bottom":o=t.x+l/2-i/2,s=t.y+u+a;break;case"left":o=t.x-i-a,s=t.y+u/2-r/2;break;case"right":o=t.x+l+a,s=t.y+u/2-r/2}return[o,s]}function x(e){return"center"===e||"middle"===e}e.exports=b},4319:function(e,t,n){var i=n("6d8b"),r=n("22d1"),a=n("e0d3"),o=a.makeInner,s=n("625e"),l=s.enableClassExtend,u=s.enableClassCheck,c=n("3901"),d=n("9bdb"),f=n("fe21"),h=n("551f"),p=i.mixin,g=o();function m(e,t,n){this.parentModel=t,this.ecModel=n,this.option=e}function v(e,t,n){for(var i=0;i<t.length;i++)if(t[i]&&(e=e&&"object"===typeof e?e[t[i]]:null,null==e))break;return null==e&&n&&(e=n.get(t)),e}function y(e,t){var n=g(e).getParent;return n?n.call(e,t):e.parentModel}m.prototype={constructor:m,init:null,mergeOption:function(e){i.merge(this.option,e,!0)},get:function(e,t){return null==e?this.option:v(this.option,this.parsePath(e),!t&&y(this,e))},getShallow:function(e,t){var n=this.option,i=null==n?n:n[e],r=!t&&y(this,e);return null==i&&r&&(i=r.getShallow(e)),i},getModel:function(e,t){var n,i=null==e?this.option:v(this.option,e=this.parsePath(e));return t=t||(n=y(this,e))&&n.getModel(e),new m(i,t,this.ecModel)},isEmpty:function(){return null==this.option},restoreData:function(){},clone:function(){var e=this.constructor;return new e(i.clone(this.option))},setReadOnly:function(e){},parsePath:function(e){return"string"===typeof e&&(e=e.split(".")),e},customizeGetParent:function(e){g(this).getParent=e},isAnimationEnabled:function(){if(!r.node){if(null!=this.option.animation)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled()}}},l(m),u(m),p(m,c),p(m,d),p(m,f),p(m,h);var _=m;e.exports=_},4362:function(e,t,n){t.nextTick=function(e){setTimeout(e,0)},t.platform=t.arch=t.execPath=t.title="browser",t.pid=1,t.browser=!0,t.env={},t.argv=[],t.binding=function(e){throw new Error("No such module. (Possibly not yet loaded)")},function(){var e,i="/";t.cwd=function(){return i},t.chdir=function(t){e||(e=n("b69a")),i=e.resolve(t,i)}}(),t.exit=t.kill=t.umask=t.dlopen=t.uptime=t.memoryUsage=t.uvCounters=function(){},t.features={}},4436:function(e,t,n){var i=n("74cb");function r(e){this._target=e.target,this._life=e.life||1e3,this._delay=e.delay||0,this._initialized=!1,this.loop=null!=e.loop&&e.loop,this.gap=e.gap||0,this.easing=e.easing||"Linear",this.onframe=e.onframe,this.ondestroy=e.ondestroy,this.onrestart=e.onrestart,this._pausedTime=0,this._paused=!1}r.prototype={constructor:r,step:function(e,t){if(this._initialized||(this._startTime=e+this._delay,this._initialized=!0),this._paused)this._pausedTime+=t;else{var n=(e-this._startTime-this._pausedTime)/this._life;if(!(n<0)){n=Math.min(n,1);var r=this.easing,a="string"==typeof r?i[r]:r,o="function"===typeof a?a(n):n;return this.fire("frame",o),1==n?this.loop?(this.restart(e),"restart"):(this._needsRemove=!0,"destroy"):null}}},restart:function(e){var t=(e-this._startTime-this._pausedTime)%this._life;this._startTime=e-t+this.gap,this._pausedTime=0,this._needsRemove=!1},fire:function(e,t){e="on"+e,this[e]&&this[e](this._target,t)},pause:function(){this._paused=!0},resume:function(){this._paused=!1}};var a=r;e.exports=a},"446e":function(e,t,n){(function(e){
/*
 @license
 Shaka Player
 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
(function(){var n="undefined"!=typeof window?window:e,i={};for(var r in function(e,t,n){var i;function r(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var a="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype?e:(e[t]=n.value,e)};function o(n){n=["object"==typeof globalThis&&globalThis,n,"object"==typeof e&&e,"object"==typeof self&&self,"object"==typeof t&&t];for(var i=0;i<n.length;++i){var r=n[i];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}var s=o(this);function l(e,t){if(t)e:{var n=s;e=e.split(".");for(var i=0;i<e.length-1;i++){var r=e[i];if(!(r in n))break e;n=n[r]}e=e[e.length-1],i=n[e],t=t(i),t!=i&&null!=t&&a(n,e,{configurable:!0,writable:!0,value:t})}}function u(e){return e={next:e},e[Symbol.iterator]=function(){return this},e}function c(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:r(e)}}function d(e){if(!(e instanceof Array)){e=c(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}l("Symbol",function(e){function t(e){if(this instanceof t)throw new TypeError("Symbol is not a constructor");return new n(i+(e||"")+"_"+r++,e)}function n(e,t){this.g=e,a(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;n.prototype.toString=function(){return this.g};var i="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",r=0;return t}),l("Symbol.iterator",function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),n=0;n<t.length;n++){var i=s[t[n]];"function"===typeof i&&"function"!=typeof i.prototype[e]&&a(i.prototype,e,{configurable:!0,writable:!0,value:function(){return u(r(this))}})}return e});var f,h="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)f=Object.setPrototypeOf;else{var p;e:{var g={a:!0},m={};try{m.__proto__=g,p=m.a;break e}catch(e){}p=!1}f=p?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var v=f;function y(e,t){if(e.prototype=h(t.prototype),e.prototype.constructor=e,v)v(e,t);else for(var n in t)if("prototype"!=n)if(Object.defineProperties){var i=Object.getOwnPropertyDescriptor(t,n);i&&Object.defineProperty(e,n,i)}else e[n]=t[n];e.pk=t.prototype}function _(){this.o=!1,this.l=null,this.h=void 0,this.g=1,this.j=this.m=0,this.A=this.i=null}function b(e){if(e.o)throw new TypeError("Generator is already running");e.o=!0}function E(e,t){e.i={Gg:t,Tg:!0},e.g=e.m||e.j}function T(e,t,n){return e.g=n,{value:t}}function S(e){e.g=0}function w(e,t,n){e.m=t,void 0!=n&&(e.j=n)}function A(e,t){e.m=0,e.j=t||0}function I(e,t,n){e.g=t,e.m=n||0}function x(e,t){return e.m=t||0,t=e.i.Gg,e.i=null,t}function R(e){e.A=[e.i],e.m=0,e.j=0}function C(e,t){var n=e.A.splice(0)[0];(n=e.i=e.i||n)?n.Tg?e.g=e.m||e.j:void 0!=n.u&&e.j<n.u?(e.g=n.u,e.i=null):e.g=e.j:e.g=t}function D(e){this.g=new _,this.h=e}function k(e,t){b(e.g);var n=e.g.l;return n?M(e,"return"in n?n["return"]:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),L(e))}function M(e,t,n,i){try{var r=t.call(e.g.l,n);if(!(r instanceof Object))throw new TypeError("Iterator result "+r+" is not an object");if(!r.done)return e.g.o=!1,r;var a=r.value}catch(t){return e.g.l=null,E(e.g,t),L(e)}return e.g.l=null,i.call(e.g,a),L(e)}function L(e){for(;e.g.g;)try{var t=e.h(e.g);if(t)return e.g.o=!1,{value:t.value,done:!1}}catch(t){e.g.h=void 0,E(e.g,t)}if(e.g.o=!1,e.g.i){if(t=e.g.i,e.g.i=null,t.Tg)throw t.Gg;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function P(e){this.next=function(t){return b(e.g),e.g.l?t=M(e,e.g.l.next,t,e.g.s):(e.g.s(t),t=L(e)),t},this.throw=function(t){return b(e.g),e.g.l?t=M(e,e.g.l["throw"],t,e.g.s):(E(e.g,t),t=L(e)),t},this.return=function(t){return k(e,t)},this[Symbol.iterator]=function(){return this}}function N(e){function t(t){return e.next(t)}function n(t){return e.throw(t)}return new Promise(function(i,r){function a(e){e.done?i(e.value):Promise.resolve(e.value).then(t,n).then(a,r)}a(e.next())})}function O(e){return N(new P(new D(e)))}function F(){for(var e=Number(this),t=[],n=e;n<arguments.length;n++)t[n-e]=arguments[n];return t}function U(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function B(e,t){e instanceof String&&(e+="");var n=0,i=!1,r={next:function(){if(!i&&n<e.length){var r=n++;return{value:t(r,e[r]),done:!1}}return i=!0,{done:!0,value:void 0}}};return r[Symbol.iterator]=function(){return r},r}function G(e,t,n){e instanceof String&&(e=String(e));for(var i=e.length,r=0;r<i;r++){var a=e[r];if(t.call(n,a,r,e))return{Rg:r,v:a}}return{Rg:-1,v:void 0}}function j(e,t,n){if(null==e)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return e+""}_.prototype.s=function(e){this.h=e},_.prototype.return=function(e){this.i={return:e},this.g=this.j},_.prototype.u=function(e){this.g=e},l("Promise",function(e){function t(e){this.h=0,this.i=void 0,this.g=[],this.o=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function n(){this.g=null}function i(e){return e instanceof t?e:new t(function(t){t(e)})}if(e)return e;n.prototype.h=function(e){if(null==this.g){this.g=[];var t=this;this.i(function(){t.l()})}this.g.push(e)};var r=s.setTimeout;n.prototype.i=function(e){r(e,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.j(e)}}}this.g=null},n.prototype.j=function(e){this.i(function(){throw e})},t.prototype.j=function(){function e(e){return function(i){n||(n=!0,e.call(t,i))}}var t=this,n=!1;return{resolve:e(this.F),reject:e(this.l)}},t.prototype.F=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.H(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.C(e):this.m(e)}},t.prototype.C=function(e){var t=void 0;try{t=e.then}catch(e){return void this.l(e)}"function"==typeof t?this.I(t,e):this.m(e)},t.prototype.l=function(e){this.s(2,e)},t.prototype.m=function(e){this.s(1,e)},t.prototype.s=function(e,t){if(0!=this.h)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.h);this.h=e,this.i=t,2===this.h&&this.G(),this.A()},t.prototype.G=function(){var e=this;r(function(){if(e.B()){var t=s.console;"undefined"!==typeof t&&t.error(e.i)}},1)},t.prototype.B=function(){if(this.o)return!1;var e=s.CustomEvent,t=s.Event,n=s.dispatchEvent;return"undefined"===typeof n||("function"===typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"===typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=s.document.createEvent("CustomEvent"),e.initCustomEvent("unhandledrejection",!1,!0,e)),e.promise=this,e.reason=this.i,n(e))},t.prototype.A=function(){if(null!=this.g){for(var e=0;e<this.g.length;++e)a.h(this.g[e]);this.g=null}};var a=new n;return t.prototype.H=function(e){var t=this.j();e.be(t.resolve,t.reject)},t.prototype.I=function(e,t){var n=this.j();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},t.prototype.then=function(e,n){function i(e,t){return"function"==typeof e?function(t){try{r(e(t))}catch(e){a(e)}}:t}var r,a,o=new t(function(e,t){r=e,a=t});return this.be(i(e,r),i(n,a)),o},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.be=function(e,t){function n(){switch(i.h){case 1:e(i.i);break;case 2:t(i.i);break;default:throw Error("Unexpected state: "+i.h)}}var i=this;null==this.g?a.h(n):this.g.push(n),this.o=!0},t.resolve=i,t.reject=function(e){return new t(function(t,n){n(e)})},t.race=function(e){return new t(function(t,n){for(var r=c(e),a=r.next();!a.done;a=r.next())i(a.value).be(t,n)})},t.all=function(e){var n=c(e),r=n.next();return r.done?i([]):new t(function(e,t){function a(t){return function(n){o[t]=n,s--,0==s&&e(o)}}var o=[],s=0;do{o.push(void 0),s++,i(r.value).be(a(o.length-1),t),r=n.next()}while(!r.done)})},t}),l("WeakMap",function(e){function t(e){if(this.g=(l+=Math.random()+1).toString(),e){e=c(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}function n(){}function i(e){var t=typeof e;return"object"===t&&null!==e||"function"===t}function r(e){if(!U(e,s)){var t=new n;a(e,s,{value:t})}}function o(e){var t=Object[e];t&&(Object[e]=function(e){return e instanceof n?e:(Object.isExtensible(e)&&r(e),t(e))})}if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),i=new e([[t,2],[n,3]]);return 2==i.get(t)&&3==i.get(n)&&(i.delete(t),i.set(n,4),!i.has(t)&&4==i.get(n))}catch(e){return!1}}())return e;var s="$jscomp_hidden_"+Math.random();o("freeze"),o("preventExtensions"),o("seal");var l=0;return t.prototype.set=function(e,t){if(!i(e))throw Error("Invalid WeakMap key");if(r(e),!U(e,s))throw Error("WeakMap key fail: "+e);return e[s][this.g]=t,this},t.prototype.get=function(e){return i(e)&&U(e,s)?e[s][this.g]:void 0},t.prototype.has=function(e){return i(e)&&U(e,s)&&U(e[s],this.g)},t.prototype.delete=function(e){return!!(i(e)&&U(e,s)&&U(e[s],this.g))&&delete e[s][this.g]},t}),l("Map",function(e){function t(){var e={};return e.Ob=e.next=e.head=e}function n(e,t){var n=e.g;return u(function(){if(n){for(;n.head!=e.g;)n=n.Ob;for(;n.next!=n.head;)return n=n.next,{done:!1,value:t(n)};n=null}return{done:!0,value:void 0}})}function i(e,t){var n=t&&typeof t;"object"==n||"function"==n?a.has(t)?n=a.get(t):(n=""+ ++o,a.set(t,n)):n="p_"+t;var i=e.h[n];if(i&&U(e.h,n))for(e=0;e<i.length;e++){var r=i[e];if(t!==t&&r.key!==r.key||t===r.key)return{id:n,list:i,index:e,entry:r}}return{id:n,list:i,index:-1,entry:void 0}}function r(e){if(this.h={},this.g=t(),this.size=0,e){e=c(e);for(var n;!(n=e.next()).done;)n=n.value,this.set(n[0],n[1])}}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(c([[t,"s"]]));if("s"!=n.get(t)||1!=n.size||n.get({x:4})||n.set({x:4},"t")!=n||2!=n.size)return!1;var i=n.entries(),r=i.next();return!r.done&&r.value[0]==t&&"s"==r.value[1]&&(r=i.next(),!(r.done||4!=r.value[0].x||"t"!=r.value[1]||!i.next().done))}catch(e){return!1}}())return e;var a=new WeakMap;r.prototype.set=function(e,t){e=0===e?0:e;var n=i(this,e);return n.list||(n.list=this.h[n.id]=[]),n.entry?n.entry.value=t:(n.entry={next:this.g,Ob:this.g.Ob,head:this.g,key:e,value:t},n.list.push(n.entry),this.g.Ob.next=n.entry,this.g.Ob=n.entry,this.size++),this},r.prototype.delete=function(e){return e=i(this,e),!(!e.entry||!e.list)&&(e.list.splice(e.index,1),e.list.length||delete this.h[e.id],e.entry.Ob.next=e.entry.next,e.entry.next.Ob=e.entry.Ob,e.entry.head=null,this.size--,!0)},r.prototype.clear=function(){this.h={},this.g=this.g.Ob=t(),this.size=0},r.prototype.has=function(e){return!!i(this,e).entry},r.prototype.get=function(e){return(e=i(this,e).entry)&&e.value},r.prototype.entries=function(){return n(this,function(e){return[e.key,e.value]})},r.prototype.keys=function(){return n(this,function(e){return e.key})},r.prototype.values=function(){return n(this,function(e){return e.value})},r.prototype.forEach=function(e,t){for(var n,i=this.entries();!(n=i.next()).done;)n=n.value,e.call(t,n[1],n[0],this)},r.prototype[Symbol.iterator]=r.prototype.entries;var o=0;return r}),l("Set",function(e){function t(e){if(this.g=new Map,e){e=c(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.g.size}return function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(c([t]));if(!n.has(t)||1!=n.size||n.add(t)!=n||1!=n.size||n.add({x:4})!=n||2!=n.size)return!1;var i=n.entries(),r=i.next();return!r.done&&r.value[0]==t&&r.value[1]==t&&(r=i.next(),!r.done&&r.value[0]!=t&&4==r.value[0].x&&r.value[1]==r.value[0]&&i.next().done)}catch(e){return!1}}()?e:(t.prototype.add=function(e){return e=0===e?0:e,this.g.set(e,e),this.size=this.g.size,this},t.prototype.delete=function(e){return e=this.g.delete(e),this.size=this.g.size,e},t.prototype.clear=function(){this.g.clear(),this.size=0},t.prototype.has=function(e){return this.g.has(e)},t.prototype.entries=function(){return this.g.entries()},t.prototype.values=function(){return this.g.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(e,t){var n=this;this.g.forEach(function(i){return e.call(t,i,i,n)})},t)}),l("Array.prototype.keys",function(e){return e||function(){return B(this,function(e){return e})}}),l("Array.prototype.findIndex",function(e){return e||function(e,t){return G(this,e,t).Rg}}),l("Array.from",function(e){return e||function(e,t,n){t=null!=t?t:function(e){return e};var i=[],r="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if("function"==typeof r){e=r.call(e);for(var a=0;!(r=e.next()).done;)i.push(t.call(n,r.value,a++))}else for(r=e.length,a=0;a<r;a++)i.push(t.call(n,e[a],a));return i}}),l("Array.prototype.values",function(e){return e||function(){return B(this,function(e,t){return t})}}),l("Object.is",function(e){return e||function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t}}),l("Array.prototype.includes",function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var i=n.length;for(t=t||0,0>t&&(t=Math.max(t+i,0));t<i;t++){var r=n[t];if(r===e||Object.is(r,e))return!0}return!1}}),l("String.prototype.includes",function(e){return e||function(e,t){return-1!==j(this,e,"includes").indexOf(e,t||0)}}),l("String.fromCodePoint",function(e){return e||function(e){for(var t="",n=0;n<arguments.length;n++){var i=Number(arguments[n]);if(0>i||1114111<i||i!==Math.floor(i))throw new RangeError("invalid_code_point "+i);65535>=i?t+=String.fromCharCode(i):(i-=65536,t+=String.fromCharCode(i>>>10&1023|55296),t+=String.fromCharCode(1023&i|56320))}return t}}),l("Array.prototype.find",function(e){return e||function(e,t){return G(this,e,t).v}}),l("String.prototype.startsWith",function(e){return e||function(e,t){var n=j(this,e,"startsWith"),i=n.length,r=e.length;t=Math.max(0,Math.min(0|t,n.length));for(var a=0;a<r&&t<i;)if(n[t++]!=e[a++])return!1;return a>=r}}),l("WeakSet",function(e){function t(e){if(this.g=new WeakMap,e){e=c(e);for(var t;!(t=e.next()).done;)this.add(t.value)}}return function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),i=new e([t]);return!(!i.has(t)||i.has(n))&&(i.delete(t),i.add(n),!i.has(t)&&i.has(n))}catch(e){return!1}}()?e:(t.prototype.add=function(e){return this.g.set(e,!0),this},t.prototype.has=function(e){return this.g.has(e)},t.prototype.delete=function(e){return this.g.delete(e)},t)});var V="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var i=arguments[n];if(i)for(var r in i)U(i,r)&&(e[r]=i[r])}return e};l("Object.assign",function(e){return e||V}),l("Promise.prototype.finally",function(e){return e||function(e){return this.then(function(t){return Promise.resolve(e()).then(function(){return t})},function(t){return Promise.resolve(e()).then(function(){throw t})})}}),l("Array.prototype.entries",function(e){return e||function(){return B(this,function(e,t){return[e,t]})}}),l("Number.isNaN",function(e){return e||function(e){return"number"===typeof e&&isNaN(e)}}),l("String.prototype.repeat",function(e){return e||function(e){var t=j(this,null,"repeat");if(0>e||1342177279<e)throw new RangeError("Invalid count value");e|=0;for(var n="";e;)1&e&&(n+=t),(e>>>=1)&&(t+=t);return n}}),l("Number.isFinite",function(e){return e||function(e){return"number"===typeof e&&(!isNaN(e)&&1/0!==e&&-1/0!==e)}}),l("Object.values",function(e){return e||function(e){var t,n=[];for(t in e)U(e,t)&&n.push(e[t]);return n}}),l("Math.log2",function(e){return e||function(e){return Math.log(e)/Math.LN2}}),l("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991}),l("Math.trunc",function(e){return e||function(e){if(e=Number(e),isNaN(e)||1/0===e||-1/0===e||0===e)return e;var t=Math.floor(Math.abs(e));return 0>e?-t:t}}),l("Object.entries",function(e){return e||function(e){var t,n=[];for(t in e)U(e,t)&&n.push([t,e[t]]);return n}});var H=this||self;function K(e,t){e=e.split(".");var n,i=H;e[0]in i||"undefined"==typeof i.execScript||i.execScript("var "+e[0]);for(;e.length&&(n=e.shift());)e.length||void 0===t?i=i[n]&&i[n]!==Object.prototype[n]?i[n]:i[n]={}:i[n]=t}
/*
 @license
 Shaka Player
 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
function z(){}function Z(){}function q(e){this.g=Math.exp(Math.log(.5)/e),this.i=this.h=0}function Y(e){return e.h/(1-Math.pow(e.g,e.i))}function W(){this.h=new q(2),this.j=new q(5),this.g=0,this.i=128e3,this.l=16e3}function $(){}function X(){}function Q(){}function J(e){var t=F.apply(1,arguments);ie.has(e)||(ie.add(e),Q.apply($,d(t)))}function ee(){}function te(){}function ne(){}q.prototype.sample=function(e,t){var n=Math.pow(this.g,e);t=t*(1-n)+n*this.h,isNaN(t)||(this.h=t,this.i+=e)},W.prototype.configure=function(e){this.i=e.minTotalBytes,this.l=e.minBytes,this.h.g=Math.exp(Math.log(.5)/e.fastHalfLife),this.j.g=Math.exp(Math.log(.5)/e.slowHalfLife)},W.prototype.sample=function(e,t){if(!(t<this.l)){var n=8e3*t/e;e/=1e3,this.g+=t,this.h.sample(e,n),this.j.sample(e,n)}},W.prototype.getBandwidthEstimate=function(e){return this.g<this.i?e:Math.min(Y(this.h),Y(this.j))};var ie=new Set;function re(){this.g={}}function ae(){this.g=new re}function oe(e,t,n,i){this.target=e,this.type=t,this.listener=n,this.g=se(e,i),this.target.addEventListener(t,n,this.g)}function se(e,t){if(void 0==t)return!1;if("boolean"==typeof t)return t;var n=new Set(["passive","capture"]);return Object.keys(t).filter(function(e){return!n.has(e)}),le(e)?t:t.capture||!1}function le(e){var t=ue;if(void 0==t){t=!1;try{var n={},i={get:function(){return t=!0,!1}};Object.defineProperty(n,"passive",i),Object.defineProperty(n,"capture",i),i=function(){},e.addEventListener("test",i,n),e.removeEventListener("test",i,n)}catch(e){t=!1}ue=t}return t||!1}e.console&&(Q=function(){return console.warn.apply(console,d(F.apply(0,arguments)))},X=function(){console.error.apply(console,d(F.apply(0,arguments)))}),i=re.prototype,i.push=function(e,t){this.g.hasOwnProperty(e)?this.g[e].push(t):this.g[e]=[t]},i.get=function(e){return(e=this.g[e])?e.slice():null},i.remove=function(e,t){e in this.g&&(this.g[e]=this.g[e].filter(function(e){return e!=t}),0==this.g[e].length&&delete this.g[e])},i.forEach=function(e){for(var t in this.g)e(t,this.g[t])},i.size=function(){return Object.keys(this.g).length},i.keys=function(){return Object.keys(this.g)},i=ae.prototype,i.release=function(){this.Ra(),this.g=null},i.D=function(e,t,n,i){this.g&&(e=new oe(e,t,n,i),this.g.push(t,e))},i.ha=function(e,t,n,i){function r(i){a.lb(e,t,r),n(i)}var a=this;this.D(e,t,r,i)},i.lb=function(e,t,n){if(this.g){var i=this.g.get(t)||[];i=c(i);for(var r=i.next();!r.done;r=i.next())r=r.value,r.target!=e||n!=r.listener&&n||(r.lb(),this.g.remove(t,r))}},i.Ra=function(){if(this.g){var e,t=this.g,n=[];for(e in t.g)n.push.apply(n,d(t.g[e]));for(t=c(n),n=t.next();!n.done;n=t.next())n.value.lb();this.g.g={}}},K("shaka.util.EventManager",ae),ae.prototype.removeAll=ae.prototype.Ra,ae.prototype.unlisten=ae.prototype.lb,ae.prototype.listenOnce=ae.prototype.ha,ae.prototype.listen=ae.prototype.D,ae.prototype.release=ae.prototype.release,oe.prototype.lb=function(){this.target.removeEventListener(this.type,this.listener,this.g),this.listener=this.target=null,this.g=!1};var ue=void 0;function ce(t){if(fe.has(t))return fe.get(t);if(e.ManagedMediaSource){var n=ManagedMediaSource.isTypeSupported(t);return fe.set(t,n),n}return!!e.MediaSource&&(n=MediaSource.isTypeSupported(t),fe.set(t,n),n)}function de(){return!!e.SourceBuffer&&!!SourceBuffer.prototype&&!!SourceBuffer.prototype.changeType}var fe=new Map;function he(e,t){this.g=e,this.h=t}function pe(e,t){var n=new he(5,0),i=ve,r=i.g,a=n.h-r.h;(0<(n.g-r.g||a)?i.i:i.h)(i.g,n,e,t)}function ge(e,t,n,i){Q([n,"has been deprecated and will be removed in",t,". We are currently at version",e,". Additional information:",i].join(" "))}function me(e,t,n,i){X([n,"has been deprecated and has been removed in",t,". We are now at version",e,". Additional information:",i].join(" "))}he.prototype.toString=function(){return"v"+this.g+"."+this.h};var ve=null;function ye(){}function _e(){}function be(){}function Ee(e,t){if(!e&&!t)return!0;if(!e||!t||e.byteLength!=t.byteLength)return!1;if(Te(e)==Te(t)&&(e.byteOffset||0)==(t.byteOffset||0))return!0;var n=we(e);t=we(t);for(var i=0;i<e.byteLength;i++)if(n[i]!=t[i])return!1;return!0}function Te(e){return e instanceof ArrayBuffer?e:e.buffer}function Se(e){return e instanceof ArrayBuffer?e:0==e.byteOffset&&e.byteLength==e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer}function we(e,t,n){return n=void 0===n?1/0:n,xe(e,void 0===t?0:t,n,Uint8Array)}function Ae(e,t,n){return n=void 0===n?1/0:n,xe(e,void 0===t?0:t,n,Uint16Array)}function Ie(e,t,n){return n=void 0===n?1/0:n,xe(e,void 0===t?0:t,n,DataView)}function xe(e,t,n,i){var r=Te(e),a=1;"BYTES_PER_ELEMENT"in i&&(a=i.BYTES_PER_ELEMENT);var o=((e.byteOffset||0)+e.byteLength)/a;return e=Math.floor(Math.max(0,Math.min(((e.byteOffset||0)+t)/a,o))),new i(r,e,Math.floor(Math.min(e+Math.max(n,0),o))-e)}function Re(){}function Ce(e){this.l=new _e,(e=De[e.toLowerCase()])&&(this.l=e()),this.h=new ye,(e=ke)&&(this.h=e())}ye.prototype.extract=function(){},ye.prototype.decode=function(){return[]},ye.prototype.clear=function(){},ye.prototype.getStreams=function(){return[]},_e.prototype.init=function(){},_e.prototype.parse=function(){return[]},K("shaka.util.BufferUtils",be),be.toDataView=Ie,be.toUint16=Ae,be.toUint8=we,be.toArrayBuffer=Se,be.equal=Ee,Re.prototype.init=function(){},Re.prototype.i=function(){},Re.prototype.g=function(){},Re.prototype.j=function(){},K("shaka.media.IClosedCaptionParser",Re),Ce.prototype.init=function(e,t){void 0!==t&&t||(this.g(),this.l.init(e))},Ce.prototype.i=function(e){e=this.l.parse(e),e=c(e);for(var t=e.next();!t.done;t=e.next()){t=t.value;var n=we(t.packet);0<n.length&&this.h.extract(n,t.pts)}return this.h.decode()},Ce.prototype.g=function(){this.h.clear()},Ce.prototype.j=function(){return this.h.getStreams()},K("shaka.media.ClosedCaptionParser",Ce),Ce.findDecoder=function(){return ke},Ce.unregisterDecoder=function(){ke=null},Ce.registerDecoder=function(e){ke=e},Ce.findParser=function(e){return De[e]},Ce.unregisterParser=function(e){delete De[e]},Ce.registerParser=function(e,t){De[e]=t};var De={},ke=null;function Me(){this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=Le,this.scroll=Pe}K("shaka.text.CueRegion",Me);var Le=1;Me.units={PX:0,PERCENTAGE:Le,LINES:2};var Pe="";function Ne(e,t){return!("number"!==typeof e||"number"!==typeof t||!isNaN(e)||!isNaN(t))||e===t}function Oe(e,t){t=e.indexOf(t),-1<t&&e.splice(t,1)}function Fe(e,t,n){if(n||(n=Ne),e.length!=t.length)return!1;t=t.slice();var i={};e=c(e);for(var r=e.next();!r.done;i={Qe:i.Qe},r=e.next()){if(i.Qe=r.value,r=t.findIndex(function(e){return function(t){return n(e.Qe,t)}}(i)),-1==r)return!1;t[r]=t[t.length-1],t.pop()}return 0==t.length}function Ue(e,t,n){if(n||(n=Ne),e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(!n(e[i],t[i]))return!1;return!0}function Be(e,t,n){this.startTime=e,this.endTime=t,this.payload=n,this.region=new Me,this.position=null,this.positionAlign=Ve,this.size=0,this.textAlign=He,this.direction=qe,this.writingMode=Ye,this.lineInterpretation=We,this.line=null,this.lineHeight="",this.lineAlign=$e,this.displayAlign=ze,this.fontSize=this.border=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=et,this.fontStyle=tt,this.linePadding=this.letterSpacing=this.fontFamily="",this.opacity=1,this.textCombineUpright="",this.textDecoration=[],this.textStrokeWidth=this.textStrokeColor=this.textShadow="",this.wrapLine=!0,this.id="",this.nestedCues=[],this.lineBreak=this.isContainer=!1,this.rubyTag=null,this.cellResolution={kc:32,rows:15}}function Ge(e,t){return e=new Be(e,t,""),e.lineBreak=!0,e}function je(e,t){if(e.startTime!=t.startTime||e.endTime!=t.endTime||e.payload!=t.payload)return!1;for(var n in e)if("startTime"!=n&&"endTime"!=n&&"payload"!=n)if("nestedCues"==n){if(!Ue(e.nestedCues,t.nestedCues,je))return!1}else if("region"==n||"cellResolution"==n){for(var i in e[n])if(e[n][i]!=t[n][i])return!1}else if(Array.isArray(e[n])){if(!Ue(e[n],t[n]))return!1}else if(e[n]!=t[n])return!1;return!0}Me.scrollMode={NONE:Pe,UP:"up"},Be.prototype.clone=function(){var e,t=new Be(0,0,"");for(e in this)t[e]=this[e],t[e]&&t[e].constructor==Array&&(t[e]=t[e].slice());return t},K("shaka.text.Cue",Be),Be.equal=je,Be.prototype.clone=Be.prototype.clone;var Ve="auto";Be.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:Ve};var He="center",Ke={LEFT:"left",RIGHT:"right",CENTER:He,START:"start",END:"end"};Be.textAlign=Ke;var ze="after",Ze={BEFORE:"before",CENTER:"center",AFTER:ze};Be.displayAlign=Ze;var qe="ltr";Be.direction={HORIZONTAL_LEFT_TO_RIGHT:qe,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var Ye="horizontal-tb";Be.writingMode={HORIZONTAL_TOP_TO_BOTTOM:Ye,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var We=0;Be.lineInterpretation={LINE_NUMBER:We,PERCENTAGE:1};var $e="start",Xe={CENTER:"center",START:$e,END:"end"};Be.lineAlign=Xe;var Qe={white:"white",lime:"lime",cyan:"cyan",red:"red",yellow:"yellow",magenta:"magenta",blue:"blue",black:"black"};Be.defaultTextColor=Qe;var Je={bg_white:"white",bg_lime:"lime",bg_cyan:"cyan",bg_red:"red",bg_yellow:"yellow",bg_magenta:"magenta",bg_blue:"blue",bg_black:"black"};Be.defaultTextBackgroundColor=Je;var et=400;Be.fontWeight={NORMAL:et,BOLD:700};var tt="normal",nt={NORMAL:tt,ITALIC:"italic",OBLIQUE:"oblique"};function it(){}function rt(e,t,n){ot[e.toLowerCase().split(";")[0]+"-"+n]={priority:n,De:t}}function at(e,t){for(var n=e.toLowerCase().split(";")[0],i=c([ct,ut,lt,st]),r=i.next();!r.done;r=i.next())if(r=ot[n+"-"+r.value]){var a=r.De(),o=a.isSupported(e,t);if(a.destroy(),o)return r.De}return null}Be.fontStyle=nt,Be.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"},it.prototype.destroy=function(){},K("shaka.transmuxer.TransmuxerEngine",it),it.findTransmuxer=at,it.unregisterTransmuxer=function(e,t){delete ot[e.toLowerCase().split(";")[0]+"-"+t]},it.registerTransmuxer=rt,it.prototype.destroy=it.prototype.destroy;var ot={},st=1,lt=2,ut=3,ct=4;it.PluginPriority={FALLBACK:st,PREFERRED_SECONDARY:lt,PREFERRED:ut,APPLICATION:ct};
/*
 @license
 Copyright 2008 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/
var dt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");
/*
 @license
 Copyright 2006 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/function ft(e){var t;e instanceof ft?(ht(this,e.Db),this.yc=e.yc,pt(this,e.Gb),gt(this,e.Pc),this.Pa=e.Pa,mt(this,e.g.clone()),this.lc=e.lc):e&&(t=String(e).match(dt))?(ht(this,t[1]||"",!0),this.yc=vt(t[2]||""),pt(this,t[3]||"",!0),gt(this,t[4]),this.Pa=vt(t[5]||"",!0),mt(this,t[6]||"",!0),this.lc=vt(t[7]||"")):this.g=new At(null)}function ht(e,t,n){e.Db=n?vt(t,!0):t,e.Db&&(e.Db=e.Db.replace(/:$/,""))}function pt(e,t,n){e.Gb=n?vt(t,!0):t}function gt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.Pc=t}else e.Pc=null}function mt(e,t,n){t instanceof At?e.g=t:(n||(t=yt(t,St)),e.g=new At(t))}function vt(e,t){return e?t?decodeURI(e):decodeURIComponent(e):""}function yt(e,t,n){return null!=e?(e=encodeURI(e).replace(t,_t),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function _t(e){return e=e.charCodeAt(0),"%"+(e>>4&15).toString(16)+(15&e).toString(16)}i=ft.prototype,i.Db="",i.yc="",i.Gb="",i.Pc=null,i.Pa="",i.lc="",i.toString=function(){var e=[],t=this.Db;if(t&&e.push(yt(t,bt,!0),":"),t=this.Gb){e.push("//");var n=this.yc;n&&e.push(yt(n,bt,!0),"@"),e.push(encodeURIComponent(t).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t=this.Pc,null!=t&&e.push(":",String(t))}return(t=this.Pa)&&(this.Gb&&"/"!=t.charAt(0)&&e.push("/"),e.push(yt(t,"/"==t.charAt(0)?Tt:Et,!0))),(t=this.g.toString())&&e.push("?",t),(t=this.lc)&&e.push("#",yt(t,wt)),e.join("")},i.resolve=function(e){var t=this.clone();"data"===t.Db&&(t=new ft);var n=!!e.Db;n?ht(t,e.Db):n=!!e.yc,n?t.yc=e.yc:n=!!e.Gb,n?pt(t,e.Gb):n=null!=e.Pc;var i=e.Pa;if(n)gt(t,e.Pc);else if(n=!!e.Pa){if("/"!=i.charAt(0))if(this.Gb&&!this.Pa)i="/"+i;else{var r=t.Pa.lastIndexOf("/");-1!=r&&(i=t.Pa.substr(0,r+1)+i)}if(".."==i||"."==i)i="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var a=[],o=0;o<i.length;){var s=i[o++];"."==s?r&&o==i.length&&a.push(""):".."==s?((1<a.length||1==a.length&&""!=a[0])&&a.pop(),r&&o==i.length&&a.push("")):(a.push(s),r=!0)}i=a.join("/")}}return n?t.Pa=i:n=""!==e.g.toString(),n?mt(t,e.g.clone()):n=!!e.lc,n&&(t.lc=e.lc),t},i.clone=function(){return new ft(this)};var bt=/[#\/\?@]/g,Et=/[#\?:]/g,Tt=/[#\?]/g,St=/[#\?@]/g,wt=/#/g;function At(e){this.g=e||null}function It(e){if(!e.Ka&&(e.Ka={},e.pd=0,e.g))for(var t=e.g.split("&"),n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var a=t[n].substring(0,i);r=t[n].substring(i+1)}else a=t[n];a=decodeURIComponent(a.replace(/\+/g," ")),r=r||"",e.add(a,decodeURIComponent(r.replace(/\+/g," ")))}}function xt(e){return It(e),e.pd}function Rt(e,t,n){var i=F.apply(3,arguments);if(this.severity=e,this.category=t,this.code=n,this.data=i,this.handled=!1,this.message="Shaka Error "+this.code,Ct)try{throw Error(this.message||"Shaka Error")}catch(e){this.stack=e.stack}}i=At.prototype,i.Ka=null,i.pd=null,i.add=function(e,t){It(this),this.g=null;var n=this.Ka.hasOwnProperty(e)?this.Ka[e]:null;return n||(this.Ka[e]=n=[]),n.push(t),this.pd++,this},i.set=function(e,t){return It(this),this.g=null,this.Ka.hasOwnProperty(e)?this.Ka[e]=[t]:this.add(e,t),this},i.get=function(e){return It(this),this.Ka[e]||[]},i.toString=function(){if(this.g)return this.g;if(!this.Ka)return"";var e,t=[];for(e in this.Ka)for(var n=encodeURIComponent(e),i=this.Ka[e],r=0;r<i.length;r++){var a=n;""!==i[r]&&(a+="="+encodeURIComponent(i[r])),t.push(a)}return this.g=t.join("&")},i.clone=function(){var e=new At;if(e.g=this.g,this.Ka){var t,n={};for(t in this.Ka)n[t]=this.Ka[t].concat();e.Ka=n,e.pd=this.pd}return e},Rt.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},K("shaka.util.Error",Rt);var Ct=!0;function Dt(e){this.h=e,this.g=void 0}function kt(e,t){return!e.length||!t.length||e===t||0<Mt(e,t).length}function Mt(e,t){if(!e.length)return t;if(!t.length)return e;var n=[];e=c(e);for(var i=e.next();!i.done;i=e.next()){i=i.value;for(var r=c(t),a=r.next();!a.done;a=r.next())if(a=a.value,i.keySystem==a.keySystem){r=new Map;for(var o=c((i.initData||[]).concat(a.initData||[])),s=o.next();!s.done;s=o.next())s=s.value,r.set(s.keyId,s);r=Array.from(r.values()),o=i.keyIds&&a.keyIds?new Set([].concat(d(i.keyIds),d(a.keyIds))):i.keyIds||a.keyIds,n.push({keySystem:i.keySystem,licenseServerUri:i.licenseServerUri||a.licenseServerUri,distinctiveIdentifierRequired:i.distinctiveIdentifierRequired||a.distinctiveIdentifierRequired,persistentStateRequired:i.persistentStateRequired||a.persistentStateRequired,videoRobustness:i.videoRobustness||a.videoRobustness,audioRobustness:i.audioRobustness||a.audioRobustness,serverCertificate:i.serverCertificate||a.serverCertificate,serverCertificateUri:i.serverCertificateUri||a.serverCertificateUri,initData:r,keyIds:o});break}}return n}function Lt(e){return!!e&&!!e.match(/^com\.(microsoft|chromecast)\.playready/)}Rt.Severity={RECOVERABLE:1,CRITICAL:2},Rt.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9,ADS:10},Rt.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,ATTEMPTS_EXHAUSTED:1010,SEGMENT_MISSING:1011,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,INVALID_MP4_CEA:2010,TEXT_COULD_NOT_GUESS_MIME_TYPE:2011,CANNOT_ADD_EXTERNAL_TEXT_TO_SRC_EQUALS:2012,TEXT_ONLY_WEBVTT_SRC_EQUALS:2013,MISSING_TEXT_PLUGIN:2014,CHAPTERS_TRACK_FAILED:2015,UNSUPPORTED_EXTERNAL_THUMBNAILS_URI:2017,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,CONTENT_TRANSFORMATION_FAILED:3019,MSS_MISSING_DATA_FOR_TRANSMUXING:3020,MSS_TRANSMUXING_FAILED:3022,TRANSMUXING_NO_VIDEO_DATA:3023,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,RESTRICTIONS_CANNOT_BE_MET:4012,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,NO_VARIANTS:4036,PERIOD_FLATTENING_FAILED:4037,INCONSISTENT_DRM_ACROSS_PERIODS:4038,HLS_VARIABLE_NOT_FOUND:4039,HLS_MSE_ENCRYPTED_MP2T_NOT_SUPPORTED:4040,HLS_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED:4041,NO_WEB_CRYPTO_API:4042,CANNOT_ADD_EXTERNAL_THUMBNAILS_TO_LIVE_STREAM:4045,MSS_INVALID_XML:4046,MSS_LIVE_CONTENT_NOT_SUPPORTED:4047,AES_128_INVALID_IV_LENGTH:4048,AES_128_INVALID_KEY_LENGTH:4049,DASH_CONFLICTING_AES_128:4050,DASH_UNSUPPORTED_AES_128:4051,DASH_INVALID_PATCH:4052,STREAMING_ENGINE_STARTUP_INVALID_STATE:5006,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,SERVER_CERTIFICATE_REQUEST_FAILED:6017,MIN_HDCP_VERSION_NOT_MATCH:6018,ERROR_CHECKING_HDCP_VERSION:6019,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,OBJECT_DESTROYED:7003,CONTENT_NOT_LOADED:7004,SRC_EQUALS_PRELOAD_NOT_SUPPORTED:7005,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013,STORAGE_LIMIT_REACHED:9014,DOWNLOAD_SIZE_CALLBACK_ERROR:9015,MODIFY_OPERATION_NOT_SUPPORTED:9016,INDEXED_DB_INIT_TIMED_OUT:9017,CS_IMA_SDK_MISSING:1e4,CS_AD_MANAGER_NOT_INITIALIZED:10001,SS_IMA_SDK_MISSING:10002,SS_AD_MANAGER_NOT_INITIALIZED:10003,CURRENT_DAI_REQUEST_NOT_FINISHED:10004,MT_AD_MANAGER_NOT_INITIALIZED:10005},Dt.prototype.value=function(){return void 0==this.g&&(this.g=this.h()),this.g};var Pt=new Dt(function(){return Se(new Uint8Array([0]))}),Nt=new Map;function Ot(e){this.h=e,this.g=null}function Ft(e){this.h=e,this.g=null}function Ut(){var t=e.ManagedMediaSource||e.MediaSource;return!(!t||!t.isTypeSupported)}function Bt(e){return""!=on().canPlayType(e)}function Gt(){return!!navigator.userAgent.match(/Edge?\//)}function jt(){return an("Xbox One")}function Vt(){return an("Tizen")}function Ht(){return an("Tizen 3")}function Kt(){return an("Tizen 2")}function zt(){return an("Web0S")}function Zt(){return zt()&&38===Yt()}function qt(){return an("CrKey")}function Yt(){if(!an("Chrome")||navigator.userAgent.match(/Edge\//))return null;var e=navigator.userAgent.match(/Chrome\/(\d+)/);return e?parseInt(e[1],10):null}function Wt(){return!!navigator.vendor&&navigator.vendor.includes("Apple")&&!Vt()&&!an("PC=EOS")&&!an("PC=APL")&&!an("VirginMedia")&&!Jt()&&!Xt()&&!an("AFT")&&!an("WPE")&&!an("DT_STB_BCM")}function $t(){return an("PlayStation 5")}function Xt(){return an("PlayStation 4")}function Qt(){return an("Hisense")||an("VIDAA")}function Jt(){return an("SOPOpenBrowser")}function en(){if(!Wt())return null;var e=navigator.userAgent.match(/Version\/(\d+)/);return e?parseInt(e[1],10):(e=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(e[1],10):null}function tn(){return navigator.userAgentData&&navigator.userAgentData.platform?"windows"==navigator.userAgentData.platform.toLowerCase():!!navigator.platform&&navigator.platform.toLowerCase().includes("windows")}function nn(){return an("Android")}function rn(){return!!(Vt()||zt()||jt()||Xt()||$t()||an("AFT")||an("PC=EOS")||an("PC=APL")||an("VirginMedia")||Jt()||an("WPE")||qt()||Qt()||an("DT_STB_BCM"))}function an(e){return(navigator.userAgent||"").includes(e)}function on(){return cn||(un||(un=new Ft(function(){cn=null})),(cn=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(cn=document.createElement("video")),un.Y(1),cn)}function sn(t){return t?t===e.shakaMediaKeysPolyfill:!!e.shakaMediaKeysPolyfill}function ln(){var t,n,i,r,a,o,s,l,u,c,d,f,h,p;return O(function(g){switch(g.g){case 1:if(t={width:1/0,height:1/0},qt()){if(d=e.cast&&cast.__platform__&&cast.__platform__.canDisplayType,t.width=1280,t.height=720,w(g,15),!(f=d)){g.u(17);break}return T(g,cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160'),18)}if(Vt()){t.width=1920,t.height=1080;try{webapis.systeminfo&&webapis.systeminfo.getMaxVideoResolution?(n=webapis.systeminfo.getMaxVideoResolution(),t.width=n.width,t.height=n.height):webapis.productinfo.is8KPanelSupported&&webapis.productinfo.is8KPanelSupported()?(t.width=7680,t.height=4320):webapis.productinfo.isUdPanelSupported&&webapis.productinfo.isUdPanelSupported()&&(t.width=3840,t.height=2160)}catch(e){Q("Tizen: Error detecting screen size, default screen size 1920x1080.")}g.u(3);break}if(jt()){t.width=1920,t.height=1080;try{i=new Windows.Media.Protection.ProtectionCapabilities,r=Windows.Media.Protection.ProtectionCapabilityResult,a=null;do{a=i.isTypeSupported('video/mp4;codecs="hvc1,mp4a";features="decode-res-x=3840,decode-res-y=2160,decode-bitrate=20000,decode-fps=30,decode-bpc=10,display-res-x=3840,display-res-y=2160,display-bpc=8"',"com.microsoft.playready.recommendation")}while(a===r.maybe);a===r.probably&&(t.width=3840,t.height=2160)}catch(e){Q("Xbox: Error detecting screen size, default screen size 1920x1080.")}g.u(3);break}if(zt()){try{o=JSON.parse(e.PalmSystem.deviceInfo),t.width=Math.max(1920,o.screenWidth),t.height=Math.max(1080,o.screenHeight)}catch(e){Q("WebOS: Error detecting screen size, default screen size 1920x1080."),t.width=1920,t.height=1080}g.u(3);break}if(Qt()){e.Hisense_Get4KSupportState&&e.Hisense_Get4KSupportState()?(t.width=3840,t.height=2160):(t.width=1920,t.height=1080),g.u(3);break}if(!Xt()&&!$t()){g.u(3);break}return s=!1,w(g,9),T(g,e.msdk.device.getDisplayInfo(),11);case 11:l=g.h,s="4K"===l.resolution,I(g,10);break;case 9:return x(g),w(g,12),T(g,e.msdk.device.getDisplayInfoImmediate(),14);case 14:u=g.h,s="4K"===u.resolution,I(g,10);break;case 12:c=x(g),Q("PlayStation: Failed to get the display info:",c);case 10:s?(t.width=3840,t.height=2160):(t.width=1920,t.height=1080),g.u(3);break;case 18:f=g.h;case 17:if(f){t.width=3840,t.height=2160,g.u(19);break}if(!(h=d)){g.u(20);break}return T(g,cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=1920; height=1080'),21);case 21:h=g.h;case 20:h&&(t.width=1920,t.height=1080);case 19:I(g,3);break;case 15:p=x(g),X("Failed to check canDisplayType:",p);case 3:return g.return(t)}})}Ot.prototype.Y=function(t){var n=this;this.stop();var i=!0,r=null;return this.g=function(){e.clearTimeout(r),i=!1},r=e.setTimeout(function(){i&&n.h()},1e3*t),this},Ot.prototype.stop=function(){this.g&&(this.g(),this.g=null)},Ft.prototype.xc=function(){return this.stop(),this.h(),this},Ft.prototype.Y=function(e){var t=this;return this.stop(),this.g=new Ot(function(){t.h()}).Y(e),this},Ft.prototype.Sa=function(e){var t=this;return this.stop(),this.g=new Ot(function(){t.g.Y(e),t.h()}).Y(e),this},Ft.prototype.stop=function(){this.g&&(this.g.stop(),this.g=null)},K("shaka.util.Timer",Ft),Ft.prototype.stop=Ft.prototype.stop,Ft.prototype.tickEvery=Ft.prototype.Sa,Ft.prototype.tickAfter=Ft.prototype.Y,Ft.prototype.tickNow=Ft.prototype.xc;var un=null,cn=null;function dn(){}function fn(t){if(!t)return"";if(t=we(t),239==t[0]&&187==t[1]&&191==t[2]&&(t=t.subarray(3)),e.TextDecoder&&!Xt())return t=(new TextDecoder).decode(t),t.includes("")&&X('Decoded string contains an "unknown character" codepoint.  That probably means the UTF8 encoding was incorrect!'),t;for(var n="",i=0;i<t.length;++i){var r=65533;if(0==(128&t[i])?r=t[i]:t.length>=i+2&&192==(224&t[i])&&128==(192&t[i+1])?(r=(31&t[i])<<6|63&t[i+1],i+=1):t.length>=i+3&&224==(240&t[i])&&128==(192&t[i+1])&&128==(192&t[i+2])?(r=(15&t[i])<<12|(63&t[i+1])<<6|63&t[i+2],i+=2):t.length>=i+4&&240==(241&t[i])&&128==(192&t[i+1])&&128==(192&t[i+2])&&128==(192&t[i+3])&&(r=(7&t[i])<<18|(63&t[i+1])<<12|(63&t[i+2])<<6|63&t[i+3],i+=3),65535>=r)n+=String.fromCharCode(r);else{r-=65536;var a=1023&r;n+=String.fromCharCode(55296+(r>>10)),n+=String.fromCharCode(56320+a)}}return n}function hn(e,t,n){if(!e)return"";if(!n&&0!=e.byteLength%2)throw new Rt(2,2,2004);n=Math.floor(e.byteLength/2);var i=new Uint16Array(n);e=Ie(e);for(var r=0;r<n;r++)i[r]=e.getUint16(2*r,t);return vn(i)}function pn(e){function t(e){return n.byteLength<=e||32<=n[e]&&126>=n[e]}if(!e)return"";var n=we(e);if(239==n[0]&&187==n[1]&&191==n[2])return fn(n);if(254==n[0]&&255==n[1])return hn(n.subarray(2),!1);if(255==n[0]&&254==n[1])return hn(n.subarray(2),!0);if(0==n[0]&&0==n[2])return hn(e,!1);if(0==n[1]&&0==n[3])return hn(e,!0);if(t(0)&&t(1)&&t(2)&&t(3))return fn(e);throw new Rt(2,2,2003)}function gn(t){if(e.TextEncoder&&!Xt()){var n=new TextEncoder;return Se(n.encode(t))}t=encodeURIComponent(t),t=unescape(t),n=new Uint8Array(t.length);for(var i=0;i<t.length;i++)n[i]=t[i].charCodeAt(0);return Se(n)}function mn(e,t){for(var n=new ArrayBuffer(2*e.length),i=new DataView(n),r=0;r<e.length;++r)i.setUint16(2*r,e.charCodeAt(r),t);return n}function vn(e){return _n.value()(e)}function yn(e){var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'","&nbsp;":"","&lrm;":"","&rlm;":""},n=/&(?:amp|lt|gt|quot|apos|nbsp|lrm|rlm|#[xX]?[0-9a-fA-F]+);/g,i=RegExp(n.source);return e&&i.test(e)?e.replace(n,function(e){return"#"==e[1]?(e="x"==e[2]||"X"==e[2]?parseInt(e.substring(3),16):parseInt(e.substring(2),10),0<=e&&1114111>=e?String.fromCodePoint(e):""):t[e]||"'"}):e||""}K("shaka.util.StringUtils",dn),dn.resetFromCharCode=function(){_n.g=void 0},dn.toUTF16=mn,dn.toUTF8=gn,dn.fromBytesAutoDetect=pn,dn.fromUTF16=hn,dn.fromUTF8=fn;var _n=new Dt(function(){function e(e){try{var t=new Uint8Array(e);return 0<String.fromCharCode.apply(null,t).length}catch(e){return!1}}for(var t={Tb:65536};0<t.Tb;t={Tb:t.Tb},t.Tb/=2)if(e(t.Tb))return function(e){return function(t){for(var n="",i=0;i<t.length;i+=e.Tb)n+=String.fromCharCode.apply(null,t.subarray(i,i+e.Tb));return n}}(t);return null});function bn(){}function En(e){return e=vn(we(e)),btoa(e)}function Tn(e,t){return t=void 0==t||t,e=En(e).replace(/\+/g,"-").replace(/\//g,"_"),t?e:e.replace(/[=]*$/,"")}function Sn(t){t=e.atob(t.replace(/-/g,"+").replace(/_/g,"/"));for(var n=new Uint8Array(t.length),i=0;i<t.length;++i)n[i]=t.charCodeAt(i);return n}function wn(t){for(var n=t.length/2,i=new Uint8Array(n),r=0;r<n;r++)i[r]=e.parseInt(t.substr(2*r,2),16);return i}function An(e){var t=we(e);e="",t=c(t);for(var n=t.next();!n.done;n=t.next())n=n.value,n=n.toString(16),1==n.length&&(n="0"+n),e+=n;return e}function In(){for(var e=F.apply(0,arguments),t=0,n=0;n<e.length;++n)t+=e[n].byteLength;t=new Uint8Array(t);for(var i=n=0;i<e.length;++i){var r=e[i];r instanceof Uint8Array?t.set(r,n):t.set(we(r),n),n+=r.byteLength}return t}function xn(e,t){if(0==t.length)return e;if(1==e.length&&1==t.length){var n=new ft(e[0]);return t=new ft(t[0]),[n.resolve(t).toString()]}t=t.map(function(e){return new ft(e)}),n=[],e=c(e);for(var i=e.next();!i.done;i=e.next()){i=new ft(i.value);for(var r=c(t),a=r.next();!a.done;a=r.next())n.push(i.resolve(a.value).toString())}return n}function Rn(e,t,n,i){return e={keySystem:e,encryptionScheme:t,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:n||[],keyIds:new Set},i&&(e.keySystemUris=new Set([i])),e}function Cn(t,n){n=void 0===n?"cenc":n;var i=[],r=[],a=[];t.forEach(function(e,t){var n=t;22!=n.length&&(n=Tn(wn(t),!1));var o=e;22!=o.length&&(o=Tn(wn(e),!1)),e={kty:"oct",kid:n,k:o},i.push(e),r.push(e.kid),a.push(t)}),t=JSON.stringify({keys:i});var o=JSON.stringify({kids:r});return o=[{initData:we(gn(o)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",encryptionScheme:n,licenseServerUri:"data:application/json;base64,"+e.btoa(t),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:o,keyIds:new Set(a)}}function Dn(e,t){if(1==t.length)return t[0];if(e=kn(e,t),null!=e)return e;throw new Rt(2,4,4025,t)}function kn(e,t){for(var n=c(On[e]),i=n.next();!i.done;i=n.next()){i=i.value;for(var r=c(t),a=r.next();!a.done;a=r.next())if(a=a.value,i.test(a.trim()))return a.trim()}return e==Ln?"":null}function Mn(e,t){var n=[];e=c(On[e]);for(var i=e.next();!i.done;i=e.next()){i=i.value;for(var r=c(t),a=r.next();!a.done;a=r.next())a=a.value,i.test(a.trim())&&n.push(a.trim())}return n}K("shaka.util.Uint8ArrayUtils",bn),bn.concat=In,bn.toHex=An,bn.fromHex=wn,bn.fromBase64=Sn,bn.toBase64=Tn,bn.toStandardBase64=En;var Ln="text",Pn={ga:"video",X:"audio",ta:Ln,Ze:"image",nj:"application"},Nn=1/15,On={audio:[/^vorbis$/,/^Opus$/,/^opus$/,/^fLaC$/,/^flac$/,/^mp4a/,/^[ae]c-3$/,/^ac-4/,/^dts[cex]$/,/^iamf/,/^mhm[12]/],video:[/^avc/,/^hev/,/^hvc/,/^vvc/,/^vvi/,/^vp0?[89]/,/^av01/,/^dvh/,/^dva/,/^dav/],text:[/^vtt$/,/^wvtt/,/^stpp/]};function Fn(){}function Un(e,t){var n=e;return t&&!$n.includes(e)&&(n+='; codecs="'+t+'"'),n}function Bn(e,t){return t&&(e+='; codecs="'+t+'"'),e}function Gn(e,t,n){var i=Un(e,t);return t=Bn(e,t),at(t)?(e=at(t))?(e=e(),n=e.convertCodecs(n,t),e.destroy()):n=t:n="video/mp2t"!=e&&"audio"==n?i.replace("video","audio"):i,n}function jn(e,t,n){var i=[t];return Wn.forEach(function(t,r){var a=e[r];"codecs"==r?$n.includes(e.mimeType)||i.push('codecs="'+n+'"'):a&&i.push(t+'="'+a+'"')}),"PQ"==e.hdr&&i.push('eotf="smpte2084"'),i.join(";")}function Vn(e){return e.split(";")[0].split("/")[1]}function Hn(e){var t=Yn(e);switch(e=t[0],t=t[1].toLowerCase(),!0){case"mp4a"===e&&"69"===t:case"mp4a"===e&&"6b"===t:case"mp4a"===e&&"40.34"===t:return"mp3";case"mp4a"===e&&"66"===t:case"mp4a"===e&&"67"===t:case"mp4a"===e&&"68"===t:case"mp4a"===e&&"40.2"===t:case"mp4a"===e&&"40.02"===t:case"mp4a"===e&&"40.5"===t:case"mp4a"===e&&"40.05"===t:case"mp4a"===e&&"40.29"===t:case"mp4a"===e&&"40.42"===t:return"aac";case"mp4a"===e&&"a5"===t:return"ac-3";case"mp4a"===e&&"a6"===t:return"ec-3";case"mp4a"===e&&"b2"===t:return"dtsx";case"mp4a"===e&&"a9"===t:return"dtsc";case"avc1"===e:case"avc3"===e:return"avc";case"hvc1"===e:case"hev1"===e:return"hevc";case"dvh1"===e:case"dvhe"===e:return"dovi-hevc";case"dvav"===e:case"dva1"===e:return"dovi-avc";case"dav1"===e:return"dovi-av1"}return e}function Kn(e){var t=[];e=c(e.split(","));for(var n=e.next();!n.done;n=e.next())n=Yn(n.value),t.push(n[0]);return t.sort().join(",")}function zn(e){return e.split(";")[0]}function Zn(e){return e=e.split(/ *; */),e.shift(),(e=e.find(function(e){return e.startsWith("codecs=")}))?e.split("=")[1].replace(/^"|"$/g,""):""}function qn(e){return"application/x-mpegurl"===e||"application/vnd.apple.mpegurl"===e}function Yn(e){e=e.split(".");var t=e[0];return e.shift(),[t,e.join(".")]}K("shaka.util.MimeUtils",Fn),Fn.getFullTypeWithAllCodecs=Bn,Fn.getFullType=Un;var Wn=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels"),$n=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"];function Xn(e){this.i=null,this.j=e,this.B=!1,this.l=this.s=0,this.m=1/0,this.h=this.g=null,this.C="",this.A=function(){},this.o=new Map}function Qn(e){return!!ri[e]||("application/cea-608"==e||"application/cea-708"==e)&&!!ke}function Jn(e,t,n,i,r){var a,o,s,l,u,d,f;return O(function(h){if(1==h.g)return T(h,Promise.resolve(),2);if(!e.i||!e.j)return h.return();if(null==n||null==i)return e.i.parseInit(we(t)),h.return();for(a=e.B?n:e.s,o={periodStart:e.s,segmentStart:n,segmentEnd:i,vttOffset:a},s=e.i.parseMedia(we(t),o,r),l=c(s),u=l.next();!u.done;u=l.next())d=u.value,e.A(d,r||null,o);f=s.filter(function(t){return t.startTime>=e.l&&t.startTime<e.m}),e.j.append(f),null==e.g&&(e.g=Math.max(n,e.l)),e.h=Math.min(i,e.m),S(h)})}function ei(e,t,n){e.l=t,e.m=n}function ti(e,t,n){if(e.C=t,t=e.o.get(t))for(var i=c(t.keys()),r=i.next();!r.done;r=i.next())(r=t.get(r.value).filter(function(e){return e.endTime<=n}))&&e.j.append(r)}function ni(e,t,n){t.startTime+=n,t.endTime+=n,t=c(t.nestedCues);for(var i=t.next();!i.done;i=t.next())ni(e,i.value,n)}function ii(e,t,n,i,r){var a=n+" "+i,o=new Map;t=c(t);for(var s=t.next();!s.done;s=t.next()){var l=s.value;s=l.stream,l=l.cue,o.has(s)||o.set(s,new Map),o.get(s).has(a)||o.get(s).set(a,[]),ni(e,l,r),l.startTime>=e.l&&l.startTime<e.m&&(o.get(s).get(a).push(l),s==e.C&&e.j.append([l]))}for(r=c(o.keys()),a=r.next();!a.done;a=r.next())for(a=a.value,e.o.has(a)||e.o.set(a,new Map),t=c(o.get(a).keys()),s=t.next();!s.done;s=t.next())s=s.value,l=o.get(a).get(s),e.o.get(a).set(s,l);e.g=null==e.g?Math.max(n,e.l):Math.min(e.g,Math.max(n,e.l)),e.h=Math.max(e.h,Math.min(i,e.m))}Xn.prototype.destroy=function(){return this.j=this.i=null,this.o.clear(),Promise.resolve()},Xn.prototype.remove=function(e,t){var n=this;return O(function(i){if(1==i.g)return T(i,Promise.resolve(),2);!n.j||!n.j.remove(e,t)||null==n.g||t<=n.g||e>=n.h||(e<=n.g&&t>=n.h?n.g=n.h=null:e<=n.g&&t<n.h?n.g=t:e>n.g&&t>=n.h&&(n.h=e)),S(i)})},K("shaka.text.TextEngine",Xn),Xn.prototype.destroy=Xn.prototype.destroy,Xn.findParser=function(e){return ri[e]},Xn.unregisterParser=function(e){delete ri[e]},Xn.registerParser=function(e,t){ri[e]=t};var ri={};function ai(e,t){return e.concat(t)}function oi(){}function si(e){return null!=e}function li(){}function ui(e,t){return e=fi(e),t=fi(t),e.split("-")[0]==t.split("-")[0]}function ci(e,t){return e=fi(e),t=fi(t),e=e.split("-"),t=t.split("-"),e[0]==t[0]&&1==e.length&&2==t.length}function di(e,t){return e=fi(e),t=fi(t),e=e.split("-"),t=t.split("-"),2==e.length&&2==t.length&&e[0]==t[0]}function fi(e){e=c(e.split("-x-"));var t=e.next().value;t=void 0===t?"":t,e=e.next().value,e=void 0===e?"":e;var n=c(t.split("-"));return t=n.next().value,t=void 0===t?"":t,n=n.next().value,n=void 0===n?"":n,e=e?"x-"+e:"",t=t.toLowerCase(),t=vi.get(t)||t,n=n.toUpperCase(),(n?t+"-"+n:t)+(e?"-"+e:"")}function hi(e,t){return e=fi(e),t=fi(t),t==e?4:ci(t,e)?3:di(t,e)?2:ci(e,t)?1:0}function pi(e){var t=e.indexOf("-");return e=0<=t?e.substring(0,t):e,e=e.toLowerCase(),vi.get(e)||e}function gi(e){return e.language?fi(e.language):e.audio&&e.audio.language?fi(e.audio.language):e.video&&e.video.language?fi(e.video.language):"und"}function mi(e,t){e=fi(e);var n=new Set,i=c(t);for(t=i.next();!t.done;t=i.next())n.add(fi(t.value));for(i=c(n),t=i.next();!t.done;t=i.next())if(t=t.value,t==e)return t;for(i=c(n),t=i.next();!t.done;t=i.next())if(t=t.value,ci(t,e))return t;for(i=c(n),t=i.next();!t.done;t=i.next())if(t=t.value,di(t,e))return t;for(n=c(n),t=n.next();!t.done;t=n.next())if(t=t.value,ci(e,t))return t;return null}K("shaka.util.LanguageUtils",li),li.findClosestLocale=mi,li.getLocaleForVariant=gi,li.getLocaleForText=function(e){return fi(e.language||"und")},li.getBase=pi,li.relatedness=hi,li.areSiblings=function(e,t){var n=pi(e),i=pi(t);return e!=n&&t!=i&&n==i},li.normalize=fi,li.isSiblingOf=di,li.isParentOf=ci,li.areLanguageCompatible=ui,li.areLocaleCompatible=function(e,t){return e=fi(e),t=fi(t),e==t};var vi=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);function yi(e){function t(e){switch(typeof e){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return e;default:if(!e||e.buffer instanceof ArrayBuffer)return e;if(n.has(e))return null;var i=e.constructor==Array;if(e.constructor!=Object&&!i)return null;n.add(e);var r,a=i?[]:{};for(r in e)a[r]=t(e[r]);return i&&(a.length=e.length),a}}var n=new WeakSet;return t(e)}function _i(e){var t,n={};for(t in e)n[t]=e[t];return n}function bi(){}function Ei(e,t,n,i){var r=e.variants;if((t.length||n.length)&&(r=Ti(r,t,n)),i.length){for(t=new re,n=c(r),r=n.next();!r.done;r=n.next())r=r.value,t.push(String(r.video.width||0),r);var a=[];t.forEach(function(e,t){e=0;var n=[],r={};t=c(t);for(var o=t.next();!o.done;r={ld:r.ld},o=t.next())r.ld=o.value,o=i.filter(function(e){return function(t){return e.ld.decodingInfos[0][t]}}(r)).length,o>e?(e=o,n=[r.ld]):o==e&&n.push(r.ld);a.push.apply(a,d(n))}),r=a}n=new Set,t=new Set;var o=c(r);for(r=o.next();!r.done;r=o.next())r=r.value,r.audio&&n.add(r.audio),r.video&&t.add(r.video);n=Array.from(n).sort(function(e,t){return e.bandwidth-t.bandwidth});var s=[];for(r=new Map,n=c(n),o=n.next();!o.done;o=n.next()){o=o.value;var l=o.language+(o.channelsCount||0)+(o.audioSamplingRate||0)+o.roles.join(",")+o.label+o.groupId+o.fastSwitching,u=r.get(l)||[];if(u.length){var f=u[u.length-1],h=Hn(f.codecs),p=Hn(o.codecs);h!=p||o.bandwidth&&f.bandwidth&&!(o.bandwidth>f.bandwidth)||(u.push(o),s.push(o.id))}else u.push(o),s.push(o.id);r.set(l,u)}n=Array.from(t).sort(function(e,t){return e.bandwidth&&t.bandwidth?e.bandwidth-t.bandwidth:e.width-t.width}),t=de();var g=[];for(r=new Map,n=c(n),o=n.next();!o.done;o=n.next()){if(o=o.value,l=Math.round(o.frameRate||0)+(o.hdr||"")+o.fastSwitching,u=r.get(l)||[],u.length){if(f=u[u.length-1],!t&&(h=Hn(f.codecs),p=Hn(o.codecs),h!==p))continue;o.width>f.width||o.height>f.height?(u.push(o),g.push(o.id)):o.width==f.width&&o.height==f.height&&(h=Hn(f.codecs),p=Hn(o.codecs),h!=p||o.bandwidth&&f.bandwidth&&!(o.bandwidth>f.bandwidth)||(u.push(o),g.push(o.id)))}else u.push(o),g.push(o.id);r.set(l,u)}e.variants=e.variants.filter(function(e){var t=e.audio;return e=e.video,!(t&&!s.includes(t.id)||e&&!g.includes(e.id))})}function Ti(e,t,n){var i={};t=c(t);for(var r=t.next();!r.done;i={Xe:i.Xe},r=t.next())if(i.Xe=r.value,r=e.filter(function(e){return function(t){return t.video&&t.video.codecs.startsWith(e.Xe)}}(i)),r.length){e=r;break}for(i={},n=c(n),t=n.next();!t.done;i={Pe:i.Pe},t=n.next())if(i.Pe=t.value,t=e.filter(function(e){return function(t){return t.audio&&t.audio.codecs.startsWith(e.Pe)}}(i)),t.length){e=t;break}return e}function Si(e,t,n){e.variants=e.variants.filter(function(e){return wi(e,t,n)})}function wi(e,t,n){function i(e,t,n){return e>=t&&e<=n}var r=e.video;if(r&&r.width&&r.height){var a=r.width,o=r.height;if(o>a&&(o=c([o,a]),a=o.next().value,o=o.next().value),!i(a,t.minWidth,Math.min(t.maxWidth,n.width))||!i(o,t.minHeight,Math.min(t.maxHeight,n.height))||!i(r.width*r.height,t.minPixels,t.maxPixels))return!1}return!(e&&e.video&&e.video.frameRate&&!i(e.video.frameRate,t.minFrameRate,t.maxFrameRate)||e&&e.audio&&e.audio.channelsCount&&!i(e.audio.channelsCount,t.minChannelsCount,t.maxChannelsCount)||!i(e.bandwidth,t.minBandwidth,t.maxBandwidth))}function Ai(e,t,n){var i=!1;e=c(e);for(var r=e.next();!r.done;r=e.next()){r=r.value;var a=r.allowedByApplication;r.allowedByApplication=wi(r,t,n),a!=r.allowedByApplication&&(i=!0)}return i}function Ii(e,t,n){return n=void 0===n?[]:n,O(function(i){return 1==i.g?T(i,xi(e,t,0<t.offlineSessionIds.length,n),2):(Oi(t),T(i,Fi(t),0))})}function xi(e,t,n,i){var r,a;return O(function(o){if(1==o.g)return T(o,Mi(t.variants,n,!1,i),2);r=null,e&&(a=e.g)&&(r=a.keySystem),t.variants=t.variants.filter(function(e){var t=Ri(e,r);if(!t){var n=[];e.audio&&n.push($i(e.audio)),e.video&&n.push($i(e.video))}return t}),S(o)})}function Ri(e,t){var n=jt(),i=an("Firefox")&&nn(),r=e.video,a=r&&r.width||0,o=r&&r.height||0;if(n&&r&&(1920<a||1080<o)&&(r.codecs.includes("avc1.")||r.codecs.includes("avc3.")))return!1;if(r){if(n=Ni(r.codecs),r.codecs.includes(",")){if(a=r.codecs.split(","),n=Dn("video",a),n=Ni(n),a=Dn("audio",a),a=Pi(a,r.mimeType),o=Gn(r.mimeType,a,"audio"),!ce(o))return!1;n=[n,a].join()}if(a=Gn(r.mimeType,n,"video"),!ce(a))return!1;r.codecs=n}if(r=e.audio,i&&r&&r.encrypted&&r.codecs.toLowerCase().includes("opus"))return!1;if(r){if(i=Pi(r.codecs,r.mimeType),n=Gn(r.mimeType,i,"audio"),!ce(n))return!1;r.codecs=i}return e.decodingInfos.some(function(e){return!(!e.supported||t&&(e=e.keySystemAccess)&&e.keySystem!=t)})}function Ci(e){var t=[];for(n in e)t.push(n);t.sort();var n=[];t=c(t);for(var i=t.next();!i.done;i=t.next()){var r=i.value;i=JSON.stringify(r),r=e[r],r instanceof Object?(r=Ci(r),n.push(i+":"+r)):(r=JSON.stringify(r),n.push(i+":"+r))}return"{"+n.join(",")+"}"}function Di(e,t){var n,i,r,a,o,s,l;return O(function(u){if(1==u.g){for(n=function(e,t){if(e){var n=_i(e);return n.supported=e.supported&&t.supported,n.powerEfficient=e.powerEfficient&&t.powerEfficient,n.smooth=e.smooth&&t.smooth,t.keySystemAccess&&!n.keySystemAccess&&(n.keySystemAccess=t.keySystemAccess),n}return t},i=null,r=[],a={},o=c(t),s=o.next();!s.done;a={Wc:a.Wc,Xc:a.Xc},s=o.next())l=s.value,a.Xc=Ci(l),a.Wc=Xi,a.Wc[a.Xc]?i=n(i,a.Wc[a.Xc]):r.push(ki(l).then(function(e){return function(t){var r=null;t=c(t||[]);for(var a=t.next();!a.done;a=t.next())r=n(r,a.value);r&&(e.Wc[e.Xc]=r,i=n(i,r))}}(a)));return T(u,Promise.all(r),2)}i&&e.decodingInfos.push(i),S(u)})}function ki(e){var t=[""];e.video&&(t=Zn(e.video.contentType).split(","));var n=[""];e.audio&&(n=Zn(e.audio.contentType).split(","));var i=[];t=c(t);for(var r=t.next();!r.done;r=t.next()){r=r.value;for(var a={},o=c(n),s=o.next();!s.done;a={fc:a.fc},s=o.next())s=s.value,a.fc=yi(e),e.video&&(a.fc.video.contentType=Un(zn(a.fc.video.contentType),r)),e.audio&&(a.fc.audio.contentType=Un(zn(a.fc.audio.contentType),s)),i.push(new Promise(function(e){return function(t,n){navigator.mediaCapabilities.decodingInfo(e.fc).then(function(e){t(e)}).catch(n)}}(a)))}return Promise.all(i).catch(function(){return JSON.stringify(e),null})}function Mi(e,t,n,i){var r,a,o,s,l,u,d,f,h,p,g,m,v,y,_,b;return O(function(E){switch(E.g){case 1:if(e.some(function(e){return e.decodingInfos.length}))return E.return();r={},a=c(i),o=a.next();case 2:if(o.done){E.u(4);break}r.Se=o.value,s=!1,l=c(e),u=l.next();case 5:if(u.done){E.u(7);break}d=u.value,f=Li(d,t,n).filter(function(e){return function(t){return t=t[0],(t.keySystemConfiguration&&t.keySystemConfiguration.keySystem)===e.Se}}(r)),h=c(f),p=h.next();case 8:if(p.done){E.u(10);break}return g=p.value,T(E,Di(d,g),9);case 9:p=h.next(),E.u(8);break;case 10:d.decodingInfos.length&&(s=!0),u=l.next(),E.u(5);break;case 7:if(s)return E.return();r={Se:r.Se},o=a.next(),E.u(2);break;case 4:m=c(e),u=m.next();case 12:if(u.done){E.u(0);break}v=u.value,y=Li(v,t,n).filter(function(e){return e=e[0],e=e.keySystemConfiguration&&e.keySystemConfiguration.keySystem,!e||!i.includes(e)}),_=c(y),p=_.next();case 15:if(p.done){u=m.next(),E.u(12);break}return b=p.value,T(E,Di(v,b),16);case 16:p=_.next(),E.u(15)}})}function Li(e,t,n){var i=e.audio,r=e.video,a=[],o=[];if(r)for(var s=c(r.fullMimeTypes),l=s.next();!l.done;l=s.next()){l=l.value;var u=Zn(l);if(u.includes(",")&&!i){var d=u.split(","),f=zn(l);u=Dn("video",d),d=Dn("audio",d),d=Pi(d,f),f=Gn(f,d,"audio"),o.push({contentType:f,channels:2,bitrate:e.bandwidth||1,samplerate:1,spatialRendering:!1})}if(u=Ni(u),l={contentType:Gn(zn(l),u,"video"),width:r.width||64,height:r.height||64,bitrate:r.bandwidth||e.bandwidth||1,framerate:r.frameRate||1},r.hdr)switch(r.hdr){case"SDR":l.transferFunction="srgb";break;case"PQ":l.transferFunction="pq";break;case"HLG":l.transferFunction="hlg"}r.colorGamut&&(l.colorGamut=r.colorGamut),a.push(l)}if(i)for(s=c(i.fullMimeTypes),l=s.next();!l.done;l=s.next())u=l.value,l=zn(u),u=Pi(Zn(u),l),l=Gn(l,u,"audio"),o.push({contentType:l,channels:i.channelsCount||2,bitrate:i.bandwidth||e.bandwidth||1,samplerate:i.audioSamplingRate||1,spatialRendering:i.spatialAudio});for(s=[],0==a.length&&a.push(null),0==o.length&&o.push(null),a=c(a),l=a.next();!l.done;l=a.next())for(l=l.value,u=c(o),f=u.next();!f.done;f=u.next())f=f.value,d={type:n?"file":"media-source"},l&&(d.video=l),f&&(d.audio=f),s.push(d);if(o=(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[]),!o.length)return[s];e=[],n=new Map,o=c(o);for(var h=o.next();!h.done;h=o.next())a=h.value,n.get(a.keySystem)||n.set(a.keySystem,[]),n.get(a.keySystem).push(a);for(o=t?"required":"optional",t=t?["persistent-license"]:["temporary"],a=c(n.keys()),l=a.next();!l.done;l=a.next()){for(l=l.value,u=[],f=c(s),d=f.next();!d.done;d=f.next()){d=Object.assign({},d.value);var p=n.get(l),g={keySystem:l,initDataType:"cenc",persistentState:o,distinctiveIdentifier:"optional",sessionTypes:t};for(p=c(p),h=p.next();!h.done;h=p.next()){if(h=h.value,h.initData&&h.initData.length){for(var m=new Set,v=c(h.initData),y=v.next();!y.done;y=v.next())m.add(y.value.initDataType);g.initDataType=h.initData[0].initDataType}h.distinctiveIdentifierRequired&&(g.distinctiveIdentifier="required"),h.persistentStateRequired&&(g.persistentState="required"),h.sessionType&&(g.sessionTypes=[h.sessionType]),i&&(g.audio?(h.encryptionScheme&&(g.audio.encryptionScheme=g.audio.encryptionScheme||h.encryptionScheme),g.audio.robustness=g.audio.robustness||h.audioRobustness):(g.audio={robustness:h.audioRobustness},h.encryptionScheme&&(g.audio.encryptionScheme=h.encryptionScheme)),""==g.audio.robustness&&delete g.audio.robustness),r&&(g.video?(h.encryptionScheme&&(g.video.encryptionScheme=g.video.encryptionScheme||h.encryptionScheme),g.video.robustness=g.video.robustness||h.videoRobustness):(g.video={robustness:h.videoRobustness},h.encryptionScheme&&(g.video.encryptionScheme=h.encryptionScheme)),""==g.video.robustness&&delete g.video.robustness)}d.keySystemConfiguration=g,u.push(d)}e.push(u)}return e}function Pi(e,t){return"flac"==e.toLowerCase()?en()?"fLaC":"flac":"opus"===e.toLowerCase()?en()&&"mp4"==Vn(t)?"Opus":"opus":e}function Ni(e){if(e.includes("avc1")){var t=e.split(".");if(3==t.length)return e=t.shift()+".",e+=parseInt(t.shift(),10).toString(16),e+("000"+parseInt(t.shift(),10).toString(16)).slice(-4)}else if("vp9"==e)return"vp09.00.41.08";return e}function Oi(e){e.textStreams=e.textStreams.filter(function(e){return e=Un(e.mimeType,e.codecs),Qn(e)})}function Fi(e){var t,n,i,r,a,o,s;return O(function(l){switch(l.g){case 1:t=[],n=c(e.imageStreams),i=n.next();case 2:if(i.done){l.u(4);break}if(r=i.value,a=r.mimeType,"application/mp4"==a&&"mjpg"==r.codecs&&(a="image/jpg"),Ji.has(a)){l.u(5);break}if(o=er.get(a),!o){Ji.set(a,!1),l.u(5);break}return T(l,Ui(o),7);case 7:s=l.h,Ji.set(a,s);case 5:Ji.get(a)&&t.push(r),i=n.next(),l.u(2);break;case 4:e.imageStreams=t,S(l)}})}function Ui(e){return new Promise(function(t){var n=new Image;n.src=e,"decode"in n?n.decode().then(function(){t(!0)}).catch(function(){t(!1)}):n.onload=n.onerror=function(){t(2===n.height)}})}function Bi(e){var t=e.audio,n=e.video,i=t?t.mimeType:null,r=n?n.mimeType:null,a=t?t.codecs:null,o=n?n.codecs:null,s=[];o&&s.push(o),a&&s.push(a);var l=[];n&&l.push(n.mimeType),t&&l.push(t.mimeType),l=l[0]||null;var u=[];t&&u.push(t.kind),n&&u.push(n.kind),u=u[0]||null;var d=new Set;if(t)for(var f=c(t.roles),h=f.next();!h.done;h=f.next())d.add(h.value);if(n)for(f=c(n.roles),h=f.next();!h.done;h=f.next())d.add(h.value);return e={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,kind:u,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:l,audioMimeType:i,videoMimeType:r,codecs:s.join(", "),audioCodec:a,videoCodec:o,primary:e.primary,roles:Array.from(d),audioRoles:null,forced:!1,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null,accessibilityPurpose:null,originalLanguage:null},n&&(e.videoId=n.id,e.originalVideoId=n.originalId,e.width=n.width||null,e.height=n.height||null,e.frameRate=n.frameRate||null,e.pixelAspectRatio=n.pixelAspectRatio||null,e.videoBandwidth=n.bandwidth||null,e.hdr=n.hdr||null,e.colorGamut=n.colorGamut||null,e.videoLayout=n.videoLayout||null),t&&(e.audioId=t.id,e.originalAudioId=t.originalId,e.channelsCount=t.channelsCount,e.audioSamplingRate=t.audioSamplingRate,e.audioBandwidth=t.bandwidth||null,e.spatialAudio=t.spatialAudio,e.label=t.label,e.audioRoles=t.roles,e.accessibilityPurpose=t.accessibilityPurpose,e.originalLanguage=t.originalLanguage),e}function Gi(e){return{id:e.id,active:!1,type:Ln,bandwidth:0,language:e.language,label:e.label,kind:e.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:e.mimeType,audioMimeType:null,videoMimeType:null,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:e.primary,roles:e.roles,audioRoles:null,forced:e.forced,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:e.originalId,originalImageId:null,accessibilityPurpose:e.accessibilityPurpose,originalLanguage:e.originalLanguage}}function ji(e){var t=e.width||null,n=e.height||null,i=null;e.segmentIndex&&(i=e.segmentIndex.get(0));var r=e.tilesLayout;return i&&(r=i.tilesLayout||r),r&&null!=t&&(t/=Number(r.split("x")[0])),r&&null!=n&&(n/=Number(r.split("x")[1])),{id:e.id,active:!1,type:"image",bandwidth:e.bandwidth||0,language:"",label:null,kind:null,width:t,height:n,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:e.mimeType,audioMimeType:null,videoMimeType:null,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,forced:!1,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:r||null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:e.originalId,accessibilityPurpose:null,originalLanguage:null}}function Vi(e){return e.__shaka_id||(e.__shaka_id=Qi++),e.__shaka_id}function Hi(e){var t=zi(e);return t.active="disabled"!=e.mode,t.type="text",t.originalTextId=e.id,"captions"==e.kind&&(t.mimeType="unknown"),"subtitles"==e.kind&&(t.mimeType="text/vtt"),e.kind&&(t.roles=[e.kind]),"forced"==e.kind&&(t.forced=!0),t}function Ki(e){var t=zi(e);return t.active=e.enabled,t.type="variant",t.originalAudioId=e.id,"main"==e.kind&&(t.primary=!0),e.kind&&(t.roles=[e.kind],t.audioRoles=[e.kind],t.label=e.label),t}function zi(e){var t=e.language;return{id:Vi(e),active:!1,type:"",bandwidth:0,language:fi(t||"und"),label:e.label,kind:e.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:null,audioMimeType:null,videoMimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],forced:!1,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null,accessibilityPurpose:null,originalLanguage:t}}function Zi(e){return e.allowedByApplication&&e.allowedByKeySystem&&0==e.disabledUntilTime}function qi(e){return e.filter(function(e){return Zi(e)})}function Yi(e,t,n,i){var r=e,a=e.filter(function(e){return e.primary});a.length&&(r=a);var o=r.length?r[0].language:"";if(r=r.filter(function(e){return e.language==o}),t){var s=mi(fi(t),e.map(function(e){return e.language}));s&&(r=e.filter(function(e){return fi(e.language)==s}))}if(r=r.filter(function(e){return e.forced==i}),n){if(e=Wi(r,n),e.length)return e}else if(e=r.filter(function(e){return 0==e.roles.length}),e.length)return e;return e=r.map(function(e){return e.roles}).reduce(ai,[]),e.length?Wi(r,e[0]):r}function Wi(e,t){return e.filter(function(e){return e.roles.includes(t)})}function $i(e){return"audio"==e.type?"type=audio codecs="+e.codecs+" bandwidth="+e.bandwidth+" channelsCount="+e.channelsCount+" audioSamplingRate="+e.audioSamplingRate:"video"==e.type?"type=video codecs="+e.codecs+" bandwidth="+e.bandwidth+" frameRate="+e.frameRate+" width="+e.width+" height="+e.height:"unexpected stream type"}K("shaka.util.StreamUtils",bi),bi.meetsRestrictions=wi;var Xi={},Qi=0,Ji=(new Map).set("image/svg+xml",!0).set("image/png",!0).set("image/jpeg",!0).set("image/jpg",!0),er=(new Map).set("image/webp","data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA").set("image/avif","data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=");function tr(){var e=this;this.A=null,this.s=!1,this.i=new W,this.F=new ae,navigator.connection&&navigator.connection.addEventListener&&this.F.D(navigator.connection,"change",function(){if(e.s&&e.g.useNetworkInformation){e.i=new W,e.g&&e.i.configure(e.g.advanced);var t=e.chooseVariant();t&&navigator.onLine&&e.A(t,e.g.clearBufferSwitch,e.g.safeMarginSwitch)}}),this.o=[],this.B=1,this.G=!1,this.h=this.m=this.g=this.j=null,this.C=new Ft(function(){if(e.g.restrictToElementSize){var t=e.chooseVariant();t&&e.A(t,e.g.clearBufferSwitch,e.g.safeMarginSwitch)}}),this.l=null}function nr(e){if(!e.G){var t=e.i;if(!(t.g>=t.i))return;e.G=!0,e.j-=1e3*(e.g.switchInterval-e.g.minTimeToSwitch)}Date.now()-e.j<1e3*e.g.switchInterval||(t=e.chooseVariant(),e.getBandwidthEstimate(),t&&e.A(t,e.g.clearBufferSwitch,e.g.safeMarginSwitch))}function ir(e,t,n,i,r){if(e.l){var a=e.l.Ng();a&&(n=n.filter(function(e){return!e.bandwidth||!a||e.bandwidth<=a}))}return t&&(n=n.filter(function(e){return wi(e,t,{width:r,height:i})})),n.sort(function(e,t){return e.bandwidth-t.bandwidth})}function rr(e){var t=[];e=c(e);for(var n=e.next();!n.done;n=e.next())(n=n.value.video)&&n.height&&n.width&&t.push({height:n.height,width:n.width});return t.sort(function(e,t){return e.width-t.width})}i=tr.prototype,i.stop=function(){this.A=null,this.s=!1,this.o=[],this.B=1,this.m=this.j=null,this.h&&(this.h.disconnect(),this.h=null),this.C.stop(),this.l=null},i.release=function(){this.F.release(),this.C=null},i.init=function(e){this.A=e},i.chooseVariant=function(t){t=void 0!==t&&t;var n=1/0,i=1/0;if(this.g.restrictToScreenSize&&(i=this.g.ignoreDevicePixelRatio?1:e.devicePixelRatio,n=e.screen.height*i,i*=e.screen.width),this.h&&this.g.restrictToElementSize){var r=this.g.ignoreDevicePixelRatio?1:e.devicePixelRatio;n=Math.min(n,this.m.clientHeight*r),i=Math.min(i,this.m.clientWidth*r)}var a=this.o.filter(function(e){return e&&!(e.audio&&e.audio.fastSwitching||e.video&&e.video.fastSwitching)});if(a.length||(a=this.o),r=a,t&&a.length!=this.o.length&&(r=this.o.filter(function(e){return e&&!!(e.audio&&e.audio.fastSwitching||e.video&&e.video.fastSwitching)})),t=ir(this,this.g.restrictions,r,1/0,1/0),1/0!=n||1/0!=i){for(t=rr(t),t=c(t),a=t.next();!a.done;a=t.next())if(a=a.value,a.height>=n&&a.width>=i){n=a.height,i=a.width;break}t=ir(this,this.g.restrictions,r,n,i)}for(n=this.getBandwidthEstimate(),r.length&&!t.length&&(t=ir(this,null,r,1/0,1/0),t=[t[0]]),i=t[0]||null,r=0;r<t.length;r++){a=t[r];for(var o=isNaN(this.B)?1:Math.abs(this.B),s=o*a.bandwidth/this.g.bandwidthDowngradeTarget,l={bandwidth:1/0},u=r+1;u<t.length;u++)if(a.bandwidth!=t[u].bandwidth){l=t[u];break}o=o*l.bandwidth/this.g.bandwidthUpgradeTarget,n>=s&&n<=o&&(i.bandwidth!=a.bandwidth||i.bandwidth==a.bandwidth&&i.video&&a.video&&(i.video.width<a.video.width||i.video.height<a.video.height))&&(i=a)}return this.j=Date.now(),i},i.enable=function(){this.s=!0},i.disable=function(){this.s=!1},i.segmentDownloaded=function(e,t,n){e<this.g.cacheLoadThreshold||(this.i.sample(e,t),n&&null!=this.j&&this.s&&nr(this))},i.trySuggestStreams=function(){null!=this.j&&this.s&&nr(this)},i.getBandwidthEstimate=function(){var e=this.g.defaultBandwidthEstimate;return navigator.connection&&navigator.connection.downlink&&this.g.useNetworkInformation&&(e=1e6*navigator.connection.downlink),e=this.i.getBandwidthEstimate(e),this.l?this.l.getBandwidthEstimate(e):e},i.setVariants=function(e){this.o=e},i.playbackRateChanged=function(e){this.B=e},i.setMediaElement=function(t){var n=this;this.m=t,this.h&&(this.h.disconnect(),this.h=null),this.m&&"ResizeObserver"in e&&(this.h=new ResizeObserver(function(){n.C.Y(ar)}),this.h.observe(this.m))},i.setCmsdManager=function(e){this.l=e},i.configure=function(e){this.g=e,this.i&&this.g&&this.i.configure(this.g.advanced)},K("shaka.abr.SimpleAbrManager",tr),tr.prototype.configure=tr.prototype.configure,tr.prototype.setCmsdManager=tr.prototype.setCmsdManager,tr.prototype.setMediaElement=tr.prototype.setMediaElement,tr.prototype.playbackRateChanged=tr.prototype.playbackRateChanged,tr.prototype.setVariants=tr.prototype.setVariants,tr.prototype.getBandwidthEstimate=tr.prototype.getBandwidthEstimate,tr.prototype.trySuggestStreams=tr.prototype.trySuggestStreams,tr.prototype.segmentDownloaded=tr.prototype.segmentDownloaded,tr.prototype.disable=tr.prototype.disable,tr.prototype.enable=tr.prototype.enable,tr.prototype.chooseVariant=tr.prototype.chooseVariant,tr.prototype.init=tr.prototype.init,tr.prototype.release=tr.prototype.release,tr.prototype.stop=tr.prototype.stop;var ar=1;function or(e,t,n,i){for(n=void 0===n||n,i=void 0!==i&&i,this.h=e,this.g=new Set([e]),t=t||[],e=c(t),t=e.next();!t.done;t=e.next())this.add(t.value,n,i)}function sr(e,t,n,i){var r;if(!(r=!!e.audio!=!!t.audio||!!e.video!=!!t.video||e.language!=t.language)&&(r=e.audio&&t.audio)){r=e.audio;var a=t.audio;r=!!((!r.channelsCount||!a.channelsCount||2<r.channelsCount||2<a.channelsCount)&&r.channelsCount!=a.channelsCount||r.spatialAudio!==a.spatialAudio||n&&!lr(r,a)||!ur(r.roles,a.roles)||i&&r.groupId!==a.groupId)}return!(i=r)&&(i=e.video&&t.video)&&(e=e.video,t=t.video,i=!((!n||lr(e,t))&&ur(e.roles,t.roles))),!i}function lr(e,t){if(e.mimeType!=t.mimeType)return!1;if(e=e.codecs.split(",").map(function(e){return Kn(e)}),t=t.codecs.split(",").map(function(e){return Kn(e)}),e.length!=t.length)return!1;e.sort(),t.sort();for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function ur(e,t){if(e=new Set(e),t=new Set(t),e.delete("main"),t.delete("main"),e.size!=t.size)return!1;e=c(e);for(var n=e.next();!n.done;n=e.next())if(!t.has(n.value))return!1;return!0}function cr(e,t,n){t=void 0===t?"reload":t,n=void 0!==n&&n,this.i=e,this.h=t,this.g=n,this.j=new dr(e.language,"",e.audio&&e.audio.channelsCount?e.audio.channelsCount:0,"",!1,"","","",t,n)}function dr(e,t,n,i,r,a,o,s,l,u,c){this.A=e,this.B=t,this.i=n,this.j=i,this.C=r,this.m=a,this.h=void 0===o?"":o,this.l=void 0===s?"":s,this.o=void 0===l?"reload":l,this.s=void 0!==u&&u,this.g=void 0===c?"":c}function fr(e,t){t=fi(t);var n=mi(t,e.map(function(e){return gi(e)}));return n?e.filter(function(e){return n==gi(e)}):[]}function hr(e,t){return e.filter(function(e){return!!e.audio&&(t?e.audio.roles.includes(t):0==e.audio.roles.length)})}function pr(e,t){return e.filter(function(e){return!(!e.audio||!e.audio.label)&&e.audio.label.toLowerCase()==t.toLowerCase()})}function gr(e,t){return e.filter(function(e){return!(!e.video||!e.video.label)&&e.video.label.toLowerCase()==t.toLowerCase()})}function mr(e,t){return e.filter(function(e){return!e.audio||!e.audio.channelsCount||e.audio.channelsCount==t})}function vr(t,n){return"AUTO"==n&&(n=e.matchMedia("(color-gamut: p3)").matches?"PQ":"SDR"),t.filter(function(e){return!e.video||!e.video.hdr||e.video.hdr==n})}function yr(e,t){return e.filter(function(e){return!e.video||!e.video.videoLayout||e.video.videoLayout==t})}function _r(e,t){return e.filter(function(e){return!e.audio||e.audio.spatialAudio==t})}function br(e,t){return e.filter(function(e){return!e.audio||e.audio.codecs==t})}function Er(){this.g=wr,this.i=(new Map).set(wr,2).set(Sr,1),this.h=0}function Tr(e,t,n){e.i.set(wr,n).set(Sr,t)}K("shaka.config.AutoShowText",{NEVER:0,ALWAYS:1,IF_PREFERRED_TEXT_LANGUAGE:2,IF_SUBTITLES_MAY_BE_NEEDED:3}),K("shaka.config.CodecSwitchingStrategy",{Qj:"reload",yh:"smooth"}),or.prototype.add=function(e,t,n){return!!sr(this.h,e,void 0===t||t,void 0!==n&&n)&&(this.g.add(e),!0)},or.prototype.values=function(){return this.g.values()},cr.prototype.create=function(e){var t=this,n="smooth"==this.h&&de(),i=e.filter(function(e){return sr(t.i,e,!n,t.g)});return i.length?new or(i[0],i,!n,this.g):this.j.create(e)},dr.prototype.create=function(e){var t=[];t=fr(e,this.A);var n=e.filter(function(e){return e.primary});return t=t.length?t:n.length?n:e,e=hr(t,this.B),e.length&&(t=e),this.m&&(e=yr(t,this.m),e.length&&(t=e)),this.j&&(e=vr(t,this.j),e.length&&(t=e)),this.i&&(e=mr(t,this.i),e.length&&(t=e)),this.h&&(e=pr(t,this.h),e.length&&(t=e)),this.l&&(e=gr(t,this.l),e.length&&(t=e)),e=_r(t,this.C),e.length&&(t=e),this.g&&(e=br(t,this.g),e.length&&(t=e)),new or(t[0],t,!("smooth"==this.o&&de()),this.s)};var Sr=0,wr=1;function Ar(e,t){var n=xr();this.l=null==e.maxAttempts?n.maxAttempts:e.maxAttempts,this.j=null==e.baseDelay?n.baseDelay:e.baseDelay,this.o=null==e.fuzzFactor?n.fuzzFactor:e.fuzzFactor,this.m=null==e.backoffFactor?n.backoffFactor:e.backoffFactor,this.g=0,this.h=this.j,(this.i=void 0!==t&&t)&&(this.g=1)}function Ir(e){var t,n;return O(function(i){if(1==i.g){if(e.g>=e.l){if(!e.i)throw new Rt(2,7,1010);e.g=1,e.h=e.j}return t=e.g,e.g++,0==t?i.return():(n=e.h*(1+(2*Math.random()-1)*e.o),T(i,new Promise(function(e){new Ft(e).Y(n/1e3)}),2))}e.h*=e.m,S(i)})}function xr(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}}function Rr(){var e,t,n=new Promise(function(n,i){e=n,t=i});return n.resolve=e,n.reject=t,n}function Cr(e,t){this.promise=e,this.i=t,this.g=!1}function Dr(e){return new Cr(Promise.reject(e),function(){return Promise.resolve()})}function kr(){var e=Promise.reject(new Rt(2,7,7001));return e.catch(function(){}),new Cr(e,function(){return Promise.resolve()})}function Mr(e){return new Cr(Promise.resolve(e),function(){return Promise.resolve()})}function Lr(e){return new Cr(e,function(){return e.catch(function(){})})}function Pr(e){return new Cr(Promise.all(e.map(function(e){return e.promise})),function(){return Promise.all(e.map(function(e){return e.abort()}))})}function Nr(e,t,n){try{var i=e(t);return i&&i.promise&&i.abort?(n.resolve(i.promise),function(){return i.abort()}):(n.resolve(i),function(){return Promise.resolve(i).then(function(){},function(){})})}catch(e){return n.reject(e),function(){return Promise.resolve()}}}function Or(t,n){if(n)if(n instanceof Map)for(var i=c(n.keys()),r=i.next();!r.done;r=i.next())r=r.value,Object.defineProperty(this,r,{value:n.get(r),writable:!0,enumerable:!0});else for(i in n)Object.defineProperty(this,i,{value:n[i],writable:!0,enumerable:!0});this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=e.performance&&e.performance.now?e.performance.now():Date.now(),this.type=t,this.isTrusted=!1,this.target=this.currentTarget=null,this.g=!1}function Fr(e){var t,n=new Or(e.type);for(t in e)Object.defineProperty(n,t,{value:e[t],writable:!0,enumerable:!0});return n}Rr.prototype.resolve=function(){},Rr.prototype.reject=function(){},Cr.prototype.abort=function(){return this.g=!0,this.i()},Cr.prototype.finally=function(e){return this.promise.then(function(){return e(!0)},function(){return e(!1)}),this},Cr.prototype.Aa=function(e,t){function n(n){return function(s){if(r.g&&n)a.reject(o);else{var l=n?e:t;l?i=Nr(l,s,a):(n?a.resolve:a.reject)(s)}}}function i(){return a.reject(o),r.abort()}var r=this,a=new Rr,o=new Rt(2,7,7001);return this.promise.then(n(!0),n(!1)),new Cr(a,function(){return i()})},K("shaka.util.AbortableOperation",Cr),Cr.prototype.chain=Cr.prototype.Aa,Cr.prototype["finally"]=Cr.prototype.finally,Cr.all=Pr,Cr.prototype.abort=Cr.prototype.abort,Cr.notAbortable=Lr,Cr.completed=Mr,Cr.aborted=kr,Cr.failed=Dr,Or.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},Or.prototype.stopImmediatePropagation=function(){this.g=!0},Or.prototype.stopPropagation=function(){},K("shaka.util.FakeEvent",Or);var Ur={pj:"abrstatuschanged",qj:"adaptation",rj:"audiotrackchanged",sj:"buffering",tj:"complete",uj:"downloadfailed",vj:"downloadheadersreceived",wj:"drmsessionupdate",yj:"emsg",Pj:"prft",Error:"error",zj:"expirationupdated",Aj:"firstquartile",Bj:"gapjumped",Ej:"keystatuschanged",Gj:"loaded",Hj:"loading",Jj:"manifestparsed",Kj:"manifestupdated",Lj:"mediaqualitychanged",Metadata:"metadata",Mj:"midpoint",Nj:"nospatialvideoinfo",Oj:"onstatechange",Rj:"ratechange",Sj:"segmentappended",Tj:"sessiondata",Uj:"spatialvideoinfo",Vj:"stalldetected",Wj:"started",Xj:"statechanged",Yj:"streaming",Zj:"textchanged",$j:"texttrackvisibility",ak:"thirdquartile",bk:"timelineregionadded",ck:"timelineregionenter",dk:"timelineregionexit",ek:"trackschanged",gk:"unloading",ik:"variantchanged"};function Br(){this.ya=new re,this.Ge=this}function Gr(){this.g=[]}function jr(e,t){e.g.push(t.finally(function(){Oe(e.g,t)}))}function Vr(e,t,n,i,r,a){Br.call(this),this.i=!1,this.m=new Gr,this.g=new Set,this.h=new Set,this.l=e||null,this.j=t||null,this.A=n||null,this.B=i||null,this.F=r||null,this.C=a||null,this.o=this.s=!1}function Hr(e,t,n,i){n=n||Jr;var r=ea[e];(!r||n>=r.priority)&&(ea[e]={priority:n,De:t,Ki:void 0!==i&&i})}function Kr(e,t){for(var n=c(e.g),i=n.next();!i.done;i=n.next())t.g.add(i.value);for(e=c(e.h),i=e.next();!i.done;i=e.next())t.h.add(i.value)}function zr(e,t,n){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t,licenseRequestType:null,sessionId:null,drmInfo:null,initData:null,initDataType:null,streamDataCallback:void 0===n?null:n}}function Zr(e,t,n,i){function r(e){a=a.Aa(function(){return n.body&&(n.body=Se(n.body)),e(t,n,i)})}var a=Mr(void 0);e.B&&r(e.B),e=c(e.g);for(var o=e.next();!o.done;o=e.next())r(o.value);return a.Aa(void 0,function(e){if(e instanceof Rt&&7001==e.code)throw e;throw new Rt(2,1,1006,e)})}function qr(e,t,n,i,r,a,o,s){e.s&&(n.uris[a]=n.uris[a].replace("https://","http://")),e.o&&(n.uris[a]=n.uris[a].replace("http://","https://")),0<a&&e.F&&e.F(t,i,n.uris[a],n.uris[a-1]);var l=new ft(n.uris[a]),u=l.Db,c=!1;u||(u=location.protocol,u=u.slice(0,-1),ht(l,u),n.uris[a]=l.toString()),u=u.toLowerCase();var d=(u=ea[u])?u.De:null;if(!d)return Dr(new Rt(2,1,1e3,l));var f,h=u.Ki,p=null,g=null,m=!1,v=!1;return Lr(Ir(r)).Aa(function(){if(e.i)return kr();f=Date.now();var r=0;n.requestStartTime=Date.now();var o=d(n.uris[a],n,t,function(a,o,l){p&&p.stop(),g&&g.Y(u/1e3),e.l&&t==Qr&&(r++,n.packetNumber=r,e.l(a,o,Wr(i),n),c=!0,s.g=l)},function(i){e.j&&e.j(i,n,t),v=!0,n.timeToFirstByte=Date.now()-n.requestStartTime});if(!h)return o;var l=n.retryParameters.connectionTimeout;l&&(p=new Ft(function(){m=!0,o.abort()}),p.Y(l/1e3));var u=n.retryParameters.stallTimeout;return u&&(g=new Ft(function(){m=!0,o.abort()})),o}).Aa(function(i){p&&p.stop(),g&&g.stop(),void 0==i.timeMs&&(i.timeMs=Date.now()-f);var r={response:i,pi:c};return!v&&e.j&&e.j(i.headers,n,t),r},function(l){if(p&&p.stop(),g&&g.stop(),e.A){var u=null,c=0;l instanceof Rt&&(u=l,1001==l.code&&(c=l.data[1])),e.A(n,u,c,m)}if(e.i)return kr();if(m&&(l=new Rt(1,1,1003,n.uris[a],t)),l instanceof Rt){if(7001==l.code)throw l;if(1010==l.code)throw o;if(1==l.severity)return u=(new Map).set("error",l),u=new Or("retry",u),e.dispatchEvent(u),a=(a+1)%n.uris.length,qr(e,t,n,i,r,a,l,s)}throw l})}function Yr(e,t,n,i){var r=Mr(void 0),a={};e=c(e.h);for(var o=e.next();!o.done;a={Ue:a.Ue},o=e.next())a.Ue=o.value,r=r.Aa(function(e){return function(){var r=n.response;return r.data&&(r.data=Se(r.data)),e.Ue(t,r,i)}}(a));return r.Aa(function(){return n},function(e){var t=2;if(e instanceof Rt){if(7001==e.code)throw e;t=e.severity}throw new Rt(t,1,1007,e)})}function Wr(e){if(e){var t=e.segment;if(e=e.stream,t&&e&&e.fastSwitching&&t.Kd)return!1}return!0}function $r(){this.g=0}function Xr(e,t,n){Cr.call(this,e,t),this.h=n}Br.prototype.addEventListener=function(e,t){this.ya&&this.ya.push(e,t)},Br.prototype.removeEventListener=function(e,t){this.ya&&this.ya.remove(e,t)},Br.prototype.dispatchEvent=function(e){if(!this.ya)return!0;var t=this.ya.get(e.type)||[],n=this.ya.get("All");for(n&&(t=t.concat(n)),t=c(t),n=t.next();!n.done;n=t.next()){n=n.value,e.target=this.Ge,e.currentTarget=this.Ge;try{n.handleEvent?n.handleEvent(e):n.call(this,e)}catch(e){}if(e.g)break}return e.defaultPrevented},Br.prototype.release=function(){this.ya=null},Gr.prototype.destroy=function(){for(var e=[],t=c(this.g),n=t.next();!n.done;n=t.next())n=n.value,n.promise.catch(function(){}),e.push(n.abort());return this.g=[],Promise.all(e)},y(Vr,Br),i=Vr.prototype,i.fg=function(e){this.s=e},i.gg=function(e){this.o=e},i.Ni=function(e){this.g.add(e)},i.ij=function(e){this.g.delete(e)},i.Ag=function(){this.g.clear()},i.Oi=function(e){this.h.add(e)},i.jj=function(e){this.h.delete(e)},i.Bg=function(){this.h.clear()},i.destroy=function(){return this.i=!0,this.g.clear(),this.h.clear(),Br.prototype.release.call(this),this.m.destroy()},i.request=function(e,t,n){var i=this,r=new $r;if(this.i){var a=Promise.reject(new Rt(2,7,7001));return a.catch(function(){}),new Xr(a,function(){return Promise.resolve()},r)}t.method=t.method||"GET",t.headers=t.headers||{},t.retryParameters=t.retryParameters?yi(t.retryParameters):xr(),t.uris=yi(t.uris),a=Zr(this,e,t,n);var o=a.Aa(function(){return qr(i,e,t,n,new Ar(t.retryParameters,!1),0,null,r)}),s=o.Aa(function(t){return Yr(i,e,t,n)}),l=Date.now(),u=0;a.promise.then(function(){u=Date.now()-l},function(){});var c=0;o.promise.then(function(){c=Date.now()},function(){});var d=s.Aa(function(r){var a=Date.now()-c,o=r.response;return o.timeMs+=u,o.timeMs+=a,r.pi||!i.l||o.fromCache||"HEAD"==t.method||e!=Qr||i.l(o.timeMs,o.data.byteLength,Wr(n)),i.C&&i.C(e,o,n),o},function(e){throw e&&(e.severity=2),e});return a=new Xr(d.promise,function(){return d.abort()},r),jr(this.m,a),a},K("shaka.net.NetworkingEngine",Vr),Vr.prototype.request=Vr.prototype.request,Vr.prototype.destroy=Vr.prototype.destroy,Vr.makeRequest=zr,Vr.defaultRetryParameters=function(){return xr()},Vr.prototype.clearAllResponseFilters=Vr.prototype.Bg,Vr.prototype.unregisterResponseFilter=Vr.prototype.jj,Vr.prototype.registerResponseFilter=Vr.prototype.Oi,Vr.prototype.clearAllRequestFilters=Vr.prototype.Ag,Vr.prototype.unregisterRequestFilter=Vr.prototype.ij,Vr.prototype.registerRequestFilter=Vr.prototype.Ni,Vr.unregisterScheme=function(e){delete ea[e]},Vr.registerScheme=Hr,Vr.prototype.setForceHTTPS=Vr.prototype.gg,Vr.prototype.setForceHTTP=Vr.prototype.fg,Vr.NumBytesRemainingClass=$r,y(Xr,Cr),Vr.PendingRequest=Xr;var Qr=1;Vr.RequestType={MANIFEST:0,SEGMENT:Qr,LICENSE:2,APP:3,TIMING:4,SERVER_CERTIFICATE:5,KEY:6,ADS:7,CONTENT_STEERING:8},Vr.AdvancedRequestType={INIT_SEGMENT:0,MEDIA_SEGMENT:1,MEDIA_PLAYLIST:2,MASTER_PLAYLIST:3,MPD:4,MSS:5,MPD_PATCH:6};var Jr=3;Vr.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:Jr};var ea={};function ta(e){this.g=!1,this.h=new Rr,this.i=e}function na(e,t){if(e.g){if(t instanceof Rt&&7003==t.code)throw t;throw new Rt(2,7,7003,t)}}function ia(e,t){var n=[];e=c(e);for(var i=e.next();!i.done;i=e.next())n.push(t(i.value));return n}function ra(e,t){e=c(e);for(var n=e.next();!n.done;n=e.next())if(!t(n.value))return!1;return!0}function aa(e){for(var t=new Map,n=c(Object.keys(e)),i=n.next();!i.done;i=n.next())i=i.value,t.set(i,e[i]);return t}function oa(e){var t={};return e.forEach(function(e,n){t[n]=e}),t}function sa(e,t){this.h=Ie(e),this.i=t==ua,this.g=0}function la(){return new Rt(2,3,3e3)}ta.prototype.destroy=function(){var e=this;return this.g?this.h:(this.g=!0,this.i().then(function(){e.h.resolve()},function(){e.h.resolve()}))},i=sa.prototype,i.oa=function(){return this.g<this.h.byteLength},i.ua=function(){return this.g},i.getLength=function(){return this.h.byteLength},i.T=function(){try{var e=this.h.getUint8(this.g);return this.g+=1,e}catch(e){throw la()}},i.ka=function(){try{var e=this.h.getUint16(this.g,this.i);return this.g+=2,e}catch(e){throw la()}},i.P=function(){try{var e=this.h.getUint32(this.g,this.i);return this.g+=4,e}catch(e){throw la()}},i.bh=function(){try{var e=this.h.getInt32(this.g,this.i);return this.g+=4,e}catch(e){throw la()}},i.Qc=function(){try{if(this.i)var e=this.h.getUint32(this.g,!0),t=this.h.getUint32(this.g+4,!0);else t=this.h.getUint32(this.g,!1),e=this.h.getUint32(this.g+4,!1)}catch(e){throw la()}if(2097151<t)throw new Rt(2,3,3001);return this.g+=8,t*Math.pow(2,32)+e},i.rb=function(e){if(this.g+e>this.h.byteLength)throw la();var t=we(this.h,this.g,e);return this.g+=e,t},i.skip=function(e){if(this.g+e>this.h.byteLength)throw la();this.g+=e},i.Vi=function(e){if(this.g<e)throw la();this.g-=e},i.seek=function(e){if(0>e||e>this.h.byteLength)throw la();this.g=e},i.tc=function(){for(var e=this.g;this.oa()&&0!=this.h.getUint8(this.g);)this.g+=1;return e=we(this.h,e,this.g-e),this.g+=1,fn(e)},K("shaka.util.DataViewReader",sa),sa.prototype.readTerminatedString=sa.prototype.tc,sa.prototype.seek=sa.prototype.seek,sa.prototype.rewind=sa.prototype.Vi,sa.prototype.skip=sa.prototype.skip,sa.prototype.readBytes=sa.prototype.rb,sa.prototype.readUint64=sa.prototype.Qc,sa.prototype.readInt32=sa.prototype.bh,sa.prototype.readUint32=sa.prototype.P,sa.prototype.readUint16=sa.prototype.ka,sa.prototype.readUint8=sa.prototype.T,sa.prototype.getLength=sa.prototype.getLength,sa.prototype.getPosition=sa.prototype.ua,sa.prototype.hasMoreData=sa.prototype.oa;var ua=1;function ca(){this.i=[],this.h=[],this.g=!1}function da(e){for(var t=ya(e);e.reader.oa()&&!e.parser.g;)e.parser.Oc(e.start+t,e.reader,e.partialOkay)}function fa(e){for(var t=ya(e),n=e.reader.P(),i=0;i<n&&(e.parser.Oc(e.start+t,e.reader,e.partialOkay),!e.parser.g);i++);}function ha(e){var t=ya(e);for(e.reader.skip(78);e.reader.oa()&&!e.parser.g;)e.parser.Oc(e.start+t,e.reader,e.partialOkay)}function pa(e){var t=ya(e);e.reader.skip(8);var n=e.reader.ka();for(e.reader.skip(6),2==n?e.reader.skip(48):e.reader.skip(12),1==n&&e.reader.skip(16);e.reader.oa()&&!e.parser.g;)e.parser.Oc(e.start+t,e.reader,e.partialOkay)}function ga(e){return function(t){e(t.reader.rb(t.reader.getLength()-t.reader.ua()))}}function ma(e){var t=0;e=c(e);for(var n=e.next();!n.done;n=e.next())t=t<<8|n.value.charCodeAt(0);return t}function va(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}function ya(e){return 8+(e.has64BitSize?8:0)+(null!=e.flags?4:0)}sa.Endianness={BIG_ENDIAN:0,LITTLE_ENDIAN:ua},i=ca.prototype,i.box=function(e,t){return e=ma(e),this.i[e]=_a,this.h[e]=t,this},i.S=function(e,t){return e=ma(e),this.i[e]=ba,this.h[e]=t,this},i.stop=function(){this.g=!0},i.parse=function(e,t,n){for(e=new sa(e,0),this.g=!1;e.oa()&&!this.g;)this.Oc(0,e,t,n)},i.Oc=function(e,t,n,i){var r=t.ua();if(i&&r+8>t.getLength())this.g=!0;else{var a=t.P(),o=t.P(),s=va(o),l=!1;switch(a){case 0:a=t.getLength()-r;break;case 1:if(i&&t.ua()+8>t.getLength())return void(this.g=!0);a=t.Qc(),l=!0}var u=this.h[o];if(u){var c=null,d=null;if(this.i[o]==ba){if(i&&t.ua()+4>t.getLength())return void(this.g=!0);d=t.P(),c=d>>>24,d&=16777215}o=r+a,n&&o>t.getLength()&&(o=t.getLength()),i&&o>t.getLength()?this.g=!0:(i=o-t.ua(),t=0<i?t.rb(i):new Uint8Array(0),t=new sa(t,0),u({name:s,parser:this,partialOkay:n||!1,version:c,flags:d,reader:t,size:a,start:r+e,has64BitSize:l}))}else t.skip(Math.min(r+a-t.ua(),t.getLength()-t.ua()))}},K("shaka.util.Mp4Parser",ca),ca.headerSize=ya,ca.typeToString=va,ca.allData=ga,ca.audioSampleEntry=pa,ca.visualSampleEntry=ha,ca.sampleDescription=fa,ca.children=da,ca.prototype.parseNext=ca.prototype.Oc,ca.prototype.parse=ca.prototype.parse,ca.prototype.stop=ca.prototype.stop,ca.prototype.fullBox=ca.prototype.S,ca.prototype.box=ca.prototype.box;var _a=0,ba=1;function Ea(e){var t=this;this.g=[],this.h=[],this.data=[],(new ca).box("moov",da).box("moof",da).S("pssh",function(e){if(!(1<e.version)){var n=we(e.reader.h,-12,e.size);if(t.data.push(n),t.g.push(An(e.reader.rb(16))),0<e.version){n=e.reader.P();for(var i=0;i<n;i++){var r=An(e.reader.rb(16));t.h.push(r)}}}}).parse(e)}function Ta(e,t,n,i){var r=e.length,a=t.length+16+r;0<i&&(a+=4+16*n.size);var o=new Uint8Array(a),s=Ie(o),l=0;if(s.setUint32(l,a),l+=4,s.setUint32(l,1886614376),l+=4,1>i?s.setUint32(l,0):s.setUint32(l,16777216),l+=4,o.set(t,l),l+=t.length,0<i)for(s.setUint32(l,n.size),l+=4,t=c(n),n=t.next();!n.done;n=t.next())n=wn(n.value),o.set(n,l),l+=n.length;return s.setUint32(l,r),o.set(e,l+4),o}
/*
 @license
 tXml
 Copyright 2015 Tobias Nickel
 SPDX-License-Identifier: MIT
*/
function Sa(e,t){return e=pn(e),wa(e,t)}function wa(e,t){return e=Ia(e),!t&&e.length?e[0]:(e=e.find(function(e){return e.tagName===t}))?e:null}function Aa(e){return Qa.has(e)?Qa.get(e):""}function Ia(e){function t(r,a){a=void 0!==a&&a;for(var o=[];e[i];)if(60==e.charCodeAt(i)){if(47===e.charCodeAt(i+1)){a=i+2,i=e.indexOf(">",i),a=e.substring(a,i);var s=a.indexOf(r);if(-1==s){var l=r.indexOf(".");0<l&&(s=a.indexOf(r.substring(0,l)))}if(-1==s)throw r=e.substring(0,i).split("\n"),Error("Unexpected close tag\nLine: "+(r.length-1)+"\nColumn: "+(r[r.length-1].length+1)+"\nChar: "+e[i]);i+1&&(i+=1);break}if(33===e.charCodeAt(i+1)){if(45==e.charCodeAt(i+2)){for(;-1!==i&&(62!==e.charCodeAt(i)||45!=e.charCodeAt(i-1)||45!=e.charCodeAt(i-2)||-1==i);)i=e.indexOf(">",i+1);-1===i&&(i=e.length)}else if(91===e.charCodeAt(i+2)&&91===e.charCodeAt(i+8)&&"cdata"===e.substr(i+3,5).toLowerCase()){s=e.indexOf("]]>",i),-1==s?(o.push(e.substr(i+9)),i=e.length):(o.push(e.substring(i+9,s)),i=s+3);continue}i++;continue}e:{l=a,i++;var u=n(),c={};for(s=[];62!==e.charCodeAt(i)&&e[i];){var f=e.charCodeAt(i);if(64<f&&91>f||96<f&&123>f){f=n();for(var h=e.charCodeAt(i);h&&39!==h&&34!==h&&!(64<h&&91>h||96<h&&123>h)&&62!==h;)i++,h=e.charCodeAt(i);var p=i+1;if(i=e.indexOf(e[i],p),p=e.slice(p,i),39===h||34===h){if(-1===i){for(l={tagName:u,attributes:c,children:s,parent:null},u=0;u<s.length;u++)"string"!==typeof s[u]&&(s[u].parent=l);s=l;break e}}else p=null,i--;f.startsWith("xmlns:")&&Qa.set(p,f.split(":")[1]),"tt"===u&&"xml:space"===f&&"preserve"===p&&(l=!0),c[f]=p}i++}for(47!==e.charCodeAt(i-1)?(i++,s=t(u,l)):i++,l={tagName:u,attributes:c,children:s,parent:null},u=s.length,c=0;c<u;c++)f=s[c],"string"!==typeof f?f.parent=l:c==u-1&&"\n"==f&&s.pop();s=l}if(o.push(s),"string"===typeof s)break;"?"===s.tagName[0]&&s.children&&(o.push.apply(o,d(s.children)),s.children=[])}else s=i,i=e.indexOf("<",i)-1,-2===i&&(i=e.length),s=e.slice(s,i+1),a?0<s.length&&o.push(s):o.length&&1==s.length&&"\n"==s[0]?o.push(s):0<s.trim().length&&o.push(s),i++;return o}function n(){for(var t=i;-1==="\r\n\t>/= ".indexOf(e[i])&&e[i];)i++;return e.slice(t,i)}var i=0;return t("")}function xa(e){return"string"===typeof e}function Ra(e){var t=[];if(!e.children)return[];e=c(e.children);for(var n=e.next();!n.done;n=e.next())n=n.value,"string"!==typeof n&&t.push(n);return t}function Ca(e,t){var n=[];if(!e.children)return[];e=c(e.children);for(var i=e.next();!i.done;i=e.next())i=i.value,i.tagName===t&&n.push(i);return n}function Da(e){return"string"===typeof e?yn(e):(e=e.children.reduce(function(e,t){return"string"===typeof t?e+t:e},""),""===e?null:yn(e))}function ka(e){return Array.from(e.children).every(function(e){return"string"===typeof e})?((e=Da(e))&&(e=e.trim()),e):null}function Ma(e,t,n){if(n=void 0===n?[]:n,e.tagName===t&&n.push(e),e.children){e=c(e.children);for(var i=e.next();!i.done;i=e.next())Ma(i.value,t,n)}return n}function La(e,t){return e=Ca(e,t),1!=e.length?null:e[0]}function Pa(e,t,n){return e=Fa(e,t,n),1!=e.length?null:e[0]}function Na(e,t,n,i){i=void 0===i?null:i;var r=null;return e=e.attributes[t],null!=e&&(r=n(e)),null==r?i:r}function Oa(e,t,n){return t=Aa(t),e.attributes[t+":"+n]||null}function Fa(e,t,n){t=Aa(t);var i=[];if(e.children){e=c(e.children);for(var r=e.next();!r.done;r=e.next())(r=r.value)&&r.tagName===t+":"+n&&i.push(r)}return i}function Ua(e,t,n){t=c(t);for(var i=t.next();!i.done;i=t.next())if(i=Oa(e,i.value,n))return i;return null}function Ba(e){return e?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),e=Date.parse(e),isNaN(e)?null:e/1e3):null}function Ga(e){return e?(e=RegExp("^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$").exec(e),e?(e=31536e3*Number(e[1]||null)+2592e3*Number(e[2]||null)+86400*Number(e[3]||null)+3600*Number(e[4]||null)+60*Number(e[5]||null)+Number(e[6]||null),isFinite(e)?e:null):null):null}function ja(e){var t=/([0-9]+)-([0-9]+)/.exec(e);return t?(e=Number(t[1]),isFinite(e)?(t=Number(t[2]),isFinite(t)?{start:e,end:t}:null):null):null}function Va(e){return e=Number(e),0===e%1?e:null}function Ha(e){return e=Number(e),0===e%1&&0<e?e:null}function Ka(e){return e=Number(e),0===e%1&&0<=e?e:null}function za(e){return e=Number(e),isNaN(e)?null:e}function Za(e){return!!e&&"true"===e.toLowerCase()}function qa(e){var t,n=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e);return isNaN(n)?null:n}function Ya(e){var t=[];e=yn(e).split(/\/+(?=(?:[^'"]*['"][^'"]*['"])*[^'"]*$)/),e=c(e);for(var n=e.next();!n.done;n=e.next()){n=n.value;var i=n.match(/^([\w]+)/);if(i){var r=n.match(/(@id='(.*?)')/),a=n.match(/\[(\d+)\]/);t.push({name:i[0],id:r?r[0].match(/'(.*?)'/)[0].replace(/'/gm,""):null,position:a?Number(a[1])-1:null,Vb:n.split("/@")[1]||null})}else n.startsWith("@")&&t.length&&(t[t.length-1].Vb=n.slice(1))}return t}function Wa(e,t){var n=Ya(t.attributes.sel||"");if(n.length){var i=n[n.length-1],r=t.attributes.pos||null;n=i.position,null===n?n="prepend"===r?0:e.length:"prepend"===r?--n:"after"===r&&++n,r=t.tagName,(i=i.Vb)?$a(e[n],r,i,ka(t)||""):("remove"!==r&&"replace"!==r||e.splice(n,1),"add"!==r&&"replace"!==r||e.splice.apply(e,[n,0].concat(d(t.children))))}}function $a(e,t,n,i){"remove"===t?delete e.attributes[n]:"add"!==t&&"replace"!==t||(e.attributes[n]=i)}function Xa(e,t,n){t=void 0===t||t,n=void 0===n||n;var i,r=document.createElement(e.tagName);for(i in e.attributes)r.setAttribute(i,e.attributes[i]);if(t&&e.parent&&"?xml"!=e.parent.tagName&&Xa(e.parent,!0,!1).appendChild(r),n)for(e=c(e.children),t=e.next();!t.done;t=e.next())t=t.value,n=void 0,n="string"==typeof t?new Text(t):Xa(t,!1,!0),r.appendChild(n);return r}var Qa=new Map([]);function Ja(e){var t=this;this.C=e,this.H=new Set,this.m=this.s=null,this.fa=this.da=!1,this.I=0,this.g=null,this.B=new ae,this.i=new Map,this.A=new Map,this.l=new Rr,this.h=null,this.o=function(n){2==n.severity&&t.l.reject(n),e.onError(n)},this.Z=new Map,this.ea=new Map,this.L=new Ft(function(){return So(t)}),this.R=!1,this.N=[],this.U=!1,this.K=new Ft(function(){Ro(t)}),this.l.catch(function(){}),this.j=new ta(function(){return eo(t)}),this.aa=!1,this.F=this.G=null}function eo(e){return O(function(t){switch(t.g){case 1:return e.B.release(),e.B=null,e.l.reject(),e.K.stop(),e.K=null,e.L.stop(),e.L=null,T(t,Io(e),2);case 2:if(!e.m){t.u(3);break}return w(t,4),T(t,e.m.setMediaKeys(null),6);case 6:I(t,5);break;case 4:x(t);case 5:e.m=null;case 3:e.g=null,e.H.clear(),e.s=null,e.A=new Map,e.h=null,e.o=function(){},e.C=null,e.aa=!1,e.G=null,S(t)}})}function to(e,t,n){return e.fa=!0,e.A=new Map,e.R=n,ro(e,t)}function no(e,t,n){e.A=new Map,n=c(n);for(var i=n.next();!i.done;i=n.next())e.A.set(i.value,{initData:null,initDataType:null});for(n=c(e.h.persistentSessionsMetadata),i=n.next();!i.done;i=n.next())i=i.value,e.A.set(i.sessionId,{initData:i.initData,initDataType:i.initDataType});return e.R=0<e.A.size,ro(e,t)}function io(e,t,n,i,r,a){var o=new Map;return r={audioCapabilities:r,videoCapabilities:a,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:t},r.drmInfos=[{keySystem:t,licenseServerUri:n,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:i,serverCertificateUri:"",initData:null,keyIds:null}],o.set(t,r),ho(e,o,[])}function ro(e,t){var n,i,r,a,o,s,l,u,d,f,h,p,g,m,v,y,_;return O(function(b){if(1==b.g){if(n=mo(e))for(i=c(t),r=i.next();!r.done;r=i.next())a=r.value,a.video&&(a.video.drmInfos=[n]),a.audio&&(a.audio.drmInfos=[n]);for(o=t.some(function(e){return!!(e.video&&e.video.drmInfos.length||e.audio&&e.audio.drmInfos.length)}),o||(s=aa(e.h.servers),ko(t,s)),l=new Set,u=c(t),r=u.next();!r.done;r=u.next())for(d=r.value,f=xo(d),h=c(f),p=h.next();!p.done;p=h.next())g=p.value,l.add(g);for(m=c(l),p=m.next();!p.done;p=m.next())v=p.value,Lo(v,aa(e.h.servers),aa(e.h.advanced||{}),e.h.keySystemsMapping);return T(b,Mi(t,e.R,e.aa,e.h.preferredKeySystems),2)}return na(e.j),y=o||Object.keys(e.h.servers).length,y?(_=ho(e,void 0,t),b.return(o?_:_.catch(function(){}))):(e.da=!0,b.return(Promise.resolve()))})}function ao(e){var t;return O(function(n){switch(n.g){case 1:if(e.m.mediaKeys)return n.return();if(!e.G){n.u(2);break}return T(n,e.G,3);case 3:return na(e.j),n.return();case 2:return w(n,4),e.G=e.m.setMediaKeys(e.s),T(n,e.G,6);case 6:I(n,5);break;case 4:t=x(n),e.o(new Rt(2,6,6003,t.message));case 5:na(e.j),S(n)}})}function oo(e,t){return O(function(n){if(1==n.g)return T(n,ao(e),2);co(e,t.initDataType,we(t.initData)),S(n)})}function so(e){var t,n,i,r,a;return O(function(o){switch(o.g){case 1:if(!e.s||!e.g)return o.return();if(!e.g.serverCertificateUri||e.g.serverCertificate&&e.g.serverCertificate.length){o.u(2);break}return t=zr([e.g.serverCertificateUri],e.h.retryParameters),w(o,3),n=e.C.Nb.request(5,t),T(o,n.promise,5);case 5:i=o.h,e.g.serverCertificate=we(i.data),I(o,4);break;case 3:throw r=x(o),new Rt(2,6,6017,r);case 4:if(e.j.g)return o.return();case 2:return e.g.serverCertificate&&e.g.serverCertificate.length?(w(o,6),T(o,e.s.setServerCertificate(e.g.serverCertificate),8)):o.return();case 8:I(o,0);break;case 6:throw a=x(o),new Rt(2,6,6004,a.message)}})}function lo(e,t){var n,i,r;return O(function(a){return 1==a.g?T(a,_o(e,t,{initData:null,initDataType:null}),2):3!=a.g?(n=a.h,n?(i=[],(r=e.i.get(n))&&(r.mb=new Rr,i.push(r.mb)),i.push(n.remove()),T(a,Promise.all(i),3)):a.return()):(e.i.delete(n),void S(a))})}function uo(e){var t,n,i,r,a;return O(function(o){if(1==o.g)return e.A.size?(e.A.forEach(function(t,n){_o(e,n,t)}),T(o,e.l,3)):o.u(2);if(2!=o.g){if(t=e.g&&e.g.keyIds||new Set([]),0<t.size&&Do(e))return o.return(e.l);e.l=new Rr,e.l.catch(function(){})}for(n=(e.g?e.g.initData:[])||[],i=c(n),r=i.next();!r.done;r=i.next())a=r.value,co(e,a.initDataType,a.initData);return Co(e)&&e.l.resolve(),o.return(e.l)})}function co(e,t,n){if(n.length){if(e.h.ignoreDuplicateInitData){var i=e.i.values();i=c(i);for(var r=i.next();!r.done;r=i.next())if(Ee(n,r.value.initData))return}0<e.i.size&&Co(e)&&(e.l.resolve(),e.l=new Rr,e.l.catch(function(){})),bo(e,t,n,e.g.sessionType)}}function fo(e){return e=e.i.keys(),e=ia(e,function(e){return e.sessionId}),Array.from(e)}function ho(e,t,n){var i,r,a,o,s,l,u,d,f,h,p,g,m,v,y;return O(function(_){switch(_.g){case 1:if(i=new Map,n.length){r=po(e,n,i),_.u(2);break}return T(_,go(e,t),3);case 3:r=_.h;case 2:if(a=r,!a)throw new Rt(2,6,6001);for(na(e.j),w(_,4),e.H.clear(),o=a.getConfiguration(),s=o.audioCapabilities||[],l=o.videoCapabilities||[],u=c(s),d=u.next();!d.done;d=u.next())f=d.value,e.H.add(f.contentType.toLowerCase());for(h=c(l),d=h.next();!d.done;d=h.next())p=d.value,e.H.add(p.contentType.toLowerCase());if(n.length){var b=a.keySystem,E=i.get(a.keySystem),S=[],A=[],R=[],C=[],D=[],k=new Set,M=new Set;Mo(E,S,A,C,R,D,k,M);var L=e.R?"persistent-license":"temporary";for(b={keySystem:b,encryptionScheme:S[0],licenseServerUri:A[0],distinctiveIdentifierRequired:E[0].distinctiveIdentifierRequired,persistentStateRequired:E[0].persistentStateRequired,sessionType:E[0].sessionType||L,audioRobustness:E[0].audioRobustness||"",videoRobustness:E[0].videoRobustness||"",serverCertificate:C[0],serverCertificateUri:R[0],initData:D,keyIds:k},0<M.size&&(b.keySystemUris=M),E=c(E),M=E.next();!M.done;M=E.next())M=M.value,M.distinctiveIdentifierRequired&&(b.distinctiveIdentifierRequired=M.distinctiveIdentifierRequired),M.persistentStateRequired&&(b.persistentStateRequired=M.persistentStateRequired);E=b}else E=a.keySystem,M=t.get(a.keySystem),b=[],S=[],A=[],R=[],C=[],D=new Set,Mo(M.drmInfos,b,S,R,A,C,D),E={keySystem:E,encryptionScheme:b[0],licenseServerUri:S[0],distinctiveIdentifierRequired:"required"==M.distinctiveIdentifier,persistentStateRequired:"required"==M.persistentState,sessionType:M.sessionTypes[0]||"temporary",audioRobustness:(M.audioCapabilities?M.audioCapabilities[0].robustness:"")||"",videoRobustness:(M.videoCapabilities?M.videoCapabilities[0].robustness:"")||"",serverCertificate:R[0],serverCertificateUri:A[0],initData:C,keyIds:D};if(e.g=E,!e.g.licenseServerUri)throw new Rt(2,6,6012,e.g.keySystem);return T(_,a.createMediaKeys(),6);case 6:if(g=_.h,na(e.j),e.s=g,!(""!=e.h.minHdcpVersion&&"getStatusForPolicy"in e.s)){_.u(7);break}return w(_,8),T(_,e.s.getStatusForPolicy({minHdcpVersion:e.h.minHdcpVersion}),10);case 10:if(m=_.h,"usable"!=m)throw new Rt(2,6,6018);na(e.j),I(_,7,4);break;case 8:if(v=x(_,4),v instanceof Rt)throw v;throw new Rt(2,6,6019,v.message);case 7:return e.da=!0,T(_,so(e),11);case 11:na(e.j),I(_,0);break;case 4:if(y=x(_),na(e.j,y),e.g=null,e.H.clear(),y instanceof Rt)throw y;throw new Rt(2,6,6002,y.message)}})}function po(e,t,n){for(var i=c(t),r=i.next();!r.done;r=i.next()){var a=c(xo(r.value));for(r=a.next();!r.done;r=a.next())r=r.value,n.has(r.keySystem)||n.set(r.keySystem,[]),n.get(r.keySystem).push(r)}if(1==n.size&&n.has(""))throw new Rt(2,6,6e3);for(i={},e=c(e.h.preferredKeySystems),r=e.next();!r.done;i={Te:i.Te},r=e.next())for(i.Te=r.value,a=c(t),r=a.next();!r.done;r=a.next())if(r=r.value.decodingInfos.find(function(e){return function(t){return t.supported&&null!=t.keySystemAccess&&t.keySystemAccess.keySystem==e.Te}}(i)))return r.keySystemAccess;for(e=c([!0,!1]),r=e.next();!r.done;r=e.next())for(i=r.value,a=c(t),r=a.next();!r.done;r=a.next()){var o=c(r.value.decodingInfos);for(r=o.next();!r.done;r=o.next()){var s=r.value;if(s.supported&&s.keySystemAccess){r=n.get(s.keySystemAccess.keySystem);var l=c(r);for(r=l.next();!r.done;r=l.next())if(!!r.value.licenseServerUri==i)return s.keySystemAccess}}}return null}function go(e,t){var n,i,r,a,o,s,l,u,d,f,h,p,g,m,v;return O(function(y){switch(y.g){case 1:if(1==t.size&&t.has(""))throw new Rt(2,6,6e3);for(i=c(t.values()),r=i.next();!r.done;r=i.next())a=r.value,0==a.audioCapabilities.length&&delete a.audioCapabilities,0==a.videoCapabilities.length&&delete a.videoCapabilities;o=c(e.h.preferredKeySystems),s=o.next();case 2:if(s.done){y.u(4);break}if(l=s.value,!t.has(l)){y.u(3);break}return u=t.get(l),w(y,6),T(y,navigator.requestMediaKeySystemAccess(l,[u]),8);case 8:return n=y.h,y.return(n);case 6:x(y);case 7:na(e.j);case 3:s=o.next(),y.u(2);break;case 4:d=c([!0,!1]),f=d.next();case 9:if(f.done){y.u(11);break}h=f.value,p=c(t.keys()),s=p.next();case 12:if(s.done){f=d.next(),y.u(9);break}if(g=s.value,m=t.get(g),v=m.drmInfos.some(function(e){return!!e.licenseServerUri}),v!=h){y.u(13);break}return w(y,15),T(y,navigator.requestMediaKeySystemAccess(g,[m]),17);case 17:return n=y.h,y.return(n);case 15:x(y);case 16:na(e.j);case 13:s=p.next(),y.u(12);break;case 11:return y.return(n)}})}function mo(e){return e=aa(e.h.clearKeys),0==e.size?null:Cn(e)}function vo(e){Co(e)&&e.l.resolve()}function yo(e,t){new Ft(function(){t.loaded=!0,vo(e)}).Y(No)}function _o(e,t,n){var i,r,a,o,s,l,u;return O(function(c){switch(c.g){case 1:try{i=e.s.createSession("persistent-license")}catch(t){return r=new Rt(2,6,6005,t.message),e.o(r),c.return(Promise.reject(r))}return e.B.D(i,"message",function(t){e.m&&e.h.delayLicenseRequestUntilPlayed&&e.m.paused&&!e.U?e.N.push(t):Eo(e,t)}),e.B.D(i,"keystatuseschange",function(t){return To(e,t)}),a={initData:n.initData,initDataType:n.initDataType,loaded:!1,Rf:1/0,mb:null,type:"persistent-license"},e.i.set(i,a),w(c,2),T(c,i.load(t),4);case 4:return o=c.h,na(e.j),o||(e.i.delete(i),s=e.h.persistentSessionOnlinePlayback?1:2,e.o(new Rt(s,6,6013)),a.loaded=!0),yo(e,a),vo(e),c.return(i);case 2:l=x(c),na(e.j,l),e.i.delete(i),u=e.h.persistentSessionOnlinePlayback?1:2,e.o(new Rt(u,6,6005,l.message)),a.loaded=!0,vo(e);case 3:return c.return(Promise.resolve())}})}function bo(e,t,n,i){try{var r=e.s.createSession(i)}catch(t){return void e.o(new Rt(2,6,6005,t.message))}e.B.D(r,"message",function(t){e.m&&e.h.delayLicenseRequestUntilPlayed&&e.m.paused&&!e.U?e.N.push(t):Eo(e,t)}),e.B.D(r,"keystatuseschange",function(t){return To(e,t)}),e.i.set(r,{initData:n,initDataType:t,loaded:!1,Rf:1/0,mb:null,type:i});try{n=e.h.initDataTransform(n,t,e.g)}catch(n){return t=n,n instanceof Rt||(t=new Rt(2,6,6016,n)),void e.o(t)}e.h.logLicenseExchange&&Tn(n),r.generateRequest(t,n).catch(function(t){if(!e.j.g){e.i.delete(r);var n=t.errorCode;if(n&&n.systemCode){var i=n.systemCode;0>i&&(i+=Math.pow(2,32)),i="0x"+i.toString(16)}e.o(new Rt(2,6,6006,t.message,t,i))}})}function Eo(e,t){var n,i,r,a,o,s,l,u,d,f,h,p,g,m;O(function(v){switch(v.g){case 1:if(n=t.target,e.h.logLicenseExchange&&Tn(t.message),i=e.i.get(n),r=e.g.licenseServerUri,a=e.h.advanced[e.g.keySystem],"individualization-request"==t.messageType&&a&&a.individualizationServer&&(r=a.individualizationServer),o=zr([r],e.h.retryParameters),o.body=t.message,o.method="POST",o.licenseRequestType=t.messageType,o.sessionId=n.sessionId,o.drmInfo=e.g,i&&(o.initData=i.initData,o.initDataType=i.initDataType),a&&a.headers)for(s in a.headers)o.headers[s]=a.headers[s];if(Lt(e.g.keySystem)){var y=hn(o.body,!0,!0);if(y.includes("PlayReadyKeyMessage")){y=wa(y,"PlayReadyKeyMessage");var _=Ma(y,"HttpHeader");_=c(_);for(var b=_.next();!b.done;b=_.next()){var E=b.value;b=Ma(E,"name")[0],E=Ma(E,"value")[0],o.headers[Da(b)]=Da(E)}y=Ma(y,"Challenge")[0],o.body=Sn(Da(y))}else o.headers["Content-Type"]="text/xml; charset=utf-8"}return l=Date.now(),w(v,2),d=e.C.Nb.request(2,o),T(v,d.promise,4);case 4:u=v.h,I(v,3);break;case 2:return f=x(v),e.j.g?v.return():(h=new Rt(2,6,6007,f),1==e.i.size?(e.o(h),i&&i.mb&&i.mb.reject(h)):(i&&i.mb&&i.mb.reject(h),e.i.delete(n),Co(e)&&(e.l.resolve(),e.L.Y(.1))),v.return());case 3:return e.j.g?v.return():(e.I+=(Date.now()-l)/1e3,e.h.logLicenseExchange&&Tn(u.data),w(v,5),T(v,n.update(u.data),7));case 7:I(v,6);break;case 5:return p=x(v),g=new Rt(2,6,6008,p.message),e.o(g),i&&i.mb&&i.mb.reject(g),v.return();case 6:if(e.j.g)return v.return();m=new Or("drmsessionupdate"),e.C.onEvent(m),i&&(i.mb&&i.mb.resolve(),yo(e,i)),S(v)}})}function To(e,t){t=t.target;var n=e.i.get(t),i=!1;t.keyStatuses.forEach(function(t,r){if("string"==typeof r){var a=r;r=t,t=a}if(Lt(e.g.keySystem)&&16==r.byteLength&&(Gt()||Xt())){a=Ie(r);var o=a.getUint32(0,!0),s=a.getUint16(4,!0),l=a.getUint16(6,!0);a.setUint32(0,o,!1),a.setUint16(4,s,!1),a.setUint16(6,l,!1)}"status-pending"!=t&&(n.loaded=!0),"expired"==t&&(i=!0),r=An(r).slice(0,32),e.Z.set(r,t)});var r=t.expiration-Date.now();(0>r||i&&1e3>r)&&n&&!n.mb&&(e.i.delete(t),t.close().catch(function(){})),Co(e)&&(e.l.resolve(),e.L.Y(Oo))}function So(e){var t=e.Z,n=e.ea;n.clear(),t.forEach(function(e,t){return n.set(t,e)}),t=Array.from(n.values()),t.length&&t.every(function(e){return"expired"==e})&&e.o(new Rt(2,6,6014)),e.C.Ae(oa(n))}function wo(){var e,t,n,i,r,a,o,s,l,u,d,f,h,p,g,m,v,y,_,b,E,A,R,C,D,k;return O(function(M){if(1==M.g){for(e="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.microsoft.playready.hardware com.microsoft.playready.recommendation com.chromecast.playready com.apple.fps.1_0 com.apple.fps".split(" "),t=["SW_SECURE_CRYPTO","SW_SECURE_DECODE","HW_SECURE_CRYPTO","HW_SECURE_DECODE","HW_SECURE_ALL"],n=["150","2000","3000"],i={"com.widevine.alpha":t,"com.microsoft.playready.recommendation":n},r=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],a=[{contentType:'audio/mp4; codecs="mp4a.40.2"'},{contentType:'audio/webm; codecs="opus"'}],o={videoCapabilities:r,audioCapabilities:a,initDataTypes:["cenc","sinf","skd","keyids"]},s=[null,"cenc","cbcs","cbcs-1-9"],l=new Map,u=function(e,t){var n,i,r,a,o,s,u,c;return O(function(d){switch(d.g){case 1:return w(d,2),T(d,t.createMediaKeys(),4);case 4:I(d,3);break;case 2:return x(d),d.return();case 3:i=!!(n=t.getConfiguration().sessionTypes)&&n.includes("persistent-license"),Ht()&&(i=!1),r=t.getConfiguration().videoCapabilities,a=t.getConfiguration().audioCapabilities,o={persistentState:i,encryptionSchemes:[],videoRobustnessLevels:[],audioRobustnessLevels:[]},l.has(e)&&l.get(e)?o=l.get(e):l.set(e,o),(s=r[0].encryptionScheme)&&!o.encryptionSchemes.includes(s)&&o.encryptionSchemes.push(s),(u=r[0].robustness)&&!o.videoRobustnessLevels.includes(u)&&o.videoRobustnessLevels.push(u),(c=a[0].robustness)&&!o.audioRobustnessLevels.includes(c)&&o.audioRobustnessLevels.push(c),S(d)}})},d=function(e,t,n,i){var r,a,s,l,d,f,h,p,g;return O(function(m){switch(m.g){case 1:for(w(m,2),r=yi(o),a=c(r.videoCapabilities),s=a.next();!s.done;s=a.next())l=s.value,l.encryptionScheme=t,l.robustness=n;for(d=c(r.audioCapabilities),s=d.next();!s.done;s=d.next())f=s.value,f.encryptionScheme=t,f.robustness=i;return h=yi(r),h.persistentState="required",h.sessionTypes=["persistent-license"],p=[h,r],T(m,navigator.requestMediaKeySystemAccess(e,p),4);case 4:return g=m.h,T(m,u(e,g),5);case 5:I(m,0);break;case 2:x(m),S(m)}})},f=function(e,t,n,i){var o,s,l;return O(function(c){switch(c.g){case 1:return w(c,2),o={type:"media-source",video:{contentType:r[0].contentType,width:640,height:480,bitrate:1,framerate:1},audio:{contentType:a[0].contentType,channels:2,bitrate:1,samplerate:1},keySystemConfiguration:{keySystem:e,video:{encryptionScheme:t,robustness:n},audio:{encryptionScheme:t,robustness:i}}},T(c,navigator.mediaCapabilities.decodingInfo(o),4);case 4:return s=c.h,l=s.keySystemAccess,T(c,u(e,l),5);case 5:I(c,0);break;case 2:x(c),S(c)}})},h=c(e),p=h.next();!p.done;p=h.next())g=p.value,l.set(g,null);for(m=[],v=c(s),y=v.next();!y.done;y=v.next())for(_=y.value,b=c(e),p=b.next();!p.done;p=b.next())E=p.value,"org.w3.clearkey"===E&&en()||(m.push(d(E,_,"","")),m.push(f(E,_,"","")));for(A=c(e),p=A.next();!p.done;p=A.next())for(R=p.value,C=c(i[R]||[]),D=C.next();!D.done;D=C.next())k=D.value,m.push(d(R,null,k,"")),m.push(d(R,null,"",k)),m.push(f(R,null,k,"")),m.push(f(R,null,"",k));return T(M,Promise.all(m),2)}return M.return(oa(l))})}function Ao(e){var t;return O(function(n){return 1==n.g?(t=new Promise(function(e,t){new Ft(t).Y(Po)}),w(n,2),T(n,Promise.race([Promise.all([e.close(),e.closed]),t]),4)):2!=n.g?I(n,0):(x(n),void S(n))})}function Io(e){var t;return O(function(n){return t=Array.from(e.i.entries()),e.i.clear(),T(n,Promise.all(t.map(function(t){t=c(t);var n=t.next().value,i=t.next().value;return O(function(t){return 1==t.g?(w(t,2),e.fa||e.A.has(n.sessionId)||"persistent-license"!==i.type||e.h.persistentSessionOnlinePlayback?T(t,Ao(n),5):T(t,n.remove(),5)):2!=t.g?I(t,0):(x(t),void S(t))})})),0)})}function xo(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[])}function Ro(e){e.i.forEach(function(t,n){var i=t.Rf,r=n.expiration;isNaN(r)&&(r=1/0),r!=i&&(e.C.onExpirationUpdated(n.sessionId,r),t.Rf=r)})}function Co(e){return e=e.i.values(),ra(e,function(e){return e.loaded})}function Do(e){for(var t=c(e.g&&e.g.keyIds||new Set([])),n=t.next();!n.done;n=t.next())if("usable"!==e.Z.get(n.value))return!1;return!0}function ko(e,t){var n=[];for(t.forEach(function(e,t){n.push({keySystem:t,licenseServerUri:e,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",initData:[],keyIds:new Set})}),e=c(e),t=e.next();!t.done;t=e.next())t=t.value,t.video&&(t.video.drmInfos=n),t.audio&&(t.audio.drmInfos=n)}function Mo(t,n,i,r,a,o,s,l){var u=[],f={};t=c(t);for(var h=t.next();!h.done;f={na:f.na},h=t.next()){if(f.na=h.value,n.includes(f.na.encryptionScheme)||n.push(f.na.encryptionScheme),"org.w3.clearkey"==f.na.keySystem&&f.na.licenseServerUri.startsWith("data:application/json;base64,")?u.includes(f.na.licenseServerUri)||u.push(f.na.licenseServerUri):i.includes(f.na.licenseServerUri)||i.push(f.na.licenseServerUri),a.includes(f.na.serverCertificateUri)||a.push(f.na.serverCertificateUri),f.na.serverCertificate&&(r.some(function(e){return function(t){return Ee(t,e.na.serverCertificate)}}(f))||r.push(f.na.serverCertificate)),f.na.initData){h={};for(var p=c(f.na.initData),g=p.next();!g.done;h={Ud:h.Ud},g=p.next())h.Ud=g.value,o.some(function(e){return function(t){var n=e.Ud;return!(!t.keyId||t.keyId!=n.keyId)||t.initDataType==n.initDataType&&Ee(t.initData,n.initData)}}(h))||o.push(h.Ud)}if(f.na.keyIds)for(h=c(f.na.keyIds),p=h.next();!p.done;p=h.next())s.add(p.value);if(f.na.keySystemUris&&l)for(h=c(f.na.keySystemUris),p=h.next();!p.done;p=h.next())l.add(p.value)}if(1==u.length)i.push(u[0]);else if(0<u.length){for(n=[],u=c(u),r=u.next();!r.done;r=u.next())r=e.atob(r.value.split("data:application/json;base64,").pop()),r=JSON.parse(r),n.push.apply(n,d(r.keys));u=JSON.stringify({keys:n}),i.push("data:application/json;base64,"+e.btoa(u))}}function Lo(t,n,i,r){var a=t.keySystem;!a||"org.w3.clearkey"==a&&t.licenseServerUri||(n.size&&(n=n.get(a)||"",t.licenseServerUri=n),t.keyIds||(t.keyIds=new Set),(i=i.get(a))&&(t.distinctiveIdentifierRequired||(t.distinctiveIdentifierRequired=i.distinctiveIdentifierRequired),t.persistentStateRequired||(t.persistentStateRequired=i.persistentStateRequired),t.videoRobustness||(t.videoRobustness=i.videoRobustness),t.audioRobustness||(t.audioRobustness=i.audioRobustness),t.serverCertificate||(t.serverCertificate=i.serverCertificate),i.sessionType&&(t.sessionType=i.sessionType),t.serverCertificateUri||(t.serverCertificateUri=i.serverCertificateUri)),r[a]&&(t.keySystem=r[a]),e.cast&&e.cast.__platform__&&"com.microsoft.playready"==a&&(t.keySystem="com.chromecast.playready"))}i=Ja.prototype,i.destroy=function(){return this.j.destroy()},i.configure=function(e){this.h=e,this.K&&this.K.Sa(this.h.updateExpirationTime)},i.Ub=function(e){var t=this;return O(function(n){if(1==n.g)return t.s?(t.m=e,t.B.ha(t.m,"play",function(){for(var e=c(t.N),n=e.next();!n.done;n=e.next())Eo(t,n.value);t.U=!0,t.N=[]}),"webkitCurrentPlaybackTargetIsWireless"in t.m&&t.B.D(t.m,"webkitcurrentplaybacktargetiswirelesschanged",function(){return Io(t)}),t.F=t.g&&t.g.initData.find(function(e){return 0<e.initData.length})||null,t.F||"com.apple.fps"!==t.g.keySystem||t.A.size?T(n,ao(t),2):n.u(2)):(t.B.ha(e,"encrypted",function(){t.o(new Rt(2,6,6010))}),n.return());uo(t).catch(function(){}),t.F||t.A.size||t.h.parseInbandPsshEnabled||t.B.D(t.m,"encrypted",function(e){return oo(t,e)}),S(n)})},i.Df=function(){var e=this,t=this.i.keys();return t=ia(t,function(t){var n=e.i.get(t);return{sessionId:t.sessionId,sessionType:n.type,initData:n.initData,initDataType:n.initDataType}}),Array.from(t)},i.td=function(){var e=1/0,t=this.i.keys();t=c(t);for(var n=t.next();!n.done;n=t.next())n=n.value,isNaN(n.expiration)||(e=Math.min(e,n.expiration));return e},i.ge=function(){return oa(this.ea)};var Po=1,No=5,Oo=.5;
/*
 @license
 Shaka Player
 Copyright 2023 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/function Fo(e,t,n){this.h=e,this.i=t,this.g=n}function Uo(e,t){return O(function(n){if(1==n.g)return T(n,Ii(e.g,t,e.h.drm.preferredKeySystems),2);if(e.h.streaming.dontChooseCodecs||Ei(t,e.h.preferredVideoCodecs,e.h.preferredAudioCodecs,e.h.preferredDecodingAttributes),!t.variants.some(Zi))throw new Rt(2,4,4032);return n.return(Bo(e,t))})}function Bo(e,t){var n=Ai(t.variants,e.h.restrictions,e.i);if(t){var i=e.g?e.g.g:null;if(i&&e.g.s)for(var r=c(t.variants),a=r.next();!a.done;a=r.next())a=a.value,Go(e,i.keySystem,a.video),Go(e,i.keySystem,a.audio);jo(e,t)}return n}function Go(e,t,n){if(n){n=c(n.drmInfos);for(var i=n.next();!i.done;i=n.next())if(i=i.value,i.keySystem==t){i=c(i.initData||[]);for(var r=i.next();!r.done;r=i.next())r=r.value,co(e.g,r.initDataType,r.initData)}}}function jo(e,t){e=e.g?e.g.ge():{};var n=Object.keys(e);n=n.length&&"00"==n[0];var i=!1,r=!1,a=new Set,o=new Set;t=c(t.variants);for(var s=t.next();!s.done;s=t.next()){s=s.value;var l=[];s.audio&&l.push(s.audio),s.video&&l.push(s.video),l=c(l);for(var u=l.next();!u.done;u=l.next())if(u=u.value,u.keyIds.size){u=c(u.keyIds);for(var d=u.next();!d.done;d=u.next()){d=d.value;var f=e[n?"00":d];f?Vo.includes(f)&&o.add(f):a.add(d)}}s.allowedByApplication?s.allowedByKeySystem&&(i=!0):r=!0}if(!i)throw e={hasAppRestrictions:r,missingKeys:Array.from(a),restrictedKeyStatuses:Array.from(o)},new Rt(2,4,4012,e)}var Vo=["output-restricted","internal-error"];function Ho(){}function Ko(e,t){if(t){var n=zo[t.toLowerCase()];if(n)return n}throw new Rt(2,4,4e3,e,t)}K("shaka.media.ManifestParser",Ho),Ho.unregisterParserByMime=function(e){delete zo[e]},Ho.registerParserByMime=function(e,t){zo[e]=t},Ho.registerParserByExtension=function(){pe("ManifestParser.registerParserByExtension","Please use an ManifestParser with registerParserByMime function.")},Ho.AccessibilityPurpose={hk:"visually impaired",Cj:"hard of hearing"};var zo={};function Zo(e,t){function n(){o=!0}function i(e){s.push(e),da(e)}var r,a=e=we(e),o=!1,s=[],l=[];if((new ca).box("moov",i).box("trak",i).box("mdia",i).box("minf",i).box("stbl",i).S("stsd",function(e){r=e,s.push(e),fa(e)}).S("encv",n).S("enca",n).S("dvav",function(e){l.push({box:e,jb:1701733238})}).S("dva1",function(e){l.push({box:e,jb:1701733238})}).S("dvh1",function(e){l.push({box:e,jb:1701733238})}).S("dvhe",function(e){l.push({box:e,jb:1701733238})}).S("hev1",function(e){l.push({box:e,jb:1701733238})}).S("hvc1",function(e){l.push({box:e,jb:1701733238})}).S("avc1",function(e){l.push({box:e,jb:1701733238})}).S("avc3",function(e){l.push({box:e,jb:1701733238})}).S("ac-3",function(e){l.push({box:e,jb:1701733217})}).S("ec-3",function(e){l.push({box:e,jb:1701733217})}).S("ac-4",function(e){l.push({box:e,jb:1701733217})}).S("mp4a",function(e){l.push({box:e,jb:1701733217})}).parse(e),o)return e;if(0==l.length||!r)throw ne(An(e)),new Rt(2,3,3019,t);l.reverse(),t=c(l);for(var u=t.next();!u.done;u=t.next())u=u.value,a=qo(a,r,u.box,s,u.jb);return Gt()&&tn()?(t=new Uint8Array(e.byteLength+a.byteLength),t.set(a),t.set(e,a.byteLength),t):a}function qo(e,t,n,i,r){var a=Wo.value(),o=e.subarray(n.start,n.start+n.size),s=Ie(o),l=new Uint8Array(n.size+a.byteLength);for(l.set(o,0),o=Ie(l),o.setUint32(4,r),l.set(a,n.size),r=s.getUint32(4),o.setUint32(n.size+16,r),Yo(l,0,l.byteLength),r=new Uint8Array(e.byteLength+l.byteLength),n=jt()||Gt()?n.start:n.start+n.size,a=e.subarray(n),r.set(e.subarray(0,n)),r.set(l,n),r.set(a,n+l.byteLength),e=c(i),i=e.next();!i.done;i=e.next())i=i.value,Yo(r,i.start,i.size+l.byteLength);return l=Ie(r,t.start),t=ya(t),e=l.getUint32(t),l.setUint32(t,e+1),r}function Yo(e,t,n){e=Ie(e,t),t=e.getUint32(0),0!=t&&(1==t?(e.setUint32(8,n>>32),e.setUint32(12,4294967295&n)):e.setUint32(0,n))}var Wo=new Dt(function(){return new Uint8Array([0,0,0,80,115,105,110,102,0,0,0,12,102,114,109,97,0,0,0,0,0,0,0,20,115,99,104,109,0,0,0,0,99,101,110,99,0,1,0,0,0,0,0,40,115,99,104,105,0,0,0,32,116,101,110,99,0,0,0,0,0,0,1,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])});function $o(e,t,n,i,r,a,o){this.M=e,this.Ha=t,this.sa=n,this.Lc=void 0===i?null:i,this.timescale=void 0===r?null:r,this.g=void 0===a?null:a,this.aesKey=void 0===o?null:o,this.mimeType=this.codecs=null}function Xo(e,t){return e===t||(e&&t?e.$b()==t.$b()&&e.Xb()==t.Xb()&&Ue(e.M().sort(),t.M().sort())&&Ee(e.vd(),t.vd()):e==t)}function Qo(e,t,n,i,r,a,o,s,l,u,d,f,h,p,g,m){for(u=void 0===u?[]:u,p=void 0===p?es:p,this.startTime=e,this.j=this.endTime=t,this.C=n,this.Ha=i,this.sa=r,this.$=a,this.timestampOffset=o,this.appendWindowStart=s,this.appendWindowEnd=l,this.g=u,this.tilesLayout=void 0===d?"":d,this.A=void 0===f?null:f,this.h=void 0===h?null:h,this.status=p,this.preload=!1,this.l=!0,this.m=!1,this.aesKey=void 0===g?null:g,this.s=null,this.i=0,this.o=void 0!==m&&m,this.pe=this.Kd=!1,e=c(this.g),t=e.next();!t.done;t=e.next())t.value.Xg();this.o&&this.g.length&&this.g[this.g.length-1].Wg(),this.B=this.mimeType=this.codecs=null}function Jo(e,t){e.$=t,e=c(e.g);for(var n=e.next();!n.done;n=e.next())Jo(n.value,t)}$o.prototype.$b=function(){return this.Ha},$o.prototype.Xb=function(){return this.sa},$o.prototype.vd=function(){return this.g},K("shaka.media.InitSegmentReference",$o),$o.prototype.getEndByte=$o.prototype.Xb,$o.prototype.getStartByte=$o.prototype.$b,i=Qo.prototype,i.M=function(){return this.C()},i.getStartTime=function(){return this.startTime},i.Th=function(){return this.endTime},i.$b=function(){return this.Ha},i.Xb=function(){return this.sa},i.ki=function(){return this.tilesLayout},i.ji=function(){return this.A},i.ac=function(){return this.status},i.Ei=function(){this.status=ts},i.Of=function(){this.preload=!0},i.yi=function(){return this.preload},i.se=function(){this.l=!1},i.vi=function(){return this.l},i.Xg=function(){this.Kd=!0},i.xi=function(){return this.Kd},i.Wg=function(){this.pe=!0},i.wi=function(){return this.pe},i.Vg=function(){this.m=!0},i.ri=function(){return this.m},i.oh=function(e){this.s=e},i.ii=function(){return this.s},i.offset=function(e){this.startTime+=e,this.endTime+=e,this.j+=e;for(var t=c(this.g),n=t.next();!n.done;n=t.next())n=n.value,n.startTime+=e,n.endTime+=e,n.j+=e},i.jg=function(e){null==this.h?X("Sync attempted without sync time!"):(e=this.h-e-this.startTime,.001<=Math.abs(e)&&this.offset(e))},i.fj=function(e){this.B=e},i.vd=function(){return this.B},K("shaka.media.SegmentReference",Qo),Qo.prototype.getSegmentData=Qo.prototype.vd,Qo.prototype.setSegmentData=Qo.prototype.fj,Qo.prototype.syncAgainst=Qo.prototype.jg,Qo.prototype.offset=Qo.prototype.offset,Qo.prototype.getThumbnailSprite=Qo.prototype.ii,Qo.prototype.setThumbnailSprite=Qo.prototype.oh,Qo.prototype.hasByterangeOptimization=Qo.prototype.ri,Qo.prototype.markAsByterangeOptimization=Qo.prototype.Vg,Qo.prototype.isLastPartial=Qo.prototype.wi,Qo.prototype.markAsLastPartial=Qo.prototype.Wg,Qo.prototype.isPartial=Qo.prototype.xi,Qo.prototype.markAsPartial=Qo.prototype.Xg,Qo.prototype.isIndependent=Qo.prototype.vi,Qo.prototype.markAsNonIndependent=Qo.prototype.se,Qo.prototype.isPreload=Qo.prototype.yi,Qo.prototype.markAsPreload=Qo.prototype.Of,Qo.prototype.markAsUnavailable=Qo.prototype.Ei,Qo.prototype.getStatus=Qo.prototype.ac,Qo.prototype.getTileDuration=Qo.prototype.ji,Qo.prototype.getTilesLayout=Qo.prototype.ki,Qo.prototype.getEndByte=Qo.prototype.Xb,Qo.prototype.getStartByte=Qo.prototype.$b,Qo.prototype.getEndTime=Qo.prototype.Th,Qo.prototype.getStartTime=Qo.prototype.getStartTime,Qo.prototype.getUris=Qo.prototype.M;var es=0,ts=1;function ns(e){return 1==e.length&&1e-4>e.end(0)-e.start(0)}function is(e){return!e||ns(e)?null:e.length?e.end(e.length-1):null}function rs(e,t){return!(!e||!e.length||ns(e)||t>e.end(e.length-1))&&t>=e.start(0)}function as(e,t){if(!e||!e.length||ns(e))return 0;var n=0;e=c(ss(e));for(var i=e.next();!i.done;i=e.next()){var r=i.value;i=r.start,r=r.end,r>t&&(n+=r-Math.max(i,t))}return n}function os(e,t,n){return e&&e.length&&!ns(e)?(e=ss(e).findIndex(function(e,i,r){return e.start>t&&(0==i||r[i-1].end-t<=n)}),0<=e?e:null):null}function ss(e){if(!e)return[];for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}
/*
 @license
 Shaka Player
 Copyright 2022 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
function ls(){}function us(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&255>e[t+3]&&255>e[t+4]&&128>e[t+6]&&128>e[t+7]&&128>e[t+8]&&128>e[t+9]}function cs(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&255>e[t+3]&&255>e[t+4]&&128>e[t+6]&&128>e[t+7]&&128>e[t+8]&&128>e[t+9]}function ds(e,t){var n=(127&e[t])<<21;return n|=(127&e[t+1])<<14,n|=(127&e[t+2])<<7,n|127&e[t+3]}function fs(e){var t={key:e.type,description:"",data:"",mimeType:null,pictureType:null};if("APIC"===e.type){if(2>e.size||3!==e.data[0])return null;var n=e.data.subarray(1).indexOf(0);if(-1===n)return null;var i=fn(we(e.data,1,n)),r=e.data[2+n],a=e.data.subarray(3+n).indexOf(0);if(-1===a)return null;var o,s=fn(we(e.data,3+n,a));return o="--\x3e"===i?fn(we(e.data,4+n+a)):Se(e.data.subarray(4+n+a)),t.mimeType=i,t.pictureType=r,t.description=s,t.data=o,t}return"TXXX"===e.type?2>e.size||3!==e.data[0]?null:(i=e.data.subarray(1).indexOf(0),-1===i?null:(n=fn(we(e.data,1,i)),e=fn(we(e.data,2+i)).replace(/\0*$/,""),t.description=n,t.data=e,t)):"WXXX"===e.type?2>e.size||3!==e.data[0]?null:(i=e.data.subarray(1).indexOf(0),-1===i?null:(n=fn(we(e.data,1,i)),e=fn(we(e.data,2+i)).replace(/\0*$/,""),t.description=n,t.data=e,t)):"PRIV"===e.type?2>e.size?null:(n=e.data.indexOf(0),-1===n?null:(n=fn(we(e.data,0,n)),t.description=n,"com.apple.streaming.transportStreamTimestamp"==n?(n=e.data.subarray(n.length+1),e=1&n[3],n=(n[4]<<23)+(n[5]<<15)+(n[6]<<7)+n[7],n/=45,e&&(n+=47721858.84),t.data=n):(e=Se(e.data.subarray(n.length+1)),t.data=e),t)):"T"===e.type[0]?2>e.size||3!==e.data[0]?null:(e=fn(e.data.subarray(1)).replace(/\0*$/,""),t.data=e,t):"W"===e.type[0]?(e=fn(e.data).replace(/\0*$/,""),t.data=e,t):e.data?(t.data=Se(e.data),t):null}function hs(e){for(var t=0,n=[];us(e,t);){var i=ds(e,t+6);for(e[t+5]>>6&1&&(t+=10),t+=10,i=t+i;t+10<i;){var r=e.subarray(t),a=ds(r,4);r={type:String.fromCharCode(r[0],r[1],r[2],r[3]),size:a,data:r.subarray(10,10+a)},(a=fs(r))&&n.push(a),t+=r.size+10}cs(e,t)&&(t+=10)}return n}function ps(e,t){for(var n=t=void 0===t?0:t,i=0;us(e,t);)e[t+5]>>6&1&&(i+=10),i+=10,i+=ds(e,t+6),cs(e,t+10)&&(i+=10),t+=i;return 0<i?e.subarray(n,n+i):new Uint8Array([])}function gs(e,t){var n=null,i=null,r=null,a=e.P();return 1&t&&(r=e.Qc()),2&t&&e.skip(4),8&t&&(n=e.P()),16&t&&(i=e.P()),{trackId:a,qd:n,fe:i,jk:r}}function ms(e,t){return 1==t?(t=e.P(),e=e.P(),{baseMediaDecodeTime:t*Math.pow(2,32)+e}):{baseMediaDecodeTime:e.P()}}function vs(e,t){return 1==t?(e.skip(8),e.skip(8)):(e.skip(4),e.skip(4)),t=e.P(),e.skip(4),e=e.ka(),{timescale:t,language:String.fromCharCode(96+(e>>10))+String.fromCharCode(96+((960&e)>>5))+String.fromCharCode(96+(31&e))}}function ys(e,t,n){var i=e.P(),r=[],a=null;1&n&&(a=e.P()),4&n&&e.skip(4);for(var o=0;o<i;o++){var s={$f:null,sampleSize:null,He:null};256&n&&(s.$f=e.P()),512&n&&(s.sampleSize=e.P()),1024&n&&e.skip(4),2048&n&&(s.He=0==t?e.P():e.bh()),r.push(s)}return{nk:i,fh:r,Mh:a}}function _s(e){e.skip(6),e.skip(2),e.skip(8);var t=e.ka();return e.skip(2),e.skip(2),e.skip(2),e=e.ka()+e.ka()/65536,{channelCount:t,sampleRate:e}}function bs(e){return e=e.P(),{Na:va(e)}}function Es(e){var t=null,n=null,i=e.rb(4),r=String.fromCharCode(i[0]);if(r+=String.fromCharCode(i[1]),r+=String.fromCharCode(i[2]),r+=String.fromCharCode(i[3]),"nclx"===r){switch(e.ka()){case 1:case 5:case 6:case 7:t="srgb";break;case 9:t="rec2020";break;case 11:case 12:t="p3"}switch(i=e.ka(),e.ka(),i){case 1:case 6:case 13:case 14:case 15:n="SDR";break;case 16:n="PQ";break;case 18:n="HLG"}}return{colorGamut:t,Qd:n}}function Ts(e,t){return t=void 0!==t&&t,e=e.toString(16).toUpperCase(),t?e:("0"+e).slice(-2)}function Ss(e){return(10>e?"0":"")+e}function ws(e,t){if(this.j=e,void 0!==t&&t){t=new Uint8Array(e.byteLength);for(var n=0,i=0;i<e.byteLength;i++)2<=i&&3==e[i]&&0==e[i-1]&&0==e[i-2]||(t[n]=e[i],n++);this.j=we(t,0,n)}this.i=this.j.byteLength,this.g=this.h=0}function As(e){var t=e.j.byteLength-e.i,n=new Uint8Array(4),i=Math.min(4,e.i);0!==i&&(n.set(e.j.subarray(t,t+i)),e.h=new sa(n,0).P(),e.g=8*i,e.i-=i)}function Is(e,t){if(e.g<=t){t-=e.g;var n=Math.floor(t/8);t-=8*n,e.g-=n,As(e)}e.h<<=t,e.g-=t}function xs(e,t){var n=Math.min(e.g,t),i=e.h>>>32-n;return e.g-=n,0<e.g?e.h<<=n:0<e.i&&As(e),n=t-n,0<n?i<<n|xs(e,n):i}function Rs(e){var t;for(t=0;t<e.g;++t)if(0!==(e.h&2147483648>>>t))return e.h<<=t,e.g-=t,t;return As(e),t+Rs(e)}function Cs(e){Is(e,1+Rs(e))}function Ds(e){var t=Rs(e);return xs(e,t+1)-1}function ks(e){return e=Ds(e),1&e?1+e>>>1:-1*(e>>>1)}function Ms(e){return 1===xs(e,1)}function Ls(e){return xs(e,8)}function Ps(e,t){for(var n=8,i=8,r=0;r<t;r++)0!==i&&(i=ks(e),i=(n+i+256)%256),n=0===i?n:i}function Ns(e){return Ls(e),Ds(e),Ds(e)}function Os(){this.G=null,this.H=!1,this.m=this.I=null,this.j=[],this.g=[],this.A=this.B=null,this.i=[],this.h=[],this.C=null,this.l=[],this.F=this.o=this.s=null}function Fs(e,t){if(1!==(t[0]<<16|t[1]<<8|t[2]))return null;var n={data:new Uint8Array(0),packetLength:t[4]<<8|t[5],pts:null,dts:null,nalus:[]};if(n.packetLength&&n.packetLength>t.byteLength-6)return null;var i=t[7];if(192&i){var r=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2;null==e.s&&(e.s=r),n.pts=Gs(r,e.s),e.s=n.pts,n.dts=n.pts,64&i&&(i=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2,null==e.o&&(e.o=i),n.dts=Gs(i,e.o)),e.o=n.dts}return e=t[8]+9,t.byteLength<=e?null:(n.data=t.subarray(e),n)}function Us(e){var t={height:null,width:null,Na:null};if(e=e.ke(),!e.length)return t;if(e=e.find(function(e){return 7==e.type}),!e)return t;e=new ws(e.data);var n=Ls(e),i=Ls(e),r=Ls(e);if(Cs(e),Hs.includes(n)){var a=Ds(e);if(3===a&&Is(e,1),Cs(e),Cs(e),Is(e,1),Ms(e)){a=3!==a?8:12;for(var o=0;o<a;o++)Ms(e)&&Ps(e,6>o?16:64)}}if(Cs(e),a=Ds(e),0===a)Ds(e);else if(1===a)for(Is(e,1),Cs(e),Cs(e),a=Ds(e),o=0;o<a;o++)Cs(e);Cs(e),Is(e,1),a=Ds(e),o=Ds(e);var s=xs(e,1);0===s&&Is(e,1),Is(e,1);var l=0,u=0,c=0,d=0;return Ms(e)&&(l=Ds(e),u=Ds(e),c=Ds(e),d=Ds(e)),t.height=String((2-s)*(o+1)*16-2*c-2*d),t.width=String(16*(a+1)-2*l-2*u),t.Na="avc1."+("0"+n.toString(16).toUpperCase()).slice(-2)+("0"+i.toString(16).toUpperCase()).slice(-2)+("0"+r.toString(16).toUpperCase()).slice(-2),t}function Bs(e){var t={height:null,width:null,Na:null};if(e=e.ke(),!e.length)return t;if(e=e.find(function(e){return 33==e.type}),!e)return t;var n=new ws(e.fullData,!0);Ls(n),Ls(n),xs(n,4);var i=xs(n,3);Ms(n);var r=xs(n,2),a=xs(n,1),o=xs(n,5),s=xs(n,32);e=Ls(n);for(var l=Ls(n),u=Ls(n),c=Ls(n),d=Ls(n),f=Ls(n),h=Ls(n),p=[],g=[],m=0;m<i;m++)p.push(Ms(n)),g.push(Ms(n));if(0<i)for(m=i;8>m;m++)xs(n,2);for(m=0;m<i;m++)p[m]&&xs(n,88),g[m]&&Ls(n);Ds(n),i=Ds(n),3==i&&xs(n,1),p=Ds(n),g=Ds(n);var v=m=0,y=0,_=0;return Ms(n)&&(m+=Ds(n),v+=Ds(n),y+=Ds(n),_+=Ds(n)),t.width=String(p-(m+v)*(1===i||2===i?2:1)),t.height=String(g-(y+_)*(1===i?2:1)),n=function(e){for(var t=0,n=0;32>n;n++)t|=(e>>n&1)<<31-n;return t>>>0}(s),a=1==a?"H":"L",r="hvc1."+["","A","B","C"][r]+o,r+="."+n.toString(16).toUpperCase(),r+="."+a+h,f&&(r+="."+f.toString(16).toUpperCase()),d&&(r+="."+d.toString(16).toUpperCase()),c&&(r+="."+c.toString(16).toUpperCase()),u&&(r+="."+u.toString(16).toUpperCase()),l&&(r+="."+l.toString(16).toUpperCase()),e&&(r+="."+e.toString(16).toUpperCase()),t.Na=r,t}function Gs(e,t){var n=1;for(e>t&&(n=-1);4294967296<Math.abs(t-e);)e+=8589934592*n;return e}function js(e){return!(0>Vs(e))}function Vs(e){for(var t=Math.min(1e3,e.length-564),n=0;n<t;){if(71==e[n]&&71==e[n+188]&&71==e[n+376])return n;n++}return-1}Qo.Status={oj:es,fk:ts,Ij:2},K("shaka.util.Id3Utils",ls),ls.getID3Data=ps,ls.getID3Frames=hs,K("shaka.util.ExpGolomb",ws),i=Os.prototype,i.clearData=function(){this.j=[],this.g=[],this.i=[],this.h=[],this.l=[]},i.parse=function(e){if(564>e.length)return this;for(var t=Math.max(0,Vs(e)),n=e.length-(e.length+t)%188,i=!1,r=t;r<n;r+=188)if(71==e[r]){var a=!!(64&e[r+1]),o=((31&e[r+1])<<8)+e[r+2];if(1<(48&e[r+3])>>4){var s=r+5+e[r+4];if(s==r+188)continue}else s=r+4;switch(o){case 0:a&&(s+=e[s]+1),this.G=(31&e[s+10])<<8|e[s+11];break;case 17:case 8191:break;case this.G:a&&(s+=e[s]+1),a=e,o={audio:-1,video:-1,me:-1,audioCodec:"",videoCodec:""};var l=s+3+((15&a[s+1])<<8|a[s+2])-4;for(s+=12+((15&a[s+10])<<8|a[s+11]);s<l;){var u=(31&a[s+1])<<8|a[s+2],c=(15&a[s+3])<<8|a[s+4];switch(a[s]){case 6:if(0<c)for(var d=s+5,f=c;2<f;){var h=a[d+1]+2;switch(a[d]){case 5:var p=vn(a.subarray(d+2,d+h));-1==o.audio&&"Opus"===p?(o.audio=u,o.audioCodec="opus"):-1==o.video&&"AV01"===p&&(o.video=u,o.videoCodec="av1");break;case 106:-1==o.audio&&(o.audio=u,o.audioCodec="ac3");break;case 122:-1==o.audio&&(o.audio=u,o.audioCodec="ec3");break;case 124:-1==o.audio&&(o.audio=u,o.audioCodec="aac");break;case 127:"opus"==o.audioCodec&&(p=null,128===a[d+2]&&(p=a[d+3]),null!=p&&(this.F={channelCount:0===(15&p)?2:15&p,Jh:p,sampleRate:48e3}))}d+=h,f-=h}break;case 15:-1==o.audio&&(o.audio=u,o.audioCodec="aac");break;case 17:-1==o.audio&&(o.audio=u,o.audioCodec="aac-loas");break;case 21:-1==o.me&&(o.me=u);break;case 27:-1==o.video&&(o.video=u,o.videoCodec="avc");break;case 3:case 4:-1==o.audio&&(o.audio=u,o.audioCodec="mp3");break;case 36:-1==o.video&&(o.video=u,o.videoCodec="hvc");break;case 129:-1==o.audio&&(o.audio=u,o.audioCodec="ac3");break;case 132:case 135:-1==o.audio&&(o.audio=u,o.audioCodec="ec3")}s+=c+5}a=o,-1!=a.video&&(this.I=a.video,this.m=a.videoCodec),-1!=a.audio&&(this.B=a.audio,this.A=a.audioCodec),-1!=a.me&&(this.C=a.me),i&&!this.H&&(i=!1,r=t-188),this.H=!0;break;case this.I:s=e.subarray(s,r+188),a?this.j.push([s]):this.j.length&&this.j[this.j.length-1]&&this.j[this.j.length-1].push(s);break;case this.B:s=e.subarray(s,r+188),a?this.i.push([s]):this.i.length&&this.i[this.i.length-1]&&this.i[this.i.length-1].push(s);break;case this.C:s=e.subarray(s,r+188),a?this.l.push([s]):this.l.length&&this.l[this.l.length-1]&&this.l[this.l.length-1].push(s);break;default:i=!0}}return this},i.Ji=function(e){return pe("TsParser.parseAvcNalus","Please use parseNalus function instead."),this.Uf(e)},i.Uf=function(e,t,n){var i=e.pts?e.pts/9e4:null;e=e.data;var r=e.byteLength,a=1;"hvc"==this.m&&(a=2);for(var o,s=n||0,l=[],u=-1,c=0,d=0;d<r;++d){var f=e[d];if(f){if(2<=s&&1==f){if(t&&!l.length&&-1==u&&(f=d-(3<s?3:s),n&&0!=f&&(f=e.subarray(0,f),t.data=In(t.data,f),t.fullData=In(t.fullData,f))),0<=u?(s=d-((3<s?3:s)+1),l.push({data:e.subarray(u+a,s+1),fullData:e.subarray(u,s+1),type:c,time:i})):t&&!l.length&&(u=d-s,0<u&&(u=e.subarray(0,u),t.data=In(t.data,u),t.fullData=In(t.fullData,u))),d>=r-a)return l;d++,u=d,c="hvc"==this.m?e[d]>>1&63:31&e[d]}s=0}else s++;d>=r-1&&0<=u&&0<=s&&(o={data:e.subarray(u+a,r),fullData:e.subarray(u,r),type:c,time:i})}return o&&l.push(o),!l.length&&t&&(t.data=In(t.data,e),t.fullData=In(t.fullData,e)),l},i.getMetadata=function(){for(var e=[],t=c(this.l),n=t.next();!n.done;n=t.next())n=In.apply(bn,d(n.value)),(n=Fs(this,n))&&e.push({cueTime:n.pts?n.pts/9e4:null,data:n.data,frames:hs(n.data),dts:n.dts,pts:n.pts});return e},i.Wb=function(){if(this.i.length&&!this.h.length){for(var e=!1,t=c(this.i),n=t.next();!n.done;n=t.next()){var i=In.apply(bn,d(n.value)),r=Fs(this,i);n=this.h.length?this.h[this.h.length-1]:null,r&&null!=r.pts&&null!=r.dts&&(!n||n.pts!=r.pts&&n.dts!=r.dts)?(this.h.length&&r.dts<(n.dts||0)&&(e=!0),this.h.push(r)):this.h.length&&(i=r?r.data:i)&&(n=this.h.pop(),n.data=In(n.data,i),this.h.push(n))}e&&(this.h=this.h.sort(function(e,t){var n=(e.pts||0)-(t.pts||0);return(e.dts||0)-(t.dts||0)||n}))}return this.h},i.Ic=function(e){if(e=void 0===e||e,this.j.length&&!this.g.length){for(var t=!1,n=c(this.j),i=n.next();!i.done;i=n.next()){var r=In.apply(bn,d(i.value)),a=Fs(this,r);i=this.g.length?this.g[this.g.length-1]:null,a&&null!=a.pts&&null!=a.dts&&(!i||i.pts!=a.pts&&i.dts!=a.dts)?(this.g.length&&a.dts<(i.dts||0)&&(t=!0),this.g.push(a)):this.g.length&&(r=a?a.data:r)&&(i=this.g.pop(),i.data=In(i.data,r),this.g.push(i))}if(e){for(n=[],i=c(this.g),r=i.next();!r.done;r=i.next())if(r=r.value,r.nalus=this.Uf(r,o,void 0),r.nalus.length){n.push(r);var o=r.nalus[r.nalus.length-1]}this.g=n}t&&(this.g=this.g.sort(function(e,t){var n=(e.pts||0)-(t.pts||0);return(e.dts||0)-(t.dts||0)||n}))}return e?this.g:(e=this.g,this.g=[],e)},i.getStartTime=function(e){if("audio"==e){e=null;var t=this.Wb();return t.length&&(e=t[0],e=Math.min(e.dts,e.pts)/9e4),e}return"video"==e?(e=null,t=this.Ic(!1),t.length&&(e=t[0],e=Math.min(e.dts,e.pts)/9e4),e):null},i.sd=function(){return{audio:this.A,video:this.m}},i.ke=function(){for(var e=[],t=c(this.Ic()),n=t.next();!n.done;n=t.next())e.push.apply(e,d(n.value.nalus));return e},i.ni=function(){pe("TsParser.getVideoResolution","Please use getVideoInfo function instead.");var e=this.Hf();return{height:e.height,width:e.width}},i.Hf=function(){return"hvc"==this.m?Bs(this):Us(this)},K("shaka.util.TsParser",Os),Os.syncOffset=Vs,Os.probe=js,Os.prototype.getVideoInfo=Os.prototype.Hf,Os.prototype.getVideoResolution=Os.prototype.ni,Os.prototype.getVideoNalus=Os.prototype.ke,Os.prototype.getCodecs=Os.prototype.sd,Os.prototype.getStartTime=Os.prototype.getStartTime,Os.prototype.getVideoData=Os.prototype.Ic,Os.prototype.getAudioData=Os.prototype.Wb,Os.prototype.getMetadata=Os.prototype.getMetadata,Os.prototype.parseNalus=Os.prototype.Uf,Os.prototype.parseAvcNalus=Os.prototype.Ji,Os.prototype.parse=Os.prototype.parse,Os.prototype.clearData=Os.prototype.clearData,Os.Timescale=9e4;var Hs=[100,110,122,244,44,83,86,118,128,138,139,134];function Ks(e,t,n){this.g=null,this.o=-1,this.l=e,this.i=t,this.m=n,this.j=!1;e:{if("undefined"===typeof libDPIModule&&Q("Could not find LCEVC Library dependencies on this page"),"undefined"!==typeof LCEVCdec)this.h=LCEVCdec;else{if("undefined"===typeof LcevcDil){Q("Could not find LCEVC Library on this page"),e=!1;break e}this.h=LcevcDil,this.j=!0,pe("LcevcDil","lcevc_dil.js is deprecated, please use lcevc_dec.js instead")}"undefined"===typeof this.h.SupportObject?(Q("Could not find LCEVC Library on this page"),e=!1):(this.h.SupportObject.SupportStatus||Q(this.h.SupportObject.SupportError),e="undefined"!==typeof this.h&&"undefined"!==typeof libDPIModule&&this.i instanceof HTMLCanvasElement&&this.h.SupportObject.SupportStatus)}e&&!this.g&&this.h.SupportObject.webGLSupport(this.i)&&(this.i.classList.remove("shaka-hidden"),this.g=this.j?new this.h.LcevcDil(this.l,this.i,this.m):new this.h.LCEVCdec(this.l,this.i,this.m))}function zs(e){e.g&&e.i.classList.add("shaka-hidden")}function Zs(e,t,n){var i=qs,r=Qs;switch(t.mimeType){case"video/webm":i=Ys;break;case"video/mp4":i=Ws}switch(n){case"DASH":r=Xs;break;case"HLS":r=$s}e.g&&(e.o=t.id,e.g.setLevelSwitching(t.id,!0),e.g.setContainerFormat(i),e.j||e.g.setStreamingFormat(r))}Ks.prototype.release=function(){this.g&&(this.g.close(),this.g=null)},K("shaka.lcevc.Dec",Ks),Ks.prototype.release=Ks.prototype.release;var qs=0,Ys=1,Ws=2,$s=0,Xs=1,Qs=-1;function Js(e,t,n,i){var r=this;this.i=e,this.da=n,this.A=null,this.F=t,this.h={},this.G={},this.Da={},this.g=null,this.fa=!1,this.Z=i||null,this.l={},this.s=new ae,this.j={},this.H=null,this.L=new Rr,this.N="",this.ra=!1,this.m=el(this,this.L),this.C=!1,this.I=new ta(function(){return nl(r)}),this.B=!1,this.aa="UNKNOWN",this.Ea=this.Fa=!1,this.za=new Rr,this.o=!1,this.xa=!0,this.qa=this.R=this.ya=this.U=this.K=this.ea=null,this.pa=new Rr}function el(t,n){if(e.ManagedMediaSource){t.i.disableRemotePlayback=!0;var i=new ManagedMediaSource;return t.s.D(i,"startstreaming",function(){t.xa=!0}),t.s.D(i,"endstreaming",function(){t.xa=!1}),t.s.ha(i,"sourceopen",function(){URL.revokeObjectURL(t.N),n.resolve()}),t.s.ha(t.i,"playing",function(){t.ra=!0}),t.N=kl(i),t.i.src=t.N,i}return i=new MediaSource,t.s.ha(i,"sourceopen",function(){URL.revokeObjectURL(t.N),n.resolve()}),t.s.ha(t.i,"playing",function(){t.ra=!0}),t.N=kl(i),t.i.src=t.N,i}function tl(e,t){var n,i,r,a,o,s,l,u,d,f,h;return O(function(p){if(1==p.g)return e.createSegmentIndex?T(p,e.createSegmentIndex(),2):p.u(2);if(!e.segmentIndex)return p.return(!1);if(0==e.segmentIndex.getNumReferences())return p.return(!0);for(n=Pn,i=new Set,r=c(e.segmentIndex),a=r.next();!a.done;a=r.next())if(o=a.value,s=o.mimeType||e.mimeType||"",l=o.codecs||e.codecs||"",u=s+":"+l,!i.has(u))if(i.add(u),t==n.ta){if(d=Un(s,l),!Qn(d))return p.return(!1)}else if(t==n.ga?l=Ni(l):t==n.X&&(l=Pi(l,s)),f=jn(e,s,l),h=Bn(s,l),!ce(f)&&!at(h))return p.return(!1);return p.return(!0)})}function nl(e){var t,n,i,r,a,o,s,l;return O(function(u){if(1==u.g){for(n in t=[],e.l)for(i=e.l[n],r=i[0],e.l[n]=i.slice(0,1),r&&t.push(r.p.catch(oi)),a=c(i.slice(1)),o=a.next();!o.done;o=a.next())s=o.value,s.p.reject(new Rt(2,7,7003,void 0));for(l in e.g&&t.push(e.g.destroy()),e.F&&t.push(e.F.destroy()),e.j)t.push(e.j[l].destroy());return T(u,Promise.all(t),2)}e.s&&(e.s.release(),e.s=null),e.i&&(e.i.removeAttribute("src"),e.i.load(),e.i=null),e.A=null,e.m=null,e.g=null,e.F=null,e.h={},e.j={},e.H=null,e.l={},e.Z=null,e.K=null,e.da=null,S(u)})}function il(e,t,n,i){var r,a,o,s,l,u,c,d,f,h,p,g;return O(function(m){switch(m.g){case 1:return r=Pn,a=z,o=Z,T(m,tl(n,t),2);case 2:if(o.call(a,m.h,"Type negotiation should happen before MediaSourceEngine.init!"),s=Un(n.mimeType,i),t==r.ta){rl(e,s,e.B,n.external),m.u(0);break}if(l=e.A.forceTransmux,(!ce(s)||!e.B&&$n.includes(s))&&(l=!0),u=Bn(n.mimeType,i),!l){m.u(4);break}if(c=kn(r.X,(i||"").split(",")),d=kn(r.ga,(i||"").split(",")),!c||!d){m.u(5);break}return e.o=!0,T(m,il(e,r.X,n,c),6);case 6:return T(m,il(e,r.ga,n,d),7);case 7:return m.return();case 5:(f=at(u))&&(h=f(),e.j[t]=h,s=h.convertCodecs(t,u));case 4:p=s+e.A.addExtraFeaturesToSourceBuffer(s),na(e.I);try{g=e.m.addSourceBuffer(p)}catch(t){throw new Rt(2,3,3015,t,"The mediaSource_ status was "+e.m.readyState+" expected 'open'",null)}e.B&&(g.mode=Ml),e.s.D(g,"error",function(){var n=e.l[t][0];n.p.reject(new Rt(2,3,3014,e.i.error?e.i.error.code:0,n.uri))}),e.s.D(g,"updateend",function(){return bl(e,t)}),e.h[t]=g,e.G[t]=s,e.Da[t]=!!n.drmInfos.length,S(m)}})}function rl(e,t,n,i){e.g||(e.g=new Xn(e.F),e.g&&(e.g.A=e.A.modifyCueCallback));var r=e.g;i=i||e.fa,e=e.aa,"application/cea-608"==t||"application/cea-708"==t?r.i=null:(r.i=(0,ri[t])(),r.i.setSequenceMode?r.i.setSequenceMode(n):pe("Text parsers w/ setSequenceMode",'Text parsers should have a "setSequenceMode" method!'),r.i.setManifestType?r.i.setManifestType(e):pe("Text parsers w/ setManifestType",'Text parsers should have a "setManifestType" method!'),r.B=i)}function al(e){return!e.C&&(!e.m||"ended"==e.m.readyState)}function ol(e,t){return e.C||!Object.keys(e.h).length?e=null:t==Ln?e=e.g.g:(e=ul(e,t),e=!e||ns(e)?null:1==e.length&&0>e.start(0)?0:e.length?e.start(0):null),e}function sl(e,t){return e.C?null:t==Ln?e.g.h:is(ul(e,t))}function ll(e,t,n){return e.C?0:t==Ln?(e=e.g,null==e.h||e.h<n?0:e.h-Math.max(n,e.g)):(e=ul(e,t),as(e,n))}function ul(e,t){try{return e.h[t].buffered}catch(e){return null}}function cl(e,t,n,i,r,a){var o=null,s=we(n);if($n.includes(r))a=hs(s),a.length&&i&&((t=a.find(function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description}))&&t.data&&(o=Math.round(t.data)/1e3),e.da.onMetadata([{cueTime:i.startTime,data:s,frames:a,dts:i.startTime,pts:i.startTime}],0,i.endTime));else if(r.includes("/mp4")&&i&&0==i.timestampOffset&&i.$&&i.$.timescale){var l=i.$.timescale;if(!isNaN(l)){var u=0,c=!1;(new ca).box("moof",da).box("traf",da).S("tfdt",function(e){u=ms(e.reader,e.version).baseMediaDecodeTime/l,c=!0,e.parser.stop()}).parse(n,!0),c&&(o=u)}}else!r.includes("/mp4")&&!r.includes("/webm")&&js(s)&&(e.K?e.K.clearData():e.K=new Os,s=e.K.parse(s),t=s.getStartTime(t),null!=t&&(o=t),s=s.getMetadata(),s.length)&&e.da.onMetadata(s,a,i?i.endTime:null);return o}function dl(e,t,n,i,r,a,o,s,l,u){var c,d,f,h,p,g,m,v,y,_,b,E,w,A;return o=void 0!==o&&o,s=void 0!==s&&s,l=void 0!==l&&l,u=void 0!==u&&u,O(function(I){switch(I.g){case 1:if(c=Pn,t!=c.ta){I.u(2);break}if(!e.B){I.u(3);break}return T(I,e.za,4);case 4:d=I.h,e.g.s=d;case 3:return T(I,Jn(e.g,n,i?i.startTime:null,i?i.endTime:null,i?i.M()[0]:null),5);case 5:return I.return();case 2:if(u||!e.o){I.u(6);break}return T(I,dl(e,c.X,n,i,r,a,o,s,l,!0),7);case 7:return T(I,dl(e,c.ga,n,i,r,a,o,s,l,!0),8);case 8:return I.return();case 6:if(!e.h[t])return I.return();if(f=e.h[t].timestampOffset,h=e.G[t],e.j[t]&&(h=e.j[t].getOriginalMimeType()),i&&(p=cl(e,t,n,i,h,f),null!=p&&(null==e.U&&t==c.ga&&(e.U=p,e.ya=i.startTime,null!=e.R&&(g=0,e.ya==e.qa&&(g=e.U-e.R),e.pa.resolve(g))),null==e.R&&t==c.X&&(e.R=p,e.qa=i.startTime,null!=e.U&&(m=0,e.ya==e.qa&&(m=e.U-e.R),e.pa.resolve(m))),v=i.startTime-p,y=Math.abs(f-v),(.001<=y||o||s)&&(!l||0<v||!f)&&(f=v,e.Ea&&(El(e,t,function(){return yl(e,t)},null),El(e,t,function(){return _l(e,t,f)},null))),_=t==c.ga||!(c.ga in e.h),e.B&&_&&e.za.resolve(f))),a&&t==c.ga&&(e.g||rl(e,"application/cea-608",e.B,!1),e.H||(b=h.split(";",1)[0],e.H=new Ce(b)),i?(E=e.H.i(n),E.length&&ii(e.g,E,i.startTime,i.endTime,f)):e.H.init(n,s)),!e.j[t]){I.u(9);break}return T(I,e.j[t].transmux(n,r,i,e.m.duration,t),10);case 10:n=I.h;case 9:if(n=Al(e,n,i?i.startTime:null,t,i?i.M()[0]:null),!i||!e.B||t==c.ta){I.u(11);break}if(!o&&!s){I.u(11);break}if(w=i.startTime,"HLS"!=e.aa||e.o||t!=c.X||!e.h[c.ga]){I.u(13);break}return T(I,e.pa,14);case 14:A=I.h,.1<Math.abs(A)&&(w-=A);case 13:El(e,t,function(){return yl(e,t)},null),El(e,t,function(){return _l(e,t,w)},null);case 11:return T(I,El(e,t,function(){var i=n;if("video"==t&&e.Z){var r=e.Z;r.g&&r.g.appendBuffer(i,"video",r.o,-f)}e.h[t].appendBuffer(i)},i?i.M()[0]:null),15);case 15:S(I)}})}function fl(e,t){var n=sl(e,"video")||0;ti(e.g,t,n)}function hl(e){e.g&&ti(e.g,"",0)}function pl(e,t){var n;return O(function(i){return 1==i.g?(n=Pn,t==n.ta?e.g?T(i,e.g.remove(0,1/0),0):i.return():T(i,El(e,t,function(){return vl(e,t,0,e.m.duration)},null),4)):e.o?T(i,El(e,n.X,function(){return vl(e,n.X,0,e.m.duration)},null),0):i.u(0)})}function gl(e,t,n,i,r,a,o,s,l){var u,c,d;return O(function(f){return 1==f.g?(u=Pn,t==u.ta?(a||(e.g.s=n),ei(e.g,i,r),f.return()):(c=[],T(f,Cl(e,t,o,s,l),2))):(d=f.h,d||(c.push(El(e,t,function(){return yl(e,t)},null)),e.o&&c.push(El(e,u.X,function(){return yl(e,u.X)},null))),a||(c.push(El(e,t,function(){return _l(e,t,n)},null)),e.o&&c.push(El(e,u.X,function(){return _l(e,u.X,n)},null))),c.push(El(e,t,function(){e.h[t].appendWindowStart=0,e.h[t].appendWindowEnd=r,e.h[t].appendWindowStart=i,bl(e,t)},null)),e.o&&c.push(El(e,u.X,function(){var t=u.X;e.h[t].appendWindowStart=0,e.h[t].appendWindowEnd=r,e.h[t].appendWindowStart=i,bl(e,t)},null)),T(f,Promise.all(c),0))})}function ml(e,t,n){var i;return O(function(r){return 1==r.g?(i=Pn,t==i.ta?r.return():(t==i.ga&&(e.za=new Rr),El(e,t,function(){return yl(e,t)},null),e.o&&El(e,i.X,function(){return yl(e,i.X)},null),T(r,El(e,t,function(){return _l(e,t,n)},null),2))):e.o?T(r,El(e,i.X,function(){return _l(e,i.X,n)},null),0):r.u(0)})}function vl(e,t,n,i){i<=n?bl(e,t):e.h[t].remove(n,i)}function yl(e,t){var n=e.h[t].appendWindowStart,i=e.h[t].appendWindowEnd;e.h[t].abort(),e.h[t].appendWindowStart=n,e.h[t].appendWindowEnd=i,bl(e,t)}function _l(e,t,n){0>n&&(n+=.001),e.h[t].timestampOffset=n,bl(e,t)}function bl(e,t){if(!e.C){var n=e.l[t][0];n&&(n.p.resolve(),Sl(e,t))}}function El(e,t,n,i){return na(e.I),n={start:n,p:new Rr,uri:i},e.l[t].push(n),1==e.l[t].length&&wl(e,t),n.p}function Tl(e,t){var n,i,r,a,o,s,l;return O(function(u){switch(u.g){case 1:for(r in na(e.I),n=[],i={},e.h)i.cd=new Rr,a={start:function(e){return function(){return e.cd.resolve()}}(i),p:i.cd,uri:null},e.l[r].push(a),n.push(i.cd),1==e.l[r].length&&a.start(),i={cd:i.cd};return w(u,2),T(u,Promise.all(n),4);case 4:I(u,3);break;case 2:throw o=x(u),o;case 3:return w(u,5,6),T(u,t(),6);case 6:for(s in R(u),e.h)Sl(e,s);C(u,0);break;case 5:throw l=x(u),new Rt(2,3,3015,l,e.i.error||"No error in the media element",null)}})}function Sl(e,t){e.l[t].shift(),wl(e,t)}function wl(e,t){var n=e.l[t][0];if(n)try{n.start()}catch(i){"QuotaExceededError"==i.name?n.p.reject(new Rt(2,3,3017,t)):n.p.reject(new Rt(2,3,3015,i,e.i.error||"No error in the media element",n.uri)),Sl(e,t)}}function Al(e,t,n,i,r){var a=null==n,o=e.Da[i];return n=e.da.Xh(),(a=e.A.insertFakeEncryptionInInit&&a&&o)&&(n=Lt(n),a=Vt()||jt()||Jt()||Gt()&&tn()&&n),a&&"mp4"==Vn(e.G[i])&&(t=Zo(t,r)),t}function Il(e,t,n,i){return El(e,t,function(){t!==Ln&&(de()&&(e.j[t]&&(e.j[t].destroy(),delete e.j[t]),i&&(e.j[t]=i),e.h[t].changeType(n+e.A.addExtraFeaturesToSourceBuffer(n)),e.G[t]=n),bl(e,t))},null)}function xl(e,t){var n,i,r,a,o,s,l,u,d,f,h,p,g,m,v,y,_,b,E,S,w,I,x,D;return O(function(k){switch(k.g){case 1:for(s in n=Pn,e.C=!0,e.o=!1,i=e.i.currentTime,r=e.i.autoplay,a=e.i.paused,e.ra&&(e.i.autoplay=!1),A(k,2),e.s.Ra(),o=[],e.j)o.push(e.j[s].destroy());for(l in e.l)for(u=e.l[l],d=u[0],e.l[l]=u.slice(0,1),d&&o.push(d.p.catch(oi)),f=c(u.slice(1)),h=f.next();!h.done;h=f.next())p=h.value,p.p.reject(new Rt(2,7,7003,void 0));for(g in e.h){m=e.h[g];try{e.m.removeSourceBuffer(m)}catch(e){}}return T(k,Promise.all(o),4);case 4:return e.j={},e.h={},v=e.m.duration,e.L=new Rr,e.m=el(e,e.L),T(k,e.L,5);case 5:!isNaN(v)&&v?e.m.duration=v:!isNaN(e.ea)&&e.ea&&(e.m.duration=e.ea),y=new Rr,_=e.m.sourceBuffers,b=t.size,E=0,S=function(){E++,E===b&&(y.resolve(),e.s.lb(_,"addsourcebuffer",S))},e.s.D(_,"addsourcebuffer",S),w=c(t.keys()),I=w.next();case 6:return I.done?(e.i.currentTime=i,T(k,y,2)):(x=I.value,D=t.get(x),T(k,il(e,x,D,D.codecs),9));case 9:e.o?(e.l[n.X]=[],e.l[n.ga]=[]):e.l[x]=[],I=w.next(),k.u(6);break;case 2:R(k),e.C=!1,na(e.I),e.s.ha(e.i,"canplaythrough",function(){e.I.g||(e.i.autoplay=r,a||e.i.play())}),C(k,0)}})}function Rl(e,t){return Tl(e,function(){return xl(e,t)})}function Cl(e,t,n,i,r){var a,o,s,l,u,c,d,f,h,p,g,m,v,y,_;return O(function(b){return 1==b.g?(a=Pn,t==a.ta?b.return(!1):(o=Kn(Zn(e.G[t])),s=zn(e.G[t]),u=!1,c=Un(n,i),d=e.A.forceTransmux,(!ce(c)||!e.B&&$n.includes(c))&&(d=!0),d&&(f=Bn(n,i),h=at(f))&&(l=h(),p=kn(a.X,(i||"").split(",")),g=kn(a.ga,(i||"").split(",")),p&&g?(u=!0,m=g,t==a.X&&(m=p),c=l.convertCodecs(t,Bn(n,m))):c=l.convertCodecs(t,f)),v=Kn(Zn(c)),y=zn(c),o===v&&s===y?(e.j[t]&&!l?(e.j[t].destroy(),delete e.j[t]):!e.j[t]&&l?e.j[t]=l:l&&(e.j[t]&&e.j[t].transmux!=l.transmux?(e.j[t].destroy(),delete e.j[t],e.j[t]=l):l.destroy()),b.return(!1)):(_=!0,(e.o||u&&l&&!e.j[t])&&(_=!1),_&&"smooth"===e.A.codecSwitchingStrategy&&de()?T(b,Il(e,t,c,l),3):(l&&l.destroy(),T(b,Rl(e,r),3))))):b.return(!0)})}function Dl(e,t,n,i){if(t==Ln)var r=!1;else{r=Kn(Zn(e.G[t]));var a=zn(e.G[t]),o=Un(n,i),s=e.A.forceTransmux;(!ce(o)||!e.B&&$n.includes(o))&&(s=!0),n=Bn(n,i),s&&(s=at(n))&&(s=s(),o=s.convertCodecs(t,n),s.destroy()),t=Kn(Zn(o)),o=zn(o),r=r!==t||a!==o}return!!r&&("smooth"!==e.A.codecSwitchingStrategy||!de()||e.o)}i=Js.prototype,i.destroy=function(){return this.I.destroy()},i.init=function(e,t,n,i){t=void 0!==t&&t,n=void 0===n?"UNKNOWN":n,i=void 0!==i&&i;var r,a,o,s,l,u=this;return O(function(d){switch(d.g){case 1:return r=Pn,T(d,u.L,2);case 2:u.B=t,u.aa=n,u.Fa=i,u.Ea=!u.B&&"HLS"==u.aa&&!u.Fa,u.K=null,a=c(e.keys()),o=a.next();case 3:if(o.done){d.u(0);break}return s=o.value,l=e.get(s),T(d,il(u,s,l,l.codecs),6);case 6:u.o?(u.l[r.X]=[],u.l[r.ga]=[]):u.l[s]=[],o=a.next(),d.u(3)}})},i.configure=function(e){this.A=e,this.g&&(this.g.A=e.modifyCueCallback)},i.yb=function(){var e={total:this.C?[]:ss(this.i.buffered),audio:this.C?[]:ss(ul(this,"audio")),video:this.C?[]:ss(ul(this,"video")),text:[]};if(this.g){var t=this.g.g,n=this.g.h;null!=t&&null!=n&&e.text.push({start:t,end:n})}return e},i.remove=function(e,t,n){var i,r=this;return O(function(a){return 1==a.g?(i=Pn,e==i.ta?T(a,r.g.remove(t,n),0):T(a,El(r,e,function(){return vl(r,e,t,n)},null),4)):r.o?T(a,El(r,i.X,function(){return vl(r,i.X,t,n)},null),0):a.u(0)})},i.flush=function(e){var t,n=this;return O(function(i){return 1==i.g?(t=Pn,e==t.ta?i.return():T(i,El(n,e,function(){n.i.currentTime-=.001,bl(n,e)},null),2)):n.o?T(i,El(n,t.X,function(){var e=t.X;n.i.currentTime-=.001,bl(n,e)},null),0):i.u(0)})},i.endOfStream=function(e){var t=this;return O(function(n){return T(n,Tl(t,function(){al(t)||"closed"===t.m.readyState||(e?t.m.endOfStream(e):t.m.endOfStream())}),0)})},i.$a=function(e){var t=this;return O(function(n){return T(n,Tl(t,function(){if(e<t.m.duration)for(var n in t.h){var i={start:function(){},p:new Rr,uri:null};t.l[n].unshift(i)}t.m.duration=e,t.ea=e}),0)})},i.getDuration=function(){return this.m.duration};var kl=e.URL.createObjectURL,Ml="sequence";function Ll(e,t,n){this.i=e,this.A=t,this.o=this.j=1/0,this.g=1,this.h=this.l=null,this.B=0,this.G=!0,this.H=0,this.C=void 0===n||n,this.F=0,this.s=!1,this.m=e}function Pl(e,t,n){this.j=n,this.l=e,this.s=Fl(e),this.g=e.g.currentTime,this.m=Date.now()/1e3,this.h=!1,this.o=0,this.A=t,this.i=function(){}}function Nl(e,t){e.i=t}function Ol(e){this.g=e}function Fl(e){if(e.g.paused||0==e.g.playbackRate||0==e.g.buffered.length)var t=!1;else e:{t=e.g.currentTime,e=c(ss(e.g.buffered));for(var n=e.next();!n.done;n=e.next())if(n=n.value,!(t<n.start-.1||t>n.end-.5)){t=!0;break e}t=!1}return t}function Ul(e,t,n,i,r){var a=this;this.A=r,this.g=e,this.B=t,this.s=n,this.l=new ae,this.j=!1,this.F=e.readyState,this.C=this.i=0,this.h=i,this.o=!1,this.l.D(e,"waiting",function(){return Bl(a)}),this.m=new Ft(function(){Bl(a)}).Sa(this.s.gapJumpTimerTime)}function Bl(e){if(0!=e.g.readyState){if(e.g.seeking){if(!e.j)return}else e.j=!1;if(!e.g.paused||e.g.currentTime==e.i&&(e.g.autoplay||e.g.currentTime!=e.i)){var t;if(e.g.readyState!=e.F&&(e.F=e.g.readyState),!(t=!e.h)){t=e.h;var n=t.l,i=Fl(n),r=n.g.currentTime,a=Date.now()/1e3;t.g==r&&t.s==i||(t.m=a,t.g=r,t.s=i,t.h=!1),r=a-t.m,(i=r>=t.A&&i&&!t.h)&&(t.i(t.g,r),t.h=!0,t.g=n.g.currentTime,t.o++,t.j(new Or("stalldetected"))),t=!i}t&&(t=e.g.currentTime,n=e.g.buffered,i=os(n,t,e.s.gapDetectionThreshold),null!=i&&(0!=i||e.o))&&(r=n.start(i),(navigator.userAgent.match(/Edge\//)||jt())&&(r=Math.ceil(100*(r+.01))/100),r>=e.B.Ab()||.001>r-t||(0!=i&&n.end(i-1),e.g.currentTime=r,t==e.i&&(e.i=r),e.C++,e.A(new Or("gapjumped"))))}}}function Gl(e,t,n,i){t==HTMLMediaElement.HAVE_NOTHING||e.readyState>=t?i():(t=jl.value().get(t),n.ha(e,t,i))}i=Ll.prototype,i.getDuration=function(){return this.j},i.Zh=function(){return this.g},i.mh=function(e){this.i=e},i.$a=function(e){this.j=e},i.di=function(){return this.i},i.kh=function(e){this.B=e},i.wc=function(e){this.G=e},i.Ie=function(e){this.o=e},i.je=function(){return this.o},i.eg=function(e){this.A=e},i.Sh=function(){return this.A},i.$g=function(e,t){if(0!=e.length){var n=(Date.now()+this.B)/1e3;if(e=e.filter(function(e){return e.start+t<n}),0!=e.length){var i=e[e.length-1].end+t;this.ye(e[0].start+t),this.g=e.reduce(function(e,t){return Math.max(e,t.end-t.start)},this.g),this.h=Math.max(this.h,i),null!=this.i&&this.C&&!this.s&&(this.i=n-this.h-this.g)}}},i.Jd=function(e){if(0!=e.length){var t=e[0].startTime,n=e[0].endTime,i=(Date.now()+this.B)/1e3;e=c(e);for(var r=e.next();!r.done;r=e.next())r=r.value,i<r.startTime||(t=Math.min(t,r.startTime),n=Math.max(n,r.endTime),this.g=Math.max(this.g,r.endTime-r.startTime));this.ye(t),this.h=Math.max(this.h,n),null!=this.i&&this.C&&!this.s&&(this.i=i-this.h-this.g)}},i.$h=function(){return this.h},i.re=function(){this.s=!0},i.zi=function(){return this.s},i.lh=function(e){this.m=e},i.Wh=function(){return this.m},i.ye=function(e){this.l=null==this.l?e:Math.min(this.l,e)},i.Pf=function(e){this.g=Math.max(this.g,e)},i.offset=function(e){null!=this.l&&(this.l+=e),null!=this.h&&(this.h+=e)},i.V=function(){return 1/0==this.j&&!this.G},i.qc=function(){return 1/0!=this.j&&!this.G},i.nb=function(){return Math.max(this.H,this.Zb()-this.o)},i.qh=function(e){this.H=e},i.Zb=function(){return this.V()||this.qc()?Math.min(Math.max(0,(Date.now()+this.B)/1e3-this.g-this.i)+this.F,this.j):this.h?Math.min(this.h,this.j):this.j},i.ud=function(e){var t=Math.max(this.l,this.H);return 1/0==this.o?Math.ceil(1e3*t)/1e3:Math.max(t,Math.min(this.Zb()-this.o+e,this.Ab()))},i.Yb=function(){return this.ud(0)},i.Ab=function(){return Math.max(0,this.Zb()-(this.V()||this.qc()?this.A:0))},i.uh=function(){return!(null==this.i||null!=this.h&&this.C)},i.jh=function(e){this.F=e},i.Qh=function(){return this.F},K("shaka.media.PresentationTimeline",Ll),Ll.prototype.getAvailabilityTimeOffset=Ll.prototype.Qh,Ll.prototype.setAvailabilityTimeOffset=Ll.prototype.jh,Ll.prototype.usingPresentationStartTime=Ll.prototype.uh,Ll.prototype.getSeekRangeEnd=Ll.prototype.Ab,Ll.prototype.getSeekRangeStart=Ll.prototype.Yb,Ll.prototype.getSafeSeekRangeStart=Ll.prototype.ud,Ll.prototype.getSegmentAvailabilityEnd=Ll.prototype.Zb,Ll.prototype.setUserSeekStart=Ll.prototype.qh,Ll.prototype.getSegmentAvailabilityStart=Ll.prototype.nb,Ll.prototype.isInProgress=Ll.prototype.qc,Ll.prototype.isLive=Ll.prototype.V,Ll.prototype.offset=Ll.prototype.offset,Ll.prototype.notifyMaxSegmentDuration=Ll.prototype.Pf,Ll.prototype.notifyMinSegmentStartTime=Ll.prototype.ye,Ll.prototype.getInitialProgramDateTime=Ll.prototype.Wh,Ll.prototype.setInitialProgramDateTime=Ll.prototype.lh,Ll.prototype.isStartTimeLocked=Ll.prototype.zi,Ll.prototype.lockStartTime=Ll.prototype.re,Ll.prototype.getMaxSegmentEndTime=Ll.prototype.$h,Ll.prototype.notifySegments=Ll.prototype.Jd,Ll.prototype.notifyTimeRange=Ll.prototype.$g,Ll.prototype.getDelay=Ll.prototype.Sh,Ll.prototype.setDelay=Ll.prototype.eg,Ll.prototype.getSegmentAvailabilityDuration=Ll.prototype.je,Ll.prototype.setSegmentAvailabilityDuration=Ll.prototype.Ie,Ll.prototype.setStatic=Ll.prototype.wc,Ll.prototype.setClockOffset=Ll.prototype.kh,Ll.prototype.getPresentationStartTime=Ll.prototype.di,Ll.prototype.setDuration=Ll.prototype.$a,Ll.prototype.setPresentationStartTime=Ll.prototype.mh,Ll.prototype.getMaxSegmentDuration=Ll.prototype.Zh,Ll.prototype.getDuration=Ll.prototype.getDuration,Pl.prototype.release=function(){this.j=this.l=null,this.i=function(){}},Ul.prototype.release=function(){this.l&&(this.l.release(),this.l=null),null!=this.m&&(this.m.stop(),this.m=null),this.h&&(this.h.release(),this.h=null),this.g=this.B=this.A=null},Ul.prototype.Sf=function(){this.o=!0,Bl(this)};var jl=new Dt(function(){return new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]])});function Vl(e,t,n,i){var r=this;this.g=e,this.m=t,this.s=n,this.l=null,this.j=function(){return null==r.l&&(r.l=i()),r.l},this.o=!1,this.h=new ae,this.i=new ql(e),Gl(this.g,HTMLMediaElement.HAVE_METADATA,this.h,function(){zl(r,r.j())})}function Hl(e){return e.o?e.g.currentTime:e.j()}function Kl(e,t){0<e.g.readyState?Yl(e.i,t):Gl(e.g,HTMLMediaElement.HAVE_METADATA,e.h,function(){zl(e,e.j())})}function zl(e,t){.001>Math.abs(e.g.currentTime-t)?Zl(e):(e.h.ha(e.g,"seeking",function(){Zl(e)}),Yl(e.i,e.g.currentTime&&0!=e.g.currentTime?e.g.currentTime:t))}function Zl(e){e.o=!0,e.h.D(e.g,"seeking",function(){return e.m()}),e.s(e.g.currentTime)}function ql(e){var t=this;this.h=e,this.m=10,this.l=this.j=this.i=0,this.g=new Ft(function(){0>=t.i?t.g.stop():t.h.currentTime!=t.j?t.g.stop():(t.h.currentTime=t.l,t.i--)})}function Yl(e,t){e.j=e.h.currentTime,e.l=t,e.i=e.m,e.h.currentTime=t,e.g.Sa(.1)}function Wl(e){this.h=e,this.j=!1,this.g=null,this.i=new ae}function $l(e,t,n,i,r,a){var o=this;this.i=e,this.g=t.presentationTimeline,this.B=t.minBufferTime||0,this.l=n,this.A=r,this.s=null,this.o=eu(e,n,a),this.j=new Ul(e,t.presentationTimeline,n,this.o,a),this.h=new Vl(e,function(){e:{var e=o.j;e.j=!0,e.o=!1;var t=Hl(o.h);if(e=Ql(o,t),.001<Math.abs(e-t)){if(t=!1,!qt()||qt()&&nn())t=!0;else{var n=Date.now()/1e3;(!o.s||o.s<n-1)&&(o.s=n,t=!0)}if(t){Kl(o.h,e),e=void 0;break e}}o.A(),e=void 0}return e},function(e){var t=o.j;t.g.seeking&&!t.j&&(t.j=!0,t.i=e)},function(){var e=i;return null==e?e=1/0>o.g.getDuration()?o.g.Yb():o.g.Ab():0>e&&(e=o.g.Ab()+e),Xl(o,Jl(o,e))}),this.m=new Ft(function(){if(0!=o.i.readyState&&!o.i.paused){var e=Hl(o.h),t=o.g.Yb(),n=o.g.Ab();3>n-t&&(t=n-3),e<t&&(e=Ql(o,e),o.i.currentTime=e)}})}function Xl(e,t){var n=e.g.getDuration();return t>=n?n-e.l.durationBackoff:t}function Ql(e,t){var n=Math.max(e.B,e.l.rebufferingGoal),i=e.l.safeSeekOffset,r=e.g.Yb(),a=e.g.Ab(),o=e.g.getDuration();3>a-r&&(r=a-3);var s=e.g.ud(n),l=e.g.ud(i);return n=e.g.ud(n+i),t>=o?Xl(e,t):t>a?a:t<r?rs(e.i.buffered,l)?l:n:t>=s||rs(e.i.buffered,t)?t:n}function Jl(e,t){var n=e.g.Yb();return t<n?n:(e=e.g.Ab(),t>e?e:t)}function eu(e,t,n){if(!t.stallEnabled)return null;var i=t.stallSkip;return t=new Pl(new Ol(e),t.stallThreshold,n),Nl(t,function(){i?e.currentTime+=i:(e.pause(),e.play())}),t}function tu(e){this.O=e,this.l=null,this.i=0,this.m=!1}function nu(e,t,n){return e=new Qo(e,e+t,function(){return n},0,null,null,e,e,e+t),new tu([e])}function iu(e,t,n,i){this.i=e,this.h=t,this.g=n,this.reverse=i}function ru(){tu.call(this,[]),this.g=[]}function au(e){var t=this;this.g=e,this.j=!1,this.i=this.g.ie(),this.h=new Ft(function(){t.g.Yg(.25*t.i)})}function ou(e){e.h.stop();var t=e.j?0:e.i;if(0<=t)try{return void(e.g.ie()!=t&&e.g.hg(t))}catch(e){}e.h.Sa(.25),0!=e.g.ie()&&e.g.hg(0)}function su(e){var t=this;this.h=e,this.g=new Set,this.i=new Ft(function(){lu(t,!1)}).Sa(.25)}function lu(e,t){for(var n=c(e.g),i=n.next();!i.done;i=n.next())i.value.j(e.h.currentTime,t)}function uu(){this.g=null,this.h=[]}function cu(e,t){var n=0;e.g&&e.g.state==t&&(n+=e.g.duration),e=c(e.h);for(var i=e.next();!i.done;i=e.next())i=i.value,n+=i.state==t?i.duration:0;return n}function du(e){function t(e){return{timestamp:e.timestamp,state:e.state,duration:e.duration}}for(var n=[],i=c(e.h),r=i.next();!r.done;r=i.next())n.push(t(r.value));return e.g&&n.push(t(e.g)),n}function fu(){this.i=this.h=null,this.g=[]}function hu(e,t,n){e.i!=t&&(e.i=t,e.g.push({timestamp:Date.now()/1e3,id:t.id,type:"text",fromAdaptation:n,bandwidth:null}))}function pu(){this.ae=this.Ug=this.A=this.B=this.I=this.C=this.s=this.j=this.H=this.m=this.i=this.U=this.Z=this.L=this.N=this.R=this.l=this.o=NaN,this.K=0,this.F=this.G=NaN,this.g=new uu,this.h=new fu}function gu(e,t,n,i){this.m=e,this.i=t,this.l=n,this.h=new Map,this.j=new Map,this.g=null,this.o=i}function mu(e,t){e.l=t,e=c(e.h.values());for(var n=e.next();!n.done;n=e.next())n.value.g=t}function vu(e,t,n){if(n=void 0!==n&&n,e.i.segmentIndex&&(e.g||(e.g=e.i.segmentIndex.Kb(t,!0,e.o)),e.g)){for(n&&e.g.next();e.h.size<e.m;){if(t=e.g.next().value,!t)break;if(n=!0,t.preload&&null!=t.sa&&(n=!1),2==t.ac()&&(n=!1),n&&t.$&&yu(e,t.$),n&&!e.h.has(t)&&(n=new Au(e.l),Iu(n,t,e.i),e.h.set(t,n)),e.i.fastSwitching&&t.Kd&&t.pe)break}Eu(e)}}function yu(e,t){if(e.i.segmentIndex&&!Array.from(e.j.keys()).some(function(e){return Xo(e,t)})){var n=new Au(e.l);Iu(n,t,e.i),e.j.set(t,n)}}function _u(e,t){t=c(t.keys());for(var n=t.next();!n.done;n=t.next())(n=n.value)&&wu(e,n)}function bu(e){_u(e,e.h),_u(e,e.j),e.g=null}function Eu(e){for(var t=Array.from(e.h.keys()),n={},i=c(e.j.keys()),r=i.next();!r.done;n={Vd:n.Vd},r=i.next())n.Vd=r.value,t.some(function(e){return function(t){return Xo(t.$,e.Vd)}}(n))||wu(e,n.Vd)}function Tu(e,t){e.m=t;for(var n=Array.from(e.h.keys());n.length>t;){var i=n.pop();i&&wu(e,i)}Eu(e)}function Su(e,t){t&&t!==e.i&&(bu(e),e.i=t)}function wu(e,t){var n=e.h;t instanceof $o&&(n=e.j),e=n.get(t),n.delete(t),e&&e.abort()}function Au(e){this.g=e,this.Be=this.ig=null}function Iu(e,t,n){var i=new Uint8Array(0);e.Be=e.g(t,n,function(t){return O(function(n){if(1==n.g)return i=0<i.byteLength?In(i,t):t,e.ig?T(n,e.ig(i),3):n.u(0);i=new Uint8Array(0),S(n)})})}function xu(e){Br.call(this);var t=this;this.g=new Set,this.i=e,this.h=new Ft(function(){for(var e=t.i(),n=c(t.g),i=n.next();!i.done;i=n.next())i=i.value,i.endTime<e.start&&(t.g.delete(i),i=new Or("regionremove",new Map([["region",i]])),t.dispatchEvent(i))}).Sa(2)}function Ru(e){Br.call(this),this.g=new Map,this.h=e}function Cu(e,t){var n=e.g.get(t);return n||(n={Md:[],kf:null,contentType:t},e.g.set(t,n)),n}function Du(e,t,n){var i=Cu(e,t.contentType);Mu(e,i),e={Lc:t,position:n},i=i.Md,t=i.findIndex(function(e){return e.position>=n}),0<=t?i.splice(t,i[t].position==n?1:0,e):i.push(e)}function ku(e,t,n){return!!((e=e.h()[n])&&0<e.length&&(n=e[e.length-1].end,t>=e[0].start&&t<n))}function Mu(e,t){if((e=e.h()[t.contentType])&&0<e.length){var n=e[0].start,i=e[e.length-1].end,r=t.Md;t.Md=r.filter(function(e,t){return!(e.position<=n&&t+1<r.length&&r[t+1].position<=n||e.position>=i)})}else t.Md=[]}function Lu(e){var t={bandwidth:e.bandwidth||0,audioSamplingRate:null,codecs:e.codecs,contentType:e.type,frameRate:null,height:null,mimeType:e.mimeType,channelsCount:null,pixelAspectRatio:null,width:null,label:null,roles:e.roles,language:null};return"video"==e.type&&(t.frameRate=e.frameRate||null,t.height=e.height||null,t.pixelAspectRatio=e.pixelAspectRatio||null,t.width=e.width||null),"audio"==e.type&&(t.audioSamplingRate=e.audioSamplingRate,t.channelsCount=e.channelsCount,t.label=e.label||null,t.language=e.language),t}function Pu(e){var t=zn(e),n=t.split("/")[0];return e=Zn(e),{type:n,mimeType:t,codecs:e,language:null,height:null,width:null,channelCount:null,sampleRate:null,closedCaptions:new Map,Qd:null,colorGamut:null}}function Nu(e,t){function n(e){a=e.name;var t=e.reader;t.skip(24);var n=t.ka(),i=t.ka();t.skip(50),h=String(n),f=String(i),e.reader.oa()&&da(e)}function i(e){var t=_s(e.reader);p=t.channelCount,g=t.sampleRate,r(e.name)}function r(e){switch(e=e.toLowerCase(),e){case"avc1":case"avc3":s.push(e+".42E01E"),u=!0;break;case"hev1":case"hvc1":s.push(e+".1.6.L93.90"),u=!0;break;case"dvh1":case"dvhe":s.push(e+".05.04"),u=!0;break;case"vp09":s.push(e+".00.10.08"),u=!0;break;case"av01":s.push(e+".0.01M.08"),u=!0;break;case"mp4a":o.push("mp4a.40.2"),l=!0;break;case"ac-3":case"ec-3":case"ac-4":case"opus":case"flac":o.push(e),l=!0}}var a,o=[],s=[],l=!1,u=!1,d=null,f=null,h=null,p=null,g=null,m=null,v=null;if((new ca).box("moov",da).box("trak",da).box("mdia",da).S("mdhd",function(e){d=vs(e.reader,e.version).language}).box("minf",da).box("stbl",da).S("stsd",fa).box("mp4a",function(e){var t=_s(e.reader);p=t.channelCount,g=t.sampleRate,e.reader.oa()?da(e):r(e.name)}).box("esds",function(e){e=e.reader;for(var t,n,i="mp4a";e.oa();){t=e.T();for(var r=e.T();128&r;)r=e.T();if(3==t)e.ka(),r=e.T(),128&r&&e.ka(),64&r&&e.skip(e.T()),32&r&&e.ka();else if(4==t)n=e.T(),e.skip(12);else if(5==t)break}n&&(i+="."+Ts(n),5==t&&e.oa()&&(t=e.T(),n=(248&t)>>3,31===n&&e.oa()&&(n=32+((7&t)<<3)+((224&e.T())>>5)),i+="."+n)),o.push(i),l=!0}).box("ac-3",i).box("ec-3",i).box("ac-4",i).box("Opus",i).box("fLaC",i).box("avc1",n).box("avc3",n).box("hev1",n).box("hvc1",n).box("dva1",n).box("dvav",n).box("dvh1",n).box("dvhe",n).box("vp09",n).box("av01",n).box("avcC",function(e){var t=a||"";switch(a){case"dvav":t="avc3";break;case"dva1":t="avc1"}e=e.reader,e.skip(1),e=t+"."+Ts(e.T())+Ts(e.T())+Ts(e.T()),s.push(e),u=!0}).box("hvcC",function(e){var t=a||"";switch(a){case"dvh1":t="hvc1";break;case"dvhe":t="hev1"}var n=e.reader;n.skip(1),e=n.T();var i=["","A","B","C"][e>>6],r=31&e,o=n.P(),l=(32&e)>>5?"H":"L";e=[n.T(),n.T(),n.T(),n.T(),n.T(),n.T()],n=n.T();for(var c=0,d=0;32>d;d++){if(c|=1&o,31==d)break;c<<=1,o>>=1}for(t=t+"."+i+r+"."+Ts(c,!0),t+="."+l+n,i="",r=e.length;r--;)((l=e[r])||i)&&(i="."+l.toString(16).toUpperCase()+i);t+=i,s.push(t),u=!0}).box("dvcC",function(e){var t=a||"";switch(a){case"hvc1":t="dvh1";break;case"hev1":t="dvhe";break;case"avc1":t="dva1";break;case"avc3":t="dvav";break;case"av01":t="dav1"}var n=e.reader;n.skip(2),e=n.T(),n=n.T(),s.push(t+"."+Ss(e>>1&127)+"."+Ss(e<<5&32|n>>3&31)),u=!0}).box("dvvC",function(e){var t=a||"";switch(a){case"hvc1":t="dvh1";break;case"hev1":t="dvhe";break;case"avc1":t="dva1";break;case"avc3":t="dvav";break;case"av01":t="dav1"}var n=e.reader;n.skip(2),e=n.T(),n=n.T(),s.push(t+"."+Ss(e>>1&127)+"."+Ss(e<<5&32|n>>3&31)),u=!0}).S("vpcC",function(e){var t=a||"",n=e.reader;e=n.T();var i=n.T();n=n.T()>>4&15,s.push(t+"."+Ss(e)+"."+Ss(i)+"."+Ss(n)),u=!0}).box("av1C",function(e){var t=a||"";switch(a){case"dav1":t="av01"}var n=e.reader;n.skip(1),e=n.T(),n=n.T();var i=e>>>5,r=(64&n)>>6;s.push(t+"."+i+"."+Ss(31&e)+(n>>>7?"H":"M")+"."+Ss(2===i&&r?(32&n)>>5?12:10:r?10:8)+"."+((16&n)>>4)+"."+((8&n)>>3)+((4&n)>>2)+(3&n)+"."+Ss(1)+"."+Ss(1)+"."+Ss(1)+".0"),u=!0}).box("enca",pa).box("encv",ha).box("sinf",da).box("frma",function(e){e=bs(e.reader).Na,r(e)}).box("colr",function(e){s=s.map(function(t){if(t.startsWith("av01.")){var n=e.reader,i=n.ua(),r=n.rb(4),a=String.fromCharCode(r[0]);if(a+=String.fromCharCode(r[1]),a+=String.fromCharCode(r[2]),a+=String.fromCharCode(r[3]),"nclx"===a){r=n.ka(),a=n.ka();var o=n.ka(),s=n.T()>>7,l=t.split(".");10==l.length&&(l[6]=Ss(r),l[7]=Ss(a),l[8]=Ss(o),l[9]=String(s),t=l.join("."))}n.seek(i)}return t});var t=Es(e.reader),n=t.colorGamut;m=t.Qd,v=n}).parse(e||t,!0),!o.length&&!s.length)return null;var y=l&&!u,_=new Map;if(u){var b=new Ce("video/mp4");for(e&&b.init(e),b.i(t),e=c(b.j()),t=e.next();!t.done;t=e.next())t=t.value,_.set(t,t);b.g()}return{type:y?"audio":"video",mimeType:y?"audio/mp4":"video/mp4",codecs:Ou(o.concat(s)).join(", "),language:d,height:f,width:h,channelCount:p,sampleRate:g,closedCaptions:_,Qd:m,colorGamut:v}}function Ou(e){var t=new Set,n=[];e=c(e);for(var i=e.next();!i.done;i=e.next()){i=i.value;var r=Kn(i);t.has(r)||(n.push(i),t.add(r))}return t=Mn("audio",n),i=Mn("video",n),e=Mn(Ln,n),i=Fu(i),t=t.concat(i).concat(e),n.length&&!t.length?n:t}function Fu(e){if(1>=e.length)return e;var t=e.find(function(e){return e.startsWith("dvh1.")||e.startsWith("dvhe.")||e.startsWith("dav1.")});return t?ce('video/mp4; codecs="'+t+'"')?[t]:e.filter(function(e){return e!=t}):e}function Uu(e){var t=null;return(new ca).box("moov",da).box("trak",da).box("mdia",da).box("minf",da).box("stbl",da).S("stsd",fa).box("encv",ha).box("enca",pa).box("sinf",da).box("schi",da).S("tenc",function(e){e=e.reader,e.T(),e.T(),e.T(),e.T(),t=An(e.rb(16))}).parse(e,!0),t}function Bu(t,n,i){var r,a,o,s,l;return O(function(u){if(1==u.g)return r=n,r.cryptoKey?u.u(2):T(u,r.fetchKey(),3);if(a=r.iv,!a)for(a=we(new ArrayBuffer(16)),o=r.firstMediaSequenceNumber+i,s=a.byteLength-1;0<=s;s--)a[s]=255&o,o>>=8;return l="CBC"==n.blockCipherMode?{name:"AES-CBC",iv:a}:{name:"AES-CTR",counter:a,length:64},u.return(e.crypto.subtle.decrypt(l,r.cryptoKey,t))})}function Gu(e,t,n,i,r){return e=zr(e,i,r),0==t&&null==n||(e.headers.Range=n?"bytes="+t+"-"+n:"bytes="+t+"-"),e}function ju(e,t){var n=this;this.g=t,this.l=e,this.h=null,this.B=1,this.s=this.j=null,this.H=0,this.F=!1,this.i=new Map,this.C=!1,this.I=null,this.A=!1,this.m=new ta(function(){return Vu(n)}),this.K=Date.now()/1e3,this.o=new Map,this.G={projection:null,hfov:null},this.N=0,this.L=1/0}function Vu(e){var t,n,i,r,a,o,s;return O(function(l){if(1==l.g){for(t=[],n=c(e.i.values()),i=n.next();!i.done;i=n.next())r=i.value,vc(r),t.push(yc(r)),r.W&&(bu(r.W),r.W=null);for(a=c(e.o.values()),o=a.next();!o.done;o=a.next())s=o.value,bu(s);return T(l,Promise.all(t),2)}e.i.clear(),e.o.clear(),e.g=null,e.l=null,e.h=null,S(l)})}function Hu(e,t,n){e.l.presentationTimeline.V()||(e.N=t,e.L=n)}function Ku(e,t){var n,i,r,a,o,s;O(function(l){switch(l.g){case 1:return n=Pn,e.H++,i=e.H,w(l,2),T(l,pl(e.g.ca,n.ta),4);case 4:I(l,3);break;case 2:r=x(l),e.g&&e.g.onError(r);case 3:a=Un(t.mimeType,t.codecs),rl(e.g.ca,a,e.l.sequenceMode,t.external),o=e.g.ca.F,(o.isTextVisible()||e.h.alwaysStreamText)&&e.H==i&&(s=Ju(e,t),e.i.set(n.ta,s),mc(e,s,0)),S(l)}})}function zu(e){var t=e.i.get(Ln);t&&(vc(t),yc(t).catch(function(){}),e.i.delete(Ln)),e.s=null}function Zu(e,t){for(var n=0>e.g.fb(),i=c(e.i.values()),r=i.next();!r.done;r=i.next())r=r.value,r.ia&&r.ia.Uc(n),r.W&&r.W.Uc(n);for(i=c(e.o.values()),r=i.next();!r.done;r=i.next())r.value.Uc(n);(n=e.i.get("video"))&&(i=n.stream)&&(t?(t=i.trickModeVideo)&&!n.vc&&(Wu(e,t,!1,0,!1),n.vc=i):(t=n.vc)&&(n.vc=null,Wu(e,t,!0,0,!1)))}function qu(e,t,n,i,r,a){n=void 0!==n&&n,i=void 0===i?0:i,r=void 0!==r&&r,a=void 0!==a&&a,e.j=t,e.C&&(t.video&&Wu(e,t.video,n,i,r,a),t.audio&&Wu(e,t.audio,n,i,r,a))}function Yu(e,t){O(function(n){if(1==n.g)return e.s=t,e.C?t.segmentIndex?n.u(2):T(n,t.createSegmentIndex(),2):n.return();Wu(e,t,!0,0,!1),S(n)})}function Wu(e,t,n,i,r,a){var o=e.i.get(t.type);o||t.type!=Ln?o&&(o.vc&&(t.trickModeVideo?(o.vc=t,t=t.trickModeVideo):o.vc=null),o.stream!=t||r)&&(e.o.has(t)?o.W=e.o.get(t):o.W&&Su(o.W,t),t.type==Ln&&(r=Un(t.mimeType,t.codecs),rl(e.g.ca,r,e.l.sequenceMode,t.external)),e.o.has(o.stream)||o.stream.closeSegmentIndex&&o.stream.closeSegmentIndex(),o.stream=t,o.ia=null,o.wg=!!a,n?o.nd?o.Oe=!0:o.Qa?(o.ec=!0,o.ee=i,o.Oe=!0):(vc(o),gc(e,o,!0,i).catch(function(t){e.g&&e.g.onError(t)})):o.Qa||o.ub||mc(e,o,0),$u(e,o).catch(function(t){e.g&&e.g.onError(t)})):Ku(e,t)}function $u(e,t){var n,i;return O(function(r){if(1==r.g)return t.kb?(n=t.stream,i=t.kb,n.segmentIndex?r.u(2):T(r,n.createSegmentIndex(),2)):r.return();if(t.kb!=i||t.stream!=n)return r.return();var a=e.g.he(),o=sl(e.g.ca,t.type),s=t.stream.segmentIndex.find(t.Ya?t.Ya.endTime:a),l=null==s?null:t.stream.segmentIndex.get(s);s=l&&l.sa?l.sa-l.Ha:null,l&&!s&&(s=(l.endTime-l.getStartTime())*(t.stream.bandwidth||0)/8),s?((l=l.$)&&(s+=(l.sa?l.sa-l.Ha:null)||0),l=e.g.getBandwidthEstimate(),a=8*s/l<(o||0)-a-Math.max(e.l.minBufferTime||0,e.h.rebufferingGoal)||t.kb.h.g>s):a=!1,a&&t.kb.abort(),S(r)})}function Xu(e,t){t.nd||t.ec||(t.Qa?(t.ec=!0,t.ee=0):null==ol(e.g.ca,t.type)?null==t.ub&&mc(e,t,0):(vc(t),gc(e,t,!1,0).catch(function(t){e.g&&e.g.onError(t)})))}function Qu(e,t){var n,i,r,a,o,s,l,u,d,f;return O(function(h){if(1==h.g){if(n=Pn,!e.j)throw new Rt(2,5,5006);return i=new Map,r=new Set,e.j.audio&&(i.set(n.X,e.j.audio),r.add(e.j.audio)),e.j.video&&(i.set(n.ga,e.j.video),r.add(e.j.video)),e.s&&(i.set(n.ta,e.s),r.add(e.s)),a=e.g.ca,T(h,a.init(i,e.l.sequenceMode,e.l.type,e.l.ignoreManifestTimestampsInSegmentsMode),2)}for(na(e.m),e.updateDuration(),o=c(i.keys()),s=o.next();!s.done;s=o.next())l=s.value,u=i.get(l),e.i.has(l)||(d=Ju(e,u),t.has(u.id)&&(f=t.get(u.id),mu(f,function(t,n,i){return pc(t,n,i||null,e.h.retryParameters,e.g.Nb)}),d.W=f),e.i.set(l,d),mc(e,d,0));S(h)})}function Ju(e,t){return{stream:t,type:t.type,ia:null,W:ec(e,t),Ya:null,Kc:null,qe:null,oe:null,ne:null,vc:null,endOfStream:!1,Qa:!1,ub:null,ec:!1,ee:0,Oe:!1,nd:!1,Nd:!0,Yf:!1,yd:!1,kb:null}}function ec(e,t){if("video"===t.type&&e.h.disableVideoPrefetch||"audio"===t.type&&e.h.disableAudioPrefetch||t.type===Ln&&("application/cea-608"==t.mimeType||"application/cea-708"==t.mimeType)||t.type===Ln&&e.h.disableTextPrefetch)return null;if(e.o.has(t))return e.o.get(t);var n=e.i.get(t.type);return(n=n&&n.W)&&t===n.i?n:0<e.h.segmentPrefetchLimit?new gu(e.h.segmentPrefetchLimit,t,function(t,n,i){return pc(t,n,i||null,e.h.retryParameters,e.g.Nb)},0>e.g.fb()):null}function tc(e){for(var t=e.h.segmentPrefetchLimit,n=e.h.prefetchAudioLanguages,i={},r=c(e.l.variants),a=r.next();!a.done;i={Ta:i.Ta},a=r.next())if(i.Ta=a.value,i.Ta.audio)if(e.o.has(i.Ta.audio)){if(a=e.o.get(i.Ta.audio),Tu(a,t),!(0<t&&n.some(function(e){return function(t){return ui(e.Ta.audio.language,t)}}(i)))){var o=e.i.get(i.Ta.audio.type);a!==(o&&o.W)&&bu(a),e.o.delete(i.Ta.audio)}}else 0>=t||!n.some(function(e){return function(t){return ui(e.Ta.audio.language,t)}}(i))||!(a=ec(e,i.Ta.audio))||(i.Ta.audio.segmentIndex||i.Ta.audio.createSegmentIndex(),e.o.set(i.Ta.audio,a))}function nc(e,t){var n,i,r,a,o,s;return O(function(l){switch(l.g){case 1:if(na(e.m),t.Qa||null==t.ub||t.nd)return l.return();if(t.ub=null,!t.ec){l.u(2);break}return T(l,gc(e,t,t.Oe,t.ee),3);case 3:return l.return();case 2:if(t.stream.segmentIndex){l.u(4);break}return n=t.stream,w(l,5),T(l,t.stream.createSegmentIndex(),7);case 7:I(l,6);break;case 5:return i=x(l),T(l,_c(e,t,i),8);case 8:return l.return();case 6:if(n!=t.stream)return n.closeSegmentIndex&&n.closeSegmentIndex(),t.Qa||t.ub||mc(e,t,0),l.return();case 4:w(l,9),r=ic(e,t),null!=r&&(mc(e,t,r),t.yd=!1),I(l,10);break;case 9:return a=x(l),T(l,_c(e,t,a),11);case 11:return l.return();case 10:if(o=Array.from(e.i.values()),!e.C||!o.every(function(e){return e.endOfStream})){l.u(0);break}return T(l,e.g.ca.endOfStream(),13);case 13:na(e.m),s=e.g.ca.getDuration(),0!=s&&s<e.l.presentationTimeline.getDuration()&&e.l.presentationTimeline.$a(s),S(l)}})}function ic(e,t){if(fc(t))return fl(e.g.ca,t.stream.originalId||""),null;if(t.type==Ln&&hl(e.g.ca),!e.g.ca.xa&&t.type!=Ln)return e.h.updateIntervalSeconds/2;var n=e.g.he();if("audio"===t.type)for(var i=c(e.o.keys()),r=i.next();!r.done;r=i.next())r=e.o.get(r.value),r.Oa(n,!0),vu(r,n);i=t.Ya?t.Ya.endTime:n,r=ll(e.g.ca,t.type,n);var a=Math.max(1,Math.max(e.l.minBufferTime||0,e.h.rebufferingGoal,e.h.bufferingGoal)*e.B),o=e.l.presentationTimeline.getDuration()-i,s=sl(e.g.ca,t.type);if(1e-6>o&&s)return t.endOfStream=!0,"video"==t.type&&(e=e.i.get(Ln))&&fc(e)&&(e.endOfStream=!0),null;if(t.endOfStream=!1,r>=a)return e.h.updateIntervalSeconds/2;if(r=rc(e,t,n,s),!r)return e.h.updateIntervalSeconds;for(a=1/0,o=Array.from(e.i.values()),o=c(o),s=o.next();!s.done;s=o.next())s=s.value,fc(s)||s.ia&&!s.ia.current()||(a=Math.min(a,s.Ya?s.Ya.endTime:n));return i>=a+e.l.presentationTimeline.g?e.h.updateIntervalSeconds:(t.W&&t.ia&&!e.o.has(t.stream)&&(t.W.Oa(r.startTime),vu(t.W,r.startTime)),ac(e,t,n,r).catch(function(){}),null)}function rc(e,t,n,i){if(t.ia)return t.ia.current();if(t.Ya||i)return t.ia=t.stream.segmentIndex.Kb(t.Ya?t.Ya.endTime:i,!1,0>e.g.fb()),t.ia&&t.ia.next().value;i=e.h.inaccurateManifestTolerance;var r=Math.max(n-i,0);e=0>e.g.fb();var a=null;return i&&(t.ia=t.stream.segmentIndex.Kb(r,!1,e),a=t.ia&&t.ia.next().value),a||(t.ia=t.stream.segmentIndex.Kb(n,!1,e),a=t.ia&&t.ia.next().value),a}function ac(t,n,i,r){var a,o,s,l,u,c,d,f,h,p,g,m,v,y,_,b;return O(function(E){switch(E.g){case 1:if(a=Pn,o=n.stream,s=n.ia,n.Qa=!0,w(E,2),2==r.ac())throw new Rt(1,1,1011);return T(E,lc(t,n,r),4);case 4:return na(t.m),t.A?E.return():(l="video/mp4"==o.mimeType||"audio/mp4"==o.mimeType,u=e.ReadableStream,t.h.lowLatencyMode&&t.l.isLowLatency&&u&&l&&("HLS"!=t.l.type||r.m)?(f=new Uint8Array(0),p=h=!1,m=function(e){var a,s,l;return O(function(u){switch(u.g){case 1:if(h)return u.return();if(p=!0,na(t.m),t.A)return u.return();if(w(u,2),f=oc(f,e),a=!1,s=0,(new ca).box("mdat",function(e){s=e.size+e.start,a=!0}).parse(f,!1,!0),!a){u.u(4);break}return l=f.subarray(0,s),f=f.subarray(s),T(u,cc(t,n,i,o,r,l,!0),5);case 5:n.W&&n.ia&&vu(n.W,r.startTime,!0);case 4:I(u,0);break;case 2:g=x(u),S(u)}})},T(E,hc(t,n,r,m),9)):(c=hc(t,n,r),T(E,c,7)));case 7:return d=E.h,na(t.m),t.A?E.return():(na(t.m),n.ec?(n.Qa=!1,mc(t,n,0),E.return()):T(E,cc(t,n,i,o,r,d),6));case 9:if(v=E.h,g)throw g;if(p){E.u(10);break}return h=!0,na(t.m),t.A?E.return():n.ec?(n.Qa=!1,mc(t,n,0),E.return()):T(E,cc(t,n,i,o,r,v),10);case 10:n.W&&n.ia&&vu(n.W,r.startTime,!0);case 6:if(na(t.m),t.A)return E.return();n.Ya=r,s.next(),n.Qa=!1,n.Yf=!1,y=t.g.ca.yb(),_=y[n.type],te(JSON.stringify(_)),n.ec||t.g.Sf(r,n.stream),mc(t,n,0),I(E,0);break;case 2:if(b=x(E),na(t.m,b),t.A)return E.return();if(n.Qa=!1,7001==b.code)n.Qa=!1,vc(n),mc(t,n,0),E.u(0);else if(n.type==a.ta&&t.h.ignoreTextStreamFailures)t.i.delete(a.ta),E.u(0);else{if(3017!=b.code)return n.yd=!0,1==b.category&&n.W&&wu(n.W,r),b.severity=2,T(E,_c(t,n,b),0);sc(t,n,b),E.u(0)}}})}function oc(e,t){var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function sc(e,t,n){if(!Array.from(e.i.values()).some(function(e){return e!=t&&e.Yf})){if(e.g.disableStream(t.stream,e.h.maxDisabledTime))return;var i=Math.round(100*e.B);if(20<i)e.B-=.2;else{if(!(4<i))return t.yd=!0,e.A=!0,void e.g.onError(n);e.B-=.04}t.Yf=!0}mc(e,t,4)}function lc(e,t,n){var i,r,a,o,s,l,u,c,d,f,h,p;return O(function(g){switch(g.g){case 1:if(i=Pn,r=[],a=Math.max(0,Math.max(n.appendWindowStart,e.N)-.1),o=Math.min(n.appendWindowEnd,e.L)+.01,s=Kn(n.codecs||t.stream.codecs),l=zn(n.mimeType||t.stream.mimeType),u=n.timestampOffset,u==t.qe&&a==t.oe&&o==t.ne&&s==t.Lf&&l==t.Mf){g.u(2);break}if(c=t.Lf&&t.Mf&&Dl(e.g.ca,t.type,l,s),!c){g.u(3);break}if(d=null,t.type===i.ga?d=e.i.get(i.X):t.type===i.X&&(d=e.i.get(i.ga)),!d){g.u(3);break}return T(g,yc(d).catch(function(){}),5);case 5:d.Kc=null,Xu(e,d);case 3:return T(g,uc(e,t,u,a,o,n,s,l),2);case 2:return Xo(n.$,t.Kc)||(t.Kc=n.$,n.l&&n.$&&(f=hc(e,t,n.$),h=function(){var r,a,o,s,l,u,c;return O(function(d){switch(d.g){case 1:return w(d,2),T(d,f,4);case 4:return r=d.h,na(e.m),a=null,o=new Map,s={projection:null,hfov:null},l=new ca,l.box("moov",da).box("trak",da).box("mdia",da).S("mdhd",function(e){a=vs(e.reader,e.version).timescale}).box("hdlr",function(e){switch(e=e.reader,e.skip(8),e.tc()){case"soun":o.set(i.X,a);break;case"vide":o.set(i.ga,a)}a=null}).box("minf",da).box("stbl",da).S("stsd",fa).box("encv",ha).box("avc1",ha).box("avc3",ha).box("hev1",ha).box("hvc1",ha).box("dvav",ha).box("dva1",ha).box("dvh1",ha).box("dvhe",ha).box("vexu",da).box("proj",da).S("prji",function(e){e=e.reader.tc(),s.projection=e}).box("hfov",function(e){e=e.reader.P()/1e3,s.hfov=e}).parse(r),Ec(e,s),o.has(t.type)?n.$.timescale=o.get(t.type):null!=a&&(n.$.timescale=a),u=t.stream.closedCaptions&&0<t.stream.closedCaptions.size,T(d,e.g.yg(t.type,r),5);case 5:return T(d,dl(e.g.ca,t.type,r,null,t.stream,u),6);case 6:I(d,0);break;case 2:throw c=x(d),t.Kc=null,c}})},e.g.Hi(n.startTime,n.$),r.push(h()))),e.l.sequenceMode&&(p=t.Ya?t.Ya.i:null,n.i!=p&&r.push(ml(e.g.ca,t.type,n.startTime))),T(g,Promise.all(r),0)}})}function uc(e,t,n,i,r,a,o,s){var l,u,c,d;return O(function(f){if(1==f.g)return l=Pn,u=new Map,e.j.audio&&u.set(l.X,e.j.audio),e.j.video&&u.set(l.ga,e.j.video),w(f,2),t.oe=i,t.ne=r,o&&(t.Lf=o),s&&(t.Mf=s),t.qe=n,c=e.l.sequenceMode||"HLS"==e.l.type,T(f,gl(e.g.ca,t.type,n,i,r,c,a.mimeType||t.stream.mimeType,a.codecs||t.stream.codecs,u),4);if(2!=f.g)return I(f,0);throw d=x(f),t.oe=null,t.ne=null,t.Lf=null,t.Mf=null,t.qe=null,d})}function cc(e,t,n,i,r,a,o){var s,l,u,c,d,f,h,p,g;return o=void 0!==o&&o,O(function(m){switch(m.g){case 1:return s=i.closedCaptions&&0<i.closedCaptions.size,u=null!=i.emsgSchemeIdUris&&0<i.emsgSchemeIdUris.length||e.h.dispatchAllEmsgBoxes,c=e.h.parsePrftBox&&!e.F,d="video/mp4"==i.mimeType||"audio/mp4"==i.mimeType,f=null,r.$&&(f=r.$.timescale),h=d&&f&&"video"===i.type&&"DASH"==e.l.type&&e.h.shouldFixTimestampOffset,(u||c||h)&&(l=new ca),u&&l.S("emsg",function(t){var n=i.emsgSchemeIdUris;if(0===t.version)var a=t.reader.tc(),o=t.reader.tc(),s=t.reader.P(),l=t.reader.P(),u=t.reader.P(),c=t.reader.P(),d=r.startTime+l/s;else s=t.reader.P(),d=t.reader.Qc()/s+r.timestampOffset,l=d-r.startTime,u=t.reader.P(),c=t.reader.P(),a=t.reader.tc(),o=t.reader.tc();t=t.reader.rb(t.reader.getLength()-t.reader.ua()),(n&&n.includes(a)||e.h.dispatchAllEmsgBoxes)&&("urn:mpeg:dash:event:2012"==a?e.g.Ii():(n=d+u/s,s=(new Map).set("detail",{startTime:d,endTime:n,schemeIdUri:a,value:o,timescale:s,presentationTimeDelta:l,eventDuration:u,id:c,messageData:t}),s=new Or("emsg",s),s.cancelable=!0,e.g.onEvent(s),s.defaultPrevented||"https://aomedia.org/emsg/ID3"!=a&&"https://developer.apple.com/streaming/emsg-id3"!=a||(a=hs(t),!a.length)||e.g.onMetadata([{cueTime:d,data:t,frames:a,dts:d,pts:d}],0,n)))}),c&&l.S("prft",function(t){if(!e.F&&r.$.timescale){var n=t.reader,i=t.version;n.P(),t=n.P();var a=n.P();t=1e3*t+a/Math.pow(2,32)*1e3,0===i?n=n.P():(i=n.P(),n=n.P(),n=i*Math.pow(2,32)+n),t=new Date(new Date(Date.UTC(1900,0,1,0,0,0)).getTime()+t).getTime(),n=(new Map).set("detail",{wallClockTime:t,programStartDate:new Date(t-n/r.$.timescale*1e3)}),n=new Or("prft",n),e.g.onEvent(n),e.F=!0}}),h&&l.box("moof",da).box("traf",da).S("tfdt",function(n){var i,a,o,s,l,u;return O(function(c){return i=ms(n.reader,n.version),a=i.baseMediaDecodeTime,a?(o=-a/f,s=Number(t.qe)||0,s<o?(l=t.oe,u=t.ne,T(c,uc(e,t,o,l,u,r),0)):c.u(0)):c.return()})}),(u||c||h)&&l.parse(a,!1,o),T(m,dc(e,t,n),2);case 2:return na(e.m),p=t.Nd,t.Nd=!1,g=t.wg,t.wg=!1,T(m,e.g.yg(t.type,a),3);case 3:return T(m,dl(e.g.ca,t.type,a,r,i,s,p,g,o),4);case 4:na(e.m),S(m)}})}function dc(e,t,n){var i,r,a,o;return O(function(s){if(1==s.g)return i=Math.max(e.h.bufferBehind,e.l.presentationTimeline.g),r=ol(e.g.ca,t.type),null==r?s.return():(a=n-r,o=a-i,o<=e.h.evictionGoal?s.return():T(s,e.g.ca.remove(t.type,r,r+o),2));na(e.m),S(s)})}function fc(e){return e&&e.type==Ln&&("application/cea-608"==e.stream.mimeType||"application/cea-708"==e.stream.mimeType)}function hc(e,t,n,i){var r,a,o,s,l;return O(function(u){switch(u.g){case 1:if(r=n.vd())return u.return(r);if(a=null,t.W){var c=t.W,d=c.h;n instanceof $o&&(d=c.j),d.has(n)?(c=d.get(n),i&&(c.ig=i),a=c.Be):a=null}return a||(a=pc(n,t.stream,i||null,e.h.retryParameters,e.g.Nb)),o=0,t.ia&&(o=t.ia.h),t.kb=a,T(u,a.promise,2);case 2:if(s=u.h,t.kb=null,l=s.data,!n.aesKey){u.u(3);break}return T(u,Bu(l,n.aesKey,o),4);case 4:l=u.h;case 3:return u.return(l)}})}function pc(e,t,n,i,r){var a=e instanceof Qo?e:void 0,o=a?1:0;return e=Gu(e.M(),e.Ha,e.sa,i,n),e.contentType=t.type,r.request(Qr,e,{type:o,stream:t,segment:a})}function gc(e,t,n,i){var r,a;return O(function(o){return 1==o.g?(t.ec=!1,t.Oe=!1,t.ee=0,t.nd=!0,t.Ya=null,t.ia=null,t.W&&!e.o.has(t.stream)&&bu(t.W),i?(r=e.g.he(),a=e.g.ca.getDuration(),T(o,e.g.ca.remove(t.type,r+i,a),3)):T(o,pl(e.g.ca,t.type),4)):3!=o.g?(na(e.m),n?T(o,e.g.ca.flush(t.type),3):o.u(3)):(na(e.m),t.nd=!1,t.endOfStream=!1,t.Qa||t.ub||mc(e,t,0),void S(o))})}function mc(e,t,n){var i=t.type;(i!=Ln||e.i.has(i))&&(t.ub=new Ot(function(){var n;return O(function(i){return 1==i.g?(w(i,2),T(i,nc(e,t),4)):2!=i.g?I(i,0):(n=x(i),e.g&&e.g.onError(n),void S(i))})}).Y(n))}function vc(e){null!=e.ub&&(e.ub.stop(),e.ub=null)}function yc(e){return O(function(t){return e.kb?T(t,e.kb.abort(),0):t.u(0)})}function _c(e,t,n){var i;return O(function(r){if(1==r.g)return T(r,Ir(e.I),2);na(e.m),1===n.category&&(i=0===e.h.maxDisabledTime&&1011==n.code?1:e.h.maxDisabledTime,n.handled=e.g.disableStream(t.stream,i),n.handled&&(n.severity=1)),n.handled&&1011==n.code||e.g.onError(n),n.handled||e.h.failureCallback(n),S(r)})}function bc(e){var t,n,i,r,a,o;return O(function(s){return 1==s.g?(t=Date.now()/1e3,n=e.h.minTimeBetweenRecoveries,!e.h.allowMediaSourceRecoveries||t-e.K<n?s.return(!1):(e.K=t,i=Pn,(r=e.i.get(i.X))&&(r.Kc=null,Xu(e,r),yc(r).catch(function(){})),(a=e.i.get(i.ga))&&(a.Kc=null,Xu(e,a),yc(a).catch(function(){})),o=new Map,e.j.audio&&o.set(i.X,e.j.audio),e.j.video&&o.set(i.ga,e.j.video),T(s,Rl(e.g.ca,o),2))):s.return(!0)})}function Ec(e,t){if(e.G.projection!=t.projection||e.G.hfov!=t.hfov){if(null!=t.projection||null!=t.hfov){var n=(new Map).set("detail",t);n=new Or("spatialvideoinfo",n)}else n=new Or("nospatialvideoinfo");n.cancelable=!0,e.g.onEvent(n),e.G=t}}function Tc(){}function Sc(e,t,n,i,r){var a,o=r in i,s=o?n.constructor==Object&&0==Object.keys(i).length:n.constructor==Object&&0==Object.keys(n).length,l=o||s,u=!0;for(a in t){var c=r+"."+a,d=o?i[r]:n[a];l||a in n?void 0===t[a]?void 0===d||l?delete e[a]:e[a]=yi(d):s?e[a]=t[a]:d.constructor==Object&&t[a]&&t[a].constructor==Object?(e[a]||(e[a]=yi(d)),c=Sc(e[a],t[a],d,i,c),u=u&&c):typeof t[a]!=typeof d||null==t[a]||"function"!=typeof t[a]&&t[a].constructor!=d.constructor?(X("Invalid config, wrong type for "+c),u=!1):("function"==typeof n[a]&&n[a].length!=t[a].length&&Q("Unexpected number of arguments for "+c),e[a]=t[a]):(X("Invalid config, unrecognized key "+c),u=!1)}return u}function wc(e,t){for(var n={},i=n,r=0,a=0;;){if(r=e.indexOf(".",r),0>r)break;0!=r&&"\\"==e[r-1]||(a=e.substring(a,r).replace(/\\\./g,"."),i[a]={},i=i[a],a=r+1),r+=1}return i[e.substring(a).replace(/\\\./g,".")]=t,n}function Ac(e,t){return e&&t}function Ic(e,t){function n(e){for(var t=c(Object.keys(e)),i=t.next();!i.done;i=t.next())i=i.value,a(e[i])&&0===Object.keys(e[i]).length?delete e[i]:r(e[i])?delete e[i]:"function"==typeof e[i]?delete e[i]:a(e[i])&&(n(e[i]),0===Object.keys(e[i]).length&&delete e[i])}function i(e,t){return Object.keys(e).reduce(function(n,o){var s=e[o];return t.hasOwnProperty(o)?a(s)&&a(t[o])?(s=i(s,t[o]),(0<Object.keys(s).length||!a(s))&&(n[o]=s)):r(s)&&r(t[o])||Number.isNaN(s)&&Number.isNaN(t[o])||s!==t[o]&&(n[o]=s):n[o]=s,n},{})}function r(e){return Array.isArray(e)&&0===e.length}function a(e){return e&&"object"===typeof e&&!Array.isArray(e)}return e=i(e,t),n(e),e}function xc(){}function Rc(e){return e=pn(e),new ft(e).Gb}function Cc(e,t,n){function i(e){Ie(a).setUint32(o,e.byteLength,!0),o+=4,a.set(we(e),o),o+=e.byteLength}if(!n||!n.byteLength)throw new Rt(2,6,6015);var r;r="string"==typeof t?mn(t,!0):t,e=pn(e),e=mn(e,!0);var a=new Uint8Array(12+e.byteLength+r.byteLength+n.byteLength),o=0;return i(e),i(r),i(n),a}function Dc(e,t,n){return"skd"!==t?e:(t=n.serverCertificate,n=pn(e).split("skd://").pop(),Cc(e,n,t))}function kc(e,t){2===e&&(t.headers["Content-Type"]="application/octet-stream")}function Mc(){}function Lc(){var e=1/0;navigator.connection&&navigator.connection.saveData&&(e=360);var t={retryParameters:xr(),servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,persistentSessionOnlinePlayback:!1,persistentSessionsMetadata:[],initDataTransform:function(e,t,n){return sn()&&"skd"==t&&(t=n.serverCertificate,n=Rc(e),e=Cc(e,n,t)),e},logLicenseExchange:!1,updateExpirationTime:1,preferredKeySystems:[],keySystemsMapping:{},parseInbandPsshEnabled:jt(),minHdcpVersion:"",ignoreDuplicateInitData:!Kt()};(jt()||Xt())&&t.preferredKeySystems.push("com.microsoft.playready");var n="reload",i=!1;Kt()||Ht()||an("Tizen 4")||an("Tizen 5")||an("Tizen 6")||Zt()||zt()&&53===Yt()||zt()&&68===Yt()||!(!qt()||qt()&&nn()||qt()&&an("Fuchsia"))||tn()&&Gt()||(n="smooth",i=!0),i={retryParameters:xr(),availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,disableThumbnails:!1,defaultPresentationDelay:0,segmentRelativeVttTiming:!1,raiseFatalErrorOnManifestUpdateRequestFailure:!1,continueLoadingWhenPaused:!0,dash:{clockSyncUri:"",ignoreDrmInfo:!1,disableXlinkProcessing:!1,xlinkFailGracefully:!1,ignoreMinBufferTime:!1,autoCorrectDrift:!0,initialSegmentLimit:1e3,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1,ignoreMaxSegmentDuration:!1,keySystemsByURI:{"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready"},manifestPreprocessor:Oc,manifestPreprocessorTXml:Fc,sequenceMode:!1,enableAudioGroups:!1,multiTypeVariantsAllowed:i,useStreamOnceInPeriodFlattening:!1,updatePeriod:-1,enableFastSwitching:!0},hls:{ignoreTextStreamFailures:!1,ignoreImageStreamFailures:!1,defaultAudioCodec:"mp4a.40.2",defaultVideoCodec:"avc1.42E01E",ignoreManifestProgramDateTime:!1,ignoreManifestProgramDateTimeForTypes:[],mediaPlaylistFullMimeType:'video/mp2t; codecs="avc1.42E01E, mp4a.40.2"',useSafariBehaviorForLive:!0,liveSegmentsDelay:3,sequenceMode:!(Ht()||Kt()||Zt()||Xt()),ignoreManifestTimestampsInSegmentsMode:!1,disableCodecGuessing:!1,disableClosedCaptionsDetection:!1,allowLowLatencyByteRangeOptimization:!0},mss:{manifestPreprocessor:Oc,manifestPreprocessorTXml:Fc,sequenceMode:!1,keySystemsBySystemId:{"9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready"}}};var r={retryParameters:xr(),failureCallback:function(e){return Ac([e])},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,evictionGoal:1,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,gapDetectionThreshold:.5,gapJumpTimerTime:.25,durationBackoff:1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsForFairPlay:!0,inaccurateManifestTolerance:2,lowLatencyMode:!1,autoLowLatencyMode:!1,forceHTTP:!1,forceHTTPS:!1,preferNativeHls:!1,updateIntervalSeconds:1,dispatchAllEmsgBoxes:!1,observeQualityChanges:!1,maxDisabledTime:30,parsePrftBox:!1,segmentPrefetchLimit:0,prefetchAudioLanguages:[],disableAudioPrefetch:!1,disableTextPrefetch:!1,disableVideoPrefetch:!1,liveSync:{enabled:!1,targetLatency:.5,targetLatencyTolerance:.5,maxPlaybackRate:1.1,minPlaybackRate:.95,panicMode:!1,panicThreshold:60,dynamicTargetLatency:{enabled:!1,stabilityThreshold:60,rebufferIncrement:.5,maxAttempts:10,maxLatency:4,minLatency:1}},allowMediaSourceRecoveries:!0,minTimeBetweenRecoveries:5,vodDynamicPlaybackRate:!1,vodDynamicPlaybackRateLowBufferRate:.95,vodDynamicPlaybackRateBufferRatio:.5,infiniteLiveStreamDuration:!1,preloadNextUrlWindow:30,loadTimeout:30,clearDecodingCache:Xt()||$t(),dontChooseCodecs:!1,shouldFixTimestampOffset:zt()||Vt()};(zt()||Vt()||qt()||Qt())&&(r.stallSkip=0);var a={trackSelectionCallback:function(e){return O(function(t){return t.return(e)})},downloadSizeCallback:function(e){var t;return O(function(n){return 1==n.g?navigator.storage&&navigator.storage.estimate?T(n,navigator.storage.estimate(),3):n.return(!0):(t=n.h,n.return(t.usage+e<.95*t.quota))})},progressCallback:function(e,t){return Ac([e,t])},usePersistentLicense:!0,numberOfParallelDownloads:5};e={enabled:!0,useNetworkInformation:!0,defaultBandwidthEstimate:1e6,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:e,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0,minChannelsCount:0,maxChannelsCount:1/0},advanced:{minTotalBytes:128e3,minBytes:16e3,fastHalfLife:2,slowHalfLife:5},restrictToElementSize:!1,restrictToScreenSize:!1,ignoreDevicePixelRatio:!1,clearBufferSwitch:!1,safeMarginSwitch:0,cacheLoadThreshold:20,minTimeToSwitch:Wt()?.5:0},n={codecSwitchingStrategy:n,addExtraFeaturesToSourceBuffer:function(e){return Ac([e],"")},forceTransmux:!1,insertFakeEncryptionInInit:!0,modifyCueCallback:function(e,t){return Ac([e,t])}};var o=!1,s=!1,l=!0;rn()&&(s=o=!0,l=!1);var u={drm:t,manifest:i,streaming:r,mediaSource:n,offline:a,abrFactory:function(){return new tr},abr:e,autoShowText:3,preferredAudioLanguage:"",preferredAudioLabel:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,preferredVideoHdrLevel:"AUTO",preferredVideoLayout:"",preferredVideoLabel:"",preferredVideoCodecs:[],preferredAudioCodecs:[],preferForcedSubs:!1,preferSpatialAudio:!1,preferredDecodingAttributes:[],restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0,minChannelsCount:0,maxChannelsCount:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayer:{captionsUpdatePeriod:.25},textDisplayFactory:function(){return null},cmcd:{enabled:!1,sessionId:"",contentId:"",rtpSafetyFactor:5,useHeaders:!1,includeKeys:[]},cmsd:{enabled:!0,applyMaximumSuggestedBitrate:!0,estimatedThroughputWeightRatio:.5},lcevc:{enabled:!1,dynamicPerformanceScaling:!0,logLevel:0,drawLogo:!1},ads:{customPlayheadTracker:o,skipPlayDetection:s,supportsMultipleMediaElements:l}};return a.trackSelectionCallback=function(e){return O(function(t){return t.return(Nc(e,u.preferredAudioLanguage,u.preferredVideoHdrLevel))})},u}function Pc(e,t,n){var i={".drm.keySystemsMapping":"",".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",sessionType:"",serverCertificate:new Uint8Array(0),serverCertificateUri:"",individualizationServer:"",headers:{}}};return Sc(e,t,n||Lc(),i,"")}function Nc(t,n,i){var r=i;"AUTO"==r&&(r=e.matchMedia("(color-gamut: p3)").matches?"PQ":"SDR");var a=t.filter(function(e){return!("variant"!=e.type||e.hdr&&e.hdr!=r)});i=[];var o=mi(n,a.map(function(e){return e.language}));o&&(i=a.filter(function(e){return fi(e.language)==o})),0==i.length&&(i=a.filter(function(e){return e.primary})),0==i.length&&(a.map(function(e){return e.language}),i=a);var s=i.filter(function(e){return e.height&&480>=e.height});for(s.length&&(s.sort(function(e,t){return t.height-e.height}),i=s.filter(function(e){return e.height==s[0].height})),n=[],i.length&&(a=Math.floor(i.length/2),i.sort(function(e,t){return e.bandwidth-t.bandwidth}),n.push(i[a])),t=c(t),i=t.next();!i.done;i=t.next())i=i.value,i.type!=Ln&&"image"!=i.type||n.push(i);return n}function Oc(e){return Ac([e],e)}function Fc(e){return Ac([e],e)}function Uc(e,t,n,i){Br.call(this),this.L=e,this.U=t,this.xa=i.networkingEngine,this.A=n,this.o=null,this.ra=0,this.Fa=i.Dc,this.C=i.Ci,this.bb=i.Di,this.g=i.config,this.j=this.F=this.h=null,this.ea=!1,this.G=i.Mi,this.pa=!1,this.l=null,this.da=!1,this.i=this.B=null,this.aa=!1,this.K=new Map,this.qa=!1,this.za=i.Li,this.Z=new pu,this.m=new Rr,this.N=null,this.s=!1,this.Da=i.Fh,this.fa=null,this.Ea=i.Eh,this.R=!1,this.I=[],this.H=[]}function Bc(e,t,n){(e=t?e.H:e.I)?e.push(n):n()}function Gc(e){if(e.H)for(var t=c(e.H),n=t.next();!n.done;n=t.next())n=n.value,n();e.H=null}function jc(e,t){if(e.N=t,e.R=!0,e.I){t=c(e.I);for(var n=t.next();!n.done;n=t.next())n=n.value,n()}e.I=null}function Vc(e){return e.aa=!0,e.i}function Hc(e){return e.ea=!0,e.j}function Kc(e){return e.pa=!0,e.G}function zc(e){return e.da=!0,e.l}function Zc(e){return e.qa=!0,e.K}function qc(e){if(e.s)throw new Rt(2,7,7003)}function Yc(e,t){e.dispatchEvent(new Or("onstatechange",(new Map).set("state",t)))}function Wc(e){var t,n,i,r,a;return O(function(o){if(1==o.g)return Yc(e,"manifest-parser"),e.j||(e.F=Ko(e.L,e.U),e.j=e.F(),e.j.configure(e.g.manifest)),t=Date.now()/1e3,Yc(e,"manifest"),e.h?o.u(2):(n=e,T(o,e.j.start(e.L,e.bb),3));if(2!=o.g&&(n.h=o.h),i=new Or("manifestparsed",void 0),e.dispatchEvent(i),0==e.h.variants.length)throw new Rt(2,4,4036);Qc(e.h),r=Date.now()/1e3,a=r-t,e.Z.H=a,S(o)})}function $c(e){var t,n,i,r,a;return O(function(o){switch(o.g){case 1:Yc(e,"drm-engine"),e.ra=Date.now()/1e3,e.l=e.Fa(),e.C.g=e.l,e.l.configure(e.g.drm);var s=e.C;if(t=Ai(e.h.variants,s.h.restrictions,s.i),!t){o.u(2);break}return n=new Or("trackschanged",void 0),T(o,Promise.resolve(),3);case 3:qc(e),e.dispatchEvent(n);case 2:return i=qi(e.h.variants),T(o,no(e.l,i,e.h.offlineSessionIds),4);case 4:return qc(e),T(o,Uo(e.C,e.h),5);case 5:if(r=o.h,!r){o.u(0);break}return a=new Or("trackschanged",void 0),T(o,Promise.resolve(),7);case 7:e.dispatchEvent(a),S(o)}})}function Xc(e,t,n){var i,r,a,o,s;O(function(l){if(1==l.g)return i=e.g.streaming.segmentPrefetchLimit||2,r=new gu(i,t,function(t,n,i){return pc(t,n,i||null,e.g.streaming.retryParameters,e.xa)},!1),e.K.set(t.id,r),T(l,t.createSegmentIndex(),2);a=e.A||0,(s=(o=t.segmentIndex.Kb(a))?o.current():null)||(s=t.segmentIndex.get(0)),s&&(n?s.$&&yu(r,s.$):vu(r,s.startTime)),S(l)})}function Qc(e){function t(e){return e.video&&e.audio||e.video&&e.video.codecs.includes(",")}e.variants.some(t)&&(e.variants=e.variants.filter(t))}function Jc(e,t){Br.call(this);var n=this;this.i=e,this.l=t,this.g=new Map,this.m=[{Ac:null,zc:nd,pc:function(e,t){return ed(n,"enter",e,t)}},{Ac:td,zc:nd,pc:function(e,t){return ed(n,"enter",e,t)}},{Ac:id,zc:nd,pc:function(e,t){return ed(n,"enter",e,t)}},{Ac:nd,zc:td,pc:function(e,t){return ed(n,"exit",e,t)}},{Ac:nd,zc:id,pc:function(e,t){return ed(n,"exit",e,t)}},{Ac:td,zc:id,pc:function(e,t){return ed(n,"skip",e,t)}},{Ac:id,zc:td,pc:function(e,t){return ed(n,"skip",e,t)}}],this.h=new ae,this.h.D(this.i,"regionremove",function(e){n.g.delete(e.region)})}function ed(e,t,n,i){t=new Or(t,new Map([["region",n],["seeking",i]])),e.dispatchEvent(t)}Vl.prototype.release=function(){this.h&&(this.h.release(),this.h=null),null!=this.i&&(this.i.release(),this.i=null),this.m=function(){},this.g=null},ql.prototype.release=function(){this.g&&(this.g.stop(),this.g=null),this.h=null},i=Wl.prototype,i.$e=function(){function e(){if(null==t.g||0==t.g&&1/0!=t.h.duration)t.j=!0;else{var e=t.h.currentTime,n=t.g;0>t.g&&(n=Math.max(0,e+t.g)),e!=n?(t.i.ha(t.h,"seeking",function(){t.j=!0}),t.h.currentTime=n):t.j=!0}}var t=this;Gl(this.h,HTMLMediaElement.HAVE_CURRENT_DATA,this.i,function(){e()})},i.release=function(){this.i&&(this.i.release(),this.i=null),this.h=null},i.af=function(e){this.g=this.j?this.g:e},i.$d=function(){return(this.j?this.h.currentTime:this.g)||0},i.vg=function(){return 0},i.ug=function(){return 0},i.Zg=function(){},i=$l.prototype,i.$e=function(){this.m.Sa(.25)},i.release=function(){this.h&&(this.h.release(),this.h=null),this.j&&(this.j.release(),this.j=null),this.m&&(this.m.stop(),this.m=null),this.i=this.h=this.g=this.l=null,this.A=function(){}},i.af=function(e){Kl(this.h,e)},i.$d=function(){var e=Hl(this.h);return 0<this.i.readyState&&!this.i.paused?Jl(this,e):e},i.vg=function(){return this.o?this.o.o:0},i.ug=function(){return this.j.C},i.Zg=function(){this.j.Sf()},i=tu.prototype,i.getNumReferences=function(){return this.O.length},i.getNumEvicted=function(){return this.i},i.release=function(){this.m||(this.O=[],this.l&&this.l.stop(),this.l=null)},i.Fi=function(){this.m=!0},i.Jb=function(e){for(var t=c(this.O),n=t.next();!n.done;n=t.next())e(n.value)},i.find=function(e){for(var t=this.O.length-1,n=t;0<=n;--n){var i=this.O[n],r=n<t?this.O[n+1].startTime:i.endTime;if(e>=i.startTime&&e<r)return n+this.i}return this.O.length&&e<this.O[0].startTime?this.i:null},i.get=function(e){return 0==this.O.length?null:(e-=this.i,0>e||e>=this.O.length?null:this.O[e])},i.offset=function(e){if(!this.m)for(var t=c(this.O),n=t.next();!n.done;n=t.next())n.value.offset(e)},i.ue=function(e){if(!this.m&&e.length){var t=Math.round(1e3*e[0].startTime)/1e3;this.O=this.O.filter(function(e){return Math.round(1e3*e.startTime)/1e3<t}),this.O.push.apply(this.O,d(e))}},i.Id=function(e,t){var n=this;e=e.filter(function(e){return e.endTime>t&&(0==n.O.length||e.endTime>n.O[0].startTime)}),this.ue(e),this.Oa(t)},i.Oa=function(e){if(!this.m){var t=this.O.length;this.O=this.O.filter(function(t){return t.endTime>e}),this.i+=t-this.O.length}},i.Ec=function(e,t,n){if(n=void 0!==n&&n,!this.m){for(;this.O.length;){if(!(this.O[this.O.length-1].startTime>=t))break;this.O.pop()}for(;this.O.length;){if(!(this.O[0].endTime<=e))break;this.O.shift(),n||this.i++}0!=this.O.length&&(e=this.O[this.O.length-1],t=new Qo(e.startTime,t,e.C,e.Ha,e.sa,e.$,e.timestampOffset,e.appendWindowStart,e.appendWindowEnd,e.g,e.tilesLayout,e.A,e.h,e.status,e.aesKey),t.mimeType=e.mimeType,t.codecs=e.codecs,t.i=e.i,this.O[this.O.length-1]=t)}},i.Me=function(e,t){var n=this;this.m||(this.l&&this.l.stop(),this.l=new Ft(function(){var e=t();e?n.O.push.apply(n.O,d(e)):(n.l.stop(),n.l=null)}),this.l.Sa(e))},tu.prototype[Symbol.iterator]=function(){return this.Kb(0)},tu.prototype.Kb=function(e,t,n){t=void 0!==t&&t,n=void 0!==n&&n;var i=this.find(e);if(null==i)return null;var r=this.get(i);n?i++:i--;var a=-1;if(r&&0<r.g.length)for(var o=r.g.length-1;0<=o;--o){var s=r.g[o];if(e>=s.startTime&&e<s.endTime){if(!t){for(;o&&!s.l;)o--,s=r.g[o];if(!s.l)return X("No independent partial segment found!"),null}n?i--:i++,a=o-1;break}}return new iu(this,i,a,n)},K("shaka.media.SegmentIndex",tu),tu.forSingleSegment=nu,tu.prototype.getIteratorForTime=tu.prototype.Kb,tu.prototype.updateEvery=tu.prototype.Me,tu.prototype.fit=tu.prototype.Ec,tu.prototype.evict=tu.prototype.Oa,tu.prototype.mergeAndEvict=tu.prototype.Id,tu.prototype.offset=tu.prototype.offset,tu.prototype.get=tu.prototype.get,tu.prototype.find=tu.prototype.find,tu.prototype.markImmutable=tu.prototype.Fi,tu.prototype.release=tu.prototype.release,tu.prototype.getNumEvicted=tu.prototype.getNumEvicted,tu.prototype.getNumReferences=tu.prototype.getNumReferences,iu.prototype.Uc=function(e){this.reverse=e},iu.prototype.Lh=function(){return this.h},iu.prototype.current=function(){var e=this.i.get(this.h);return e&&0<e.g.length&&e.o&&this.g>=e.g.length&&(this.h++,this.g=0,e=this.i.get(this.h)),e&&0<e.g.length?e.g[this.g]:e},iu.prototype.next=function(){var e=this.i.get(this.h);return this.reverse?e&&0<e.g.length?(this.g--,0>this.g&&(this.h--,this.g=(e=this.i.get(this.h))&&0<e.g.length?e.g.length-1:0)):(this.h--,this.g=0):e&&0<e.g.length?(this.g++,e.o&&this.g==e.g.length&&(this.h++,this.g=0)):(this.h++,this.g=0),e=this.current(),{value:e,done:!e}},K("shaka.media.SegmentIterator",iu),iu.prototype.next=iu.prototype.next,iu.prototype.current=iu.prototype.current,iu.prototype.currentPosition=iu.prototype.Lh,iu.prototype.setReverse=iu.prototype.Uc,y(ru,tu),i=ru.prototype,i.clone=function(){var e=new ru;return e.g=this.g.slice(),e},i.release=function(){for(var e=c(this.g),t=e.next();!t.done;t=e.next())t.value.release();this.g=[]},i.Jb=function(e){for(var t=c(this.g),n=t.next();!n.done;n=t.next())n.value.Jb(e)},i.find=function(e){for(var t=0,n=c(this.g),i=n.next();!i.done;i=n.next()){i=i.value;var r=i.find(e);if(null!=r)return r+t;t+=i.getNumEvicted()+i.getNumReferences()}return null},i.get=function(e){for(var t=0,n=c(this.g),i=n.next();!i.done;i=n.next()){i=i.value;var r=i.get(e-t);if(r)return r;r=i.getNumReferences(),t+=i.getNumEvicted()+r}return null},i.offset=function(){},i.ue=function(){},i.Oa=function(){},i.Id=function(){},i.Ec=function(){},i.Me=function(){},K("shaka.media.MetaSegmentIndex",ru),ru.prototype.updateEvery=ru.prototype.Me,ru.prototype.fit=ru.prototype.Ec,ru.prototype.mergeAndEvict=ru.prototype.Id,ru.prototype.evict=ru.prototype.Oa,ru.prototype.merge=ru.prototype.ue,ru.prototype.offset=ru.prototype.offset,ru.prototype.get=ru.prototype.get,ru.prototype.find=ru.prototype.find,ru.prototype.forEachTopLevelReference=ru.prototype.Jb,ru.prototype.release=ru.prototype.release,au.prototype.release=function(){this.set(this.nc()),this.h&&(this.h.stop(),this.h=null),this.g=null},au.prototype.set=function(e){this.i=e,ou(this)},au.prototype.nc=function(){return this.g.nc()},su.prototype.release=function(){this.i.stop();for(var e=c(this.g),t=e.next();!t.done;t=e.next())t.value.release();this.g.clear()},gu.prototype.Oa=function(e,t){t=void 0!==t&&t;for(var n=c(this.h.keys()),i=n.next();!i.done;i=n.next())i=i.value,e>i.endTime&&wu(this,i);t&&Eu(this)},gu.prototype.Uc=function(e){this.o=e,this.g&&this.g.Uc(e)},Au.prototype.abort=function(){this.Be&&this.Be.abort()},y(xu,Br),xu.prototype.release=function(){this.g.clear(),this.h.stop(),Br.prototype.release.call(this)},y(Ru,Br),Ru.prototype.release=function(){this.g.clear(),Br.prototype.release.call(this)},Ru.prototype.j=function(e){for(var t=c(this.g.values()),n=t.next();!n.done;n=t.next()){n=n.value;var i=n.kf;e:{for(var r=n.Md,a=r.length-1;0<=a;a--){var o=r[a];if(o.position<=e){r=o.Lc;break e}}r=null}a=r&&!(i===r||i&&r&&i.bandwidth==r.bandwidth&&i.audioSamplingRate==r.audioSamplingRate&&i.codecs==r.codecs&&i.contentType==r.contentType&&i.frameRate==r.frameRate&&i.height==r.height&&i.mimeType==r.mimeType&&i.channelsCount==r.channelsCount&&i.pixelAspectRatio==r.pixelAspectRatio&&i.width==r.width),o=r&&i&&r.label&&i.label&&i.label!==r.label;var s=r&&i&&r.language&&i.language&&i.language!==r.language;i=r&&i&&r.roles&&i.roles&&!Ue(i.roles,r.roles),(o||s||i)&&ku(this,e,r.contentType)&&(n.kf=r,i=new Or("audiotrackchange",new Map([["quality",r],["position",e]])),this.dispatchEvent(i)),a&&ku(this,e,r.contentType)&&(n.kf=r,JSON.stringify(r),n=new Or("qualitychange",new Map([["quality",r],["position",e]])),this.dispatchEvent(n))}},i=ju.prototype,i.destroy=function(){return this.m.destroy()},i.configure=function(e){if(this.h=e,this.I=new Ar({maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor,timeout:0,stallTimeout:0,connectionTimeout:0},!0),e.disableAudioPrefetch){var t=this.i.get("audio");t&&t.W&&(bu(t.W),t.W=null),t=c(this.o.keys());for(var n=t.next();!n.done;n=t.next())n=n.value,bu(this.o.get(n)),this.o.delete(n)}for(e.disableTextPrefetch&&(t=this.i.get(Ln))&&t.W&&(bu(t.W),t.W=null),e.disableVideoPrefetch&&(t=this.i.get("video"))&&t.W&&(bu(t.W),t.W=null),t=c(this.i.keys()),n=t.next();!n.done;n=t.next())n=this.i.get(n.value),n.W?(Tu(n.W,e.segmentPrefetchLimit),0<e.segmentPrefetchLimit||(bu(n.W),n.W=null)):0<e.segmentPrefetchLimit&&(n.W=ec(this,n.stream));e.disableAudioPrefetch||tc(this)},i.start=function(e){var t=this;return O(function(n){if(1==n.g)return T(n,Qu(t,e||new Map),2);na(t.m),t.C=!0,S(n)})},i.Nd=function(){if(this.g)for(var e=this.g.he(),t=c(this.i.keys()),n=t.next();!n.done;n=t.next()){var i=n.value;n=this.i.get(i);var r=this.g.ca;if(r.C?r=!1:i==Ln?(r=r.g,r=null!=r.g&&null!=r.h&&(e>=r.g&&e<r.h)):(r=ul(r,i),r=rs(r,e)),!r){if(n.W&&(n.W.g=null),"audio"===n.type){r=c(this.o.values());for(var a=r.next();!a.done;a=r.next())a.value.g=null}n.ia=null,(null!=sl(this.g.ca,i)||n.Qa)&&Xu(this,n),n.kb&&(n.kb.abort(),n.kb=null),i===Ln&&(i=this.g.ca,i.H&&i.H.g()),n.Nd=!0}}},i.updateDuration=function(){var e=this.l.presentationTimeline.getDuration();1/0>e?this.g.ca.$a(e):this.g.ca.$a(this.h.infiniteLiveStreamDuration?1/0:Math.pow(2,32))},K("shaka.util.ConfigUtils",Tc),Tc.getDifferenceFromConfigObjects=Ic,Tc.convertToConfigObject=wc,Tc.mergeConfigObjects=Sc,K("shaka.util.FairPlayUtils",xc),xc.commonFairPlayResponse=function(e,t){if(2===e){try{var n=fn(t.data)}catch(e){return}e=!1,n=n.trim(),"<ckc>"===n.substr(0,5)&&"</ckc>"===n.substr(-6)&&(n=n.slice(5,-6),e=!0);try{var i=JSON.parse(n);i.ckc&&(n=i.ckc,e=!0),i.CkcMessage&&(n=i.CkcMessage,e=!0),i.License&&(n=i.License,e=!0)}catch(e){}e&&(t.data=Se(Sn(n)))}},xc.expressplayFairPlayRequest=function(e,t){kc(e,t)},xc.conaxFairPlayRequest=function(e,t){kc(e,t)},xc.ezdrmFairPlayRequest=function(e,t){kc(e,t)},xc.verimatrixFairPlayRequest=function(e,t){2===e&&(e=we(t.body),e=Tn(e),t.headers["Content-Type"]="application/x-www-form-urlencoded",t.body=gn("spc="+e))},xc.expressplayInitDataTransform=function(e,t,n){return Dc(e,t,n)},xc.conaxInitDataTransform=function(t,n,i){if("skd"!==n)return t;n=i.serverCertificate,i=pn(t).split("skd://").pop().split("?").shift(),i=e.atob(i);var r=new ArrayBuffer(2*i.length);r=Ae(r);for(var a=0,o=i.length;a<o;a++)r[a]=i.charCodeAt(a);return Cc(t,r,n)},xc.ezdrmInitDataTransform=function(e,t,n){return"skd"!==t?e:(t=n.serverCertificate,n=pn(e).split(";").pop(),Cc(e,n,t))},xc.verimatrixInitDataTransform=function(e,t,n){return Dc(e,t,n)},xc.initDataTransform=Cc,xc.defaultGetContentId=Rc,xc.isFairPlaySupported=function(){var e;return O(function(t){return 1==t.g?(e={initDataTypes:["cenc","sinf","skd"],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"'}]},w(t,2),T(t,navigator.requestMediaKeySystemAccess("com.apple.fps",[e]),4)):2!=t.g?t.return(!0):(x(t),t.return(!1))})},K("shaka.util.PlayerConfiguration",Mc),Mc.mergeConfigObjects=Pc,Mc.createDefault=Lc,y(Uc,Br),i=Uc.prototype,i.getStartTime=function(){return this.A},i.Gc=function(){return this.L},i.Ef=function(){return this.h},i.getStats=function(){return this.Z},i.start=function(){var e=this;(function(){var t;O(function(n){switch(n.g){case 1:return T(n,Promise.resolve(),2);case 2:return w(n,3),T(n,Wc(e),5);case 5:return qc(e),T(n,$c(e),6);case 6:if(qc(e),e.o||(e.o=new dr(e.g.preferredAudioLanguage,e.g.preferredVariantRole,e.g.preferredAudioChannelCount,e.g.preferredVideoHdrLevel,e.g.preferSpatialAudio,e.g.preferredVideoLayout,e.g.preferredAudioLabel,e.g.preferredVideoLabel,e.g.mediaSource.codecSwitchingStrategy,e.g.manifest.dash.enableAudioGroups)),e.Ea){var i=e.g.abrFactory;e.B=i,e.i=i(),e.i.configure(e.g.abr)}if(e.Da){i=e.h.presentationTimeline.V();var r=qi(e.h.variants);r=e.o.create(r),e.i.configure(e.g.abr),e.i.setVariants(Array.from(r.values())),(r=e.i.chooseVariant(!0))&&(e.fa=r,r.video&&Xc(e,r.video,i),r.audio&&Xc(e,r.audio,i))}return T(n,void 0,7);case 7:qc(e),e.m.resolve(),I(n,0);break;case 3:t=x(n),e.m.reject(t),S(n)}})})()},i.dispatchEvent=function(e){return this.N?this.N.dispatchEvent(e):Br.prototype.dispatchEvent.call(this,e)},i.onError=function(e){2===e.severity&&(this.m.reject(e),this.destroy());var t=(new Map).set("detail",e);t=new Or("error",t),this.dispatchEvent(t),t.defaultPrevented&&(e.handled=!0)},i.configure=function(e,t){e=wc(e,t),Pc(this.g,e)},i.getConfiguration=function(){return yi(this.g)},i.mj=function(){return this.m},i.destroy=function(){var e,t,n,i=this;return O(function(r){switch(r.g){case 1:if(i.s=!0,!i.j||i.ea){r.u(2);break}return T(r,i.j.stop(),2);case 2:if(!i.i||i.aa){r.u(4);break}return T(r,i.i.stop(),4);case 4:if(i.G&&!i.pa&&i.G.release(),!i.l||i.da){r.u(6);break}return T(r,i.l.destroy(),6);case 6:if(0<i.K.size&&!i.qa)for(e=c(i.K.values()),t=e.next();!t.done;t=e.next())n=t.value,bu(n);S(r)}})},K("shaka.media.PreloadManager",Uc),Uc.prototype.destroy=Uc.prototype.destroy,Uc.prototype.waitForFinish=Uc.prototype.mj,y(Jc,Br),Jc.prototype.release=function(){this.i=null,this.g.clear(),this.h.release(),this.h=null,Br.prototype.release.call(this)},Jc.prototype.j=function(e,t){if(!this.l||0!=e){this.l=!1;for(var n=c(this.i.g),i=n.next();!i.done;i=n.next()){i=i.value;var r=this.g.get(i),a=e<i.startTime?td:e>i.endTime?id:nd;this.g.set(i,a);for(var o=c(this.m),s=o.next();!s.done;s=o.next())s=s.value,s.Ac==r&&s.zc==a&&s.pc(i,t)}}};var td=1,nd=2,id=3;function rd(e,t,n){var i,r,a,o,s,l,u;return O(function(c){switch(c.g){case 1:var d=new ft(e).Pa.split("/").pop().split(".");return i=1==d.length?"":d.pop().toLowerCase(),(r=ad[i])?c.return(r):(a=0,o=zr([e],n),w(c,2),o.method="HEAD",T(c,t.request(a,o).promise,4));case 4:s=c.h,r=s.headers["content-type"],I(c,3);break;case 2:if(l=x(c),!l||1002!=l.code&&1001!=l.code){c.u(3);break}return o.method="GET",T(c,t.request(a,o).promise,6);case 6:u=c.h,r=u.headers["content-type"];case 3:return c.return(r?r.toLowerCase().split(";").shift():"")}})}var ad={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",weba:"audio/webm",mkv:"video/webm",ts:"video/mp2t",ogv:"video/ogg",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",m3u8:"application/x-mpegurl",mpd:"application/dash+xml",ism:"application/vnd.ms-sstr+xml",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac",wav:"audio/wav",sbv:"text/x-subviewer",srt:"text/srt",vtt:"text/vtt",webvtt:"text/vtt",ttml:"application/ttml+xml",lrc:"application/x-subtitle-lrc",ssa:"text/x-ssa",ass:"text/x-ssa"};function od(e,t){if(e.lineBreak)return"\n";if(e.nestedCues.length)return e.nestedCues.map(function(t){return od(t,e)}).join("");var n=[],i=700<=e.fontWeight,r="italic"==e.fontStyle,a=e.textDecoration.includes("underline");return i&&n.push(["b"]),r&&n.push(["i"]),a&&n.push(["u"]),r=e.color,""==r&&t&&(r=t.color),i="",(r=sd(r))&&(i+="."+r),r=e.backgroundColor,""==r&&t&&(r=t.backgroundColor),(t=sd(r))&&(i+=".bg_"+t),i&&n.push(["c",i]),n.reduceRight(function(e,t){var n=c(t);return t=n.next().value,n=n.next().value,"<"+t+(void 0===n?"":n)+">"+e+"</"+t+">"},e.payload)}function sd(e){e=e.toLowerCase();var t=e.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i);switch(t?e="#"+(256|parseInt(t[1],10)).toString(16).slice(1)+(256|parseInt(t[2],10)).toString(16).slice(1)+(256|parseInt(t[3],10)).toString(16).slice(1):e.startsWith("#")&&7<e.length&&(e=e.slice(0,7)),e){case"white":case"#fff":case"#ffffff":return"white";case"lime":case"#0f0":case"#00ff00":return"lime";case"cyan":case"#0ff":case"#00ffff":return"cyan";case"red":case"#f00":case"#ff0000":return"red";case"yellow":case"#ff0":case"#ffff00":return"yellow";case"magenta":case"#f0f":case"#ff00ff":return"magenta";case"blue":case"#00f":case"#0000ff":return"blue";case"black":case"#000":case"#000000":return"black"}return null}function ld(e,t){var n=[];e=c(ud(e));for(var i=e.next();!i.done;i=e.next())if(i=i.value,i.isContainer)n.push.apply(n,d(ld(i.nestedCues,i)));else{var r=i.clone();r.nestedCues=[],r.payload=od(i,t),n.push(r)}return n}function ud(e){var t=[],n={};e=c(e);for(var i=e.next();!i.done;n={Sd:n.Sd},i=e.next())n.Sd=i.value,t.some(function(e){return function(t){return je(e.Sd,t)}}(n))||t.push(n.Sd);return t}function cd(e){function t(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return(t>>>0).toString()}if(e.startTime>=e.endTime)return null;var n=new VTTCue(e.startTime,e.endTime,e.payload);n.id=t(e.startTime.toString())+t(e.endTime.toString())+t(e.payload),n.lineAlign=e.lineAlign,n.positionAlign=e.positionAlign,e.size&&(n.size=e.size);try{n.align=e.textAlign}catch(e){}return"center"==e.textAlign&&"center"!=n.align&&(n.align="middle"),"vertical-lr"==e.writingMode?n.vertical="lr":"vertical-rl"==e.writingMode&&(n.vertical="rl"),1==e.lineInterpretation&&(n.snapToLines=!1),null!=e.line&&(n.line=e.line),null!=e.position&&(n.position=e.position),n}function dd(e,t){this.g=null;for(var n=c(Array.from(e.textTracks)),i=n.next();!i.done;i=n.next())i=i.value,"metadata"!==i.kind&&"chapters"!==i.kind&&(i.mode="disabled",i.label==t&&(this.g=i));this.g||(this.g=e.addTextTrack("subtitles",t)),this.g.mode="hidden"}function fd(e,t){var n=e.mode;e.mode="showing"==n?"showing":"hidden";for(var i=c(Array.from(e.cues)),r=i.next();!r.done;r=i.next())(r=r.value)&&t(r)&&e.removeCue(r);e.mode=n}function hd(){}function pd(){}function gd(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function md(t,n,i){var r=this;this.m=!1,this.h=[],this.A=t,this.s=n,this.l=null,this.g=document.createElement("div"),this.g.classList.add("shaka-text-container"),this.g.style.textAlign="center",this.g.style.display="flex",this.g.style.flexDirection="column",this.g.style.alignItems="center",this.g.style.justifyContent="flex-end",this.s.appendChild(this.g),i&&i.captionsUpdatePeriod||pe("UITextDisplayer w/ config","Please migrate to initializing UITextDisplayer with a config."),this.C=new Ft(function(){r.A.paused||_d(r)}).Sa(i&&i.captionsUpdatePeriod?i.captionsUpdatePeriod:.25),this.i=new Map,this.j=new ae,this.j.D(document,"fullscreenchange",function(){_d(r,!0)}),this.j.D(this.A,"seeking",function(){_d(r,!0)}),this.j.D(this.A,"resize",function(){var e=r.A,t=e.videoWidth;e=e.videoHeight,r.l=t&&e?t/e:null}),this.o=null,"ResizeObserver"in e&&(this.o=new ResizeObserver(function(){_d(r,!0)}),this.o.observe(this.g)),this.B=new Map}function vd(e,t){for(;null!=t;){if(t==e.g)return!0;t=t.parentElement}return!1}function yd(e,t,n,i,r){var a=!1,o=[],s=[];t=c(t);for(var l=t.next();!l.done;l=t.next()){l=l.value,r.push(l);var u=e.i.get(l),d=l.startTime<=i&&l.endTime>i,f=u?u.wh:null;u&&(o.push(u.jf),u.uc&&o.push(u.uc),d||(a=!0,e.i.delete(l),u=null)),d&&(s.push(l),u?vd(e,f)||(a=!0):(bd(e,l,r),u=e.i.get(l),f=u.wh,a=!0)),0<l.nestedCues.length&&f&&yd(e,l.nestedCues,f,i,r),r.pop()}if(a){for(i=c(o),r=i.next();!r.done;r=i.next())r=r.value,r.parentElement&&r.parentElement.removeChild(r);for(s.sort(function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime-t.endTime}),s=c(s),l=s.next();!l.done;l=s.next())i=e.i.get(l.value),i.uc?(i.uc.contains(n)&&i.uc.removeChild(n),n.appendChild(i.uc),i.uc.appendChild(i.jf)):n.appendChild(i.jf)}}function _d(e,t){if(e.g){var n=e.A.currentTime;if(!e.m||void 0!==t&&t){t=c(e.B.values());for(var i=t.next();!i.done;i=t.next())gd(i.value);gd(e.g),e.i.clear(),e.B.clear()}e.m&&yd(e,e.h,e.g,n,[])}}function bd(e,t,n){var i=1<n.length,r=i?"span":"div";t.lineBreak&&(r="br"),t.rubyTag&&(r=t.rubyTag),i=!i&&0<t.nestedCues.length;var a=document.createElement(r);if("br"!=r&&Td(e,a,t,n,i),n=null,t.region&&t.region.id){var o=t.region,s=e.l===4/3?2.5:1.9;if(n=o.id+"_"+o.width+"x"+o.height+(o.heightUnits==Le?"%":"px")+"-"+o.viewportAnchorX+"x"+o.viewportAnchorY+(o.viewportAnchorUnits==Le?"%":"px"),e.B.has(n))n=e.B.get(n);else{r=document.createElement("span");var l=o.heightUnits==Le?"%":"px",u=o.widthUnits==Le?"%":"px",c=o.viewportAnchorUnits==Le?"%":"px";r.id="shaka-text-region---"+n,r.classList.add("shaka-text-region"),r.style.position="absolute",r.style.height=2===o.heightUnits?5.33*o.height+"%":o.height+l,r.style.width=2===o.widthUnits?o.width*s+"%":o.width+u,2===o.viewportAnchorUnits?(l=o.viewportAnchorY/75*100,u=o.viewportAnchorX/(e.l===4/3?160:210)*100,l-=o.regionAnchorY*o.height*5.33/100,u-=o.regionAnchorX*o.width*s/100,r.style.top=l+"%",r.style.left=u+"%"):(r.style.top=o.viewportAnchorY-o.regionAnchorY*o.height/100+c,r.style.left=o.viewportAnchorX-o.regionAnchorX*o.width/100+c),0!==o.heightUnits&&0!==o.widthUnits&&0!==o.viewportAnchorUnits&&(o=Math.max(0,Math.min(100-(parseInt(r.style.width.slice(0,-1),10)||0),parseInt(r.style.left.slice(0,-1),10)||0)),r.style.top=Math.max(0,Math.min(100-(parseInt(r.style.height.slice(0,-1),10)||0),parseInt(r.style.top.slice(0,-1),10)||0))+"%",r.style.left=o+"%"),r.style.display="flex",r.style.flexDirection="column",r.style.alignItems="center",r.style.justifyContent="before"==t.displayAlign?"flex-start":"center"==t.displayAlign?"center":"flex-end",e.B.set(n,r),n=r}}r=a,i&&(r=document.createElement("span"),r.classList.add("shaka-text-wrapper"),r.style.backgroundColor=t.backgroundColor,r.style.lineHeight="normal",a.appendChild(r)),e.i.set(t,{jf:a,wh:r,uc:n})}function Ed(e){var t=e.direction,n=e.positionAlign;return e=e.textAlign,n!==Ve?n:"left"===e||"start"===e&&t===qe||"end"===e&&"rtl"===t?"line-left":"right"===e||"start"===e&&"rtl"===t||"end"===e&&t===qe?"line-right":"center"}function Td(e,t,n,i,r){var a=t.style,o=0==n.nestedCues.length,s=1<i.length;a.whiteSpace="pre-wrap";var l=n.payload.replace(/\s+$/g,function(e){return"".repeat(e.length)});if(a.webkitTextStrokeColor=n.textStrokeColor,a.webkitTextStrokeWidth=n.textStrokeWidth,a.color=n.color,a.direction=n.direction,a.opacity=n.opacity,a.paddingLeft=Sd(n.linePadding,n,e.s),a.paddingRight=Sd(n.linePadding,n,e.s),a.textCombineUpright=n.textCombineUpright,a.textShadow=n.textShadow,n.backgroundImage)a.backgroundImage="url('"+n.backgroundImage+"')",a.backgroundRepeat="no-repeat",a.backgroundSize="contain",a.backgroundPosition="center",n.backgroundColor&&(a.backgroundColor=n.backgroundColor),a.width="100%",a.height="100%";else{if(n.nestedCues.length)var u=t;else u=document.createElement("span"),t.appendChild(u);n.border&&(u.style.border=n.border),!r&&((t=wd(i,function(e){return e.backgroundColor}))?u.style.backgroundColor=t:l&&(u.style.backgroundColor="rgba(0, 0, 0, 0.8)"),t=wd(i,function(e){return e.fontFamily}))&&(u.style.fontFamily=t),l&&(u.textContent=l)}s&&!i[i.length-1].isContainer?a.display="inline":(a.display="flex",a.flexDirection="column",a.alignItems="center","left"==n.textAlign||"start"==n.textAlign?(a.width="100%",a.alignItems="start"):"right"!=n.textAlign&&"end"!=n.textAlign||(a.width="100%",a.alignItems="end"),a.justifyContent="before"==n.displayAlign?"flex-start":"center"==n.displayAlign?"center":"flex-end"),o||(a.margin="0"),a.fontFamily=n.fontFamily,a.fontWeight=n.fontWeight.toString(),a.fontStyle=n.fontStyle,a.letterSpacing=n.letterSpacing,a.fontSize=Sd(n.fontSize,n,e.s),i=n.line,null!=i&&(o=n.lineInterpretation,o==We&&(o=1,s=16,e.l&&1>e.l&&(s=32),i=0>i?100+i/s*100:i/s*100),1==o&&(a.position="absolute",n.writingMode==Ye?(a.width="100%",n.lineAlign==$e?a.top=i+"%":"end"==n.lineAlign&&(a.bottom=100-i+"%")):"vertical-lr"==n.writingMode?(a.height="100%",n.lineAlign==$e?a.left=i+"%":"end"==n.lineAlign&&(a.right=100-i+"%")):(a.height="100%",n.lineAlign==$e?a.right=i+"%":"end"==n.lineAlign&&(a.left=100-i+"%")))),a.lineHeight=n.lineHeight,e=Ed(n),"line-left"==e?(a.cssFloat="left",null!==n.position&&(a.position="absolute",n.writingMode==Ye?(a.left=n.position+"%",a.width="auto"):a.top=n.position+"%")):"line-right"==e?(a.cssFloat="right",null!==n.position&&(a.position="absolute",n.writingMode==Ye?(a.right=n.position+"%",a.width="auto"):a.bottom=n.position+"%")):null!==n.position&&50!=n.position&&(a.position="absolute",n.writingMode==Ye?(a.left=n.position+"%",a.width="auto"):a.top=n.position+"%"),a.textAlign=n.textAlign,a.textDecoration=n.textDecoration.join(" "),a.writingMode=n.writingMode,"writingMode"in document.documentElement.style&&a.writingMode==n.writingMode||(a.webkitWritingMode=n.writingMode),n.size&&(n.writingMode==Ye?a.width=n.size+"%":a.height=n.size+"%")}function Sd(e,t,n){var i=(i=new RegExp(/(\d*\.?\d+)([a-z]+|%+)/).exec(e))?{value:Number(i[1]),unit:i[2]}:null;if(!i)return e;var r=i.value;switch(i.unit){case"%":return r/100*n.clientHeight/t.cellResolution.rows+"px";case"c":return n.clientHeight*r/t.cellResolution.rows+"px";default:return e}}function wd(e,t){for(var n=e.length-1;0<=n;n--){var i=t(e[n]);if(i||0===i)return i}return null}function Ad(e,t){function n(e){for(var n=e,i=c(t),r=i.next();!r.done;r=i.next())r=r.value,r.end&&r.start<e&&(n+=r.end-r.start);return e=Math.floor(n/3600),i=Math.floor(n/60%60),r=Math.floor(n%60),n=Math.floor(1e3*n%1e3),(10>e?"0":"")+e+":"+(10>i?"0":"")+i+":"+(10>r?"0":"")+r+"."+(100>n?10>n?"00":"0":"")+n}var i=ld(e);e="WEBVTT\n\n",i=c(i);for(var r=i.next();!r.done;r=i.next())r=r.value,e+=n(r.startTime)+" --\x3e "+n(r.endTime)+function(e){var t=[];switch(e.textAlign){case"left":t.push("align:left");break;case"right":t.push("align:right");break;case He:t.push("align:middle");break;case"start":t.push("align:start");break;case"end":t.push("align:end")}switch(e.writingMode){case"vertical-lr":t.push("vertical:lr");break;case"vertical-rl":t.push("vertical:rl")}return t.length?" "+t.join(" "):""}(r)+"\n",e+=r.payload+"\n\n";return e}function Id(e,t){this.h=e,this.g=t,this.m=void 0,this.i=!1,this.l=!0,this.j=!1}function xd(e){e.i=!1,e.l=!0,e.j=!1}function Rd(e,t,n){try{if(!e.g.enabled)return t;var i=Cd(e);e:{switch(n.toLowerCase()){case"audio/mp4":case"audio/webm":case"audio/ogg":case"audio/mpeg":case"audio/aac":case"audio/flac":case"audio/wav":var r=Gd;break e;case"video/webm":case"video/mp4":case"video/mpeg":case"video/mp2t":r=Vd;break e;case"application/x-mpegurl":case"application/vnd.apple.mpegurl":case"application/dash+xml":case"video/vnd.mpeg.dash.mpd":case"application/vnd.ms-sstr+xml":r=Bd;break e}r=void 0}i.ot=r,i.su=!0;var a=Od(i);return Ud(t,a)}catch(e){return J("CMCD_SRC_ERROR","Could not generate src CMCD data.",e),t}}function Cd(t){return t.g.sessionId||(t.g.sessionId=e.crypto.randomUUID()),{v:1,sf:t.m,sid:t.g.sessionId,cid:t.g.contentId,mtp:t.h.getBandwidthEstimate()/1e3}}function Dd(e,t,n){n=void 0===n?{}:n;var i=void 0===i?e.g.useHeaders:i;if(e.g.enabled){Object.assign(n,Cd(e)),n.pr=e.h.fb();var r=n.ot===jd||n.ot===Vd;if(e.j&&r&&(n.bs=!0,n.su=!0,e.j=!1),null==n.su&&(n.su=e.l),e=kd(e,n),i)i=Fd(e),Object.keys(i).length&&Object.assign(t.headers,i);else{var a=Od(e);a&&(t.uris=t.uris.map(function(e){return Ud(e,a)}))}}}function kd(e,t){var n=e.g.includeKeys;return n.length?Object.keys(t).reduce(function(e,i){return n.includes(i)&&(e[i]=t[i]),e},{}):t}function Md(e){if(0===e.type)return Hd;if(e=e.stream){var t=e.type;if("video"==t)return e.codecs&&e.codecs.includes(",")?Vd:jd;if("audio"==t)return Gd;if("text"==t)return"application/mp4"===e.mimeType?zd:Kd}}function Ld(e,t){if(t=e.h.yb()[t],!t.length)return NaN;var n=e.h.getCurrentTime();return(e=t.find(function(e){return e.start<=n&&e.end>=n}))?1e3*(e.end-n):NaN}function Pd(e,t){if(t=e.h.yb()[t],!t.length)return 0;var n=e.h.getCurrentTime();return(e=t.find(function(e){return e.start<=n&&e.end>=n}))?1e3*(e.end-n):0}function Nd(e,t){var n=e.h.oc();if(!n.length)return NaN;e=n[0],n=c(n);for(var i=n.next();!i.done;i=n.next())i=i.value,"variant"===i.type&&i.bandwidth>e.bandwidth&&(e=i);switch(t){case jd:return e.videoBandwidth||NaN;case Gd:return e.audioBandwidth||NaN;default:return e.bandwidth}}function Od(e){function t(e){return 100*n(e/100)}function n(e){return Math.round(e)}function i(e){return!Number.isNaN(e)&&null!=e&&""!==e&&!1!==e}var r=[],a={br:n,d:n,bl:t,dl:t,mtp:t,nor:function(e){return encodeURIComponent(e)},rtp:t,tb:n},o=Object.keys(e||{}).sort();o=c(o);for(var s=o.next();!s.done;s=o.next()){s=s.value;var l=e[s];if(i(l)&&("v"!==s||1!==l)&&("pr"!=s||1!==l)){var u=a[s];u&&(l=u(l)),u=typeof l;var d=void 0;d="string"===u&&"ot"!==s&&"sf"!==s&&"st"!==s?s+"="+JSON.stringify(l):"boolean"===u?s:"symbol"===u?s+"="+l.description:s+"="+l,r.push(d)}}return r.join(",")}function Fd(e){var t=Object.keys(e),n={},i=["Object","Request","Session","Status"],r=[{},{},{},{}],a={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3};t=c(t);for(var o=t.next();!o.done;o=t.next())o=o.value,r[null!=a[o]?a[o]:1][o]=e[o];for(e=0;e<r.length;e++)(a=Od(r[e]))&&(n["CMCD-"+i[e]]=a);return n}function Ud(e,t){return!t||e.includes("offline:")?e:(e=new ft(e),e.g.set("CMCD",t),e.toString())}i=dd.prototype,i.configure=function(){},i.remove=function(e,t){return!!this.g&&(fd(this.g,function(n){return n.startTime<t&&n.endTime>e}),!0)},i.append=function(e){var t=ld(e),n=[];e=this.g.cues?Array.from(this.g.cues):[];var i={};t=c(t);for(var r=t.next();!r.done;i={Cc:i.Cc},r=t.next())i.Cc=r.value,e.some(function(e){return function(t){return t.startTime==e.Cc.startTime&&t.endTime==e.Cc.endTime&&t.text==e.Cc.payload}}(i))||(r=cd(i.Cc))&&n.push(r);for(e=n.slice().sort(function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime!=t.endTime?e.endTime-t.startTime:"line"in VTTCue.prototype?n.indexOf(t)-n.indexOf(e):n.indexOf(e)-n.indexOf(t)}),e=c(e),i=e.next();!i.done;i=e.next())this.g.addCue(i.value)},i.destroy=function(){return this.g&&(fd(this.g,function(){return!0}),this.g.mode="disabled"),this.g=null,Promise.resolve()},i.isTextVisible=function(){return"showing"==this.g.mode},i.setTextVisibility=function(e){this.g.mode=e?"showing":"hidden"},K("shaka.text.SimpleTextDisplayer",dd),dd.prototype.setTextVisibility=dd.prototype.setTextVisibility,dd.prototype.isTextVisible=dd.prototype.isTextVisible,dd.prototype.destroy=dd.prototype.destroy,dd.prototype.append=dd.prototype.append,dd.prototype.remove=dd.prototype.remove,dd.prototype.configure=dd.prototype.configure,i=hd.prototype,i.configure=function(){},i.remove=function(){},i.append=function(){},i.destroy=function(){},i.isTextVisible=function(){return!1},i.setTextVisibility=function(){},K("shaka.text.StubTextDisplayer",hd),hd.prototype.setTextVisibility=hd.prototype.setTextVisibility,hd.prototype.isTextVisible=hd.prototype.isTextVisible,hd.prototype.destroy=hd.prototype.destroy,hd.prototype.append=hd.prototype.append,hd.prototype.remove=hd.prototype.remove,hd.prototype.configure=hd.prototype.configure,K("shaka.util.Dom",pd),pd.removeAllChildren=gd,i=md.prototype,i.configure=function(e){this.C&&this.C.Sa(e.captionsUpdatePeriod)},i.append=function(e){var t=[].concat(d(this.h)),n={};e=c(ud(e));for(var i=e.next();!i.done;n={Td:n.Td},i=e.next())n.Td=i.value,t.some(function(e){return function(t){return je(t,e.Td)}}(n))||this.h.push(n.Td);_d(this)},i.destroy=function(){return this.g?(this.s.removeChild(this.g),this.g=null,this.m=!1,this.h=[],this.C&&this.C.stop(),this.i.clear(),this.j&&(this.j.release(),this.j=null),this.o&&(this.o.disconnect(),this.o=null),Promise.resolve()):Promise.resolve()},i.remove=function(e,t){if(!this.g)return!1;var n=this.h.length;return this.h=this.h.filter(function(n){return n.startTime<e||n.endTime>=t}),_d(this,n>this.h.length),!0},i.isTextVisible=function(){return this.m},i.setTextVisibility=function(e){this.m=e},K("shaka.text.UITextDisplayer",md),md.prototype.setTextVisibility=md.prototype.setTextVisibility,md.prototype.isTextVisible=md.prototype.isTextVisible,md.prototype.remove=md.prototype.remove,md.prototype.destroy=md.prototype.destroy,md.prototype.append=md.prototype.append,md.prototype.configure=md.prototype.configure,K("shaka.text.WebVttGenerator",function(){}),Id.prototype.configure=function(e){this.g=e};var Bd="m",Gd="a",jd="v",Vd="av",Hd="i",Kd="c",zd="tt";function Zd(e){this.h=e,this.g=null}function qd(e){return!e||"false"!==e.toLowerCase()&&(/^[-0-9]/.test(e)?parseInt(e,10):e.replace(/["]+/g,""))}K("shaka.util.CmcdManager.StreamingFormat",{DASH:"d",HLS:"h",yh:"s",OTHER:"o"}),i=Zd.prototype,i.configure=function(e){this.h=e},i.Ng=function(){return this.h.enabled&&this.h.applyMaximumSuggestedBitrate&&this.g&&this.g.has(Wd)?1e3*this.g.get(Wd):null},i.Lg=function(){return this.h.enabled&&this.g&&this.g.has(Yd)?1e3*this.g.get(Yd):null},i.ei=function(){return this.h.enabled&&this.g&&this.g.has($d)?this.g.get($d):null},i.fi=function(){return this.h.enabled&&this.g&&this.g.has(Xd)?this.g.get(Xd):null},i.getBandwidthEstimate=function(e){var t=this.Lg();if(!t)return e;var n=this.h.estimatedThroughputWeightRatio;return 0<n&&1>=n?e*(1-n)+t*n:e},K("shaka.util.CmsdManager",Zd),Zd.prototype.getBandwidthEstimate=Zd.prototype.getBandwidthEstimate,Zd.prototype.getRoundTripTime=Zd.prototype.fi,Zd.prototype.getResponseDelay=Zd.prototype.ei,Zd.prototype.getEstimatedThroughput=Zd.prototype.Lg,Zd.prototype.getMaxBitrate=Zd.prototype.Ng;var Yd="etp",Wd="mb",$d="rd",Xd="rtt";function Qd(){this.g=null,this.h=[]}function Jd(e,t){return O(function(n){if(1==n.g)return e.g?T(n,new Promise(function(t){return e.h.push(t)}),2):n.u(2);e.g=t,S(n)})}function ef(t,n){Br.call(this);var i=this;this.l=gh,this.ze=this.h=null,this.pa=!1,this.Je=new ae,this.zd=new ae,this.m=new ae,this.Fa=new ae,this.wb=new ae,this.C=this.G=this.B=this.H=null,this.Le=0,this.Z=new Qd,this.qa=this.pg=this.da=this.i=this.bb=this.F=this.j=this.rd=this.K=this.tg=this.ea=this.N=this.wd=this.L=this.Ce=this.I=this.Hb=null,this.Ea=!1,this.xa=this.o=null,this.rg=1e9,this.Hd=[],this.U=NaN,this.g=Gf(this),this.R=null,this.Ne=-1,this.Da=null,this.fa={width:1/0,height:1/0},this.xe=new Fo(this.g,this.fa,null),this.Fe=[],this.s=null,this.za=new dr(this.g.preferredAudioLanguage,this.g.preferredVariantRole,this.g.preferredAudioChannelCount,this.g.preferredVideoHdrLevel,this.g.preferSpatialAudio,this.g.preferredVideoLayout,this.g.preferredAudioLabel,this.g.preferredVideoLabel,this.g.mediaSource.codecSwitchingStrategy,this.g.manifest.dash.enableAudioGroups),this.Fb=this.g.preferredTextLanguage,this.Gd=this.g.preferredTextRole,this.Fd=this.g.preferForcedSubs,this.Ed=[],n&&n(this),this.N=Cf(this),this.ea=new Zd(this.g.cmsd),this.H=Sf(this),this.H.fg(this.g.streaming.forceHTTP),this.H.gg(this.g.streaming.forceHTTPS),this.Ib=this.aa=this.A=null,this.Ye=!1,this.sg=new Ft(function(){return O(function(e){return 1==e.g?i.aa?T(e,i.Ub(i.Ib,!0),3):e.u(0):4!=e.g?T(e,i.load(i.aa),4):(i.Ye?i.Ib.pause():i.Ib.play(),i.aa=null,i.Ye=!1,void S(e))})}),bh&&(this.A=bh(),this.A.configure(this.g.ads),this.wb.D(this.A,"ad-content-pause-requested",function(e){var t,n;return O(function(r){if(1==r.g)return i.sg.stop(),i.aa?r.u(0):(i.Ib=i.h,i.Ye=i.h.ended,t=e.saveLivePosition||!1,n=i,T(r,i.Eg(!0,t),3));n.aa=r.h,S(r)})}),this.wb.D(this.A,"ad-content-resume-requested",function(e){if(e=e.offset||0,i.aa){var t=i.aa;t.A&&e&&(t.A+=e)}i.sg.Y(.1)}),this.wb.D(this.A,"ad-content-attach-requested",function(){return O(function(e){return i.h||!i.Ib?e.u(0):T(e,i.Ub(i.Ib,!0),0)})})),this.Je.D(e,"online",function(){ah(i),i.Zf()}),this.Ee=new Ft(function(){for(var e=Date.now()/1e3,t=!1,n=!0,r=c(i.i.variants),a=r.next();!a.done;a=r.next())a=a.value,0<a.disabledUntilTime&&a.disabledUntilTime<=e&&(a.disabledUntilTime=0,t=!0),0<a.disabledUntilTime&&(n=!1);n&&i.Ee.stop(),t&&$f(i,!1,void 0,!1,!1)}),this.ra=null,t&&(pe("Player w/ mediaElement","Please migrate from initializing Player with a mediaElement; use the attach method instead."),this.Ub(t,!0))}function tf(e){null!=e.K&&(zs(e.K),e.K.release(),e.K=null)}function nf(e,t){t.lcevc.enabled?(tf(e),null==e.K&&(e.K=new Ks(e.h,e.tg,t.lcevc),e.G&&(e.G.Z=e.K))):tf(e)}function rf(e,t){return new Or(e,t)}function af(e,t){e.dispatchEvent(rf("onstatechange",(new Map).set("state",t)))}function of(e,t){var n;return O(function(i){return 1==i.g?(n=++e.Le,T(i,Jd(e.Z,t),2)):n!=e.Le?(e.Z.release(),i.return(!0)):i.return(!1)})}function sf(e){for(var t=c(e.i.variants),n=t.next();!n.done;n=t.next())n=n.value,n.video&&(n.video.closeSegmentIndex(),n.video=null),n.bandwidth=n.audio&&n.audio.bandwidth?n.audio.bandwidth:0;e.i.variants=e.i.variants.filter(function(e){return e.audio})}function lf(e,t){var n,i;return t=void 0!==t&&t,O(function(r){if(1==r.g)return n=null,e.i&&e.F&&e.bb&&e.da?(i=e.h.currentTime,e.V()&&!t&&(i=null),T(r,cf(e,e.da,i,e.pg,!0,!1,!1),3)):r.u(2);if(2!=r.g){n=r.h,e.Fe.push(n),e.F&&e.F.setMediaElement&&e.F.setMediaElement(null);var a=n,o=e.F,s=e.bb;a.h=e.i,a.j=o,a.F=s,a=n,o=e.xa,a.i=e.o,a.B=o,n.o=e.za,n.start(),e.i=null,e.F=null,e.bb=null,e.o=null,e.xa=null}return r.return(n)})}function uf(e,t,n,i,r){var a,o,s;return r=void 0!==r&&r,O(function(l){return 1==l.g?i?l.u(2):T(l,df(e,t),3):(2!=l.g&&(i=l.h),ff(e,i)?l.return(null):(a=!1,o=!0,r&&(e.o&&e.xa==e.g.abrFactory&&(o=!1),e.h&&"AUDIO"===e.h.nodeName&&(a=!0)),s=cf(e,t,n,i||null,!r,a,o),r||(s=s.then(function(t){return e.Fe.push(t),t})),l.return(s)))})}function cf(e,t,n,i,r,a,o){var s,l,u,d,f,h,p,g,m,v,y,_,b,E,w;return r=void 0===r||r,a=void 0!==a&&a,o=void 0===o||o,O(function(A){return 1==A.g?(s=null,l=yi(e.g),a&&(l.manifest.disableVideo=!0),u=function(){return s.R&&s.s?null:s},d=function(){return u()?u().getConfiguration():e.g},f=function(t,n){u()?s.configure(t,n):e.configure(t,n)},1/0!=e.fa.width||1/0!=e.fa.height?A.u(2):T(A,ln(),3)):(2!=A.g&&(h=A.h,e.fa.width=h.width,e.fa.height=h.height),p=new Fo(l,e.fa,null),g={networkingEngine:e.H,filter:function(e){var t,n;return O(function(i){return 1==i.g?T(i,Uo(p,e),2):4!=i.g?(t=i.h,t?(n=rf("trackschanged"),T(i,Promise.resolve(),4)):i.u(0)):(s.dispatchEvent(n),void S(i))})},makeTextStreamsForClosedCaptions:function(t){return jf(e,t)},onTimelineRegionAdded:function(e){var t=s.G;e:{for(var n=c(t.g),i=n.next();!i.done;i=n.next())if(i=i.value,i.schemeIdUri==e.schemeIdUri&&i.id==e.id&&i.startTime==e.startTime&&i.endTime==e.endTime){n=i;break e}n=null}null==n&&(t.g.add(e),e=new Or("regionadd",new Map([["region",e]])),t.dispatchEvent(e))},onEvent:function(e){return s.dispatchEvent(e)},onError:function(e){return s.onError(e)},isLowLatencyMode:function(){return d().streaming.lowLatencyMode},isAutoLowLatencyMode:function(){return d().streaming.autoLowLatencyMode},enableLowLatencyMode:function(){f("streaming.lowLatencyMode",!0)},updateDuration:function(){e.j&&s.R&&e.j.updateDuration()},newDrmInfo:function(e){var t=s.l,n=t?t.g:null;n&&t.s&&Go(p,n.keySystem,e)},onManifestUpdated:function(){var t=(new Map).set("isLive",e.V());s.dispatchEvent(rf("manifestupdated",t)),Bc(s,!1,function(){e.A&&e.A.onManifestUpdated(e.V())})},getBandwidthEstimate:function(){return e.o.getBandwidthEstimate()},onMetadata:function(t,n,i,r){var a=t;"com.apple.hls.interstitial"==t&&(a="com.apple.quicktime.HLS",t={startTime:n,endTime:i,values:r},e.A)&&e.A.onInterstitialMetadata(e,e.h,t),t={},r=c(r);for(var o=r.next();!o.done;t={Re:t.Re},o=r.next())t.Re=o.value,Bc(s,!1,function(t){return function(){Ef(e,n,i,a,t.Re)}}(t))},disableStream:function(t){return e.disableStream(t,e.g.streaming.maxDisabledTime)}},m=new xu(function(){return e.Qb()}),m.addEventListener("regionadd",function(t){var n=t.region;sh(e,"timelineregionadded",n,s),Bc(s,!1,function(){e.A&&e.A.onDashTimedMetadata(n)})}),v=null,l.streaming.observeQualityChanges&&(v=new Ru(function(){return e.yb()}),v.addEventListener("qualitychange",function(t){lh(e,t.quality,t.position)}),v.addEventListener("audiotrackchange",function(t){lh(e,t.quality,t.position,!0)})),y=!0,_={Nb:e.H,onError:function(e){return s.onError(e)},Ae:function(t){Bc(s,!0,function(){var n=t,i=rf("keystatuschanged");e.dispatchEvent(i);var r=Object.keys(n);1==r.length&&""==r[0]&&(r=["00"],n={"00":n[""]}),i=1==r.length&&"00"==r[0];var a=!1;if(r.length){r=c(e.i.variants);for(var o=r.next();!o.done;o=r.next()){o=o.value;var s=[];o.audio&&s.push(o.audio),o.video&&s.push(o.video),s=c(s);for(var l=s.next();!l.done;l=s.next()){var u=l.value;if(l=o.allowedByKeySystem,u.keyIds.size){o.allowedByKeySystem=!0,u=c(u.keyIds);for(var d=u.next();!d.done;d=u.next())d=d.value,((d=n[i?"00":d])||e.B.F)&&(o.allowedByKeySystem=o.allowedByKeySystem&&!!d&&!Vo.includes(d))}l!=o.allowedByKeySystem&&(a=!0)}}}a&&(eh(e),!Yf(e))||(n=e.j.j)&&!n.allowedByKeySystem&&$f(e)})},onExpirationUpdated:function(e,t){var n=rf("expirationupdated");s.dispatchEvent(n),(n=s.j)&&n.onExpirationUpdated&&n.onExpirationUpdated(e,t)},onEvent:function(t){s.dispatchEvent(t),"drmsessionupdate"==t.type&&y&&(y=!1,t=Date.now()/1e3-s.ra,(e.s||s.getStats()).j=t,e.K&&zs(e.K))}},b=Sf(e,u),Kr(e.H,b),E=function(){return e.Dc(_)},w={config:l,Di:g,Mi:m,Li:v,Dc:E,Ci:p,networkingEngine:b,Fh:r,Eh:o},s=new Uc(t,i,n,w),A.return(s))})}function df(e,t){var n,i;return O(function(r){return 1==r.g?(n=e.g.manifest.retryParameters,T(r,rd(t,e.H,n),2)):(i=r.h,"application/x-mpegurl"==i&&Wt()&&(i="application/vnd.apple.mpegurl"),r.return(i))})}function ff(e,t){if(!Ut())return!0;if(t){if(""==(e.h||on()).canPlayType(t))return!1;if(!(Ut()&&t in zo))return!0;if(qn(t))return Wt()&&(e.g.drm.servers["com.apple.fps"]||e.g.drm.servers["com.apple.fps.1_0"])?e.g.streaming.useNativeHlsForFairPlay:e.g.streaming.preferNativeHls}return!1}function hf(e){var t,n,i,r,a;return O(function(o){if(1==o.g)return af(e,"media-source"),t=e.g.textDisplayFactory,n=t(),n.configure?n.configure(e.g.textDisplayer):pe("Text displayer w/ configure",'Text displayer should have a "configure" method!'),e.qg=t,i=Rf(e.h,n,{Xh:function(){return e.keySystem()},onMetadata:function(t,n,i){bf(e,t,n,i)}},e.K),i.configure(e.g.mediaSource),r=e.g.manifest,a=r.segmentRelativeVttTiming,i.fa=a,T(o,i.L,2);e.G=i,S(o)})}function pf(e,t,n,i){var r,a,o,s,l,u,d,f,h,p,g,m,v,y,_,b,E,w,A,I,x,R;return O(function(C){switch(C.g){case 1:af(e,"load"),r=e.h,e.I=new au({ie:function(){return r.playbackRate},nc:function(){return r.defaultPlaybackRate},hg:function(e){r.playbackRate=e},Yg:function(e){r.currentTime+=e}}),a=function(){return zf(e)},o=function(){return Kf(e)},e.m.D(r,"playing",a),e.m.D(r,"pause",a),e.m.D(r,"ended",a),e.m.D(r,"ratechange",o),nf(e,e.g),e.Fb=e.g.preferredTextLanguage,e.Gd=e.g.preferredTextRole,e.Fd=e.g.preferForcedSubs,ch(e.i.presentationTimeline,e.g.playRangeStart,e.g.playRangeEnd),e.o.init(function(t,n,i){e.i&&e.j&&t!=e.j.j&&Xf(e,t,!0,void 0!==n&&n,void 0===i?0:i)}),e.o.setMediaElement(r),e.o.setCmsdManager(e.ea),e.j=Df(e),e.j.configure(e.g.streaming),e.l=mh,r.textTracks&&e.m.D(r.textTracks,"addtrack",function(t){if(t.track)switch(t=t.track,t.kind){case"chapters":Tf(e,t)}}),e.dispatchEvent(rf("streaming")),s=n;case 2:for((u=e.j.j)||s||(s=Wf(e,!0)),d=[],l=u||s,f=c([l.video,l.audio]),h=f.next();!h.done;h=f.next())(p=h.value)&&!p.segmentIndex&&d.push(p.createSegmentIndex());if(!(0<d.length)){C.u(4);break}return T(C,Promise.all(d),4);case 4:if(!l||0!=l.disabledUntilTime){C.u(2);break}if(e.F&&e.F.onInitialVariantChosen&&e.F.onInitialVariantChosen(l),e.i.isLowLatency&&!e.g.streaming.lowLatencyMode&&Q("Low-latency live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details."),ch(e.i.presentationTimeline,e.g.playRangeStart,e.g.playRangeEnd),Hu(e.j,e.g.playRangeStart,e.g.playRangeEnd),g=function(t){e.C=wf(e,t),e.Hb=Af(e,t),If(e,r,Math.max(e.i.minBufferTime,e.g.streaming.rebufferingGoal))},e.g.streaming.startAtSegmentBoundary||g(e.qa),u){C.u(7);break}if(!e.g.streaming.startAtSegmentBoundary){C.u(8);break}return m=e.i.presentationTimeline,v=e.qa||e.h.currentTime,y=m.Yb(),_=m.Ab(),v<y?v=y:v>_&&(v=_),T(C,Vf(s,v),9);case 9:b=C.h,g(b);case 8:Xf(e,s,!0,!1,0);case 7:return e.C.$e(),E=e.Hc().find(function(e){return e.active}),E||((w=Yi(e.i.textStreams,e.Fb,e.Gd,e.Fd)[0]||null)&&hu(e.s.h,w,!0),s&&(w?(Jf(e,s.audio,w)&&(e.pa=!0),e.pa&&e.G.F.setTextVisibility(!0),ih(e)):e.pa=!1),w&&(e.g.streaming.alwaysStreamText||e.Kf())&&Yu(e.j,w)),T(C,e.j.start(i),10);case 10:e.g.abr.enabled&&(e.o.enable(),rh(e)),eh(e),Yf(e),e.i.variants.some(function(e){return e.primary}),((A=e.V())&&(e.g.streaming.liveSync&&e.g.streaming.liveSync.enabled||e.i.serviceDescription||e.g.streaming.liveSync.panicMode)||e.g.streaming.vodDynamicPlaybackRate)&&(I=function(){return Zf(e)},e.m.D(r,"timeupdate",I)),A||(x=function(){return qf(e)},e.m.D(r,"timeupdate",x),qf(e),e.i.nextUrl&&(0<e.g.streaming.preloadNextUrlWindow&&(R=function(){var t,n;return O(function(i){if(1==i.g)return t=e.h.duration-e.h.currentTime,!isNaN(t)&&t<=e.g.streaming.preloadNextUrlWindow?(e.m.lb(r,"timeupdate",R),n=e,T(i,e.preload(e.i.nextUrl),4)):i.u(0);n.ra=i.h,S(i)})},e.m.D(r,"timeupdate",R)),e.m.D(r,"ended",function(){e.load(e.ra||e.i.nextUrl)}))),e.A&&e.A.onManifestUpdated(A),e.Ea=!0,e.m.ha(r,"loadedmetadata",function(){e.s.m=Date.now()/1e3-t}),S(C)}})}function gf(e,t){var n,i,r,a,o;return O(function(s){return 1==s.g?(n=Pn,i=Date.now()/1e3,r=!0,e.B=e.Dc({Nb:e.H,onError:function(t){oh(e,t)},Ae:function(){},onExpirationUpdated:function(){var t=rf("expirationupdated");e.dispatchEvent(t)},onEvent:function(t){e.dispatchEvent(t),"drmsessionupdate"==t.type&&r&&(r=!1,e.s.j=Date.now()/1e3-i)}}),e.B.configure(e.g.drm),a={id:0,language:"und",disabledUntilTime:0,primary:!1,audio:null,video:null,bandwidth:100,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},o={id:0,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:t?zn(t):"",codecs:t?Zn(t):"",encrypted:!0,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:n.ga,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set},o.fullMimeTypes.add(Un(o.mimeType,o.codecs)),t.startsWith("audio/")?(o.type=n.X,a.audio=o):a.video=o,e.B.aa=!0,T(s,no(e.B,[a],[]),2)):T(s,e.B.Ub(e.h),0)})}function mf(e,t,n){var i,r,a,o,s,l,u,c,d,f,h;return O(function(p){if(1==p.g)return af(e,"src-equals"),i=e.h,e.C=new Wl(i),r=!1,e.Ed.push(function(){r=!0}),null!=e.qa&&e.C.af(e.qa),e.I=new au({ie:function(){return i.playbackRate},nc:function(){return i.defaultPlaybackRate},hg:function(e){i.playbackRate=e},Yg:function(e){i.currentTime+=e}}),a=e.g.streaming.rebufferingGoal,If(e,i,a),o=function(){return zf(e)},s=function(){return Kf(e)},e.m.D(i,"playing",o),e.m.D(i,"pause",o),e.m.D(i,"ended",o),e.m.D(i,"ratechange",s),"none"!=i.preload&&e.m.ha(i,"loadedmetadata",function(){e.s.m=Date.now()/1e3-t}),i.audioTracks&&(e.m.D(i.audioTracks,"addtrack",function(){return eh(e)}),e.m.D(i.audioTracks,"removetrack",function(){return eh(e)}),e.m.D(i.audioTracks,"change",function(){return eh(e)})),i.textTracks&&(e.m.D(i.textTracks,"addtrack",function(t){if(t.track)switch(t=t.track,t.kind){case"metadata":_f(e,t);break;case"chapters":Tf(e,t);break;default:eh(e)}}),e.m.D(i.textTracks,"removetrack",function(){return eh(e)}),e.m.D(i.textTracks,"change",function(){return eh(e)})),i.src=Rd(e.N,e.da,n),(Vt()||zt())&&i.load(),"none"!=i.preload&&!i.autoplay&&qn(n)&&en()&&i.load(),e.l=vh,e.dispatchEvent(rf("streaming")),l=new Rr,Gl(i,HTMLMediaElement.HAVE_METADATA,e.m,function(){e.C.$e(),l.resolve()}),Gl(i,HTMLMediaElement.HAVE_CURRENT_DATA,e.m,function(){var t;return O(function(n){return 1==n.g?(vf(e),t=Lf(e),t.find(function(e){return"disabled"!=e.mode})?(0<t.length&&(e.pa=!0),n.u(2)):T(n,new Promise(function(t){e.m.ha(i.textTracks,"change",t),new Ft(t).Y(1)}),2)):r?n.return():(yf(e),void S(n))})}),i.error?l.reject(uh(e)):"none"==i.preload&&(Q('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),l.resolve()),e.m.ha(i,"error",function(){l.reject(uh(e))}),u=new Promise(function(t,n){new Ft(n).Y(e.g.streaming.loadTimeout)}),T(p,Promise.race([l,u]),2);((c=e.V())&&(e.g.streaming.liveSync&&e.g.streaming.liveSync.enabled||e.g.streaming.liveSync.panicMode)||e.g.streaming.vodDynamicPlaybackRate)&&(d=function(){return Zf(e)},e.m.D(i,"timeupdate",d)),c||(f=function(){return qf(e)},e.m.D(i,"timeupdate",f),qf(e)),e.A&&(e.A.onManifestUpdated(c),c&&(h=e.Qb().end,e.m.D(i,"progress",function(){var t=e.Qb().end;h!=t&&(e.A.onManifestUpdated(e.V()),h=t)}))),e.Ea=!0,S(p)})}function vf(e){var t=e.g.preferredAudioLanguage;""!=t&&e.gh(t,e.g.preferredVariantRole)}function yf(e){var t=e.g.preferredTextLanguage;""!=t&&e.bg(t,e.g.preferredTextRole,e.g.preferForcedSubs)}function _f(e,t){if("metadata"==t.kind){t.mode="hidden",e.m.D(t,"cuechange",function(){if(t.activeCues){for(var n=[],i={},r=c(t.activeCues),a=r.next();!a.done;i={Ma:i.Ma},a=r.next())i.Ma=a.value,Ef(e,i.Ma.startTime,i.Ma.endTime,i.Ma.type,i.Ma.value),e.A&&e.A.onCueMetadataChange(i.Ma.value),"com.apple.quicktime.HLS"==i.Ma.type&&null!=i.Ma.startTime&&(a=n.find(function(e){return function(t){return t.startTime==e.Ma.startTime&&t.endTime==e.Ma.endTime}}(i)),a||(a={startTime:i.Ma.startTime,endTime:i.Ma.endTime,values:[]},n.push(a)),a.values.push(i.Ma.value));for(n=c(n),i=n.next();!i.done;i=n.next())i=i.value,i.values.some(function(e){return"X-ASSET-URI"==e.key||"X-ASSET-LIST"==e.key})&&e.A&&(i.values.push({key:"CUE",description:"",data:"ONCE",mimeType:null,pictureType:null}),e.A.onInterstitialMetadata(e,e.h,i))}});var n=new Ft(function(){var t=Pf(e);t=c(t);for(var n=t.next();!n.done;n=t.next())n.value.mode="hidden"}).xc().Y(.5);e.Ed.push(function(){n.stop()})}}function bf(e,t,n,i){t=c(t);for(var r=t.next();!r.done;r=t.next())if(r=r.value,r.data&&"number"==typeof r.cueTime&&r.frames){var a=r.cueTime+n,o=i;o&&a>o&&(o=a);for(var s=c(r.frames),l=s.next();!l.done;l=s.next())Ef(e,a,o,"org.id3",l.value);e.A&&e.A.onHlsTimedMetadata(r,a)}}function Ef(e,t,n,i,r){t=(new Map).set("startTime",t).set("endTime",n).set("metadataType",i).set("payload",r),e.dispatchEvent(rf("metadata",t))}function Tf(e,t){if(t&&"chapters"==t.kind){t.mode="hidden";var n=new Ft(function(){t.mode="hidden"}).xc().Y(.5);e.Ed.push(function(){n.stop()})}}function Sf(e,t){function n(n){t()?t().dispatchEvent(n):e.dispatchEvent(n)}function i(e){t()?Bc(t(),!0,e):e()}return t||(t=function(){return null}),new Vr(function(n,i,r,a){var o=t()?t().i:e.o;o&&o.segmentDownloaded(n,i,r,a)},function(t,r,a){r=(new Map).set("headers",t).set("request",r).set("requestType",a),n(rf("downloadheadersreceived",r)),i(function(){if(e.ea){var n=e.ea;if(n.h.enabled){var i=t["cmsd-static"];if(i)try{var r=new Map,a=i.split(",");for(i=0;i<a.length;i++){var o=a[i].split("=");r.set(o[0],qd(o[1]))}}catch(e){}if(r=t["cmsd-dynamic"]){try{var s=new Map,l=r.split(";");for(r=1;r<l.length;r++){var u=l[r].split("=");s.set(u[0],qd(u[1]))}var c=s}catch(e){c=null}c&&(n.g=c)}}}})},function(e,t,i,r){e=(new Map).set("request",e).set("error",t).set("httpResponseCode",i).set("aborted",r),n(rf("downloadfailed",e))},function(t,n,r){i(function(){var i=e.N,a=r;if(a=void 0===a?{}:a,i.g.enabled)if("HEAD"===n.method)Dd(i,n);else switch(t){case 0:try{if(i.g.enabled){if(a.type){e:{switch(a.type){case 4:var o="d";break e;case 3:case 2:o="h";break e;case 5:o="s";break e}o=void 0}i.m=o}Dd(i,n,{ot:Bd,su:!i.i})}}catch(e){J("CMCD_MANIFEST_ERROR","Could not generate manifest CMCD data.",e)}break;case Qr:try{if(i.g.enabled){var s=a.segment;o=0,s&&(o=s.endTime-s.startTime);var l={d:1e3*o,st:i.h.V()?"l":"v"};l.ot=Md(a);var u=l.ot===jd||l.ot===Gd||l.ot===Vd||l.ot===zd,c=a.stream;if(c){var d=i.h.fb();if(u&&(l.bl=Ld(i,c.type),l.ot!==zd)){var f=Pd(i,c.type);l.dl=d?f/Math.abs(d):f}if(c.bandwidth&&(l.br=c.bandwidth/1e3),c.segmentIndex&&s){var h=c.segmentIndex.Kb(s.endTime,!0,0>d);if(h){var p=h.next().value;if(p&&p!=s){if(!Ue(s.M(),p.M())){var g=p.M()[0],m=n.uris[0],v=new URL(g),y=new URL(m);if(v.origin!==y.origin)var _=g;else{for(var b=v.pathname.split("/").slice(1),E=y.pathname.split("/").slice(1,-1);b[0]===E[0];)b.shift(),E.shift();for(;E.length;)E.shift(),b.unshift("..");_=b.join("/")}l.nor=_}if((p.Ha||p.sa)&&(s.Ha!=p.Ha||s.sa!=p.sa)){var T=p.Ha+"-";p.sa&&(T+=p.sa),l.nrr=T}}}var S=i.h.fb()||1,w=Pd(i,c.type)||500,A=c.bandwidth,I=A?A*(s.endTime-s.startTime)/1e3/(w/S/1e3)*i.g.rtpSafetyFactor:NaN;isNaN(I)||(l.rtp=I)}}u&&l.ot!==zd&&(l.tb=Nd(i,l.ot)/1e3),Dd(i,n,l)}}catch(e){J("CMCD_SEGMENT_ERROR","Could not generate segment CMCD data.",e)}break;case 2:case 5:case 6:Dd(i,n,{ot:"k"});break;case 4:Dd(i,n,{ot:"o"})}})},function(n,i,r,a){(n=t()?t().j:e.F)&&n.banLocation&&n.banLocation(a)},function(n,i){if(i.data){i=i.data.byteLength;var r=t()?t().getStats():e.s;r&&(r.ae=isNaN(r.ae)?i:r.ae+i,0===n&&(r.Ug=i))}})}function wf(e,t){return new $l(e.h,e.i,e.g.streaming,t,function(){e.Hb&&lu(e.Hb,!0),e.j&&e.j.Nd(),e.L&&xf(e)},function(t){return e.dispatchEvent(t)})}function Af(e,t){t=new Jc(e.wd,e.V()||0<t),t.addEventListener("enter",function(t){sh(e,"timelineregionenter",t.region)}),t.addEventListener("exit",function(t){sh(e,"timelineregionexit",t.region)}),t.addEventListener("skip",function(t){var n=t.region;t.seeking||(sh(e,"timelineregionenter",n),sh(e,"timelineregionexit",n))});var n=new su(e.h);return n.g.add(t),e.rd&&n.g.add(e.rd),n}function If(e,t,n){e.L=new Er,e.L.g=Sr,Tr(e.L,n,Math.min(.5,n/2)),Hf(e),e.Ce=new Ft(function(){xf(e)}).Sa(.25),e.m.D(t,"waiting",function(){return xf(e)}),e.m.D(t,"stalled",function(){return xf(e)}),e.m.D(t,"canplaythrough",function(){return xf(e)}),e.m.D(t,"progress",function(){return xf(e)})}function xf(e){switch(e.l){case vh:if(e.h.ended)var t=!0;else{var n=is(e.h.buffered);t=null!=n&&n>=e.h.duration-1}break;case mh:e:if(e.h.ended||al(e.G))t=!0;else{if(e.i.presentationTimeline.V()){n=e.i.presentationTimeline.Zb();var i=is(e.h.buffered);if(null!=i&&i>=n){t=!0;break e}}t=!1}break;default:t=!1}i=as(e.h.buffered,e.h.currentTime),n=e.L;var r=t,a=n.i.get(n.g);t=n.g,i=r||i>=a?wr:Sr,n.g=i,(t=t!=i)&&i===wr&&(n.h=Date.now()),t&&Hf(e)}function Rf(e,t,n,i){return new Js(e,t,n,i)}function Cf(e){return new Id({getBandwidthEstimate:function(){return e.o?e.o.getBandwidthEstimate():NaN},yb:function(){return e.yb()},getCurrentTime:function(){return e.h?e.h.currentTime:0},fb:function(){return e.fb()},zb:function(){return e.zb()},oc:function(){return e.oc()},V:function(){return e.V()}},e.g.cmcd)}function Df(e){return new ju(e.i,{he:function(){return e.C?e.C.$d():0},getBandwidthEstimate:function(){return e.o.getBandwidthEstimate()},fb:function(){return e.fb()},ca:e.G,Nb:e.H,onError:function(t){return oh(e,t)},onEvent:function(t){return e.dispatchEvent(t)},Ii:function(){e.F&&e.F.update&&e.F.update()},Sf:function(t,n){var i=t.startTime,r=t.endTime,a=n.type,o=n.codecs.includes(",");if(e.C){e.C.Zg();var s=ol(e.G,a);!e.V()&&e.h.paused&&null!=s&&0<s&&e.C.$d()<s&&e.C.af(s)}xf(e),i=(new Map).set("start",i).set("end",r).set("contentType",a).set("isMuxed",o),e.dispatchEvent(rf("segmentappended",i)),e.o&&n.fastSwitching&&t.Kd&&t.pe&&e.o.trySuggestStreams()},Hi:function(t,n){(n=n.Lc)&&e.rd&&Du(e.rd,n,t)},yg:function(t,n){var i=e.B;if(i.h.parseInbandPsshEnabled&&!i.F&&["audio","video"].includes(t)){n=new Ea(we(n));var r=0,a=c(n.data);for(t=a.next();!t.done;t=a.next())r+=t.value.length;if(0==r)i=Promise.resolve();else{for(r=new Uint8Array(r),a=0,n=c(n.data),t=n.next();!t.done;t=n.next())t=t.value,r.set(t,a),a+=t.length;co(i,"cenc",r),i=i.l}}else i=Promise.resolve();return i},onMetadata:function(t,n,i){bf(e,t,n,i)},disableStream:function(t,n){return e.disableStream(t,n)}})}function kf(e){if(e.xe=new Fo(e.g,e.fa,e.B),e.F){var t=yi(e.g.manifest);e.h&&"AUDIO"===e.h.nodeName&&(t.disableVideo=!0),e.F.configure(t)}if(e.B&&e.B.configure(e.g.drm),e.j){e.j.configure(e.g.streaming);try{e.l!=ph&&Bo(e.xe,e.i)&&eh(e)}catch(t){oh(e,t)}e.o&&Yf(e),t=e.j.j,!t||t.allowedByApplication&&t.allowedByKeySystem||$f(e)}if(e.H&&(e.H.fg(e.g.streaming.forceHTTP),e.H.gg(e.g.streaming.forceHTTPS)),e.G)if(e.G.configure(e.g.mediaSource),e.G.fa=e.g.manifest.segmentRelativeVttTiming,t=e.g.textDisplayFactory,e.qg!=t){var n=t();n.configure?n.configure(e.g.textDisplayer):pe("Text displayer w/ configure",'Text displayer should have a "configure" method!');var i=e.G,r=i.F;i.F=n,r&&(n.setTextVisibility(r.isTextVisible()),r.destroy()),i.g&&(i.g.j=n),e.qg=t,e.j&&(t=e.j,(n=t.i.get(Ln))&&Wu(t,n.stream,!0,0,!0))}else t=e.G.F,t.configure&&t.configure(e.g.textDisplayer);e.o&&(e.o.configure(e.g.abr),e.g.abr.enabled?e.o.enable():e.o.disable(),rh(e)),e.L&&(t=e.g.streaming.rebufferingGoal,e.i&&(t=Math.max(t,e.i.minBufferTime)),Tr(e.L,t,Math.min(.5,t/2))),e.i&&ch(e.i.presentationTimeline,e.g.playRangeStart,e.g.playRangeEnd),e.A&&e.A.configure(e.g.ads),e.N&&e.N.configure(e.g.cmcd),e.ea&&e.ea.configure(e.g.cmsd)}function Mf(e){return e&&(e=/(\d+)x(\d+)/.exec(e))?{kc:parseInt(e[1],10),rows:parseInt(e[2],10)}:null}function Lf(e){return Array.from(e.h.textTracks).filter(function(e){return"metadata"!=e.kind&&"chapters"!=e.kind&&"Shaka Player TextTrack"!=e.label})}function Pf(e){return Array.from(e.h.textTracks).filter(function(e){return"metadata"==e.kind})}function Nf(e){return Array.from(e.h.textTracks).filter(function(e){return"chapters"==e.kind})}function Of(e,t){var n;return O(function(i){switch(i.g){case 1:return w(i,2),T(i,rd(t,e.H,e.g.streaming.retryParameters),4);case 4:n=i.h,I(i,3);break;case 2:x(i);case 3:if(n)return i.return(n);throw new Rt(1,2,2011,t)}})}function Ff(e,t,n,i,r,a,o){var s,l,u,c;return O(function(d){if(1==d.g)return"text/vtt"!=r||o.length?T(d,Uf(e,t,e.H,e.g.streaming.retryParameters),3):d.u(2);2!=d.g&&(s=d.h,l=Bf(e,s,r,o),u=new Blob([l],{type:"text/vtt"}),t=kl(u),r="text/vtt"),c=document.createElement("track");var f=e.N,h=t;try{if(f.g.enabled){var p=Cd(f);p.ot=Kd,p.su=!0;var g=Od(p),m=Ud(h,g)}else m=h}catch(e){J("CMCD_TEXT_TRACK_ERROR","Could not generate text track CMCD data.",e),m=h}return c.src=m,c.label=a,c.kind=i,c.srclang=n,e.h.getAttribute("crossorigin")||e.h.setAttribute("crossorigin","anonymous"),e.h.appendChild(c),d.return(c)})}function Uf(e,t,n,i){var r,a,o;return O(function(s){if(1==s.g){r=Qr,a=zr([t],i),a.method="GET";var l=e.N;try{l.g.enabled&&Dd(l,a,{ot:Kd,su:!0})}catch(e){J("CMCD_TEXT_ERROR","Could not generate text CMCD data.",e)}return T(s,n.request(r,a).promise,2)}return o=s.h,s.return(o.data)})}function Bf(e,t,n,i){var r=ri[n];if(r)return n=r(),e={periodStart:0,segmentStart:0,segmentEnd:e.h.duration,vttOffset:0},t=we(t),t=n.parseMedia(t,e,null),Ad(t,i);throw new Rt(2,2,2014,n)}function Gf(e){var t=Lc();return t.streaming.failureCallback=function(t){if(e.V()){var n=null;1001==t.code||1002==t.code?(n=1,e.g.streaming.lowLatencyMode&&(n=.1)):1003==t.code&&(n=.1),null!=n&&(t.severity=1,e.Zf(n))}},t.textDisplayFactory=function(){if(e.ze){var t=e.getConfiguration();return new md(e.h,e.ze,t.textDisplayer)}return HTMLMediaElement.prototype.addTextTrack?new dd(e.h,"Shaka Player TextTrack"):new hd},t}function jf(e,t){for(var n=new Set,i=c(t.textStreams),r=i.next();!r.done;r=i.next())r=r.value,"application/cea-608"!=r.mimeType&&"application/cea-708"!=r.mimeType||n.add(r.originalId);for(i=c(t.variants),r=i.next();!r.done;r=i.next())if((r=r.value.video)&&r.closedCaptions)for(var a=c(r.closedCaptions.keys()),o=a.next();!o.done;o=a.next())if(o=o.value,!n.has(o)){var s=o.startsWith("CC")?"application/cea-608":"application/cea-708",l=new ru,u=r.closedCaptions.get(o);s={id:e.rg++,originalId:o,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:l,mimeType:s,codecs:"",kind:"caption",encrypted:!1,drmInfos:[],keyIds:new Set,language:u,originalLanguage:u,label:null,type:Ln,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:r.roles,forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set([Un(s,"")])},t.textStreams.push(s),n.add(o)}}function Vf(e,t){var n,i,r,a,o;return O(function(s){return 1==s.g?(n=e.audio,i=e.video,r=function(e,t){var n,i,r;return O(function(a){return 1==a.g?e?T(a,e.createSegmentIndex(),2):a.return(null):(i=(n=e.segmentIndex.Kb(t))?n.next().value:null,i?(r=i.startTime,a.return(r)):a.return(null))})},T(s,r(n,t),2)):3!=s.g?(a=s.h,T(s,r(i,t),3)):(o=s.h,null!=o&&null!=a?s.return(Math.max(o,a)):null!=o?s.return(o):null!=a?s.return(a):s.return(t))})}function Hf(e){var t=e.Jf();if(e.s&&e.L&&e.C){var n=e.I;if(n.j=t,ou(n),e.N&&(n=e.N,t||n.i||(n.i=!0),n.i&&t&&(n.j=!0),n.l=t),zf(e),n=e.g.streaming.liveSync.dynamicTargetLatency.maxAttempts,e.g.streaming.liveSync.dynamicTargetLatency.enabled&&t&&e.Ne<n){n=e.g.streaming.liveSync.dynamicTargetLatency.maxLatency;var i=e.g.streaming.liveSync.targetLatencyTolerance,r=e.g.streaming.liveSync.dynamicTargetLatency.rebufferIncrement;e.R&&(e.R=Math.min(e.R+ ++e.Ne*r,n-i))}}t=(new Map).set("buffering",t),e.dispatchEvent(rf("buffering",t))}function Kf(e){var t=e.h.playbackRate;0!=t&&(e.I&&e.I.set(t),t=rf("ratechange"),e.dispatchEvent(t))}function zf(e){if(e.s&&e.L){var t=e.s.g,n="playing";e.L.g==Sr?n="buffering":e.h.paused?n="paused":e.h.ended&&(n="ended");var i=n;if(null==t.g)t.g={timestamp:Date.now()/1e3,state:i,duration:0},t=!0;else{var r=Date.now()/1e3;t.g.duration=r-t.g.timestamp,t.g.state==i?t=!1:(t.h.push(t.g),t.g={timestamp:r,state:i,duration:0},t=!0)}t&&(n=(new Map).set("newstate",n),e.dispatchEvent(rf("statechanged",n)))}}function Zf(e){var t=e.h.playbackRate,n=e.V();if(e.g.streaming.vodDynamicPlaybackRate&&!n){var i=e.g.streaming.vodDynamicPlaybackRateLowBufferRate,r=e.Jg();r<=e.g.streaming.vodDynamicPlaybackRateBufferRatio?t!=i&&e.Pd(i):1==r&&t!==e.I.nc()&&e.md()}if(n&&(n=e.Qb(),Number.isFinite(n.end)&&!(e.h.currentTime<n.start))){i=e.g.streaming.liveSync.targetLatencyTolerance,r=e.g.streaming.liveSync.dynamicTargetLatency.enabled;var a=e.g.streaming.liveSync.dynamicTargetLatency.stabilityThreshold;if(e.g.streaming.liveSync&&e.g.streaming.liveSync.enabled)var o=e.g.streaming.liveSync.targetLatency,s=o+i,l=Math.max(0,o-i),u=e.g.streaming.liveSync.maxPlaybackRate,c=e.g.streaming.liveSync.minPlaybackRate;else e.i&&e.i.serviceDescription&&(o=e.i.serviceDescription.targetLatency,null!=e.i.serviceDescription.targetLatency?s=e.i.serviceDescription.targetLatency+i:null!=e.i.serviceDescription.maxLatency&&(s=e.i.serviceDescription.maxLatency),null!=e.i.serviceDescription.targetLatency?l=Math.max(0,e.i.serviceDescription.targetLatency-i):null!=e.i.serviceDescription.minLatency&&(l=e.i.serviceDescription.minLatency),u=e.i.serviceDescription.maxPlaybackRate||e.g.streaming.liveSync.maxPlaybackRate,c=e.i.serviceDescription.minPlaybackRate||e.g.streaming.liveSync.minPlaybackRate);e.R||"number"!==typeof o||(e.R=o);var d=e.g.streaming.liveSync.dynamicTargetLatency.maxAttempts;r&&e.Da&&null!==e.R&&"number"===typeof o&&e.Ne<d&&Date.now()-e.Da>1e3*a&&(a=e.g.streaming.liveSync.dynamicTargetLatency.minLatency,e.R=Math.max(e.R-(o-a)/2,a+i),e.Da=Date.now()),r&&null!==e.R&&(s=e.R+i,l=e.R-i),o=n.end-e.h.currentTime,i=0,e.l==vh&&(r=e.h.buffered,0<r.length&&(i=r.end(r.length-1),i=Math.max(u,i-n.end))),n=e.g.streaming.liveSync.panicMode,r=1e3*e.g.streaming.liveSync.panicThreshold,a=Date.now()-e.L.h,n&&!c&&(c=e.g.streaming.liveSync.minPlaybackRate),n&&c&&a<=r?t!=c&&e.Pd(c):s&&u&&o-i>s?(t!=u&&e.Pd(u),e.Da=null):l&&c&&o-i<l?(t!=c&&e.Pd(c),e.Da=null):t!==e.I.nc()&&(e.md(),e.Da=Date.now())}}function qf(e){if(e.h){var t,n=!1,i=e.h.currentTime/e.h.duration;if(isNaN(i)||(i=Math.round(100*i),isNaN(e.U)?(e.U=i,n=!0):(i=Math.max(e.U,i),e.U!=i&&(e.U=i,n=!0))),n)0==e.U?t=rf("started"):25==e.U?t=rf("firstquartile"):50==e.U?t=rf("midpoint"):75==e.U?t=rf("thirdquartile"):100==e.U&&(t=rf("complete")),t&&e.dispatchEvent(t)}}function Yf(e){try{jo(e.xe,e.i)}catch(t){return oh(e,t),!1}var t=qi(e.i.variants);return t=e.za.create(t),e.o.setVariants(Array.from(t.values())),!0}function Wf(e,t){return t=void 0!==t&&t,Yf(e)?e.o.chooseVariant(t):null}function $f(e,t,n,i,r){t=void 0===t||t,n=void 0===n?0:n,i=void 0!==i&&i,r=void 0===r||r;var a=Wf(e);a&&Xf(e,a,r,t,n,i)}function Xf(e,t,n,i,r,a){a=void 0!==a&&a;var o=e.j.j;if(t==o)i&&qu(e.j,t,i,r,!0);else{var s=e.s.h;s.h!=t&&(s.h=t,s.g.push({timestamp:Date.now()/1e3,id:t.id,type:"variant",fromAdaptation:n,bandwidth:t.bandwidth})),qu(e.j,t,i,r,a,n),i=null,o&&(i=Bi(o)),t=Bi(t),n?(n=(new Map).set("oldTrack",i).set("newTrack",t),e.K&&Zs(e.K,t,e.Ff()),n=rf("adaptation",n),dh(e,n)):th(e,i,t)}}function Qf(e,t){var n=Array.from(e.h.audioTracks).find(function(e){return e.enabled});t.enabled=!0,n&&(t.id!==n.id&&(n.enabled=!1),n=Ki(n),t=Ki(t),th(e,n,t))}function Jf(e,t,n){if(0==e.g.autoShowText)return!1;if(1==e.g.autoShowText)return!0;var i=fi(e.g.preferredTextLanguage);return n=fi(n.language),2==e.g.autoShowText?ui(n,i):3==e.g.autoShowText?!!t&&(e=fi(t.language),ui(n,i)&&!ui(e,n)):(Q("Invalid autoShowText setting!"),!1)}function eh(e){var t=rf("trackschanged");dh(e,t)}function th(e,t,n){t=(new Map).set("oldTrack",t).set("newTrack",n),e.K&&Zs(e.K,n,e.Ff()),n=rf("variantchanged",t),dh(e,n)}function nh(e){var t=rf("textchanged");dh(e,t)}function ih(e){var t=rf("texttrackvisibility");dh(e,t)}function rh(e){e.g.abr.enabled||ah(e);var t=(new Map).set("newStatus",e.g.abr.enabled);dh(e,rf("abrstatuschanged",t))}function ah(e,t){if(t=void 0===t||t,e.l==mh){e.Ee.stop();for(var n=c(e.i.variants),i=n.next();!i.done;i=n.next())i.value.disabledUntilTime=0;t&&Yf(e)}}function oh(e,t){var n,i,r;return O(function(a){switch(a.g){case 1:if(e.l==ph)return a.return();if(1===t.severity&&e.s.K++,n=!0,!(e.Ea&&e.i&&e.j)||3016!=t.code&&3014!=t.code&&3015!=t.code&&3018!=t.code){a.u(2);break}return w(a,3),T(a,bc(e.j),5);case 5:i=a.h,n=!i,I(a,2);break;case 3:x(a),n=!0;case 2:if(!n)return a.return();2===t.severity&&ah(e,!1),r=rf("error",(new Map).set("detail",t)),e.dispatchEvent(r),r.defaultPrevented&&(t.handled=!0),S(a)}})}function sh(e,t,n,i){i=void 0===i?e:i,e=(new Map).set("detail",{schemeIdUri:n.schemeIdUri,value:n.value,startTime:n.startTime,endTime:n.endTime,id:n.id,eventElement:n.eventElement,eventNode:n.eventNode}),i.dispatchEvent(rf(t,e))}function lh(e,t,n,i){i=void 0!==i&&i,t=(new Map).set("mediaQuality",{bandwidth:t.bandwidth,audioSamplingRate:t.audioSamplingRate,codecs:t.codecs,contentType:t.contentType,frameRate:t.frameRate,height:t.height,mimeType:t.mimeType,channelsCount:t.channelsCount,pixelAspectRatio:t.pixelAspectRatio,width:t.width,label:t.label,roles:t.roles,language:t.language}).set("position",n),e.dispatchEvent(rf(i?"audiotrackchanged":"mediaqualitychanged",t))}function uh(e){if(!e.h.error)return null;var t=e.h.error.code;if(1==t)return null;var n=e.h.error.msExtendedCode;return n&&(0>n&&(n+=Math.pow(2,32)),n=n.toString(16)),new Rt(2,3,3016,t,n,e.h.error.message)}function ch(e,t,n){0<t&&(e.V()||e.qh(t)),t=e.getDuration(),n<t&&(e.V()||e.$a(n))}function dh(e,t){O(function(n){if(1==n.g)return T(n,Promise.resolve(),2);e.l!=ph&&e.dispatchEvent(t),S(n)})}function fh(e){var t=new Set;e=c(e);for(var n=e.next();!n.done;n=e.next())n=n.value,n.language?t.add(fi(n.language)):t.add("und");return t}function hh(e){var t=new Map,n=new Map;e=c(e);for(var i=e.next();!i.done;i=e.next()){i=i.value;var r="und",a=[];i.language&&(r=fi(i.language)),a="variant"==i.type?i.audioRoles:i.roles,a&&a.length||(a=[""]),t.has(r)||t.set(r,new Set),a=c(a);for(var o=a.next();!o.done;o=a.next())o=o.value,t.get(r).add(o),i.label&&(n.has(r)||n.set(r,new Map),n.get(r).set(o,i.label))}var s=[];return t.forEach(function(e,t){e=c(e);for(var i=e.next();!i.done;i=e.next()){i=i.value;var r=null;n.has(t)&&n.get(t).has(i)&&(r=n.get(t).get(i)),s.push({language:t,role:i,label:r})}}),s}Qd.prototype.release=function(){0<this.h.length?this.h.shift()():this.g=null},y(ef,Br),i=ef.prototype,i.destroy=function(){var e,t=this;return O(function(n){switch(n.g){case 1:return t.l==ph?n.return():(tf(t),e=t.detach(),t.l=ph,T(n,e,2));case 2:return T(n,t.lf(),3);case 3:if(t.Je&&(t.Je.release(),t.Je=null),t.zd&&(t.zd.release(),t.zd=null),t.m&&(t.m.release(),t.m=null),t.Fa&&(t.Fa.release(),t.Fa=null),t.wb&&(t.wb.release(),t.wb=null),t.xa=null,t.g=null,t.s=null,t.ze=null,t.N=null,t.ea=null,!t.H){n.u(4);break}return T(n,t.H.destroy(),5);case 5:t.H=null;case 4:t.o&&(t.o.release(),t.o=null),Br.prototype.release.call(t),S(n)}})},i.Ub=function(e,t){t=void 0===t||t;var n,i,r,a=this;return O(function(o){switch(o.g){case 1:if(a.l==ph)throw new Rt(2,7,7e3);if(n=a.h&&a.h==e,!a.h||a.h==e){o.u(2);break}return T(o,a.detach(),2);case 2:return T(o,of(a,"attach"),4);case 4:if(o.h)return o.return();if(w(o,5,6),n||(af(a,"attach"),i=function(){var e=uh(a);e&&oh(a,e)},a.zd.D(e,"error",i),a.h=e),!t||!Ut()||a.G){o.u(6);break}return T(o,hf(a),6);case 6:R(o),a.Z.release(),C(o,0);break;case 5:return r=x(o),T(o,a.detach(),10);case 10:throw r}})},i.Gh=function(e){this.tg=e},i.detach=function(e){e=void 0!==e&&e;var t=this;return O(function(n){if(1==n.g){if(t.l==ph)throw new Rt(2,7,7e3);return T(n,t.dc(!1,e),2)}if(3!=n.g)return T(n,of(t,"detach"),3);if(n.h)return n.return();try{t.h&&(t.zd.Ra(),t.h=null),af(t,"detach"),t.A&&!e&&t.A.release()}finally{t.Z.release()}S(n)})},i.dc=function(e,t){e=void 0===e||e,t=void 0!==t&&t;var n,i,r,a,o,s,l,u,d,f=this;return O(function(h){switch(h.g){case 1:return f.l!=ph&&(f.l=gh),T(h,of(f,"unload"),2);case 2:return h.h?h.return():(A(h,3),f.Ea=!1,af(f,"unload"),e&&!Ut()&&(e=!1),tf(f),n=f.Ed.map(function(e){return e()}),f.Ed=[],T(h,Promise.all(n),5));case 5:if(f.dispatchEvent(rf("unloading")),f.wd&&(f.wd.release(),f.wd=null),f.h&&(f.m.Ra(),f.Fa.Ra()),f.Ee.stop(),f.Hb&&(f.Hb.release(),f.Hb=null),f.Ce&&(f.Ce.stop(),f.Ce=null),!f.F){h.u(6);break}return T(h,f.F.stop(),7);case 7:f.F=null,f.bb=null;case 6:if(!f.o){h.u(8);break}return T(h,f.o.stop(),8);case 8:if(!f.j){h.u(10);break}return T(h,f.j.destroy(),11);case 11:f.j=null;case 10:if(f.I&&(f.I.release(),f.I=null),f.C&&(f.C.release(),f.C=null),!sn("webkit")||!f.B){h.u(12);break}return T(h,f.B.destroy(),13);case 13:f.B=null;case 12:if(!f.G){h.u(14);break}return T(h,f.G.destroy(),15);case 15:f.G=null;case 14:if(f.A&&!t&&f.A.onAssetUnload(),f.aa&&!t&&(f.aa.destroy(),f.aa=null),t||f.sg.stop(),f.N&&xd(f.N),f.ea&&(f.ea.g=null),f.h&&gd(f.h),!f.h||!f.h.src){h.u(16);break}return T(h,new Promise(function(e){return new Ft(e).Y(.1)}),17);case 17:f.h.removeAttribute("src"),f.h.load();case 16:if(!f.B){h.u(18);break}return T(h,f.B.destroy(),19);case 19:f.B=null;case 18:if(f.ra&&f.da!=f.ra.Gc()&&(f.ra.s||f.ra.destroy(),f.ra=null),f.da=null,f.pg=null,f.L=null,f.i){for(i=c(f.i.variants),r=i.next();!r.done;r=i.next())for(a=r.value,o=c([a.audio,a.video]),s=o.next();!s.done;s=o.next())(l=s.value)&&l.segmentIndex&&l.segmentIndex.release();for(u=c(f.i.textStreams),s=u.next();!s.done;s=u.next())d=s.value,d.segmentIndex&&d.segmentIndex.release()}f.g.streaming.clearDecodingCache&&(Xi={},Nt.clear()),f.i=null,f.s=new pu,f.qg=null,f.Da=null,f.R=null,f.Ne=-1,f.Hd=[],f.U=NaN,Hf(f);case 3:R(h),f.Z.release(),C(h,4);break;case 4:if(e&&Ut()&&!f.G&&f.h)return T(h,hf(f),0);h.u(0)}})},i.lj=function(e){this.qa=e},i.load=function(e,t,n){t=void 0===t?null:t;var i,r,a,o,s,l,u,c,d,f,h,p,g,m=this;return O(function(v){switch(v.g){case 1:if(m.l==ph)throw new Rt(2,7,7e3);return i=null,r="",e instanceof Uc?(i=e,r=i.Gc()||""):r=e||"",T(v,Jd(m.Z,"load"),2);case 2:if(m.Z.release(),!m.h)throw new Rt(2,7,7002);if(!m.da){v.u(3);break}return m.da=r,T(v,m.dc(!1),3);case 3:if(a=++m.Le,o=function(){return O(function(e){if(1==e.g)return m.Le==a?e.u(0):i?T(e,i.destroy(),3):e.u(3);throw new Rt(2,7,7e3)})},s=function(e,t){return O(function(n){switch(n.g){case 1:return A(n,2),T(n,Jd(m.Z,t),4);case 4:return T(n,o(),5);case 5:return T(n,e(),6);case 6:return T(n,o(),7);case 7:i&&m.g&&(i.g=m.g);case 2:R(n),m.Z.release(),C(n,0)}})},w(v,5,6),null==t&&i&&(t=i.getStartTime()),m.qa=t,m.Ea=!1,m.dispatchEvent(rf("loading")),i){n=i.U,v.u(8);break}if(n){v.u(8);break}return T(v,s(function(){return O(function(e){if(1==e.g)return T(e,df(m,r),2);n=e.h,S(e)})},"guessMimeType_"),8);case 8:if(l=!!i,i){jc(i,m),m.s=i.getStats(),v.u(11);break}return T(v,uf(m,r,t,n,!0),12);case 12:(i=v.h)?(jc(i,m),m.s=i.getStats(),i.start(),i.m.catch(function(){})):m.s=new pu;case 11:if(u=!i,c=Date.now()/1e3,m.s=i?i.getStats():new pu,m.da=r,m.pg=n||null,u)return T(v,s(function(){return O(function(e){return T(e,gf(m,n),0)})},"initializeSrcEqualsDrmInner_"),20);if(m.G){v.u(15);break}return T(v,s(function(){return O(function(e){return T(e,hf(m),0)})},"initializeMediaSourceEngineInner_"),15);case 15:return T(v,s(function(){return O(function(e){return T(e,i.m,0)})},"waitForFinish"),17);case 17:return m.g=i.getConfiguration(),m.xe=i.C,m.bb=i.F,m.F=Hc(i),m.F&&m.F.setMediaElement&&m.h&&m.F.setMediaElement(m.h),m.wd=Kc(i),m.rd=i.za,m.i=i.Ef(),(d=i.o)&&(m.za=d),l&&m.h&&"AUDIO"===m.h.nodeName&&(sf(m),m.configure("manifest.disableVideo",!0)),m.B=zc(i),T(v,s(function(){return O(function(e){return T(e,m.B.Ub(m.h),0)})},"drmEngine_.attach"),18);case 18:return!(f=i.B)||m.xa&&m.xa==f||(m.o=Vc(i),m.xa=i.B,"function"!=typeof m.o.setMediaElement&&(pe("AbrManager w/o setMediaElement","Please use an AbrManager with setMediaElement function."),m.o.setMediaElement=function(){}),"function"!=typeof m.o.setCmsdManager&&(pe("AbrManager w/o setCmsdManager","Please use an AbrManager with setCmsdManager function."),m.o.setCmsdManager=function(){}),"function"!=typeof m.o.trySuggestStreams&&(pe("AbrManager w/o trySuggestStreams","Please use an AbrManager with trySuggestStreams function."),m.o.trySuggestStreams=function(){})),h=Zc(i),p=i.fa,T(v,s(function(){return O(function(e){return T(e,pf(m,c,p,h),0)})},"loadInner_"),19);case 19:Gc(i),v.u(14);break;case 20:return T(v,s(function(){return O(function(e){return T(e,mf(m,c,n),0)})},"srcEqualsInner_"),14);case 14:m.dispatchEvent(rf("loaded"));case 6:if(R(v),!i){v.u(22);break}return T(v,i.destroy(),22);case 22:m.ra=null,C(v,0);break;case 5:if(g=x(v),7e3==g.code){v.u(24);break}return T(v,m.dc(!1),24);case 24:throw g}})},i.hj=function(e,t){e=void 0===e||e,t=void 0!==t&&t;var n,i=this;return O(function(r){return 1==r.g?T(r,lf(i),2):3!=r.g?(n=r.h,T(r,i.dc(e,t),3)):r.return(n)})},i.Eg=function(e,t){e=void 0!==e&&e,t=void 0!==t&&t;var n,i=this;return O(function(r){return 1==r.g?T(r,lf(i,t),2):3!=r.g?(n=r.h,T(r,i.detach(e),3)):r.return(n)})},i.preload=function(e,t,n){t=void 0===t?null:t;var i,r=this;return O(function(a){return 1==a.g?T(a,uf(r,e,t,n),2):((i=a.h)?i.start():oh(r,new Rt(2,7,7005)),a.return(i))})},i.lf=function(){var e,t,n,i,r=this;return O(function(a){for(e=[],t=c(r.Fe),n=t.next();!n.done;n=t.next())i=n.value,i.s||e.push(i.destroy());return r.Fe=[],T(a,Promise.all(e),0)})},i.Qi=function(){for(var e=this.Z;e.g;)e.release()},i.Dc=function(e){return new Ja(e)},i.configure=function(e,t){if(2==arguments.length&&"string"==typeof e&&(e=wc(e,t)),e.streaming&&"forceTransmuxTS"in e.streaming&&(pe("streaming.forceTransmuxTS configuration","Please Use mediaSource.forceTransmux instead."),e.mediaSource.mediaSource=e.streaming.forceTransmuxTS,delete e.streaming.forceTransmuxTS),e.streaming&&"forceTransmux"in e.streaming&&(pe("streaming.forceTransmux configuration","Please Use mediaSource.forceTransmux instead."),e.mediaSource.mediaSource=e.streaming.forceTransmux,delete e.streaming.forceTransmux),e.streaming&&"useNativeHlsOnSafari"in e.streaming&&(pe("streaming.useNativeHlsOnSafari configuration","Please Use streaming.useNativeHlsForFairPlay or streaming.preferNativeHls instead."),e.streaming.preferNativeHls=e.streaming.useNativeHlsOnSafari&&Wt(),delete e.streaming.useNativeHlsOnSafari),e.streaming&&"boolean"==typeof e.streaming.liveSync){pe("streaming.liveSync","Please Use streaming.liveSync.enabled instead.");var n=e.streaming.liveSync;e.streaming.liveSync={},e.streaming.liveSync.enabled=n}if(e.streaming&&!(e.streaming.liveSync&&"targetLatency"in e.streaming.liveSync)&&("liveSyncMinLatency"in e.streaming||"liveSyncMaxLatency"in e.streaming)){n=e.streaming.liveSyncMinLatency||0;var i=Math.abs((e.streaming.liveSyncMaxLatency||1)-n)/2;e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatency=n+i,e.streaming.liveSync.targetLatencyTolerance=i}if(e.streaming&&"liveSyncMaxLatency"in e.streaming&&(pe("streaming.liveSyncMaxLatency","Please Use streaming.liveSync.targetLatency and streaming.liveSync.targetLatencyTolerance instead. Or, set the values in your DASH manifest"),delete e.streaming.liveSyncMaxLatency),e.streaming&&"liveSyncMinLatency"in e.streaming&&(pe("streaming.liveSyncMinLatency","Please Use streaming.liveSync.targetLatency and streaming.liveSync.targetLatencyTolerance instead. Or, set the values in your DASH manifest"),delete e.streaming.liveSyncMinLatency),e.streaming&&"liveSyncTargetLatency"in e.streaming&&(pe("streaming.liveSyncTargetLatency","Please Use streaming.liveSync.targetLatency instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatency=e.streaming.liveSyncTargetLatency,delete e.streaming.liveSyncTargetLatency),e.streaming&&"liveSyncTargetLatencyTolerance"in e.streaming&&(pe("streaming.liveSyncTargetLatencyTolerance","Please Use streaming.liveSync.targetLatencyTolerance instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatencyTolerance=e.streaming.liveSyncTargetLatencyTolerance,delete e.streaming.liveSyncTargetLatencyTolerance),e.streaming&&"liveSyncPlaybackRate"in e.streaming&&(pe("streaming.liveSyncPlaybackRate","Please Use streaming.liveSync.maxPlaybackRate instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.maxPlaybackRate=e.streaming.liveSyncPlaybackRate,delete e.streaming.liveSyncPlaybackRate),e.streaming&&"liveSyncMinPlaybackRate"in e.streaming&&(pe("streaming.liveSyncMinPlaybackRate","Please Use streaming.liveSync.minPlaybackRate instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.minPlaybackRate=e.streaming.liveSyncMinPlaybackRate,delete e.streaming.liveSyncMinPlaybackRate),e.streaming&&"liveSyncPanicMode"in e.streaming&&(pe("streaming.liveSyncPanicMode","Please Use streaming.liveSync.panicMode instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.panicMode=e.streaming.liveSyncPanicMode,delete e.streaming.liveSyncPanicMode),e.streaming&&"liveSyncPanicThreshold"in e.streaming&&(pe("streaming.liveSyncPanicThreshold","Please Use streaming.liveSync.panicThreshold instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.panicThreshold=e.streaming.liveSyncPanicThreshold,delete e.streaming.liveSyncPanicThreshold),e.mediaSource&&"sourceBufferExtraFeatures"in e.mediaSource){pe("mediaSource.sourceBufferExtraFeatures configuration","Please Use mediaSource.addExtraFeaturesToSourceBuffer() instead.");var r=e.mediaSource.sourceBufferExtraFeatures;e.mediaSource.addExtraFeaturesToSourceBuffer=function(){return r},delete e.mediaSource.sourceBufferExtraFeatures}return e.streaming&&e.streaming.lowLatencyMode&&(void 0==e.streaming.inaccurateManifestTolerance&&(e.streaming.inaccurateManifestTolerance=0),void 0==e.streaming.rebufferingGoal&&(e.streaming.rebufferingGoal=.01),void 0==e.streaming.segmentPrefetchLimit&&(e.streaming.segmentPrefetchLimit=2),void 0==e.streaming.updateIntervalSeconds&&(e.streaming.updateIntervalSeconds=.1),void 0==e.streaming.maxDisabledTime&&(e.streaming.maxDisabledTime=1),void 0==e.streaming.retryParameters&&(e.streaming.retryParameters={}),void 0==e.streaming.retryParameters.baseDelay&&(e.streaming.retryParameters.baseDelay=100),void 0==e.manifest&&(e.manifest={}),void 0==e.manifest.dash&&(e.manifest.dash={}),void 0==e.manifest.dash.autoCorrectDrift&&(e.manifest.dash.autoCorrectDrift=!1),void 0==e.manifest.retryParameters&&(e.manifest.retryParameters={}),void 0==e.manifest.retryParameters.baseDelay&&(e.manifest.retryParameters.baseDelay=100),void 0==e.drm&&(e.drm={}),void 0==e.drm.retryParameters&&(e.drm.retryParameters={}),void 0==e.drm.retryParameters.baseDelay&&(e.drm.retryParameters.baseDelay=100)),n=Pc(this.g,e,Gf(this)),kf(this),n},i.getConfiguration=function(){var e=Gf(this);return Pc(e,this.g,Gf(this)),e},i.Og=function(){var e=Gf(this);return Pc(e,this.g,Gf(this)),Ic(this.g,Gf(this))},i.Jg=function(){if(this.h){var e=this.h.buffered.length;e=e?this.h.buffered.end(e-1):0;var t=this.getConfiguration().streaming.bufferingGoal;if(t=Math.min(this.h.currentTime+t,this.Qb().end),e>=t)return 1;if(!(e<=this.h.currentTime)&&e<t)return(e-this.h.currentTime)/(t-this.h.currentTime)}return 0},i.Ui=function(){for(var e in this.g)delete this.g[e];Pc(this.g,Gf(this),Gf(this)),kf(this)},i.Mg=function(){return this.l},i.Ff=function(){return this.i?this.i.type:null},i.ai=function(){return this.h},i.zb=function(){return this.H},i.Gc=function(){return this.da},i.Ig=function(){return this.A?this.A:null},i.V=function(){return this.i?this.i.presentationTimeline.V():!(!this.h||!this.h.src)&&1/0==this.h.duration},i.qc=function(){return!!this.i&&this.i.presentationTimeline.qc()},i.si=function(){if(this.i){var e=this.i.variants;return!!e.length&&!e[0].video}return!(!this.h||!this.h.src)&&(this.h.videoTracks?0==this.h.videoTracks.length:0==this.h.videoHeight)},i.Qb=function(){if(this.i){if(!this.Ea&&"HLS"==this.i.type)return{start:0,end:0};var e=this.i.presentationTimeline;return{start:e.Yb(),end:e.Ab()}}return this.h&&this.h.src&&(e=this.h.seekable,e.length)?{start:e.start(0),end:e.end(e.length-1)}:{start:0,end:0}},i.oi=function(){this.V()&&(this.h.currentTime=this.Qb().end)},i.ti=function(){return this.Ea},i.keySystem=function(){var e=this.drmInfo();return e?e.keySystem:""},i.drmInfo=function(){return this.B?this.B.g:null},i.td=function(){return this.B?this.B.td():1/0},i.Df=function(){return this.B?this.B.Df():[]},i.ge=function(){return this.B?this.B.ge():{}},i.Jf=function(){return!!this.L&&this.L.g==Sr},i.fb=function(){return this.h?this.I?this.I.i:1:0},i.Pd=function(e){var t=this;0==e?Q("A trick play rate of 0 is unsupported!"):(this.Fa.Ra(),this.h.paused&&this.h.play(),this.I.set(e),this.l==mh&&(this.o.playbackRateChanged(e),Zu(this.j,1<Math.abs(e))),this.V()&&this.Fa.D(this.h,"timeupdate",function(){var n=t.h.currentTime,i=t.Qb(),r=t.g.streaming.safeSeekOffset;0<e?Math.floor(n)>=Math.floor(i.end)&&t.md():Math.floor(n)<=Math.floor(i.start+r)&&t.md()}))},i.md=function(){var e=this.I.nc();this.l==vh&&this.I.set(e),this.l==mh&&(this.I.set(e),this.o.playbackRateChanged(e),Zu(this.j,!1)),this.Fa.Ra()},i.oc=function(){if(this.i){for(var e=this.j?this.j.j:null,t=[],n=0,i=c(this.i.variants),r=i.next();!r.done;r=i.next())if(r=r.value,Zi(r)){var a=Bi(r);a.active=r==e,a.active||1==n||null==e||r.video!=e.video||r.audio!=e.audio||(a.active=!0),a.active&&n++,t.push(a)}return t}return this.h&&this.h.audioTracks?Array.from(this.h.audioTracks).map(function(e){return Ki(e)}):[]},i.Hc=function(){if(this.i){for(var e=this.j?this.j.s:null,t=[],n=c(this.i.textStreams),i=n.next();!i.done;i=n.next()){i=i.value;var r=Gi(i);r.active=i==e,t.push(r)}return t}return this.h&&this.h.src&&this.h.textTracks?Lf(this).map(function(e){return Hi(e)}):[]},i.Vh=function(){var e=this.Hd;return this.i&&(e=this.i.imageStreams),e.map(function(e){return ji(e)})},i.Nh=function(e){var t,n,i,r,a=this;return O(function(o){return 1==o.g?a.l!=mh&&a.l!=vh?o.return(null):(t=a.Hd,a.i&&(t=a.i.imageStreams),(n=t.find(function(t){return t.id==e}))?n.segmentIndex?o.u(2):T(o,n.createSegmentIndex(),2):o.return(null)):4!=o.g?(i=[],n.segmentIndex.Jb(function(t){var r=Mf(t.tilesLayout||n.tilesLayout);if(r){r=r.rows*r.kc;for(var o=t.j-t.startTime,s=0;s<r;s++)i.push(a.Qg(e,t.startTime+o*s/r))}}),T(o,Promise.all(i),4)):(r=o.h,o.return(r.filter(function(e){return e})))})},i.Qg=function(e,t){var n,i,r,a,o,s,l,u,c,d,f,h,p,g,m,v,y,_,b=this;return O(function(E){return 1==E.g?b.l!=mh&&b.l!=vh?E.return(null):(n=b.Hd,b.i&&(n=b.i.imageStreams),(i=n.find(function(t){return t.id==e}))?i.segmentIndex?E.u(2):T(E,i.createSegmentIndex(),2):E.return(null)):(r=i.segmentIndex.find(t),null==r?E.return(null):(a=i.segmentIndex.get(r),o=Mf(a.tilesLayout||i.tilesLayout),o?(s=i.width||0,l=i.height||0,u=s/o.kc,c=l/o.rows,d=o.kc*o.rows,f=a.j-a.startTime,h=a.A||f/d,p=a.startTime,m=g=0,1<d&&(v=Math.floor((t-a.startTime)/h),p=a.startTime+v*h,g=v%o.kc*u,m=Math.floor(v/o.kc)*c),y=!1,(_=a.s)&&(y=!0,c=_.height,g=_.positionX,m=_.positionY,u=_.width),E.return({segment:a,imageHeight:l,imageWidth:s,height:c,positionX:g,positionY:m,startTime:p,duration:h,uris:a.M(),width:u,sprite:y})):E.return(null)))})},i.hh=function(e){if(this.i&&this.j){var t=this.i.textStreams.find(function(t){return t.id==e.id});t&&t!=this.j.s&&(hu(this.s.h,t,!1),Yu(this.j,t),nh(this),this.Fb=t.language)}else if(this.h&&this.h.src&&this.h.textTracks){t=Lf(this),t=c(t);for(var n=t.next();!n.done;n=t.next())n=n.value,Vi(n)==e.id?n.mode=this.pa?"showing":"hidden":n.mode="disabled";nh(this)}},i.cg=function(e,t,n){if(t=void 0!==t&&t,n=void 0===n?0:n,this.i&&this.j){var i=this.i.variants.find(function(t){return t.id==e.id});if(i&&Zi(i)){var r=this.j.j;this.g.abr.enabled&&(r.video!=i.video||r.audio&&i.audio&&r.audio.language==i.audio.language&&r.audio.channelsCount==i.audio.channelsCount)&&Q("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack()."),Xf(this,i,!1,t,n),this.za=new cr(i,this.g.mediaSource.codecSwitchingStrategy,this.g.manifest.dash.enableAudioGroups),Yf(this)}}else if(this.h&&this.h.audioTracks)for(t=Array.from(this.h.audioTracks),t=c(t),n=t.next();!n.done;n=t.next())if(n=n.value,Vi(n)==e.id){Qf(this,n);break}},i.Ph=function(){return hh(this.oc())},i.hi=function(){return hh(this.Hc())},i.Oh=function(){return Array.from(fh(this.oc()))},i.gi=function(){return Array.from(fh(this.Hc()))},i.gh=function(e,t,n,i,r){if(n=void 0===n?0:n,i=void 0===i?0:i,r=void 0===r?"":r,this.i&&this.C){this.za=new dr(e,t||"",n,"",!1,"","","",this.g.mediaSource.codecSwitchingStrategy,this.g.manifest.dash.enableAudioGroups,r),e=function(e,t){return e.video||t.video?e.video&&t.video?Math.abs((e.video.height||0)-(t.video.height||0))+Math.abs((e.video.width||0)-(t.video.width||0)):1/0:0},t=this.j.j,r=this.za.create(this.i.variants),n=null,r=c(r.values());for(var a=r.next();!a.done;a=r.next())a=a.value,Zi(a)&&(!n||e(n,t)>e(a,t))&&(n=a);n!=t&&(n?(e=Bi(n),this.cg(e,!0,i)):$f(this))}else this.h&&this.h.audioTracks&&(i=Yi(this.oc(),e,t||"",!1)[0])&&this.cg(i)},i.bg=function(e,t,n){n=void 0!==n&&n,this.i&&this.C?(this.Fb=e,this.Gd=t||"",this.Fd=n,(e=Yi(this.i.textStreams,this.Fb,this.Gd,this.Fd)[0]||null)&&e!=this.j.s&&(hu(this.s.h,e,!1),this.g.streaming.alwaysStreamText||this.Kf())&&(Yu(this.j,e),nh(this))):(e=Yi(this.Hc(),e,t||"",n)[0])&&this.hh(e)},i.$i=function(e,t,n){if(t=void 0===t||t,n=void 0===n?0:n,this.i&&this.C){for(var i=null,r=c(this.i.variants),a=r.next();!a.done;a=r.next())if(a=a.value,a.audio.label==e){i=a;break}null!=i&&(this.za=new dr(i.language,"",0,"",!1,"",e,"",this.g.mediaSource.codecSwitchingStrategy,this.g.manifest.dash.enableAudioGroups),$f(this,t,n))}else if(this.h&&this.h.audioTracks){for(n=Array.from(this.h.audioTracks),t=null,n=c(n),i=n.next();!i.done;i=n.next())i=i.value,i.label==e&&(t=i);t&&Qf(this,t)}},i.Kf=function(){var e=this.pa;return this.G&&this.l==mh?this.G.F.isTextVisible():this.h&&this.h.src&&this.h.textTracks?Lf(this).some(function(e){return"showing"==e.mode}):e},i.Kg=function(){return this.h&&this.h.src&&this.h.textTracks?Nf(this).map(function(e){return Hi(e)}):[]},i.Rh=function(e){if(!this.h||!this.h.src||!this.h.textTracks)return[];var t=fi(e),n=Nf(this).filter(function(e){return fi(e.language)==t});if(!n||!n.length)return[];e=[];var i=new Set;n=c(n);for(var r=n.next();!r.done;r=n.next())if((r=r.value)&&r.cues){r=c(r.cues);for(var a=r.next();!a.done;a=r.next()){var o=a.value;(a=o.id)&&""!=a||(a=o.startTime+"-"+o.endTime+"-"+o.text),o={id:a,title:o.text,startTime:o.startTime,endTime:o.endTime},i.has(a)||(e.push(o),i.add(a))}}return e},i.nh=function(e){if(e=!!e,this.pa!=e){if(this.pa=e,this.l==mh)this.G.F.setTextVisibility(e),this.g.streaming.alwaysStreamText||(e?this.j.s||(e=Yi(this.i.textStreams,this.Fb,this.Gd,this.Fd),0<e.length&&(Yu(this.j,e[0]),nh(this))):zu(this.j));else if(this.h&&this.h.src&&this.h.textTracks){var t=Lf(this);t=c(t);for(var n=t.next();!n.done;n=t.next())n=n.value,"disabled"!=n.mode&&(n.mode=e?"showing":"hidden")}ih(this)}},i.ci=function(){if(this.C)var e=this.C.$d();else{if(null==this.qa)return new Date;e=this.qa}if(this.i){var t=this.i.presentationTimeline;return new Date(1e3*((t.m||t.i)+e))}return this.h&&this.h.getStartDate?(t=this.h.getStartDate(),isNaN(t.getTime())?null:new Date(t.getTime()+1e3*e)):null},i.Pg=function(){if(this.i){var e=this.i.presentationTimeline;return new Date(1e3*(e.m||e.i))}return this.h&&this.h.getStartDate?(e=this.h.getStartDate(),isNaN(e.getTime())?null:e):null},i.je=function(){return this.V()&&this.i?this.i.presentationTimeline.je():null},i.yb=function(){if(this.l==mh)return this.G.yb();var e={total:[],audio:[],video:[],text:[]};return this.l==vh&&(e.total=ss(this.h.buffered)),e},i.getStats=function(){if(this.l!=mh&&this.l!=vh)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,stallsDetected:NaN,gapsJumped:NaN,estimatedBandwidth:NaN,completionPercent:NaN,loadLatency:NaN,manifestTimeSeconds:NaN,drmTimeSeconds:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,liveLatency:NaN,maxSegmentDuration:NaN,manifestSizeBytes:NaN,bytesDownloaded:NaN,nonFatalErrorCount:NaN,manifestPeriodCount:NaN,manifestGapCount:NaN,switchHistory:[],stateHistory:[]};zf(this);var e=this.h,t=e.currentTime/e.duration;if(!isNaN(t)&&!this.V()){var n=this.s;t=Math.round(100*t),n.i=isNaN(n.i)?t:Math.max(n.i,t)}if(this.C&&(this.s.U=this.C.ug(),this.s.Z=this.C.vg()),e.getVideoPlaybackQuality){n=e.getVideoPlaybackQuality(),t=this.s;var i=Number(n.totalVideoFrames);t.R=Number(n.droppedVideoFrames),t.N=i,this.s.L=Number(n.corruptedVideoFrames)}if(this.B?(n=this.B,n=n.I?n.I:NaN):n=NaN,this.s.s=n,this.l==mh){if(n=this.j.j,t=this.j.s,n){i=this.I?this.I.i:1;var r=i*n.bandwidth;t&&t.bandwidth&&(r+=i*t.bandwidth),this.s.B=r}n&&n.video&&(t=this.s,i=n.video.height||NaN,t.o=n.video.width||NaN,t.l=i),this.V()&&(n=this.Pg().valueOf()+1e3*e.currentTime,this.s.C=(Date.now()-n)/1e3),this.i&&(this.s.G=this.i.periodCount,this.s.F=this.i.gapCount,this.i.presentationTimeline&&(this.s.I=this.i.presentationTimeline.g)),n=this.o.getBandwidthEstimate(),this.s.A=n}this.l==vh&&(n=this.s,t=e.videoHeight||NaN,n.o=e.videoWidth||NaN,n.l=t);var a=this.s;e=a.o,n=a.l,t=a.B,i=a.N,r=a.R;var o=a.L,s=a.Z,l=a.U,u=a.A,d=a.i,f=a.m,h=a.H,p=a.j,g=cu(a.g,"playing"),m=cu(a.g,"paused"),v=cu(a.g,"buffering"),y=a.s,_=a.C,b=a.I,E=a.Ug,T=a.ae,S=a.K,w=a.G,A=a.F,I=du(a.g),x=[];a=c(a.h.g);for(var R=a.next();!R.done;R=a.next())R=R.value,x.push({timestamp:R.timestamp,id:R.id,type:R.type,fromAdaptation:R.fromAdaptation,bandwidth:R.bandwidth});return{width:e,height:n,streamBandwidth:t,decodedFrames:i,droppedFrames:r,corruptedFrames:o,stallsDetected:s,gapsJumped:l,estimatedBandwidth:u,completionPercent:d,loadLatency:f,manifestTimeSeconds:h,drmTimeSeconds:p,playTime:g,pauseTime:m,bufferingTime:v,licenseTime:y,liveLatency:_,maxSegmentDuration:b,manifestSizeBytes:E,bytesDownloaded:T,nonFatalErrorCount:S,manifestPeriodCount:w,manifestGapCount:A,stateHistory:I,switchHistory:x}},i.Bh=function(e,t,n,i,r,a,o){o=void 0!==o&&o;var s,l,u,c,d,f,h,p,g,m,v,y,_=this;return O(function(b){switch(b.g){case 1:if(_.l!=mh&&_.l!=vh)throw new Rt(1,7,7004);if("subtitles"!=n&&"captions"!=n&&Q("Using a kind value different of `subtitles` or `captions` can cause unwanted issues."),i){b.u(2);break}return T(b,Of(_,e),3);case 3:i=b.h;case 2:if(s=[],_.A&&(s=_.A.getCuePoints()),_.l!=vh){b.u(4);break}return o&&(n="forced"),T(b,Ff(_,e,t,n,i,a||"",s),5);case 5:if(l=fi(t),u=_.Hc(),c=u.find(function(e){return fi(e.language)==l&&e.label==(a||"")&&e.kind==n}))return eh(_),b.return(c);throw new Rt(1,2,2012);case 4:if(d=Pn,f=_.h.duration,_.i&&(f=_.i.presentationTimeline.getDuration()),1/0==f)throw new Rt(1,4,4033);if(!s.length){b.u(6);break}return T(b,Uf(_,e,_.H,_.g.streaming.retryParameters),7);case 7:h=b.h,p=Bf(_,h,i,s),g=new Blob([p],{type:"text/vtt"}),e=kl(g),i="text/vtt";case 6:if(m={id:_.rg++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:nu(0,f,[e]),mimeType:i||"",codecs:r||"",kind:n,encrypted:!1,drmInfos:[],keyIds:new Set,language:t,originalLanguage:t,label:a||null,type:d.ta,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!!o,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([Un(i||"",r||"")])},v=Un(m.mimeType,m.codecs),y=Qn(v),!y)throw new Rt(2,2,2014,i);return _.i.textStreams.push(m),eh(_),b.return(Gi(m))}})},i.Ch=function(e,t){var n,i,r,a,o,s,l,u,d,f,h,p,g,m,v,y,_=this;return O(function(b){switch(b.g){case 1:if(_.l!=mh&&_.l!=vh)throw new Rt(1,7,7004);if(t){b.u(2);break}return T(b,Of(_,e),3);case 3:t=b.h;case 2:if("text/vtt"!=t)throw new Rt(1,2,2017,e);if(n=Pn,i=_.h.duration,_.i&&(i=_.i.presentationTimeline.getDuration()),1/0==i)throw new Rt(1,4,4045);return T(b,Uf(_,e,_.H,_.g.streaming.retryParameters),4);case 4:if(r=b.h,a=ri[t],!a)throw new Rt(2,2,2014,t);for(o=a(),s={periodStart:0,segmentStart:0,segmentEnd:i,vttOffset:0},l=we(r),u=o.parseMedia(l,s,e),d=[],f={},h=c(u),p=h.next();!p.done;f={hd:f.hd,hc:f.hc},p=h.next())f.hc=p.value,f.hd=null,g=function(t){return function(){return null==t.hd&&(t.hd=xn([e],[t.hc.payload])),t.hd||[]}}(f),m=new Qo(f.hc.startTime,f.hc.endTime,g,0,null,null,0,0,1/0),f.hc.payload.includes("#xywh")&&(v=f.hc.payload.split("#xywh=")[1].split(","),4===v.length&&m.oh({height:parseInt(v[3],10),positionX:parseInt(v[0],10),positionY:parseInt(v[1],10),width:parseInt(v[2],10)})),d.push(m);return y={id:_.rg++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new tu(d),mimeType:t||"",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:n.Ze,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,tilesLayout:"1x1",accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([Un(t||"","")])},_.l==vh?_.Hd.push(y):_.i.imageStreams.push(y),eh(_),b.return(ji(y))}})},i.Ah=function(e,t,n){var i,r,a,o,s=this;return O(function(l){switch(l.g){case 1:if(s.l!=mh&&s.l!=vh)throw new Rt(1,7,7004);if(n){l.u(2);break}return T(l,Of(s,e),3);case 3:n=l.h;case 2:return i=[],s.A&&(i=s.A.getCuePoints()),T(l,Ff(s,e,t,"chapters",n,"",i),4);case 4:if(r=l.h,a=s.Kg(),o=a.find(function(e){return e.language==t}),!o){l.u(5);break}return T(l,new Promise(function(e,t){s.m.ha(r,"load",e),s.m.ha(r,"error",function(){t(new Rt(1,2,2015))})}),6);case 6:return eh(s),l.return(o);case 5:throw new Rt(1,2,2012)}})},i.ej=function(e,t){this.fa.width=e,this.fa.height=t},i.Zf=function(e){if(this.l==mh){var t=this.j;if(e=void 0===e?.1:e,t.m.g)t=!1;else if(t.A)t=!1;else{for(var n=c(t.i.values()),i=n.next();!i.done;i=n.next())i=i.value,!i.yd||i.Qa||i.ub||(i.yd=!1,mc(t,i,e));t=!0}}else t=!1;return t},i.Ef=function(){return Q("Shaka Player's internal Manifest structure is NOT covered by semantic versioning compatibility guarantees.  It may change at any time!  Please consider filing a feature request for whatever you use getManifest() for."),this.i},i.Yh=function(){return this.bb},i.rh=function(e){this.ze=e},i.disableStream=function(e,t){if(!this.g.abr.enabled||this.l===ph||!navigator.onLine||0==t)return!1;if(this.i.variants.some(function(t){var n=t[e.type];return!(!n||n.id===e.id||t.disabledUntilTime)&&("audio"!=e.type||e.language===n.language)})){for(var n=c(this.i.variants),i=n.next();!i.done;i=n.next()){i=i.value;var r=i[e.type];r&&r.id===e.id&&(i.disabledUntilTime=Date.now()/1e3+t)}return this.Ee.Sa(1),t=this.yb().video.reduce(function(e,t){return e+t.end-t.start},0),$f(this,!1,t,!0,!1),!0}return!1},K("shaka.Player",ef),ef.prototype.setVideoContainer=ef.prototype.rh,ef.prototype.getManifestParserFactory=ef.prototype.Yh,ef.prototype.getManifest=ef.prototype.Ef,ef.prototype.retryStreaming=ef.prototype.Zf,ef.prototype.setMaxHardwareResolution=ef.prototype.ej,ef.prototype.addChaptersTrack=ef.prototype.Ah,ef.prototype.addThumbnailsTrack=ef.prototype.Ch,ef.prototype.addTextTrackAsync=ef.prototype.Bh,ef.prototype.getStats=ef.prototype.getStats,ef.prototype.getBufferedInfo=ef.prototype.yb,ef.prototype.getSegmentAvailabilityDuration=ef.prototype.je,ef.prototype.getPresentationStartTimeAsDate=ef.prototype.Pg,ef.prototype.getPlayheadTimeAsDate=ef.prototype.ci,ef.prototype.setTextTrackVisibility=ef.prototype.nh,ef.prototype.getChapters=ef.prototype.Rh,ef.prototype.getChaptersTracks=ef.prototype.Kg,ef.prototype.isTextTrackVisible=ef.prototype.Kf,ef.prototype.selectVariantsByLabel=ef.prototype.$i,ef.prototype.selectTextLanguage=ef.prototype.bg,ef.prototype.selectAudioLanguage=ef.prototype.gh,ef.prototype.getTextLanguages=ef.prototype.gi,ef.prototype.getAudioLanguages=ef.prototype.Oh,ef.prototype.getTextLanguagesAndRoles=ef.prototype.hi,ef.prototype.getAudioLanguagesAndRoles=ef.prototype.Ph,ef.prototype.selectVariantTrack=ef.prototype.cg,ef.prototype.selectTextTrack=ef.prototype.hh,ef.prototype.getThumbnails=ef.prototype.Qg,ef.prototype.getAllThumbnails=ef.prototype.Nh,ef.prototype.getImageTracks=ef.prototype.Vh,ef.prototype.getTextTracks=ef.prototype.Hc,ef.prototype.getVariantTracks=ef.prototype.oc,ef.prototype.cancelTrickPlay=ef.prototype.md,ef.prototype.trickPlay=ef.prototype.Pd,ef.prototype.getPlaybackRate=ef.prototype.fb,ef.prototype.isBuffering=ef.prototype.Jf,ef.prototype.getKeyStatuses=ef.prototype.ge,ef.prototype.getActiveSessionsMetadata=ef.prototype.Df,ef.prototype.getExpiration=ef.prototype.td,ef.prototype.drmInfo=ef.prototype.drmInfo,ef.prototype.keySystem=ef.prototype.keySystem,ef.prototype.isFullyLoaded=ef.prototype.ti,ef.prototype.goToLive=ef.prototype.oi,ef.prototype.seekRange=ef.prototype.Qb,ef.prototype.isAudioOnly=ef.prototype.si,ef.prototype.isInProgress=ef.prototype.qc,ef.prototype.isLive=ef.prototype.V,ef.prototype.getAdManager=ef.prototype.Ig,ef.prototype.getAssetUri=ef.prototype.Gc,ef.prototype.getNetworkingEngine=ef.prototype.zb,ef.prototype.getMediaElement=ef.prototype.ai,ef.prototype.getManifestType=ef.prototype.Ff,ef.prototype.getLoadMode=ef.prototype.Mg,ef.prototype.resetConfiguration=ef.prototype.Ui,ef.prototype.getBufferFullness=ef.prototype.Jg,ef.prototype.getNonDefaultConfiguration=ef.prototype.Og,ef.prototype.getConfiguration=ef.prototype.getConfiguration,ef.prototype.configure=ef.prototype.configure,ef.prototype.releaseAllMutexes=ef.prototype.Qi,ef.prototype.destroyAllPreloads=ef.prototype.lf,ef.prototype.preload=ef.prototype.preload,ef.prototype.detachAndSavePreload=ef.prototype.Eg,ef.prototype.unloadAndSavePreload=ef.prototype.hj,ef.prototype.load=ef.prototype.load,ef.prototype.updateStartTime=ef.prototype.lj,ef.prototype.unload=ef.prototype.dc,ef.prototype.detach=ef.prototype.detach,ef.prototype.attachCanvas=ef.prototype.Gh,ef.prototype.attach=ef.prototype.Ub,ef.probeSupport=function(e){var t,n,i,r,a,o,s;return e=void 0===e||e,O(function(l){switch(l.g){case 1:if(t={},!e){l.u(2);break}return T(l,wo(),3);case 3:t=l.h;case 2:var u={};if(Ut())for(var f in zo)u[f]=!0;f=c(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"]);for(var h=f.next();!h.done;h=f.next())h=h.value,u[h]=Ut()?!!zo[h]:Bt(h);for(n=u,f='video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",video/mp4; codecs="dvh1.20.01",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="ac-4.02.01.01",audio/mp4; codecs="opus",audio/mp4; codecs="flac",audio/mp4; codecs="dtsc",audio/mp4; codecs="dtse",audio/mp4; codecs="dtsx",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",").concat(d($n)),u={},f=c(f),h=f.next();!h.done;h=f.next()){h=h.value,u[h]=!!Qn(h)||(Ut()?ce(h)||!!at(h):Bt(h));var p=h.split(";")[0];u[p]=u[p]||u[h]}return i=u,T(l,ln(),4);case 4:for(s in r=l.h,a={manifest:n,media:i,drm:t,hardwareResolution:r},o=_h,o)a[s]=o[s]();return l.return(a)}})},ef.isBrowserSupported=function(){if(e.Promise||Q("A Promise implementation or polyfill is required"),!(e.Promise&&e.Uint8Array&&Array.prototype.forEach)||an("Trident/"))return!1;var t=en();return!(t&&9>t||!(e.MediaKeys&&e.navigator&&e.navigator.requestMediaKeySystemAccess&&e.MediaKeySystemAccess&&e.MediaKeySystemAccess.prototype.getConfiguration))&&(!!Ut()||Bt("application/x-mpegurl"))},ef.setAdManagerFactory=function(e){bh=e},ef.registerSupportPlugin=function(e,t){_h[e]=t},ef.prototype.destroy=ef.prototype.destroy;var ph=0,gh=1,mh=2,vh=3;ef.LoadMode={DESTROYED:ph,NOT_LOADED:gh,MEDIA_SOURCE:mh,SRC_EQUALS:vh},ef.version="v4.10.9";var yh=["4","10"];ve=new function(e){this.g=e,this.i=ge,this.h=me}(new he(Number(yh[0]),Number(yh[1])));var _h={},bh=null;function Eh(){this.g=[],this.i=this.l=this.j=this.h=0}function Th(e){return e.g.length?e.g.reduce(function(e,t){return e+t},0)/e.g.length:0}function Sh(e,t,n){var i=this;this.g=e,this.h=t,this.j=n,this.i=!1,this.l=this.h.getVolume(),this.m=new ae,this.m.D(this.h,google.ima.AdEvent.Type.PAUSED,function(){i.i=!0}),this.m.D(this.h,google.ima.AdEvent.Type.RESUMED,function(){i.i=!1})}function wh(){}function Ah(e,t,n,i,r){var a=this;this.s=e,this.i=t,this.F=!1,this.A=this.o=null,this.G=NaN,this.l=r,this.j=null,this.h=new ae,google.ima.settings.setLocale(n),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),this.C=new google.ima.AdDisplayContainer(this.s,this.i),this.C.initialize(),this.m=new google.ima.AdsLoader(this.C),this.m.getSettings().setPlayerType("shaka-player"),this.m.getSettings().setPlayerVersion("v4.10.9"),this.g=null,this.B=i||new google.ima.AdsRenderingSettings,this.h.D(this.m,google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,function(e){xh(a,e)}),this.h.D(this.m,google.ima.AdErrorEvent.Type.AD_ERROR,function(e){Ih(a,e)}),this.h.D(this.i,"ended",function(){a.m.contentComplete()}),this.h.ha(this.i,"play",function(){a.F=!0})}function Ih(e,t){t.getError(),t=(new Map).set("originalEvent",t),e.l(new Or("ad-error",t)),kh(e,null),e.l(new Or("ad-cue-points-changed",(new Map).set("cuepoints",[])))}function xh(t,n){if(t.l(new Or("ads-loaded",(new Map).set("loadTime",Date.now()/1e3-t.G))),t.o.customPlayheadTracker){var i={currentTime:t.i.currentTime};t.g=n.getAdsManager(i,t.B),t.i.muted?t.g.setVolume(0):t.g.setVolume(t.i.volume),t.h.D(t.i,"timeupdate",function(){t.i.duration&&(i.currentTime=t.i.currentTime)}),t.h.D(t.i,"volumechange",function(){t.j&&(t.j.setVolume(t.i.volume),t.i.muted&&t.j.setMuted(!0))})}else t.g=n.getAdsManager(t.i,t.B);t.l(new Or("ima-ad-manager-loaded",(new Map).set("imaAdManager",t.g)));var r=t.g.getCuePoints();if(r.length){n=[],r=c(r);for(var a=r.next();!a.done;a=r.next())n.push({start:a.value,end:null});t.l(new Or("ad-cue-points-changed",(new Map).set("cuepoints",n)))}Ch(t);try{t.g.init(t.i.offsetWidth,t.i.offsetHeight,Rh(t)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL),t.h.D(t.i,"loadeddata",function(){t.g.resize(t.i.offsetWidth,t.i.offsetHeight,Rh(t)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)}),"ResizeObserver"in e?(t.A=new ResizeObserver(function(){t.g.resize(t.i.offsetWidth,t.i.offsetHeight,Rh(t)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)}),t.A.observe(t.i)):t.h.D(document,"fullscreenchange",function(){t.g.resize(t.i.offsetWidth,t.i.offsetHeight,Rh(t)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)}),t.F||t.o.skipPlayDetection?t.g.start():t.h.ha(t.i,"play",function(){t.F=!0,t.g.start()})}catch(e){kh(t,null)}}function Rh(e){return document.fullscreenEnabled?!!document.fullscreenElement:(e=e.i,!!e.webkitSupportsFullscreen&&e.webkitDisplayingFullscreen)}function Ch(e){function t(t,n){t=(new Map).set("originalEvent",t),e.l(new Or(n,t))}e.h.D(e.g,google.ima.AdErrorEvent.Type.AD_ERROR,function(t){Ih(e,t)}),e.h.D(e.g,google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,function(t){Dh(e,t)}),e.h.D(e.g,google.ima.AdEvent.Type.STARTED,function(t){Dh(e,t)}),e.h.D(e.g,google.ima.AdEvent.Type.FIRST_QUARTILE,function(e){t(e,"ad-first-quartile")}),e.h.D(e.g,google.ima.AdEvent.Type.MIDPOINT,function(e){t(e,"ad-midpoint")}),e.h.D(e.g,google.ima.AdEvent.Type.THIRD_QUARTILE,function(e){t(e,"ad-third-quartile")}),e.h.D(e.g,google.ima.AdEvent.Type.COMPLETE,function(e){t(e,"ad-complete")}),e.h.D(e.g,google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,function(t){kh(e,t)}),e.h.D(e.g,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,function(t){kh(e,t)}),e.h.D(e.g,google.ima.AdEvent.Type.SKIPPED,function(e){t(e,"ad-skipped")}),e.h.D(e.g,google.ima.AdEvent.Type.VOLUME_CHANGED,function(e){t(e,"ad-volume-changed")}),e.h.D(e.g,google.ima.AdEvent.Type.VOLUME_MUTED,function(e){t(e,"ad-muted")}),e.h.D(e.g,google.ima.AdEvent.Type.PAUSED,function(n){e.j&&(e.j.i=!0,t(n,"ad-paused"))}),e.h.D(e.g,google.ima.AdEvent.Type.RESUMED,function(n){e.j&&(e.j.i=!1,t(n,"ad-resumed"))}),e.h.D(e.g,google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,function(n){e.j&&t(n,"ad-skip-state-changed")}),e.h.D(e.g,google.ima.AdEvent.Type.CLICK,function(e){t(e,"ad-clicked")}),e.h.D(e.g,google.ima.AdEvent.Type.AD_PROGRESS,function(e){t(e,"ad-progress")}),e.h.D(e.g,google.ima.AdEvent.Type.AD_BUFFERING,function(e){t(e,"ad-buffering")}),e.h.D(e.g,google.ima.AdEvent.Type.IMPRESSION,function(e){t(e,"ad-impression")}),e.h.D(e.g,google.ima.AdEvent.Type.DURATION_CHANGE,function(e){t(e,"ad-duration-changed")}),e.h.D(e.g,google.ima.AdEvent.Type.USER_CLOSE,function(e){t(e,"ad-closed")}),e.h.D(e.g,google.ima.AdEvent.Type.LOADED,function(e){t(e,"ad-loaded")}),e.h.D(e.g,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,function(e){t(e,"all-ads-completed")}),e.h.D(e.g,google.ima.AdEvent.Type.LINEAR_CHANGED,function(e){t(e,"ad-linear-changed")}),e.h.D(e.g,google.ima.AdEvent.Type.AD_METADATA,function(e){t(e,"ad-metadata")}),e.h.D(e.g,google.ima.AdEvent.Type.LOG,function(e){t(e,"ad-recoverable-error")}),e.h.D(e.g,google.ima.AdEvent.Type.AD_BREAK_READY,function(e){t(e,"ad-break-ready")}),e.h.D(e.g,google.ima.AdEvent.Type.INTERACTION,function(e){t(e,"ad-interaction")})}function Dh(e,t){var n=t.getAd();n?(e.j=new Sh(n,e.g,e.i),t.type!=google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED||e.o.supportsMultipleMediaElements||e.l(new Or("ad-content-pause-requested")),t=(new Map).set("ad",e.j).set("sdkAdObject",n).set("originalEvent",t),e.l(new Or("ad-started",t)),e.j.isLinear()&&(e.s.setAttribute("ad-active","true"),e.o.customPlayheadTracker||e.i.pause(),e.i.muted?(t=e.j,t.l=e.i.volume,t.h.setVolume(0)):e.j.setVolume(e.i.volume))):Q("The IMA SDK fired a "+t.type+" event with no associated ad. Unable to play ad!")}function kh(e,t){t&&t.type==google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED&&!e.o.supportsMultipleMediaElements&&e.l(new Or("ad-content-resume-requested")),e.l(new Or("ad-stopped",(new Map).set("originalEvent",t))),e.j&&e.j.isLinear()&&(e.s.removeAttribute("ad-active"),e.o.customPlayheadTracker||e.i.ended||e.i.play())}function Mh(e,t,n,i,r){this.g=e,this.h=t,this.j=n,this.l=i,this.i=r}function Lh(e,t,n,i){var r=this;this.F=e,this.B=t,this.i=n,this.C=null,this.m=!0,this.s=this.i,this.g=i,this.G=new Set,this.A=new Set,this.o=new Map,this.h=new ef,Bh(this),this.I=new ae,this.j=new ae,this.H=!1,this.l=null,this.I.D(this.i,"timeupdate",function(){if(!r.H){var e=null==r.l||0==r.l;r.l=r.i.currentTime,(e=Nh(r,e))&&Oh(r,e,1,1,Date.now())}}),new Ft(function(){var e,t,n,i,a,o,s,l,u,d;return O(function(f){switch(f.g){case 1:if(!r.A.size||r.H||null==r.l){f.u(0);break}e=!1,t=Array.from(r.A),n=r.B.Qb(),i=c(t),a=i.next();case 3:if(a.done){f.u(5);break}if(o=a.value,s=o.endTime||o.startTime,!(1<=n.start-s)){l=o.startTime-r.l,0<l&&10>=l&&(r.o.has(o)||r.o.set(o,r.h.preload(o.uri))),f.u(4);break}if(!r.o.has(o)){f.u(7);break}return T(f,r.o.get(o),8);case 8:(u=f.h)&&u.destroy(),r.o.delete(o);case 7:d=JSON.stringify(o),r.G.has(d)&&r.G.delete(d),r.A.delete(o),e=!0;case 4:a=i.next(),f.u(3);break;case 5:e&&Uh(r),S(f)}})}).Sa(1)}function Ph(e,t){var n,i,r,a,o,s,l,u;O(function(d){if(1==d.g)return e.B.Mg()==vh&&e.m?(Q("Unsupported interstitial when using single media element",t),d.return()):(Bh(e),n=!1,T(d,Fh(e,t),2));if(i=d.h,i.length)for(r=c(i),a=r.next();!a.done;a=r.next())o=a.value,s=JSON.stringify(o),e.G.has(s)||(n=!0,e.G.add(s),e.A.add(o),l=!1,t.Cb&&null==e.l?l=!0:0!=o.startTime||o.ef?null!=e.l&&(u=t.startTime-e.l,0<u&&10>=u&&(l=!0)):l=!0,l&&(e.o.has(o)||e.o.set(o,e.h.preload(o.uri))));else Q("Unsupported interstitial",t);n&&Uh(e),S(d)})}function Nh(e,t,n){n=void 0===n?0:n;var i=0,r=null;if(e.A.size&&null!=e.l){var a=e.i.ended,o=Array.from(e.A).sort(function(e,t){return t.startTime-e.startTime});o=c(o);for(var s=o.next();!s.done;s=o.next()){s=s.value;var l=!1;if(t?l=s.Cb:a?l=s.sc:s.Cb||s.sc||(l=e.l-Math.round(1e3*s.startTime)/1e3,l=0<l&&(1>=l||!s.ef)),l){if(i==n){r=s;break}i++}}}return r}function Oh(e,t,n,i,r,a){var o,s,l,u,c,d,f,h,p,g,m,v,y,_;a=void 0===a?0:a,O(function(b){switch(b.g){case 1:if(o=Date.now(),!e.s.parentElement&&e.F&&e.F.appendChild(e.s),1==i&&1==n&&(n=Array.from(e.A).filter(function(e){return t.Cb?e.Cb==t.Cb:t.sc?e.sc==t.sc:.001>Math.abs(e.startTime-t.startTime)}).length),(t.once||t.Cb)&&(a++,e.A.delete(t),Uh(e)),e.H=!0,!e.m||1!=i){b.u(2);break}return e.g(new Or("ad-content-pause-requested",(new Map).set("saveLivePosition",!0))),s=new Rr,l=function(t){return O(function(n){if(1==n.g)return"detach"!=t.state?n.u(0):rn()?T(n,new Promise(function(e){return new Ft(e).Y(.1)}),3):n.u(3);s.resolve(),e.j.lb(e.B,"onstatechange",l),S(n)})},e.j.D(e.B,"onstatechange",l),T(b,s,2);case 2:return e.m||(e.i.pause(),null!=t.Rc&&0!=t.Rc&&(e.i.currentTime+=t.Rc)),u=!1,c=null,d=function(){if(!e.m&&null==t.Rc)if(t.Ke&&t.endTime&&1/0!=t.endTime)e.i.currentTime!=t.endTime&&(e.i.currentTime=t.endTime);else{var n=Date.now();e.i.currentTime+=(n-r)/1e3,r=n}},f=function(){var o,s;return O(function(l){if(1==l.g)return d(),c&&c.stop(),(o=Nh(e,t.Cb,i-a))?(e.g(new Or("ad-stopped")),e.j.Ra(),Oh(e,o,n,++i,r,a),l.u(0)):e.m?T(l,e.h.detach(),4):T(l,e.h.dc(),4);e.m&&(s=t.Rc,null==s&&(s=t.Ke&&t.endTime&&1/0!=t.endTime?t.endTime-(e.l||0):(Date.now()-r)/1e3),e.g(new Or("ad-content-resume-requested",(new Map).set("offset",s)))),e.g(new Or("ad-stopped")),e.j.Ra(),e.H=!1,e.m||(d(),e.i.ended||e.i.play()),S(l)})},h=function(t){return O(function(n){return u?n.return():(u=!0,e.g(new Or("ad-error",(new Map).set("originalEvent",t))),T(n,f(),0))})},p=function(){return O(function(t){if(1==t.g)return u?t.return():(u=!0,T(t,f(),2));e.g(new Or("ad-complete")),S(t)})},g=function(){return O(function(t){return u?t.return():(u=!0,e.g(new Or("ad-skipped")),T(t,f(),0))})},m=new Mh(e.s,t.isSkippable,g,n,i),e.m||(m.setMuted(e.i.muted),m.setVolume(e.i.volume)),e.g(new Or("ad-started",(new Map).set("ad",m))),m.canSkipNow()&&e.g(new Or("ad-skip-state-changed")),e.j.ha(e.h,"error",h),e.j.ha(e.h,"firstquartile",function(){d(),e.g(new Or("ad-first-quartile"))}),e.j.ha(e.h,"midpoint",function(){d(),e.g(new Or("ad-midpoint"))}),e.j.ha(e.h,"thirdquartile",function(){d(),e.g(new Or("ad-third-quartile"))}),e.j.ha(e.h,"complete",p),e.j.D(e.s,"play",function(){e.g(new Or("ad-resumed"))}),e.j.D(e.s,"pause",function(){e.g(new Or("ad-paused"))}),e.j.D(e.s,"volumechange",function(){e.s.muted?e.g(new Or("ad-muted")):e.g(new Or("ad-volume-changed"))}),w(b,4),t.Wf&&(c=new Ft(function(){m.skip()}).Y(t.Wf)),Bh(e),T(b,e.h.Ub(e.s),6);case 6:return e.o.has(t)?T(b,e.o.get(t),10):T(b,e.h.load(t.uri),8);case 10:return v=b.h,e.o.delete(t),T(b,v?e.h.load(v):e.h.load(t.uri),8);case 8:y=(Date.now()-o)/1e3,e.g(new Or("ads-loaded",(new Map).set("loadTime",y))),e.m&&e.i.play(),I(b,0);break;case 4:_=x(b),h(_),S(b)}})}function Fh(e,t){var n,i,r,a,o,s,l,u,d,f,h,p,g,m,v,y,_,b,E,S,A,R,C,D,k,M,L,P,N,F,U;return O(function(O){switch(O.g){case 1:if(n=[],!t)return O.return(n);if(i=t.values.find(function(e){return"X-ASSET-URI"==e.key}),r=t.values.find(function(e){return"X-ASSET-LIST"==e.key}),!i&&!r)return O.return(n);if(a=t.values.find(function(e){return"X-RESTRICT"==e.key}),s=o=!0,a&&a.data&&(l=a.data,o=!l.includes("SKIP"),s=!l.includes("JUMP")),u=null,(d=t.values.find(function(e){return"X-RESUME-OFFSET"==e.key}))&&(f=d.data,u=parseFloat(f),isNaN(u)&&(u=null)),h=null,(p=t.values.find(function(e){return"X-PLAYOUT-LIMIT"==e.key}))&&(g=p.data,h=parseFloat(g),isNaN(h)&&(h=null)),y=v=m=!1,(_=t.values.find(function(e){return"CUE"==e.key}))&&(b=_.data,m=b.includes("ONCE"),v=b.includes("PRE"),y=b.includes("POST")),E=!1,(S=t.values.find(function(e){return"X-TIMELINE-OCCUPIES"==e.key}))?(A=S.data,E=A.includes("RANGE")):!d&&e.B.V()&&(E=!v&&!y),i){if(R=i.data,!R)return O.return(n);n.push({startTime:t.startTime,endTime:t.endTime,uri:R,isSkippable:o,ef:s,Rc:u,Wf:h,once:m,Cb:v,sc:y,Ke:E}),O.u(2);break}if(!r){O.u(2);break}return C=r.data,C?(D=zr([C],xr()),k=e.B.zb().request(7,D),w(O,4),T(O,k.promise,6)):O.return(n);case 6:for(M=O.h,L=fn(M.data),P=JSON.parse(L),N=c(P.ASSETS),F=N.next();!F.done;F=N.next())U=F.value,U.URI&&n.push({startTime:t.startTime,endTime:t.endTime,uri:U.URI,isSkippable:o,ef:s,Rc:u,Wf:h,once:m,Cb:v,sc:y,Ke:E});I(O,2);break;case 4:x(O);case 2:return O.return(n)}})}function Uh(e){for(var t=[],n={},i=c(e.A),r=i.next();!r.done;n={vb:n.vb},r=i.next())r=r.value,n.vb={start:r.startTime,end:null},r.Cb?(n.vb.start=0,n.vb.end=null):r.sc?(n.vb.start=-1,n.vb.end=null):r.Ke&&(n.vb.end=r.endTime),t.find(function(e){return function(t){return e.vb.start==t.start&&e.vb.end==t.end}}(n))||t.push(n.vb);e.g(new Or("ad-cue-points-changed",(new Map).set("cuepoints",t)))}function Bh(e){e.h.configure(e.B.Og());var t=e.h.zb();t.Ag(),t.Bg(),Kr(e.B.zb(),t)}function Gh(e){this.h=e||"",this.g=0}function jh(e){Vh(e,/[ \t]+/gm)}function Vh(e,t){return t.lastIndex=e.g,t=t.exec(e.h),t=null==t?null:{position:t.index,length:t[0].length,results:t},e.g==e.h.length||null==t||t.position!=e.g?null:(e.g+=t.length,t.results)}function Hh(e){return e.g==e.h.length?null:(e=Vh(e,/[^ \t\n]*/gm))?e[0]:null}function Kh(e,t,n,i,r){if(this.h=e,e=this.h.skipOffset)if(e=Vh(new Gh(e),zh),null==e)e=null;else{var a=Number(e[2]),o=Number(e[3]);e=59<a||59<o?null:(Number(e[4])||0)/1e3+o+60*a+3600*(Number(e[1])||0)}else e=null;this.j=e,this.g=r,this.i=t,this.l=n,this.o=i,this.m=!1}i=Sh.prototype,i.needsSkipUI=function(){return!1},i.getDuration=function(){return this.g.getDuration()},i.getMinSuggestedDuration=function(){return this.g.getMinSuggestedDuration()},i.getRemainingTime=function(){return this.h.getRemainingTime()},i.isPaused=function(){return this.i},i.isSkippable=function(){return 0<=this.g.getSkipTimeOffset()},i.getTimeUntilSkippable=function(){var e=this.g.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},i.canSkipNow=function(){return this.h.getAdSkippableState()},i.skip=function(){return this.h.skip()},i.pause=function(){return this.h.pause()},i.play=function(){return this.h.resume()},i.getVolume=function(){return this.h.getVolume()},i.setVolume=function(e){return this.j.volume=e,this.h.setVolume(e)},i.isMuted=function(){return 0==this.h.getVolume()},i.isLinear=function(){return this.g.isLinear()},i.resize=function(e,t){var n=!1,i=this.j;document.fullscreenEnabled?n=!!document.fullscreenElement:i.webkitSupportsFullscreen&&(n=i.webkitDisplayingFullscreen),this.h.resize(e,t,n?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)},i.setMuted=function(e){(this.j.muted=e)?(this.l=this.getVolume(),this.h.setVolume(0)):this.h.setVolume(this.l)},i.getSequenceLength=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getTotalAds()},i.getPositionInSequence=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getAdPosition()},i.getTitle=function(){return this.g.getTitle()},i.getDescription=function(){return this.g.getDescription()},i.getVastMediaBitrate=function(){return this.g.getVastMediaBitrate()},i.getVastMediaHeight=function(){return this.g.getVastMediaHeight()},i.getVastMediaWidth=function(){return this.g.getVastMediaWidth()},i.getAdId=function(){return this.g.getAdId()},i.getCreativeAdId=function(){return this.g.getCreativeAdId()},i.getAdvertiserName=function(){return this.g.getAdvertiserName()},i.getMediaUrl=function(){return this.g.getMediaUrl()},i.getTimeOffset=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getTimeOffset()},i.getPodIndex=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getPodIndex()},i.release=function(){this.h=this.g=null},K("shaka.ads.ClientSideAd",Sh),Sh.prototype.release=Sh.prototype.release,Sh.prototype.getPodIndex=Sh.prototype.getPodIndex,Sh.prototype.getTimeOffset=Sh.prototype.getTimeOffset,Sh.prototype.getMediaUrl=Sh.prototype.getMediaUrl,Sh.prototype.getAdvertiserName=Sh.prototype.getAdvertiserName,Sh.prototype.getCreativeAdId=Sh.prototype.getCreativeAdId,Sh.prototype.getAdId=Sh.prototype.getAdId,Sh.prototype.getVastMediaWidth=Sh.prototype.getVastMediaWidth,Sh.prototype.getVastMediaHeight=Sh.prototype.getVastMediaHeight,Sh.prototype.getVastMediaBitrate=Sh.prototype.getVastMediaBitrate,Sh.prototype.getDescription=Sh.prototype.getDescription,Sh.prototype.getTitle=Sh.prototype.getTitle,Sh.prototype.getPositionInSequence=Sh.prototype.getPositionInSequence,Sh.prototype.getSequenceLength=Sh.prototype.getSequenceLength,Sh.prototype.setMuted=Sh.prototype.setMuted,Sh.prototype.resize=Sh.prototype.resize,Sh.prototype.isLinear=Sh.prototype.isLinear,Sh.prototype.isMuted=Sh.prototype.isMuted,Sh.prototype.setVolume=Sh.prototype.setVolume,Sh.prototype.getVolume=Sh.prototype.getVolume,Sh.prototype.play=Sh.prototype.play,Sh.prototype.pause=Sh.prototype.pause,Sh.prototype.skip=Sh.prototype.skip,Sh.prototype.canSkipNow=Sh.prototype.canSkipNow,Sh.prototype.getTimeUntilSkippable=Sh.prototype.getTimeUntilSkippable,Sh.prototype.isSkippable=Sh.prototype.isSkippable,Sh.prototype.isPaused=Sh.prototype.isPaused,Sh.prototype.getRemainingTime=Sh.prototype.getRemainingTime,Sh.prototype.getMinSuggestedDuration=Sh.prototype.getMinSuggestedDuration,Sh.prototype.getDuration=Sh.prototype.getDuration,Sh.prototype.needsSkipUI=Sh.prototype.needsSkipUI,K("shaka.ads.Utils",wh),wh.ADS_LOADED="ads-loaded",wh.AD_STARTED="ad-started",wh.AD_FIRST_QUARTILE="ad-first-quartile",wh.AD_MIDPOINT="ad-midpoint",wh.AD_THIRD_QUARTILE="ad-third-quartile",wh.AD_COMPLETE="ad-complete",wh.AD_STOPPED="ad-stopped",wh.AD_SKIPPED="ad-skipped",wh.AD_VOLUME_CHANGED="ad-volume-changed",wh.AD_MUTED="ad-muted",wh.AD_PAUSED="ad-paused",wh.AD_RESUMED="ad-resumed",wh.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",wh.CUEPOINTS_CHANGED="ad-cue-points-changed",wh.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",wh.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",wh.AD_CLICKED="ad-clicked",wh.AD_PROGRESS="ad-progress",wh.AD_BUFFERING="ad-buffering",wh.AD_IMPRESSION="ad-impression",wh.AD_DURATION_CHANGED="ad-duration-changed",wh.AD_CLOSED="ad-closed",wh.AD_LOADED="ad-loaded",wh.ALL_ADS_COMPLETED="all-ads-completed",wh.AD_LINEAR_CHANGED="ad-linear-changed",wh.AD_METADATA="ad-metadata",wh.AD_RECOVERABLE_ERROR="ad-recoverable-error",wh.AD_ERROR="ad-error",wh.AD_BREAK_READY="ad-break-ready",wh.AD_INTERACTION="ad-interaction",wh.AD_CONTENT_PAUSE_REQUESTED="ad-content-pause-requested",wh.AD_CONTENT_RESUME_REQUESTED="ad-content-resume-requested",wh.AD_CONTENT_ATTACH_REQUESTED="ad-content-attach-requested",Ah.prototype.configure=function(e){this.o=e},Ah.prototype.stop=function(){this.g&&this.g.stop(),this.s&&gd(this.s)},Ah.prototype.release=function(){this.stop(),this.A&&this.A.disconnect(),this.h&&this.h.release(),this.g&&this.g.destroy(),this.m.destroy(),this.C.destroy()},i=Mh.prototype,i.needsSkipUI=function(){return!0},i.getDuration=function(){var e=this.g.duration;return isNaN(e)?-1:e},i.getMinSuggestedDuration=function(){return this.getDuration()},i.getRemainingTime=function(){var e=this.g.duration;return isNaN(e)?-1:e-this.g.currentTime},i.isPaused=function(){return this.g.paused},i.isSkippable=function(){return this.h},i.getTimeUntilSkippable=function(){return this.h?0:Math.max(this.getRemainingTime(),0)},i.canSkipNow=function(){return 0==this.getTimeUntilSkippable()},i.skip=function(){this.j()},i.pause=function(){return this.g.pause()},i.play=function(){return this.g.play()},i.getVolume=function(){return this.g.volume},i.setVolume=function(e){this.g.volume=e},i.isMuted=function(){return this.g.muted},i.isLinear=function(){return!0},i.resize=function(){},i.setMuted=function(e){this.g.muted=e},i.getSequenceLength=function(){return this.l},i.getPositionInSequence=function(){return this.i},i.getTitle=function(){return""},i.getDescription=function(){return""},i.getVastMediaBitrate=function(){return 0},i.getVastMediaHeight=function(){return 0},i.getVastMediaWidth=function(){return 0},i.getAdId=function(){return""},i.getCreativeAdId=function(){return""},i.getAdvertiserName=function(){return""},i.getMediaUrl=function(){return null},i.getTimeOffset=function(){return 0},i.getPodIndex=function(){return 0},i.release=function(){this.g=null},K("shaka.ads.InterstitialAd",Mh),Mh.prototype.release=Mh.prototype.release,Mh.prototype.getPodIndex=Mh.prototype.getPodIndex,Mh.prototype.getTimeOffset=Mh.prototype.getTimeOffset,Mh.prototype.getMediaUrl=Mh.prototype.getMediaUrl,Mh.prototype.getAdvertiserName=Mh.prototype.getAdvertiserName,Mh.prototype.getCreativeAdId=Mh.prototype.getCreativeAdId,Mh.prototype.getAdId=Mh.prototype.getAdId,Mh.prototype.getVastMediaWidth=Mh.prototype.getVastMediaWidth,Mh.prototype.getVastMediaHeight=Mh.prototype.getVastMediaHeight,Mh.prototype.getVastMediaBitrate=Mh.prototype.getVastMediaBitrate,Mh.prototype.getDescription=Mh.prototype.getDescription,Mh.prototype.getTitle=Mh.prototype.getTitle,Mh.prototype.getPositionInSequence=Mh.prototype.getPositionInSequence,Mh.prototype.getSequenceLength=Mh.prototype.getSequenceLength,Mh.prototype.setMuted=Mh.prototype.setMuted,Mh.prototype.resize=Mh.prototype.resize,Mh.prototype.isLinear=Mh.prototype.isLinear,Mh.prototype.isMuted=Mh.prototype.isMuted,Mh.prototype.setVolume=Mh.prototype.setVolume,Mh.prototype.getVolume=Mh.prototype.getVolume,Mh.prototype.play=Mh.prototype.play,Mh.prototype.pause=Mh.prototype.pause,Mh.prototype.skip=Mh.prototype.skip,Mh.prototype.canSkipNow=Mh.prototype.canSkipNow,Mh.prototype.getTimeUntilSkippable=Mh.prototype.getTimeUntilSkippable,Mh.prototype.isSkippable=Mh.prototype.isSkippable,Mh.prototype.isPaused=Mh.prototype.isPaused,Mh.prototype.getRemainingTime=Mh.prototype.getRemainingTime,Mh.prototype.getMinSuggestedDuration=Mh.prototype.getMinSuggestedDuration,Mh.prototype.getDuration=Mh.prototype.getDuration,Mh.prototype.needsSkipUI=Mh.prototype.needsSkipUI,Lh.prototype.configure=function(e){this.F&&this.m==e.supportsMultipleMediaElements&&((this.m=!e.supportsMultipleMediaElements)?(this.s=this.i,this.C&&(this.C.parentElement&&this.F.removeChild(this.C),this.C=null)):(this.C||(e=document.createElement(this.i.tagName),e.autoplay=!0,e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.backgroundColor="rgb(0, 0, 0)",e.setAttribute("playsinline",""),this.C=e),this.s=this.C))},Lh.prototype.stop=function(){this.j&&this.j.Ra(),this.G.clear(),this.A.clear(),this.h.lf(),this.o.clear(),this.h.detach(),this.H=!1,this.l=null},Lh.prototype.release=function(){this.stop(),this.I&&this.I.release(),this.j&&this.j.release(),this.F&&gd(this.F),this.h.destroy()},i=Kh.prototype,i.needsSkipUI=function(){return!0},i.getDuration=function(){return this.h.durationInSeconds},i.getMinSuggestedDuration=function(){return this.getDuration()},i.getRemainingTime=function(){return this.h.startTimeInSeconds+this.h.durationInSeconds-this.g.currentTime},i.isPaused=function(){return this.g.paused},i.isSkippable=function(){return"number"==typeof this.j},i.getTimeUntilSkippable=function(){if("number"!=typeof this.j)return this.getRemainingTime();var e=this.getRemainingTime()+this.j-this.getDuration();return Math.max(e,0)},i.canSkipNow=function(){return 0==this.getTimeUntilSkippable()},i.skip=function(){this.m=!0,this.g.currentTime+=this.getRemainingTime()},i.pause=function(){return this.g.pause()},i.play=function(){return this.g.play()},i.getVolume=function(){return this.g.volume},i.setVolume=function(e){this.g.volume=e},i.isMuted=function(){return this.g.muted},i.isLinear=function(){return this.o},i.resize=function(){},i.setMuted=function(e){this.g.muted=e},i.getSequenceLength=function(){return this.l?this.l:1},i.getPositionInSequence=function(){return this.i?this.i:1},i.getTitle=function(){return this.h.adTitle},i.getDescription=function(){return""},i.getVastMediaBitrate=function(){return 0},i.getVastMediaHeight=function(){return 0},i.getVastMediaWidth=function(){return 0},i.getAdId=function(){return this.h.adId},i.getCreativeAdId=function(){return this.h.creativeId},i.getAdvertiserName=function(){return""},i.getMediaUrl=function(){return null},i.getTimeOffset=function(){return 0},i.getPodIndex=function(){return 0},i.release=function(){this.l=this.i=this.g=this.h=null},K("shaka.ads.MediaTailorAd",Kh),Kh.prototype.release=Kh.prototype.release,Kh.prototype.getPodIndex=Kh.prototype.getPodIndex,Kh.prototype.getTimeOffset=Kh.prototype.getTimeOffset,Kh.prototype.getMediaUrl=Kh.prototype.getMediaUrl,Kh.prototype.getAdvertiserName=Kh.prototype.getAdvertiserName,Kh.prototype.getCreativeAdId=Kh.prototype.getCreativeAdId,Kh.prototype.getAdId=Kh.prototype.getAdId,Kh.prototype.getVastMediaWidth=Kh.prototype.getVastMediaWidth,Kh.prototype.getVastMediaHeight=Kh.prototype.getVastMediaHeight,Kh.prototype.getVastMediaBitrate=Kh.prototype.getVastMediaBitrate,Kh.prototype.getDescription=Kh.prototype.getDescription,Kh.prototype.getTitle=Kh.prototype.getTitle,Kh.prototype.getPositionInSequence=Kh.prototype.getPositionInSequence,Kh.prototype.getSequenceLength=Kh.prototype.getSequenceLength,Kh.prototype.setMuted=Kh.prototype.setMuted,Kh.prototype.resize=Kh.prototype.resize,Kh.prototype.isLinear=Kh.prototype.isLinear,Kh.prototype.isMuted=Kh.prototype.isMuted,Kh.prototype.setVolume=Kh.prototype.setVolume,Kh.prototype.getVolume=Kh.prototype.getVolume,Kh.prototype.play=Kh.prototype.play,Kh.prototype.pause=Kh.prototype.pause,Kh.prototype.skip=Kh.prototype.skip,Kh.prototype.canSkipNow=Kh.prototype.canSkipNow,Kh.prototype.getTimeUntilSkippable=Kh.prototype.getTimeUntilSkippable,Kh.prototype.isSkippable=Kh.prototype.isSkippable,Kh.prototype.isPaused=Kh.prototype.isPaused,Kh.prototype.getRemainingTime=Kh.prototype.getRemainingTime,Kh.prototype.getMinSuggestedDuration=Kh.prototype.getMinSuggestedDuration,Kh.prototype.getDuration=Kh.prototype.getDuration,Kh.prototype.needsSkipUI=Kh.prototype.needsSkipUI;var zh=/(?:(\d{1,}):)?(\d{2}):(\d{2})((\.(\d{1,3})))?/g;function Zh(e,t,n,i){this.B=e,this.K=t,this.h=n,this.l=null,this.U=NaN,this.i=i,this.I=!1,this.A=null,this.j=[],this.N=[],this.L=this.C=this.g=null,this.F=new Map,this.m=[],this.s=[],this.G="",this.R=!0,this.H="",this.o=new ae}function qh(e,t,n){var i,r,a,o,s,l,u,c,d,f,h;O(function(p){if(1==p.g)return i=zr([t],xr()),i.method="POST",n&&(r=JSON.stringify(n),i.body=gn(r)),a=e.K.request(7,i),w(p,2),T(p,a.promise,4);if(2!=p.g){if(o=p.h,s=fn(o.data),l=JSON.parse(s),!l.manifestUrl||!l.trackingUrl)throw Error("Insufficient data from MediaTailor.");return u=new ft(t),c=new ft(l.trackingUrl),e.G=u.resolve(c).toString(),d=Date.now()/1e3,f=d-e.U,e.i(new Or("ads-loaded",(new Map).set("loadTime",f))),h=new ft(l.manifestUrl),e.l.resolve(u.resolve(h).toString()),e.l=null,I(p,0)}if(x(p),!e.H.length)return e.l.reject("MediaTailor request returned an error and there was no backup asset uri provided."),e.l=null,p.return();e.l.resolve(e.H),e.l=null,S(p)})}function Yh(e,t,n){var i,r,a,o,s,l,u,d,f,h,p,g,m,v,y;O(function(_){if(1==_.g)return i=zr([t],xr()),r=e.K.request(7,i),w(_,2),T(_,r.promise,4);if(2!=_.g){if(a=_.h,o=[],s=fn(a.data),l=JSON.parse(s),0<l.avails.length){if(JSON.stringify(e.j)!=JSON.stringify(l.avails)){for(e.j=l.avails,u=c(e.j),d=u.next();!d.done;d=u.next())for(f=d.value,h=c(f.nonLinearAdsList),p=h.next();!p.done;p=h.next())for(g=p.value,m=c(g.nonLinearAdList),v=m.next();!v.done;v=m.next())y=v.value,Wh(e,y);o=e.getCuePoints(),e.i(new Or("ad-cue-points-changed",(new Map).set("cuepoints",o)))}}else e.j.length&&e.i(new Or("ad-cue-points-changed",(new Map).set("cuepoints",o))),ep(e),e.j=[];return n&&(e.I||0<o.length)&&Xh(e),I(_,0)}x(_),S(_)})}function Wh(e,t){var n,i,r,a,o,s,l;O(function(u){return 1==u.g?t.staticResource?(n=$h(t),e.F.get(n)?u.return():(i=zr([t.staticResource],xr()),r=e.K.request(7,i),w(u,2),e.F.set(n,[]),T(u,r.promise,4))):u.return():2!=u.g?(a=u.h,o=fn(a.data),s=JSON.parse(o),l=s.apps,e.F.set(n,l),I(u,0)):(x(u),e.F.delete(n),void S(u))})}function $h(e){return[e.adId,e.adParameters,e.adSystem,e.adTitle,e.creativeAdId,e.creativeId,e.creativeSequence,e.height,e.width,e.staticResource].join("")}function Xh(e){Jh(e),e.I||(Qh(e),e.o.D(e.h,"seeked",function(){Qh(e)}),e.o.D(e.h,"ended",function(){ep(e)})),e.o.D(e.h,"timeupdate",function(){Jh(e)})}function Qh(e){var t=e.h.currentTime;if(0!=t&&null==e.A){for(var n,i,r=c(e.j),a=r.next();!a.done;a=r.next()){a=a.value;for(var o=c(a.ads),s=o.next();!s.done;s=o.next())if(s=s.value,i){if(s.startTimeInSeconds<t&&s.startTimeInSeconds>i.startTimeInSeconds+i.durationInSeconds){i=s,n=a;break}}else s.startTimeInSeconds<t&&(i=s,n=a)}n&&i&&!e.N.includes(i.adId)&&(e.A=t,e.h.currentTime=n.startTimeInSeconds)}}function Jh(e){if(e.h.duration&&(e.g||e.j.length)){var t=e.h.currentTime,n=!1;if(e.g){n=!0;var i=e.C,r=i.startTimeInSeconds+.5*i.durationInSeconds,a=i.startTimeInSeconds+.75*i.durationInSeconds;t>=i.startTimeInSeconds+.25*i.durationInSeconds&&!e.s.includes("firstQuartile")?(e.s.push("firstQuartile"),np(e,"firstQuartile")):t>=r&&!e.s.includes("midpoint")?(e.s.push("midpoint"),np(e,"midpoint")):t>=a&&!e.s.includes("thirdQuartile")&&(e.s.push("thirdQuartile"),np(e,"thirdQuartile")),i=e.g.getRemainingTime(),r=e.g.getDuration(),e.g.canSkipNow()&&0<i&&0<r&&np(e,"skipStateChanged"),0<r&&(0>=i||i>r)&&ep(e)}if(!e.g||!e.g.isLinear()){e:for(i=c(e.j),r=i.next();!r.done;r=i.next()){if(r=r.value,e.g&&e.g.isLinear())break;for(a=0;a<r.ads.length;a++){var o=r.ads[a],s=o.startTimeInSeconds+o.durationInSeconds;if(o.startTimeInSeconds<=t&&s>t){if(e.N.includes(o.adId)){if(e.h.ended)continue;e.h.currentTime=s;break e}ep(e),e.L=r,e.g=new Kh(o,a+1,r.ads.length,!0,e.h),e.C=o,0===a&&np(e,"breakStart"),tp(e);break}}}if(!e.g)for(i=c(e.j),r=i.next();!r.done;r=i.next()){if(r=r.value,e.g)break;for(a=0;a<r.nonLinearAdsList.length;a++)if(o=r.nonLinearAdsList[a],o.nonLinearAdList.length){s=r.startTimeInSeconds;var l=e.F.get($h(o.nonLinearAdList[0]));if(s<=t&&l&&l.length){ep(e),s=e,l=c(l);for(var u=l.next();!u.done;u=l.next())if(u=u.value,u.data.source.length){var d=document.createElement("img");d.src=u.data.source[0].url,d.style.top=(u.placeholder.top||0)+"%",d.style.height=100-(u.placeholder.top||0)+"%",d.style.left=(u.placeholder.left||0)+"%",d.style.maxWidth=100-(u.placeholder.left||0)+"%",d.style.objectFit="contain",d.style.position="absolute",s.B.appendChild(d)}e.L=r,e.g=new Kh(o,a+1,r.ads.length,!1,e.h),e.C=o,0===a&&np(e,"breakStart"),tp(e);break}}}n&&!e.g&&(t=e.h.currentTime,e.A&&e.A>t&&(e.h.currentTime=e.A),e.A=null)}}}function ep(e){if(e.g){for(;e.B.lastChild;)e.B.removeChild(e.B.firstChild);e.I||e.N.push(e.C.adId);var t=e.g.m;np(e,void 0!==t&&t?"skip":"complete"),t=c(e.m);for(var n=t.next();!n.done;n=t.next())n=n.value,e.o.lb(n.target,n.type,n.listener);e.m=[],e.s=[],t=e.g.getPositionInSequence(),n=e.g.getSequenceLength(),t===n&&np(e,"breakEnd"),e.g=null,e.C=null,e.L=null}}function tp(e){var t=!1;e.h.paused?t=!0:(np(e,"impression"),np(e,"start")),e.m.push({target:e.h,type:"volumechange",listener:function(){e.h.muted&&np(e,"mute")}}),e.m.push({target:e.h,type:"volumechange",listener:function(){e.h.muted||np(e,"unmute")}}),e.m.push({target:e.h,type:"play",listener:function(){t?(np(e,"impression"),np(e,"start"),t=!1):np(e,"resume")}}),e.m.push({target:e.h,type:"pause",listener:function(){np(e,"pause")}});for(var n=c(e.m),i=n.next();!i.done;i=n.next())i=i.value,e.o.D(i.target,i.type,i.listener)}function np(e,t){var n=e.C.trackingEvents.find(function(e){return e.eventType==t});if(n||(n=e.L.adBreakTrackingEvents.find(function(e){return e.eventType==t})),n){n=c(n.beaconUrls);for(var i=n.next();!i.done;i=n.next())(i=i.value)&&""!=i&&(i=zr([i],xr()),i.method="POST",e.K.request(7,i))}switch(t){case"impression":e.i(new Or("ad-impression"));break;case"start":e.i(new Or("ad-started",(new Map).set("ad",e.g)));break;case"mute":e.i(new Or("ad-muted"));break;case"unmute":e.i(new Or("ad-volume-changed"));break;case"resume":e.i(new Or("ad-resumed"));break;case"pause":e.i(new Or("ad-paused"));break;case"firstQuartile":e.i(new Or("ad-first-quartile"));break;case"midpoint":e.i(new Or("ad-midpoint"));break;case"thirdQuartile":e.i(new Or("ad-third-quartile"));break;case"complete":e.i(new Or("ad-complete")),e.i(new Or("ad-stopped"));break;case"skip":e.i(new Or("ad-skipped")),e.i(new Or("ad-stopped"));break;case"breakStart":e.B.setAttribute("ad-active","true");break;case"breakEnd":e.B.removeAttribute("ad-active");break;case"skipStateChanged":e.i(new Or("ad-skip-state-changed"))}}function ip(e,t){this.g=e,this.i=null,this.h=t}function rp(e,t,n,i){var r=this;this.s=e,this.l=t,this.j=null,this.F=NaN,this.i=i,this.G=!1,this.A=this.m=this.o=null,this.B="",this.C=[],this.h=new ae,e=new google.ima.dai.api.UiSettings,e.setLocale(n),this.g=new google.ima.dai.api.StreamManager(this.l,this.s,e),this.i(new Or("ima-stream-manager-loaded",(new Map).set("imaStreamManager",this.g))),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.LOADED,function(e){ap(r,e)}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.ERROR,function(){r.B.length?r.j.resolve(r.B):r.j.reject("IMA Stream request returned an error and there was no backup asset uri provided."),r.j=null}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_BREAK_STARTED,function(){}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.STARTED,function(e){e=e.getAd(),r.m=new ip(e,r.l),r.A&&(r.m.i=r.A),r.i(new Or("ad-started",(new Map).set("ad",r.m))),r.s.setAttribute("ad-active","true")}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_BREAK_ENDED,function(){r.s.removeAttribute("ad-active");var e=r.l.currentTime;r.o&&r.o>e&&(r.l.currentTime=r.o,r.o=null)}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_PROGRESS,function(e){r.A=e.getStreamData().adProgressData,r.m&&(r.m.i=r.A)}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.FIRST_QUARTILE,function(){r.i(new Or("ad-first-quartile"))}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.MIDPOINT,function(){r.i(new Or("ad-midpoint"))}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.THIRD_QUARTILE,function(){r.i(new Or("ad-third-quartile"))}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.COMPLETE,function(){r.i(new Or("ad-complete")),r.i(new Or("ad-stopped")),r.s.removeAttribute("ad-active"),r.m=null}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.SKIPPED,function(){r.i(new Or("ad-skipped")),r.i(new Or("ad-stopped"))}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.CUEPOINTS_CHANGED,function(e){var t=e.getStreamData();e=[],t=c(t.cuepoints);for(var n=t.next();!n.done;n=t.next())n=n.value,e.push({start:n.start,end:n.end});r.C=e,r.i(new Or("ad-cue-points-changed",(new Map).set("cuepoints",e)))})}function ap(e,t){e.i(new Or("ads-loaded",(new Map).set("loadTime",Date.now()/1e3-e.F))),t=t.getStreamData().url,e.j.resolve(t),e.j=null,e.G||e.h.D(e.l,"seeked",function(){var t=e.l.currentTime;if(0!=t){e.g.streamTimeForContentTime(t);var n=e.g.previousCuePointForStreamTime(t);n&&!n.played&&(e.o=t,e.l.currentTime=n.start)}})}function op(){Br.call(this),this.g=this.h=this.i=this.j=null,this.m=new Eh,this.o=navigator.language,this.l=null}function sp(e,t){if(t&&t.type)switch(t.type){case"ads-loaded":e.m.g.push(t.loadTime);break;case"ad-started":e.m.h++;break;case"ad-complete":e.m.j++;break;case"ad-skipped":e.m.l++;break;case"ad-error":e.m.i++}e.dispatchEvent(t)}function lp(e){return JSON.stringify(e,function(e,t){if("function"!=typeof t){if(t instanceof Event||t instanceof Or){var n={};for(i in t)(e=t[i])&&"object"==typeof e?"detail"==i&&(n[i]=e):i in Event||(n[i]=e);return n}if(t instanceof Error){var i=new Set(["name","message","stack"]);for(n in t)i.add(n);for(e=c(Object.getOwnPropertyNames(t)),n=e.next();!n.done;n=e.next())i.add(n.value);for(e={},i=c(i),n=i.next();!n.done;n=i.next())n=n.value,e[n]=t[n];t={__type__:"Error",contents:e}}else if(t instanceof TimeRanges){for(i={__type__:"TimeRanges",length:t.length,start:[],end:[]},t=c(ss(t)),n=t.next();!n.done;n=t.next())n=n.value,e=n.end,i.start.push(n.start),i.end.push(e);t=i}else t=t instanceof Uint8Array?{__type__:"Uint8Array",entries:Array.from(t)}:"number"==typeof t?isNaN(t)?"NaN":isFinite(t)?t:0>t?"-Infinity":"Infinity":t;return t}})}function up(e){return JSON.parse(e,function(e,t){if("NaN"==t)var n=NaN;else if("-Infinity"==t)n=-1/0;else if("Infinity"==t)n=1/0;else if(t&&"object"==typeof t&&"TimeRanges"==t.__type__)n=cp(t);else if(t&&"object"==typeof t&&"Uint8Array"==t.__type__)n=new Uint8Array(t.entries);else if(t&&"object"==typeof t&&"Error"==t.__type__){for(n in e=t.contents,t=Error(e.message),e)t[n]=e[n];n=t}else n=t;return n})}function cp(e){return{length:e.length,start:function(t){return e.start[t]},end:function(t){return e.end[t]}}}Zh.prototype.stop=function(){for(var e=c(this.m),t=e.next();!t.done;t=e.next())t=t.value,this.o.lb(t.target,t.type,t.listener);ep(this),this.m=[],this.s=[],this.G="",this.R=!0,this.H="",this.A=null,this.j=[],this.N=[],this.F.clear()},Zh.prototype.release=function(){this.stop(),this.o&&this.o.release()},Zh.prototype.onManifestUpdated=function(e){this.I=e,""!=this.G&&(Yh(this,this.G,this.R),this.R=!1)},Zh.prototype.getCuePoints=function(){for(var e=[],t=c(this.j),n=t.next();!n.done;n=t.next()){n=c(n.value.ads);for(var i=n.next();!i.done;i=n.next())i=i.value,e.push({start:i.startTimeInSeconds,end:i.startTimeInSeconds+i.durationInSeconds})}return e},i=ip.prototype,i.needsSkipUI=function(){return!0},i.getDuration=function(){return this.i?this.i.duration:-1},i.getMinSuggestedDuration=function(){return this.getDuration()},i.getRemainingTime=function(){return this.i?this.i.duration-this.i.currentTime:-1},i.isPaused=function(){return this.h.paused},i.isSkippable=function(){return this.g.isSkippable()},i.getTimeUntilSkippable=function(){var e=this.g.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},i.canSkipNow=function(){return 0==this.getTimeUntilSkippable()},i.skip=function(){this.h.currentTime+=this.getRemainingTime()},i.pause=function(){return this.h.pause()},i.play=function(){return this.h.play()},i.getVolume=function(){return this.h.volume},i.setVolume=function(e){this.h.volume=e},i.isMuted=function(){return this.h.muted},i.isLinear=function(){return!0},i.resize=function(){},i.setMuted=function(e){this.h.muted=e},i.getSequenceLength=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getTotalAds()},i.getPositionInSequence=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getAdPosition()},i.getTitle=function(){return this.g.getTitle()},i.getDescription=function(){return this.g.getDescription()},i.getVastMediaBitrate=function(){return 0},i.getVastMediaHeight=function(){return this.g.getVastMediaHeight()},i.getVastMediaWidth=function(){return this.g.getVastMediaWidth()},i.getAdId=function(){return this.g.getAdId()},i.getCreativeAdId=function(){return this.g.getCreativeAdId()},i.getAdvertiserName=function(){return this.g.getAdvertiserName()},i.getMediaUrl=function(){return null},i.getTimeOffset=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getTimeOffset()},i.getPodIndex=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getPodIndex()},i.release=function(){this.h=this.i=this.g=null},K("shaka.ads.ServerSideAd",ip),ip.prototype.release=ip.prototype.release,ip.prototype.getPodIndex=ip.prototype.getPodIndex,ip.prototype.getTimeOffset=ip.prototype.getTimeOffset,ip.prototype.getMediaUrl=ip.prototype.getMediaUrl,ip.prototype.getAdvertiserName=ip.prototype.getAdvertiserName,ip.prototype.getCreativeAdId=ip.prototype.getCreativeAdId,ip.prototype.getAdId=ip.prototype.getAdId,ip.prototype.getVastMediaWidth=ip.prototype.getVastMediaWidth,ip.prototype.getVastMediaHeight=ip.prototype.getVastMediaHeight,ip.prototype.getVastMediaBitrate=ip.prototype.getVastMediaBitrate,ip.prototype.getDescription=ip.prototype.getDescription,ip.prototype.getTitle=ip.prototype.getTitle,ip.prototype.getPositionInSequence=ip.prototype.getPositionInSequence,ip.prototype.getSequenceLength=ip.prototype.getSequenceLength,ip.prototype.setMuted=ip.prototype.setMuted,ip.prototype.resize=ip.prototype.resize,ip.prototype.isLinear=ip.prototype.isLinear,ip.prototype.isMuted=ip.prototype.isMuted,ip.prototype.setVolume=ip.prototype.setVolume,ip.prototype.getVolume=ip.prototype.getVolume,ip.prototype.play=ip.prototype.play,ip.prototype.pause=ip.prototype.pause,ip.prototype.skip=ip.prototype.skip,ip.prototype.canSkipNow=ip.prototype.canSkipNow,ip.prototype.getTimeUntilSkippable=ip.prototype.getTimeUntilSkippable,ip.prototype.isSkippable=ip.prototype.isSkippable,ip.prototype.isPaused=ip.prototype.isPaused,ip.prototype.getRemainingTime=ip.prototype.getRemainingTime,ip.prototype.getMinSuggestedDuration=ip.prototype.getMinSuggestedDuration,ip.prototype.getDuration=ip.prototype.getDuration,ip.prototype.needsSkipUI=ip.prototype.needsSkipUI,i=rp.prototype,i.configure=function(){},i.stop=function(){this.B="",this.o=null,this.C=[]},i.release=function(){this.stop(),this.h&&this.h.release()},i.onCueMetadataChange=function(e){if(e.key&&e.data){var t={};t[e.key]=e.data,this.g.onTimedMetadata(t)}},i.getCuePoints=function(){return this.C},y(op,Br),i=op.prototype,i.setLocale=function(e){this.o=e},i.configure=function(e){this.l=e,this.j&&this.j.configure(this.l),this.i&&this.i.configure(this.l),this.g&&this.g.configure(this.l)},i.initInterstitial=function(e,t,n){var i=this;this.j&&this.j.release(),this.j=new Lh(e,t,n,function(e){return sp(i,e)}),this.j.configure(this.l)},i.initClientSide=function(t,n,i){var r=this;if(!e.google||!google.ima||!google.ima.AdsLoader)throw new Rt(2,10,1e4);this.i&&this.i.release(),this.i=new Ah(t,n,this.o,i,function(e){return sp(r,e)}),this.i.configure(this.l)},i.release=function(){this.j&&(this.j.release(),this.j=null),this.i&&(this.i.release(),this.i=null),this.h&&(this.h.release(),this.h=null),this.g&&(this.g.release(),this.g=null),Br.prototype.release.call(this)},i.onAssetUnload=function(){this.j&&this.j.stop(),this.i&&this.i.stop(),this.h&&this.h.stop(),this.g&&this.g.stop(),this.dispatchEvent(new Or("ad-stopped")),this.dispatchEvent(new Or("ad-content-attach-requested")),this.m=new Eh},i.requestClientSideAds=function(e){if(!this.i)throw new Rt(1,10,10001);var t=this.i;t.g&&t.g.destroy(),t.m&&t.m.contentComplete(),t.G=Date.now()/1e3,t.m.requestAds(e)},i.updateClientSideAdsRenderingSettings=function(e){if(!this.i)throw new Rt(1,10,10001);var t=this.i;t.B=e,t.g&&t.g.updateAdsRenderingSettings(t.B)},i.initMediaTailor=function(e,t,n){var i=this;this.h&&this.h.release(),this.h=new Zh(e,t,n,function(e){return sp(i,e)})},i.requestMediaTailorStream=function(e,t,n){if(!this.h)throw new Rt(1,10,10005);var i=this.h;return n=void 0===n?"":n,i.l?e=Promise.reject(new Rt(1,10,10004)):(i.l=new Rr,qh(i,e,t),i.H=n||"",i.U=Date.now()/1e3,e=i.l),e},i.addMediaTailorTrackingUrl=function(e){if(!this.h)throw new Rt(1,10,10005);var t=this.h;t.G=e,t.i(new Or("ads-loaded",(new Map).set("loadTime",0)))},i.initServerSide=function(t,n){var i=this;if(!e.google||!google.ima||!google.ima.dai)throw new Rt(2,10,10002);this.g&&this.g.release(),this.g=new rp(t,n,this.o,function(e){return sp(i,e)}),this.g.configure(this.l)},i.requestServerSideStream=function(e,t){if(t=void 0===t?"":t,!this.g)throw new Rt(1,10,10003);e.adTagParameters||(e.adTagParameters={});var n=e.adTagParameters;return(n.mpt||n.mpv)&&Q('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overriden.'),e.adTagParameters.mpt="shaka-player",e.adTagParameters.mpv="v4.10.9",n=this.g,n.j?e=Promise.reject(new Rt(1,10,10004)):(e instanceof google.ima.dai.api.LiveStreamRequest&&(n.G=!0),n.j=new Rr,n.g.requestStream(e),n.B=t||"",n.F=Date.now()/1e3,e=n.j),e},i.replaceServerSideAdTagParameters=function(e){if(!this.g)throw new Rt(1,10,10003);(e.mpt||e.mpv)&&Q('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overriden.'),e.mpt="Shaka Player",e.mpv="v4.10.9",this.g.g.replaceAdTagParameters(e)},i.getServerSideCuePoints=function(){return pe("AdManager.getServerSideCuePoints","Please use getCuePoints function."),this.getCuePoints()},i.getCuePoints=function(){var e=[];return this.g&&(e=e.concat(this.g.getCuePoints())),this.h&&(e=e.concat(this.h.getCuePoints())),e},i.getStats=function(){var e=this.m;return{loadTimes:e.g,averageLoadTime:Th(e),started:e.h,playedCompletely:e.j,skipped:e.l,errors:e.i}},i.onManifestUpdated=function(e){this.h&&this.h.onManifestUpdated(e)},i.onDashTimedMetadata=function(e){this.g&&"urn:google:dai:2018"==e.schemeIdUri&&this.g.g.processMetadata(e.schemeIdUri,e.eventNode?e.eventNode.attributes.messageData:null,e.startTime)},i.onHlsTimedMetadata=function(e,t){this.g&&this.g.g.processMetadata("ID3",e.data,t)},i.onCueMetadataChange=function(e){this.g&&this.g.onCueMetadataChange(e)},i.onInterstitialMetadata=function(e,t,n){this.j||this.initInterstitial(null,e,t),this.j&&Ph(this.j,n)},K("shaka.ads.AdManager",op),op.prototype.onInterstitialMetadata=op.prototype.onInterstitialMetadata,op.prototype.onCueMetadataChange=op.prototype.onCueMetadataChange,op.prototype.onHlsTimedMetadata=op.prototype.onHlsTimedMetadata,op.prototype.onDashTimedMetadata=op.prototype.onDashTimedMetadata,op.prototype.onManifestUpdated=op.prototype.onManifestUpdated,op.prototype.getStats=op.prototype.getStats,op.prototype.getCuePoints=op.prototype.getCuePoints,op.prototype.getServerSideCuePoints=op.prototype.getServerSideCuePoints,op.prototype.replaceServerSideAdTagParameters=op.prototype.replaceServerSideAdTagParameters,op.prototype.requestServerSideStream=op.prototype.requestServerSideStream,op.prototype.initServerSide=op.prototype.initServerSide,op.prototype.addMediaTailorTrackingUrl=op.prototype.addMediaTailorTrackingUrl,op.prototype.requestMediaTailorStream=op.prototype.requestMediaTailorStream,op.prototype.initMediaTailor=op.prototype.initMediaTailor,op.prototype.updateClientSideAdsRenderingSettings=op.prototype.updateClientSideAdsRenderingSettings,op.prototype.requestClientSideAds=op.prototype.requestClientSideAds,op.prototype.onAssetUnload=op.prototype.onAssetUnload,op.prototype.release=op.prototype.release,op.prototype.initClientSide=op.prototype.initClientSide,op.prototype.initInterstitial=op.prototype.initInterstitial,op.prototype.configure=op.prototype.configure,op.prototype.setLocale=op.prototype.setLocale,op.ADS_LOADED="ads-loaded",op.AD_STARTED="ad-started",op.AD_FIRST_QUARTILE="ad-first-quartile",op.AD_MIDPOINT="ad-midpoint",op.AD_THIRD_QUARTILE="ad-third-quartile",op.AD_COMPLETE="ad-complete",op.AD_STOPPED="ad-stopped",op.AD_SKIPPED="ad-skipped",op.AD_VOLUME_CHANGED="ad-volume-changed",op.AD_MUTED="ad-muted",op.AD_PAUSED="ad-paused",op.AD_RESUMED="ad-resumed",op.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",op.CUEPOINTS_CHANGED="ad-cue-points-changed",op.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",op.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",op.AD_CLICKED="ad-clicked",op.AD_PROGRESS="ad-progress",op.AD_BUFFERING="ad-buffering",op.AD_IMPRESSION="ad-impression",op.AD_DURATION_CHANGED="ad-duration-changed",op.AD_CLOSED="ad-closed",op.AD_LOADED="ad-loaded",op.ALL_ADS_COMPLETED="all-ads-completed",op.AD_LINEAR_CHANGED="ad-linear-changed",op.AD_METADATA="ad-metadata",op.AD_RECOVERABLE_ERROR="ad-recoverable-error",op.AD_ERROR="ad-error",op.AD_BREAK_READY="ad-break-ready",op.AD_INTERACTION="ad-interaction",op.AD_CONTENT_PAUSE_REQUESTED="ad-content-pause-requested",op.AD_CONTENT_RESUME_REQUESTED="ad-content-resume-requested",op.AD_CONTENT_ATTACH_REQUESTED="ad-content-attach-requested",bh=function(){return new op};var dp="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),fp="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),hp=["loop","playbackRate"],pp=["pause","play"],gp={getAssetUri:2,getAudioLanguages:4,getAudioLanguagesAndRoles:4,getBufferFullness:1,getBufferedInfo:2,getExpiration:2,getKeyStatuses:2,getPlaybackRate:2,getTextLanguages:4,getTextLanguagesAndRoles:4,getImageTracks:2,getThumbnails:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,getLoadMode:10,getManifestType:10,isFullyLoaded:1},mp={getConfiguration:4,getStats:5,getTextTracks:2,getVariantTracks:2},vp={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20,getSegmentAvailabilityDuration:20},yp=[["getConfiguration","configure"]],_p=[["isTextTrackVisible","setTextTrackVisibility"]],bp="addChaptersTrack addTextTrackAsync addThumbnailsTrack cancelTrickPlay configure getChapters getChaptersTracks resetConfiguration retryStreaming selectAudioLanguage selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel setTextTrackVisibility trickPlay updateStartTime goToLive".split(" "),Ep=["attach","attachCanvas","detach","load","unload"];function Tp(e,t,n,i,r,a,o){var s=this;this.G=e,this.K=o,this.l=new Ft(t),this.L=n,this.s=!1,this.A=i,this.F=r,this.N=a,this.h=this.m=!1,this.I="",this.o=null,this.B=function(){return xp(s)},this.C=function(e,t){switch(e=up(t),e.type){case"event":var n=e.targetName,i=Fr(e.event);s.A(n,i);break;case"update":for(i in n=e.update,n)for(var r in e=s.g[i]||{},n[i])e[r]=n[i][r];s.s&&(s.L(),s.s=!1);break;case"asyncComplete":if(i=e.id,r=e.error,e=s.i[i],delete s.i[i],e)if(r){for(n in i=new Rt(r.severity,r.category,r.code),r)i[n]=r[n];e.reject(i)}else e.resolve()}},this.g={video:{},player:{}},this.H=0,this.i={},this.j=null,Pp.add(this)}function Sp(e){e.h&&chrome.cast.requestSession(function(t){return wp(e,t)},function(t){return Ap(e,t)})}function wp(e,t){var n=e.N();Mp=t,t.addUpdateListener(e.B),t.addMessageListener("urn:x-cast:com.google.shaka.v2",e.C),xp(e),Cp(e,{type:"init",initState:n,appData:e.o}),e.j.resolve()}function Ap(e,t){var n=8003;switch(t.code){case"cancel":n=8004;break;case"timeout":n=8005;break;case"receiver_unavailable":n=8006}e.j.reject(new Rt(2,8,n,t))}function Ip(e){var t=Mp;t.removeUpdateListener(e.B),t.removeMessageListener("urn:x-cast:com.google.shaka.v2",e.C)}function xp(e){var t=!!Mp&&"connected"==Mp.status;if(e.h&&!t){for(var n in e.F(),e.g)e.g[n]={};Rp(e)}e.h=t,e.I=t?Mp.receiver.friendlyName:"",e.l.xc()}function Rp(e){for(var t in e.i){var n=e.i[t];delete e.i[t],n.reject(new Rt(1,7,7e3))}}function Cp(e,t){t=lp(t);var n=Mp;try{n.sendMessage("urn:x-cast:com.google.shaka.v2",t,function(){},ee)}catch(i){throw t=new Rt(2,8,8005,i),n=new Or("error",(new Map).set("detail",t)),e.A("player",n),e.Fc(),t}}i=Tp.prototype,i.destroy=function(){return Pp.delete(this),Rp(this),Mp&&Ip(this),this.l&&(this.l.stop(),this.l=null),this.F=this.A=null,this.h=this.m=!1,this.C=this.B=this.j=this.i=this.g=this.o=null,Promise.resolve()},i.gb=function(){return this.h},i.Xf=function(){return this.I},i.init=function(){if(this.G.length)if(e.chrome&&chrome.cast&&chrome.cast.isAvailable){this.m=!0,this.l.xc();var t=new chrome.cast.SessionRequest(this.G,[],null,this.K,null);t=new chrome.cast.ApiConfig(t,function(e){for(var t=c(Pp),n=t.next();!n.done;n=t.next()){n=n.value;var i=e;n.j=new Rr,n.s=!0,wp(n,i)}},function(e){for(var t=c(Pp),n=t.next();!n.done;n=t.next())n=n.value,kp="available"==e,n.l.xc()},"origin_scoped"),chrome.cast.initialize(t,function(){},function(){}),kp&&this.l.Y(Dp),(t=Mp)&&t.status!=chrome.cast.SessionStatus.STOPPED?(this.j=new Rr,this.s=!0,wp(this,t)):Mp=null}else e.__onGCastApiAvailable!==Np&&(Lp=e.__onGCastApiAvailable||null,e.__onGCastApiAvailable=Np)},i.dg=function(e){this.o=e,this.h&&Cp(this,{type:"appData",appData:this.o})},i.cast=function(){var e=this;return O(function(t){if(!e.m)throw new Rt(1,8,8e3);if(!kp)throw new Rt(1,8,8001);if(e.h)throw new Rt(1,8,8002);return e.j=new Rr,chrome.cast.requestSession(function(t){return wp(e,t)},function(t){return Ap(e,t)}),T(t,e.j,0)})},i.Fc=function(){if(this.h){if(Rp(this),Mp){Ip(this);try{Mp.stop(function(){},function(){})}catch(e){}Mp=null}xp(this)}},i.get=function(e,t){var n=this;if("video"==e){if(pp.includes(t))return function(){return n.eh.apply(n,[e,t].concat(d(F.apply(0,arguments))))}}else if("player"==e){if(vp[t]&&!this.get("player","isLive")())return function(){};if(bp.includes(t))return function(){return n.eh.apply(n,[e,t].concat(d(F.apply(0,arguments))))};if(Ep.includes(t))return function(){return n.Ri.apply(n,[e,t].concat(d(F.apply(0,arguments))))};if(gp[t]||mp[t])return function(){return n.g[e][t]}}return this.g[e][t]},i.set=function(e,t,n){this.g[e][t]=n,Cp(this,{type:"set",targetName:e,property:t,value:n})},i.eh=function(e,t){Cp(this,{type:"call",targetName:e,methodName:t,args:F.apply(2,arguments)})},i.Ri=function(e,t){var n=F.apply(2,arguments),i=new Rr,r=this.H.toString();this.H++,this.i[r]=i;try{Cp(this,{type:"asyncCall",targetName:e,methodName:t,args:n,id:r})}catch(e){i.reject(e)}return i};var Dp=.02,kp=!1,Mp=null,Lp=null,Pp=new Set;function Np(t){if(Lp?e.__onGCastApiAvailable=Lp:delete e.__onGCastApiAvailable,Lp=null,t)for(var n=c(Pp),i=n.next();!i.done;i=n.next())i.value.init();"function"===typeof e.__onGCastApiAvailable&&e.__onGCastApiAvailable(t)}function Op(e,t,n,i){i=void 0!==i&&i,Br.call(this);var r=this;this.i=e,this.h=t,this.m=this.o=this.j=this.s=this.l=null,this.C=n,this.B=i,this.A=new Map,this.g=new Tp(n,function(){return jp(r)},function(){return Vp(r)},function(e,t){return Zp(r,e,t)},function(){return Hp(r)},function(){return Gp(r)},i),Fp(this)}function Fp(e){e.g.init(),e.m=new ae;for(var t=c(dp),n=t.next();!n.done;n=t.next())e.m.D(e.i,n.value,function(t){e.g.gb()||(t=Fr(t),e.j.dispatchEvent(t))});for(var i in Ur)e.m.D(e.h,Ur[i],function(t){e.g.gb()||e.o.dispatchEvent(t)});for(var r in e.l={},t={},e.i)t.$c=r,Object.defineProperty(e.l,t.$c,{configurable:!1,enumerable:!0,get:function(t){return function(){return Kp(e,t.$c)}}(t),set:function(t){return function(n){var i=t.$c;e.g.gb()?e.g.set("video",i,n):e.i[i]=n}}(t)}),t={$c:t.$c};e.s={},Bp(e,function(t){Object.defineProperty(e.s,t,{configurable:!1,enumerable:!0,get:function(){return zp(e,t)}})}),Up(e),e.j=new Br,e.j.Ge=e.l,e.o=new Br,e.o.Ge=e.s}function Up(e){var t=new Map;Bp(e,function(n,i){t.has(i)?(i=t.get(i),n.length<i.length?e.A.set(n,i):e.A.set(i,n)):t.set(i,n)})}function Bp(e,t){function n(e){return"constructor"!=e&&"function"==typeof r[e]&&!a.has(e)}var i,r=e.h,a=new Set;for(i in r)n(i)&&(a.add(i),t(i,r[i]));for(e=Object.getPrototypeOf(r),i=Object.getPrototypeOf({});e&&e!=i;){for(var o=c(Object.getOwnPropertyNames(e)),s=o.next();!s.done;s=o.next())s=s.value,n(s)&&(a.add(s),t(s,r[s]));e=Object.getPrototypeOf(e)}}function Gp(e){var t={video:{},player:{},playerAfterLoad:{},manifest:e.h.Gc(),startTime:null};e.i.pause();for(var n=c(hp),i=n.next();!i.done;i=n.next())i=i.value,t.video[i]=e.i[i];for(e.i.ended||(t.startTime=e.i.currentTime),n=c(yp),i=n.next();!i.done;i=n.next()){var r=i.value;i=r[1],r=e.h[r[0]](),t.player[i]=r}for(n=c(_p),i=n.next();!i.done;i=n.next())r=i.value,i=r[1],r=e.h[r[0]](),t.playerAfterLoad[i]=r;return t}function jp(e){var t=new Or("caststatuschanged");e.dispatchEvent(t)}function Vp(e){var t=new Or(e.l.paused?"pause":"play");e.j.dispatchEvent(t)}function Hp(e){for(var t=c(yp),n=t.next();!n.done;n=t.next()){var i=n.value;n=i[1],i=e.g.get("player",i[0])(),e.h[n](i)}var r=e.g.get("player","getAssetUri")();i=e.g.get("video","ended"),t=Promise.resolve();var a,o=e.i.autoplay;n=null,i||(n=e.g.get("video","currentTime")),(i=e.g.get("player","getTextTracks")())&&i.length&&(a=i.find(function(e){return e.active}));var s=e.g.get("player","isTextTrackVisible")();r&&(e.i.autoplay=!1,t=e.h.load(r,n));var l={};for(n=c(hp),i=n.next();!i.done;i=n.next())i=i.value,l[i]=e.g.get("video",i);t.then(function(){if(e.i){for(var t=c(hp),n=t.next();!n.done;n=t.next())n=n.value,e.i[n]=l[n];for(t=c(_p),n=t.next();!n.done;n=t.next()){var i=n.value;n=i[1],i=e.g.get("player",i[0])(),e.h[n](i)}e.h.nh(s),a&&e.h.bg(a.language,a.roles,a.forced),e.i.autoplay=o,r&&e.i.play()}},function(t){t=(new Map).set("detail",t),t=new Or("error",t),e.h.dispatchEvent(t)})}function Kp(e,t){if("addEventListener"==t)return function(t,n,i){return e.j.addEventListener(t,n,i)};if("removeEventListener"==t)return function(t,n,i){return e.j.removeEventListener(t,n,i)};if(e.g.gb()&&0==Object.keys(e.g.g.video).length){var n=e.i[t];if("function"!=typeof n)return n}return e.g.gb()?e.g.get("video",t):(t=e.i[t],"function"==typeof t&&(t=t.bind(e.i)),t)}function zp(e,t){if(e.A.has(t)&&(t=e.A.get(t)),"addEventListener"==t)return function(t,n,i){return e.o.addEventListener(t,n,i)};if("removeEventListener"==t)return function(t,n,i){return e.o.removeEventListener(t,n,i)};if("getMediaElement"==t)return function(){return e.l};if("getSharedConfiguration"==t)return e.g.get("player","getConfiguration");if("getNetworkingEngine"==t)return function(){return e.h.zb()};if("getDrmEngine"==t)return function(){return e.h.B};if("getAdManager"==t)return function(){return e.h.Ig()};if("setVideoContainer"==t)return function(t){return e.h.rh(t)};if(e.g.gb()){if("getManifest"==t||"drmInfo"==t)return function(){return Q(t+"() does not work while casting!"),null};if("attach"==t||"detach"==t)return function(){return Q(t+"() does not work while casting!"),Promise.resolve()}}return e.g.gb()&&0==Object.keys(e.g.g.video).length&&(gp[t]||mp[t])||!e.g.gb()?e.h[t].bind(e.h):e.g.get("player",t)}function Zp(e,t,n){e.g.gb()&&("video"==t?e.j.dispatchEvent(n):"player"==t&&e.o.dispatchEvent(n))}function qp(e,t,n,i){Br.call(this);var r=this;this.g=e,this.h=t,this.j=new ae,this.H={video:e,player:t},this.F=n||function(){},this.I=i||function(e){return e},this.i=null,this.G=!1,this.o=!0,this.m=0,this.B=!1,this.A=!0,this.s=this.l=null,this.C=new Ft(function(){Jp(r)}),Yp(this)}function Yp(e){var t=cast.receiver.CastReceiverManager.getInstance();t.onSenderConnected=function(){return Wp(e)},t.onSenderDisconnected=function(){return Wp(e)},t.onSystemVolumeChanged=function(){var t=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();t&&ag(e,{type:"update",update:{video:{volume:t.level,muted:t.muted}}},e.l),ag(e,{type:"event",targetName:"video",event:{type:"volumechange"}},e.l)},e.s=t.getCastMessageBus("urn:x-cast:com.google.cast.media"),e.s.onMessage=function(t){return ig(e,t)},e.l=t.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),e.l.onMessage=function(t){return ng(e,t)},t.start(),t=c(dp);for(var n=t.next();!n.done;n=t.next())e.j.D(e.g,n.value,function(t){return Qp(e,"video",t)});for(var i in Ur)e.j.D(e.h,Ur[i],function(t){return Qp(e,"player",t)});e.j.D(e.g,"loadeddata",function(){e.B=!0}),e.j.D(e.h,"loading",function(){e.o=!1,$p(e)}),e.j.D(e.g,"playing",function(){e.o=!1,$p(e)}),e.j.D(e.g,"pause",function(){$p(e)}),e.j.D(e.h,"unloading",function(){e.o=!0,$p(e)}),e.j.D(e.g,"ended",function(){new Ft(function(){e.g&&e.g.ended&&(e.o=!0,$p(e))}).Y(lg)})}function Wp(e){e.m=0,e.A=!0,e.G=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length,$p(e)}function $p(e){var t;O(function(n){return 1==n.g?T(n,Promise.resolve(),2):e.h?(t=new Or("caststatuschanged"),e.dispatchEvent(t),eg(e)||og(e),void S(n)):n.return()})}function Xp(e,t,n){var i,r,a,o,s,l,u,c,d,f;O(function(h){switch(h.g){case 1:for(i in t.player)r=t.player[i],e.h[i](r);return e.F(n),a=e.g.autoplay,t.manifest?(e.g.autoplay=!1,w(h,5),T(h,e.h.load(t.manifest,t.startTime),7)):T(h,Promise.resolve(),3);case 7:I(h,3);break;case 5:return o=x(h),s=(new Map).set("detail",o),l=new Or("error",s),e.h&&e.h.dispatchEvent(l),h.return();case 3:if(!e.h)return h.return();for(u in t.video)c=t.video[u],e.g[u]=c;for(d in t.playerAfterLoad)f=t.playerAfterLoad[d],e.h[d](f);e.g.autoplay=a,t.manifest&&(e.g.play(),og(e)),S(h)}})}function Qp(e,t,n){e.h&&(Jp(e),ag(e,{type:"event",targetName:t,event:n},e.l))}function Jp(e){e.C.Y(sg);for(var t={video:{},player:{}},n=c(fp),i=n.next();!i.done;i=n.next())i=i.value,t.video[i]=e.g[i];if(e.h.V())for(var r in vp)0==e.m%vp[r]&&(t.player[r]=e.h[r]());for(var a in gp)0==e.m%gp[a]&&(t.player[a]=e.h[a]());for(var o in(n=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(t.video.volume=n.level,t.video.muted=n.muted),ag(e,{type:"update",update:t},e.l),mp)0==e.m%mp[o]&&(t={player:{}},t.player[o]=e.h[o](),ag(e,{type:"update",update:t},e.l));e.B&&(e.m+=1),eg(e)}function eg(e){return!(!e.A||!e.g.duration&&!e.h.V())&&(tg(e),e.A=!1,!0)}function tg(e,t){var n={contentId:e.h.Gc(),streamType:e.h.V()?"LIVE":"BUFFERED",contentType:""};e.h.V()||(n.duration=e.g.duration),e.i&&(n.metadata=e.i),og(e,void 0===t?0:t,n)}function ng(e,t){var n=up(t.data);switch(n.type){case"init":e.m=0,e.B=!1,e.A=!0,Xp(e,n.initState,n.appData),Jp(e);break;case"appData":e.F(n.appData);break;case"set":var i=n.targetName,r=n.property;if(n=n.value,"video"==i){if(t=cast.receiver.CastReceiverManager.getInstance(),"volume"==r){t.setSystemVolumeLevel(n);break}if("muted"==r){t.setSystemVolumeMuted(n);break}}e.H[i][r]=n;break;case"call":i=e.H[n.targetName],i[n.methodName].apply(i,n.args);break;case"asyncCall":i=n.targetName,r=n.methodName,"player"==i&&"load"==r&&(e.m=0,e.B=!1);var a=n.id,o=t.senderId;t=e.H[i],n=t[r].apply(t,n.args),"player"==i&&"load"==r&&(n=n.then(function(){e.A=!0})),n.then(function(){return rg(e,o,a,null)},function(t){return rg(e,o,a,t)})}}function ig(e,t){var n=up(t.data);switch(n.type){case"PLAY":e.g.play(),og(e);break;case"PAUSE":e.g.pause(),og(e);break;case"SEEK":t=n.currentTime;var i=n.resumeState;null!=t&&(e.g.currentTime=Number(t)),i&&"PLAYBACK_START"==i?(e.g.play(),og(e)):i&&"PLAYBACK_PAUSE"==i&&(e.g.pause(),og(e));break;case"STOP":e.h.dc().then(function(){e.h&&og(e)});break;case"GET_STATUS":tg(e,Number(n.requestId));break;case"VOLUME":i=n.volume,t=i.level,i=i.muted;var r=e.g.volume,a=e.g.muted;null!=t&&(e.g.volume=Number(t)),null!=i&&(e.g.muted=i),r==e.g.volume&&a==e.g.muted||og(e);break;case"LOAD":e.m=0,e.B=!1,e.A=!1,t=n.media,i=n.currentTime,r=e.I(t.contentId),a=n.autoplay||!0,e.F(t.customData),a&&(e.g.autoplay=!0),e.h.load(r,i).then(function(){e.h&&tg(e)}).catch(function(t){var i="LOAD_FAILED";7==t.category&&7e3==t.code&&(i="LOAD_CANCELLED"),ag(e,{requestId:Number(n.requestId),type:i},e.s)});break;default:ag(e,{requestId:Number(n.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},e.s)}}function rg(e,t,n,i){e.h&&ag(e,{type:"asyncComplete",id:n,error:i},e.l,t)}function ag(e,t,n,i){e.G&&(e=lp(t),i?n.getCastChannel(i).send(e):n.broadcast(e))}function og(e,t,n){n=void 0===n?null:n;var i={mediaSessionId:0,playbackRate:e.g.playbackRate,playerState:e.o?ug:e.h.Jf()?dg:e.g.paused?fg:cg,currentTime:e.g.currentTime,supportedMediaCommands:63,volume:{level:e.g.volume,muted:e.g.muted}};n&&(i.media=n),ag(e,{requestId:void 0===t?0:t,type:"MEDIA_STATUS",status:[i]},e.s)}y(Op,Br),i=Op.prototype,i.destroy=function(e){return e&&this.g.Fc(),this.m&&(this.m.release(),this.m=null),e=[],this.h&&(e.push(this.h.destroy()),this.h=null),this.g&&(e.push(this.g.destroy()),this.g=null),this.s=this.l=this.i=null,Br.prototype.release.call(this),Promise.all(e)},i.mi=function(){return this.l},i.bi=function(){return this.s},i.Hh=function(){return this.g.m&&kp},i.gb=function(){return this.g.gb()},i.Xf=function(){return this.g.Xf()},i.cast=function(){var e=this;return O(function(t){return 1==t.g?T(t,e.g.cast(),2):e.h?T(t,e.h.dc(),0):t.return()})},i.dg=function(e){this.g.dg(e)},i.gj=function(){Sp(this.g)},i.Fc=function(){this.g.Fc()},i.Ih=function(e,t){t=void 0!==t&&t;var n=this;return O(function(i){if(1==i.g)return e==n.C&&t==n.B?i.return():(n.C=e,n.B=t,n.g.Fc(),T(i,n.g.destroy(),2));n.g=null,n.g=new Tp(e,function(){return jp(n)},function(){return Vp(n)},function(e,t){return Zp(n,e,t)},function(){return Hp(n)},function(){return Gp(n)},t),n.g.init(),S(i)})},K("shaka.cast.CastProxy",Op),Op.prototype.changeReceiverId=Op.prototype.Ih,Op.prototype.forceDisconnect=Op.prototype.Fc,Op.prototype.suggestDisconnect=Op.prototype.gj,Op.prototype.setAppData=Op.prototype.dg,Op.prototype.cast=Op.prototype.cast,Op.prototype.receiverName=Op.prototype.Xf,Op.prototype.isCasting=Op.prototype.gb,Op.prototype.canCast=Op.prototype.Hh,Op.prototype.getPlayer=Op.prototype.bi,Op.prototype.getVideo=Op.prototype.mi,Op.prototype.destroy=Op.prototype.destroy,y(qp,Br),i=qp.prototype,i.isConnected=function(){return this.G},i.ui=function(){return this.o},i.cj=function(e){this.i=e},i.Kh=function(){this.i=null},i.dj=function(e){this.i||(this.i={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.i.title=e},i.bj=function(e){this.i||(this.i={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.i.images=[{url:e}]},i.aj=function(e){this.i||(this.i={}),this.i.artist=e,this.i.metadataType=cast.receiver.media.MetadataType.MUSIC_TRACK},i.destroy=function(){var e,t,n=this;return O(function(i){if(1==i.g)return n.j&&(n.j.release(),n.j=null),e=[],n.h&&(e.push(n.h.destroy()),n.h=null),n.C&&(n.C.stop(),n.C=null),n.g=null,n.H=null,n.F=null,n.G=!1,n.o=!0,n.l=null,n.s=null,Br.prototype.release.call(n),T(i,Promise.all(e),2);t=cast.receiver.CastReceiverManager.getInstance(),t.stop(),S(i)})},K("shaka.cast.CastReceiver",qp),qp.prototype.destroy=qp.prototype.destroy,qp.prototype.setContentArtist=qp.prototype.aj,qp.prototype.setContentImage=qp.prototype.bj,qp.prototype.setContentTitle=qp.prototype.dj,qp.prototype.clearContentMetadata=qp.prototype.Kh,qp.prototype.setContentMetadata=qp.prototype.cj,qp.prototype.isIdle=qp.prototype.ui,qp.prototype.isConnected=qp.prototype.isConnected;var sg=.5,lg=5,ug="IDLE",cg="PLAYING",dg="BUFFERING",fg="PAUSED";function hg(e,t,n,i,r){if(i>=r)return null;for(var a=-1,o=-1,s=0;s<n.length;s++)if(n[s].some(function(e){return null!=e&&""!=e.g.trim()})){a=s;break}for(s=n.length-1;0<=s;s--)if(n[s].some(function(e){return null!=e&&""!=e.g.trim()})){o=s;break}if(-1===a||-1===o)return null;for(var l=s=!1,u="white",c="black",d=pg(i,r,s,l,u,c);a<=o;a++){for(var f=n[a],h=-1,p=-1,g=0;g<f.length;g++)if(null!=f[g]&&""!==f[g].g.trim()){h=g;break}for(g=f.length-1;0<=g;g--)if(null!=f[g]&&""!==f[g].g.trim()){p=g;break}if(-1===h||-1===p)f=gg(i,r),e.nestedCues.push(f);else{for(;h<=p;h++)if(g=f[h]){var m=g.l,v=g.i,y=g.j,_=g.h;m==s&&v==l&&y==u&&_==c||(d.payload&&e.nestedCues.push(d),d=pg(i,r,m,v,y,_),s=m,l=v,u=y,c=_),d.payload+=g.g}else d.payload+=" ";d.payload&&e.nestedCues.push(d),a!==o&&(d=gg(i,r),e.nestedCues.push(d)),d=pg(i,r,s,l,u,c)}}return e.nestedCues.length?{cue:e,stream:t}:null}function pg(e,t,n,i,r,a){return e=new Be(e,t,""),n&&e.textDecoration.push("underline"),i&&(e.fontStyle="italic"),e.color=r,e.backgroundColor=a,e}function gg(e,t){return e=new Be(e,t,""),e.lineBreak=!0,e}function mg(e,t,n,i,r){this.g=e,this.l=t,this.i=n,this.h=i,this.j=r}function vg(e,t){this.i=[],this.g=1,this.h=0,this.A=e,this.s=t,this.j=this.m=!1,this.l="white",this.o="black",_g(this)}function yg(e,t,n){var i="CC"+(1+(e.A<<1|e.s)),r=new Be(t,n,"");r.lineInterpretation=1;var a=kg.get(e.g);return a&&(r.line=a),(t=hg(r,i,e.i,t,n))&&15<e.g+t.cue.nestedCues.length-3&&(a=kg.get(e.g+3-t.cue.nestedCues.length))&&(r.line=a),t}function _g(e){Tg(e,0,15),e.g=1}function bg(e,t,n){if(!(32>n||127<n)){var i="";switch(t){case Sg:i=xg.has(n)?xg.get(n):String.fromCharCode(n);break;case wg:i=Rg.get(n);break;case Ag:e.i[e.g].pop(),i=Cg.get(n);break;case Ig:e.i[e.g].pop(),i=Dg.get(n)}i&&e.i[e.g].push(new mg(i,e.m,e.j,e.o,e.l))}}function Eg(e,t,n,i){if(!(0>n||0>t))if(t>=n)for(--i;0<=i;i--)e.i[t+i]=e.i[n+i].map(function(e){return e});else for(var r=0;r<i;r++)e.i[t+r]=e.i[n+r].map(function(e){return e})}function Tg(e,t,n){for(var i=0;i<=n;i++)e.i[t+i]=[]}var Sg=0,wg=1,Ag=2,Ig=3,xg=new Map([[39,""],[42,""],[92,""],[92,""],[94,""],[95,""],[96,""],[123,""],[124,""],[125,""],[126,""],[127,""]]),Rg=new Map([[48,""],[49,""],[50,""],[51,""],[52,""],[53,""],[54,""],[55,""],[56,""],[57," "],[58,""],[59,""],[60,""],[61,""],[62,""],[63,""]]),Cg=new Map([[32,""],[33,""],[34,""],[35,""],[36,""],[37,""],[38,""],[39,""],[40,"*"],[41,"'"],[42,""],[43,""],[44,""],[45,""],[46,""],[47,""],[48,""],[49,""],[50,""],[51,""],[52,""],[53,""],[54,""],[55,""],[56,""],[57,""],[58,""],[59,""],[60,""],[61,""],[62,""],[63,""]]),Dg=new Map([[32,""],[33,""],[34,""],[35,""],[36,""],[37,""],[38,""],[39,""],[40,""],[41,"{"],[42,"}"],[43,"\\"],[44,"^"],[45,"_"],[46,"|"],[47,"~"],[48,""],[49,""],[50,""],[51,""],[52,""],[53,""],[54,""],[55,""],[56,""],[57,""],[58,""],[59,""],[60,""],[61,""],[62,""],[63,""]]),kg=new Map([[1,10],[2,15.33],[3,20.66],[4,26],[5,31.33],[6,36.66],[7,42],[8,47.33],[9,52.66],[10,58],[11,63.33],[12,68.66],[13,74],[14,79.33],[15,84.66]]);function Mg(e,t){this.h=Og,this.o=new vg(e,t),this.i=new vg(e,t),this.g=this.j=new vg(e,t),this.l=0,this.m=null}function Lg(e,t,n){e.g=e.i;var i=e.g,r=null;return e.h!==Ug&&e.h!==Bg&&(r=yg(i,e.l,n),n=e.i,n.g=0<n.h?n.h:0,Tg(n,0,15),n=e.j,n.g=0<n.h?n.h:0,Tg(n,0,15),i.g=15),e.h=Ug,i.h=t,r}function Pg(e){e.h=Fg,e.g=e.j,e.g.h=0}function Ng(e){J("Cea608DataChannel","CEA-608 text mode entered, but is unsupported"),e.g=e.o,e.h=Bg}var Og=0,Fg=1,Ug=3,Bg=4,Gg="black green blue cyan red yellow magenta black".split(" "),jg="white green blue cyan red yellow magenta white_italics".split(" ");function Vg(e,t){this.I=t,this.N=e,this.K=this.l=!1,this.m=this.o=this.G=this.L=this.H=0,this.F=$g,this.i=[],this.g=this.h=this.j=0,this.C=this.A=!1,this.B="white",this.s="black",Hg(this)}function Hg(e){e.i=[];for(var t=0;16>t;t++)e.i.push(Kg())}function Kg(){for(var e=[],t=0;42>t;t++)e.push(null);return e}function zg(e,t){Zg(e)&&(e.i[e.h][e.g]=new mg(t,e.C,e.A,e.s,e.B),e.g++)}function Zg(e){var t=e.g<e.m&&0<=e.g;return e.h<e.o&&0<=e.h&&t}function qg(e,t,n){var i=new Be(e.j,t,"");i.textAlign=e.F===Yg?"left":e.F===Wg?"right":He;var r=i.region;switch(e.I&&(r.id+="svc"+e.I),r.id+="win"+e.N,r.height=e.o,r.width=e.m,r.heightUnits=2,r.widthUnits=2,r.viewportAnchorX=e.H,r.viewportAnchorY=e.L,r.viewportAnchorUnits=e.K?Le:2,e.G){case Xg:r.regionAnchorX=0,r.regionAnchorY=0;break;case Qg:r.regionAnchorX=50,r.regionAnchorY=0;break;case Jg:r.regionAnchorX=100,r.regionAnchorY=0;break;case em:r.regionAnchorX=0,r.regionAnchorY=50;break;case tm:r.regionAnchorX=50,r.regionAnchorY=50;break;case nm:r.regionAnchorX=100,r.regionAnchorY=50;break;case im:r.regionAnchorX=0,r.regionAnchorY=100;break;case rm:r.regionAnchorX=50,r.regionAnchorY=100;break;case am:r.regionAnchorX=100,r.regionAnchorY=100}return(n=hg(i,"svc"+n,e.i,e.j,t))&&(e.j=t),n}Vg.prototype.isVisible=function(){return this.l};var Yg=0,Wg=1,$g=2,Xg=0,Qg=1,Jg=2,em=3,tm=4,nm=5,im=6,rm=7,am=8;function om(){this.i=[],this.h=null,this.g=0}function sm(e,t){3===t.type?(e.g=2*(63&t.value)-1,e.h=[]):e.h&&(0<e.g&&(e.h.push(t),e.g--),0===e.g&&(e.i.push(new lm(e.h)),e.h=null,e.g=0))}function lm(e){this.g=0,this.h=e}function um(e){if(!e.oa())throw new Rt(2,2,3e3);return e.h[e.g++]}function cm(e){this.i=e,this.h=[null,null,null,null,null,null,null,null],this.g=null}function dm(e,t,n,i){if(128<=n&&135>=n)i=7&n,e.h[i]&&(e.g=e.h[i]);else{if(136===n){n=um(t).value,t=null,n=c(fm(e,n));for(var r=n.next();!r.done;r=n.next())r=e.h[r.value],r.isVisible()&&(t=qg(r,i,e.i)),Hg(r);return t}if(137===n)for(t=um(t).value,t=c(fm(e,t)),n=t.next();!n.done;n=t.next())n=e.h[n.value],n.isVisible()||(n.j=i),n.l=!0;else{if(138===n){for(n=um(t).value,t=null,n=c(fm(e,n)),r=n.next();!r.done;r=n.next())r=e.h[r.value],r.isVisible()&&(t=qg(r,i,e.i)),r.l=!1;return t}if(139===n){for(n=um(t).value,t=null,n=c(fm(e,n)),r=n.next();!r.done;r=n.next())r=e.h[r.value],r.isVisible()?t=qg(r,i,e.i):r.j=i,r.l=!r.l;return t}if(140===n)return t=um(t).value,hm(e,t,i);if(143===n)return i=hm(e,255,i),pm(e),i;if(144===n)t.skip(1),i=um(t).value,e.g&&(e.g.A=0<(128&i),e.g.C=0<(64&i));else if(145===n)i=um(t).value,n=um(t).value,t.skip(1),e.g&&(t=gm((48&n)>>4,(12&n)>>2,3&n),e.g.B=gm((48&i)>>4,(12&i)>>2,3&i),e.g.s=t);else if(146===n)i=um(t).value,t=um(t).value,e.g&&(e=e.g,e.h=15&i,e.g=63&t);else if(151===n)t.skip(1),t.skip(1),i=um(t).value,t.skip(1),e.g&&(e.g.F=3&i);else if(152<=n&&159>=n){if(n=(15&n)-8,r=null!==e.h[n],!r){var a=new Vg(n,e.i);a.j=i,e.h[n]=a}i=um(t).value,a=um(t).value;var o=um(t).value,s=um(t).value,l=um(t).value;t=um(t).value,r&&0===(7&t)||(t=e.h[n],t.h=0,t.g=0,t.C=!1,t.A=!1,t.B="white",t.s="black"),t=e.h[n],t.l=0<(32&i),t.L=127&a,t.H=o,t.G=(240&s)>>4,t.K=0<(128&a),t.o=1+(15&s),t.m=1+(63&l),e.g=e.h[n]}}}return null}function fm(e,t){for(var n=[],i=0;8>i;i++)1===(1&t)&&e.h[i]&&n.push(i),t>>=1;return n}function hm(e,t,n){var i=null;t=c(fm(e,t));for(var r=t.next();!r.done;r=t.next()){r=r.value;var a=e.h[r];a.isVisible()&&(i=qg(a,n,e.i)),e.h[r]=null}return i}function pm(e){e.g=null,e.h=[null,null,null,null,null,null,null,null]}function gm(e,t,n){var i={0:0,1:0,2:1,3:1};return e=i[e],t=i[t],n=i[n],vm[e<<2|t<<1|n]}lm.prototype.oa=function(){return this.g<this.h.length},lm.prototype.ua=function(){return this.g},lm.prototype.skip=function(e){if(this.g+e>this.h.length)throw new Rt(2,2,3e3);this.g+=e};var mm=new Map([[32," "],[33,""],[37,""],[42,""],[44,""],[48,""],[49,""],[50,""],[51,""],[52,""],[53,""],[57,""],[58,""],[60,""],[61,""],[63,""],[118,""],[119,""],[120,""],[121,""],[122,""],[123,""],[124,""],[125,""],[126,""],[127,""]]),vm="black blue green cyan red magenta yellow white".split(" ");function ym(){this.h=[],this.g=[],this.i=new om,this.l=0,this.m=new Map([["CC1",new Mg(0,0)],["CC2",new Mg(0,1)],["CC3",new Mg(1,0)],["CC4",new Mg(1,1)]]),this.s=this.o=0,this.j=new Map,this.B=!0,this.A=new Set,_m(this)}function _m(e){e.o=0,e.s=0;for(var t=c(e.m.values()),n=t.next();!n.done;n=t.next())n=n.value,n.h=Og,n.g=n.j,n.m=null,_g(n.i),_g(n.j),_g(n.o);e.B=!0}function bm(e,t){var n=t.type;if(16===(112&t.cb)){var i=t.cb>>3&1;0===n?e.o=i:e.s=i}if(i="CC"+(1+(n<<1|(n?e.s:e.o))),n=e.m.get(i),255===t.cb&&255===t.Eb||!t.cb&&!t.Eb||!Tm(t.cb)||!Tm(t.Eb))return 45<=++e.l&&_m(e),null;e.l=0,t.cb&=127,t.Eb&=127;var r=t.cb;if(1<=r&&15>=r||!t.cb&&!t.Eb)return null;if(r=null,16===(112&t.cb))e:{if(e.A.add(i),i=t.cb,e=t.Eb,n.m===(i<<8|e))n.m=null;else if(n.m=i<<8|e,16===(240&i)&&64===(192&e)){t=[11,11,1,2,3,4,12,13,14,15,5,6,7,8,9,10][(7&i)<<1|e>>5&1];var a=(30&e)>>1;i="white",r=!1,7>a?i=jg[a]:7===a&&(r=!0),e=1===(1&e),n.h!==Bg&&(a=n.g,n.h===Ug&&t!==a.g&&(n=1+t-a.h,Eg(a,n,1+a.g-a.h,a.h),Tg(a,0,n-1),Tg(a,t+1,15-t)),a.g=t,a.m=e,a.j=r,a.l=i,a.o="black")}else if(17===(247&i)&&32===(240&e))n.g.m=!1,n.g.j=!1,n.g.l="white",bg(n.g,Sg,32),i=!1,t=jg[(14&e)>>1],"white_italics"===t&&(t="white",i=!0),n.g.m=1===(1&e),n.g.j=i,n.g.l=t;else if(16===(247&i)&&32===(240&e)||23===(247&i)&&45===(255&e))t="black",0===(7&i)&&(t=Gg[(14&e)>>1]),n.g.o=t;else if(17===(247&i)&&48===(240&e))bg(n.g,wg,e);else if(18===(246&i)&&32===(224&e))bg(n.g,1&i?Ig:Ag,e);else if(20===(246&i)&&32===(240&e)){switch(e=t.pts,i=null,t.Eb){case 32:Pg(n);break;case 33:n=n.g,n.i[n.g].pop();break;case 37:i=Lg(n,2,e);break;case 38:i=Lg(n,3,e);break;case 39:i=Lg(n,4,e);break;case 40:bg(n.g,Sg,32);break;case 41:n.h=2,n.g=n.i,n.g.h=0,n.l=e;break;case 42:_g(n.o),Ng(n);break;case 43:Ng(n);break;case 44:t=n.i,i=null,n.h!==Bg&&(i=yg(t,n.l,e)),Tg(t,0,15);break;case 45:t=n.g,n.h!==Ug?i=null:(i=yg(t,n.l,e),r=t.g-t.h+1,Eg(t,r-1,r,t.h),Tg(t,0,r-1),Tg(t,t.g,15-t.g),n.l=e);break;case 46:Tg(n.j,0,15);break;case 47:t=null,n.h!==Bg&&(t=yg(n.i,n.l,e)),i=n.j,n.j=n.i,n.i=i,Pg(n),n.l=e,i=t}r=i;break e}r=null}else e=t.Eb,bg(n.g,Sg,t.cb),bg(n.g,Sg,e);return r}function Em(e,t){var n=[];try{for(;t.oa();){var i=um(t).value,r=(224&i)>>5,a=31&i;if(7===r&&0!=a&&(r=63&um(t).value),0!=r){e.A.add("svc"+r),e.j.has(r)||e.j.set(r,new cm(r));for(var o=e.j.get(r),s=t.ua();t.ua()-s<a;){r=t;var l=um(r),u=l.value,c=l.pts;if(16===u){var d=um(r);u=u<<16|d.value}if(0<=u&&31>=u){var f=c;if(o.g){var h=o.g;switch(r=null,u){case 8:!Zg(h)||0>=h.g&&0>=h.h||(0>=h.g?(h.g=h.m-1,h.h--):h.g--,h.i[h.h][h.g]=null);break;case 13:if(h.isVisible()&&(r=qg(h,f,o.i)),h.h+1>=h.o){f=h;for(var p=0,g=1;16>g;g++,p++)f.i[p]=f.i[g];for(g=0;1>g;g++,p++)f.i[p]=Kg()}else h.h++;h.g=0;break;case 14:h.isVisible()&&(r=qg(h,f,o.i)),h.i[h.h]=Kg(),h.g=0;break;case 12:h.isVisible()&&(r=qg(h,f,o.i)),Hg(h),f=h,f.h=0,f.g=0}var m=r}else m=null}else if(128<=u&&159>=u)m=dm(o,r,u,c);else{if(4096<=u&&4127>=u)f=255&u,8<=f&&15>=f?r.skip(1):16<=f&&23>=f?r.skip(2):24<=f&&31>=f&&r.skip(3);else if(4224<=u&&4255>=u)f=255&u,128<=f&&135>=f?r.skip(4):136<=f&&143>=f&&r.skip(5);else if(32<=u&&127>=u)r=u,o.g&&zg(o.g,127===r?"":String.fromCharCode(r));else if(160<=u&&255>=u)o.g&&zg(o.g,String.fromCharCode(u));else if(4128<=u&&4223>=u){if(r=255&u,o.g)if(mm.has(r)){var v=mm.get(r);zg(o.g,v)}else zg(o.g,"_")}else 4256<=u&&4351>=u&&o.g&&zg(o.g,160!=(255&u)?"_":"[CC]");m=null}(r=m)&&n.push(r)}}}}catch(e){if(!(e instanceof Rt&&3e3===e.code))throw e;J("CEA708_INVALID_DATA","Buffer read out of bounds / invalid CEA-708 Data.")}return n}function Tm(e){for(var t=0;e;)t^=1&e,e>>=1;return 1===t}function Sm(e){for(var t=[],n=e,i=e=0;i<n.length;)2==e&&3==n[i]?(e=0,n=[].concat(d(n)),n.splice(i,1),n=new Uint8Array(n)):0==n[i]?e++:e=0,i++;for(e=n,i=0;i<e.length;){for(n=0;255==e[i];)n+=255,i++;n+=e[i++];for(var r=0;255==e[i];)r+=255,i++;r+=e[i++],4==n&&t.push(e.subarray(i,i+r)),i+=r}return t}function wm(){this.j=new Map,this.i=this.h=0,this.g=Im}function Am(e,t,n,i,r,a,o,s,l){var u=0,f=a,h=s.map(function(e){return e.fh});for(h=[].concat.apply([],d(h)),h.length&&(f=h[0].sampleSize||a),t.skip(o+s[0].Mh);t.oa();){o=t.P();var p=t.T(),g=null;switch(g=!1,s=1,e.g){case xm:g=31&p,g=6==g;break;case Rm:s=2,t.skip(1),g=p>>1&63,g=39==g||40==g;break;case Cm:s=2,t.skip(1),g=p>>1&63,g=23==g||24==g;break;default:return}if(g)for(p=0,u<h.length&&(p=h[u].He||0),p=(n+p)/i,s=c(Sm(t.rb(o-s))),g=s.next();!g.done;g=s.next())l.push({packet:g.value,pts:p});else try{t.skip(o-s)}catch(e){break}f-=o+4,0==f&&(n=u<h.length?n+(h[u].$f||r):n+r,u++,f=u<h.length&&h[u].sampleSize||a)}}ym.prototype.clear=function(){this.l=0,this.h=[],this.g=[];var e=this.i;e.i=[],e.h=[],e.g=0,_m(this),e=c(this.j.values());for(var t=e.next();!t.done;t=e.next())pm(t.value)},ym.prototype.extract=function(e,t){if(this.B){for(var n=c(this.m.values()),i=n.next();!i.done;i=n.next())i.value.l=t;this.B=!1}if(e=new sa(e,0),!(8>e.getLength())&&181===e.T()&&49===e.ka()&&1195456820===e.P()&&3===e.T()&&(n=e.T(),0!==(64&n)))for(n&=31,e.skip(1),i=0;i<n;i++){var r=e.T(),a=(4&r)>>2,o=e.T(),s=e.T();a&&(r&=3,0===r||1===r?this.h.push({pts:t,type:r,cb:o,Eb:s,order:this.h.length}):(this.g.push({pts:t,type:r,value:o,order:this.g.length}),this.g.push({pts:t,type:2,value:s,order:this.g.length})))}},ym.prototype.decode=function(){function e(e,t){return e.pts-t.pts||e.order-t.order}var t=[];this.h.sort(e),this.g.sort(e);for(var n=c(this.h),i=n.next();!i.done;i=n.next())(i=bm(this,i.value))&&t.push(i);for(n=c(this.g),i=n.next();!i.done;i=n.next())sm(this.i,i.value);for(n=c(this.i.i),i=n.next();!i.done;i=n.next())i=Em(this,i.value),t.push.apply(t,d(i));return this.i.i=[],this.h=[],this.g=[],t},ym.prototype.getStreams=function(){return Array.from(this.A)},K("shaka.cea.CeaDecoder",ym),ke=function(){return new ym},wm.prototype.init=function(e){function t(e){e=e.name,e in Dm&&(n.g=Dm[e])}var n=this,i=[],r=[];if((new ca).box("moov",da).box("mvex",da).S("trex",function(e){var t=e.reader;t.skip(4),t.skip(4),e=t.P(),t=t.P(),n.h=e,n.i=t}).box("trak",da).S("tkhd",function(e){var t=e.reader;e=e.version,1==e?(t.skip(8),t.skip(8)):(t.skip(4),t.skip(4));var n=t.P();1==e?t.skip(8):t.skip(4),t.skip(4),t.skip(8),t.skip(2),t.skip(2),t.skip(2),t.skip(2),t.skip(36),t.ka(),t.ka(),t.ka(),t.ka(),i.push(n)}).box("mdia",da).S("mdhd",function(e){e=vs(e.reader,e.version),r.push(e.timescale)}).box("minf",da).box("stbl",da).S("stsd",fa).box("avc1",t).box("avc3",t).box("hev1",t).box("hvc1",t).box("dvav",t).box("dva1",t).box("dvh1",t).box("dvhe",t).box("vvc1",t).box("vvi1",t).box("encv",ha).box("sinf",da).box("frma",function(e){e=bs(e.reader).Na,e in Dm&&(n.g=Dm[e])}).parse(e,!0),!i.length||!r.length||i.length!=r.length)throw new Rt(2,2,2010);this.g==Im&&Q("Unable to determine bitstream format for CEA parsing!"),i.forEach(function(e,t){n.j.set(e,r[t])})},wm.prototype.parse=function(e){var t=this;if(this.g==Im)return[];var n=[],i=0,r=[];return(new ca).box("moof",function(e){i=e.start,r=[],da(e)}).box("traf",function(e){r.push({baseMediaDecodeTime:null,qd:t.h,fe:t.i,ah:[],timescale:9e4}),da(e)}).S("trun",function(e){var t=r[r.length-1];e=ys(e.reader,e.version,e.flags),t.ah.push(e)}).S("tfhd",function(e){var n=r[r.length-1];e=gs(e.reader,e.flags),n.qd=e.qd||t.h,n.fe=e.fe||t.i,e=e.trackId,t.j.has(e)&&(n.timescale=t.j.get(e))}).S("tfdt",function(e){var t=r[r.length-1];e=ms(e.reader,e.version),t.baseMediaDecodeTime=e.baseMediaDecodeTime}).box("mdat",function(e){for(var a=i-e.start-8,o=e.reader.ua(),s=c(r),l=s.next();!l.done;l=s.next()){if(l=l.value,null===l.baseMediaDecodeTime)throw Q("Unable to find base media decode time for CEA captions!"),new Rt(2,2,2010);e.reader.seek(o),Am(t,e.reader,l.baseMediaDecodeTime,l.timescale,l.qd,l.fe,a,l.ah,n)}}).parse(e,!1),n},K("shaka.cea.Mp4CeaParser",wm);var Im=0,xm=1,Rm=2,Cm=3,Dm={avc1:xm,avc3:xm,hev1:Rm,hvc1:Rm,dvav:xm,dva1:xm,dvh1:Rm,dvhe:Rm,vvc1:Cm,vvi1:Cm};function km(){this.g=null}function Mm(e,t,n){var i=Um(e),r=null;e=[];var a=[],o=null,s=new Set(i.map(function(e){return e.keyId}));s.delete(null);var l="cenc";if(1<s.size)throw new Rt(2,4,4010);if(!t){if(a=i.filter(function(e){return"urn:mpeg:dash:sea:2012"==e.Sc}),1<a.length)throw new Rt(2,4,4050);a.length&&(o=Gm(a[0])),(a=i.find(function(e){return"urn:mpeg:dash:mp4protection:2011"==e.Sc}))&&a.encryptionScheme&&(l=a.encryptionScheme),a=i.filter(function(e){return"urn:mpeg:dash:mp4protection:2011"==e.Sc?(r=e.init||r,!1):"urn:mpeg:dash:sea:2012"!=e.Sc}),a.length&&(e=Fm(r,l,a,n,s),0==e.length&&(e=[Rn("",l,r)]))}if(i.length&&!o&&(t||!a.length))for(e=[],t=c(Object.values(n)),n=t.next();!n.done;n=t.next())n=n.value,"org.w3.clearkey"!=n&&e.push(Rn(n,l,r));if(s=Array.from(s)[0]||null)for(l=c(e),t=l.next();!t.done;t=l.next())for(t=c(t.value.initData),n=t.next();!n.done;n=t.next())n.value.keyId=s;return{Dg:s,kk:r,drmInfos:e,bf:o,Hg:!0}}function Lm(e,t,n,i){var r=Mm(e,n,i);if(t.Hg)e=1==t.drmInfos.length&&!t.drmInfos[0].keySystem,n=0==r.drmInfos.length,(0==t.drmInfos.length||e&&!n)&&(t.drmInfos=r.drmInfos),t.Hg=!1;else if(0<r.drmInfos.length&&(t.drmInfos=t.drmInfos.filter(function(e){return r.drmInfos.some(function(t){return t.keySystem==e.keySystem})}),0==t.drmInfos.length))throw new Rt(2,4,4008);return r.Dg||t.Dg}function Pm(e){var t=0,n=Ie(e),i=n.getUint32(t,!0);if(i!=e.byteLength)return[];e:{for(e=t+6,t=[];e<n.byteLength-1;){i=n.getUint16(e,!0),e+=2;var r=n.getUint16(e,!0);if(e+=2,0!=(1&r)||r+e>n.byteLength){n=[];break e}var a=we(n,e,r);t.push({type:i,value:a}),e+=r}n=t}return n}function Nm(e){e=c(Ma(e,"DATA"));for(var t=e.next();!t.done;t=e.next())if(t=t.value,t.children){t=c(t.children);for(var n=t.next();!n.done;n=t.next())if(n=n.value,"LA_URL"==n.tagName)return Da(n)}return""}function Om(e){var t=Pa(e.node,"https://dashif.org/CPS","Laurl");return t&&(t=Da(t))?t:(e=Pa(e.node,"urn:microsoft:playready","pro"),e&&Da(e)?(e=Da(e),e=Sn(e),e=Pm(e).filter(function(e){return e.type===jm})[0],e?(e=hn(e.value,!0),(e=wa(e,"WRMHEADER"))?Nm(e):""):""):"")}function Fm(e,t,n,i,r){var a=[];n=c(n);for(var o=n.next();!o.done;o=n.next()){o=o.value;var s=i[o.Sc];if(s){var l;if((l=Pa(o.node,"urn:microsoft:playready","pro"))&&Da(l)){l=Da(l),l=Sn(l);var u=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);l=[{initData:Ta(l,u,new Set,0),initDataType:"cenc",keyId:o.keyId}]}else l=null;if(u=null,"urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e"===o.Sc)if(u=r,0==u.size)u=null;else{var d=new Uint8Array([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75]),f=new Uint8Array([]);u=[{initData:Ta(f,d,u,1),initDataType:"cenc",keyId:o.keyId}]}l=Rn(s,t,o.init||e||l||u),(s=Vm.get(s))&&(l.licenseServerUri=s(o)),a.push(l)}}return a}function Um(e){var t=[];e=c(e);for(var n=e.next();!n.done;n=e.next())(n=Bm(n.value))&&t.push(n);return t}function Bm(e){var t=e.attributes.schemeIdUri,n=Oa(e,"urn:mpeg:cenc:2013","default_KID"),i=Fa(e,"urn:mpeg:cenc:2013","pssh").map(ka),r=e.attributes.value;if(!t)return null;if(t=t.toLowerCase(),n&&(n=n.replace(/-/g,"").toLowerCase(),n.includes(" ")))throw new Rt(2,4,4009);var a=[];try{a=i.map(function(e){return{initDataType:"cenc",initData:Sn(e),keyId:null}})}catch(e){throw new Rt(2,4,4007)}return{node:e,Sc:t,keyId:n,init:0<a.length?a:null,encryptionScheme:r}}function Gm(t){if(!e.crypto||!e.crypto.subtle)throw Q("Web Crypto API is not available to decrypt AES-128. (Web Crypto only exists in secure origins like https)"),new Rt(2,4,4042);var n=Pa(t.node,"urn:mpeg:dash:schema:sea:2012","SegmentEncryption");if(!n)throw new Rt(2,4,4051);if("urn:mpeg:dash:sea:aes128-cbc:2013"!=n.attributes.schemeIdUri)throw new Rt(2,4,4051);if(n=Pa(t.node,"urn:mpeg:dash:schema:sea:2012","CryptoPeriod"),!n)throw new Rt(2,4,4051);if(t=n.attributes.IV,n=yn(n.attributes.keyUriTemplate),!t||!n)throw new Rt(2,4,4051);if(t=wn(t.substr(2)),16!=t.byteLength)throw new Rt(2,4,4048);return{Ai:n,iv:t}}De["video/mp4"]=function(){return new wm},km.prototype.init=function(){},km.prototype.parse=function(e){this.g?this.g.clearData():this.g=new Os;var t=[];if(e=we(e),!js(e))return t;e=this.g.parse(e);var n=e.sd(),i=e.ke();switch(e=[],n.video){case"avc":e.push(6);break;case"hvc":e.push(39),e.push(40)}if(!e.length)return t;for(n=c(i),i=n.next();!i.done;i=n.next())if(i=i.value,e.includes(i.type)&&null!=i.time)for(var r=c(Sm(i.data)),a=r.next();!a.done;a=r.next())t.push({packet:a.value,pts:i.time});return t},K("shaka.cea.TsCeaParser",km),De["video/mp2t"]=function(){return new km};var jm=1,Vm=(new Map).set("com.widevine.alpha",function(e){var t=Pa(e.node,"https://dashif.org/CPS","Laurl");return t&&(t=Da(t))?t:(e=Pa(e.node,"urn:microsoft","laurl"))&&yn(e.attributes.licenseUrl)||""}).set("com.microsoft.playready",Om).set("com.microsoft.playready.recommendation",Om).set("com.microsoft.playready.software",Om).set("com.microsoft.playready.hardware",Om).set("org.w3.clearkey",function(e){var t=Pa(e.node,"https://dashif.org/CPS","Laurl");return t&&(t=Da(t))?t:(e=Pa(e.node,"http://dashif.org/guidelines/clearKey","Laurl"))&&"EME-1.0"===e.attributes.Lic_type&&e&&(e=Da(e))?e:""});function Hm(t,n,i,r,a,o){var s={RepresentationID:n,Number:i,SubNumber:r,Bandwidth:a,Time:o};return t.replace(/\$(RepresentationID|Number|SubNumber|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(t,n,i,r){if("$$"==t)return"$";var a=s[n];if(null==a)return t;switch("RepresentationID"==n&&i&&(i=void 0),"Time"==n&&"bigint"!=typeof a&&(.2<=Math.abs(a-Math.round(a))&&Q("Calculated $Time$ values must be close to integers"),a=Math.round(a)),r){case void 0:case"d":case"i":case"u":t=a.toString();break;case"o":t=a.toString(8);break;case"x":t=a.toString(16);break;case"X":t=a.toString(16).toUpperCase();break;default:t=a.toString()}return i=e.parseInt(i,10)||1,Array(Math.max(0,i-t.length)+1).join("0")+t})}function Km(e,t){var n=Zm(e,t,"timescale"),i=1;n&&(i=Ha(n)||1),n=Zm(e,t,"duration"),(n=Ha(n||""))&&(n/=i);var r=Zm(e,t,"startNumber"),a=Number(Zm(e,t,"presentationTimeOffset"))||0,o=Ka(r||"");if(null!=r&&null!=o||(o=1),r=null,t=qm(e,t,"SegmentTimeline")){t=Ca(t,"S"),r=i,e=e.ja.duration||1/0;for(var s=o,l=[],u=-a,c=0;c<t.length;++c){var d=t[c],f=t[c+1],h=Na(d,"t",Ka),p=Na(d,"d",Ka),g=Na(d,"r",Va);if(d=Na(d,"k",Va)||0,null!=h&&(h-=a),p){if(h=null!=h?h:u,g=g||0,0>g)if(f){if(f=Na(f,"t",Ka),null==f)break;if(h>=f)break;g=Math.ceil((f-h)/p)-1}else{if(1/0==e)break;if(h/r>=e)break;g=Math.ceil((e*r-h)/p)-1}for(0<l.length&&h!=u&&(l[l.length-1].end=h/r),f=0;f<=g;++f)u=h+p,l.push({start:h/r,end:u/r,og:h,Bb:d,Zi:l.length+s}),h=u}}r=l}return{timescale:i,La:n,Od:o,Pb:a/i||0,ng:a,timeline:r}}function zm(e,t){return[t(e.J),t(e.la),t(e.va)].filter(si)}function Zm(e,t,n){t=zm(e,t),e=null,t=c(t);for(var i=t.next();!i.done&&!(e=i.value.attributes[n]);i=t.next());return e}function qm(e,t,n){t=zm(e,t),e=null,t=c(t);for(var i=t.next();!i.done&&!(e=La(i.value,n));i=t.next());return e}function Ym(e,t,n,i,r,a){for(var o=Oa(e,"http://www.w3.org/1999/xlink","href"),s=Oa(e,"http://www.w3.org/1999/xlink","actuate")||"onRequest",l=c(Object.keys(e.attributes)),u=l.next();!u.done;u=l.next()){u=u.value;var d=u.split(":"),f=Aa("http://www.w3.org/1999/xlink");d[0]==f&&delete e.attributes[u]}if(5<=a)return Dr(new Rt(2,4,4028));if("onLoad"!=s)return Dr(new Rt(2,4,4027));var h=xn([i],[o]);return r.request(0,zr(h,t)).Aa(function(i){if(i=Sa(i.data,e.tagName),!i)return Dr(new Rt(2,4,4001,o));for(e.children=[];i.children.length;){var s=i.children.shift();s.tagName&&(s.parent=e),e.children.push(s)}s=c(Object.keys(i.attributes));for(var l=s.next();!l.done;l=s.next())l=l.value,e.attributes[l]=i.attributes[l];return Wm(e,t,n,h[0],r,a+1)})}function Wm(e,t,n,i,r,a){if(a=void 0===a?0:a,Oa(e,"http://www.w3.org/1999/xlink","href")){var o=Ym(e,t,n,i,r,a);return n&&(o=o.Aa(void 0,function(){return Wm(e,t,n,i,r,a)})),o}o=[];for(var s={},l=c(Ra(e)),u=l.next();!u.done;s={Bc:s.Bc},u=l.next())s.Bc=u.value,"urn:mpeg:dash:resolve-to-zero:2013"==Oa(s.Bc,"http://www.w3.org/1999/xlink","href")?e.children=e.children.filter(function(e){return function(t){return t!==e.Bc}}(s)):"SegmentTimeline"!=s.Bc.tagName&&o.push(Wm(s.Bc,t,n,i,r,a));return Pr(o).Aa(function(){return e})}function $m(e,t,n,i,r,a,o){var s,l=(new ca).S("sidx",function(e){s=Xm(t,i,r,a,o,n,e)});if(e&&l.parse(e),s)return s;throw new Rt(2,3,3004)}function Xm(e,t,n,i,r,a,o){var s=[];o.reader.skip(4);var l=o.reader.P();if(0==l)throw new Rt(2,3,3005);if(0==o.version)var u=o.reader.P(),c=o.reader.P();else u=o.reader.Qc(),c=o.reader.Qc();o.reader.skip(2);var d=o.reader.ka();for(e=e+o.size+c,c=0;c<d;c++){var f=o.reader.P(),h=(2147483648&f)>>>31;f&=2147483647;var p=o.reader.P();if(o.reader.skip(4),1==h)throw new Rt(2,3,3006);s.push(new Qo(u/l+n,(u+p)/l+n,function(){return a},e,e+f-1,t,n,i,r)),u+=p,e+=f}return o.parser.stop(),s}function Qm(e){this.h=Ie(e),this.g=new sa(this.h,0)}function Jm(e){var t=ev(e);if(7<t.length)throw new Rt(2,3,3002);var n=0;t=c(t);for(var i=t.next();!i.done;i=t.next())n=256*n+i.value;t=ev(e);e:{i=c(tv);for(var r=i.next();!r.done;r=i.next())if(Ee(t,new Uint8Array(r.value))){i=!0;break e}i=!1}if(i)t=e.h.byteLength-e.g.ua();else{if(8==t.length&&224&t[1])throw new Rt(2,3,3001);for(r=i=0;r<t.length;r++){var a=t[r];i=0==r?a&(1<<8-t.length)-1:256*i+a}t=i}return t=e.g.ua()+t<=e.h.byteLength?t:e.h.byteLength-e.g.ua(),i=Ie(e.h,e.g.ua(),t),e.g.skip(t),new nv(n,i)}function ev(e){var t=e.g.ua(),n=e.g.T();if(0==n)throw new Rt(2,3,3002);return n=8-Math.floor(Math.log2(n)),e.g.skip(n-1),we(e.h,t,n)}Qm.prototype.oa=function(){return this.g.oa()};var tv=[[255],[127,255],[63,255,255],[31,255,255,255],[15,255,255,255,255],[7,255,255,255,255,255],[3,255,255,255,255,255,255],[1,255,255,255,255,255,255,255]];function nv(e,t){this.id=e,this.g=t}function iv(e){if(8<e.g.byteLength)throw new Rt(2,3,3002);if(8==e.g.byteLength&&224&e.g.getUint8(0))throw new Rt(2,3,3001);for(var t=0,n=0;n<e.g.byteLength;n++){var i=e.g.getUint8(n);t=256*t+i}return t}function rv(e,t,n,i,r,a,o,s,l){function u(){return r}var c=[];e=new Qm(e.g);for(var d=null,f=null;e.oa();){var h=Jm(e);if(187==h.id){var p=av(h);p&&(h=n*p.kj,p=t+p.Pi,null!=d&&c.push(new Qo(d+o,h+o,u,f,p-1,a,o,s,l)),d=h,f=p)}}return null!=d&&c.push(new Qo(d+o,i+o,u,f,null,a,o,s,l)),c}function av(e){var t=new Qm(e.g);if(e=Jm(t),179!=e.id)throw new Rt(2,3,3013);if(e=iv(e),t=Jm(t),183!=t.id)throw new Rt(2,3,3012);t=new Qm(t.g);for(var n=0;t.oa();){var i=Jm(t);if(241==i.id){n=iv(i);break}}return{kj:e,Pi:n}}function ov(e,t,n){if(t=qm(e,t,"Initialization"),!t)return null;var i=e.J.Ga(),r=t.attributes.sourceURL;r&&(i=xn(i,[yn(r)])),r=0;var a=null;return(t=Na(t,"range",ja))&&(r=t.start,a=t.end),n=new $o(function(){return i},r,a,hv(e),null,null,n),n.codecs=e.J.codecs,n.mimeType=e.J.mimeType,n}function sv(e,t,n){var i=Number(Zm(e,uv,"presentationTimeOffset"))||0,r=Zm(e,uv,"timescale"),a=1;r&&(a=Ha(r)||1);var o=i/a||0,s=ov(e,uv,n);dv(e,s);var l=_i(e);return{mc:function(){var e=qm(l,uv,"RepresentationIndex"),n=l.J.Ga();return e&&(e=yn(e.attributes.sourceURL))&&(n=xn(n,[e])),e=cv(l),lv(l,t,s,n,e.start,e.end,o)}}}function lv(e,t,n,i,r,a,o){var s,l,u,d,f,h,p,g,m,v,y,_,b,E,S,w,A,I;return O(function(x){if(1==x.g)return s=e.presentationTimeline,l=!e.xb||!e.ja.Dd,u=e.ja.start,d=e.ja.duration,f=e.J.mimeType.split("/")[1],h=t,p=null,g=[h(i,r,a,!1),"webm"==f?h(n.M(),n.Ha,n.sa,!0):null],h=null,T(x,Promise.all(g),2);if(m=x.h,v=m[0],y=m[1]||null,_=null,b=u-o,E=u,S=d?u+d:1/0,"mp4"==f)var R=$m(v,r,i,n,b,E,S);else{if(R=new Qm(y),440786851!=Jm(R).id)throw new Rt(2,3,3008);var C=Jm(R);if(408125543!=C.id)throw new Rt(2,3,3009);R=C.g.byteOffset,C=new Qm(C.g);for(var D=null;C.oa();){var k=Jm(C);if(357149030==k.id){D=k;break}}if(!D)throw new Rt(2,3,3010);for(D=new Qm(D.g),k=1e6,C=null;D.oa();){var M=Jm(D);if(2807729==M.id)k=iv(M);else if(17545==M.id)if(4==M.g.byteLength)C=M.g.getFloat32(0);else{if(8!=M.g.byteLength)throw new Rt(2,3,3003);C=M.g.getFloat64(0)}}if(null==C)throw new Rt(2,3,3011);if(D=k/1e9,C*=D,k=Jm(new Qm(v)),475249515!=k.id)throw new Rt(2,3,3007);R=rv(k,R,D,C,i,n,b,E,S)}for(_=R,w=c(_),A=w.next();!A.done;A=w.next())I=A.value,I.codecs=e.J.codecs,I.mimeType=e.J.mimeType;return s.Jd(_),p=new tu(_),l&&p.Ec(E,S,!0),x.return(p)})}function uv(e){return e.Tc}function cv(e){var t=qm(e,uv,"RepresentationIndex");return e=Zm(e,uv,"indexRange"),e=ja(e||""),t&&(e=Na(t,"range",ja,e)),e}function dv(e,t){if(fv(e,t),!cv(e))throw new Rt(2,4,4002)}function fv(e,t){var n=e.J.mimeType.split("/")[1];if(e.J.contentType!=Ln&&"mp4"!=n&&"webm"!=n)throw new Rt(2,4,4006);if("webm"==n&&!t)throw new Rt(2,4,4005)}function hv(e){var t=e.J;return{bandwidth:e.bandwidth,audioSamplingRate:t.audioSamplingRate,codecs:t.codecs,contentType:t.contentType,frameRate:t.frameRate||null,height:t.height||null,mimeType:t.mimeType,channelsCount:t.Nc,pixelAspectRatio:t.pixelAspectRatio||null,width:t.width||null,label:e.la.label||null,roles:e.roles||null,language:e.la.language||null}}function pv(e,t,n){var i=ov(e,gv,n),r=mv(e);if(!r.La&&!r.timeline&&1<r.Mc.length)throw new Rt(2,4,4002);if(!r.La&&!e.ja.duration&&!r.timeline&&1==r.Mc.length)throw new Rt(2,4,4002);if(r.timeline&&0==r.timeline.length)throw new Rt(2,4,4002);var a=null,o=null;e.va.id&&e.J.id&&(o=t[e.va.id+","+e.J.id])&&(a=o.segmentIndex);var s=vv(e.ja.start,e.ja.duration,e.J.Ga,r,i,n,e.J.mimeType,e.J.codecs);return t=!a,a?a.Id(s,e.presentationTimeline.nb()):a=new tu(s),e.presentationTimeline.Jd(s),e.xb&&e.ja.Dd||a.Ec(e.ja.start,e.ja.duration?e.ja.start+e.ja.duration:1/0,t),o&&(o.segmentIndex=a),{mc:function(){return a&&0!=a.getNumReferences()||a.ue(s),Promise.resolve(a)}}}function gv(e){return e.Rb}function mv(e){var t=yv(e);e=Km(e,gv);var n=e.Od;0==n&&(n=1);var i=0;return e.La?i=e.La*(n-1):e.timeline&&0<e.timeline.length&&(i=e.timeline[0].start),{La:e.La,startTime:i,Od:n,Pb:e.Pb,timeline:e.timeline,Mc:t}}function vv(e,t,n,i,r,a,o,s){var l=i.Mc.length;i.timeline&&i.timeline.length!=i.Mc.length&&(l=Math.min(i.timeline.length,i.Mc.length));for(var u=e-i.Pb,c=t?e+t:1/0,d=[],f=i.startTime,h={},p=0;p<l;h={jd:h.jd,ed:h.ed},p++){h.ed=i.Mc[p];var g=f;f=void 0,f=null!=i.La?g+i.La:i.timeline?i.timeline[p].end:g+t,h.jd=null,g=new Qo(e+g,e+f,function(e){return function(){return null==e.jd&&(e.jd=xn(n(),[e.ed.Gi])),e.jd}}(h),h.ed.start,h.ed.end,r,u,e,c,[],"",null,null,es,a),g.codecs=s,g.mimeType=o,d.push(g)}return d}function yv(e){return[e.J.Rb,e.la.Rb,e.va.Rb].filter(si).map(function(e){return Ca(e,"SegmentURL")}).reduce(function(e,t){return 0<e.length?e:t}).map(function(t){t.attributes.indexRange&&!e.If&&(e.If=!0);var n=yn(t.attributes.media);return t=Na(t,"mediaRange",ja,{start:0,end:null}),{Gi:n,start:t.start,end:t.end}})}function _v(e,t,n,i,r,a,o,s,l){l||e.J.Jc||(e.J.Jc=Zm(e,bv,"initialization"));var u=e.J.Jc?wv(e,o):null,c=Ev(e);Tv(c);var d=_i(e);if(c.Bd)return fv(e,u),{mc:function(){var e=Hm(c.Bd,d.J.id,null,null,d.bandwidth||null,null);return e=xn(d.J.Ga(),[e]),lv(d,t,u,e,0,null,c.Pb)}};if(c.La)return i||"image"===e.la.contentType||(e.presentationTimeline.Pf(c.La),e.presentationTimeline.ye(e.ja.start)),{mc:function(){return Sv(d,c,r,u,a,o,s)}};var f=null;i=i=null,e.va.id&&e.J.id&&(i=e.va.id+","+e.J.id,i=n[i])&&(f=i.segmentIndex);var h=e.ja.start,p=e.ja.duration?h+e.ja.duration:1/0,g=!(e.xb&&e.ja.Dd);return f?(n=f,Iv(n,c,h,p,g,u),n.Oa(e.presentationTimeline.nb())):f=new Av(c,e.J.id,e.bandwidth,e.J.Ga,h,p,u,g,o,e.J.ag),c.timeline&&"image"!==e.la.contentType&&e.presentationTimeline.$g(c.timeline,h),i&&e.xb&&(i.segmentIndex=f),{mc:function(){return f instanceof Av&&0==f.getNumReferences()&&Iv(f,c,h,p,g,u),Promise.resolve(f)}}}function bv(e){return e.cc}function Ev(e){var t=Km(e,bv),n=Zm(e,bv,"media"),i=Zm(e,bv,"index");return{La:t.La,timescale:t.timescale,Od:t.Od,Pb:t.Pb,ng:t.ng,timeline:t.timeline,bc:n&&yn(n),Bd:i,mimeType:e.J.mimeType,codecs:e.J.codecs}}function Tv(e){var t=e.Bd?1:0;if(t+=e.timeline?1:0,t+=e.La?1:0,0==t)throw new Rt(2,4,4002);if(1!=t&&(e.Bd&&(e.timeline=null),e.La=null),!e.Bd&&!e.bc)throw new Rt(2,4,4002)}function Sv(t,n,i,r,a,o,s){function l(i){var a=(i-v)*m,s=a+n.Pb,l=a+h;a=l+m;var u=Math.min(a,d());return l=new Qo(l,u,function(){var t=s*y;return"BigInt"in e&&t>Number.MAX_SAFE_INTEGER&&(t=BigInt(s)*BigInt(y)),t=Hm(_,E,i,null,b,t),xn(T(),[t])},0,null,r,S,h,d(),[],"",null,null,es,o),l.codecs=t.J.codecs,l.mimeType=t.J.mimeType,l.j=a,l}function u(){var e=[Math.max(f.nb(),h),Math.min(f.Zb(),d())].map(function(e){return e-h});return e=[Math.ceil(e[0]/m),Math.ceil(e[1]/m)-1],t.J.Ia&&e[1]++,e.map(function(e){return e+v})}function d(){var e=null!=p&&a[p]||g;return e?h+e:1/0}var f=t.presentationTimeline,h=t.ja.start,p=t.va.id,g=t.ja.duration,m=n.La,v=n.Od,y=n.timescale,_=n.bc,b=t.bandwidth||null,E=t.J.id,T=t.J.Ga,S=h-n.Pb,w=u();i=t.xb?Math.max(w[0],w[1]-i+1):w[0],s=s||w[1],w=[];for(var A=i;A<=s;++A){var I=l(A);w.push(I)}var x=new tu(w);if(w=f.Zb()<d(),A=f.V(),w||A){var R=Math.max(i,s+1);i=m,t.J.Ia&&(i=.1),x.Me(i,function(){var e=f.nb();x.Oa(e);var t=c(u());t.next(),t=t.next().value;for(var n=[];R<=t;){var i=l(R);n.push(i),R++}return e>d()&&!n.length?null:n})}return Promise.resolve(x)}function wv(e,t){var n=e.J.Jc;if(n||(n=Zm(e,bv,"initialization")),!n)return null;n=yn(n);var i=e.J.id,r=e.bandwidth||null,a=e.J.Ga;return t=new $o(function(){var e=Hm(n,i,null,null,r,null);return xn(a(),[e])},0,null,hv(e),null,null,t),t.codecs=e.J.codecs,t.mimeType=e.J.mimeType,t}function Av(e,t,n,i,r,a,o,s,l,u){tu.call(this,[]),this.g=e,this.C=t,this.A=n,this.B=i,this.h=r,this.j=a,this.o=o,this.s=l,this.F=u,s&&Rv(this)}function Iv(e,t,n,i,r,a){if(xv(e,a),e.g){if(n=e.g.timeline,e.g.bc!==t.bc&&(e.g.bc=t.bc),n.length){var o=n[n.length-1];t=t.timeline.filter(function(e){return e.start>=o.end})}else t=t.timeline.slice();0<t.length&&e.g.timeline.push.apply(e.g.timeline,d(t)),e.j!==i&&(e.j=i)}else e.g=t,e.h=n,e.j=i;r&&Rv(e)}function xv(e,t){if(e.o!==t){e.o=t,e=c(e.O);for(var n=e.next();!n.done;n=e.next())(n=n.value)&&Jo(n,t)}}function Rv(e){if(!e.m){for(var t=e.g.timeline;t.length;){if(!(t[t.length-1].start>=e.j))break;t.pop()}e.Oa(e.h)}}function Cv(e,t,n,i,r,a,o){return e=Hm(e,t,n,a,i||null,r),xn(o(),[e]).map(function(e){return e.toString()})}function Dv(e){this.o=null,this.A=e,this.G=new Gr,this.i=[],this.h=null,this.m=[],this.B=null,this.F=[],this.C=300,this.l=new Map,this.j=new Map,this.g=null,this.s="UNKNOWN"}function kv(e,t){var n,i,r,a,o,s,l;return O(function(u){return 1==u.g?(n=xn(e.i,[Mv(e,t)]),i=zr(n,e.o.retryParameters),r=e.A.networkingEngine.request(8,i),jr(e.G,r),w(u,2),T(u,r.promise,4)):2!=u.g?(a=u.h,o=fn(a.data),s=JSON.parse(o),1==s.VERSION&&Lv(e,s,a.uri),I(u,0)):(l=x(u))&&7001==l.code?u.return():(null!=e.g&&(e.g.stop(),e.g=null),e.g=new Ft(function(){kv(e,t)}),e.g.Y(e.C),void S(u))})}function Mv(e,t){if(!e.m.length)return t;t=new ft(t);var n=e.B||e.m[0],i=Math.round(e.A.getBandwidthEstimate()),r=t.g;return"DASH"==e.s?(r.add("_DASH_pathway",n),r.add("_DASH_throughput",String(i))):"HLS"==e.s&&(r.add("_HLS_pathway",n),r.add("_HLS_throughput",String(i))),xt(r)&&mt(t,r),t.toString()}function Lv(e,t,n){null!=e.g&&(e.g.stop(),e.g=null);var i=t["RELOAD-URI"]||n;e.g=new Ft(function(){kv(e,i)}),(n=t.TTL)&&(e.C=n),e.g.Y(e.C),e.m=t["PATHWAY-PRIORITY"]||[],e.F=t["PATHWAY-CLONES"]||[]}function Pv(e,t,n,i){var r=e.l.get(t);r||(r=new Map),r.set(n,i),e.l.set(t,r)}function Nv(e,t,n){n=void 0!==n&&n,t=e.l.get(t)||new Map;for(var i=[],r={},a=c(e.m),o=a.next();!o.done;r={jc:r.jc},o=a.next())if(r.jc=o.value,o=t.get(r.jc))i.push({Vf:r.jc,location:o});else if(o=e.F.find(function(e){return function(t){return t.Dj==e.jc}}(r))){var s=t.get(o["BASE-ID"]);s&&(o["URI-REPLACEMENT"].xh?(s=new ft(s),pt(s,o["URI-REPLACEMENT"].xh),i.push({Vf:r.jc,location:s.toString()})):i.push({Vf:r.jc,location:s}))}for(r=Date.now(),a=c(e.j.keys()),o=a.next();!o.done;o=a.next())o=o.value,s=e.j.get(o),r>s&&e.j.delete(o);if(i=i.filter(function(t){for(var n=c(e.j.keys()),i=n.next();!i.done;i=n.next())if(i.value.includes(new ft(t.location).Gb))return!1;return!0}),i.length&&(e.B=i[0].Vf),i=i.map(function(e){return e.location}),!i.length&&e.h)for(r=c(e.h.split(",")),o=r.next();!o.done;o=r.next())(a=t.get(o.value))&&(e.B=e.h,i.push(a));if(!i.length)for(t=c(t.values()),r=t.next();!r.done;r=t.next())i.push(r.value);return n?i:xn(e.i,i)}function Ov(){this.j=[],this.h=[],this.g=[],this.l=[],this.i=[],this.s=this.o=!1,this.m=new Set}function Fv(e,t){var n=[],i=[],r=[],a=[];e=c(e);for(var o=e.next();!o.done;o=e.next()){var s=o.value;o=new Map(s.audioStreams.map(function(e){return[cy(e),e]}));var l=new Map(s.videoStreams.map(function(e){return[uy(e),e]})),u=new Map(s.textStreams.map(function(e){return[dy(e),e]}));if(s=new Map(s.imageStreams.map(function(e){return[fy(e),e]})),t){var d=ay(Ln);u.set(dy(d),d),d=ay("image"),s.set(fy(d),d)}n.push(o),i.push(l),r.push(u),a.push(s)}return{xg:n,vh:i,sh:r,Sg:a}}function Uv(e){var t,n,i,r,a,o,s,l,u,d,f,h,p,g,m,v,y,_,b,E,S,w,A,I,x,R,C,D,k,M;return O(function(L){switch(L.g){case 1:if(t=Pn,1==e.length)return L.return(e[0]);for(n=e.map(function(e){return new Map(e.filter(function(e){return e.type===t.X}).map(function(e){return[cy(e),e]}))}),i=e.map(function(e){return new Map(e.filter(function(e){return e.type===t.ga}).map(function(e){return[uy(e),e]}))}),r=e.map(function(e){return new Map(e.filter(function(e){return e.type===t.ta}).map(function(e){return[dy(e),e]}))}),a=e.map(function(e){return new Map(e.filter(function(e){return e.type===t.Ze}).map(function(e){return[fy(e),e]}))}),o=c(r),s=o.next();!s.done;s=o.next())l=s.value,u=ry(t.ta),l.set(dy(u),u);for(d=c(a),f=d.next();!f.done;f=d.next())h=f.value,p=ry(t.Ze),h.set(fy(p),p);return g=new Ov,T(L,Bv(g,[],n,0,zv,qv,0),2);case 2:return m=L.h,T(L,Bv(g,[],i,0,zv,qv,0),3);case 3:return v=L.h,T(L,Bv(g,[],r,0,zv,qv,0),4);case 4:return y=L.h,T(L,Bv(g,[],a,0,zv,qv,0),5);case 5:if(_=L.h,b=0,v.length&&m.length)for(I=c(m),x=I.next();!x.done;x=I.next())for(R=x.value,C=c(v),D=C.next();!D.done;D=C.next())k=D.value,M=b++,k.variantIds.push(M),R.variantIds.push(M);else for(E=v.concat(m),S=c(E),w=S.next();!w.done;w=S.next())A=w.value,A.variantIds=[b++];return L.return(v.concat(m).concat(y).concat(_))}})}function Bv(e,t,n,i,r,a,o){var s,l,u,d,f,h,p,g,m,v,y,_,b,E,S,w,A;return O(function(I){switch(I.g){case 1:for(s=[],l=0;l<n.length;l++)l>=i?s.push(new Set(n[l].values())):s.push(new Set);u=c(t),d=u.next();case 2:if(d.done){I.u(4);break}return f=d.value,T(I,Gv(e,f,n,i,a,s,o),5);case 5:if(h=I.h,!h)throw new Rt(2,4,4037);d=u.next(),I.u(2);break;case 4:for(p=c(s),g=p.next();!g.done;g=p.next())for(m=g.value,v=c(m),y=v.next();!y.done;y=v.next())_=y.value,(b=Vv(e,_,n,r,a,s))&&t.push(b);for(E=c(s),g=E.next();!g.done;g=E.next())for(S=g.value,w={},A=c(S),y=A.next();!y.done;w={Yd:w.Yd},y=A.next())if(w.Yd=y.value,!ly(w.Yd)&&t.some(function(t){return function(n){return Xv(e,t.Yd,n)}}(w)))throw new Rt(2,4,4037);return I.return(t)}})}function Gv(e,t,n,i,r,a,o){return O(function(s){return 1==s.g?(Yv(e,n,t,0<o),t.matchedStreams?t.segmentIndex?T(s,jv(t,i+o),2):s.u(2):s.return(!1)):(Hv(t,i,r,a,o),s.return(!0))})}function jv(e,t){var n,i,r,a,o,s,l;return O(function(u){if(1==u.g){for(n=[],i=e.matchedStreams,r=c(i),a=r.next();!a.done;a=r.next())o=a.value,n.push(o.createSegmentIndex()),o.trickModeVideo&&!o.trickModeVideo.segmentIndex&&n.push(o.trickModeVideo.createSegmentIndex());return T(u,Promise.all(n),2)}if(e.segmentIndex instanceof ru)for(s=t;s<i.length;s++)l=i[s],l.segmentIndex&&e.segmentIndex.g.push(l.segmentIndex);S(u)})}function Vv(e,t,n,i,r,a){if(ly(t))return null;var o=i(t);return Yv(e,n,o),o.createSegmentIndex&&(o.createSegmentIndex=function(){return O(function(e){return o.segmentIndex?e.u(0):(o.segmentIndex=new ru,T(e,jv(o,0),0))})}),o.matchedStreams&&o.matchedStreams.length?(Hv(o,0,r,a,0),o):null}function Hv(e,t,n,i,r){var a=e.matchedStreams;for(t+=r;t<a.length;t++){var o=a[t];n(e,o);var s=!0;if("audio"==e.type&&0==hi(e.language,o.language)&&(s=!1),s&&(i[t-r].delete(o),o.fullMimeTypes))for(o=c(o.fullMimeTypes.values()),s=o.next();!s.done;s=o.next())e.fullMimeTypes.add(s.value)}}function Kv(e){var t=Object.assign({},e);return t.originalId=null,t.createSegmentIndex=function(){return Promise.resolve()},t.closeSegmentIndex=function(){if(t.segmentIndex&&(t.segmentIndex.release(),t.segmentIndex=null),t.matchedStreams)for(var e=c(t.matchedStreams),n=e.next();!n.done;n=e.next())n=n.value,n.segmentIndex&&(n.segmentIndex.release(),n.segmentIndex=null)},t.roles=t.roles.slice(),t.segmentIndex=null,t.emsgSchemeIdUris=[],t.keyIds=new Set,t.closedCaptions=null,t.trickModeVideo=null,t}function zv(e){return e=Object.assign({},e),e.roles=e.roles.slice(),e.keyIds=new Set,e.segments=[],e.variantIds=[],e.closedCaptions=null,e}function Zv(e,t){function n(e,t){e||(e=[]),t=c(t);for(var n=t.next();!n.done;n=t.next())n=n.value,e.includes(n)||e.push(n);return e}e.roles=n(e.roles,t.roles),t.emsgSchemeIdUris&&(e.emsgSchemeIdUris=n(e.emsgSchemeIdUris,t.emsgSchemeIdUris));for(var i=c(t.keyIds),r=i.next();!r.done;r=i.next())e.keyIds.add(r.value);if(null==e.originalId?e.originalId=t.originalId:e.originalId+=","+(t.originalId||""),i=Mt(e.drmInfos,t.drmInfos),t.drmInfos.length&&e.drmInfos.length&&!i.length)throw new Rt(2,4,4038);if(e.drmInfos=i,e.encrypted=e.encrypted||t.encrypted,t.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),i=c(t.closedCaptions),r=i.next();!r.done;r=i.next()){var a=c(r.value);r=a.next().value,a=a.next().value,e.closedCaptions.set(r,a)}e.bandwidth&&t.bandwidth&&(e.bandwidth=Math.max(e.bandwidth,t.bandwidth)),t.trickModeVideo?(e.trickModeVideo||(e.trickModeVideo=Kv(t.trickModeVideo),e.trickModeVideo.createSegmentIndex=function(){return e.trickModeVideo.segmentIndex=e.segmentIndex.clone(),Promise.resolve()}),Zv(e.trickModeVideo,t.trickModeVideo)):e.trickModeVideo&&Zv(e.trickModeVideo,t)}function qv(e,t){var n=e.roles;n||(n=[]);for(var i=c(t.roles),r=i.next();!r.done;r=i.next())r=r.value,n.includes(r)||n.push(r);for(e.roles=n,n=c(t.keyIds),i=n.next();!i.done;i=n.next())e.keyIds.add(i.value);if(e.encrypted=e.encrypted&&t.encrypted,e.segments.push.apply(e.segments,d(t.segments)),t.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),t=c(t.closedCaptions),n=t.next();!n.done;n=t.next())i=c(n.value),n=i.next().value,i=i.next().value,e.closedCaptions.set(n,i)}function Yv(e,t,n,i){i=void 0!==i&&i?n.matchedStreams:[],t=c(t);for(var r=t.next();!r.done;r=t.next()){if(r=Wv(e,r.value,n),!r)return;i.push(r)}n.matchedStreams=i}function Wv(e,t,n){var i={audio:cy,video:uy,text:dy,image:fy}[n.type],r=null,a=i(n);if(t.has(a))r=t.get(a);else{a={audio:function(t,n){return Xv(e,t,n)},video:function(t,n){return Xv(e,t,n)},text:Qv,image:Jv}[n.type];for(var o={audio:ey,video:ty,text:ny,image:iy}[n.type],s=c(t.values()),l=s.next();!l.done;l=s.next())l=l.value,!a(n,l)||n.fastSwitching!=l.fastSwitching||r&&!o(n,r,l)||(r=l)}return e.s&&!ly(r)&&t.delete(i(r)),r}function $v(e,t){return e.mimeType==t.mimeType&&hy(e.codecs)===hy(t.codecs)}function Xv(e,t,n){return!(!$v(t,n)&&!e.o||t.drmInfos&&!kt(t.drmInfos,n.drmInfos))}function Qv(e,t){return!t.language||e.forced===t.forced&&0!=hi(e.language,t.language)&&t.kind==e.kind}function Jv(){return!0}function ey(e,t,n){var i=$v(e,t),r=$v(e,n);if(i&&!r)return!1;if(!i&&r)return!0;if(i=hi(e.language,t.language),r=hi(e.language,n.language),r>i)return!0;if(r<i)return!1;if(t.label!==n.label){if(e.label===t.label)return!1;if(e.label===n.label)return!0}if(e.roles.length){if(i=t.roles.filter(function(t){return e.roles.includes(t)}),r=n.roles.filter(function(t){return e.roles.includes(t)}),r.length>i.length)return!0;if(r.length<i.length)return!1;if(n.roles.length!==t.roles.length)return n.roles.length<t.roles.length}else{if(!n.roles.length&&t.roles.length)return!0;if(n.roles.length&&!t.roles.length)return!1}return!(t.primary||!n.primary)||!(t.primary&&!n.primary)&&(i=oy(e.channelsCount,t.channelsCount,n.channelsCount),i==py||i!=my&&(i=oy(e.audioSamplingRate,t.audioSamplingRate,n.audioSamplingRate),i==py||i!=my&&!(!e.bandwidth||sy(e.bandwidth,t.bandwidth,n.bandwidth)!=py)))}function ty(e,t,n){var i=$v(e,t),r=$v(e,n);if(i&&!r)return!1;if(!i&&r)return!0;if(i=oy(e.width*e.height,t.width*t.height,n.width*n.height),i==py)return!0;if(i==my)return!1;if(e.frameRate){if(i=oy(e.frameRate,t.frameRate,n.frameRate),i==py)return!0;if(i==my)return!1}return!(!e.bandwidth||sy(e.bandwidth,t.bandwidth,n.bandwidth)!=py)}function ny(e,t,n){var i=hi(e.language,t.language),r=hi(e.language,n.language);if(r>i)return!0;if(r<i)return!1;if(!t.primary&&n.primary)return!0;if(t.primary&&!n.primary)return!1;if(t.label!==n.label){if(e.label===t.label)return!1;if(e.label===n.label)return!0}if(e.roles.length){if(i=t.roles.filter(function(t){return e.roles.includes(t)}),r=n.roles.filter(function(t){return e.roles.includes(t)}),r.length>i.length)return!0;if(r.length<i.length)return!1}else{if(!n.roles.length&&t.roles.length)return!0;if(n.roles.length&&!t.roles.length)return!1}return n.mimeType==e.mimeType&&n.codecs==e.codecs&&(t.mimeType!=e.mimeType||t.codecs!=e.codecs)}function iy(e,t,n){return oy(e.width*e.height,t.width*t.height,n.width*n.height)==py}function ry(e){return{id:0,originalId:"",groupId:null,primary:!1,type:e,mimeType:"",codecs:"",language:"",originalLanguage:null,label:null,width:null,height:null,encrypted:!1,keyIds:new Set,segments:[],variantIds:[],roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,external:!1,fastSwitching:!1}}function ay(e){return{id:0,originalId:"",groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new tu([]),mimeType:"",codecs:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"",originalLanguage:null,label:null,type:e,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set}}function oy(e,t,n){if(t==e&&e!=n)return my;if(n==e&&e!=t)return py;if(t>e){if(n<=e||n-e<t-e)return py;if(n-e>t-e)return my}else{if(n>e)return my;if(e-n<e-t)return py;if(e-n>e-t)return my}return gy}function sy(e,t,n){return t=Math.abs(e-t),e=Math.abs(e-n),e<t?py:t<e?my:gy}function ly(e){switch(e.type){case Ln:return!e.language;case"image":return!e.tilesLayout;default:return!1}}function uy(e){return JSON.stringify([e.fastSwitching,e.width,e.frameRate,hy(e.codecs),e.mimeType,e.label,e.roles,e.closedCaptions?Array.from(e.closedCaptions.entries()):null,e.bandwidth])}function cy(e){return JSON.stringify([e.fastSwitching,e.channelsCount,e.language,e.bandwidth,e.label,hy(e.codecs),e.mimeType,e.roles,e.audioSamplingRate,e.primary])}function dy(e){return JSON.stringify([e.language,e.label,e.codecs,e.mimeType,e.bandwidth,e.roles])}function fy(e){return JSON.stringify([e.width,e.codecs,e.mimeType])}function hy(e){if(!vy.has(e)){var t=Hn(e);vy.set(e,t)}return vy.get(e)}y(Av,tu),i=Av.prototype,i.getNumReferences=function(){return this.g?this.g.timeline.length:0},i.release=function(){tu.prototype.release.call(this),this.g=null},i.Oa=function(e){if(this.g){for(var t=0,n=this.g.timeline,i=0;i<n.length;i+=1){if(!(n[i].end+this.h<=e))break;t+=1}0<t&&(this.g.timeline=n.slice(t),this.O.length>=t&&(this.O=this.O.slice(t)),this.i+=t,0===this.getNumReferences()&&this.release())}},i.find=function(e){if(this.g&&this.g.timeline&&this.g.timeline.length&&e<this.g.timeline[0].start+this.h)return this.i;if(!this.g)return null;var t=this.g.timeline;if(e<this.h||e>=this.j)return null;for(var n=t.length-1,i=0;i<t.length;i++){var r=t[i],a=r.start+this.h;if(r=i<n?t[i+1].start+this.h:1/0===this.j?r.end+this.h:this.j,e>=a&&e<r)return i+this.i}return null},i.get=function(e){var t=this;if(e-=this.i,0>e||e>=this.getNumReferences()||!this.g)return null;var n=this.O[e];if(!n){var i=this.g.timeline[e],r=i.Zi,a=this.g.ng+i.og;n=this.h-this.g.Pb;var o=this.h+i.end,s=o;e===this.getNumReferences()-1&&1/0!==this.j&&(s=this.j);for(var l=this.g.codecs,u=this.g.mimeType,c=[],d=(i.end-i.start)/i.Bb,f={},h=0;h<i.Bb;f={kd:f.kd,We:f.We},h++){var p=i.start+d*h,g=p+d;f.We=h+1,f.kd=null,p=new Qo(this.h+p,this.h+g,function(e){return function(){return t.g?(null==e.kd&&(e.kd=Cv(t.g.bc,t.C,r,t.A,a,e.We,t.B)),e.kd):[]}}(f),0,null,this.o,n,this.h,this.j,[],"",null,null,es,this.s),p.codecs=l,p.mimeType=u,0==this.F?0<h&&p.se():0!=h%this.F&&p.se(),c.push(p)}n=new Qo(this.h+i.start,s,function(){return 0<i.Bb||!t.g?[]:Cv(t.g.bc,t.C,r,t.A,a,null,t.B)},0,null,this.o,n,this.h,this.j,c,"",null,null,es,this.s,0<i.Bb),n.codecs=l,n.mimeType=u,n.j=o,this.O[e]=n}return n},Dv.prototype.configure=function(e){this.o=e},Dv.prototype.destroy=function(){return this.A=this.o=null,this.i=[],this.h=null,this.m=[],this.F=[],this.l.clear(),null!=this.g&&(this.g.stop(),this.g=null),this.G.destroy()},Dv.prototype.setManifestType=function(e){this.s=e},Dv.prototype.banLocation=function(e){this.j.set(e,Date.now()+6e4)},i=Ov.prototype,i.release=function(){for(var e=c(this.h.concat(this.g,this.l,this.i)),t=e.next();!t.done;t=e.next())t=t.value,t.segmentIndex&&t.segmentIndex.release();this.h=[],this.g=[],this.l=[],this.i=[],this.j=[]},i.li=function(){return this.j},i.Gf=function(){return this.l.slice()},i.Uh=function(){return this.i},i.gf=function(e,t,n){n=void 0!==n&&n;var i,r,a,o,s,l,u,d,f,h,p,g,m,v,y,_,b,E,w,A,I,x,R,C,D,k,M,L,P,N,F=this;return O(function(O){if(1==O.g){if(i=Pn,!t&&1==e.length)return r=Fv(e,!1),a=r.xg,o=r.vh,s=r.sh,l=r.Sg,F.h=Array.from(a[0].values()),F.g=Array.from(o[0].values()),F.l=Array.from(s[0].values()),F.i=Array.from(l[0].values()),O.u(2);for(u=n?F.m.size:0,d=-1,f=0;f<e.length;f++)h=e[f],F.m.has(h.id)||(F.m.add(h.id),-1==d&&(d=f));return-1==d?O.return():(p=Fv(e,!0),g=p.xg,m=p.vh,v=p.sh,y=p.Sg,T(O,Promise.all([Bv(F,F.h,g,d,Kv,Zv,u),Bv(F,F.g,m,d,Kv,Zv,u),Bv(F,F.l,v,d,Kv,Zv,u),Bv(F,F.i,y,d,Kv,Zv,u)]),2))}if(_=0,b=[],F.g.length&&F.h.length)for(R=c(F.h),C=R.next();!C.done;C=R.next())for(D=C.value,k=c(F.g),M=k.next();!M.done;M=k.next())L=M.value,P=Mt(D.drmInfos,L.drmInfos),D.drmInfos.length&&L.drmInfos.length&&!P.length||(N=_++,b.push({id:N,language:D.language,disabledUntilTime:0,primary:D.primary,audio:D,video:L,bandwidth:(D.bandwidth||0)+(L.bandwidth||0),drmInfos:P,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]}));else for(E=F.g.length?F.g:F.h,w=c(E),A=w.next();!A.done;A=w.next())I=A.value,x=_++,b.push({id:x,language:I.language,disabledUntilTime:0,primary:I.primary,audio:I.type==i.X?I:null,video:I.type==i.ga?I:null,bandwidth:I.bandwidth||0,drmInfos:I.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});F.j=b,S(O)})},i.ih=function(e){this.o=e},i.ph=function(e){this.s=e},K("shaka.util.PeriodCombiner",Ov),Ov.prototype.setUseStreamOnce=Ov.prototype.ph,Ov.prototype.setAllowMultiTypeVariants=Ov.prototype.ih,Ov.prototype.combinePeriods=Ov.prototype.gf,Ov.prototype.getImageStreams=Ov.prototype.Uh,Ov.prototype.getTextStreams=Ov.prototype.Gf,Ov.prototype.getVariants=Ov.prototype.li;var py=1,gy=0,my=-1,vy=new Map;function yy(e,t){var n=new DOMParser,i=by.value()(e);e=null;try{e=n.parseFromString(i,"text/xml")}catch(e){return null}if(n=e.documentElement,!n||n.getElementsByTagName("parsererror").length||n.tagName!=t)return null;if(!("createNodeIterator"in document))return n;for(t=document.createNodeIterator(e,NodeFilter.SHOW_ALL);e=t.nextNode();)if(e instanceof HTMLElement||e instanceof SVGElement)return null;return n}function _y(e,t){try{var n=pn(e);return yy(n,t)}catch(e){return null}}var by=new Dt(function(){if("undefined"!==typeof trustedTypes){var e=trustedTypes.createPolicy("shaka-player#xml",{createHTML:function(e){return e}});return function(t){return e.createHTML(t)}}return function(e){return e}});function Ey(){var e=this;this.j=this.g=null,this.A=[],this.i=null,this.ea=1,this.B=[],this.l={we:"",type:"",profiles:[],Mb:null,Ia:0,Ga:null,Ld:0},this.o=new Map,this.s={},this.aa={},this.m=new Ov,this.H=0,this.da=new q(5),this.I=new Ft(function(){e.G&&!e.g.continueLoadingWhenPaused&&(e.C.lb(e.G,"timeupdate"),e.G.paused)?e.C.ha(e.G,"timeupdate",function(){return Fy(e)}):Fy(e)}),this.N=new Gr,this.L=null,this.fa=[],this.R=1/0,this.F=!1,this.h=null,this.K=0,this.U=!1,this.C=new ae,this.G=null,this.Z=!1}function Ty(e){var t,n,i,r,a,o,s,l,u,c;return O(function(d){return 1==d.g?(t=4,n="MPD",i=Wy(e),r=e.A,i.length?(r=i,n="Patch",t=6):1<e.A.length&&e.h&&(a=Nv(e.h,"Location",!0),a.length&&(r=a)),o=zr(r,e.g.retryParameters),s=Date.now(),T(d,Yy(e,o,0,{type:t}),2)):3!=d.g?(l=d.h,e.j?(l.uri&&l.uri!=l.originalUri&&!e.A.includes(l.uri)&&e.A.unshift(l.uri),T(d,Sy(e,l.data,l.uri,n),3)):d.return(0)):(u=Date.now(),c=(u-s)/1e3,e.da.sample(1,c),d.return(c))})}function Sy(e,t,n,i){var r,a,o,s,l,u,c,d,f,h;return O(function(p){if(1==p.g){if(r=t,a=e.g.dash.manifestPreprocessor,o=Oc,a!=o){if(pe("manifest.dash.manifestPreprocessor configuration","Please Use manifest.dash.manifestPreprocessorTXml instead."),s=_y(r,i),!s)throw new Rt(2,4,4001,n);a(s),r=gn(s.outerHTML)}if(l=Sa(r,i),!l)throw new Rt(2,4,4001,n);return u=e.g.dash.manifestPreprocessorTXml,c=Fc,u!=c&&u(l),"Patch"===i?p.return(Iy(e,l)):e.g.dash.disableXlinkProcessing?p.return(wy(e,l,n)):(d=e.g.dash.xlinkFailGracefully,f=Wm(l,e.g.retryParameters,d,n,e.j.networkingEngine),jr(e.N,f),T(p,f.promise,2))}return h=p.h,p.return(wy(e,h,n))})}function wy(e,t,n){var i,r,a,o,s,l,u,d,f,h,p,g,m,v,y,_,b,E,w,A,I,x,R,C,D,k,M,L,P,N,F,U,B,G,j,V,H,K,z,Z,q,Y,W,$,X,Q,J,ee,te,ne,ie,re,ae;return O(function(O){switch(O.g){case 1:for(e.h&&e.h.l.clear(),i=[n],r=[],a=new Map,o=Ca(t,"Location"),s=c(o),l=s.next();!l.done;l=s.next())u=l.value,d=u.attributes.serviceLocation,(f=ka(u))&&(h=xn(i,[f])[0],d&&(e.h?Pv(e.h,"Location",d,h):a.set(d,h)),r.push(h));if(e.h?(p=Nv(e.h,"Location",!0),0<p.length&&(i=e.A=p)):r.length&&(i=e.A=r),e.l.we=t.attributes.id||"",e.l.Ld=Na(t,"publishTime",Ba)||0,e.B=Ca(t,"PatchLocation"),g=Promise.resolve(),(m=La(t,"ContentSteering"))&&e.j)for(v=m.attributes.defaultServiceLocation,e.h?(e.h.i=i,e.h.h=v):(e.h=new Dv(e.j),e.h.configure(e.g),e.h.setManifestType("DASH"),e.h.i=i,e.h.h=v,(y=ka(m))&&(Na(m,"queryBeforeStart",Za,!1)?g=kv(e.h,y):kv(e.h,y))),_=c(a.keys()),b=_.next();!b.done;b=_.next())E=b.value,w=a.get(E),Pv(e.h,"Location",E,w);if(A=Ca(t,"BaseURL"),x=!1,e.h)for(R=c(A),C=R.next();!C.done;C=R.next())D=C.value,k=D.attributes.serviceLocation,M=ka(D),k&&M&&(Pv(e.h,"BaseURL",k,M),x=!0);if(x&&e.h||(L=A.map(ka),I=xn(i,L)),P=function(){return e.h&&x?Nv(e.h,"BaseURL"):I||[]},e.l.Ga=P,N=0,A&&A.length&&(N=Na(A[0],"availabilityTimeOffset",za)||0),e.l.Ia=N,F=e.g.dash.ignoreMinBufferTime,U=0,F||(U=Na(t,"minBufferTime",Ga)||0),e.H=Na(t,"minimumUpdatePeriod",Ga,-1),B=Na(t,"availabilityStartTime",Ba),G=Na(t,"timeShiftBufferDepth",Ga),j=e.g.dash.ignoreSuggestedPresentationDelay,V=null,j||(V=Na(t,"suggestedPresentationDelay",Ga)),H=e.g.dash.ignoreMaxSegmentDuration,K=null,H||(K=Na(t,"maxSegmentDuration",Ga)),z=t.attributes.type||"static",e.i&&e.i.presentationTimeline&&(e.Z=e.i.presentationTimeline.V()&&"static"==z),e.l.type=z,e.i)for(Z=e.i.presentationTimeline,q=c(Object.values(e.s)),Y=q.next();!Y.done;Y=q.next())W=Y.value,W.segmentIndex&&W.segmentIndex.Oa(Z.nb());else $=e.g.defaultPresentationDelay||1.5*U,X=null!=V?V:$,Z=new Ll(B,X,e.g.dash.autoCorrectDrift);return Z.wc("static"==z),Z.V()&&!isNaN(e.g.availabilityWindowOverride)&&(G=e.g.availabilityWindowOverride),null==G&&(G=1/0),Z.Ie(G),Q=t.attributes.profiles||"",e.l.profiles=Q.split(","),J={xb:"static"!=z,presentationTimeline:Z,va:null,ja:null,la:null,J:null,bandwidth:0,If:!1,Ia:N,Mb:null,profiles:Q.split(","),roles:null},e.K=0,ee=ky(e,J,P,t),te=ee.duration,ne=ee.periods,("static"!=z||e.Z)&&ee.Fg||Z.$a(te||1/0),e.U&&!e.F&&e.j.isAutoLowLatencyMode()&&(e.j.enableLowLatencyMode(),e.F=e.j.isLowLatencyMode()),e.F&&Z.jh(e.R),Z.Pf(K||1),T(O,g,2);case 2:return e.F&&(U=0,ie=null!=V?V:e.g.defaultPresentationDelay,Z.eg(ie)),e.i?(e.i.periodCount=ne.length,e.i.gapCount=e.K,T(O,Ay(e,ne,!1),4)):T(O,e.m.gf(ne,J.xb),6);case 6:if(e.i={presentationTimeline:Z,variants:e.m.j,textStreams:e.m.Gf(),imageStreams:e.m.i,offlineSessionIds:[],minBufferTime:U||0,sequenceMode:e.g.dash.sequenceMode,ignoreManifestTimestampsInSegmentsMode:!1,type:"DASH",serviceDescription:Cy(t),nextUrl:Dy(t),periodCount:ne.length,gapCount:e.K,isLowLatency:e.U},!Z.uh()){O.u(7);break}return re=Ca(t,"UTCTiming"),T(O,Ky(e,P,re),8);case 8:if(ae=O.h,!e.j)return O.return();Z.kh(ae);case 7:Z.re();case 4:e.j.makeTextStreamsForClosedCaptions(e.i),S(O)}})}function Ay(e,t,n){var i;return O(function(r){if(1==r.g)return T(r,e.m.gf(t,!0,n),2);e.i.variants=e.m.j,i=e.m.Gf(),0<i.length&&(e.i.textStreams=i),e.i.imageStreams=e.m.i,e.j.filter(e.i),S(r)})}function Iy(e,t){var n,i,r,a,o,s,l,u,f,h,p,g,m,v,y,_,b,E,w,A,I,x,R,C,D;return O(function(k){if(1==k.g){if(n=t.attributes.mpdId,i=Na(t,"originalPublishTime",Ba),!n||n!==e.l.we||i!==e.l.Ld)throw e.B=[],new Rt(1,4,4052);for(r=[],a=[],o=new Set,s=c(Ra(t)),l=s.next();!l.done;l=s.next())if(u=l.value,f=Ya(u.attributes.sel||""),h=f[f.length-1],p=ka(u)||"","MPD"===h.name)if("mediaPresentationDuration"===h.Vb){g=ka(u)||"";var M=Ga(g);if(null!=M){e.l.Mb=M;for(var L=c(e.o.values()),P=L.next();!P.done;P=L.next())P.value.Mb=M}}else if("type"===h.Vb){for(e.i.presentationTimeline.wc("static"==p),e.l.type=p,M=c(e.o.values()),L=M.next();!L.done;L=M.next())L.value.xb="dynamic"==p;"static"==p&&(e.H=-1)}else"publishTime"===h.Vb?e.l.Ld=Ba(p)||0:null===h.Vb&&"add"===u.tagName&&a.push(u);else if("PatchLocation"===h.name)Wa(e.B,u);else if("Period"===h.name){if("add"===u.tagName)a.push(u);else if("remove"===u.tagName&&h.id)for(M=h.id,e.i.periodCount--,L=c(e.o.keys()),P=L.next();!P.done;P=L.next())if(P=P.value,P.startsWith(M)){var N=e.o.get(P);qm(N,bv,"SegmentTimeline").children=[],Ry(e,P),e.o.delete(P)}}else if("SegmentTemplate"===h.name){if(L=Ya(u.attributes.sel||""),M=L[L.length-1],M.Vb){L=xy(e,L),P=ka(u)||"",N=c(L);for(var O=N.next();!O.done;O=N.next())O=e.o.get(O.value),$a(O.J.cc,u.tagName,M.Vb,P);M=L}else M=[];for(m=M,v=c(m),y=v.next();!y.done;y=v.next())_=y.value,o.add(_)}else if("SegmentTimeline"===h.name||"S"===h.name){for(M=Ya(u.attributes.sel||""),M=xy(e,M),L=c(M),P=L.next();!P.done;P=L.next())P=e.o.get(P.value),P=qm(P,bv,"SegmentTimeline"),N=Ca(P,"S"),Wa(N,u),P.children=N;for(b=M,E=c(b),y=E.next();!y.done;y=E.next())w=y.value,o.add(w)}for(A=c(o),y=A.next();!y.done;y=A.next())I=y.value,Ry(e,I);for(x=c(a),R=x.next();!R.done;R=x.next())C=R.value,r.push.apply(r,d(ky(e,{xb:"dynamic"==e.l.type,presentationTimeline:e.i.presentationTimeline,va:null,ja:null,la:null,J:null,bandwidth:0,If:!1,Ia:e.l.Ia,profiles:e.l.profiles,Mb:e.l.Mb,roles:null},e.l.Ga,C).periods));return r.length?(e.i.periodCount+=r.length,e.i.gapCount=e.K,T(k,Ay(e,r,!0),2)):k.u(2)}"static"==e.l.type&&(D=e.l.Mb,e.i.presentationTimeline.$a(D||1/0)),S(k)})}function xy(e,t){var n="",i="",r="";t=c(t);for(var a=t.next();!a.done;a=t.next())a=a.value,"Period"===a.name?n=a.id:"AdaptationSet"===a.name?i=a.id:"Representation"===a.name&&(r=a.id);if(t=[],r)t.push(n+","+r);else for(e=c(e.o.values()),r=e.next();!r.done;r=e.next())r=r.value,r.va.id===n&&r.la.id===i&&r.J.id&&t.push(n+","+r.J.id);return t}function Ry(e,t){var n=e.o.get(t),i=e.s[t];i.segmentIndex&&i.segmentIndex.Oa(e.i.presentationTimeline.nb());try{var r=_v(n,function(t,n,i,r){return Zy(e,t,n,i,r)},e.s,!0,e.g.dash.initialSegmentLimit,e.aa,n.J.aesKey,null,!0);i.createSegmentIndex=function(){var e;return O(function(t){if(1==t.g)return i.segmentIndex?t.u(0):(e=i,T(t,r.mc(),3));e.segmentIndex=t.h,S(t)})}}catch(e){if(t=n.J.contentType,t!=Ln&&"application"!=t&&"image"!=t||4002!=e.code)throw e}}function Cy(e){var t=La(e,"ServiceDescription");if(!t)return null;if(e=La(t,"Latency"),t=La(t,"PlaybackRate"),!e&&!t)return null;var n={};return e&&("target"in e.attributes&&(n.targetLatency=parseInt(e.attributes.target,10)/1e3),"max"in e.attributes&&(n.maxLatency=parseInt(e.attributes.max,10)/1e3),"min"in e.attributes&&(n.minLatency=parseInt(e.attributes.min,10)/1e3)),t&&("max"in t.attributes&&(n.maxPlaybackRate=parseFloat(t.attributes.max)),"min"in t.attributes&&(n.minPlaybackRate=parseFloat(t.attributes.min))),n}function Dy(e){if(e=Ca(e,"SupplementalProperty"),!e.length)return null;e=c(e);for(var t=e.next();!t.done;t=e.next())if(t=t.value,"urn:mpeg:dash:chaining:2016"==t.attributes.schemeIdUri)return t.attributes.value;return null}function ky(e,t,n,i){var r=t.Mb;r||(r=Na(i,"mediaPresentationDuration",Ga),e.l.Mb=r);var a=0;e.i&&e.i.presentationTimeline&&e.Z&&(a=e.i.presentationTimeline.Yb());var o=[],s=a;i=Ca(i,"Period");for(var l=0;l<i.length;l++){var u=i[l],c=i[l+1],d=Na(u,"start",Ga,s),f=u.attributes.id,h=Na(u,"duration",Ga),p=null;if(c){var g=Na(c,"start",Ga);null!=g&&(p=g-d)}else null!=r&&(p=r-d+a);if(g=Nn,p&&h&&Math.abs(p-h)>g&&p>h&&e.K++,null==p&&(p=h),!(null!==e.L&&null!==f&&null!==d&&d<e.L)||e.fa.includes(f)||l+1==i.length){if(null!==d&&(null===e.L||d>e.L)&&(e.L=d),s=My(e,t,n,{start:d,duration:p,node:u,Dd:null==p||!c}),o.push(s),t.va.id&&p&&(e.aa[t.va.id]=p),null==p){s=null;break}s=d+p}}return e.fa=o.map(function(e){return e.id}),null!=r?{periods:o,duration:r+a,Fg:!1}:{periods:o,duration:s,Fg:!0}}function My(e,t,n,i){t.va=By(e,i.node,null,n),t.ja=i,t.va.Ia=t.Ia,t.va.id||(t.va.id="__shaka_period_"+i.start);var r=Ca(i.node,"EventStream");n=t.presentationTimeline.nb(),r=c(r);for(var a=r.next();!a.done;a=r.next())zy(e,i.start,i.duration,a.value,n);if(n=Ca(i.node,"AdaptationSet").map(function(n){return Py(e,t,n)}).filter(si),t.xb){for(i=[],r=c(n),a=r.next();!a.done;a=r.next()){a=c(a.value.Ti);for(var o=a.next();!o.done;o=a.next())i.push(o.value)}if(i.length!=new Set(i).size)throw new Rt(2,4,4018)}for(i=n.filter(function(e){return!e.mg}),n=n.filter(function(e){return e.mg}),n=c(n),r=n.next();!r.done;r=n.next()){r=r.value,a=r.mg.split(" "),o=c(i);for(var s=o.next();!s.done;s=o.next()){var l=s.value;if(a.includes(l.id)){s={},l=c(l.streams);for(var u=l.next();!u.done;s={Zd:s.Zd},u=l.next())s.Zd=u.value,s.Zd.trickModeVideo=r.streams.find(function(e){return function(t){return Hn(e.Zd.codecs)==Hn(t.codecs)}}(s))}}}if(n=Ly(e.g.disableAudio,i,"audio"),r=Ly(e.g.disableVideo,i,"video"),a=Ly(e.g.disableText,i,Ln),i=Ly(e.g.disableThumbnails,i,"image"),0===r.length&&0===n.length)throw new Rt(2,4,4004);return{id:t.va.id,audioStreams:n,videoStreams:r,textStreams:a,imageStreams:i}}function Ly(e,t,n){return e||!t.length?[]:t.reduce(function(e,t){return t.contentType!=n?e:(e.push.apply(e,d(t.streams)),e)},[])}function Py(e,t,n){function i(e){switch(e){case 1:case 5:case 6:case 7:return"srgb";case 9:return"rec2020";case 11:case 12:return"p3"}}function r(e){switch(e){case 1:case 6:case 13:case 14:case 15:return"SDR";case 16:return"PQ";case 18:return"HLG"}}t.la=By(e,n,t.va,null);var a,o,s=!1,l=Ca(n,"Role"),u=l.map(function(e){return e.attributes.value}).filter(si),f=void 0,h=t.la.contentType==Ln;h&&(f="subtitle"),l=c(l);for(var p=l.next();!p.done;p=l.next()){p=p.value;var g=p.attributes.schemeIdUri;if(null==g||"urn:mpeg:dash:role:2011"==g)switch(p=p.attributes.value,p){case"main":s=!0;break;case"caption":case"subtitle":f=p}}g=Ca(n,"EssentialProperty"),l=null;var m=!1;p=!1,g=c(g);for(var v=g.next();!v.done;v=g.next()){v=v.value;var y=v.attributes.schemeIdUri;"http://dashif.org/guidelines/trickmode"==y?l=v.attributes.value:"urn:mpeg:mpegB:cicp:TransferCharacteristics"==y?a=r(parseInt(v.attributes.value,10)):"urn:mpeg:mpegB:cicp:ColourPrimaries"==y?o=i(parseInt(v.attributes.value,10)):"urn:mpeg:mpegB:cicp:MatrixCoefficients"!=y&&("urn:mpeg:dash:ssr:2023"==y&&e.g.dash.enableFastSwitching?m=!0:p=!0)}var _=null;for(g=Ca(n,"SupplementalProperty"),g=c(g),v=g.next();!v.done;v=g.next())v=v.value,y=v.attributes.schemeIdUri,"http://dashif.org/guidelines/last-segment-number"==y?_=parseInt(v.attributes.value,10)-1:"urn:mpeg:mpegB:cicp:TransferCharacteristics"==y?a=r(parseInt(v.attributes.value,10)):"urn:mpeg:mpegB:cicp:ColourPrimaries"==y&&(o=i(parseInt(v.attributes.value,10)));g=Ca(n,"Accessibility");var b,E=new Map;for(g=c(g),v=g.next();!v.done;v=g.next())if(y=v.value,v=y.attributes.schemeIdUri,y=y.attributes.value,"urn:scte:dash:cc:cea-608:2015"!=v||e.g.disableText)if("urn:scte:dash:cc:cea-708:2015"!=v||e.g.disableText)"urn:mpeg:dash:role:2011"==v?null!=y&&(u.push(y),"captions"==y&&(f="caption")):"urn:tva:metadata:cs:AudioPurposeCS:2007"==v&&("1"==y?b="visually impaired":"2"==y&&(b="hard of hearing"));else if(v=1,null!=y)for(y=c(y.split(";")),w=y.next();!w.done;w=y.next()){w=w.value;var T=void 0,S=void 0;w.includes("=")?(w=w.split("="),T="svc"+w[0],S=w[1].split(",")[0].split(":").pop()):(T="svc"+v,v++,S=w),E.set(T,fi(S))}else E.set("svc1","und");else if(v=1,null!=y){y=y.split(";"),T=c(y);for(var w=T.next();!w.done;w=T.next()){S=w.value;var A=w=void 0;S.includes("=")?(S=S.split("="),w=S[0].startsWith("CC")?S[0]:"CC"+S[0],A=S[1]||"und"):(w="CC"+v,2==y.length?v+=2:v++,A=S),E.set(w,fi(A))}}else E.set("CC1","und");if(p)return null;p=Ca(n,"ContentProtection");var I=Mm(p,e.g.dash.ignoreDrmInfo,e.g.dash.keySystemsByURI),x=fi(t.la.language||"und"),R=t.la.label;if(p=Ca(n,"Representation"),n=p.map(function(n){return(n=Ny(e,t,I,f,x,R,s,u,E,n,b,_))&&(n.hdr=n.hdr||a,n.colorGamut=n.colorGamut||o,n.fastSwitching=m),n}).filter(function(e){return!!e}),0==n.length){if(l="image"==t.la.contentType,e.g.dash.ignoreEmptyAdaptationSet||h||l)return null;throw new Rt(2,4,4003)}if(!t.la.contentType||"application"==t.la.contentType)for(t.la.contentType=qy(n[0].mimeType,n[0].codecs),h=c(n),v=h.next();!v.done;v=h.next())v.value.type=t.la.contentType;for(h=t.la.id||"__fake__"+e.ea++,g=c(n),v=g.next();!v.done;v=g.next()){for(v=v.value,y=c(I.drmInfos),T=y.next();!T.done;T=y.next())T=T.value,T.keyIds=T.keyIds&&v.keyIds?new Set([].concat(d(T.keyIds),d(v.keyIds))):T.keyIds||v.keyIds;e.g.dash.enableAudioGroups&&(v.groupId=h)}return p=p.map(function(e){return e.attributes.id}).filter(si),{id:h,contentType:t.la.contentType,language:x,lk:s,streams:n,drmInfos:I.drmInfos,mg:l,Ti:p}}function Ny(t,n,i,r,a,o,s,l,u,c,d,f){n.J=By(t,c,n.la,null);var h=n.J.id;if(t.R=Math.min(t.R,n.J.Ia),t.U=0<t.R,!Vy(n.J))return null;var p=n.ja.start;n.bandwidth=Na(c,"bandwidth",Ha)||0,n.roles=l;var g,m,v=n.J.contentType,y=v==Ln||"application"==v;v="image"==v;try{var _=void 0;if(i.bf){var b=n.J.Ga,E=xn(b(),[i.bf.Ai]),w=zr(E,t.g.retryParameters);_={bitsKey:128,blockCipherMode:"CBC",iv:i.bf.iv,firstMediaSequenceNumber:0,fetchKey:function(){var n,i,r;return O(function(a){if(1==a.g)return T(a,Yy(t,w,6),2);if(3!=a.g){if(n=a.h,!n.data||16!=n.data.byteLength)throw new Rt(2,4,4049);return i={name:"AES-CBC"},r=_,T(a,e.crypto.subtle.importKey("raw",n.data,i,!0,["decrypt"]),3)}r.cryptoKey=a.h,_.fetchKey=void 0,S(a)})}}}if(n.J.aesKey=_,b=function(e,n,i,r){return Zy(t,e,n,i,r)},n.J.Tc)var A=sv(n,b,_);else if(n.J.Rb)A=pv(n,t.s,_);else if(n.J.cc)A=_v(n,b,t.s,!!t.i,t.g.dash.initialSegmentLimit,t.aa,_,f,!1);else{var I=n.ja.duration||0,x=n.J.Ga,R=n.J.mimeType,C=n.J.codecs;A={mc:function(){var e=nu(p,I,x());return e.Jb(function(e){e.mimeType=R,e.codecs=C}),Promise.resolve(e)}}}}catch(e){if((y||v)&&4002==e.code)return null;throw e}if(f=Ca(c,"ContentProtection"),f=Lm(f,i,t.g.dash.ignoreDrmInfo,t.g.dash.keySystemsByURI),f=new Set(f?[f]:[]),b=!1,Ca(c,"SupplementalProperty").some(function(e){return"tag:dolby.com,2018:dash:EC3_ExtensionType:2018"==e.attributes.schemeIdUri&&"JOC"==e.attributes.value})&&(b=!0),E=!1,y&&(E=l.includes("forced_subtitle")||l.includes("forced-subtitle")),v&&((c=Ca(c,"EssentialProperty").find(function(e){return["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"].includes(e.attributes.schemeIdUri)}))&&(g=c.attributes.value),!g))return null;c=n.J.codecs,n.profiles.includes("http://dashif.org/guidelines/dash-if-uhd#hevc-hdr-pq10")&&(c.includes("hvc1.2.4.L153.B0")||c.includes("hev1.2.4.L153.B0"))&&(m="PQ"),y=n.J.id?n.va.id+","+n.J.id:"",t.B.length&&h&&t.o.set(n.va.id+","+h,Oy(n));var D=y&&t.s[y]?t.s[y]:{id:t.ea++,originalId:n.J.id,groupId:null,createSegmentIndex:function(){return Promise.resolve()},closeSegmentIndex:function(){D.segmentIndex&&(D.segmentIndex.release(),D.segmentIndex=null)},segmentIndex:null,mimeType:n.J.mimeType,codecs:c,frameRate:n.J.frameRate,pixelAspectRatio:n.J.pixelAspectRatio,bandwidth:n.bandwidth,width:n.J.width,height:n.J.height,kind:r,encrypted:0<i.drmInfos.length,drmInfos:i.drmInfos,keyIds:f,language:a,originalLanguage:n.la.language,label:o,type:n.la.contentType,primary:s,trickModeVideo:null,emsgSchemeIdUris:n.J.emsgSchemeIdUris,roles:l,forced:E,channelsCount:n.J.Nc,audioSamplingRate:n.J.audioSamplingRate,spatialAudio:b,closedCaptions:u,hdr:m,colorGamut:void 0,videoLayout:void 0,tilesLayout:g,accessibilityPurpose:d,external:!1,fastSwitching:!1,fullMimeTypes:new Set([Un(n.J.mimeType,n.J.codecs)])};return D.createSegmentIndex=function(){var e;return O(function(t){if(1==t.g)return D.segmentIndex?t.u(0):(e=D,T(t,A.mc(),3));e.segmentIndex=t.h,S(t)})},y&&n.xb&&!t.s[y]&&(t.s[y]=D),D}function Oy(e){for(var t={},n=c(Object.keys(e)),i=n.next();!i.done;i=n.next())if(i=i.value,["period","adaptationSet","representation"].includes(i)){var r=e[i];t[i]={Tc:null,Rb:null,cc:r.cc,Ga:r.Ga,width:r.width,height:r.height,contentType:r.contentType,mimeType:r.mimeType,language:r.language,codecs:r.codecs,frameRate:r.frameRate,pixelAspectRatio:r.pixelAspectRatio,emsgSchemeIdUris:r.emsgSchemeIdUris,id:r.id,Nc:r.Nc,audioSamplingRate:r.audioSamplingRate,Ia:r.Ia,Jc:r.Jc}}else"periodInfo"==i?(r=e[i],t[i]={start:r.start,duration:r.duration,node:null,Dd:r.Dd}):t[i]=e[i];return t}function Fy(e){var t,n;return O(function(i){switch(i.g){case 1:return t=0,w(i,2),T(i,Ty(e),4);case 4:t=i.h,I(i,3);break;case 2:if(n=x(i),e.j){if(e.g.raiseFatalErrorOnManifestUpdateRequestFailure)return e.j.onError(n),i.return();n.severity=1,e.j.onError(n)}case 3:if(!e.j)return i.return();e.j.onManifestUpdated(),Uy(e,t),S(i)}})}function Uy(e,t){if(!(0>e.H)){var n=e.H;0<=e.g.dash.updatePeriod&&(n=e.g.dash.updatePeriod),e.I.Y(Math.max(n-t,Y(e.da)))}}function By(e,t,n,i){n=n||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,pixelAspectRatio:void 0,Nc:null,audioSamplingRate:null,Ia:0,ag:0},i=i||n.Ga;var r,a=t.attributes.id,o=Ca(t,"BaseURL"),s=!1;if(e.h)for(var l=c(o),u=l.next();!u.done;u=l.next()){var d=u.value;u=d.attributes.serviceLocation,d=ka(d),u&&d&&(Pv(e.h,a,u,d),s=!0)}s&&e.h||(r=o.map(ka)),l=t.attributes.contentType||n.contentType,u=t.attributes.mimeType||n.mimeType,d=[t.attributes.codecs||n.codecs];var f=Oa(t,"urn:scte:dash:scte214-extensions","supplementalCodecs");f&&d.push(f),d=Ou(d).join(","),f=Na(t,"frameRate",qa)||n.frameRate;var h=t.attributes.sar||n.pixelAspectRatio,p=Gy(Ca(t,"InbandEventStream"),n.emsgSchemeIdUris),g=Ca(t,"AudioChannelConfiguration");g=jy(g)||n.Nc;var m=Na(t,"audioSamplingRate",Ka)||n.audioSamplingRate;l||(l=qy(u,d));var v=La(t,"SegmentBase"),y=La(t,"SegmentTemplate"),_=v&&Na(v,"availabilityTimeOffset",za)||0,b=y&&Na(y,"availabilityTimeOffset",za)||0,E=o&&o.length&&Na(o[0],"availabilityTimeOffset",za)||0;_=n.Ia+E+_+b,b=null,(E=La(t,"SegmentSequenceProperties"))&&(E=La(E,"SAP"))&&(b=Na(E,"cadence",Va)),E=t.attributes.label;var T=Ca(t,"Label");return T&&T.length&&(T=T[0],Da(T)&&(E=Da(T))),{Ga:function(){return xn(i(),o.length?e.h&&s?Nv(e.h,a):r||[]:[])},Tc:v||n.Tc,Rb:La(t,"SegmentList")||n.Rb,cc:y||n.cc,width:Na(t,"width",Ka)||n.width,height:Na(t,"height",Ka)||n.height,contentType:l,mimeType:u,codecs:d,frameRate:f,pixelAspectRatio:h,emsgSchemeIdUris:p,id:a,language:t.attributes.lang,Nc:g,audioSamplingRate:m,Ia:_,Jc:null,ag:b||n.ag,label:E||null}}function Gy(e,t){t=t.slice(),e=c(e);for(var n=e.next();!n.done;n=e.next())n=n.value.attributes.schemeIdUri,t.includes(n)||t.push(n);return t}function jy(e){e=c(e);for(var t=e.next();!t.done;t=e.next()){var n=t.value;if((t=n.attributes.schemeIdUri)&&(n=n.attributes.value))switch(t){case"urn:mpeg:dash:outputChannelPositionList:2012":return n.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":if(t=parseInt(n,10),!t)continue;return t;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(t=parseInt(n,16),!t)continue;for(e=0;t;)1&t&&++e,t>>=1;return e;case"urn:mpeg:mpegB:cicp:ChannelConfiguration":if(t=[0,1,2,3,4,5,6,8,2,3,4,7,8,24,8,12,10,12,14,12,14],(n=parseInt(n,10))&&0<n&&n<t.length)return t[n]}}return null}function Vy(e){var t=e.Tc?1:0;return t+=e.Rb?1:0,t+=e.cc?1:0,0==t?e.contentType==Ln||"application"==e.contentType:(1!=t&&(e.Tc&&(e.Rb=null),e.cc=null),!0)}function Hy(e,t,n,i){var r,a,o,s,l,u,c;return O(function(d){if(1==d.g)return r=[yn(n)],a=xn(t(),r),o=zr(a,e.g.retryParameters),o.method=i,s=e.j.networkingEngine.request(4,o),jr(e.N,s),T(d,s.promise,2);if(l=d.h,"HEAD"==i){if(!l.headers||!l.headers.date)return d.return(0);u=l.headers.date}else u=fn(l.data);return c=Date.parse(u),isNaN(c)?d.return(0):d.return(c-Date.now())})}function Ky(e,t,n){var i,r,a,o,s,l,u,d;return O(function(f){switch(f.g){case 1:i=n.map(function(e){return{scheme:e.attributes.schemeIdUri,value:e.attributes.value}}),r=e.g.dash.clockSyncUri,!i.length&&r&&i.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:r}),a=c(i),o=a.next();case 2:if(o.done){f.u(4);break}switch(s=o.value,w(f,5),l=s.scheme,u=s.value,l){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return f.u(7);case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return f.u(8);case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return d=Date.parse(u),f.return(isNaN(d)?0:d-Date.now());case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":Q("NTP UTCTiming scheme is not supported");break;default:Q("Unrecognized scheme in UTCTiming element",l)}f.u(9);break;case 7:return T(f,Hy(e,t,u,"HEAD"),10);case 10:return f.return(f.h);case 8:return T(f,Hy(e,t,u,"GET"),11);case 11:return f.return(f.h);case 9:I(f,3);break;case 5:x(f);case 3:o=a.next(),f.u(2);break;case 4:return Q("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),f.return(0)}})}function zy(e,t,n,i,r){var a=i.attributes.schemeIdUri||"",o=i.attributes.value||"",s=Na(i,"timescale",Ka)||1;i=c(Ca(i,"Event"));for(var l=i.next();!l.done;l=i.next()){l=l.value;var u=Na(l,"presentationTime",Ka)||0,d=Na(l,"duration",Ka)||0;u=u/s+t,d=u+d/s,null!=n&&(u=Math.min(u,t+n),d=Math.min(d,t+n)),d<r||(l={schemeIdUri:a,value:o,startTime:u,endTime:d,id:l.attributes.id||"",eventElement:Xa(l),eventNode:l},e.j.onTimelineRegionAdded(l))}}function Zy(e,t,n,i,r){var a,o,s,l;return O(function(u){return 1==u.g?(a=Qr,o=r?0:1,s=Gu(t,n,i,e.g.retryParameters),T(u,Yy(e,s,a,{type:o}),2)):(l=u.h,u.return(l.data))})}function qy(e,t){return t=Un(e,t),Qn(t)?Ln:e.split("/")[0]}function Yy(e,t,n,i){return t=e.j.networkingEngine.request(n,t,i),jr(e.N,t),t.promise}function Wy(e){var t=e.l.Ld;if(!e.l.we||!t||!e.B.length)return[];var n=Date.now()/1e3,i=e.B.filter(function(e){return e=Ka(e.attributes.ttl),!e||t+e>n}).map(ka).filter(si);return i.length?xn(e.A,i):[]}function $y(){}i=Ey.prototype,i.configure=function(e){var t=this.j&&e.dash.updatePeriod!=this.g.dash.updatePeriod&&0<=e.dash.updatePeriod;this.g=e,t&&this.i&&this.i.presentationTimeline.V()&&this.I.xc(),this.h&&this.h.configure(this.g),this.m&&(this.m.ih(this.g.dash.multiTypeVariantsAllowed&&de()),this.m.ph(this.g.dash.useStreamOnceInPeriodFlattening))},i.start=function(e,t){var n,i=this;return O(function(r){if(1==r.g)return i.F=t.isLowLatencyMode(),i.A=[e],i.j=t,T(r,Ty(i),2);if(n=r.h,i.j&&Uy(i,n),!i.j)throw new Rt(2,7,7001);return r.return(i.i)})},i.stop=function(){for(var e=c(Object.values(this.s)),t=e.next();!t.done;t=e.next())t=t.value,t.segmentIndex&&t.segmentIndex.release();return this.m&&this.m.release(),this.g=this.j=null,this.A=[],this.i=null,this.s={},this.o.clear(),this.l={we:"",type:"",profiles:[],Mb:null,Ia:0,Ga:null,Ld:0},this.m=null,null!=this.I&&(this.I.stop(),this.I=null),this.h&&this.h.destroy(),this.C&&(this.C.release(),this.C=null),this.N.destroy()},i.update=function(){var e,t=this;return O(function(n){return 1==n.g?(w(n,2),T(n,Ty(t),4)):2!=n.g?I(n,0):(e=x(n),t.j&&e?(t.j.onError(e),void S(n)):n.return())})},i.onExpirationUpdated=function(){},i.onInitialVariantChosen=function(e){if(this.i&&this.i.presentationTimeline.V()){var t=e.video||e.audio;if(t&&t.segmentIndex){e=this.i.presentationTimeline.Zb();var n=t.segmentIndex.find(e);null!=n&&(t=t.segmentIndex.get(n))&&(this.H=t.endTime-e,Uy(this,0))}}},i.banLocation=function(e){this.h&&this.h.banLocation(e)},i.setMediaElement=function(e){this.G=e},K("shaka.dash.DashParser",Ey),zo["application/dash+xml"]=function(){return new Ey},zo["video/vnd.mpeg.dash.mpd"]=function(){return new Ey},K("shaka.dependencies",$y),$y.has=function(e){return Jy.has(e)},$y.add=function(e,t){if(!Qy[e])throw Error(e+" is not supported");e==Xy?pe("mux.js","mux.js is no longer used in Shaka Player."):Jy.set(e,function(){return t})};var Xy="muxjs",Qy={mk:Xy,ISOBoxer:"ISOBoxer"};$y.Allowed=Qy;var Jy=new Map([["ISOBoxer",function(){return e.ISOBoxer}]]);function e_(e,t,n){this.type=e,this.g=t,this.segments=n||null}function t_(e,t,n,i){this.id=e,this.name=t,this.attributes=n,this.value=void 0===i?null:i}function n_(e){var t=(new Set).add("AUDIO").add("VIDEO").add("SUBTITLES").add("PATHWAY-ID").add("GROUP-ID").add("URI");return e.toString(t)}function i_(e,t){return e=e.attributes.filter(function(e){return e.name==t}),e.length?e[0]:null}function r_(e,t,n){return(e=i_(e,t))?e.value:n||null}function a_(e,t){if(e=i_(e,t),!e)throw new Rt(2,4,4023,t);return e.value}function o_(e,t,n){n=void 0===n?[]:n,this.g=t,this.h=e,this.Bb=n}function s_(e,t){this.name=e,this.value=t}function l_(e,t){return e.filter(function(e){return e.name==t})}function u_(e,t){return e.filter(function(e){return a_(e,"TYPE")==t})}function c_(e,t){e=c(e);for(var n=e.next();!n.done;n=e.next())if(n=n.value,n.name===t)return n;return null}function d_(e,t,n){return n=void 0===n?0:n,(e=c_(e,t))?Number(e.value):n}function f_(e,t,n){return t?h_(e,[t],n):[]}function h_(e,t,n){if(!t.length)return[];t=xn(e,t),e=[],t=c(t);for(var i=t.next();!i.done;i=t.next())e.push(p_(i.value,n));return e}function p_(e,t){if(!t||!t.size)return e;e=String(e).replace(/%7B/g,"{").replace(/%7D/g,"}");var n=e.match(/{\$\w*}/g);if(n){n=c(n);for(var i=n.next();!i.done;i=n.next()){i=i.value;var r=i.slice(2,i.length-1),a=t.get(r);if(!a)throw new Rt(2,4,4039,r);e=e.replace(i,a)}}return e}function g_(){this.g=0}function m_(e,t){t=fn(t),t=t.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim();var n=t.split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(n[0]))throw new Rt(2,4,4015);t=0;for(var i=!0,r=c(n),a=r.next();!a.done;a=r.next())if(a=a.value,/^#(?!EXT)/m.test(a)||i)i=!1;else{if(a=v_(e,a),--e.g,y_.includes(a.name)){t=1;break}"EXT-X-STREAM-INF"==a.name&&(i=!0)}for(r=[],i=!0,a=0;a<n.length;a++){var o=n[a],s=n[a+1];if(/^#(?!EXT)/m.test(o)||i)i=!1;else{if(o=v_(e,o),__.includes(o.name)){if(1!=t)throw new Rt(2,4,4017);o=n.splice(a,n.length-a),n=[],i=[],a=[],s=null,o=c(o);for(var l=o.next();!l.done;l=o.next())l=l.value,/^(#EXT)/.test(l)?(l=v_(e,l),y_.includes(l.name)?r.push(l):"EXT-X-MAP"==l.name?s=l:"EXT-X-PART"==l.name?a.push(l):"EXT-X-PRELOAD-HINT"==l.name?"PART"==r_(l,"TYPE")?a.push(l):"MAP"==r_(l,"TYPE")&&(l.name="EXT-X-MAP",s=l):i.push(l)):/^#(?!EXT)/m.test(l)||(l=l.trim(),s&&i.push(s),n.push(new o_(l,i,a)),i=[],a=[]);return a.length&&(s&&i.push(s),n.push(new o_("",i,a))),new e_(t,r,n)}r.push(o),"EXT-X-STREAM-INF"==o.name&&(o.attributes.push(new s_("URI",s)),i=!0)}}return new e_(t,r)}function v_(e,t){e=e.g++;var n=t.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!n)throw new Rt(2,4,4016,t);t=n[1];var i,r=n[2];if(n=[],r){var a;r=new Gh(r),(a=Vh(r,/^([^,=]+)(?:,|$)/g))&&(i=a[1]);for(var o=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;a=Vh(r,o);)n.push(new s_(a[1],a[2]||a[3])),jh(r)}return new t_(e,t,n,i)}t_.prototype.toString=function(e){function t(e){return e.name+"="+(isNaN(Number(e.value))?'"'+e.value+'"':e.value)}var n="#"+this.name,i=this.attributes?this.attributes.filter(function(t){return!e||!e.has(t.name)}).map(t):[];return this.value&&i.unshift(this.value),0<i.length&&(n+=":"+i.join(",")),n};var y_="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST EXT-X-SERVER-CONTROL EXT-X-SKIP EXT-X-PART-INF EXT-X-DATERANGE".split(" "),__="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE EXT-X-MAP EXT-X-GAP".split(" ");function b_(){}function E_(e){try{var t=T_(e);return Mr({uri:e,originalUri:e,data:t.data,headers:{"content-type":t.contentType}})}catch(e){return Dr(e)}}function T_(t){var n=t.split(":");if(2>n.length||"data"!=n[0])throw new Rt(2,1,1004,t);if(n=n.slice(1).join(":").split(","),2>n.length)throw new Rt(2,1,1004,t);var i=n[0];t=e.decodeURIComponent(n.slice(1).join(",")),n=i.split(";"),i=n[0];var r,a=!1;return 1<n.length&&"base64"==n[n.length-1]&&(a=!0,n.pop()),r=a?Sn(t):gn(t),{data:r,contentType:i}}function S_(){var e=this;this.g=this.h=null,this.B=1,this.s=new Map,this.G=new Map,this.N=new Map,this.N.set("video",new Map),this.N.set("audio",new Map),this.N.set(Ln,new Map),this.N.set("image",new Map),this.wb=new Set,this.i=new Map,this.j=null,this.L="",this.Fa=new g_,this.H=-1,this.fa=1/0,this.ea=this.Ib=!1,this.A=new Ft(function(){e.aa&&!e.g.continueLoadingWhenPaused&&(e.Z.lb(e.aa,"timeupdate"),e.aa.paused)?e.Z.ha(e.aa,"timeupdate",function(){return Sb(e)}):Sb(e)}),this.xa=Lb,this.m=null,this.bb=0,this.o=1/0,this.Da=this.za=this.U=0,this.da=new Gr,this.C=new Map,this.F=new Map,this.ra=new Map,this.pa=new Map,this.K=new Map,this.qa=new Map,this.ya=new Map,this.Hb=this.I=!1,this.Fb=new q(5),this.l=null,this.R=!0,this.Ea=new Set,this.Z=new ae,this.aa=null}function w_(e,t){return wb(e)?e.N.get(t.type):t.te}function A_(e,t){var n,i,r,a,o,s,l,u,f,h,p,g,m,v,y,_,b,E,A,R,C,D,k,M,L,P,N,F,U,B,G,j,V,H;return O(function(O){switch(O.g){case 1:for(n=[],i=c(t.M()),r=i.next();!r.done;r=i.next())a=r.value,o=new ft(a),s=o.g,t.ce&&(0<=t.pb&&s.add("_HLS_msn",String(t.pb)),0<=t.qb&&s.add("_HLS_part",String(t.qb))),t.de&&s.add("_HLS_skip","YES"),xt(s)&&mt(o,s),n.push(o.toString());return w(O,2),T(O,Tb(e,n,!0),4);case 4:l=O.h,I(O,3);break;case 2:throw u=x(O),e.h&&e.h.disableStream(t.stream),u;case 3:if(!t.stream.segmentIndex)return O.return();if(f=m_(e.Fa,l.data),1!=f.type)throw new Rt(2,4,4017);return h=l.uri,h==l.originalUri||t.M().includes(h)||t.dh.push(h),p=l_(f.g,"EXT-X-DEFINE"),g=L_(e,p,h),m=t.stream,v=w_(e,t),T(O,sb(e,f,m.mimeType,t.M,g),5);case 5:for(y=O.h,_=y.keyIds,b=y.drmInfos,E=function(e,t){return e.size===t.size&&[].concat(d(e)).every(function(e){return t.has(e)})},E(m.keyIds,_)||(m.keyIds=_,m.drmInfos=b,e.h.newDrmInfo(m)),A=mb(e,f,v,g,t.M,t.type),R=A.segments,(C=A.bandwidth)&&(m.bandwidth=C),D=Lu(m),k=c(R),M=k.next();!M.done;M=k.next())L=M.value,L.$&&(L.$.Lc=D);m.segmentIndex.Id(R,e.j.nb()),R.length&&(P=d_(f.g,"EXT-X-MEDIA-SEQUENCE",0),F=(N=c_(f.g,"EXT-X-SKIP"))?Number(r_(N,"SKIPPED-SEGMENTS")):0,U=ab(P,R),B=U.pb,G=U.qb,t.pb=B+F,t.qb=G,j=v.get(P),m.segmentIndex.Oa(j)),(V=m.segmentIndex.O[0]||null)&&(t.rc=V.startTime,H=R[R.length-1],t.Lb=H.endTime),c_(f.g,"EXT-X-ENDLIST")&&(t.xd=!0),ub(e,f),gb(e,f.g,m.type,g,t.M),S(O)}})}function I_(e,t){for(var n=-1==e.H,i=c(t),r=i.next();!r.done;r=i.next()){r=r.value;var a=r.stream.segmentIndex,o=w_(e,r);if(a=a.O[0]||null){o=c(o);for(var s=o.next();!s.done;s=o.next()){s=c(s.value);var l=s.next().value;if(s.next().value==a.startTime){n&&(e.H=Math.max(e.H,l)),r.mf=l;break}}}}if(!(0>e.H))for(t=c(t),r=t.next();!r.done;r=t.next())n=r.value,nb(e,n.type)&&(i=n.stream.segmentIndex)&&(r=e.H-n.mf,0<r&&(i.O.splice(0,r),i=i.O[0]||null)&&(i=-i.startTime,n.stream.segmentIndex.offset(i),R_(e,n,i)))}function x_(e,t){if(1/0==e.fa){t=c(t);for(var n=t.next();!n.done;n=t.next()){var i=n.value.stream.segmentIndex.O[0]||null;null!=i&&null!=i.h&&(e.fa=Math.min(e.fa,i.h))}}if(t=e.fa,1/0!=t)for(i=c(e.i.values()),n=i.next();!n.done;n=i.next())if(n=n.value,!nb(e,n.type)){var r=n.stream.segmentIndex;if(null!=r){var a=r.O[0]||null;if(null==a.h)X("Missing EXT-X-PROGRAM-DATE-TIME for stream",n.M(),"Expect AV sync issues!");else for(R_(e,n,a.h-t-a.startTime),n=c(r),r=n.next();!r.done;r=n.next())r.value.jg(t)}}}function R_(e,t,n){t.rc+=n,t.Lb+=n,e=w_(e,t);for(var i=c(e),r=i.next();!r.done;r=i.next()){var a=c(r.value);r=a.next().value,a=a.next().value,e.set(r,a+n)}t.M()}function C_(e,t,n){var i,r,a,o,s,l,u,d,f,h,p,g,m,v,y,_,b,E,S,w,A,I,x,R,C,D,k,M,L,P,N,F;return O(function(O){switch(O.g){case 1:return i=Pn,r=m_(e.Fa,t),a=l_(r.g,"EXT-X-DEFINE"),o=[],s=[],l=[],e.j=new Ll(null,0),e.j.wc(!0),u=function(){return[n]},d=null,f=new Map,1==r.type?(e.R=!1,b=l_(r.g,"EXT-X-DEFINE"),f=L_(e,b,e.L),d=i.ga,E="",S=new Map,T(O,rb(e,e.B++,f,r,u,"",d,E,!0,"Media Playlist",null,S,null,!1,null,!1),7)):(M_(e,a),h=l_(r.g,"EXT-X-MEDIA"),p=l_(r.g,"EXT-X-STREAM-INF"),g=l_(r.g,"EXT-X-IMAGE-STREAM-INF"),m=l_(r.g,"EXT-X-I-FRAME-STREAM-INF"),v=l_(r.g,"EXT-X-SESSION-KEY"),y=l_(r.g,"EXT-X-SESSION-DATA"),_=l_(r.g,"EXT-X-CONTENT-STEERING"),N_(e,y),T(O,O_(e,_),4));case 4:return P_(e,p),Y_(e,h),T(O,j_(e,p,v,h,u,e.s),5);case 5:return o=O.h,s=F_(e,h),T(O,B_(e,g,m),6);case 6:l=O.h,O.u(3);break;case 7:w=O.h,e.i.set(n,w),w.stream&&(A=Lu(w.stream),w.stream.segmentIndex.Jb(function(e){e.$&&(e.$.Lc=A)})),d=w.stream.type,o.push({id:0,language:fi(E||"und"),disabledUntilTime:0,primary:!0,audio:"audio"==d?w.stream:null,video:"video"==d?w.stream:null,bandwidth:w.stream.bandwidth||0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});case 3:if(!e.h)throw new Rt(2,7,7001);if(1==r.type&&(wb(e)&&(cb(e,r),I=e.o,e.A.Y(I)),x=Array.from(e.i.values()),tb(e,x),k_(e),gb(e,r.g,d,f,u)),e.m={presentationTimeline:e.j,variants:o,textStreams:s,imageStreams:l,offlineSessionIds:[],minBufferTime:0,sequenceMode:e.g.hls.sequenceMode,ignoreManifestTimestampsInSegmentsMode:e.g.hls.ignoreManifestTimestampsInSegmentsMode,type:"HLS",serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1},e.ea||!e.g.hls.disableCodecGuessing){O.u(8);break}for(R=[],C=c(e.m.variants),D=C.next();!D.done;D=C.next())k=D.value,k.audio&&""===k.audio.codecs&&R.push(k.audio.createSegmentIndex()),k.video&&""===k.video.codecs&&R.push(k.video.createSegmentIndex());return T(O,Promise.all(R),8);case 8:if(e.h.makeTextStreamsForClosedCaptions(e.m),1==o.length){for(M=[],L=o[0],P=c([L.video,L.audio]),N=P.next();!N.done;N=P.next())(F=N.value)&&!F.segmentIndex&&M.push(F.createSegmentIndex());if(0<M.length)return T(O,Promise.all(M),0)}O.u(0)}})}function D_(e,t){var n,i,r,a,o,s,l,u,d,f,h,p,g,m,v,y,_,b,E,S,w,A,I;return O(function(x){switch(x.g){case 1:if(n=Pu(e.g.hls.mediaPlaylistFullMimeType),!t.length)return x.return(n);if(i=_b(e,t),r=i.segment,a=i.segmentIndex,o=r.M(),s=o[0],l=new ft(s),u=l.Pa.split(".").pop(),d=Cb[u])return x.return(Pu(d));if(f=Qr,p=h=null,g=r.$,!g){x.u(2);break}return m=Gu(g.M(),g.$b(),g.Xb(),e.g.retryParameters),T(x,Ib(e,m,f,{type:0}),3);case 3:if(v=x.h,h=v.data,!g.aesKey){x.u(4);break}return T(x,Bu(h,g.aesKey,0),5);case 5:h=x.h;case 4:(p=v.headers["content-type"])&&(p=p.split(";")[0].toLowerCase());case 2:return y=Gu(r.M(),r.$b(),r.Xb(),e.g.retryParameters),T(x,Ib(e,y,f,{type:1}),6);case 6:if(_=x.h,b=_.data,!r.aesKey){x.u(7);break}return T(x,Bu(b,r.aesKey,a),8);case 8:b=x.h;case 7:if((E=_.headers["content-type"])&&(E=E.split(";")[0].toLowerCase()),S="mp4 mp4a m4s m4i m4a m4f cmfa mp4v m4v cmfv fmp4".split(" "),w=["audio/mp4","video/mp4","video/iso.segment"],js(we(b))){var R=b,C=we(R);C=(new Os).parse(C);var D=C.sd();C=C.Hf();var k=[],M=!1,L=!1;switch(D.audio){case"aac":case"aac-loas":k.push("mp4a.40.2"),M=!0;break;case"mp3":k.push("mp4a.40.34"),M=!0;break;case"ac3":k.push("ac-3"),M=!0;break;case"ec3":k.push("ec-3"),M=!0;break;case"opus":k.push("opus"),M=!0}switch(D.video){case"avc":C.Na?k.push(C.Na):k.push("avc1.42E01E"),L=!0;break;case"hvc":C.Na?k.push(C.Na):k.push("hvc1.1.6.L93.90"),L=!0;break;case"av1":k.push("av01.0.01M.08"),L=!0}if(k.length){if(D=M&&!L,M=new Map,L){L=new Ce("video/mp2t"),L.i(R),R=c(L.j());for(var P=R.next();!P.done;P=R.next())P=P.value,M.set(P,P);L.g()}C={type:D?"audio":"video",mimeType:"video/mp2t",codecs:k.join(", "),language:null,height:C.height,width:C.width,channelCount:null,sampleRate:null,closedCaptions:M,Qd:null,colorGamut:null}}else C=null;if(A=C)return x.return(A)}else if((S.includes(u)||w.includes(E)||p&&w.includes(p))&&(I=Nu(h,b)))return x.return(I);return E?x.return(Pu(E)):p?x.return(Pu(p)):x.return(n)}})}function k_(e){if(wb(e)){if(e.xa==Nb){for(var t,n=t=1/0,i=c(e.i.values()),r=i.next();!r.done;r=i.next())r=r.value,r.stream.segmentIndex&&"text"!=r.stream.type&&(t=Math.min(t,r.Lb),n=Math.min(n,r.rc));t-=n,e.g.hls.useSafariBehaviorForLive&&(t=e.j.A),isNaN(e.g.availabilityWindowOverride)||(t=e.g.availabilityWindowOverride),e.j.Ie(t)}}else e.j.$a(J_(e));if(!e.j.s)for(t=c(e.i.values()),n=t.next();!n.done;n=t.next())n=n.value,!n.stream.segmentIndex||"audio"!=n.type&&"video"!=n.type||(n=n.stream.segmentIndex.get(0))&&n.h&&e.j.lh(n.h);e.j.re()}function M_(e,t){var n=new ft(e.L).g;t=c(t);for(var i=t.next();!i.done;i=t.next()){var r=i.value;i=r_(r,"NAME");var a=r_(r,"VALUE");r=r_(r,"QUERYPARAM"),i&&a&&(e.s.has(i)||e.s.set(i,a)),r&&(i=n.get(r)[0])&&!e.s.has(i)&&e.s.set(r,i)}}function L_(e,t,n){n=new ft(n).g;var i=new Map;t=c(t);for(var r=t.next();!r.done;r=t.next()){var a=r.value,o=r_(a,"NAME"),s=r_(a,"VALUE");r=r_(a,"QUERYPARAM"),a=r_(a,"IMPORT"),o&&s&&(i.has(o)||i.set(o,s)),r&&(o=n.get(r)[0])&&!i.has(o)&&i.set(r,o),a&&(r=e.s.get(a))&&i.set(a,r)}return i}function P_(e,t){t=c(t);for(var n=t.next();!n.done;n=t.next()){var i=n.value,r=r_(i,"AUDIO");n=r_(i,"VIDEO");var a=r_(i,"SUBTITLES");if(i=H_(e,i),a){var o=kn(Ln,i);e.F.set(a,o),Oe(i,o)}r&&(a=kn("audio",i),a||(a=e.g.hls.defaultAudioCodec),e.F.set(r,a)),n&&(r=kn("video",i),r||(r=e.g.hls.defaultVideoCodec),e.F.set(n,r))}}function N_(e,t){t=c(t);for(var n=t.next();!n.done;n=t.next()){var i=n.value,r=r_(i,"DATA-ID");n=r_(i,"URI");var a=r_(i,"LANGUAGE");i=r_(i,"VALUE"),r=(new Map).set("id",r),n&&r.set("uri",f_([e.L],n,e.s)[0]),a&&r.set("language",a),i&&r.set("value",i),n=new Or("sessiondata",r),e.h&&e.h.onEvent(n)}}function O_(e,t){var n,i,r,a,o,s;return O(function(l){if(!e.h||!e.g)return l.return();for(i=c(t),r=i.next();!r.done;r=i.next())if(a=r.value,o=r_(a,"PATHWAY-ID"),s=r_(a,"SERVER-URI"),o&&s){e.l=new Dv(e.h),e.l.configure(e.g),e.l.i=[e.L],e.l.setManifestType("HLS"),e.l.h=o,n=kv(e.l,s);break}return T(l,n,0)})}function F_(e,t){var n=u_(t,"SUBTITLES");t=n.map(function(t){if(e.g.disableText)return null;try{return W_(e,[t],new Map).stream}catch(t){if(e.g.hls.ignoreTextStreamFailures)return null;throw t}}),n=c(n);for(var i=n.next();!i.done;i=n.next()){var r=a_(i.value,"GROUP-ID");if((i=e.F.get(r))&&(r=e.G.get(r))){r=c(r);for(var a=r.next();!a.done;a=r.next())a=a.value,a.stream.codecs=i,a.stream.mimeType=vb(Ln,i)||yb(Ln),U_(a.stream)}}return t.filter(function(e){return e})}function U_(e){var t=new Set([Un(e.mimeType,e.codecs)]);e.segmentIndex&&e.segmentIndex.Jb(function(n){n.mimeType&&t.add(Un(n.mimeType,e.codecs))}),e.fullMimeTypes=t}function B_(e,t,n){var i,r;return O(function(a){return 1==a.g?(i=t.map(function(t){var n,i;return O(function(r){if(1==r.g)return e.g.disableThumbnails?r.return(null):(w(r,2),T(r,$_(e,t),4));if(2!=r.g)return n=r.h,r.return(n.stream);if(i=x(r),e.g.hls.ignoreImageStreamFailures)return r.return(null);throw i})}).concat(n.map(function(t){if(e.g.disableThumbnails)return null;try{var n=a_(t,"URI"),i=r_(t,"CODECS")||"";if(e.i.has(n))var r=e.i.get(n);else{var a=r_(t,"LANGUAGE"),o=r_(t,"NAME"),s=r_(t,"CHARACTERISTICS"),l=Q_(e,e.B++,[n],i,"image",a,!1,o,null,null,s,!1,null,!1),u=r_(t,"RESOLUTION"),d=c(u?u.split("x"):[null,null]),f=d.next().value,h=d.next().value;l.stream.width=Number(f)||void 0,l.stream.height=Number(h)||void 0;var p=r_(t,"BANDWIDTH");p&&(l.stream.bandwidth=Number(p)),e.i.set(n,l),r=l}return t=r,"mjpg"!==t.stream.codecs?null:t.stream}catch(t){if(e.g.hls.ignoreImageStreamFailures)return null;throw t}})),T(a,Promise.all(i),2)):(r=a.h,a.return(r.filter(function(e){return e})))})}function G_(e,t,n){t=t.filter(function(e){var t=r_(e,"URI")||"";return"SUBTITLES"!=r_(e,"TYPE")&&""!=t});var i={};t=c(t);for(var r=t.next();!r.done;r=t.next()){r=r.value;var a=n_(r);i[a]?i[a].push(r):i[a]=[r]}for(var o in i)W_(e,i[o],n)}function j_(e,t,n,i,r,a){var o,s,l,u,f,h,p,g,m,v,y,_,b,E,S,w,A,I,x,R,C,D,k,M,L,P,N,F,U,B,G,j,V,H,K;return O(function(O){switch(O.g){case 1:if(o=[],s=new Set,!(0<n.length)){O.u(2);break}l=c(n),u=l.next();case 3:if(u.done){O.u(2);break}if(f=u.value,h=a_(f,"METHOD"),p=r_(f,"KEYFORMAT")||"identity",g=null,"NONE"==h){O.u(4);break}if(xb(h)){m=f_(r(),a_(f,"URI"),a),v=m.sort().join(""),e.K.has(v)||(y=zr(m,e.g.retryParameters),_=Ib(e,y,6),e.K.set(v,_)),O.u(4);break}if("identity"!=p){g=(b=Mb[p])?b(f,""):null,O.u(6);break}return T(O,Rb(e,f,"",r,null,a),9);case 9:g=O.h;case 6:if(g){if(g.keyIds)for(E=c(g.keyIds),S=E.next();!S.done;S=E.next())w=S.value,s.add(w);o.push(g)}case 4:u=l.next(),O.u(3);break;case 2:for(A={},I=c(t),x=I.next();!x.done;x=I.next())R=x.value,C=n_(R),A[C]?A[C].push(R):A[C]=[R];for(k in D=[],A)M=A[k],L=M[0],P=r_(L,"FRAME-RATE"),N=Number(r_(L,"AVERAGE-BANDWIDTH"))||Number(a_(L,"BANDWIDTH")),F=r_(L,"RESOLUTION"),U=c(F?F.split("x"):[null,null]),B=U.next().value,G=U.next().value,j=r_(L,"VIDEO-RANGE"),(V=r_(L,"REQ-VIDEO-LAYOUT"))&&V.includes(",")&&(H=V.split(",").filter(function(e){return"CH-STEREO"==e||"CH-MONO"==e}),V=H[0]),V=V||"CH-MONO",K=V_(e,M,i),D.push.apply(D,d(q_(e,K.audio,K.video,N,B,G,P,j,V,o,s)));return O.return(D.filter(function(e){return null!=e}))}})}function V_(e,t,n){for(var i={audio:[],video:[]},r=new Map,a=[],o=!1,s=!1,l=c(t),u=l.next();!u.done;u=l.next()){var f=u.value;u=r_(f,"AUDIO");var h=r_(f,"VIDEO"),p=u||h;p&&(a.includes(p)||a.push(p),(f=r_(f,"PATHWAY-ID"))&&r.set(p,f),u?o=!0:h&&(s=!0))}a.length&&n.length&&(l=n.filter(function(e){return a.includes(a_(e,"GROUP-ID"))}),G_(e,l,r)),l=(r=a.sort().join(","))&&e.G.has(r)?e.G.get(r):[],o?i.audio.push.apply(i.audio,d(l)):s&&i.video.push.apply(i.video,d(l)),u=!1;var g=t.map(function(e){return a_(e,"URI")});if(s=i.audio.find(function(e){return e&&e.M().find(function(e){return g.includes(e)})}),o=H_(e,t[0]),h=kn("video",o),(p=kn("audio",o))&&!h?(s="audio",u=0<i.audio.length):!i.audio.length&&!i.video.length&&p&&h?(s="video",o=[[h,p].join()]):i.audio.length&&s?(s="audio",u=!0):s=i.video.length&&!i.audio.length?"audio":"video",!u){var m=f=p=h=u=null;!l.length&&(n=n.find(function(e){var t=r_(e,"URI")||"",n=r_(e,"TYPE");return e=a_(e,"GROUP-ID"),"SUBTITLES"!=n&&""==t&&a.includes(e)}))&&(u=r_(n,"LANGUAGE"),h=r_(n,"NAME"),p=K_(n),Z_(n),f=r_(n,"CHARACTERISTICS"),m=z_(n)),e=X_(e,t,o,s,u,h,p,f,m),r&&(e.stream.groupId=r),i[e.stream.type]=[e]}return i}function H_(e,t){var n=r_(t,"CODECS")||"";return t=r_(t,"SUPPLEMENTAL-CODECS"),e.ea=0<n.length,e.ea||e.g.hls.disableCodecGuessing||(n=[],e.g.disableVideo||n.push(e.g.hls.defaultVideoCodec),e.g.disableAudio||n.push(e.g.hls.defaultAudioCodec),n=n.join(",")),e=n.split(/\s*,\s*/),t&&(t=t.split(/\s*,\s*/).map(function(e){return e.split("/")[0]}),e.push.apply(e,d(t))),Ou(e)}function K_(e){return(e=r_(e,"CHANNELS"))?parseInt(e.split("/")[0],10):null}function z_(e){return(e=r_(e,"SAMPLE-RATE"))?parseInt(e,10):null}function Z_(e){return!!(e=r_(e,"CHANNELS"))&&e.includes("/JOC")}function q_(e,t,n,i,r,a,o,s,l,u,d){for(var f=c(n),h=f.next();!h.done;h=f.next())Eb(h.value.stream,r,a,o,s,l,null);for(r=e.g.disableAudio,t.length&&!r||(t=[null]),r=e.g.disableVideo,n.length&&!r||(n=[null]),r=[],t=c(t),a=t.next();!a.done;a=t.next())for(a=a.value,o=c(n),s=o.next();!s.done;s=o.next()){var p=s.value;(s=a?a.stream:null)&&(s.drmInfos=u,s.keyIds=d),(l=p?p.stream:null)&&(l.drmInfos=u,l.keyIds=d),l&&!s&&(l.bandwidth=i),!l&&s&&(s.bandwidth=i),f=a?a.stream.drmInfos:null,h=p?p.stream.drmInfos:null,p=p?p.M().sort().join(","):"";var g=a?a.M().sort().join(","):"";p=p+" - "+g,s&&l&&!kt(f,h)||e.wb.has(p)||(s={id:e.B++,language:s?s.language:"und",disabledUntilTime:0,primary:!!s&&s.primary||!!l&&l.primary,audio:s,video:l,bandwidth:i,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},r.push(s),e.wb.add(p))}return r}function Y_(e,t){t=u_(t,"CLOSED-CAPTIONS"),e.R=0==t.length,t=c(t);for(var n=t.next();!n.done;n=t.next()){var i=n.value,r=r_(i,"LANGUAGE");n=fi(r||"und"),r||(r=r_(i,"NAME"))&&(n=r),r=a_(i,"GROUP-ID"),i=a_(i,"INSTREAM-ID").replace("SERVICE","svc"),e.C.get(r)||e.C.set(r,new Map),e.C.get(r).set(i,n)}}function W_(e,t,n){for(var i=[],r=[],a=new Map,o=c(t),s=o.next();!s.done;s=o.next()){var l=s.value;s=a_(l,"URI"),l=a_(l,"GROUP-ID"),i.push(s),r.push(l),a.set(l,s)}if(o=r.sort().join(","),s=t[0],t="",l=a_(s,"TYPE").toLowerCase(),"subtitles"==l&&(l=Ln),l==Ln)t=r_(s,"CODECS")||"";else{r=c(r);for(var u=r.next();!u.done;u=r.next())if(u=u.value,e.F.has(u)){t=e.F.get(u);break}}if(r=i.sort().join(","),e.i.has(r))return e.i.get(r);if(u=e.B++,e.l){a=c(a);for(var d=a.next();!d.done;d=a.next()){var f=c(d.value);d=f.next().value,f=f.next().value,(d=n.get(d))&&Pv(e.l,u,d,f)}}n=r_(s,"LANGUAGE"),a=r_(s,"NAME"),d="YES"==r_(s,"DEFAULT"),f="audio"==l?K_(s):null;var h="audio"==l&&Z_(s),p=r_(s,"CHARACTERISTICS"),g="YES"==r_(s,"FORCED");return s="audio"==l?z_(s):null,i=Q_(e,u,i,t,l,n,d,a,f,null,p,g,s,h),i.stream&&(i.stream.groupId=o),e.G.has(o)?e.G.get(o).push(i):e.G.set(o,[i]),e.i.set(r,i),i}function $_(e,t){var n,i,r,a,o,s,l,u,c,d;return O(function(f){return 1==f.g?(n=a_(t,"URI"),i=r_(t,"CODECS","jpeg")||"",e.i.has(n)?f.return(e.i.get(n)):(r=r_(t,"LANGUAGE"),a=r_(t,"NAME"),o=r_(t,"CHARACTERISTICS"),s=Q_(e,e.B++,[n],i,"image",r,!1,a,null,null,o,!1,null,!1),(l=r_(t,"RESOLUTION"))?T(f,s.stream.createSegmentIndex(),3):f.u(2))):(2!=f.g&&(u=s.stream.segmentIndex.get(0),c=u.tilesLayout)&&(s.stream.width=Number(l.split("x")[0])*Number(c.split("x")[0]),s.stream.height=Number(l.split("x")[1])*Number(c.split("x")[1])),(d=r_(t,"BANDWIDTH"))&&(s.stream.bandwidth=Number(d)),e.i.set(n,s),f.return(s))})}function X_(e,t,n,i,r,a,o,s,l){for(var u=e.B++,d=[],f=c(t),h=f.next();!h.done;h=f.next()){var p=h.value;h=a_(p,"URI"),p=r_(p,"PATHWAY-ID"),e.l&&p&&Pv(e.l,u,p,h),d.push(h)}if(f=d.sort().join(","),e.i.has(f))return e.i.get(f);e:{if(t=r_(t[0],"CLOSED-CAPTIONS"),"video"==i){if(e.g.disableText){e.R=!1,t=null;break e}if(t){if("NONE"!=t){t=e.C.get(t);break e}e.R=!1}else if(!t&&e.C.size)for(t=c(e.C.keys()).next();!t.done;){t=e.C.get(t.value);break e}}t=null}return n=Dn(i,n),i=Q_(e,u,d,n,i,r,!1,a,o,t,s,!1,l,!1),e.i.set(f,i),i}function Q_(e,t,n,i,r,a,o,s,l,u,d,f,h,p){function g(t){var n,g,b,E,A,R,C,D,k,M,L,P,N,F,U,B,G,j,V,H,K,z;return O(function(O){switch(O.g){case 1:return n=Pn,g=_.M(),w(O,2),T(O,Tb(e,_.M(),!0),4);case 4:b=O.h,I(O,3);break;case 2:if(E=x(O),v.closeSegmentIndex(),e.h.disableStream(v))return O.return();throw E;case 3:if(t.aborted)return O.return();if(A=b.uri,A==b.originalUri||g.includes(A)||y.push(A),R=m_(e.Fa,b.data),1!=R.type)throw new Rt(2,4,4017);return C=l_(R.g,"EXT-X-DEFINE"),D=L_(e,C,A),k=!1,(!e.ea&&e.g.hls.disableCodecGuessing||e.R&&r==n.ga&&!e.g.hls.disableClosedCaptionsDetection)&&0<R.segments.length&&(e.R=!1,k=!0),M=!e.ea&&e.g.hls.disableCodecGuessing,L=wb(e),T(O,rb(e,0,D,R,m,i,r,a,o,s,l,u,d,f,h,p,void 0,k,M),5);case 5:if(P=O.h,t.aborted)return O.return();if(N=P.stream,wb(e)&&!L&&cb(e,R),_.rc=P.rc,_.Lb=P.Lb,_.de=P.de,_.ce=P.ce,_.xd=P.xd,_.te=P.te,_.pb=P.pb,_.qb=P.qb,_.Nf=!0,v.segmentIndex=N.segmentIndex,v.encrypted=N.encrypted,v.drmInfos=N.drmInfos,v.keyIds=N.keyIds,v.mimeType=N.mimeType,v.bandwidth=v.bandwidth||N.bandwidth,v.codecs=v.codecs||N.codecs,v.closedCaptions=v.closedCaptions||N.closedCaptions,v.width=v.width||N.width,v.height=v.height||N.height,v.hdr=v.hdr||N.hdr,v.colorGamut=v.colorGamut||N.colorGamut,"und"==v.language&&"und"!=N.language&&(v.language=N.language),v.language=v.language||N.language,v.channelsCount=v.channelsCount||N.channelsCount,v.audioSamplingRate=v.audioSamplingRate||N.audioSamplingRate,U_(v),v.drmInfos.length&&e.h.newDrmInfo(v),F=!1,(!u&&v.closedCaptions||u&&v.closedCaptions&&u.size!=v.closedCaptions.size)&&(F=!0),e.m&&F&&e.h.makeTextStreamsForClosedCaptions(e.m),r==n.ga||r==n.X)for(U=c(e.i.values()),B=U.next();!B.done;B=U.next())G=B.value,G.Nf||G.type!=r||(G.stream.mimeType=N.mimeType,U_(G.stream));r==n.ta&&(j=N.segmentIndex.get(0))&&j.$&&(v.mimeType="application/mp4",U_(v)),V=Lu(v),v.segmentIndex.Jb(function(e){e.$&&(e.$.Lc=V)}),ib(e)&&(e.Ib?tb(e,[_]):(e.Ib=!0,H=Array.from(e.i.values()),K=H.filter(function(e){return e.stream.segmentIndex}),tb(e,K),k_(e),z=e.o,0<z&&e.A.Y(z))),gb(e,R.g,v.type,D,m),S(O)}})}function m(){return e.l&&1<n.length?Nv(e.l,t):y.concat(h_([e.L],n,e.s))}var v=ob(e,i,r,a,o,s,l,u,d,f,h,p),y=[],_={stream:v,type:r,dh:y,M:m,rc:0,Lb:0,te:new Map,de:!1,ce:!1,xd:!1,mf:-1,pb:-1,qb:-1,Nf:!1},b=null,E=new AbortController;return v.createSegmentIndex=function(){return b||(E=new AbortController,b=new Promise(function(e){e(g(E.signal))}))},v.closeSegmentIndex=function(){b&&!v.segmentIndex&&E.abort(),v.segmentIndex&&(v.segmentIndex.release(),v.segmentIndex=null),b=null},_}function J_(e){var t=1/0;e=c(e.i.values());for(var n=e.next();!n.done;n=e.next())n=n.value,n.stream.segmentIndex&&"text"!=n.stream.type&&(t=Math.min(t,n.Lb));return t}function eb(e,t){var n=[];t=c(t);for(var i=t.next();!i.done;i=t.next())i=i.value,i.segmentIndex&&i.segmentIndex.Jb(function(e){n.push(e)});e.j.Jd(n)}function tb(e,t){if(!wb(e))for(var n=J_(e),i=c(t),r=i.next();!r.done;r=i.next())r.value.stream.segmentIndex.Ec(0,n);eb(e,t.map(function(e){return e.stream})),e.g.hls.ignoreManifestProgramDateTime?I_(e,t):(x_(e,t),0<e.g.hls.ignoreManifestProgramDateTimeForTypes.length&&I_(e,t))}function nb(e,t){return!!e.g.hls.ignoreManifestProgramDateTime||e.g.hls.ignoreManifestProgramDateTimeForTypes.includes(t)}function ib(e){if(!e.m)return!1;var t=[],n=[];e=c(e.m.variants);for(var i=e.next();!i.done;i=e.next())i=i.value,i.video&&t.push(i.video),i.audio&&n.push(i.audio);return!(0<t.length&&!t.some(function(e){return e.segmentIndex})||0<n.length&&!n.some(function(e){return e.segmentIndex}))}function rb(e,t,n,i,r,a,o,s,l,u,c,d,f,h,p,g,m,v,y){var _,b,E,S,w,A,I,x,R,C,D,k,M,L,P,N,F,U,B,G,j,V,H,K,z,Z;return v=void 0===v||v,y=void 0===y||y,O(function(t){switch(t.g){case 1:var O=c_(i.g,"EXT-X-PLAYLIST-TYPE"),q=c_(i.g,"EXT-X-ENDLIST");if(q=O&&"VOD"==O.value||q,O=O&&"EVENT"==O.value&&!q,O=!q&&!O,Ab(e,q?Lb:O?Nb:Pb),wb(e)&&ub(e,i),_=wb(e)?e.N.get(o):new Map,b=mb(e,i,_,n,r,o),E=b.segments,S=b.bandwidth,x=I=A=w=null,!(0<E.length&&v)){t.u(2);break}return T(t,D_(e,E),3);case 3:R=t.h,o=R.type,s=R.language,c=R.channelCount,p=R.sampleRate,e.g.disableText||(d=R.closedCaptions),A=R.height,w=R.width,I=R.Qd,x=R.colorGamut,y&&(m=R.mimeType,a=R.codecs);case 2:if(m){t.u(4);break}return T(t,bb(e,o,a,E),5);case 5:m=t.h;case 4:return T(t,sb(e,i,m,r,n),6);case 6:if(C=t.h,D=C.drmInfos,k=C.keyIds,M=C.encrypted,L=C.Dh,M&&!D.length&&!L)throw new Rt(2,4,4026);return P=ob(e,a,o,s,l,u,c,d,f,h,p,g),P.encrypted=M,P.drmInfos=D,P.keyIds=k,P.mimeType=m,S&&(P.bandwidth=S),U_(P),"video"==o&&(w||A||I||x)&&Eb(P,w,A,null,I,null,x),wb(e)&&ub(e,i),N=E[0].startTime,F=E[E.length-1],U=F.endTime,B=new tu(E),P.segmentIndex=B,j=!!(G=c_(i.g,"EXT-X-SERVER-CONTROL"))&&null!=i_(G,"CAN-SKIP-UNTIL"),V=!!G&&null!=i_(G,"CAN-BLOCK-RELOAD"),H=d_(i.g,"EXT-X-MEDIA-SEQUENCE",0),K=ab(H,E),z=K.pb,Z=K.qb,t.return({stream:P,type:o,dh:[],M:r,rc:N,Lb:U,de:j,ce:V,xd:!1,mf:-1,pb:z,qb:Z,te:_,Nf:!1})}})}function ab(e,t){e=e+t.length-1;var n=-1;if(!t.length)return e++,{pb:e,qb:n};t=t[t.length-1];var i=t.g;return t.g.length?(n=i.length-1,i[i.length-1].preload||(e++,n=0),{pb:e,qb:n}):(e++,t.m&&(n=0),{pb:e,qb:n})}function ob(e,t,n,i,r,a,o,s,l,u,d,f){var h=vb(n,t)||yb(n),p=[];if(l){l=c(l.split(","));for(var g=l.next();!g.done;g=l.next())p.push(g.value)}return l=void 0,g=null,n==Ln?l=p.includes("public.accessibility.transcribes-spoken-dialog")&&p.includes("public.accessibility.describes-music-and-sound")?"caption":"subtitle":p.includes("public.accessibility.describes-video")&&(g="visually impaired"),p.length||"subtitle"!==l||p.push("subtitle"),e={id:e.B++,originalId:a,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:h,codecs:t,kind:n==Ln?"subtitle":void 0,encrypted:!1,drmInfos:[],keyIds:new Set,language:fi(i||"und"),originalLanguage:i,label:a,type:n,primary:r,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:p,forced:u,channelsCount:o,audioSamplingRate:d,spatialAudio:f,closedCaptions:s,hdr:void 0,colorGamut:void 0,videoLayout:void 0,tilesLayout:void 0,accessibilityPurpose:g,external:!1,fastSwitching:!1,fullMimeTypes:new Set},U_(e),e}function sb(e,t,n,i,r){var a,o,s,l,u,d,f,h,p,g,m,v,y,_,b,E,S,w,A,I,x,R,C,D,k,M,L,P;return O(function(N){switch(N.g){case 1:if(a=new Map,t.segments)for(o=c(t.segments),s=o.next();!s.done;s=o.next())if(l=s.value,u=l_(l.g,"EXT-X-KEY"),d=null,u.length)for(d=db(e,t,l.g,i,r),f=c(u),h=f.next();!h.done;h=f.next())p=h.value,a.set(p,d);m=g=!1,v=[],y=new Set,_=c(a),b=_.next();case 2:if(b.done){N.u(4);break}if(E=b.value,S=c(E),w=S.next().value,A=S.next().value,I=w,x=A,R=a_(I,"METHOD"),"NONE"==R){N.u(3);break}if(g=!0,C=r_(I,"KEYFORMAT")||"identity",D=null,xb(R)){m=!0,N.u(3);break}if("identity"!=C){D=(k=Mb[C])?k(I,n):null,N.u(6);break}return T(N,Rb(e,I,n,i,x,r),8);case 8:D=N.h;case 6:if(D){if(D.keyIds)for(M=c(D.keyIds),L=M.next();!L.done;L=M.next())P=L.value,y.add(P);v.push(D)}case 3:b=_.next(),N.u(2);break;case 4:return N.return({drmInfos:v,keyIds:y,encrypted:g,Dh:m})}})}function lb(t,n,i,r,a){if(!e.crypto||!e.crypto.subtle)throw Q("Web Crypto API is not available to decrypt AES. (Web Crypto only exists in secure origins like https)"),new Rt(2,4,4042);var o=0,s=r_(n,"IV","");if(s){var l=wn(s.substr(2));if(16!=l.byteLength)throw new Rt(2,4,4048)}else o=d_(i.g,"EXT-X-MEDIA-SEQUENCE",0);if(i=n.toString()+"-"+o,!t.pa.has(i)){var u={bitsKey:128,blockCipherMode:"CBC",iv:l,firstMediaSequenceNumber:o};switch(a_(n,"METHOD")){case"AES-256":u.bitsKey=256;break;case"AES-256-CTR":u.bitsKey=256,u.blockCipherMode="CTR"}u.fetchKey=function(){var i,o,s,l,c,d,f;return O(function(h){if(1==h.g)return i=f_(r(),a_(n,"URI"),a),o=i.sort().join(""),t.K.has(o)||(s=zr(i,t.g.retryParameters),l=Ib(t,s,6),t.K.set(o,l)),T(h,t.K.get(o),2);if(3!=h.g){if(c=h.h,!c.data||c.data.byteLength!=u.bitsKey/8)throw new Rt(2,4,4049);return d={name:"CTR"==u.blockCipherMode?"AES-CTR":"AES-CBC",length:u.bitsKey},f=u,T(h,e.crypto.subtle.importKey("raw",c.data,d,!0,["decrypt"]),3)}f.cryptoKey=h.h,u.fetchKey=void 0,S(h)})},t.pa.set(i,u)}return t.pa.get(i)}function ub(e,t){var n=1/0,i=t.segments;if(i.length)for(var r=i.length-1;0<=r;){var a=c_(i[r].g,"EXTINF");if(a){n=Number(a.value.split(",")[0]);break}r--}if(i=c_(t.g,"EXT-X-TARGETDURATION"),!i)throw new Rt(2,4,4024,"EXT-X-TARGETDURATION");i=Number(i.value),(r=c_(t.g,"EXT-X-PART-INF"))&&(e.U=Number(a_(r,"PART-TARGET"))),t=c_(t.g,"EXT-X-SERVER-CONTROL"),e.I&&e.U?(e.o=e.Hb?5*e.U<=n?Math.min(e.U,e.o):Math.min(n,e.o):Math.min(e.U,e.o),e.Da=t?Number(a_(t,"PART-HOLD-BACK")):0):(e.o=Math.min(n,e.o),n=t?i_(t,"HOLD-BACK"):null,e.za=n?Number(n.value):0),e.bb=Math.max(i,e.bb)}function cb(e,t){if(e.g.defaultPresentationDelay)t=e.g.defaultPresentationDelay;else if(e.Da)t=e.Da;else if(e.za)t=e.za;else{t=t.segments.length;var n=e.g.hls.liveSegmentsDelay;n>t-2&&(n=Math.max(1,t-2)),t=e.bb*n}e.j.mh(0),e.j.eg(t),e.j.wc(!1)}function db(e,t,n,i,r){var a=c_(n,"EXT-X-MAP");if(!a)return null;var o=a_(a,"URI"),s=f_(i(),o,r);if(o=[s.toString(),r_(a,"BYTERANGE","")].join("-"),!e.ra.has(o)){var l=void 0,u=null;n=c(n);for(var d=n.next();!d.done;d=n.next())d=d.value,"EXT-X-KEY"==d.name?xb(a_(d,"METHOD"))&&d.id<a.id&&(l=lb(e,d,t,i,r)):"EXT-X-BYTERANGE"==d.name&&d.id<a.id&&(u=d);t=fb(s,a,u,l),e.ra.set(o,t)}return e.ra.get(o)}function fb(e,t,n,i){var r=0,a=null;return t=r_(t,"BYTERANGE"),!t&&n&&(t=n.value),t&&(r=t.split("@"),a=Number(r[0]),r=Number(r[1]),a=r+a-1,i&&(n=a+1-r,n%16&&(a+=16-n%16))),new $o(function(){return e},r,a,null,null,null,i)}function hb(t,n,i,r,a,o,s,l,u){function d(e){e=new ft(e).Pa.split(".").pop();var t=Db[s][e];return t||(t=Cb[e]),t}var f=r.g,h=c_(f,"EXTINF"),p=0,g=0,m=null;r.Bb.length&&(t.m.isLowLatency=!0);var v=null;if(!t.g.hls.ignoreManifestProgramDateTime){var y=c_(f,"EXT-X-PROGRAM-DATE-TIME");y&&y.value&&(v=Ba(y.value))}var _=es;if(c_(f,"EXT-X-GAP")&&(t.m.gapCount++,_=2),!h){if(0==r.Bb.length)throw new Rt(2,4,4024,"EXTINF");if(!t.I)return null}var b=[];y=!1;var E=null,T=!1,S=!1;if(t.I&&r.Bb.length){p=n&&e.ReadableStream&&t.g.hls.allowLowLatencyByteRangeOptimization;for(var w=v,A={},I=0;I<r.Bb.length;A={gd:A.gd,bd:A.bd},I++){var x=r.Bb[I],R=0==I?i:b[b.length-1],C=0==I?a:R.endTime,D=Number(r_(x,"DURATION"))||t.U;if(D){var k=C+D,M=0,L=null;if("EXT-X-PRELOAD-HINT"==x.name?(M=(M=r_(x,"BYTERANGE-START"))?Number(M):0,(R=r_(x,"BYTERANGE-LENGTH"))?L=M+Number(R)-1:M&&(L=Number.MAX_SAFE_INTEGER)):(M=r_(x,"BYTERANGE"),L=c(pb(R,M)),M=L.next().value,L=L.next().value),A.bd=r_(x,"URI"),A.bd){R=es,"YES"==r_(x,"GAP")&&(t.m.gapCount++,R=2,T=!0),A.gd=null;var P=function(e){return function(){return null==e.gd&&(e.gd=f_(l(),e.bd,o)),e.gd}}(A);p&&0<=M&&null!=L&&(E=P,y=!0),C=new Qo(C,k,P,M,L,n,0,0,1/0,[],"",null,w,R,u),"EXT-X-PRELOAD-HINT"==x.name&&(C.Of(),S=!0),"YES"!=r_(x,"INDEPENDENT")&&0<I&&C.se(),(x=d(A.bd))&&(C.mimeType=x,kb.has(x)&&(C.$=null)),b.push(C),w&&(w+=D)}}}}if(h){if(h=Number(h.value.split(",")[0]),0==h)return null;p=a+h}else{if(!b.length)return null;p=b[b.length-1].endTime}y&&(T||0!=b[0].Ha?(y=!1,E=null):b=[]),(h=c_(f,"EXT-X-BYTERANGE"))?(m=c(pb(i,h.value)),g=m.next().value,m=m.next().value):b.length&&(g=b[0].Ha,m=b[b.length-1].sa),i="",h=null,"image"==s&&(i="1x1",f=c_(f,"EXT-X-TILES"))&&(i=a_(f,"LAYOUT"),(f=r_(f,"DURATION"))&&(h=Number(f)));var N=null;return n=new Qo(a,p,function(){return E?E():(null==N&&(N=f_(l(),r.h,o)),N||[])},g,m,n,0,0,1/0,b,i,h,v,_,u,0<b.length&&!!r.h),(a=d(r.h))&&(n.mimeType=a,kb.has(a)&&(n.$=null)),y&&(t.Hb=!0,n.Vg(),S&&n.Of()),n}function pb(e,t){var n=0,i=null;return t&&(n=t.split("@"),t=Number(n[0]),n=n[1]?Number(n[1]):e.sa+1,i=n+t-1),[n,i]}function gb(e,t,n,i,r){if("video"==n||"audio"==n){var a=e.j.m;if(a&&!nb(e,n))for(t=l_(t,"EXT-X-DATERANGE"),t=t.sort(function(e,t){return e=a_(e,"START-DATE"),t=a_(t,"START-DATE"),e<t?-1:e>t?1:0}),n=0;n<t.length;n++){var o=t[n],s=a_(o,"ID");if(!e.Ea.has(s)){var l=a_(o,"START-DATE"),u=Ba(l);if(!isNaN(u)){l=Math.max(0,u-a);var d=null,f=r_(o,"END-DATE");if(f&&(f=Ba(f),!isNaN(f)&&(d=f-a,0>d)))continue;if(null==d&&(f=r_(o,"DURATION")||r_(o,"PLANNED-DURATION"))&&(f=parseFloat(f),isNaN(f)||(d=l+f),0>u-a+f))continue;f=r_(o,"CLASS")||"com.apple.quicktime.HLS";var h="YES"==r_(o,"END-ON-NEXT");if(null==d&&h){for(h=n+1;h<t.length;h++){var p=r_(t[h],"CLASS")||"com.apple.quicktime.HLS";if(f==p&&(p=a_(t[h],"START-DATE"),p=Ba(p),!isNaN(p)&&p&&p>u)){d=Math.max(0,p-a);break}}if(null==d)continue}for(u="ID CLASS START-DATE END-DATE DURATION END-ON-NEXT".split(" "),h=[],o=c(o.attributes),p=o.next();!p.done;p=o.next())if(p=p.value,!u.includes(p.name)){var g=p_(p.value,i);"X-ASSET-URI"!=p.name&&"X-ASSET-LIST"!=p.name||(g=f_(r(),p.value,i)[0]),h.push({key:p.name,description:"",data:g,mimeType:null,pictureType:null})}h.length&&e.h.onMetadata(f,l,d,h),e.Ea.add(s)}}}}}function mb(e,t,n,i,r,a){var o=t.segments,s=void 0,l=d_(t.g,"EXT-X-DISCONTINUITY-SEQUENCE",0),u=d_(t.g,"EXT-X-MEDIA-SEQUENCE",0),d=c_(t.g,"EXT-X-SKIP"),f=d?Number(r_(d,"SKIPPED-SEGMENTS")):0,h=u+f,p=0;wb(e)&&n.has(h)&&(p=n.get(h)),0===p&&e.xa==Nb&&0<n.size&&!n.has(h)&&(p=e.j.nb());var g=[],m=null;d=[];for(var v=0;v<o.length;v++){var y=o[v],_=0==v?p:m.endTime;h=u+f+v,c_(y.g,"EXT-X-DISCONTINUITY")&&l++;for(var b=c(y.g),E=b.next();!E.done;E=b.next())E=E.value,"EXT-X-KEY"==E.name&&(s=xb(a_(E,"METHOD"))?lb(e,E,t,r,i):void 0);n.set(h,_),b=db(e,t,y.g,r,i),!e.I&&e.h.isAutoLowLatencyMode()&&(e.h.enableLowLatencyMode(),e.I=e.h.isLowLatencyMode()),(_=hb(e,b,m,y,_,i,a,r,s))&&((m=d_(y.g,"EXT-X-BITRATE"))?d.push({bitrate:m,duration:_.endTime-_.startTime}):d.length&&(m=d.pop(),m.duration+=_.endTime-_.startTime,d.push(m)),m=_,_.i=l,nb(e,a)&&null!=e.H&&h<e.H||g.push(_))}if(t=void 0,d.length&&(t=d.reduce(function(e,t){return e+t.duration},0),t=Math.round(d.reduce(function(e,t){return e+t.bitrate*t.duration},0)/t*1e3)),d=g.some(function(e){return null!=e.h}))for(n={},i=0;i<g.length;n={Zc:n.Zc,Yc:n.Yc,Rd:n.Rd,Sb:n.Sb,Vc:n.Vc},i++)if(n.Sb=g[i],null==n.Sb.h)for(n.Yc=0,n.Zc=i,r=function(e){return function(){var t=g[e.Zc];if(t){if(null!=t.h)return t.h+e.Yc;e.Yc-=t.endTime-t.startTime,e.Zc+=1}return null}}(n),n.Vc=0,n.Rd=i,o=function(e){return function(){var t=g[e.Rd];if(t){if(t!=e.Sb&&(e.Vc+=t.endTime-t.startTime),null!=t.h)return t.h+e.Vc;--e.Rd}return null}}(n);null==n.Sb.h;)n.Sb.h=o(),null==n.Sb.h&&(n.Sb.h=r());if(d)for(n=c(g),i=n.next();!i.done;i=n.next())for(r=i.value,i=r.h,r=c(r.g),o=r.next();!o.done;o=r.next())o=o.value,o.h=i,i+=o.endTime-o.startTime;if(n=e.fa,d&&1/0!=n&&!nb(e,a))for(e=c(g),i=e.next();!i.done;i=e.next())i.value.jg(n);return{segments:g,bandwidth:t}}function vb(e,t){if(e==Ln){if("vtt"==t||"wvtt"==t)return"text/vtt";if(t&&""!==t)return"application/mp4"}return"image"!=e||t&&"jpeg"!=t?"audio"==e&&"mp4a.40.34"==t?"audio/mpeg":"mjpg"==t?"application/mp4":null:"image/jpeg"}function yb(e){return e==Ln?"text/vtt":Db[e].mp4}function _b(e,t){e=wb(e)?Math.trunc((t.length-1)/2):0;for(var n=t[e];2==n.ac()&&e+1<t.length;)e++,n=t[e];return{segment:n,segmentIndex:e}}function bb(e,t,n,i){var r,a,o,s,l,u,c,d,f,h,p,g,m,v;return O(function(y){switch(y.g){case 1:return r=Qr,a=_b(e,i),o=a.segment,2==o.status?y.return(yb(t)):(s=o.M(),l=new ft(s[0]),u=l.Pa.split(".").pop(),c=Db[t],(d=c[u])||(d=Cb[u])||(d=vb(t,n))?y.return(d):(h=1,p=zr(s,e.g.retryParameters),w(y,2),p.method="HEAD",T(y,Ib(e,p,r,{type:h}),4)));case 4:g=y.h,f=g.headers["content-type"],I(y,3);break;case 2:if(m=x(y),!m||1002!=m.code&&1001!=m.code){y.u(3);break}return p.method="GET",T(y,Ib(e,p,r,{type:h}),6);case 6:v=y.h,f=v.headers["content-type"];case 3:return f?y.return(f.toLowerCase().split(";")[0]):y.return(yb(t))}})}function Eb(e,t,n,i,r,a,o){e&&(e.width=Number(t)||void 0,e.height=Number(n)||void 0,e.frameRate=Number(i)||void 0,e.hdr=r||void 0,e.videoLayout=a||void 0,e.colorGamut=o||void 0)}function Tb(e,t,n){return Ib(e,zr(t,e.g.retryParameters),0,{type:n?2:3})}function Sb(e){var t,n,i,r,a,o;return O(function(s){switch(s.g){case 1:return e.h?(w(s,2),t=Date.now(),T(s,e.update(),4)):s.return();case 4:n=Date.now(),wb(e)&&(i=(n-t)/1e3,e.Fb.sample(1,i),r=e.o,a=Math.max(0,r-Y(e.Fb)),e.A.Y(a)),I(s,3);break;case 2:if(o=x(s),!e.h)return s.return();if(e.g.raiseFatalErrorOnManifestUpdateRequestFailure)return e.h.onError(o),s.return();o.severity=1,e.h.onError(o),e.A.Y(.1);case 3:if(!e.h)return s.return();e.h.onManifestUpdated(),S(s)}})}function wb(e){return e.xa!=Lb}function Ab(e,t){e.xa=t,e.j&&e.j.wc(!wb(e)),wb(e)||e.A.stop()}function Ib(e,t,n,i){if(!e.da)throw new Rt(2,7,7001);return t=e.h.networkingEngine.request(n,t,i),jr(e.da,t),t.promise}function xb(e){return"AES-128"==e||"AES-256"==e||"AES-256-CTR"==e}function Rb(e,t,n,i,r,a){var o,s,l,u,c,d,f,h,p,g,m,v,y,_,b;return O(function(E){switch(E.g){case 1:if("video/mp2t"==n)throw new Rt(2,4,4040);if(sn())throw new Rt(2,4,4041);if(o=a_(t,"METHOD"),s=["SAMPLE-AES","SAMPLE-AES-CTR"],!s.includes(o))return E.return(null);if(l=f_(i(),a_(t,"URI"),a),l[0].startsWith("data:text/plain;base64,")){u=An(Sn(l[0].split("data:text/plain;base64,").pop())),E.u(2);break}return c=l.sort().join(""),e.qa.has(c)||(d=zr(l,e.g.retryParameters),f=Ib(e,d,6),e.qa.set(c,f)),T(E,e.qa.get(c),3);case 3:h=E.h,u=An(h.data);case 2:if(p="00000000000000000000000000000000",!r){E.u(4);break}if(e.ya.has(r)){g=e.ya.get(r),E.u(5);break}return m=Gu(r.M(),r.$b(),r.Xb(),e.g.retryParameters),v=Qr,T(E,Ib(e,m,v,{type:0}),6);case 6:y=E.h,g=Uu(y.data),e.ya.set(r,g);case 5:g&&(p=g);case 4:return _=new Map,_.set(p,u),b="cenc","SAMPLE-AES"==o&&(b="cbcs"),E.return(Cn(_,b))}})}K("shaka.net.DataUriPlugin",b_),b_.parse=E_,Hr("data",E_),i=S_.prototype,i.configure=function(e){this.g=e,this.l&&this.l.configure(this.g)},i.start=function(e,t){var n,i=this;return O(function(r){return 1==r.g?(i.h=t,i.I=t.isLowLatencyMode(),T(r,Tb(i,[e]),2)):3!=r.g?(n=r.h,i.L=n.uri,T(r,C_(i,n.data,e),3)):r.return(i.m)})},i.stop=function(){this.A&&(this.A.stop(),this.A=null);var e=[];return this.da&&(e.push(this.da.destroy()),this.da=null),this.g=this.h=null,this.wb.clear(),this.m=null,this.i.clear(),this.G.clear(),this.F.clear(),this.s.clear(),this.ra.clear(),this.pa.clear(),this.K.clear(),this.qa.clear(),this.ya.clear(),this.Ea.clear(),this.l&&this.l.destroy(),this.Z&&(this.Z.release(),this.Z=null),Promise.all(e)},i.update=function(){var e,t,n,i,r,a,o,s,l,u,f,h=this;return O(function(p){if(1==p.g){if(!wb(h))return p.return();for(e=[],t=Array.from(h.i.values()),h.o=1/0,h.m.gapCount=0,n=t.filter(function(e){return e.stream.segmentIndex}),i=c(n),r=i.next();!r.done;r=i.next())a=r.value,e.push(A_(h,a));return T(p,Promise.all(e),2)}for(eb(h,n.map(function(e){return e.stream})),o=n.some(function(e){return 0==e.xd}),n.length&&!o&&(s=Ob,Ab(h,s.zh),l=n.map(function(e){return e.Lb}),h.j.$a(Math.min.apply(Math,d(l))),h.h.updateDuration()),o&&k_(h),u=c(n),r=u.next();!r.done;r=u.next())f=r.value,f.stream.segmentIndex&&!f.stream.segmentIndex.O[0]&&h.h.disableStream(f.stream);S(p)})},i.onExpirationUpdated=function(){},i.onInitialVariantChosen=function(){},i.banLocation=function(e){this.l&&this.l.banLocation(e)},i.setMediaElement=function(e){this.aa=e},K("shaka.hls.HlsParser",S_);var Cb={aac:"audio/aac",ac3:"audio/ac3",ec3:"audio/ec3",mp3:"audio/mpeg"},Db={audio:{mp4:"audio/mp4",mp4a:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",m4f:"audio/mp4",cmfa:"audio/mp4",ts:"video/mp2t",tsa:"video/mp2t"},video:{mp4:"video/mp4",mp4v:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",m4f:"video/mp4",cmfv:"video/mp4",ts:"video/mp2t",tsv:"video/mp2t"},text:{mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",m4f:"application/mp4",cmft:"application/mp4",vtt:"text/vtt",webvtt:"text/vtt",ttml:"application/ttml+xml"},image:{jpg:"image/jpeg",png:"image/png",svg:"image/svg+xml",webp:"image/webp",avif:"image/avif"}},kb=new Set(["video/mp2t"].concat(d($n))),Mb={"com.apple.streamingkeydelivery":function(e,t){if("video/mp2t"==t)throw new Rt(2,4,4040);if(sn())throw new Rt(2,4,4041);if(t=a_(e,"METHOD"),!["SAMPLE-AES","SAMPLE-AES-CTR"].includes(t))return null;var n="cenc";return"SAMPLE-AES"==t&&(n="cbcs"),Rn("com.apple.fps",n,[{initDataType:"sinf",initData:new Uint8Array(0),keyId:null}],a_(e,"URI"))},"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":function(e){var t=a_(e,"METHOD");if(!["SAMPLE-AES","SAMPLE-AES-CTR"].includes(t))return null;var n="cenc";return"SAMPLE-AES"==t&&(n="cbcs"),t=a_(e,"URI"),t=T_(t.split("?")[0]),t=we(t.data),n=Rn("com.widevine.alpha",n,[{initDataType:"cenc",initData:t}]),(e=r_(e,"KEYID"))&&(n.keyIds=new Set([e.toLowerCase().substr(2)])),n},"com.microsoft.playready":function(e){var t=a_(e,"METHOD");if(!["SAMPLE-AES","SAMPLE-AES-CTR"].includes(t))return null;var n="cenc";return"SAMPLE-AES"==t&&(n="cbcs"),e=a_(e,"URI"),e=T_(e.split("?")[0]),e=we(e.data),t=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),e=Ta(e,t,new Set,0),Rn("com.microsoft.playready",n,[{initDataType:"cenc",initData:e}])}},Lb="VOD",Pb="EVENT",Nb="LIVE",Ob={zh:Lb,xj:Pb,Fj:Nb};function Fb(e){var t=0,n=Ie(e),i=n.getUint32(t,!0);if(i!=e.byteLength)return[];e:{for(e=t+6,t=[];e<n.byteLength-1;){i=n.getUint16(e,!0),e+=2;var r=n.getUint16(e,!0);if(e+=2,0!=(1&r)||r+e>n.byteLength){n=[];break e}var a=we(n,e,r);t.push({type:i,value:a}),e+=r}n=t}return n}function Ub(e){if(e=Bb(e))e:{e=c(Ma(e,"DATA"));for(var t=e.next();!t.done;t=e.next())if(t=La(t.value,"LA_URL")){e=Da(t);break e}e=""}else e="";return e}function Bb(e){return e=Sn(Da(e)),e=Fb(e).filter(function(e){return e.type===Gb})[0],e?(e=hn(e.value,!0),(e=wa(e,"WRMHEADER"))?e:null):null}zo["application/x-mpegurl"]=function(){return new S_},zo["application/vnd.apple.mpegurl"]=function(){return new S_};var Gb=1,jb=(new Map).set("com.microsoft.playready",Ub).set("com.microsoft.playready.recommendation",Ub).set("com.microsoft.playready.software",Ub).set("com.microsoft.playready.hardware",Ub);function Vb(e){if(!Jb){Jb=!0;var t=new Uint8Array([105,115,111,109]),n=new Uint8Array([97,118,99,49]),i=new Uint8Array([0,0,0,1]);dE=Qb("ftyp",t,i,t,n),t=Qb("dref",fE),hE=Qb("dinf",t)}this.g=e}function Hb(e){for(var t=[],n=c(e.g),i=n.next();!i.done;i=n.next()){var r=t,a=r.push,o=i.value;i=Qb;var s=o.id+1,l=o.stream.width||0,u=o.stream.height||0;"audio"==o.type&&(u=l=0);var f=o.duration*o.timescale,h=Math.floor(f/(eE+1));switch(f=Math.floor(f%(eE+1)),s=new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(d($b(s,4)),[0,0,0,0],d($b(h,4)),d($b(f,4)),[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0],d($b(l,2)),[0,0],d($b(u,2)),[0,0])),s=Qb("tkhd",s),l=Qb,h=o.duration*o.timescale,u=Math.floor(h/(eE+1)),h=Math.floor(h%(eE+1)),f=o.stream.language,f=f.charCodeAt(0)-96<<10|f.charCodeAt(1)-96<<5|f.charCodeAt(2)-96,u=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(d($b(o.timescale,4)),d($b(u,4)),d($b(h,4)),d($b(f,2)),[0,0])),u=Qb("mdhd",u),h=o,f=new Uint8Array([]),h.type){case"video":f=nE;break;case"audio":f=iE}h=Qb("hdlr",f);e:{switch(o.type){case"video":o=Qb("minf",Qb("vmhd",lE),hE,Kb(o));break e;case"audio":o=Qb("minf",Qb("smhd",uE),hE,Kb(o));break e}o=new Uint8Array([])}o=l("mdia",u,h,o),i=i("trak",s,o),a.call(r,i)}for(t=In.apply(bn,d(t)),a=e.g[0],n=Qb,i=a.duration*a.timescale,r=Math.floor(i/(eE+1)),i=Math.floor(i%(eE+1)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(d($b(a.timescale,4)),d($b(r,4)),d($b(i,4)),[0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255])),r=Qb("mvhd",r),i=[],e=c(e.g),l=e.next();!l.done;l=e.next())o=i,s=o.push,l=new Uint8Array([0,0,0,0].concat(d($b(l.value.id+1,4)),[0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1])),l=Qb("trex",l),s.call(o,l);if(e=In.apply(bn,d(i)),e=Qb("mvex",e),i=[],a.encrypted){for(a=c(a.stream.drmInfos),o=a.next();!o.done;o=a.next())if(o=o.value,o.initData)for(o=c(o.initData),s=o.next();!s.done;s=o.next())i.push(s.value.initData);a=In.apply(bn,d(i))}else a=new Uint8Array([]);return e=n("moov",r,t,e,a),t=new Uint8Array(dE.byteLength+e.byteLength),t.set(dE),t.set(e,dE.byteLength),t}function Kb(e){var t=Qb,n=new Uint8Array([]);switch(e.type){case"video":if(e.codecs.includes("avc1")){n=e.stream.width||0;var i=e.stream.height||0;if(0<e.wa.byteLength)var r=Qb("avcC",e.wa);else{r=Qb;for(var a=7,o=[],s=[],l=0,u=0,c=0,f=0;f<e.ab.length;f++){var h=Xb(e.ab[f]);switch(31&h[0]){case 7:o.push(h),a+=h.length+2;break;case 8:s.push(h),a+=h.length+2}}for(0<o.length&&(l=o[0][1],c=o[0][2],u=o[0][3]),a=new Uint8Array(a),f=0,a[f++]=1,a[f++]=l,a[f++]=c,a[f++]=u,a[f++]=255,a[f++]=224|o.length,l=0;l<o.length;l++)a[f++]=(65280&o[l].length)>>8,a[f++]=255&o[l].length,a.set(o[l],f),f+=o[l].length;for(a[f++]=s.length,o=0;o<s.length;o++)a[f++]=(65280&s[o].length)>>8,a[f++]=255&s[o].length,a.set(s[o],f),f+=s[o].length;r=r("avcC",a)}n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat(d($b(n,2)),d($b(i,2)),[0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17])),i="avc1",s=zb(e),o=new Uint8Array([]),e.encrypted&&(o=qb(e),i="encv"),n=Qb(i,n,r,s,o)}else e.codecs.includes("hvc1")&&(i=e.stream.width||0,r=e.stream.height||0,n=new Uint8Array([]),0<e.wa.byteLength&&(n=Qb("hvcC",e.wa)),i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat(d($b(i,2)),d($b(r,2)),[0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17])),r="hvc1",s=zb(e),o=new Uint8Array([]),e.encrypted&&(o=qb(e),r="encv"),n=Qb(r,i,n,s,o));break;case"audio":e.codecs.includes("mp3")?e=Qb(".mp3",Zb(e)):e.codecs.includes("ac-3")?(n=Qb("dac3",e.ma),i="ac-3",r=new Uint8Array([]),e.encrypted&&(r=qb(e),i="enca"),e=Qb(i,Zb(e),n,r)):e.codecs.includes("ec-3")?(n=Qb("dec3",e.ma),i="ec-3",r=new Uint8Array([]),e.encrypted&&(r=qb(e),i="enca"),e=Qb(i,Zb(e),n,r)):e.codecs.includes("opus")?(n=Qb("dOps",e.ma),i="Opus",r=new Uint8Array([]),e.encrypted&&(r=qb(e),i="enca"),e=Qb(i,Zb(e),n,r)):(0<e.ma.byteLength?n=Qb("esds",e.ma):(n=Qb,i=e.id+1,r=e.stream.channelsCount||2,o=e.stream.audioSamplingRate||44100,l=Dn("audio",e.codecs.split(",")),u={96000:0,88200:1,64000:2,48000:3,44100:4,32000:5,24000:6,22050:7,16000:8,12000:9,11025:10,8000:11,7350:12},s=u[o],"mp4a.40.5"!==l&&"mp4a.40.29"!==l||(s=u[2*o]),o=parseInt(l.split(".").pop(),10),i=new Uint8Array([0,0,0,0,3,25].concat(d($b(i,2)),[0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,o<<3|s>>>1,s<<7|r<<3,6,1,2])),n=n("esds",i)),i="mp4a",r=new Uint8Array([]),e.encrypted&&(r=qb(e),i="enca"),e=Qb(i,Zb(e),n,r)),n=e}return e=Qb("stsd",cE,n),t("stbl",e,Qb("stts",rE),Qb("stsc",aE),Qb("stsz",sE),Qb("stco",oE))}function zb(e){if(!e.Ba&&!e.Ca)return new Uint8Array([]);var t=e.Ca;return e=new Uint8Array([].concat(d($b(e.Ba,4)),d($b(t,4)))),Qb("pasp",e)}function Zb(e){return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.stream.channelsCount||2,0,16,0,0,0,0].concat(d($b(e.stream.audioSamplingRate||44100,2)),[0,0]))}function qb(e){for(var t=Qb,n=e.codecs.substring(0,e.codecs.indexOf(".")),i=0,r=0;r<n.length;r+=1)i|=n.charCodeAt(r)<<8*(n.length-r-1);n=new Uint8Array([].concat(d($b(i,4)))),n=Qb("frma",n),i=new Uint8Array([0,0,0,0,99,101,110,99,0,1,0,0]),i=Qb("schm",i),r=Qb;var a=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);e=c(e.stream.drmInfos);for(var o=e.next();!o.done;o=e.next())if((o=o.value)&&o.keyIds&&o.keyIds.size){o=c(o.keyIds);for(var s=o.next();!s.done;s=o.next())a=Xb(s.value)}return e=new Uint8Array([0,0,0,0,0,0,1,8]),a=Qb("tenc",e,a),t("sinf",n,i,r("schi",a))}function Yb(e){var t=[];e=c(e.g);for(var n=e.next();!n.done;n=e.next()){n=n.value;var i,r=t.push,a=r.apply,o=Qb,s=new Uint8Array([0,0,0,0].concat(d($b(n.data?n.data.sb:0,4))));s=Qb("mfhd",s);var l=n.data?n.data.Za:[],u=new Uint8Array(4+l.length);for(i=0;i<l.length;i++){var f=l[i].flags;u[i+4]=f.Va<<4|f.Xa<<2|f.Wa}l=Qb("sdtp",u);var h=l.length+92;u=Qb,i=new Uint8Array([0,0,0,58].concat(d($b(n.id+1,4)),[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),i=Qb("tfhd",i),f=n.data?n.data.baseMediaDecodeTime:0;var p=Math.floor(f%(eE+1));f=new Uint8Array([1,0,0,0].concat(d($b(Math.floor(f/(eE+1)),4)),d($b(p,4)))),f=Qb("tfdt",f);var g=h;h=n.data?n.data.Za:[],p=h.length;var m=12+16*p,v=new Uint8Array(m);for(g+=8+m,v.set(["video"===n.type?1:0,0,15,1].concat(d($b(p,4)),d($b(g,4))),0),g=0;g<p;g++){var y=h[g];m=$b(y.duration,4);var _=$b(y.size,4),b=y.flags;y=$b(y.eb,4),v.set([].concat(d(m),d(_),[b.hb<<2|b.Va,b.Xa<<6|b.Wa<<4|b.ib,61440&b.Ua,15&b.Ua],d(y)),12+16*g)}h=Qb("trun",v),l=u("traf",i,f,h,l),o=o("moof",s,l),a.call(r,t,[o,Wb(n)])}return In.apply(bn,d(t))}function Wb(e){return e=(e.data?e.data.Za:[]).map(function(e){return e.data}),e=In.apply(bn,d(e)),Qb("mdat",e)}function $b(e,t){var n=[];for(--t;0<=t;t--)n.push(e>>8*t&255);return n}function Xb(e){for(var t=new Uint8Array(e.length/2),n=0;n<e.length/2;n+=1)t[n]=parseInt(String(e[2*n]+e[2*n+1]),16);return t}function Qb(e){var t=F.apply(1,arguments),n=tE[e];n||(n=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)],tE[e]=n);for(var i=8,r=t.length-1;0<=r;r--)i+=t[r].byteLength;for(r=new Uint8Array(i),r[0]=i>>24&255,r[1]=i>>16&255,r[2]=i>>8&255,r[3]=255&i,r.set(n,4),n=0,i=8;n<t.length;n++)r.set(t[n],i),i+=t[n].byteLength;return r}var Jb=!1,eE=Math.pow(2,32)-1,tE={},nE=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),iE=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),rE=new Uint8Array([0,0,0,0,0,0,0,0]),aE=new Uint8Array([0,0,0,0,0,0,0,0]),oE=new Uint8Array([0,0,0,0,0,0,0,0]),sE=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),lE=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),uE=new Uint8Array([0,0,0,0,0,0,0,0]),cE=new Uint8Array([0,0,0,0,0,0,0,1]),dE=new Uint8Array([]),fE=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),hE=new Uint8Array([]);function pE(){var e=this;this.h=this.g=null,this.l=[],this.j=null,this.s=1,this.i=null,this.B=new q(5),this.o=new Ft(function(){gE(e)}),this.A=new Gr,this.m=new Map}function gE(e){var t;O(function(n){switch(n.g){case 1:return w(n,2),T(n,mE(e),4);case 4:I(n,3);break;case 2:t=x(n),e.h&&(t.severity=1,e.h.onError(t));case 3:if(!e.h)return n.return();S(n)}})}function mE(e){var t,n,i,r,a,o,s;return O(function(l){if(1==l.g)return t=zr(e.l,e.g.retryParameters),n=e.h.networkingEngine,i=Date.now(),r=n.request(0,t,{type:5}),jr(e.A,r),T(l,r.promise,2);if(a=l.h,!e.h)return l.return();a.uri&&!e.l.includes(a.uri)&&e.l.unshift(a.uri);var u=a.uri,f=a.data,h=e.g.mss.manifestPreprocessor;if(h!=Oc){if(pe("manifest.mss.manifestPreprocessor configuration","Please Use manifest.mss.manifestPreprocessorTXml instead."),f=_y(f,"SmoothStreamingMedia"),!f)throw new Rt(2,4,4046,u);h(f),f=gn(f.outerHTML)}var p=Sa(f,"SmoothStreamingMedia");if(!p)throw new Rt(2,4,4046,u);if(u=e.g.mss.manifestPreprocessorTXml,u!=Fc&&u(p),e.i||(e.i=new Ll(null,0)),u=Na(p,"IsLive",Za,!1))throw new Rt(2,4,4047);e.i.wc(!u),h=Na(p,"TimeScale",Ka,1e7),f=Na(p,"DVRWindowLength",Ka),u&&(0===f||isNaN(f))&&(f=1/0);var g,m=Na(p,"CanSeek",Za,!1);for(0===f&&m&&(f=1/0),m=null,f&&0<f&&(m=f/h),u&&!isNaN(e.g.availabilityWindowOverride)&&(m=e.g.availabilityWindowOverride),null==m&&(m=1/0),e.i.Ie(m),f=Na(p,"Duration",Ka,1/0),u||e.i.$a(f/h),u={variants:[],textStreams:[],timescale:h,duration:f/h},m=Ca(p,"Protection"),h=e.g.mss.keySystemsBySystemId,f=[],m=c(m),g=m.next();!g.done;g=m.next())f=f.concat(Ca(g.value,"ProtectionHeader"));if(f.length){for(m=[],g=0;g<f.length;g++){var v=f[g],y=v.attributes.SystemID.toLowerCase(),_=h[y];if(_){var b=Bb(v);if(b)e:{b=c(Ma(b,"DATA"));for(var E=b.next();!E.done;E=b.next())if(E=La(E.value,"KID")){b=Sn(Da(E)),b=new Uint8Array([b[3],b[2],b[1],b[0],b[5],b[4],b[7],b[6]].concat(d(b.slice(8)))),b=An(b);break e}b=null}else b=null;E=Sn(Da(v)),y=wn(y.replace(/-/g,"")),y=[{initData:Ta(E,y,new Set,0),initDataType:"cenc",keyId:b}],y=Rn(_,"cenc",y),b&&y.keyIds.add(b),(_=jb.get(_))&&(y.licenseServerUri=_(v)),m.push(y)}}h=m}else h=[];for(g=h,m=[],h=[],f=[],p=Ca(p,"StreamIndex"),p=c(p),v=p.next();!v.done;v=p.next()){v=v.value,_=Ca(v,"QualityLevel"),y=u.timescale,b=u.duration,E=Ca(v,"c");for(var w=[],A=0,I=0;I<E.length;++I){var x=E[I],R=E[I+1],C=Na(x,"t",Ka),D=Na(x,"d",Ka);if(x=Na(x,"r",Va),!D)break;if(C=null!=C?C:A,x=x||0,0>x)if(R){if(R=Na(R,"t",Ka),null==R)break;if(C>=R)break;x=Math.ceil((R-C)/D)-1}else{if(1/0==b)break;if(C/y>=b)break;x=Math.ceil((b*y-C)/D)-1}for(R=0;R<=x;++R)A=C+D,w.push({start:C/y,end:A/y,og:C}),C=A}for(y=w,_=c(_),b=_.next();!b.done;b=_.next())(b=vE(e,v,b.value,y,g,u))&&("audio"!=b.type||e.g.disableAudio?"video"!=b.type||e.g.disableVideo?b.type!=Ln||e.g.disableText||f.push(b):h.push(b):m.push(b))}for(p=[],m=c(0<m.length?m:[null]),g=m.next();!g.done;g=m.next())for(g=g.value,v=c(0<h.length?h:[null]),b=v.next();!b.done;b=v.next())_=p,y=_.push,b=b.value,E=0,g&&g.bandwidth&&0<g.bandwidth&&(E+=g.bandwidth),b&&b.bandwidth&&0<b.bandwidth&&(E+=b.bandwidth),b={id:e.s++,language:g?g.language:"und",disabledUntilTime:0,primary:!!g&&g.primary||!!b&&b.primary,audio:g,video:b,bandwidth:E,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},y.call(_,b);u.variants=p,u.textStreams=f,e.j?(e.j.variants=u.variants,e.j.textStreams=u.textStreams,e.h.filter(e.j)):(e.j={presentationTimeline:e.i,variants:u.variants,textStreams:u.textStreams,imageStreams:[],offlineSessionIds:[],minBufferTime:0,sequenceMode:e.g.mss.sequenceMode,ignoreManifestTimestampsInSegmentsMode:!1,type:"MSS",serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1},e.i.re()),Promise.resolve(),o=Date.now(),s=(o-i)/1e3,e.B.sample(1,s),S(l)})}function vE(e,t,n,i,r,a){var o=t.attributes.Type;if("audio"!==o&&"video"!==o&&"text"!==o)return Q("Ignoring unrecognized type:",o),null;var s=t.attributes.Language,l=e.s++,u=Na(n,"Bitrate",Ha),c=Na(n,"MaxWidth",Ha),d=Na(n,"MaxHeight",Ha),f=Na(n,"Channels",Ha),h=Na(n,"SamplingRate",Ha),p=a.duration;i.length&&(p=i[i.length-1].end-i[0].start);var g=e.i.getDuration();e.i.$a(Math.min(p,g));var m={id:l,originalId:t.attributes.Name||String(l),groupId:null,createSegmentIndex:function(){return Promise.resolve()},closeSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:"",codecs:"",frameRate:void 0,pixelAspectRatio:void 0,bandwidth:u||0,width:c||void 0,height:d||void 0,kind:"",encrypted:0<r.length,drmInfos:r,keyIds:new Set,language:fi(s||"und"),originalLanguage:s,label:"",type:"",primary:!1,trickModeVideo:null,emsgSchemeIdUris:[],roles:[],forced:!1,channelsCount:f,audioSamplingRate:h,spatialAudio:!1,closedCaptions:null,hdr:void 0,colorGamut:void 0,videoLayout:void 0,tilesLayout:void 0,matchedStreams:[],mssPrivateData:{duration:p,timescale:a.timescale,codecPrivateData:null},accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set};if((r=t.attributes.Subtype)&&((r=SE[r])&&m.roles.push(r),"main"===r&&(m.primary=!0)),r=n.attributes.FourCC,null!==r&&""!==r||(r=t.attributes.FourCC),!r)if("audio"===o)r="AAC";else if("video"===o)return Q('FourCC is not defined whereas it is required for a QualityLevel element for a StreamIndex of type "video"'),null;if(!TE.includes(r.toUpperCase()))return Q("Codec not supported:",r),null;switch(n=yE(n,o,r,m),m.mssPrivateData.codecPrivateData=n,o){case"audio":if(!n)return Q("Quality unsupported without CodecPrivateData",o),null;m.type="audio",m.mimeType="mss/audio/mp4",m.codecs=_E(r,n);break;case"video":if(!n)return Q("Quality unsupported without CodecPrivateData",o),null;m.type="video",m.mimeType="mss/video/mp4",m.codecs=bE(n);break;case"text":m.type=Ln,m.mimeType="application/mp4",("TTML"===r||"DFXP"===r)&&(m.codecs="stpp")}return m.fullMimeTypes.add(Un(m.mimeType,m.codecs)),m.createSegmentIndex=function(){if(m.segmentIndex)return Promise.resolve();if(e.m.has(m.id))var n=e.m.get(m.id);else n=[],"video"==m.type&&(n=m.mssPrivateData.codecPrivateData.split("00000001").slice(1)),n={id:m.id,type:m.type,codecs:m.codecs,encrypted:m.encrypted,timescale:m.mssPrivateData.timescale,duration:m.mssPrivateData.duration,ab:n,ma:new Uint8Array([]),wa:new Uint8Array([]),Ba:0,Ca:0,data:null,stream:m},n=Hb(new Vb([n])),e.m.set(m.id,n);return n=EE(e,new $o(function(){return[]},0,null,Lu(m),m.mssPrivateData.timescale,n),m,t,i),m.segmentIndex=new tu(n),Promise.resolve()},m.closeSegmentIndex=function(){m.segmentIndex&&(m.segmentIndex.release(),m.segmentIndex=null)},m}function yE(e,t,n,i){if(e=e.attributes.CodecPrivateData)return e;if("audio"!==t)return null;t=i.channelsCount||2,e=i.audioSamplingRate||44100;var r={96000:0,88200:1,64000:2,48000:3,44100:4,32000:5,24000:6,22050:7,16000:8,12000:9,11025:10,8000:11,7350:12};return i=r[e],"AACH"===n?(n=new Uint8Array(4),e=r[2*e],n[0]=40|i>>1,n[1]=i<<7|t<<3|e>>1,n[2]=e<<7|8,n[3]=0,t=new Uint16Array(2),t[0]=(n[0]<<8)+n[1],t[1]=(n[2]<<8)+n[3],t[0].toString(16)+t[1].toString(16)):(n=new Uint8Array(2),n[0]=16|i>>1,n[1]=i<<7|t<<3,t=new Uint16Array(1),t[0]=(n[0]<<8)+n[1],t[0].toString(16))}function _E(e,t){var n=0;return"AACH"===e&&(n=5),t?0===n&&(n=(248&parseInt(t.substr(0,2),16))>>3):(n=2,"AACH"===e&&(n=5)),"mp4a.40."+n}function bE(e){var t=/00000001[0-9]7/.exec(e);return t.length&&e?"avc1."+e.substr(e.indexOf(t[0])+10,6):""}function EE(e,t,n,i,r){var a=i.attributes.Url.replace("{bitrate}",String(n.bandwidth));i=[];var o={};r=c(r);for(var s=r.next();!s.done;o={fd:o.fd},s=r.next())o.fd=s.value,i.push(new Qo(o.fd.start,o.fd.end,function(t){return function(){return xn(e.l,[a.replace("{start time}",String(t.fd.og))])}}(o),0,null,t,0,0,n.mssPrivateData.duration));return i}i=pE.prototype,i.configure=function(e){this.g=e},i.start=function(e,t){var n=this;return O(function(i){if(1==i.g)return n.l=[e],n.h=t,T(i,mE(n),2);if(!n.h)throw new Rt(2,7,7001);return i.return(n.j)})},i.stop=function(){return this.g=this.h=null,this.l=[],this.j=null,null!=this.o&&(this.o.stop(),this.o=null),this.m.clear(),this.A.destroy()},i.update=function(){var e,t=this;return O(function(n){return 1==n.g?(w(n,2),T(n,mE(t),4)):2!=n.g?I(n,0):(e=x(n),t.h&&e?(t.h.onError(e),void S(n)):n.return())})},i.onExpirationUpdated=function(){},i.onInitialVariantChosen=function(){},i.banLocation=function(){},i.setMediaElement=function(){},K("shaka.mss.MssParser",pE);var TE="AAC AACL AACH AACP AVC1 H264 TTML DFXP".split(" "),SE={CAPT:"main",SUBT:"alternate",DESC:"main"};function wE(e,t,n,i,r,a){if(200<=n&&299>=n&&202!=n)return{uri:r||i,originalUri:i,data:t,status:n,headers:e,fromCache:!!e["x-shaka-from-cache"]};var o=null;try{o=pn(t)}catch(e){}throw new Rt(401==n||403==n?2:1,1,1001,i,n,o,e,a,r||i)}function AE(){}function IE(e,t,n,i,r){var a=new LE;aa(t.headers).forEach(function(e,t){a.append(t,e)});var o=new kE,s={zg:!1,th:!1};if(e=xE(e,n,{body:t.body||void 0,headers:a,method:t.method,signal:o.signal,credentials:t.allowCrossSiteCredentials?"include":void 0},s,i,r,t.streamDataCallback),e=new Cr(e,function(){return s.zg=!0,o.abort(),Promise.resolve()}),t=t.retryParameters.timeout){var l=new Ft(function(){s.th=!0,o.abort()});l.Y(t/1e3),e.finally(function(){l.stop()})}return e}function xE(e,t,n,i,r,a,o){var s,l,u,c,d,f,h,p,g,m,v,y,_;return O(function(b){switch(b.g){case 1:return s=DE,l=ME,f=d=0,h=Date.now(),w(b,2),T(b,s(e,n),4);case 4:if(u=b.h,a(RE(u.headers)),"HEAD"==n.method){b.u(5);break}return p=u.clone().body.getReader(),m=(g=u.headers.get("Content-Length"))?parseInt(g,10):0,v=function(e){function t(){var n,i,a;return O(function(s){switch(s.g){case 1:return w(s,2),T(s,p.read(),4);case 4:n=s.h,I(s,3);break;case 2:return x(s),s.return();case 3:if(n.done){s.u(5);break}if(d+=n.value.byteLength,!o){s.u(5);break}return T(s,o(n.value),5);case 5:i=Date.now(),(100<i-h||n.done)&&(a=n.done?0:m-d,r(i-h,d-f,a),f=d,h=i),n.done?e.close():(e.enqueue(n.value),t()),S(s)}})}t()},new l({start:v}),T(b,u.arrayBuffer(),6);case 6:c=b.h;case 5:I(b,3);break;case 2:if(y=x(b),i.zg)throw new Rt(1,1,7001,e,t);if(i.th)throw new Rt(1,1,1003,e,t);throw new Rt(1,1,1002,e,y,t);case 3:return _=RE(u.headers),b.return(wE(_,c,u.status,e,u.url,t))}})}function RE(e){var t={};return e.forEach(function(e,n){t[n.trim()]=e}),t}function CE(){if(!e.ReadableStream)return!1;try{new ReadableStream({})}catch(e){return!1}return!!e.Response&&(!!new Response("").body&&!(!e.fetch||"polyfill"in e.fetch||!e.AbortController))}zo["application/vnd.ms-sstr+xml"]=function(){return new pE},K("shaka.net.HttpFetchPlugin",AE),AE.isSupported=CE,AE.parse=IE;var DE=e.fetch,kE=e.AbortController,ME=e.ReadableStream,LE=e.Headers;function PE(){}function NE(e,t,n,i,r){var a=new FE,o=Date.now(),s=0,l=new Promise(function(l,u){a.open(t.method,e,!0),a.responseType="arraybuffer",a.timeout=t.retryParameters.timeout,a.withCredentials=t.allowCrossSiteCredentials,a.onabort=function(){u(new Rt(1,1,7001,e,n))};var c=!1;for(var d in a.onreadystatechange=function(){if(2==a.readyState&&!c){var e=OE(a);r(e),c=!0}},a.onload=function(t){var r=OE(a),c=a.response;try{i(Date.now()-o,t.loaded-s,0);var d=wE(r,c,a.status,e,a.responseURL,n);l(d)}catch(e){u(e)}},a.onerror=function(t){u(new Rt(1,1,1002,e,t,n))},a.ontimeout=function(){u(new Rt(1,1,1003,e,n))},a.onprogress=function(e){var t=Date.now();(100<t-o||e.lengthComputable&&e.loaded==e.total)&&(i(t-o,e.loaded-s,4==a.readyState?0:e.total-e.loaded),s=e.loaded,o=t)},t.headers)a.setRequestHeader(d.toLowerCase(),t.headers[d]);a.send(t.body)});return new Cr(l,function(){return a.abort(),Promise.resolve()})}function OE(e){var t=e.getAllResponseHeaders().trim().split("\r\n");e={},t=c(t);for(var n=t.next();!n.done;n=t.next())n=n.value.split(": "),e[n[0].toLowerCase()]=n.slice(1).join(": ");return e}CE()&&(Hr("http",IE,2,!0),Hr("https",IE,2,!0),Hr("blob",IE,2,!0)),K("shaka.net.HttpXHRPlugin",PE),PE.parse=NE;var FE=e.XMLHttpRequest;function UE(e,t,n,i){this.g=e,this.i=t,this.groupId=n,this.h=i}function BE(e){return e.M().map(function(e){return"{"+encodeURI(e)+"}"}).join("")+":"+e.Ha+":"+e.sa}function GE(e,t){return Gu(e.g.M(),e.g.Ha,e.g.sa,t.streaming.retryParameters)}function jE(){this.h=this.j=this.i=0,this.g=new Map,this.l=0}function VE(e,t){e.i+=t;var n=e.l;return e.l++,e.g.set(n,t),n}function HE(e){var t=this;this.o=e,this.j=new Map,this.i=new ta(function(){return zE(t).catch(function(){})}),this.h=[],this.m=function(){},this.l=function(){},this.g=new jE}function KE(e,t,n){e.m=t,e.l=n}function zE(e){var t=e.h.map(function(e){return e()});return e.h=[],Promise.all(t)}function ZE(e,t,n,i,r,a){na(e.i);var o=(e.j.get(t)||Promise.resolve()).then(function(){var t,o,s,l,u,c,d;return O(function(f){if(1==f.g)return T(f,YE(e,n),2);if(t=f.h,e.i.g)throw new Rt(2,9,7001);if(r)for(l in o=we(t),s=new Ea(o),s.data)u=Number(l),c=s.data[u],d=s.g[u],e.l(c,d);e.g.close(i,t.byteLength);var h=e.g;return e.m(0==h.i?0:h.j/h.i,e.g.h),f.return(a(t))})});e.j.set(t,o)}function qE(e){return O(function(t){return 1==t.g?T(t,Promise.all(e.j.values()),2):t.return(e.g.h)})}function YE(e,t){var n,i,r,a;return O(function(o){return 1==o.g?(n=Qr,i=e.o.request(n,t),r=function(){return i.abort()},e.h.push(r),T(o,i.promise,2)):(a=o.h,Oe(e.h,r),o.return(a.data))})}function WE(e,t){var n=this;this.i=e,this.h=e.objectStore(t),this.g=new Rr,e.onabort=function(e){e.preventDefault(),n.g.reject()},e.onerror=function(e){e.preventDefault(),n.g.reject()},e.oncomplete=function(){n.g.resolve()}}function $E(e,t){return new Promise(function(n,i){var r=e.h.openCursor();r.onerror=i,r.onsuccess=function(){var e;return O(function(i){if(1==i.g)return null==r.result?(n(),i.return()):(e=r.result,T(i,t(e.key,e.value,e),2));e.continue(),S(i)})}})}function XE(e){this.h=e,this.g=[]}function QE(e,t){return JE(e,t,"readwrite")}function JE(e,t,n){n=e.h.transaction([t],n);var i=new WE(n,t);return e.g.push(i),i.promise().then(function(){Oe(e.g,i)},function(){Oe(e.g,i)}),i}function eT(e,t,n){this.h=new XE(e),this.i=t,this.g=n}function tT(e,t,n){e=QE(e.h,e.g);var i=e.store();return i.get(t).onsuccess=function(){i.put(n,t)},e.promise()}function nT(e){return Promise.reject(new Rt(2,9,9011,"Cannot add new value to "+e))}function iT(e,t,n,i){e=QE(e.h,t),t=e.store();var r={};n=c(n);for(var a=n.next();!a.done;r={Wd:r.Wd},a=n.next())r.Wd=a.value,t.delete(r.Wd).onsuccess=function(e){return function(){return i(e.Wd)}}(r);return e.promise()}function rT(e,t,n){var i,r,a,o,s,l,u;return O(function(d){if(1==d.g){for(i=JE(e.h,t,"readonly"),r=i.store(),a={},o=[],s={},l=c(n),u=l.next();!u.done;s={dd:s.dd,ad:s.ad},u=l.next())s.ad=u.value,s.dd=r.get(s.ad),s.dd.onsuccess=function(e){return function(){void 0==e.dd.result&&o.push(e.ad),a[e.ad]=e.dd.result}}(s);return T(d,i.promise(),2)}if(o.length)throw new Rt(2,9,9012,"Could not find values for "+o);return d.return(n.map(function(e){return a[e]}))})}function aT(e){this.g=new XE(e)}function oT(){this.g=new Map}function sT(e){var t=null;if(e.g.forEach(function(e,n){e.getCells().forEach(function(e,i){e.hasFixedKeySpace()||t||(t={path:{ob:n,Ja:i},Ja:e})})}),t)return t;throw new Rt(2,9,9013,"Could not find a cell that supports add-operations")}function lT(e,t){e.g.forEach(function(e,n){e.getCells().forEach(function(e,i){t({ob:n,Ja:i},e)})})}function uT(e,t,n){if(e=e.g.get(t),!e)throw new Rt(2,9,9013,"Could not find mechanism with name "+t);if(t=e.getCells().get(n),!t)throw new Rt(2,9,9013,"Could not find cell with name "+n);return t}function cT(e,t){e.g.forEach(function(e){t(e.getEmeSessionCell())})}function dT(e){var t=Array.from(e.g.keys());if(!t.length)throw new Rt(2,9,9e3,"No supported storage mechanisms found");return e.g.get(t[0]).getEmeSessionCell()}function fT(e){var t,n,i;return O(function(r){return 1==r.g?(t=Array.from(e.g.values()),n=0<t.length,n||(i=pT,i.forEach(function(e){(e=e())&&t.push(e)})),T(r,Promise.all(t.map(function(e){return e.erase()})),2)):n?r.u(0):T(r,Promise.all(t.map(function(e){return e.destroy()})),0)})}function hT(e,t){pT.set(e,t)}Hr("http",NE,1,!0),Hr("https",NE,1,!0),Hr("blob",NE,1,!0),jE.prototype.close=function(e,t){if(this.g.has(e)){var n=this.g.get(e);this.g.delete(e),this.j+=n,this.h+=t}},HE.prototype.destroy=function(){return this.i.destroy()},WE.prototype.abort=function(){var e=this;return O(function(t){if(1==t.g){try{e.i.abort()}catch(e){}return w(t,2),T(t,e.g,4)}if(2!=t.g)return I(t,0);x(t),S(t)})},WE.prototype.store=function(){return this.h},WE.prototype.promise=function(){return this.g},XE.prototype.destroy=function(){return Promise.all(this.g.map(function(e){return e.abort()}))},i=eT.prototype,i.destroy=function(){return this.h.destroy()},i.hasFixedKeySpace=function(){return!0},i.addSegments=function(){return nT(this.i)},i.removeSegments=function(e,t){return iT(this,this.i,e,t)},i.getSegments=function(e){var t,n=this;return O(function(i){return 1==i.g?T(i,rT(n,n.i,e),2):(t=i.h,i.return(t.map(function(e){return n.Cg(e)})))})},i.addManifests=function(){return nT(this.g)},i.updateManifest=function(){return Promise.reject(new Rt(2,9,9016,"Cannot modify values in "+this.g))},i.updateManifestExpiration=function(e,t){var n=QE(this.h,this.g),i=n.store();return i.get(e).onsuccess=function(n){(n=n.target.result)&&(n.expiration=t,i.put(n,e))},n.promise()},i.removeManifests=function(e,t){return iT(this,this.g,e,t)},i.getManifests=function(e){var t,n=this;return O(function(i){return 1==i.g?T(i,rT(n,n.g,e),2):(t=i.h,i.return(Promise.all(t.map(function(e){return n.od(e)}))))})},i.getAllManifests=function(){var e,t,n=this;return O(function(i){return 1==i.g?(e=JE(n.h,n.g,"readonly"),t=new Map,T(i,$E(e,function(e,i){var r;return O(function(a){if(1==a.g)return T(a,n.od(i),2);r=a.h,t.set(e,r),S(a)})}),2)):3!=i.g?T(i,e.promise(),3):i.return(t)})},i.Cg=function(e){return e},i.od=function(e){return Promise.resolve(e)},i.add=function(e,t){var n,i,r,a,o,s,l,u=this;return O(function(d){if(1==d.g){for(n=QE(u.h,e),i=n.store(),r=[],a={},o=c(t),s=o.next();!s.done;a={Xd:a.Xd},s=o.next())l=s.value,a.Xd=i.add(l),a.Xd.onsuccess=function(e){return function(){r.push(e.Xd.result)}}(a);return T(d,n.promise(),2)}return d.return(r)})},aT.prototype.destroy=function(){return this.g.destroy()},aT.prototype.getAll=function(){var e,t,n=this;return O(function(i){return 1==i.g?(e=JE(n.g,"session-ids","readonly"),t=[],T(i,$E(e,function(e,n){t.push(n)}),2)):3!=i.g?T(i,e.promise(),3):i.return(t)})},aT.prototype.add=function(e){var t=QE(this.g,"session-ids"),n=t.store();e=c(e);for(var i=e.next();!i.done;i=e.next())n.add(i.value);return t.promise()},aT.prototype.remove=function(e){var t,n=this;return O(function(i){return 1==i.g?(t=QE(n.g,"session-ids"),T(i,$E(t,function(t,n,i){e.includes(n.sessionId)&&i.delete()}),2)):T(i,t.promise(),0)})},oT.prototype.destroy=function(){for(var e=[],t=c(this.g.values()),n=t.next();!n.done;n=t.next())e.push(n.value.destroy());return this.g.clear(),Promise.all(e)},oT.prototype.init=function(){var e=this;pT.forEach(function(t,n){(t=t())&&e.g.set(n,t)});for(var t=[],n=c(this.g.values()),i=n.next();!i.done;i=n.next())t.push(i.value.init());return Promise.all(t)},K("shaka.offline.StorageMuxer",oT),oT.unregister=function(e){pT.delete(e)},oT.register=hT,oT.prototype.destroy=oT.prototype.destroy;var pT=new Map;function gT(){eT.apply(this,arguments)}function mT(e,t){_T(e);for(var n=c(e.streams),i=n.next();!i.done;i=n.next());return e.streams.map(function(n){return vT(n,e.startTime,t)})}function vT(e,t,n){var i=e.initSegmentUri?yT(e.initSegmentUri):null,r=t+e.presentationTimeOffset,a=t+n;return{id:e.id,originalId:null,groupId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:void 0,hdr:void 0,colorGamut:void 0,videoLayout:void 0,kind:e.kind,language:e.language,originalLanguage:e.language||null,label:e.label,width:e.width,height:e.height,initSegmentKey:i,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map(function(e){var n=yT(e.uri);return{startTime:t+e.startTime,endTime:t+e.endTime,dataKey:n,initSegmentKey:i,appendWindowStart:t,appendWindowEnd:a,timestampOffset:r,tilesLayout:"",mimeType:null,codecs:null}}),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0,external:!1,fastSwitching:!1}}function yT(e){var t;if((t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))||(t=/^offline:segment\/([0-9]+)$/.exec(e)))return Number(t[1]);throw new Rt(2,9,9004,"Could not parse uri "+e)}function _T(e){var t=e.streams.filter(function(e){return"audio"==e.contentType});if(e=e.streams.filter(function(e){return"video"==e.contentType}),!t.every(function(e){return e.variantIds})||!e.every(function(e){return e.variantIds})){for(var n=c(t),i=n.next();!i.done;i=n.next())i.value.variantIds=[];for(n=c(e),i=n.next();!i.done;i=n.next())i.value.variantIds=[];if(n=0,e.length&&!t.length){var r=n++,a=c(e);for(i=a.next();!i.done;i=a.next())i.value.variantIds.push(r)}if(!e.length&&t.length)for(r=n++,a=c(t),i=a.next();!i.done;i=a.next())i.value.variantIds.push(r);if(e.length&&t.length)for(t=c(t),i=t.next();!i.done;i=t.next())for(i=i.value,r=c(e),a=r.next();!a.done;a=r.next()){a=a.value;var o=n++;i.variantIds.push(o),a.variantIds.push(o)}}}function bT(){eT.apply(this,arguments)}function ET(e,t,n){return{id:e.id,originalId:e.originalId,groupId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:e.pixelAspectRatio,hdr:void 0,colorGamut:void 0,videoLayout:void 0,kind:e.kind,language:e.language,originalLanguage:e.language||null,label:e.label,width:e.width,height:e.height,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map(function(i){return{startTime:t+i.startTime,endTime:t+i.endTime,initSegmentKey:e.initSegmentKey,appendWindowStart:t,appendWindowEnd:n,timestampOffset:t-e.presentationTimeOffset,dataKey:i.dataKey,tilesLayout:"",mimeType:null,codecs:null}}),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0,external:!1,fastSwitching:!1}}function TT(){eT.apply(this,arguments)}function ST(){this.m=this.j=this.i=this.h=this.g=this.l=null}function wT(){var t=new Rr,n=e.indexedDB.deleteDatabase("shaka_offline_db");return n.onblocked=function(){},n.onsuccess=function(){t.resolve()},n.onerror=function(e){t.reject(new Rt(2,9,9001,n.error)),e.preventDefault()},t}function AT(e,t,n,i){this.g=e,this.i=t,this.h=n,this.l=i,this.j=["offline:",e,"/",t,"/",n,"/",i].join("")}function IT(e){if(e=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(e),null==e)return null;var t=e[1];if("manifest"!=t&&"segment"!=t)return null;var n=e[2];if(!n)return null;var i=e[3];return i&&null!=t?new AT(t,n,i,Number(e[4])):null}function xT(e,t){this.h=e,this.g=t}function RT(e,t){var n=new Ll(null,0);n.$a(t.duration);var i=t.streams.filter(function(e){return"audio"==e.type}),r=t.streams.filter(function(e){return"video"==e.type});i=CT(e,i,r,n),r=t.streams.filter(function(e){return e.type==Ln}).map(function(t){return DT(e,t,n)});var a=t.streams.filter(function(e){return"image"==e.type}).map(function(t){return DT(e,t,n)}),o=t.drmInfo?[t.drmInfo]:[];if(t.drmInfo)for(var s=c(i.values()),l=s.next();!l.done;l=s.next())l=l.value,l.audio&&l.audio.encrypted&&(l.audio.drmInfos=o),l.video&&l.video.encrypted&&(l.video.drmInfos=o);return{presentationTimeline:n,minBufferTime:2,offlineSessionIds:t.sessionIds,variants:Array.from(i.values()),textStreams:r,imageStreams:a,sequenceMode:t.sequenceMode||!1,ignoreManifestTimestampsInSegmentsMode:!1,type:t.type||"UNKNOWN",serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1}}function CT(e,t,n,i){for(var r=new Set,a=c(t),o=a.next();!o.done;o=a.next()){var s=c(o.value.variantIds);for(o=s.next();!o.done;o=s.next())r.add(o.value)}for(a=c(n),o=a.next();!o.done;o=a.next())for(s=c(o.value.variantIds),o=s.next();!o.done;o=s.next())r.add(o.value);for(a=new Map,r=c(r),o=r.next();!o.done;o=r.next())o=o.value,a.set(o,{id:o,language:"",disabledUntilTime:0,primary:!1,audio:null,video:null,bandwidth:0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});for(t=c(t),r=t.next();!r.done;r=t.next())for(r=r.value,o=DT(e,r,i),s=c(r.variantIds),r=s.next();!r.done;r=s.next())r=a.get(r.value),r.language=o.language,r.primary=r.primary||o.primary,r.audio=o;for(n=c(n),t=n.next();!t.done;t=n.next())for(r=t.value,t=DT(e,r,i),o=c(r.variantIds),r=o.next();!r.done;r=o.next())r=a.get(r.value),r.primary=r.primary||t.primary,r.video=t;return a}function DT(e,t,n){var i=t.segments.map(function(n){return kT(e,n,t)});return n.Jd(i),{id:t.id,originalId:t.originalId,groupId:t.groupId,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new tu(i),mimeType:t.mimeType,codecs:t.codecs,width:t.width||void 0,height:t.height||void 0,frameRate:t.frameRate,pixelAspectRatio:t.pixelAspectRatio,hdr:t.hdr,colorGamut:t.colorGamut,videoLayout:t.videoLayout,kind:t.kind,encrypted:t.encrypted,drmInfos:[],keyIds:t.keyIds,language:t.language,originalLanguage:t.originalLanguage||null,label:t.label,type:t.type,primary:t.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:t.roles,forced:t.forced,channelsCount:t.channelsCount,audioSamplingRate:t.audioSamplingRate,spatialAudio:t.spatialAudio,closedCaptions:t.closedCaptions,tilesLayout:t.tilesLayout,accessibilityPurpose:null,external:t.external,fastSwitching:t.fastSwitching,fullMimeTypes:new Set([Un(t.mimeType,t.codecs)])}}function kT(e,t,n){var i=new AT("segment",e.h,e.g,t.dataKey);return e=new Qo(t.startTime,t.endTime,function(){return[i.toString()]},0,null,null!=t.initSegmentKey?MT(e,t.initSegmentKey):null,t.timestampOffset,t.appendWindowStart,t.appendWindowEnd,[],t.tilesLayout||""),e.mimeType=t.mimeType||n.mimeType||"",e.codecs=t.codecs||n.codecs||"",e}function MT(e,t){var n=new AT("segment",e.h,e.g,t);return new $o(function(){return[n.toString()]},0,null)}function LT(){this.g=null}function PT(){}function NT(e){var t=IT(e);return t&&"manifest"==t.g?(e={uri:e,originalUri:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}},e=Mr(e)):e=t&&"segment"==t.g?OT(t.key(),t):Dr(new Rt(2,1,9004,e)),e}function OT(e,t){var n=new oT;return Mr(void 0).Aa(function(){return n.init()}).Aa(function(){return uT(n,t.ob(),t.Ja())}).Aa(function(e){return e.getSegments([t.key()])}).Aa(function(e){return{uri:t,data:e[0].data,headers:{}}}).finally(function(){return n.destroy()})}function FT(e,t,n){var i,r,a,o,s,l;return O(function(u){switch(u.g){case 1:i=[];for(var d=[],f=c(n),h=f.next();!h.done;h=f.next()){h=h.value;for(var p=!1,g=c(d),m=g.next();!m.done;m=g.next())if(m=m.value,BT(m.info,h)){m.sessionIds.push(h.sessionId),p=!0;break}p||d.push({info:h,sessionIds:[h.sessionId]})}r=c(d),a=r.next();case 2:if(a.done){u.u(4);break}return o=a.value,s=UT(e,t,o),T(u,s,5);case 5:l=u.h,i=i.concat(l),a=r.next(),u.u(2);break;case 4:return u.return(i)}})}function UT(e,t,n){var i,r;return O(function(a){switch(a.g){case 1:return i=new Ja({Nb:t,onError:function(){},Ae:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),w(a,2),i.configure(e),T(a,io(i,n.info.keySystem,n.info.licenseUri,n.info.serverCertificate,n.info.audioCapabilities,n.info.videoCapabilities),4);case 4:I(a,3);break;case 2:return x(a),T(a,i.destroy(),5);case 5:return a.return([]);case 3:return r=[],T(a,Promise.all(n.sessionIds.map(function(e){return O(function(t){return 1==t.g?(w(t,2),T(t,lo(i,e),4)):2!=t.g?(r.push(e),I(t,0)):(x(t),void S(t))})})),6);case 6:return T(a,i.destroy(),7);case 7:return a.return(r)}})}function BT(e,t){function n(e,t){return e.robustness==t.robustness&&e.contentType==t.contentType}return e.keySystem==t.keySystem&&e.licenseUri==t.licenseUri&&Fe(e.audioCapabilities,t.audioCapabilities,n)&&Fe(e.videoCapabilities,t.videoCapabilities,n)}function GT(e,t,n){var i=t.presentationTimeline.getDuration();return t=VT(t),{offlineUri:null,originalManifestUri:e,duration:i,size:0,expiration:1/0,tracks:t,appMetadata:n,isIncomplete:!1}}function jT(e,t){var n=RT(new xT(e.ob(),e.Ja()),t),i=t.appMetadata||{};return n=VT(n),{offlineUri:e.toString(),originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:t.expiration,tracks:n,appMetadata:i,isIncomplete:t.isIncomplete||!1}}function VT(e){var t=[],n=qi(e.variants);n=c(n);for(var i=n.next();!i.done;i=n.next())t.push(Bi(i.value));for(e=c(e.textStreams),n=e.next();!n.done;n=e.next())t.push(Gi(n.value));return t}function HT(){this.g={}}function KT(e,t){var n=t.audio,i=t.video;if(n&&!i&&(e.g[n.id]=n.bandwidth||t.bandwidth),!n&&i&&(e.g[i.id]=i.bandwidth||t.bandwidth),n&&i){var r=n.bandwidth||393216,a=i.bandwidth||t.bandwidth-r;0>=a&&(a=t.bandwidth),e.g[n.id]=r,e.g[i.id]=a}}function zT(e,t){e.g[t.id]=t.bandwidth||2048}function ZT(e,t){return e=e.g[t],null==e&&(e=0),e}function qT(e){var t=this;if(e&&e.constructor!=ef)throw new Rt(2,9,9008);this.g=this.h=null,e?(this.h=e.g,this.g=e.zb()):(this.h=Lc(),this.g=new Vr),this.i=[],this.j=[];var n=!e;this.l=new ta(function(){var e,i,r,a,o;return O(function(s){switch(s.g){case 1:return T(s,Promise.all(t.j.map(function(e){return zE(e)})),2);case 2:for(e=function(){},i=[],r=c(t.i),a=r.next();!a.done;a=r.next())o=a.value,i.push(o.then(e,e));return T(s,Promise.all(i),3);case 3:if(!n){s.u(4);break}return T(s,t.g.destroy(),4);case 4:t.h=null,t.g=null,S(s)}})})}function YT(){if(Ut())e:{for(var e=c(pT.values()),t=e.next();!t.done;t=e.next())if(t=t.value,t=t()){t.destroy(),e=!0;break e}e=!1}else e=!1;return e}function WT(e,t,n,i,r,a){var o,s,l,u,c,d,f,h,p,g,m,v,y,_;return O(function(b){switch(b.g){case 1:return gS(),s=o=null,l=new oT,d=c=u=null,w(b,2,3),T(b,i(),5);case 5:return o=b.h,T(b,cS(e,t,o,r),6);case 6:if(f=b.h,pS(e),h=!f.presentationTimeline.V()&&!f.presentationTimeline.qc(),!h)throw new Rt(2,9,9005,t);return T(b,e.Dc(f,function(e){d=d||e},r),7);case 7:if(s=b.h,pS(e),d)throw d;return T(b,JT(f,s,r),8);case 8:return T(b,l.init(),9);case 9:return pS(e),T(b,sT(l),10);case 10:return u=b.h,pS(e),p=eS(s,f,t,n,r,a),g=p.Bi,m=p.lg,T(b,u.Ja.addManifests([g]),11);case 11:if(v=b.h,pS(e),c=v[0],pS(e),d)throw d;return T(b,$T(e,m,c,g,a,r,u.Ja,f,s),12);case 12:return pS(e),iS(f,g,s,r),T(b,u.Ja.updateManifest(c,g),13);case 13:return pS(e),y=new AT("manifest",u.path.ob,u.path.Ja,c),b.return(jT(y,g));case 3:return R(b),T(b,l.destroy(),14);case 14:if(!o){b.u(15);break}return T(b,o.stop(),15);case 15:if(!s){b.u(17);break}return T(b,s.destroy(),17);case 17:C(b,0);break;case 2:if(_=x(b),null==c){b.u(19);break}return T(b,XT(c),19);case 19:throw d||_}})}function $T(e,t,n,i,r,a,o,s,l){var u,d,f,h,p,g,m,v,y,_;return O(function(b){switch(b.g){case 1:if(u={},d=0,f=function(t,f){var h,p,g,m,v,y,_;return O(function(b){if(1==b.g){for(h={},p=c(t),g=p.next();!g.done;h={ic:h.ic},g=p.next())h.ic=g.value,m=GE(h.ic,a),v=h.ic.i,y=h.ic.h,_=function(t){return function(n){var i,r,a;return O(function(s){if(1==s.g)return T(s,o.addSegments([{data:n}]),2);i=s.h,pS(e),r=t.ic.g,a=BE(r),u[a]=i[0],d+=n.byteLength,S(s)})}}(h),ZE(r,h.ic.groupId,m,v,y,_);return T(b,qE(r),2)}return f?(pS(e),iS(s,i,l,a),T(b,o.updateManifest(n,i),0)):b.u(0)})},h=!1,w(b,2),!tS(s)||!h||nS(s)){b.u(4);break}return T(b,f(t.filter(function(e){return e.h}),!0),5);case 5:return pS(e),t=t.filter(function(e){return!e.h}),p=u,g=d,u={},d=0,T(b,QT(o,n,i,p,g,function(){return pS(e)}),6);case 6:pS(e);case 4:if(h){b.u(7);break}return T(b,f(t,!1),8);case 8:return pS(e),m=u,v=d,u={},d=0,T(b,QT(o,n,i,m,v,function(){return pS(e)}),9);case 9:pS(e);case 7:I(b,0);break;case 2:return y=x(b),_=Object.values(u),T(b,o.removeSegments(_,function(){}),10);case 10:throw y}})}function XT(e){var t,n,i,r;return O(function(a){switch(a.g){case 1:return t=new oT,T(a,t.init(),2);case 2:return T(a,sT(t),3);case 3:return n=a.h,i=new AT("manifest",n.path.ob,n.path.Ja,e),T(a,t.destroy(),4);case 4:return r=new qT,T(a,r.remove(i.toString()),0)}})}function QT(e,t,n,i,r,a){var o,s,l,u,d,f,h,p,g,m,v;return O(function(y){switch(y.g){case 1:for(o=!1,w(y,2),s=!0,l=c(n.streams),u=l.next();!u.done;u=l.next())for(d=u.value,f=c(d.segments),h=f.next();!h.done;h=f.next())p=h.value,g=p.pendingSegmentRefId?i[p.pendingSegmentRefId]:null,null!=g&&(p.dataKey=g,p.pendingSegmentRefId=void 0),g=p.pendingInitSegmentRefId?i[p.pendingInitSegmentRefId]:null,null!=g&&(p.initSegmentKey=g,p.pendingInitSegmentRefId=void 0),p.pendingSegmentRefId&&(s=!1),p.pendingInitSegmentRefId&&(s=!1);return n.size+=r,s&&(n.isIncomplete=!1),T(y,e.updateManifest(t,n),4);case 4:o=!0,a(),I(y,0);break;case 2:return m=x(y),T(y,XT(t),5);case 5:if(o){y.u(6);break}return v=Object.values(i),T(y,e.removeSegments(v,function(){}),6);case 6:throw m}})}function JT(e,t,n){var i,r,a,o,s,l,u,d,f,h,p,g,m,v,y,_,b,E,A,R,C,D,k,M,L,P,N,F;return O(function(O){switch(O.g){case 1:return i={width:1/0,height:1/0},Si(e,n.restrictions,i),T(O,xi(t,e,n.offline.usePersistentLicense,n.drm.preferredKeySystems),2);case 2:for(r=[],a=n.preferredDecodingAttributes,o=n.preferredVideoCodecs,s=n.preferredAudioCodecs,Ei(e,o,s,a),l=c(e.variants),u=l.next();!u.done;u=l.next())d=u.value,r.push(Bi(d));for(f=c(e.textStreams),h=f.next();!h.done;h=f.next())p=h.value,r.push(Gi(p));for(g=c(e.imageStreams),m=g.next();!m.done;m=g.next())v=m.value,r.push(ji(v));return T(O,n.offline.trackSelectionCallback(r),3);case 3:for(y=O.h,_=e.presentationTimeline.getDuration(),b=0,E=c(y),A=E.next();!A.done;A=E.next())R=A.value,C=R.bandwidth*_/8,b+=C;return w(O,4),T(O,n.offline.downloadSizeCallback(b),6);case 6:if(D=O.h,!D)throw new Rt(2,9,9014);I(O,5);break;case 4:if(k=x(O),k instanceof Rt)throw k;throw new Rt(2,9,9015);case 5:for(M=new Set,L=new Set,P=new Set,N=c(y),A=N.next();!A.done;A=N.next())F=A.value,"variant"==F.type&&M.add(F.id),"text"==F.type&&L.add(F.id),"image"==F.type&&P.add(F.id);e.variants=e.variants.filter(function(e){return M.has(e.id)}),e.textStreams=e.textStreams.filter(function(e){return L.has(e.id)}),e.imageStreams=e.imageStreams.filter(function(e){return P.has(e.id)}),ES(e),S(O)}})}function eS(e,t,n,i,r,a){var o=GT(n,t,i),s=r.offline.progressCallback;KE(a,function(e,t){o.size=t,s(o,e)},function(t,n){l&&r.offline.usePersistentLicense&&u==n&&co(e,"cenc",t)});var l=tS(t)&&!nS(t),u=null;l&&(u=TS.get(e.g.keySystem));for(var d=new HT,f=c(t.textStreams),h=f.next();!h.done;h=f.next())d.g[h.value.id]=52;for(f=c(t.imageStreams),h=f.next();!h.done;h=f.next())zT(d,h.value);for(h=c(t.variants),f=h.next();!f.done;f=h.next())KT(d,f.value);return d=dS(a,d,t,r),a=d.streams,d=d.lg,h=e.g,f=r.offline.usePersistentLicense,h&&f&&(h.initData=[]),{Bi:{creationTime:Date.now(),originalManifestUri:n,duration:t.presentationTimeline.getDuration(),size:0,expiration:e.td(),streams:a,sessionIds:f?fo(e):[],drmInfo:h,appMetadata:i,isIncomplete:!0,sequenceMode:t.sequenceMode,type:t.type},lg:d}}function tS(e){return e.variants.some(function(e){var t=e.audio&&e.audio.encrypted;return e.video&&e.video.encrypted||t})}function nS(e){return e.variants.some(function(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[]).some(function(e){return e.initData&&e.initData.length})})}function iS(e,t,n,i){if(t.expiration=n.td(),n=fo(n),t.sessionIds=i.offline.usePersistentLicense?n:[],tS(e)&&i.offline.usePersistentLicense&&!n.length)throw new Rt(2,9,9007)}function rS(e,t){var n,i,r,a,o,s;return O(function(l){switch(l.g){case 1:if(gS(),n=IT(t),null==n||"manifest"!=n.g)throw new Rt(2,9,9004,t);return i=n,r=new oT,A(l,2),T(l,r.init(),4);case 4:return T(l,uT(r,i.ob(),i.Ja()),5);case 5:return a=l.h,T(l,a.getManifests([i.key()]),6);case 6:return o=l.h,s=o[0],T(l,Promise.all([oS(e,s,r),sS(a,i,s)]),2);case 2:return R(l),T(l,r.destroy(),8);case 8:C(l,0)}})}function aS(e,t){for(var n=[],i=c(e.streams),r=i.next();!r.done;r=i.next())r=r.value,t&&"video"==r.type?n.push({contentType:Un(r.mimeType,r.codecs),robustness:e.drmInfo.videoRobustness}):t||"audio"!=r.type||n.push({contentType:Un(r.mimeType,r.codecs),robustness:e.drmInfo.audioRobustness});return n}function oS(e,t,n){return O(function(i){return T(i,_S(e.g,e.h.drm,n,t),0)})}function sS(e,t,n){function i(){}var r=yS(n);return jT(t,n),Promise.all([e.removeSegments(r,i),e.removeManifests([t.key()],i)])}function lS(e){var t,n,i,r,a,o,s,l,u,d;return O(function(f){switch(f.g){case 1:return gS(),t=e.g,n=e.h.drm,i=new oT,r=!1,A(f,2),T(f,i.init(),4);case 4:a=[],cT(i,function(e){return a.push(e)}),o=c(a),s=o.next();case 5:if(s.done){f.u(2);break}return l=s.value,T(f,l.getAll(),8);case 8:return u=f.h,T(f,FT(n,t,u),9);case 9:return d=f.h,T(f,l.remove(d),10);case 10:d.length!=u.length&&(r=!0),s=o.next(),f.u(5);break;case 2:return R(f),T(f,i.destroy(),11);case 11:C(f,3);break;case 3:return f.return(!r)}})}function uS(){var e,t,n;return O(function(i){switch(i.g){case 1:return gS(),e=[],t=new oT,A(i,2),T(i,t.init(),4);case 4:return n=Promise.resolve(),lT(t,function(t,i){n=n.then(function(){var n;return O(function(r){if(1==r.g)return T(r,i.getAllManifests(),2);n=r.h,n.forEach(function(n,i){n=jT(new AT("manifest",t.ob,t.Ja,i),n),e.push(n)}),S(r)})})}),T(i,n,2);case 2:return R(i),T(i,t.destroy(),6);case 6:C(i,3);break;case 3:return i.return(e)}})}function cS(e,t,n,i){var r,a,o,s,l;return O(function(u){if(1==u.g)return r=null,a=e.g,o={networkingEngine:a,filter:function(){return Promise.resolve()},makeTextStreamsForClosedCaptions:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(e){r=e},isLowLatencyMode:function(){return!1},isAutoLowLatencyMode:function(){return!1},enableLowLatencyMode:function(){},updateDuration:function(){},newDrmInfo:function(){},onManifestUpdated:function(){},getBandwidthEstimate:function(){return i.abr.defaultBandwidthEstimate},onMetadata:function(){},disableStream:function(){}},n.configure(i.manifest),pS(e),T(u,n.start(t,o),2);if(3!=u.g)return s=u.h,pS(e),l=bS(s),T(u,Promise.all(ia(l,function(e){return e.createSegmentIndex()})),3);if(pS(e),r)throw r;return u.return(s)})}function dS(e,t,n,i){var r=new Map,a=bS(n),o=new Map;a=c(a);for(var s=a.next();!s.done;s=a.next()){s=s.value;var l=fS(e,t,n,s,i,r);o.set(s.id,l)}for(e=c(n.variants),t=e.next();!t.done;t=e.next())t=t.value,t.audio&&o.get(t.audio.id).variantIds.push(t.id),t.video&&o.get(t.video.id).variantIds.push(t.id);return{streams:Array.from(o.values()),lg:Array.from(r.values())}}function fS(e,t,n,i,r,a){var o={id:i.id,originalId:i.originalId,groupId:i.groupId,primary:i.primary,type:i.type,mimeType:i.mimeType,codecs:i.codecs,frameRate:i.frameRate,pixelAspectRatio:i.pixelAspectRatio,hdr:i.hdr,colorGamut:i.colorGamut,videoLayout:i.videoLayout,kind:i.kind,language:i.language,originalLanguage:i.originalLanguage,label:i.label,width:i.width||null,height:i.height||null,encrypted:i.encrypted,keyIds:i.keyIds,segments:[],variantIds:[],roles:i.roles,forced:i.forced,channelsCount:i.channelsCount,audioSamplingRate:i.audioSamplingRate,spatialAudio:i.spatialAudio,closedCaptions:i.closedCaptions,tilesLayout:i.tilesLayout,external:i.external,fastSwitching:i.fastSwitching},s=r.offline.numberOfParallelDownloads,l=0;return hS(i,n.presentationTimeline.nb(),function(n){var r=BE(n),u=void 0;if(!a.has(r)){var c=n.endTime-n.startTime;c=ZT(t,i.id)*c,c=VE(e.g,c),a.set(r,new UE(n,c,l,!1))}n.$&&(u=BE(n.$),a.has(u)||(c=.5*ZT(t,i.id),c=VE(e.g,c),a.set(u,new UE(n.$,c,l,!0)))),o.segments.push({pendingInitSegmentRefId:u,initSegmentKey:u?0:null,startTime:n.startTime,endTime:n.endTime,appendWindowStart:n.appendWindowStart,appendWindowEnd:n.appendWindowEnd,timestampOffset:n.timestampOffset,tilesLayout:n.tilesLayout,pendingSegmentRefId:r,dataKey:0,mimeType:n.mimeType,codecs:n.codecs}),l=(l+1)%s}),o}function hS(e,t,n){if(t=e.segmentIndex.find(t),null!=t)for(var i=e.segmentIndex.get(t);i;)n(i),i=e.segmentIndex.get(++t)}function pS(e){if(e.l.g)throw new Rt(2,9,7001)}function gS(){if(!YT())throw new Rt(2,9,9e3)}function mS(e,t){return O(function(n){return 1==n.g?(e.i.push(t),A(n,2),T(n,t,4)):2!=n.g?n.return(n.h):(R(n),Oe(e.i,t),C(n,0))})}function vS(e,t){var n=t.promise;return e.i.push(n),t.finally(function(){Oe(e.i,n)})}function yS(e){var t=new Set;e=c(e.streams);for(var n=e.next();!n.done;n=e.next()){n=c(n.value.segments);for(var i=n.next();!i.done;i=n.next())i=i.value,null!=i.initSegmentKey&&t.add(i.initSegmentKey),t.add(i.dataKey)}return Array.from(t)}function _S(e,t,n,i){var r,a,o;return O(function(s){return 1==s.g?i.drmInfo?(r=dT(n),a=i.sessionIds.map(function(e){return{sessionId:e,keySystem:i.drmInfo.keySystem,licenseUri:i.drmInfo.licenseServerUri,serverCertificate:i.drmInfo.serverCertificate,audioCapabilities:aS(i,!1),videoCapabilities:aS(i,!0)}}),T(s,FT(t,e,a),2)):s.return():3!=s.g?(o=s.h,T(s,r.remove(o),3)):T(s,r.add(a.filter(function(e){return!o.includes(e.sessionId)})),0)})}function bS(e){for(var t=new Set,n=c(e.textStreams),i=n.next();!i.done;i=n.next())t.add(i.value);for(n=c(e.imageStreams),i=n.next();!i.done;i=n.next())t.add(i.value);for(e=c(e.variants),n=e.next();!n.done;n=e.next())n=n.value,n.audio&&t.add(n.audio),n.video&&t.add(n.video);return t}function ES(e){e.variants.map(function(e){return e.video});var t=new Set(e.variants.map(function(e){return e.audio}));e=e.textStreams;for(var n=c(t),i=n.next();!i.done;i=n.next()){i=c(t);for(var r=i.next();!r.done;r=i.next());}for(t=c(e),n=t.next();!n.done;n=t.next())for(n=c(e),i=n.next();!i.done;i=n.next());}y(gT,eT),gT.prototype.updateManifestExpiration=function(e,t){var n,i,r,a=this;return O(function(o){return n=QE(a.h,a.g),i=n.store(),r=new Rr,i.get(e).onsuccess=function(n){(n=n.target.result)?(n.expiration=t,i.put(n),r.resolve()):r.reject(new Rt(2,9,9012,"Could not find values for "+e))},T(o,Promise.all([n.promise(),r]),0)})},gT.prototype.od=function(e){var t,n,i,r,a,o;return O(function(s){if(1==s.g){for(t=[],n=0;n<e.periods.length;++n)i=n==e.periods.length-1?e.duration:e.periods[n+1].startTime,r=i-e.periods[n].startTime,a=mT(e.periods[n],r),t.push(a);return T(s,Uv(t),2)}return o=s.h,s.return({creationTime:0,originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:null==e.expiration?1/0:e.expiration,streams:o,sessionIds:e.sessionIds,drmInfo:e.drmInfo,appMetadata:e.appMetadata,sequenceMode:!1})})},gT.prototype.Cg=function(e){return{data:e.data}},y(bT,eT),bT.prototype.od=function(e){var t,n,i,r,a,o;return O(function(s){if(1==s.g){for(t=[],n=0;n<e.periods.length;++n){i=n==e.periods.length-1?e.duration:e.periods[n+1].startTime,r=i-e.periods[n].startTime;for(var l=e.periods[n],u=[],d=c(l.streams),f=d.next();!f.done;f=d.next())f=f.value,0!=f.variantIds.length&&u.push(ET(f,l.startTime,l.startTime+r));a=u,t.push(a)}return T(s,Uv(t),2)}return o=s.h,s.return({appMetadata:e.appMetadata,creationTime:0,drmInfo:e.drmInfo,duration:e.duration,expiration:null==e.expiration?1/0:e.expiration,originalManifestUri:e.originalManifestUri,sessionIds:e.sessionIds,size:e.size,streams:o,sequenceMode:!1})})},y(TT,eT),i=TT.prototype,i.hasFixedKeySpace=function(){return!1},i.addSegments=function(e){return this.add(this.i,e)},i.addManifests=function(e){return this.add(this.g,e)},i.updateManifest=function(e,t){return tT(this,e,t)},i.od=function(e){return null==e.expiration&&(e.expiration=1/0),Promise.resolve(e)},i=ST.prototype,i.init=function(){var t=this,n=new Rr,i=!1,r=new Ft(function(){i=!0,n.reject(new Rt(2,9,9017))});r.Y(5);var a=e.indexedDB.open("shaka_offline_db",5);return a.onsuccess=function(){if(!i){var e=a.result;t.l=e;var o=e.objectStoreNames;o=o.contains("manifest")&&o.contains("segment")?new gT(e,"segment","manifest"):null,t.g=o,o=e.objectStoreNames,o=o.contains("manifest-v2")&&o.contains("segment-v2")?new bT(e,"segment-v2","manifest-v2"):null,t.h=o,o=e.objectStoreNames,o=o.contains("manifest-v3")&&o.contains("segment-v3")?new bT(e,"segment-v3","manifest-v3"):null,t.i=o,o=e.objectStoreNames,o=o.contains("manifest-v5")&&o.contains("segment-v5")?new TT(e,"segment-v5","manifest-v5"):null,t.j=o,e=e.objectStoreNames.contains("session-ids")?new aT(e):null,t.m=e,r.stop(),n.resolve()}},a.onupgradeneeded=function(){for(var e=a.result,t=c(["segment-v5","manifest-v5","session-ids"]),n=t.next();!n.done;n=t.next())n=n.value,e.objectStoreNames.contains(n)||e.createObjectStore(n,{autoIncrement:!0})},a.onerror=function(e){i||(n.reject(new Rt(2,9,9001,a.error)),r.stop(),e.preventDefault())},n},i.destroy=function(){var e=this;return O(function(t){switch(t.g){case 1:if(!e.g){t.u(2);break}return T(t,e.g.destroy(),2);case 2:if(!e.h){t.u(4);break}return T(t,e.h.destroy(),4);case 4:if(!e.i){t.u(6);break}return T(t,e.i.destroy(),6);case 6:if(!e.j){t.u(8);break}return T(t,e.j.destroy(),8);case 8:if(!e.m){t.u(10);break}return T(t,e.m.destroy(),10);case 10:e.l&&e.l.close(),S(t)}})},i.getCells=function(){var e=new Map;return this.g&&e.set("v1",this.g),this.h&&e.set("v2",this.h),this.i&&e.set("v3",this.i),this.j&&e.set("v5",this.j),e},i.getEmeSessionCell=function(){return this.m},i.erase=function(){var e=this;return O(function(t){switch(t.g){case 1:if(!e.g){t.u(2);break}return T(t,e.g.destroy(),2);case 2:if(!e.h){t.u(4);break}return T(t,e.h.destroy(),4);case 4:if(!e.i){t.u(6);break}return T(t,e.i.destroy(),6);case 6:if(!e.j){t.u(8);break}return T(t,e.j.destroy(),8);case 8:return e.l&&e.l.close(),T(t,wT(),10);case 10:return e.l=null,e.g=null,e.h=null,e.i=null,e.j=null,T(t,e.init(),0)}})},hT("idb",function(){return qt()||jt()||!e.indexedDB?null:new ST}),AT.prototype.ob=function(){return this.i},AT.prototype.Ja=function(){return this.h},AT.prototype.key=function(){return this.l},AT.prototype.toString=function(){return this.j},i=LT.prototype,i.configure=function(){},i.start=function(e,t){var n,i,r,a,o,s,l,u=this;return O(function(c){switch(c.g){case 1:if(n=IT(e),u.g=n,null==n||"manifest"!=n.g)throw new Rt(2,1,9004,e);return i=new oT,A(c,2),T(c,i.init(),4);case 4:return T(c,uT(i,n.ob(),n.Ja()),5);case 5:return r=c.h,T(c,r.getManifests([n.key()]),6);case 6:return a=c.h,o=a[0],s=new xT(n.ob(),n.Ja()),l=RT(s,o),t.makeTextStreamsForClosedCaptions(l),c.return(l);case 2:return R(c),T(c,i.destroy(),7);case 7:C(c,0)}})},i.stop=function(){return Promise.resolve()},i.update=function(){},i.onExpirationUpdated=function(e,t){var n,i,r,a,o,s,l,u=this;return O(function(c){switch(c.g){case 1:return n=u.g,i=new oT,w(c,2,3),T(c,i.init(),5);case 5:return T(c,uT(i,n.ob(),n.Ja()),6);case 6:return r=c.h,T(c,r.getManifests([n.key()]),7);case 7:if(a=c.h,o=a[0],s=o.sessionIds.includes(e),l=void 0==o.expiration||o.expiration>t,!s||!l){c.u(3);break}return T(c,r.updateManifestExpiration(n.key(),t),3);case 3:return R(c),T(c,i.destroy(),10);case 10:C(c,0);break;case 2:x(c),c.u(3)}})},i.onInitialVariantChosen=function(){},i.banLocation=function(){},i.setMediaElement=function(){},zo["application/x-offline-manifest"]=function(){return new LT},K("shaka.offline.OfflineScheme",PT),PT.plugin=NT,Hr("offline",NT),i=qT.prototype,i.destroy=function(){return this.l.destroy()},i.configure=function(e,t){return 2==arguments.length&&"string"==typeof e&&(e=wc(e,t)),Pc(this.h,e)},i.getConfiguration=function(){var e=Lc();return Pc(e,this.h,Lc()),e},i.zb=function(){return this.g},i.store=function(e,t,n){var i=this,r=this.getConfiguration(),a=new HE(this.g);return this.j.push(a),t=WT(this,e,t||{},function(){var t;return O(function(a){return 1==a.g?n?a.u(2):T(a,rd(e,i.g,r.manifest.retryParameters),3):(2!=a.g&&(n=a.h),t=Ko(e,n||null),a.return(t()))})},r,a),t=new Cr(t,function(){return zE(a)}),t.finally(function(){Oe(i.j,a)}),vS(this,t)},i.remove=function(e){return mS(this,rS(this,e))},i.Si=function(){return mS(this,lS(this))},i.list=function(){return mS(this,uS())},i.Dc=function(e,t,n){var i,r=this;return O(function(a){return 1==a.g?(i=new Ja({Nb:r.g,onError:t,Ae:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),i.configure(n.drm),T(a,to(i,e.variants,n.offline.usePersistentLicense),2)):3!=a.g?T(a,uo(i),3):a.return(i)})},K("shaka.offline.Storage",qT),qT.deleteAll=function(){var e;return O(function(t){return 1==t.g?(e=new oT,A(t,2),T(t,fT(e),2)):5!=t.g?(R(t),T(t,e.destroy(),5)):C(t,0)})},qT.prototype.list=qT.prototype.list,qT.prototype.removeEmeSessions=qT.prototype.Si,qT.prototype.remove=qT.prototype.remove,qT.prototype.store=qT.prototype.store,qT.prototype.getNetworkingEngine=qT.prototype.zb,qT.prototype.getConfiguration=qT.prototype.getConfiguration,qT.prototype.configure=qT.prototype.configure,qT.prototype.destroy=qT.prototype.destroy,qT.support=YT;var TS=(new Map).set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.recommendation","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.software","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.hardware","9a04f07998404286ab92e65be0885f95");function SS(){}function wS(e,t){for(e={priority:t||0,callback:e},t=0;t<AS.length;t++)if(AS[t].priority<e.priority)return void AS.splice(t,0,e);AS.push(e)}_h.offline=YT,K("shaka.polyfill",SS),SS.register=wS,SS.installAll=function(){for(var e=c(AS),t=e.next();!t.done;t=e.next()){t=t.value;try{t.callback()}catch(e){Q("Error installing polyfill!",e)}}};var AS=[];function IS(){this.g=new RS}function xS(){e.AbortController||(e.AbortController=IS,e.AbortSignal=RS)}function RS(){Br.call(this),this.h=!1,this.g=void 0,this.onabort=null}function CS(){}function DS(){if(!Object.getOwnPropertyDescriptor(Element.prototype,"ariaHidden"))for(var e=c(["ariaHidden","ariaLabel","ariaPressed","ariaSelected"]),t=e.next();!t.done;t=e.next())kS(t.value)}function kS(e){var t="aria-"+e.toLowerCase().replace(/^aria/,"");Object.defineProperty(Element.prototype,e,{get:function(){return this.getAttribute(t)},set:function(e){null==e||void 0==e?this.removeAttribute(t):this.setAttribute(t,e)}})}function MS(){}function LS(){gx()}function PS(){}function NS(){if(e.Document){var t=Element.prototype;t.requestFullscreen=t.requestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen||t.webkitRequestFullscreen,t=Document.prototype,t.exitFullscreen=t.exitFullscreen||t.mozCancelFullScreen||t.msExitFullscreen||t.webkitCancelFullScreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}})),document.addEventListener("webkitfullscreenchange",OS),document.addEventListener("webkitfullscreenerror",OS),document.addEventListener("mozfullscreenchange",OS),document.addEventListener("mozfullscreenerror",OS),document.addEventListener("MSFullscreenChange",OS),document.addEventListener("MSFullscreenError",OS)}}function OS(e){var t=e.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),n=document.createEvent("Event");n.initEvent(t,e.bubbles,e.cancelable),e.target.dispatchEvent(n)}function FS(){}function US(){var e=!0;!qt()||qt()&&nn()||qt()&&an("Fuchsia")||(e=!1),(Wt()||$t()||Xt()||zt()||Vt()||an("PC=EOS")||Qt())&&(e=!1),e&&navigator.mediaCapabilities||(navigator.mediaCapabilities||(navigator.mediaCapabilities={}),HS=navigator.mediaCapabilities,navigator.mediaCapabilities.decodingInfo=BS)}function BS(e){var t,n,i,r,a,o,s,l,u,c,d;return O(function(f){switch(f.g){case 1:if(t={supported:!1,powerEfficient:!0,smooth:!0,keySystemAccess:null,configuration:e},n=e.video,i=e.audio,"media-source"!=e.type){if("file"!=e.type)return f.return(t);if(n&&(r=n.contentType,a=Bt(r),!a)||i&&(o=i.contentType,s=Bt(o),!s))return f.return(t);f.u(2);break}if(!Ut())return f.return(t);if(!n){f.u(3);break}return T(f,GS(n),4);case 4:if(l=f.h,!l)return f.return(t);case 3:if(i){var h=i.contentType;if(qt()&&i.spatialRendering&&(h+="; spatialRendering=true"),u=ce(h),!u)return f.return(t)}case 2:return e.keySystemConfiguration?(c=e.keySystemConfiguration,T(f,jS(n,i,c),6)):(t.supported=!0,f.return(t));case 6:(d=f.h)&&(t.supported=!0,t.keySystemAccess=d);case 5:return f.return(t)}})}function GS(e){var t,n;return O(function(i){return 1==i.g?qt()?T(i,VS(e),3):Vt()?(t=e.contentType,e.width&&e.height&&(t+="; width="+e.width,t+="; height="+e.height),e.framerate&&(t+="; framerate="+e.framerate),e.bitrate&&(t+="; bitrate="+e.bitrate),i.return(ce(t))):i.u(2):2!=i.g?(n=i.h,i.return(n)):i.return(ce(e.contentType))})}function jS(e,t,n){var i,r,a,o,s,l,u,c,d;return O(function(f){switch(f.g){case 1:if(i=[],r=[],n.audio&&(a={robustness:n.audio.robustness||"",contentType:t.contentType},Vt()&&t.contentType.includes('codecs="ac-3"')&&(a.contentType='audio/mp4; codecs="ec-3"'),n.audio.encryptionScheme&&(a.encryptionScheme=n.audio.encryptionScheme),i.push(a)),n.video&&(o={robustness:n.video.robustness||"",contentType:e.contentType},n.video.encryptionScheme&&(o.encryptionScheme=n.video.encryptionScheme),r.push(o)),s={initDataTypes:[n.initDataType],distinctiveIdentifier:n.distinctiveIdentifier,persistentState:n.persistentState,sessionTypes:n.sessionTypes},i.length&&(s.audioCapabilities=i),r.length&&(s.videoCapabilities=r),l=e?e.contentType:"",u=t?t.contentType:"",c=n.keySystem,d=null,w(f,2),Nt.has(l+"#"+u+"#"+c)){d=Nt.get(l+"#"+u+"#"+c)||null,f.u(4);break}return T(f,navigator.requestMediaKeySystemAccess(n.keySystem,[s]),5);case 5:d=f.h,Nt.set(l+"#"+u+"#"+c,d);case 4:I(f,3);break;case 2:x(f);case 3:return f.return(d)}})}function VS(t){var n,i;return O(function(r){return 1==r.g?e.cast&&cast.__platform__&&cast.__platform__.canDisplayType?(n=t.contentType,t.width&&t.height&&(n+="; width="+t.width+"; height="+t.height),t.framerate&&(n+="; framerate="+t.framerate),"pq"===t.transferFunction&&(n+="; eotf=smpte2084"),i=!1,n in $S?(i=$S[n],r.u(2)):T(r,cast.__platform__.canDisplayType(n),3)):r.return(ce(t.contentType)):(2!=r.g&&(i=r.h,$S[n]=i),r.return(i))})}IS.prototype.abort=function(e){var t=this.g;t.h||(t.h=!0,t.g=e,void 0===t.g&&(t.g=new DOMException("signal is aborted without reason","AbortError")),e=new Or("abort"),t.onabort&&t.onabort(e),t.dispatchEvent(e))},s.Object.defineProperties(IS.prototype,{signal:{configurable:!0,enumerable:!0,get:function(){return this.g}}}),SS.AbortController=IS,IS.install=xS,y(RS,Br),s.Object.defineProperties(RS.prototype,{aborted:{configurable:!0,enumerable:!0,get:function(){return this.h}},reason:{configurable:!0,enumerable:!0,get:function(){return this.g}}}),wS(xS),SS.Aria=CS,CS.install=DS,wS(DS),SS.EncryptionScheme=MS,MS.install=LS,wS(LS,-2),SS.Fullscreen=PS,PS.install=NS,wS(NS),SS.MediaCapabilities=FS,FS.install=US;var HS=null;FS.originalMcap=HS;var KS,zS,ZS,qS,YS,WS,$S={};function XS(){}function QS(){var t=en();(e.MediaSource||e.ManagedMediaSource)&&(t&&e.MediaSource?10>=t?e.MediaSource=null:12>=t?(JS(),ew()):15>=t&&JS():an("DT_STB_BCM")?(JS(),ew()):(Kt()||Ht()||an("Tizen 4"))&&nw()),(e.MediaSource||e.ManagedMediaSource)&&tw(),e.MediaSource&&MediaSource.isTypeSupported('video/webm; codecs="vp9"')&&!MediaSource.isTypeSupported('video/webm; codecs="vp09.00.10.08"')&&iw()}function JS(){var e=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(){var t=e.apply(this,F.apply(0,arguments));return t.abort=function(){},t}}function ew(){var e=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(t,n){return e.call(this,t,n-.001)}}function tw(){if(e.MediaSource){var t=MediaSource.isTypeSupported.bind(MediaSource);MediaSource.isTypeSupported=function(e){return"mp2t"!=Vn(e)&&t(e)}}if(e.ManagedMediaSource){var n=ManagedMediaSource.isTypeSupported.bind(ManagedMediaSource);e.ManagedMediaSource.isTypeSupported=function(e){return"mp2t"!=Vn(e)&&n(e)}}}function nw(){var t=MediaSource.isTypeSupported.bind(MediaSource);if(MediaSource.isTypeSupported=function(e){return"opus"!=Kn(e)&&t(e)},e.ManagedMediaSource){var n=ManagedMediaSource.isTypeSupported.bind(ManagedMediaSource);e.ManagedMediaSource.isTypeSupported=function(e){return"opus"!=Kn(e)&&n(e)}}}function iw(){var e=MediaSource.isTypeSupported;zt()||(MediaSource.isTypeSupported=function(t){var n=t.split(/ *; */),i=n.findIndex(function(e){return e.startsWith("codecs=")});if(0>i)return e(t);var r=n[i].replace("codecs=","").replace(/"/g,"").split(/\s*,\s*/),a=r.findIndex(function(e){return e.startsWith("vp09")});return 0<=a&&(r[a]="vp9",n[i]='codecs="'+r.join(",")+'"',t=n.join("; ")),e(t)})}function rw(){}function aw(){screen.orientation&&screen.orientation.unlock||(void 0!=screen.orientation?ow():void 0!=e.orientation&&sw())}function ow(){void 0===screen.orientation.lock&&(screen.orientation.lock=function(){return Promise.resolve()}),void 0===screen.orientation.unlock&&(screen.orientation.unlock=function(){})}function sw(){function t(){switch(e.orientation){case-90:n.type="landscape-secondary",n.angle=270;break;case 0:n.type="portrait-primary",n.angle=0;break;case 90:n.type="landscape-primary",n.angle=90;break;case 180:n.type="portrait-secondary",n.angle=180}}var n=new lw;screen.orientation=n,t(),e.addEventListener("orientationchange",function(){t();var e=new Or("change");n.dispatchEvent(e)})}function lw(){Br.call(this),this.type="",this.angle=0}function uw(){}function cw(e,t){try{var n=new hw(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function dw(e){var t=this.mediaKeys;return t&&t!=e&&gw(t,null),delete this.mediaKeys,(this.mediaKeys=e)?gw(e,this):Promise.resolve()}function fw(e){if(e=we(e.initData),Ie(e).getUint32(0,!0)+4!=e.byteLength)throw new RangeError("Malformed FairPlay init data");e=hn(e.subarray(4),!0),e=gn(e);var t=new Event("encrypted");t.initDataType="skd",t.initData=Se(e),this.dispatchEvent(t)}function hw(e,t){if(this.keySystem=e,e.startsWith("com.apple.fps"))for(e=c(t),t=e.next();!t.done;t=e.next()){var n=t.value;if("required"==n.persistentState)t=null;else{t={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:n.initDataTypes,sessionTypes:["temporary"],label:n.label};var i=!1,r=!1;if(n.audioCapabilities)for(var a=c(n.audioCapabilities),o=a.next();!o.done;o=a.next())o=o.value,o.contentType&&(i=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,o.contentType.split(";")[0])&&(t.audioCapabilities.push(o),r=!0));if(n.videoCapabilities)for(n=c(n.videoCapabilities),o=n.next();!o.done;o=n.next())a=o.value,a.contentType&&(i=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,a.contentType.split(";")[0])&&(t.videoCapabilities.push(a),r=!0));i||(r=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),t=r?t:null}if(t)return void(this.g=t)}throw e=Error("Unsupported keySystem"),e.name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e}function pw(e){this.h=new WebKitMediaKeys(e),this.g=new ae}function gw(e,t){if(e.g.Ra(),!t)return Promise.resolve();e.g.D(t,"webkitneedkey",fw);try{return Gl(t,HTMLMediaElement.HAVE_METADATA,e.g,function(){t.webkitSetMediaKeys(e.h)}),Promise.resolve()}catch(e){return Promise.reject(e)}}function mw(e){Br.call(this),this.i=null,this.l=e,this.g=this.h=null,this.j=new ae,this.sessionId="",this.expiration=NaN,this.closed=new Rr,this.keyStatuses=new yw}function vw(e,t){var n=e.keyStatuses;n.size=void 0==t?0:1,n.g=t,t=new Or("keystatuseschange"),e.dispatchEvent(t)}function yw(){this.size=0,this.g=void 0}FS.memoizedCanDisplayTypeRequests_=$S,wS(US,-1),SS.MediaSource=XS,XS.install=QS,wS(QS),SS.Orientation=rw,rw.install=aw,y(lw,Br),lw.prototype.lock=function(e){function t(e){return screen.lockOrientation?screen.lockOrientation(e):screen.mozLockOrientation?screen.mozLockOrientation(e):!!screen.msLockOrientation&&screen.msLockOrientation(e)}var n=!1;switch(e){case"natural":n=t("default");break;case"any":n=!0,this.unlock();break;default:n=t(e)}return n?Promise.resolve():(e=Error("screen.orientation.lock() is not available on this device"),e.name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,Promise.reject(e))},lw.prototype.unlock=function(){screen.unlockOrientation?screen.unlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()},wS(aw),SS.PatchedMediaKeysApple=uw,uw.uninstall=function(){KS&&(KS=!1,Object.defineProperty(HTMLMediaElement.prototype,"mediaKeys",zS),HTMLMediaElement.prototype.setMediaKeys=ZS,e.MediaKeys=qS,e.MediaKeySystemAccess=YS,navigator.requestMediaKeySystemAccess=WS,zS=WS=ZS=YS=qS=null,e.shakaMediaKeysPolyfill="")},uw.install=function(t){e.HTMLVideoElement&&e.WebKitMediaKeys&&(void 0!==t&&t&&(KS=!0,zS=Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"mediaKeys"),ZS=HTMLMediaElement.prototype.setMediaKeys,qS=e.MediaKeys,YS=e.MediaKeySystemAccess,WS=navigator.requestMediaKeySystemAccess),delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=dw,e.MediaKeys=pw,e.MediaKeySystemAccess=hw,navigator.requestMediaKeySystemAccess=cw,e.shakaMediaKeysPolyfill=_w)},hw.prototype.createMediaKeys=function(){var e=new pw(this.keySystem);return Promise.resolve(e)},hw.prototype.getConfiguration=function(){return this.g},pw.prototype.createSession=function(e){if(e=e||"temporary","temporary"!=e)throw new TypeError("Session type "+e+" is unsupported on this platform.");return new mw(this.h,e)},pw.prototype.setServerCertificate=function(){return Promise.resolve(!1)},pw.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")},y(mw,Br),i=mw.prototype,i.generateRequest=function(e,t){var n=this;this.h=new Rr;try{var i=this.l.createSession("video/mp4",we(t));this.i=i,this.sessionId=i.sessionId||"",this.j.D(this.i,"webkitkeymessage",function(e){n.h&&(n.h.resolve(),n.h=null),e=(new Map).set("messageType",void 0==n.keyStatuses.ac()?"license-request":"license-renewal").set("message",Se(e.message)),e=new Or("message",e),n.dispatchEvent(e)}),this.j.D(i,"webkitkeyadded",function(){n.g&&(vw(n,"usable"),n.g.resolve(),n.g=null)}),this.j.D(i,"webkitkeyerror",function(){var e=Error("EME PatchedMediaKeysApple key error");if(e.errorCode=n.i.error,null!=n.h)n.h.reject(e),n.h=null;else if(null!=n.g)n.g.reject(e),n.g=null;else switch(n.i.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:vw(n,"output-not-allowed");break;default:vw(n,"internal-error")}}),vw(this,"status-pending")}catch(e){this.h.reject(e)}return this.h},i.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))},i.update=function(e){this.g=new Rr;try{this.i.update(we(e))}catch(e){this.g.reject(e)}return this.g},i.close=function(){try{this.i.close(),this.closed.resolve(),this.j.Ra()}catch(e){this.closed.reject(e)}return this.closed},i.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},i=yw.prototype,i.ac=function(){return this.g},i.forEach=function(e){this.g&&e(this.g,Pt.value())},i.get=function(e){if(this.has(e))return this.g},i.has=function(e){var t=Pt.value();return!(!this.g||!Ee(e,t))},i.entries=function(){},i.keys=function(){},i.values=function(){};var _w="apple";function bw(){}function Ew(){e.MediaKeys&&(!MediaKeys.prototype.setServerCertificate||Ht()||an("Tizen 4")||an("Tizen 5.0")||Zt())&&(MediaKeys.prototype.setServerCertificate=Tw)}function Tw(){return Promise.resolve(!1)}function Sw(){}function ww(){!e.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(navigator.requestMediaKeySystemAccess=Aw,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Iw,e.MediaKeys=xw,e.MediaKeySystemAccess=Rw,e.shakaMediaKeysPolyfill=Cw)}function Aw(){return Promise.reject(Error("The key system specified is not supported."))}function Iw(e){return null==e?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function xw(){throw new TypeError("Illegal constructor.")}function Rw(){throw this.keySystem="",new TypeError("Illegal constructor.")}SS.PatchedMediaKeysCert=bw,bw.install=Ew,wS(Ew),SS.PatchedMediaKeysNop=Sw,Sw.install=ww,xw.prototype.createSession=function(){},xw.prototype.setServerCertificate=function(){},xw.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")},Rw.prototype.getConfiguration=function(){},Rw.prototype.createMediaKeys=function(){};var Cw="nop";function Dw(){}function kw(){if(!(!e.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)Kw="webkit";else if(!HTMLMediaElement.prototype.generateKeyRequest)return;navigator.requestMediaKeySystemAccess=Lw,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Pw,e.MediaKeys=Ow,e.MediaKeySystemAccess=Nw,e.shakaMediaKeysPolyfill=zw}}function Mw(e){var t=Kw;return t?t+e.charAt(0).toUpperCase()+e.slice(1):e}function Lw(e,t){try{var n=new Nw(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function Pw(e){var t=this.mediaKeys;return t&&t!=e&&Fw(t,null),delete this.mediaKeys,(this.mediaKeys=e)&&Fw(e,this),Promise.resolve()}function Nw(e,t){this.g=this.keySystem=e;var n=!1;"org.w3.clearkey"==e&&(this.g="webkit-org.w3.clearkey",n=!1);var i=!1,r=document.getElementsByTagName("video");r=r.length?r[0]:document.createElement("video"),t=c(t);for(var a=t.next();!a.done;a=t.next()){a=a.value;var o={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:a.initDataTypes,sessionTypes:["temporary"],label:a.label},s=!1;if(a.audioCapabilities)for(var l=c(a.audioCapabilities),u=l.next();!u.done;u=l.next())u=u.value,u.contentType&&(s=!0,r.canPlayType(u.contentType.split(";")[0],this.g)&&(o.audioCapabilities.push(u),i=!0));if(a.videoCapabilities)for(l=c(a.videoCapabilities),u=l.next();!u.done;u=l.next())u=u.value,u.contentType&&(s=!0,r.canPlayType(u.contentType,this.g)&&(o.videoCapabilities.push(u),i=!0));if(s||(i=r.canPlayType("video/mp4",this.g)||r.canPlayType("video/webm",this.g)),"required"==a.persistentState&&(n?(o.persistentState="required",o.sessionTypes=["persistent-license"]):i=!1),i)return void(this.h=o)}throw n="Unsupported keySystem","org.w3.clearkey"!=e&&"com.widevine.alpha"!=e||(n="None of the requested configurations were supported."),e=Error(n),e.name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e}function Ow(e){this.l=e,this.h=null,this.g=new ae,this.i=[],this.j=new Map}function Fw(e,t){e.h=t,e.g.Ra();var n=Kw;t&&(e.g.D(t,n+"needkey",function(t){var n=new CustomEvent("encrypted");n.initDataType="cenc",n.initData=Se(t.initData),e.h.dispatchEvent(n)}),e.g.D(t,n+"keymessage",function(t){var n=Uw(e,t.sessionId);n&&(t=(new Map).set("messageType",void 0==n.keyStatuses.ac()?"licenserequest":"licenserenewal").set("message",t.message),t=new Or("message",t),n.h&&(n.h.resolve(),n.h=null),n.dispatchEvent(t))}),e.g.D(t,n+"keyadded",function(t){(t=Uw(e,t.sessionId))&&(Vw(t,"usable"),t.g&&t.g.resolve(),t.g=null)}),e.g.D(t,n+"keyerror",function(t){var n=Uw(e,t.sessionId);if(n){var i=Error("EME v0.1b key error"),r=t.errorCode;r.systemCode=t.systemCode,i.errorCode=r,!t.sessionId&&n.h?(45==t.systemCode&&(i.message="Unsupported session type."),n.h.reject(i),n.h=null):t.sessionId&&n.g?(n.g.reject(i),n.g=null):(i=t.systemCode,t.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?Vw(n,"output-restricted"):Vw(n,1==i?"expired":"internal-error"))}}))}function Uw(e,t){var n=e.j.get(t);return n||((n=e.i.shift())?(n.sessionId=t,e.j.set(t,n),n):null)}function Bw(e,t,n){Br.call(this),this.j=e,this.m=!1,this.g=this.h=null,this.i=t,this.l=n,this.sessionId="",this.expiration=NaN,this.closed=new Rr,this.keyStatuses=new Hw}function Gw(e,t,n){if(e.m)return Promise.reject(Error("The session is already initialized."));e.m=!0;try{if("persistent-license"==e.l)if(n)var i=we(gn("LOAD_SESSION|"+n));else{var r=gn("PERSISTENT|");i=In(r,t)}else i=we(t)}catch(e){return Promise.reject(e)}e.h=new Rr;var a=Mw("generateKeyRequest");try{e.j[a](e.i,i)}catch(t){if("InvalidStateError"!=t.name)return e.h=null,Promise.reject(t);new Ft(function(){try{e.j[a](e.i,i)}catch(t){e.h.reject(t),e.h=null}}).Y(.01)}return e.h}function jw(e,t,n){if(e.g)e.g.then(function(){return jw(e,t,n)}).catch(function(){return jw(e,t,n)});else{if(e.g=t,"webkit-org.w3.clearkey"==e.i){var i=fn(n),r=JSON.parse(i);"oct"!=r.keys[0].kty&&(e.g.reject(Error("Response is not a valid JSON Web Key Set.")),e.g=null),i=Sn(r.keys[0].k),r=Sn(r.keys[0].kid)}else i=we(n),r=null;var a=Mw("addKey");try{e.j[a](e.i,i,r,e.sessionId)}catch(t){e.g.reject(t),e.g=null}}}function Vw(e,t){var n=e.keyStatuses;n.size=void 0==t?0:1,n.g=t,t=new Or("keystatuseschange"),e.dispatchEvent(t)}function Hw(){this.size=0,this.g=void 0}wS(ww,-10),SS.PatchedMediaKeysWebkit=Dw,Dw.install=kw,Nw.prototype.createMediaKeys=function(){var e=new Ow(this.g);return Promise.resolve(e)},Nw.prototype.getConfiguration=function(){return this.h},Ow.prototype.createSession=function(e){if(e=e||"temporary","temporary"!=e&&"persistent-license"!=e)throw new TypeError("Session type "+e+" is unsupported on this platform.");var t=this.h||document.createElement("video");return t.src||(t.src="about:blank"),e=new Bw(t,this.l,e),this.i.push(e),e},Ow.prototype.setServerCertificate=function(){return Promise.resolve(!1)},Ow.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")},y(Bw,Br),i=Bw.prototype,i.generateRequest=function(e,t){return Gw(this,t,null)},i.load=function(e){return"persistent-license"==this.l?Gw(this,null,e):Promise.reject(Error("Not a persistent session."))},i.update=function(e){var t=new Rr;return jw(this,t,e),t},i.close=function(){if("persistent-license"!=this.l){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var e=Mw("cancelKeyRequest");try{this.j[e](this.i,this.sessionId)}catch(e){}}return this.closed.resolve(),this.closed},i.remove=function(){return"persistent-license"!=this.l?Promise.reject(Error("Not a persistent session.")):this.close()},i=Hw.prototype,i.ac=function(){return this.g},i.forEach=function(e){this.g&&e(this.g,Pt.value())},i.get=function(e){if(this.has(e))return this.g},i.has=function(e){var t=Pt.value();return!(!this.g||!Ee(e,t))},i.entries=function(){},i.keys=function(){},i.values=function(){};var Kw="",zw="webkit";function Zw(){}function qw(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;t.requestPictureInPicture&&document.exitPictureInPicture||!t.webkitSupportsPresentationMode||(document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,t.requestPictureInPicture=Ww,Object.defineProperty(t,"disablePictureInPicture",{get:Xw,set:Qw,enumerable:!0,configurable:!0}),document.exitPictureInPicture=$w,document.addEventListener("webkitpresentationmodechanged",Yw,!0))}}function Yw(e){if(e=e.target,"picture-in-picture"==e.webkitPresentationMode){document.pictureInPictureElement=e;var t=new Event("enterpictureinpicture");e.dispatchEvent(t)}else document.pictureInPictureElement==e&&(document.pictureInPictureElement=null),t=new Event("leavepictureinpicture"),e.dispatchEvent(t)}function Ww(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function $w(){var e=document.pictureInPictureElement;return e?(e.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}function Xw(){return!!this.hasAttribute("disablePictureInPicture")||!this.webkitSupportsPresentationMode("picture-in-picture")}function Qw(e){e?this.setAttribute("disablePictureInPicture",""):this.removeAttribute("disablePictureInPicture")}function Jw(){}function eA(){e.crypto&&("randomUUID"in e.crypto||(e.crypto.randomUUID=tA))}function tA(){var e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.substr(t.lastIndexOf("/")+1)}function nA(){}function iA(){var e=Symbol.prototype;"description"in e||Object.defineProperty(e,"description",{get:rA})}function rA(){var e=/\((.*)\)/.exec(this.toString());return e?e[1]:void 0}function aA(){}function oA(){if(e.HTMLMediaElement){var t=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var e=t.apply(this);return e&&e.catch(function(){}),e}}}function sA(){}function lA(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;!t.getVideoPlaybackQuality&&("webkitDroppedFrameCount"in t||Zt())&&(t.getVideoPlaybackQuality=uA)}}function uA(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}function cA(){}function dA(){if(!e.VTTCue&&e.TextTrackCue){var t=null,n=TextTrackCue.length;if(3==n)t=fA;else if(6==n)t=hA;else{try{var i=!!fA(1,2,"")}catch(e){i=!1}i&&(t=fA)}t&&(e.VTTCue=function(e,n,i){return t(e,n,i)})}}function fA(t,n,i){return new e.TextTrackCue(t,n,i)}function hA(t,n,i){return new e.TextTrackCue(t+"-"+n+"-"+i,t,n,i)}function pA(){}wS(kw),SS.PiPWebkit=Zw,Zw.install=qw,wS(qw),SS.RandomUUID=Jw,Jw.install=eA,wS(eA),SS.Symbol=nA,nA.install=iA,wS(iA),SS.VideoPlayPromise=aA,aA.install=oA,wS(oA),SS.VideoPlaybackQuality=sA,sA.install=lA,wS(lA),SS.VTTCue=cA,cA.install=dA,wS(dA),pA.prototype.parseInit=function(){},pA.prototype.setSequenceMode=function(){},pA.prototype.setManifestType=function(){},pA.prototype.parseMedia=function(e,t){var n=null,i=[];e=fn(e).split(/\r?\n/),e=c(e);for(var r=e.next();!r.done;r=e.next())if((r=r.value)&&!/^\s+$/.test(r)&&(r=gA.exec(r))){var a=mA.exec(r[1]);a=60*parseInt(a[1],10)+parseFloat(a[2].replace(",",".")),r=new Be(a,t.segmentEnd?t.segmentEnd:a+2,r[2]),n&&(n.endTime=a,i.push(n)),n=r}return n&&i.push(n),i},K("shaka.text.LrcTextParser",pA),pA.prototype.parseMedia=pA.prototype.parseMedia,pA.prototype.setManifestType=pA.prototype.setManifestType,pA.prototype.setSequenceMode=pA.prototype.setSequenceMode,pA.prototype.parseInit=pA.prototype.parseInit;var gA=/^\[(\d{1,2}:\d{1,2}(?:[.,]\d{1,3})?)\](.*)/,mA=/^(\d+):(\d{1,2}(?:[.,]\d{1,3})?)$/;function vA(){}function yA(e,t,n,i,r,a,o,s,l,u,d,f){var h=u;if(xa(e)){if(!d)return null;var p={tagName:"span",children:[Da(e)],attributes:{},parent:null}}else p=e;for(var g=null,m=c(zA),v=m.next();!v.done&&!(g=AA(p,"backgroundImage",i,"#",v.value)[0]);v=m.next());m=null;var y=Ua(p,zA,"backgroundImage");if(f&&y&&!y.startsWith("#")&&(v=new ft(f),y=new ft(y),(v=v.resolve(y).toString())&&(m=v)),("p"==e.tagName||g||m)&&(d=!0),e=d,v="default"==(p.attributes["xml:space"]||(s?"default":"preserve")),y=p.children.every(xa),s=[],!y)for(var _=c(p.children),b=_.next();!b.done;b=_.next())(b=yA(b.value,t,n,i,r,a,o,v,l,p,d,f))&&s.push(b);if(i=null!=u,f=Da(p),f=p.children.length&&f&&/\S/.test(f),b=p.attributes.begin||p.attributes.end||p.attributes.dur,!(b||f||"br"==p.tagName||0!=s.length||i&&!v))return null;for(_=xA(p,n),f=_.start,_=_.end;h&&h.tagName&&"tt"!=h.tagName;)_=IA(h,n,f,_),f=_.start,_=_.end,h=h.parent;if(null==f&&(f=0),f+=t.periodStart,_=null==_?1/0:_+t.periodStart,f=Math.max(f,t.segmentStart),_=Math.min(_,t.segmentEnd),!b&&0<s.length)for(f=1/0,_=0,t=c(s),n=t.next();!n.done;n=t.next())n=n.value,f=Math.min(f,n.startTime),_=Math.max(_,n.endTime);if("br"==p.tagName)return r=new Be(f,_,""),r.lineBreak=!0,r;if(t="",y&&(t=yn(Da(p)||""),v&&(t=t.replace(/\s+/g," "))),t=new Be(f,_,t),t.nestedCues=s,d||(t.isContainer=!0),l&&(t.cellResolution=l),l=AA(p,"region",a,"")[0],p.attributes.region&&l&&l.attributes["xml:id"]){var E=l.attributes["xml:id"];t.region=o.filter(function(e){return e.id==E})[0]}return o=l,u&&i&&!p.attributes.region&&!p.attributes.style&&(o=AA(u,"region",a,"")[0]),_A(t,p,o,g,m,r,e,0==s.length),t}function _A(e,t,n,i,r,a,o,s){if(o=o||s,"rtl"==EA(t,n,a,"direction",o)&&(e.direction="rtl"),s=EA(t,n,a,"writingMode",o),"tb"==s||"tblr"==s?e.writingMode="vertical-lr":"tbrl"==s?e.writingMode="vertical-rl":"rltb"==s||"rl"==s?e.direction="rtl":s&&(e.direction=qe),(s=EA(t,n,a,"textAlign",!0))?(e.positionAlign=VA[s],e.lineAlign=jA[s],e.textAlign=Ke[s.toUpperCase()]):e.textAlign=He,(s=EA(t,n,a,"displayAlign",!0))&&(e.displayAlign=Ze[s.toUpperCase()]),(s=EA(t,n,a,"color",o))&&(e.color=s),(s=EA(t,n,a,"backgroundColor",o))&&(e.backgroundColor=s),(s=EA(t,n,a,"border",o))&&(e.border=s),s=EA(t,n,a,"fontFamily",o))switch(s){case"monospaceSerif":e.fontFamily="Courier New,Liberation Mono,Courier,monospace";break;case"proportionalSansSerif":e.fontFamily="Arial,Helvetica,Liberation Sans,sans-serif";break;case"sansSerif":e.fontFamily="sans-serif";break;case"monospaceSansSerif":e.fontFamily="Consolas,monospace";break;case"proportionalSerif":e.fontFamily="serif";break;default:e.fontFamily=s.split(",").filter(function(e){return"default"!=e}).join(",")}switch((s=EA(t,n,a,"fontWeight",o))&&"bold"==s&&(e.fontWeight=700),s=EA(t,n,a,"wrapOption",o),e.wrapLine=!s||"noWrap"!=s,(s=EA(t,n,a,"lineHeight",o))&&s.match(LA)&&(e.lineHeight=s),(s=EA(t,n,a,"fontSize",o))&&(s.match(LA)||s.match(MA))&&(e.fontSize=s),(s=EA(t,n,a,"fontStyle",o))&&(e.fontStyle=nt[s.toUpperCase()]),i?(r=i.attributes.imageType||i.attributes.imagetype,s=i.attributes.encoding,i=Da(i).trim(),"PNG"==r&&"Base64"==s&&i&&(e.backgroundImage="data:image/png;base64,"+i)):r&&(e.backgroundImage=r),(i=EA(t,n,a,"textOutline",o))&&(i=i.split(" "),i[0].match(LA)?e.textStrokeColor=e.color:(e.textStrokeColor=i[0],i.shift()),i[0]&&i[0].match(LA)?e.textStrokeWidth=i[0]:e.textStrokeColor=""),(i=EA(t,n,a,"letterSpacing",o))&&i.match(LA)&&(e.letterSpacing=i),(i=EA(t,n,a,"linePadding",o))&&i.match(LA)&&(e.linePadding=i),(i=EA(t,n,a,"opacity",o))&&(e.opacity=parseFloat(i)),(i=TA(n,a,"textDecoration"))&&bA(e,i),(i=SA(t,a,"textDecoration"))&&bA(e,i),(i=EA(t,n,a,"textCombine",o))&&(e.textCombineUpright=i),EA(t,n,a,"ruby",o)){case"container":e.rubyTag="ruby";break;case"text":e.rubyTag="rt"}}function bA(e,t){t=c(t.split(" "));for(var n=t.next();!n.done;n=t.next())switch(n.value){case"underline":e.textDecoration.includes("underline")||e.textDecoration.push("underline");break;case"noUnderline":e.textDecoration.includes("underline")&&Oe(e.textDecoration,"underline");break;case"lineThrough":e.textDecoration.includes("lineThrough")||e.textDecoration.push("lineThrough");break;case"noLineThrough":e.textDecoration.includes("lineThrough")&&Oe(e.textDecoration,"lineThrough");break;case"overline":e.textDecoration.includes("overline")||e.textDecoration.push("overline");break;case"noOverline":e.textDecoration.includes("overline")&&Oe(e.textDecoration,"overline")}}function EA(e,t,n,i,r){return r=void 0===r||r,(e=SA(e,n,i))?e:r?TA(t,n,i):null}function TA(e,t,n){if(!e)return null;var i=Ua(e,KA,n);return i||wA(e,t,n)}function SA(e,t,n){var i=Ua(e,KA,n);return i||wA(e,t,n)}function wA(e,t,n){e=AA(e,"style",t,"");for(var i=null,r=0;r<e.length;r++){var a=Oa(e[r],"urn:ebu:tt:style",n);a||(a=Ua(e[r],KA,n)),a||(a=SA(e[r],t,n)),a&&(i=a)}return i}function AA(e,t,n,i,r){var a=[];if(!e||1>n.length)return a;var o=e;for(e=null;!e&&!(e=r?Oa(o,r,t):o.attributes[t])&&(o=o.parent,o););if(t=e)for(t=c(t.split(" ")),r=t.next();!r.done;r=t.next())for(r=r.value,e=c(n),o=e.next();!o.done;o=e.next())if(o=o.value,i+o.attributes["xml:id"]==r){a.push(o);break}return a}function IA(e,t,n,i){return e=xA(e,t),null==n?n=e.start:null!=e.start&&(n+=e.start),null==i?i=e.end:null!=e.start&&(i+=e.start),{start:n,end:i}}function xA(e,t){var n=RA(e.attributes.begin,t),i=RA(e.attributes.end,t);return e=RA(e.attributes.dur,t),null==i&&null!=e&&(i=n+e),{start:n,end:i}}function RA(e,t){var n=null;if(NA.test(e)){e=NA.exec(e),n=Number(e[1]);var i=Number(e[2]),r=Number(e[3]),a=Number(e[4]);a+=(Number(e[5])||0)/t.h,r+=a/t.frameRate,n=r+60*i+3600*n}else if(OA.test(e))n=CA(OA,e);else if(FA.test(e))n=CA(FA,e);else if(UA.test(e))e=UA.exec(e),n=Number(e[1])/t.frameRate;else if(BA.test(e))e=BA.exec(e),n=Number(e[1])/t.g;else if(GA.test(e))n=CA(GA,e);else if(e)throw new Rt(2,2,2001,"Could not parse cue time range in TTML");return n}function CA(e,t){return e=e.exec(t),null==e||""==e[0]?null:(Number(e[4])||0)/1e3+(Number(e[3])||0)+60*(Number(e[2])||0)+3600*(Number(e[1])||0)}function DA(e,t,n,i){this.frameRate=Number(e)||30,this.h=Number(t)||1,this.g=Number(i),0==this.g&&(this.g=e?this.frameRate*this.h:1),n&&(e=/^(\d+) (\d+)$/g.exec(n))&&(this.frameRate*=Number(e[1])/Number(e[2]))}ri["application/x-subtitle-lrc"]=function(){return new pA},vA.prototype.parseInit=function(){},vA.prototype.setSequenceMode=function(){},vA.prototype.setManifestType=function(){},vA.prototype.parseMedia=function(e,t,n){var i=fn(e);if(e=[],""==i)return e;var r=wa(i,"tt");if(!r)throw new Rt(2,2,2005,"Failed to parse TTML.");if(i=Ma(r,"body")[0],!i)return[];var a=Ua(r,HA,"frameRate"),o=Ua(r,HA,"subFrameRate"),s=Ua(r,HA,"frameRateMultiplier"),l=Ua(r,HA,"tickRate"),u=Ua(r,HA,"cellResolution"),d=r.attributes["xml:space"]||"default",f=Ua(r,KA,"extent");if("default"!=d&&"preserve"!=d)throw new Rt(2,2,2005,"Invalid xml:space value: "+d);d="default"==d,a=new DA(a,o,s,l),u=u&&(u=/^(\d+) (\d+)$/.exec(u))?{kc:parseInt(u[1],10),rows:parseInt(u[2],10)}:null,o=(o=Ma(r,"metadata")[0])?o.children:[],s=Ma(r,"style"),r=Ma(r,"region"),l=[];for(var h=c(r),p=h.next();!p.done;p=h.next()){var g=p.value;p=new Me;var m=g.attributes["xml:id"];if(m){p.id=m;var v=null;f&&(v=kA.exec(f)||PA.exec(f)),m=v?Number(v[1]):null,v=v?Number(v[2]):null;var y,_=TA(g,s,"extent");if(_){var b=(y=kA.exec(_))||PA.exec(_);null!=b&&(p.width=Number(b[1]),p.height=Number(b[2]),y||(null!=m&&(p.width=100*p.width/m),null!=v&&(p.height=100*p.height/v)),p.widthUnits=y||null!=m?Le:0,p.heightUnits=y||null!=v?Le:0)}(g=TA(g,s,"origin"))&&(b=(y=kA.exec(g))||PA.exec(g),null!=b&&(p.viewportAnchorX=Number(b[1]),p.viewportAnchorY=Number(b[2]),y?_||(p.width=100-p.viewportAnchorX,p.widthUnits=Le,p.height=100-p.viewportAnchorY,p.heightUnits=Le):(null!=v&&(p.viewportAnchorY=100*p.viewportAnchorY/v),null!=m&&(p.viewportAnchorX=100*p.viewportAnchorX/m)),p.viewportAnchorUnits=y||null!=m?Le:0))}else p=null;p&&l.push(p)}if(Ca(i,"p").length)throw new Rt(2,2,2001,"<p> can only be inside <div> in TTML");for(f=c(Ca(i,"div")),h=f.next();!h.done;h=f.next())if(Ca(h.value,"span").length)throw new Rt(2,2,2001,"<span> can only be inside <p> in TTML");return(t=yA(i,t,a,o,s,r,l,d,u,null,!1,n))&&(t.backgroundColor||(t.backgroundColor="transparent"),e.push(t)),e},K("shaka.text.TtmlTextParser",vA),vA.prototype.parseMedia=vA.prototype.parseMedia,vA.prototype.setManifestType=vA.prototype.setManifestType,vA.prototype.setSequenceMode=vA.prototype.setSequenceMode,vA.prototype.parseInit=vA.prototype.parseInit;var kA=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,MA=/^(\d{1,4}(?:\.\d+)?|100)%$/,LA=/^(\d+px|\d+em|\d*\.?\d+c)$/,PA=/^(\d+)px (\d+)px$/,NA=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,OA=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,FA=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d+)$/,UA=/^(\d*(?:\.\d*)?)f$/,BA=/^(\d*(?:\.\d*)?)t$/,GA=RegExp("^(?:(\\d*(?:\\.\\d*)?)h)?(?:(\\d*(?:\\.\\d*)?)m)?(?:(\\d*(?:\\.\\d*)?)s)?(?:(\\d*(?:\\.\\d*)?)ms)?$"),jA={left:$e,center:"center",right:"end",start:$e,end:"end"},VA={left:"line-left",center:"center",right:"line-right"},HA=["http://www.w3.org/ns/ttml#parameter","http://www.w3.org/2006/10/ttaf1#parameter"],KA=["http://www.w3.org/ns/ttml#styling","http://www.w3.org/2006/10/ttaf1#styling"],zA=["http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt","http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"];function ZA(){this.g=new vA}function qA(){this.h=!1,this.g="UNKNOWN"}function YA(e){for(var t=c(Object.entries(Qe)),n=t.next();!n.done;n=t.next()){var i=c(n.value);n=i.next().value,i=i.next().value;var r=new Be(0,0,"");r.color=i,e.set("."+n,r)}for(t=c(Object.entries(Je)),n=t.next();!n.done;n=t.next())i=c(n.value),n=i.next().value,i=i.next().value,r=new Be(0,0,""),r.backgroundColor=i,e.set("."+n,r)}function WA(e,t,n){if(e.includes("<")){0===n.size&&YA(n);var i=e;e=[];for(var r=-1,a=0;a<i.length;a++)"<"===i[a]?r=a+1:">"===i[a]&&0<r&&(r=i.substr(r,a-r),r.match(nI)&&e.push(r),r=-1);for(e=c(e),a=e.next();!a.done;a=e.next())a=a.value,i=i.replace("<"+a+">",'<div time="'+a+'">'),i+="</div>";e=i;e:{a=e,r=[];var o=-1;e="",i=!1;for(var s=0;s<a.length;s++)if("/"===a[s]){var l=a.indexOf(">",s);if(-1===l){e=a;break e}if((l=a.substring(s+1,l))&&"v"==l){i=!0;var u=null;if(r.length&&(u=r[r.length-1]),u){if(u===l)e+="/"+l+">";else{if(!u.startsWith("v")){e+=a[s];continue}e+="/"+u+">"}s+=l.length+1}else e+=a[s]}else e+=a[s]}else"<"===a[s]?(o=s+1,"v"!=a[o]&&(o=-1)):">"===a[s]&&0<o&&(r.push(a.substr(o,s-o)),o=-1),e+=a[s];for(a=c(r),r=a.next();!r.done;r=a.next())r=r.value,o=r.replace(" ",".voice-"),e=e.replace("<"+r+">","<"+o+">"),e=e.replace("</"+r+">","</"+o+">"),i||(e+="</"+o+">")}e=$A(e);try{var d=wa("<span>"+e+"</span>","span")}catch(e){}if(d)if(d=d.children,1!=d.length||d[0].tagName)for(d=c(d),e=d.next();!e.done;e=d.next())QA(e.value,t,n);else t.payload=yn(e);else t.payload=yn(e)}else t.payload=yn(e)}function $A(e){var t={"< ":""," >":" &gt;"},n=/(< +>|<\s|\s>)/g,i=RegExp(n.source);return e&&i.test(e)?e.replace(n,function(e){return t[e]||""}):e||""}function XA(e,t){return e&&0<e.length?e:t}function QA(e,t,n){var i=t.clone();if(i.nestedCues=[],i.payload="",i.rubyTag="",i.line=null,i.region=new Me,i.position=null,i.size=0,e.tagName)for(var r=c(e.tagName.split(/(?=[ .])+/g)),a=r.next();!a.done;a=r.next()){var o=a=a.value;if(o.startsWith(".voice-")){var s=o.split("-").pop();o='v[voice="'+s+'"]',n.has(o)||(o="v[voice="+s+"]")}switch(n.has(o)&&(o=n.get(o))&&(i.backgroundColor=XA(o.backgroundColor,i.backgroundColor),i.color=XA(o.color,i.color),i.fontFamily=XA(o.fontFamily,i.fontFamily),i.fontSize=XA(o.fontSize,i.fontSize),i.textShadow=XA(o.textShadow,i.textShadow),i.fontWeight=o.fontWeight,i.fontStyle=o.fontStyle,i.opacity=o.opacity,i.rubyTag=o.rubyTag,i.textCombineUpright=o.textCombineUpright,i.wrapLine=o.wrapLine),a){case"br":return i=Ge(i.startTime,i.endTime),void t.nestedCues.push(i);case"b":i.fontWeight=700;break;case"i":i.fontStyle="italic";break;case"u":i.textDecoration.push("underline");break;case"font":(a=e.attributes.color)&&(i.color=a);break;case"div":if(a=e.attributes.time,!a)break;(a=tI(new Gh(a)))&&(i.startTime=a);break;case"ruby":case"rp":case"rt":i.rubyTag=a}}if(r=e.children,xa(e)||1==r.length&&xa(r[0]))for(n=Da(e).split("\n"),e=!0,n=c(n),r=n.next();!r.done;r=n.next())r=r.value,e||(e=Ge(i.startTime,i.endTime),t.nestedCues.push(e)),0<r.length&&(e=i.clone(),e.payload=yn(r),t.nestedCues.push(e)),e=!1;else for(t.nestedCues.push(i),t=c(r),e=t.next();!e.done;e=t.next())QA(e.value,i,n)}function JA(e,t,n){var i;(i=/^align:(start|middle|center|end|left|right)$/.exec(t))?(t=i[1],e.textAlign="middle"==t?He:Ke[t.toUpperCase()]):(i=/^vertical:(lr|rl)$/.exec(t))?e.writingMode="lr"==i[1]?"vertical-lr":"vertical-rl":(i=/^size:([\d.]+)%$/.exec(t))?e.size=Number(i[1]):(i=/^position:([\d.]+)%(?:,(line-left|line-right|middle|center|start|end|auto))?$/.exec(t))?(e.position=Number(i[1]),i[2]&&(t=i[2],e.positionAlign="line-left"==t||"start"==t?"line-left":"line-right"==t||"end"==t?"line-right":"center"==t||"middle"==t?"center":Ve)):(i=/^region:(.*)$/.exec(t))?(t=eI(n,i[1]))&&(e.region=t):(n=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))?(e.lineInterpretation=1,e.line=Number(n[1]),n[2]&&(e.lineAlign=Xe[n[2].toUpperCase()])):(n=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t))&&(e.lineInterpretation=We,e.line=Number(n[1]),n[2]&&(e.lineAlign=Xe[n[2].toUpperCase()]))}function eI(e,t){return e=e.filter(function(e){return e.id==t}),e.length?e[0]:null}function tI(e){if(e=Vh(e,nI),null==e)return null;var t=Number(e[2]),n=Number(e[3]);return 59<t||59<n?null:Number(e[4])/1e3+n+60*t+3600*(Number(e[1])||0)}ri["application/ttml+xml"]=function(){return new vA},ZA.prototype.parseInit=function(e){var t=!1;if((new ca).box("moov",da).box("trak",da).box("mdia",da).box("minf",da).box("stbl",da).S("stsd",fa).box("stpp",function(e){t=!0,e.parser.stop()}).parse(e),!t)throw new Rt(2,2,2007)},ZA.prototype.setSequenceMode=function(){},ZA.prototype.setManifestType=function(){},ZA.prototype.parseMedia=function(e,t,n){var i=this,r=!1,a=[];if((new ca).box("mdat",ga(function(e){r=!0,a=a.concat(i.g.parseMedia(e,t,n))})).parse(e,!1),!r)throw new Rt(2,2,2007);return a},K("shaka.text.Mp4TtmlParser",ZA),ZA.prototype.parseMedia=ZA.prototype.parseMedia,ZA.prototype.setManifestType=ZA.prototype.setManifestType,ZA.prototype.setSequenceMode=ZA.prototype.setSequenceMode,ZA.prototype.parseInit=ZA.prototype.parseInit,ri['application/mp4; codecs="stpp"']=function(){return new ZA},ri['application/mp4; codecs="stpp.ttml"']=function(){return new ZA},ri['application/mp4; codecs="stpp.ttml.im1t"']=function(){return new ZA},ri['application/mp4; codecs="stpp.ttml.im2t"']=function(){return new ZA},ri['application/mp4; codecs="stpp.ttml.etd1"']=function(){return new ZA},ri['application/mp4; codecs="stpp.ttml.etd1|im1t"']=function(){return new ZA},ri['application/mp4; codecs="stpp.ttml.im1t|etd1"']=function(){return new ZA},ri['application/mp4; codecs="stpp.TTML.im1t"']=function(){return new ZA},qA.prototype.parseInit=function(){},qA.prototype.setSequenceMode=function(e){this.h=e},qA.prototype.setManifestType=function(e){this.g=e},qA.prototype.parseMedia=function(e,t){e=fn(e),e=e.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n");var n=e.split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(n[0]))throw new Rt(2,2,2e3);if(e=t.vttOffset,n[0].includes("X-TIMESTAMP-MAP")&&"HLS"==this.g)if(this.h){var i=n[0];if(e=i.match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),i=i.match(/MPEGTS:(\d+)/m),!e||!i)throw new Rt(2,2,2e3);if(e=tI(new Gh(e[1])),null==e)throw new Rt(2,2,2e3);e=t.periodStart+Number(i[1])/9e4-e}else e=t.segmentStart;t=[],i=c(n[0].split("\n"));for(var r=i.next();!r.done;r=i.next())if(r=r.value,/^Region:/.test(r)){r=new Gh(r);var a=new Me;Hh(r),jh(r);for(var o=Hh(r);o;){var s=a,l=o;(o=/^id=(.*)$/.exec(l))?s.id=o[1]:(o=/^width=(\d{1,2}|100)%$/.exec(l))?s.width=Number(o[1]):(o=/^lines=(\d+)$/.exec(l))?(s.height=Number(o[1]),s.heightUnits=2):(o=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(l))?(s.regionAnchorX=Number(o[1]),s.regionAnchorY=Number(o[2])):(o=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(l))?(s.viewportAnchorX=Number(o[1]),s.viewportAnchorY=Number(o[2])):/^scroll=up$/.exec(l)&&(s.scroll="up"),jh(r),o=Hh(r)}t.push(a)}for(i=new Map,YA(i),r=[],n=c(n.slice(1)),a=n.next();!a.done;a=n.next()){if(a=a.value.split("\n"),(1!=a.length||a[0])&&!/^NOTE($|[ \t])/.test(a[0])&&"STYLE"==a[0]){for(s=[],o=-1,l=1;l<a.length;l++)a[l].includes("::cue")&&(s.push([]),o=s.length-1),-1!=o&&(s[o].push(a[l]),a[l].includes("}")&&(o=-1));for(s=c(s),o=s.next();!o.done;o=s.next()){var u=o.value;o="global",(l=u[0].match(/\((.*)\)/))&&(o=l.pop()),l=u.slice(1,-1),u[0].includes("}")&&(u=/\{(.*?)\}/.exec(u[0]))&&(l=u[1].split(";")),(u=i.get(o))||(u=new Be(0,0,""));for(var d=!1,f=0;f<l.length;f++){var h=/^\s*([^:]+):\s*(.*)/.exec(l[f]);if(h){var p=h[2].trim().replace(";","");switch(h[1].trim()){case"background-color":case"background":d=!0,u.backgroundColor=p;break;case"color":d=!0,u.color=p;break;case"font-family":d=!0,u.fontFamily=p;break;case"font-size":d=!0,u.fontSize=p;break;case"font-weight":(700<=parseInt(p,10)||"bold"==p)&&(d=!0,u.fontWeight=700);break;case"font-style":switch(p){case"normal":d=!0,u.fontStyle=tt;break;case"italic":d=!0,u.fontStyle="italic";break;case"oblique":d=!0,u.fontStyle="oblique"}break;case"opacity":d=!0,u.opacity=parseFloat(p);break;case"text-combine-upright":d=!0,u.textCombineUpright=p;break;case"text-shadow":d=!0,u.textShadow=p;break;case"white-space":d=!0,u.wrapLine="noWrap"!=p}}}d&&i.set(o,u)}}if(d=e,1==a.length&&!a[0]||/^NOTE($|[ \t])/.test(a[0])||"STYLE"==a[0]||"REGION"==a[0])a=null;else if(s=null,a[0].includes("--\x3e")||(s=a[0],a.splice(0,1)),o=new Gh(a[0]),l=tI(o),f=Vh(o,/[ \t]+--\x3e[ \t]+/g),u=tI(o),null==l||null==f||null==u)Q("Failed to parse VTT time code. Cue skipped:",s,a),a=null;else{for(l+=d,u+=d,a=a.slice(1).join("\n").trim(),i.has("global")?(d=i.get("global").clone(),d.startTime=l,d.endTime=u,d.payload=""):d=new Be(l,u,""),jh(o),l=Hh(o);l;)JA(d,l,t),jh(o),l=Hh(o);WA(a,d,i),null!=s&&(d.id=s),a=d}a&&r.push(a)}return r},K("shaka.text.VttTextParser",qA),qA.prototype.parseMedia=qA.prototype.parseMedia,qA.prototype.setManifestType=qA.prototype.setManifestType,qA.prototype.setSequenceMode=qA.prototype.setSequenceMode,qA.prototype.parseInit=qA.prototype.parseInit;var nI=/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g;function iI(){this.g=null}function rI(e,t,n){var i,r,a;return(new ca).box("payl",ga(function(e){i=fn(e)})).box("iden",ga(function(e){r=fn(e)})).box("sttg",ga(function(e){a=fn(e)})).parse(e),i?aI(i,r,a,t,n):null}function aI(e,t,n,i,r){if(i=new Be(i,r,""),WA(e,i,new Map),t&&(i.id=t),n)for(e=new Gh(n),t=Hh(e);t;)JA(i,t,[]),jh(e),t=Hh(e);return i}function oI(){}function sI(e){if(e=Vh(e,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g),null==e)return null;var t=Number(e[2]),n=Number(e[3]);return 59<t||59<n?null:Number(e[4])/1e3+n+60*t+3600*(Number(e[1])||0)}function lI(){this.g=new qA}function uI(e){var t="WEBVTT\n\n";if(""==e)return t;e=e.replace(/\r+/g,""),e=e.trim(),e=c(e.split("\n\n"));for(var n=e.next();!n.done;n=e.next())n=n.value.split(/\n/),n[0].match(/\d+/)&&n.shift(),n[0]=n[0].replace(/,/g,"."),t+=n.join("\n").replace(/{b}/g,"<b>").replace(/{\/b}/g,"</b>").replace(/{i}/g,"<i>").replace(/{\/i}/g,"</i>").replace(/{u}/g,"<u>").replace(/{\/u}/g,"</u>")+"\n\n";return t}function cI(){}function dI(e,t){var n=t.Fontname;if(n&&(e.fontFamily=n),(n=t.Fontsize)&&(e.fontSize=n+"px"),(n=t.PrimaryColour)&&(n=fI(n))&&(e.color=n),(n=t.BackColour)&&(n=fI(n))&&(e.backgroundColor=n),t.Bold&&(e.fontWeight=700),t.Italic&&(e.fontStyle="italic"),t.Underline&&e.textDecoration.push("underline"),(n=t.Spacing)&&(e.letterSpacing=n+"px"),n=t.Alignment)switch(parseInt(n,10)){case 1:e.displayAlign=ze,e.textAlign="start";break;case 2:e.displayAlign=ze,e.textAlign=He;break;case 3:e.displayAlign=ze,e.textAlign="end";break;case 5:e.displayAlign="before",e.textAlign="start";break;case 6:e.displayAlign="before",e.textAlign=He;break;case 7:e.displayAlign="before",e.textAlign="end";break;case 9:e.displayAlign="center",e.textAlign="start";break;case 10:e.displayAlign="center",e.textAlign=He;break;case 11:e.displayAlign="center",e.textAlign="end"}(t=t.AlphaLevel)&&(e.opacity=parseFloat(t))}function fI(e){return e=parseInt(e.replace("&H",""),16),0<=e?"rgba("+(255&e)+","+(e>>8&255)+","+(e>>16&255)+","+(e>>24&255^255)/255+")":null}function hI(e){return e=vI.exec(e),3600*(e[1]?parseInt(e[1].replace(":",""),10):0)+60*parseInt(e[2],10)+parseFloat(e[3])}ri["text/vtt"]=function(){return new qA},ri['text/vtt; codecs="vtt"']=function(){return new qA},ri['text/vtt; codecs="wvtt"']=function(){return new qA},iI.prototype.parseInit=function(e){var t=this,n=!1;if((new ca).box("moov",da).box("trak",da).box("mdia",da).S("mdhd",function(e){e=vs(e.reader,e.version),t.g=e.timescale}).box("minf",da).box("stbl",da).S("stsd",fa).box("wvtt",function(){n=!0}).parse(e),!this.g)throw new Rt(2,2,2008);if(!n)throw new Rt(2,2,2008)},iI.prototype.setSequenceMode=function(){},iI.prototype.setManifestType=function(){},iI.prototype.parseMedia=function(e,t){if(!e.length)return[];if(!this.g)throw new Rt(2,2,2008);var n,i=0,r=[],a=[],o=!1,s=!1,l=!1,u=null;if((new ca).box("moof",da).box("traf",da).S("tfdt",function(e){o=!0,i=ms(e.reader,e.version).baseMediaDecodeTime}).S("tfhd",function(e){u=gs(e.reader,e.flags).qd}).S("trun",function(e){s=!0,r=ys(e.reader,e.version,e.flags).fh}).box("mdat",ga(function(e){l=!0,n=e})).parse(e,!1),!l&&!o&&!s)throw new Rt(2,2,2008);e=i;for(var d=new sa(n,0),f=c(r),h=f.next();!h.done;h=f.next()){h=h.value;var p=h.$f||u,g=h.He?i+h.He:e;e=g+(p||0);var m=0;do{var v=d.P();m+=v;var y=d.P(),_=null;"vttc"==va(y)?8<v&&(_=d.rb(v-8)):d.skip(v-8),p&&_&&(v=rI(_,t.periodStart+g/this.g,t.periodStart+e/this.g),a.push(v))}while(h.sampleSize&&m<h.sampleSize)}return a.filter(si)},K("shaka.text.Mp4VttParser",iI),iI.prototype.parseMedia=iI.prototype.parseMedia,iI.prototype.setManifestType=iI.prototype.setManifestType,iI.prototype.setSequenceMode=iI.prototype.setSequenceMode,iI.prototype.parseInit=iI.prototype.parseInit,ri['application/mp4; codecs="wvtt"']=function(){return new iI},oI.prototype.parseInit=function(){},oI.prototype.setSequenceMode=function(){},oI.prototype.setManifestType=function(){},oI.prototype.parseMedia=function(e){var t=fn(e).replace(/\r+/g,"");if(t=t.trim(),e=[],""==t)return e;t=c(t.split("\n\n"));for(var n=t.next();!n.done;n=t.next()){n=n.value.split("\n");var i=new Gh(n[0]),r=sI(i),a=Vh(i,/,/g);if(i=sI(i),null==r||null==a||null==i)throw new Rt(2,2,2001,"Could not parse cue time range in SubViewer");e.push(new Be(r,i,n.slice(1).join("\n").trim()))}return e},K("shaka.text.SbvTextParser",oI),oI.prototype.parseMedia=oI.prototype.parseMedia,oI.prototype.setManifestType=oI.prototype.setManifestType,oI.prototype.setSequenceMode=oI.prototype.setSequenceMode,oI.prototype.parseInit=oI.prototype.parseInit,ri["text/x-subviewer"]=function(){return new oI},lI.prototype.parseInit=function(){},lI.prototype.setSequenceMode=function(){},lI.prototype.setManifestType=function(){},lI.prototype.parseMedia=function(e,t,n){return e=fn(e),e=uI(e),e=we(gn(e)),this.g.parseMedia(e,t,n)},K("shaka.text.SrtTextParser",lI),lI.srt2webvtt=uI,lI.prototype.parseMedia=lI.prototype.parseMedia,lI.prototype.setManifestType=lI.prototype.setManifestType,lI.prototype.setSequenceMode=lI.prototype.setSequenceMode,lI.prototype.parseInit=lI.prototype.parseInit,ri["text/srt"]=function(){return new lI},cI.prototype.parseInit=function(){},cI.prototype.setSequenceMode=function(){},cI.prototype.setManifestType=function(){},cI.prototype.parseMedia=function(e){var t="",n="",i=null,r=null;for(r=fn(e).split(/\r?\n\s*\r?\n/),e=c(r),r=e.next();!r.done;r=e.next()){var a=r.value;r=a,(a=pI.exec(a))&&(i=a[1],r=a[2]),"V4 Styles"==i||"V4+ Styles"==i?(t=r,t=n?t+"\n"+r:r):"Events"==i&&(n=n?n+"\n"+r:r)}for(i=[],r=null,t=c(t.split(/\r?\n/)),a=t.next();!a.done;a=t.next())if(e=a.value,!/^\s*;/.test(e)&&(a=gI.exec(e)))if(e=a[1].trim(),a=a[2].trim(),"Format"==e)r=a.split(mI);else if("Style"==e){e=a.split(mI),a={};for(var o=0;o<r.length&&o<e.length;o++)a[r[o]]=e[o];i.push(a)}for(r=[],t=null,e={},n=c(n.split(/\r?\n/)),a=n.next();!a.done;e={Ve:e.Ve},a=n.next())if(a=a.value,!/^\s*;/.test(a)&&(o=gI.exec(a)))if(a=o[1].trim(),o=o[2].trim(),"Format"==a)t=o.split(mI);else if("Dialogue"==a){o=o.split(mI),a={};for(var s=0;s<t.length&&s<o.length;s++)a[t[s]]=o[s];s=hI(a.Start);var l=hI(a.End);o=new Be(s,l,o.slice(t.length-1).join(",").replace(/\\N/g,"\n").replace(/\{[^}]+\}/g,"")),e.Ve=a.Style,(a=i.find(function(e){return function(t){return t.Name==e.Ve}}(e)))&&dI(o,a),r.push(o)}return r},K("shaka.text.SsaTextParser",cI),cI.prototype.parseMedia=cI.prototype.parseMedia,cI.prototype.setManifestType=cI.prototype.setManifestType,cI.prototype.setSequenceMode=cI.prototype.setSequenceMode,cI.prototype.parseInit=cI.prototype.parseInit;var pI=/^\s*\[([^\]]+)\]\r?\n([\s\S]*)/,gI=/^\s*([^:]+):\s*(.*)/,mI=/\s*,\s*/,vI=/^(\d+:)?(\d{1,2}):(\d{1,2}(?:[.]\d{1,3})?)?$/;function yI(e,t){var n=1&e[t+1]?7:9;return t+n<=e.length&&(e=((3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5)-n,0<e)?{le:n,ba:e}:null}function _I(e,t){var n=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],i=(60&e[t+2])>>>2;if(i>n.length-1)return null;var r=1+((192&e[t+2])>>>6),a=(1&e[t+2])<<2;return a|=(192&e[t+3])>>>6,{sampleRate:n[i],channelCount:a,Na:"mp4a.40."+r}}function bI(e,t){if(t+1<e.length&&255===e[t]&&240===(246&e[t+1])){var n=1&e[t+1]?7:9;if(t+n>=e.length)return!1;var i=(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5;return!(i<=n)&&(t+=i,t===e.length||t+1<e.length&&255===e[t]&&240===(246&e[t+1]))}return!1}function EI(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t||3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}function TI(e){this.i=e,this.h=0,this.g=new Map}function SI(e,t){if(t+8>e.length||11!==e[t]||119!==e[t+1])return null;var n=e[t+4]>>6;if(3<=n)return null;var i=63&e[t+4],r=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*i+n];if(t+r>e.length)return null;var a=e[t+6]>>5,o=0;2===a?o+=2:(1&a&&1!==a&&(o+=2),4&a&&(o+=2)),o=(e[t+6]<<8|e[t+7])>>12-o&1;var s=7&e[t+5];return e=new Uint8Array([n<<6|e[t+5]>>3<<1|s>>2,(3&s)<<6|a<<3|o<<2|i>>4,i<<4&224]),{sampleRate:[48e3,44100,32e3][n],channelCount:[2,1,2,3,3,4,4,5][a]+o,ma:e,ba:r}}function wI(e,t){if(11===e[t]&&119===e[t+1]){var n,i,r=0,a=5;for(t+=a;0<a;){i=e[t];var o=Math.min(a,8),s=8-o;n=4278190080>>>24+s<<s,n=(i&n)>>s,r=r?r<<o|n:n,t+=1,a-=o}if(16>r)return!0}return!1}function AI(e){this.i=e,this.h=0,this.g=new Map}function II(e,t){if(t+8>e.length||2935!==(e[t]<<8|e[t+1]<<0))return null;var n=new ws(e.subarray(t+2));Is(n,2),Is(n,3);var i=xs(n,11)+1<<1,r=xs(n,2);if(3==r){r=xs(n,2),r=[24e3,22060,16e3][r];var a=3}else r=[48e3,44100,32e3][r],a=xs(n,2);var o=xs(n,3),s=xs(n,1);return n=xs(n,5),t+i>e.byteLength?null:(e=Math.floor(i*r/(16*[1,2,3,6][a])),e=new Uint8Array([(8160&e)>>5,(31&e)<<3,r<<6|n<<1|0,0|o<<1|s<<0,0]),{sampleRate:r,channelCount:[2,1,2,3,3,4,4,5][o]+s,ma:e,ba:i})}function xI(e){this.i=e,this.h=0,this.g=new Map}function RI(e){if(!e.length)return null;var t=e.find(function(e){return 7==e.type});if(e=e.find(function(e){return 8==e.type}),!t||!e)return null;var n=new ws(t.data),i=Ls(n);if(Ls(n),Ls(n),Cs(n),DI.includes(i)&&(i=Ds(n),3===i&&Is(n,1),Cs(n),Cs(n),Is(n,1),Ms(n))){i=3!==i?8:12;for(var r=0;r<i;r++)Ms(n)&&Ps(n,6>r?16:64)}if(Cs(n),i=Ds(n),0===i)Ds(n);else if(1===i)for(Is(n,1),Cs(n),Cs(n),i=Ds(n),r=0;r<i;r++)Cs(n);Cs(n),Is(n,1);var a=Ds(n),o=Ds(n),s=xs(n,1);0===s&&Is(n,1),Is(n,1);var l=0,u=0,c=0,f=0;if(Ms(n)&&(l=Ds(n),u=Ds(n),c=Ds(n),f=Ds(n)),r=i=1,Ms(n)&&Ms(n)){var h=Ls(n),p=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],g=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];0<h&&16>=h?(i=p[h-1],r=g[h-1]):255===h&&(i=xs(n,16),r=xs(n,16))}return n=(2-s)*(o+1)*16-2*c-2*f,a=16*(a+1)-2*l-2*u,l=[],t=t.fullData,l.push(t.byteLength>>>8&255),l.push(255&t.byteLength),l=l.concat.apply(l,d(t)),t=[],e=e.fullData,t.push(e.byteLength>>>8&255),t.push(255&e.byteLength),t=t.concat.apply(t,d(e)),e=new Uint8Array([1,l[3],l[4],l[5],255,225].concat(l,[1],t)),{height:n,width:a,wa:e,Ba:i,Ca:r}}function CI(e){var t=!1,n=[],i=e.find(function(e){return 7==e.type}),r=!1;e=c(e);for(var a=e.next();!a.done;a=e.next()){a=a.value;var o=!1;switch(a.type){case 1:o=r=!0;var s=a.data;i&&4<s.length&&(s=Ns(new ws(s)),2===s||4===s||7===s||9===s)&&(t=!0);break;case 5:t=o=r=!0;break;case 6:o=!0;break;case 7:o=!0;break;case 8:o=!0;break;case 9:r=o=!0;break;case 12:o=!0;break;default:o=!1}r&&o&&(o=a.fullData.byteLength,s=new Uint8Array(4),s[0]=o>>24&255,s[1]=o>>16&255,s[2]=o>>8&255,s[3]=255&o,n.push(s),n.push(a.fullData))}return n.length?{data:In.apply(bn,d(n)),Cd:t}:null}ri["text/x-ssa"]=function(){return new cI},i=TI.prototype,i.destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/aac"==e.toLowerCase().split(";")[0]&&ce(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/aac"==t.toLowerCase().split(";")[0]?'audio/mp4; codecs="'+(Zn(t)||"mp4a.40.2")+'"':t},i.getOriginalMimeType=function(){return this.i},i.transmux=function(e,t,n,i){for(var r=we(e),a=ps(r),o=a.length;o<r.length&&!bI(r,o);o++);if(e=1e3*n.endTime,a=hs(a),a.length&&n&&(a=a.find(function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description}))&&(e=a.data),a=_I(r,o),!a)return Promise.reject(new Rt(2,3,3018,n?n.M()[0]:null));t.audioSamplingRate=a.sampleRate,t.channelsCount=a.channelCount;for(var s=[];o<r.length;){var l=yI(r,o);if(!l)return Promise.reject(new Rt(2,3,3018,n?n.M()[0]:null));var u=l.le+l.ba;o+u<=r.length&&s.push({data:r.subarray(o+l.le,o+u),size:l.ba,duration:1024,eb:0,flags:{hb:0,Xa:0,Wa:0,Ua:0,Va:2,ib:0}}),o+=u}return r=a.sampleRate,e=Math.floor(e*r/1e3),i={id:t.id,type:"audio",codecs:a.Na,encrypted:t.encrypted&&0<t.drmInfos.length,timescale:r,duration:i,ab:[],ma:new Uint8Array([]),wa:new Uint8Array([]),Ba:0,Ca:0,data:{sb:this.h,baseMediaDecodeTime:e,Za:s},stream:t},i=new Vb([i]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=Hb(i),this.g.set(n,t)),n=Yb(i),this.h++,t=In(t,n),Promise.resolve(t)},K("shaka.transmuxer.AacTransmuxer",TI),TI.prototype.transmux=TI.prototype.transmux,TI.prototype.getOriginalMimeType=TI.prototype.getOriginalMimeType,TI.prototype.convertCodecs=TI.prototype.convertCodecs,TI.prototype.isSupported=TI.prototype.isSupported,TI.prototype.destroy=TI.prototype.destroy,rt("audio/aac",function(){return new TI("audio/aac")},st),i=AI.prototype,i.destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/ac3"==e.toLowerCase().split(";")[0]&&ce(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/ac3"==t.toLowerCase().split(";")[0]?'audio/mp4; codecs="ac-3"':t},i.getOriginalMimeType=function(){return this.i},i.transmux=function(e,t,n,i){e=we(e);for(var r=ps(e),a=r.length;a<e.length&&!wI(e,a);a++);var o=1e3*n.endTime;r=hs(r),r.length&&n&&(r=r.find(function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description}))&&(o=r.data),r=0;for(var s=new Uint8Array([]),l=[];a<e.length;){var u=SI(e,a);if(!u)return Promise.reject(new Rt(2,3,3018,n?n.M()[0]:null));t.audioSamplingRate=u.sampleRate,t.channelsCount=u.channelCount,r=u.sampleRate,s=u.ma,l.push({data:e.subarray(a,a+u.ba),size:u.ba,duration:1536,eb:0,flags:{hb:0,Xa:0,Wa:0,Ua:0,Va:2,ib:0}}),a+=u.ba}return e=Math.floor(o*r/1e3),i={id:t.id,type:"audio",codecs:"ac-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:r,duration:i,ab:[],ma:s,wa:new Uint8Array([]),Ba:0,Ca:0,data:{sb:this.h,baseMediaDecodeTime:e,Za:l},stream:t},i=new Vb([i]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=Hb(i),this.g.set(n,t)),n=Yb(i),this.h++,t=In(t,n),Promise.resolve(t)},K("shaka.transmuxer.Ac3Transmuxer",AI),AI.prototype.transmux=AI.prototype.transmux,AI.prototype.getOriginalMimeType=AI.prototype.getOriginalMimeType,AI.prototype.convertCodecs=AI.prototype.convertCodecs,AI.prototype.isSupported=AI.prototype.isSupported,AI.prototype.destroy=AI.prototype.destroy,rt("audio/ac3",function(){return new AI("audio/ac3")},st),i=xI.prototype,i.destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/ec3"==e.toLowerCase().split(";")[0]&&ce(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/ec3"==t.toLowerCase().split(";")[0]?'audio/mp4; codecs="ec-3"':t},i.getOriginalMimeType=function(){return this.i},i.transmux=function(e,t,n,i){e=we(e);for(var r=ps(e),a=r.length;a<e.length&&2935!==(e[a]<<8|e[a+1]<<0);a++);var o=1e3*n.endTime;r=hs(r),r.length&&n&&(r=r.find(function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description}))&&(o=r.data),r=0;for(var s=new Uint8Array([]),l=[];a<e.length;){var u=II(e,a);if(!u)return Promise.reject(new Rt(2,3,3018,n?n.M()[0]:null));t.audioSamplingRate=u.sampleRate,t.channelsCount=u.channelCount,r=u.sampleRate,s=u.ma,l.push({data:e.subarray(a,a+u.ba),size:u.ba,duration:1536,eb:0,flags:{hb:0,Xa:0,Wa:0,Ua:0,Va:2,ib:0}}),a+=u.ba}return e=Math.floor(o*r/1e3),i={id:t.id,type:"audio",codecs:"ec-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:r,duration:i,ab:[],ma:s,wa:new Uint8Array([]),Ba:0,Ca:0,data:{sb:this.h,baseMediaDecodeTime:e,Za:l},stream:t},i=new Vb([i]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=Hb(i),this.g.set(n,t)),n=Yb(i),this.h++,t=In(t,n),Promise.resolve(t)},K("shaka.transmuxer.Ec3Transmuxer",xI),xI.prototype.transmux=xI.prototype.transmux,xI.prototype.getOriginalMimeType=xI.prototype.getOriginalMimeType,xI.prototype.convertCodecs=xI.prototype.convertCodecs,xI.prototype.isSupported=xI.prototype.isSupported,xI.prototype.destroy=xI.prototype.destroy,rt("audio/ec3",function(){return new xI("audio/ec3")},st);var DI=[100,110,122,244,44,83,86,118,128,138,139,134];function kI(e){if(!e.length)return null;var t=e.find(function(e){return 32==e.type}),n=e.find(function(e){return 33==e.type}),i=e.find(function(e){return 34==e.type});if(!t||!n||!i)return null;var r=MI(t.fullData);e=LI(n.fullData);var a=PI(i.fullData);return t=NI(t.fullData,n.fullData,i.fullData,{Qf:r.Qf,kg:r.kg,Bf:e.Bf,Cf:e.Cf,vf:e.vf,Af:e.Af,wf:e.wf,xf:e.xf,yf:e.yf,zf:e.zf,nf:e.nf,pf:e.pf,qf:e.qf,rf:e.rf,tf:e.tf,uf:e.uf,hf:e.hf,ve:e.ve,ff:e.ff,df:e.df,cf:e.cf,Tf:a.Tf}),{height:e.height,width:e.width,wa:t,Ba:e.Yi,Ca:e.Xi}}function MI(e){var t=new ws(e,!0);return Ls(t),Ls(t),xs(t,4),xs(t,2),xs(t,6),e=xs(t,3),t=Ms(t),{Qf:e+1,kg:t}}function LI(e){e=new ws(e,!0),Ls(e),Ls(e);var t=0,n=0,i=0,r=0;xs(e,4);var a=xs(e,3);Ms(e);for(var o=xs(e,2),s=xs(e,1),l=xs(e,5),u=Ls(e),c=Ls(e),d=Ls(e),f=Ls(e),h=Ls(e),p=Ls(e),g=Ls(e),m=Ls(e),v=Ls(e),y=Ls(e),_=Ls(e),b=[],E=[],T=0;T<a;T++)b.push(Ms(e)),E.push(Ms(e));if(0<a)for(T=a;8>T;T++)xs(e,2);for(T=0;T<a;T++)b[T]&&xs(e,88),E[T]&&Ls(e);Ds(e),b=Ds(e),3==b&&xs(e,1),E=Ds(e),T=Ds(e),Ms(e)&&(t+=Ds(e),n+=Ds(e),i+=Ds(e),r+=Ds(e));var S=Ds(e),w=Ds(e),A=Ds(e);if(Ms(e))for(var I=0;I<=a;I++)Ds(e),Ds(e),Ds(e);else Ds(e),Ds(e),Ds(e);if(Ds(e),Ds(e),Ds(e),Ds(e),Ds(e),Ds(e),Ms(e)&&Ms(e))for(I=0;4>I;I++)for(var x=0;x<(3===I?2:6);x++)if(Ms(e)){var R=Math.min(64,1<<4+(I<<1));1<I&&ks(e);for(var C=0;C<R;C++)ks(e)}else Ds(e);for(Ms(e),Ms(e),Ms(e)&&(Ls(e),Ds(e),Ds(e),Ms(e)),I=Ds(e),R=x=0;R<I;R++)if(C=!1,0!==R&&(C=Ms(e)),C){R===I&&Ds(e),Ms(e),Ds(e);for(var D=C=0;D<=x;D++){var k=Ms(e),M=!1;k||(M=Ms(e)),(k||M)&&C++}x=C}else{for(D=Ds(e),C=Ds(e),x=D+C,k=0;k<D;k++)Ds(e),Ms(e);for(D=0;D<C;D++)Ds(e),Ms(e)}if(Ms(e))for(I=Ds(e),x=0;x<I;x++){for(R=0;R<A+4;R++)xs(e,1);xs(e,1)}if(I=A=1,x=0,Ms(e),Ms(e),Ms(e)){if(Ms(e)&&(R=Ls(e),C=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],D=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1],0<R&&16>=R?(A=C[R-1],I=D[R-1]):255===R&&(A=xs(e,16),I=xs(e,16))),Ms(e)&&Ms(e),Ms(e)&&(xs(e,3),Ms(e),Ms(e)&&(Ls(e),Ls(e),Ls(e))),Ms(e)&&(Ds(e),Ds(e)),Ms(e),Ms(e),Ms(e),(R=Ms(e))&&(Ds(e),Ds(e),Ds(e),Ds(e)),Ms(e)&&(xs(e,32),xs(e,32),Ms(e)&&Ds(e),Ms(e)))for(D=!1,R=Ms(e),C=Ms(e),(R||C)&&((D=Ms(e))&&(Ls(e),xs(e,5),Ms(e),xs(e,5)),xs(e,4),xs(e,4),D&&xs(e,4),xs(e,5),xs(e,5),xs(e,5)),k=0;k<=a;k++){var L=!0;M=1,Ms(e)||(L=Ms(e));var P=!1;if(L?Ds(e):P=Ms(e),P||(M=Ds(e)+1),R){for(L=0;L<M;L++)Ds(e),Ds(e),D&&(Ds(e),Ds(e));Ms(e)}if(C){for(L=0;L<M;L++)Ds(e),Ds(e),D&&(Ds(e),Ds(e));Ms(e)}}Ms(e)&&(Ms(e),Ms(e),Ms(e),x=Ds(e),Ds(e),Ds(e),Ds(e),Ds(e))}return{vf:_,Bf:o,Cf:s,Af:l,wf:u,xf:c,yf:d,zf:f,nf:h,pf:p,qf:g,rf:m,tf:v,uf:y,ve:x,hf:0,ff:b,df:S,cf:w,width:E-(t+n)*(1===b||2===b?2:1),height:T-(i+r)*(1===b?2:1),Yi:A,Xi:I}}function PI(e){var t=new ws(e,!0);Ls(t),Ls(t),Ds(t),Ds(t),Ms(t),Ms(t),xs(t,3),Ms(t),Ms(t),Ds(t),Ds(t),ks(t),Ms(t),Ms(t),Ms(t)&&Ds(t),ks(t),ks(t),Ms(t),Ms(t),Ms(t),Ms(t),e=Ms(t),t=Ms(t);var n=1;return t&&e?n=0:t?n=3:e&&(n=2),{Tf:n}}function NI(e,t,n,i){var r=new Uint8Array(23+(5+e.byteLength)+(5+t.byteLength)+(5+n.byteLength));return r[0]=1,r[1]=(3&i.Bf)<<6|(i.Cf?1:0)<<5|31&i.Af,r[2]=i.wf,r[3]=i.xf,r[4]=i.yf,r[5]=i.zf,r[6]=i.nf,r[7]=i.pf,r[8]=i.qf,r[9]=i.rf,r[10]=i.tf,r[11]=i.uf,r[12]=i.vf,r[13]=240|(3840&i.ve)>>8,r[14]=255&i.ve,r[15]=252|3&i.Tf,r[16]=252|3&i.ff,r[17]=248|7&i.df,r[18]=248|7&i.cf,r[19]=0,r[20]=0,r[21]=(3&i.hf)<<6|(7&i.Qf)<<3|(i.kg?1:0)<<2|3,r[22]=3,r[23]=160,r[24]=0,r[25]=1,r[26]=(65280&e.byteLength)>>8,r[27]=(255&e.byteLength)>>0,r.set(e,28),r[23+(5+e.byteLength)]=161,r[e.byteLength+29]=0,r[e.byteLength+30]=1,r[e.byteLength+31]=(65280&t.byteLength)>>8,r[e.byteLength+32]=(255&t.byteLength)>>0,r.set(t,e.byteLength+33),r[23+(e.byteLength+10+t.byteLength)]=162,r[e.byteLength+10+t.byteLength+24]=0,r[e.byteLength+10+t.byteLength+25]=1,r[e.byteLength+10+t.byteLength+26]=(65280&n.byteLength)>>8,r[e.byteLength+10+t.byteLength+27]=(255&n.byteLength)>>0,r.set(n,e.byteLength+10+t.byteLength+28),r}function OI(e,t){var n=e[t+1]>>3&3,i=e[t+1]>>1&3,r=e[t+2]>>4&15,a=e[t+2]>>2&3;if(1!==n&&0!==r&&15!==r&&3!==a){var o=e[t+3]>>6;r=1e3*BI[14*(3===n?3-i:3===i?3:4)+r-1],a=GI[3*(3===n?0:2===n?1:2)+a],n=jI[n][i];var s=VI[i],l=Math.floor(n*r/a+(e[t+2]>>1&1))*s,u=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);return(u=u?parseInt(u[1],10):0)&&87>=u&&2===i&&224e3<=r&&0===o&&(e[t+3]|=128),{sampleRate:a,channelCount:3===o?1:2,ba:l,Wi:8*n*s}}return null}function FI(e,t){return 255===e[t]&&224===(224&e[t+1])&&0!==(6&e[t+1])}function UI(e,t){if(t+1<e.length&&FI(e,t)){var n=OI(e,t),i=4;return n&&n.ba&&(i=n.ba),t+=i,t===e.length||t+1<e.length&&FI(e,t)}return!1}var BI=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],GI=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],jI=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],VI=[0,1,1,4];function HI(e){this.i=e,this.h=0,this.g=new Map}function KI(e){this.h=e,this.g=null}
/*
 @license
 MSS Transmuxer
 Copyright 2015 Dash Industry Forum
 SPDX-License-Identifier: BSD-3-Clause
*/
function zI(e){this.h=e,(this.g=Jy.get("ISOBoxer")())&&ZI(this)}function ZI(e){function t(){this._procFullBox(),1&this.flags&&(this._procField("AlgorithmID","uint",24),this._procField("IV_size","uint",8),this._procFieldArray("KID",16,"uint",8)),this._procField("sample_count","uint",32),this._procEntries("entry",this.sample_count,function(e){this._procEntryField(e,"InitializationVector","data",8),2&this.flags&&(this._procEntryField(e,"NumberOfEntries","uint",16),this._procSubEntries(e,"clearAndCryptedData",e.NumberOfEntries,function(e){this._procEntryField(e,"BytesOfClearData","uint",16),this._procEntryField(e,"BytesOfEncryptedData","uint",32)}))})}e.g.addBoxProcessor("saio",function(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("entry_count","uint",32),this._procFieldArray("offset",this.entry_count,"uint",1===this.version?64:32)}),e.g.addBoxProcessor("saiz",function(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("default_sample_info_size","uint",8),this._procField("sample_count","uint",32),0===this.default_sample_info_size&&this._procFieldArray("sample_info_size",this.sample_count,"uint",8)}),e.g.addBoxProcessor("senc",t),e.g.addBoxProcessor("uuid",function(){for(var e=!0,n=0;16>n;n++)this.usertype[n]!==YI[n]&&(e=!1);e&&(this._parsing&&(this.type="sepiff"),t.call(this))})}function qI(e,t){for(var n=8,i=0;i<e.boxes.length&&e.boxes[i].type!==t;i++)n+=e.boxes[i].size;return n}i=HI.prototype,i.destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/mpeg"==e.toLowerCase().split(";")[0]&&ce(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/mpeg"==t.toLowerCase().split(";")[0]?'audio/mp4; codecs="mp3"':t},i.getOriginalMimeType=function(){return this.i},i.transmux=function(e,t,n,i){for(var r=we(e),a=ps(r).length;a<r.length&&!UI(r,a);a++);var o;for(e=[];a<r.length;){var s=OI(r,a);if(!s)return Promise.reject(new Rt(2,3,3018,n?n.M()[0]:null));o||(o=s),a+s.ba<=r.length&&e.push({data:r.subarray(a,a+s.ba),size:s.ba,duration:1152,eb:0,flags:{hb:0,Xa:0,Wa:0,Ua:0,Va:2,ib:0}}),a+=s.ba}return o?(r=9e4*o.Wi/o.sampleRate*this.h,i={id:t.id,type:"audio",codecs:"mp3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:o.sampleRate,duration:i,ab:[],ma:new Uint8Array([]),wa:new Uint8Array([]),Ba:0,Ca:0,data:{sb:this.h,baseMediaDecodeTime:r,Za:e},stream:t},i=new Vb([i]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=Hb(i),this.g.set(n,t)),n=Yb(i),this.h++,t=In(t,n),Promise.resolve(t)):Promise.reject(new Rt(2,3,3018,n?n.M()[0]:null))},K("shaka.transmuxer.Mp3Transmuxer",HI),HI.prototype.transmux=HI.prototype.transmux,HI.prototype.getOriginalMimeType=HI.prototype.getOriginalMimeType,HI.prototype.convertCodecs=HI.prototype.convertCodecs,HI.prototype.isSupported=HI.prototype.isSupported,HI.prototype.destroy=HI.prototype.destroy,rt("audio/mpeg",function(){return new HI("audio/mpeg")},st),i=KI.prototype,i.destroy=function(){},i.isSupported=function(e){if("video/mp2t"!=e.toLowerCase().split(";")[0])return!1;var t=Zn(e).split(","),n=kn("audio",t);return t=kn("video",t),!(!n||t||"mp3"!=Hn(n))&&ce(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"video/mp2t"==t.toLowerCase().split(";")[0]?"audio/mpeg":t},i.getOriginalMimeType=function(){return this.h},i.transmux=function(e,t,n,i,r){if(this.g?this.g.clearData():this.g=new Os,e=we(e),e=this.g.parse(e),"mp3"!=e.sd().audio||"audio"!=r)return Promise.reject(new Rt(2,3,3018,n?n.M()[0]:null));for(n=new Uint8Array([]),r=c(e.Wb()),e=r.next();!e.done;e=r.next())if(e=e.value.data)for(t=0;t<e.length;)(i=OI(e,t))?(t+i.ba<=e.length&&(n=In(n,e.subarray(t,t+i.ba))),t+=i.ba):t++;return Promise.resolve(n)},K("shaka.transmuxer.MpegTsTransmuxer",KI),KI.prototype.transmux=KI.prototype.transmux,KI.prototype.getOriginalMimeType=KI.prototype.getOriginalMimeType,KI.prototype.convertCodecs=KI.prototype.convertCodecs,KI.prototype.isSupported=KI.prototype.isSupported,KI.prototype.destroy=KI.prototype.destroy,rt("video/mp2t",function(){return new KI("video/mp2t")},lt),i=zI.prototype,i.destroy=function(){},i.isSupported=function(e,t){var n=e.startsWith("mss/");return!(!this.g||!n)&&(t?ce(this.convertCodecs(t,e)):(t=this.convertCodecs("audio",e),e=this.convertCodecs("video",e),ce(t)||ce(e)))},i.convertCodecs=function(e,t){return t.replace("mss/","")},i.getOriginalMimeType=function(){return this.h},i.transmux=function(e,t,n){if(!n)return Promise.resolve(we(e));if(!t.mssPrivateData)return Promise.reject(new Rt(2,3,3020,n?n.M()[0]:null));try{var i,r=this.g.parseBuffer(e),a=r.fetch("tfhd");a.track_ID=t.id+1;var o=r.fetch("tfdt"),s=r.fetch("traf");null===o&&(o=this.g.createFullBox("tfdt",s,a),o.version=1,o.flags=0,o.baseMediaDecodeTime=Math.floor(n.startTime*t.mssPrivateData.timescale));var l=r.fetch("trun"),u=r.fetch("tfxd");u&&u._parent.boxes.splice(u._parent.boxes.indexOf(u),1);var c=r.fetch("tfrf");c&&c._parent.boxes.splice(c._parent.boxes.indexOf(c),1);var d=r.fetch("sepiff");if(null!==d){d.type="senc",d.usertype=void 0;var f=r.fetch("saio");if(null===f){f=this.g.createFullBox("saio",s),f.version=0,f.flags=0,f.entry_count=1,f.offset=[0];var h=this.g.createFullBox("saiz",s);if(h.version=0,h.flags=0,h.sample_count=d.sample_count,h.default_sample_info_size=0,h.sample_info_size=[],2&d.flags)for(i=0;i<d.sample_count;i+=1)h.sample_info_size[i]=10+6*d.entry[i].NumberOfEntries;else h.default_sample_info_size=8}}a.flags&=16777214,a.flags|=131072,l.flags|=1;var p=r.fetch("moof");l.data_offset=p.getLength()+8;var g=r.fetch("saio");null!==g&&(g.offset[0]=qI(p,"traf")+qI(s,"senc")+16);var m=we(r.write());return Promise.resolve(m)}catch(e){return e instanceof Rt?Promise.reject(e):Promise.reject(new Rt(2,3,3022,n?n.M()[0]:null))}},K("shaka.transmuxer.MssTransmuxer",zI),zI.prototype.transmux=zI.prototype.transmux,zI.prototype.getOriginalMimeType=zI.prototype.getOriginalMimeType,zI.prototype.convertCodecs=zI.prototype.convertCodecs,zI.prototype.isSupported=zI.prototype.isSupported,zI.prototype.destroy=zI.prototype.destroy;var YI=new Uint8Array([162,57,79,82,90,155,79,20,162,68,108,66,124,100,141,244]);function WI(e){this.l=e,this.g=0,this.i=new Map,this.h=this.j=null}rt("mss/audio/mp4",function(){return new zI("mss/audio/mp4")},st),rt("mss/video/mp4",function(){return new zI("mss/video/mp4")},st),i=WI.prototype,i.destroy=function(){this.i.clear(),this.h&&this.h.destroy()},i.isSupported=function(e,t){if("video/mp2t"!=e.toLowerCase().split(";")[0])return!1;var n=e;t&&(n=this.convertCodecs(t,e));var i=Zn(n).split(",");return n=kn("audio",i),i=kn("video",i),!(n&&(n=Hn(n),!QI.includes(n))||i&&(n=Hn(i),!JI.includes(n)))&&(t?ce(this.convertCodecs(t,e)):(t=this.convertCodecs("audio",e),e=this.convertCodecs("video",e),ce(t)||ce(e)))},i.convertCodecs=function(e,t){return"video/mp2t"==t.toLowerCase().split(";")[0]?(t=Zn(t).replace("mp4a.40.34","mp3").split(",").map(function(e){return Pi(e,"audio/mp4")}).map(Ni).join(","),"audio"==e?'audio/mp4; codecs="'+t+'"':'video/mp4; codecs="'+t+'"'):t},i.getOriginalMimeType=function(){return this.l},i.transmux=function(e,t,n,i,r){var a=we(e);if("audio"==r&&!js(a)){for(var o=ps(a),s=o.length;s<a.length;s++)if(UI(a,s))return Promise.reject(new Rt(2,3,3018,n?n.M()[0]:null));for(s=o.length;s<a.length;s++)if(bI(a,s))return this.h||(this.h=new TI("audio/aac")),this.h.transmux(e,t,n,i,r);return Promise.reject(new Rt(2,3,3018,n?n.M()[0]:null))}this.j?this.j.clearData():this.j=new Os;var l=this.j.parse(a),u=[],f=l.sd();try{var h=null;if("video"==r){switch(f.video){case"avc":var p=[],g=null,m=[],v=l.Ic();if(!v.length)throw new Rt(2,3,3023,n?n.M()[0]:null);for(var y=0;y<v.length;y++){var _=v[y],b=_.nalus;m.push.apply(m,d(b));var E=CI(b);if(E){null==g&&(g=_.dts);var T=void 0;T=y+1<v.length?(v[y+1].dts||0)-(_.dts||0):1<v.length?(_.dts||0)-(v[y-1].dts||0):9e4*(n.endTime-n.startTime),p.push({data:E.data,size:E.data.byteLength,duration:T,eb:Math.round((_.pts||0)-(_.dts||0)),flags:{hb:0,Xa:0,Wa:0,Ua:0,Va:E.Cd?2:1,ib:E.Cd?0:1}})}}var S=RI(m);if(!S||null==g)throw new Rt(2,3,3018,n?n.M()[0]:null);t.height=S.height,t.width=S.width,h={id:t.id,type:"video",codecs:"avc1",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:9e4,duration:i,ab:[],ma:new Uint8Array([]),wa:S.wa,Ba:S.Ba,Ca:S.Ca,data:{sb:this.g,baseMediaDecodeTime:g,Za:p},stream:t};break;case"hvc":var w=[],A=null,I=[],x=l.Ic();if(!x.length)throw new Rt(2,3,3023,n?n.M()[0]:null);for(var R=0;R<x.length;R++){var C=x[R],D=C.nalus;I.push.apply(I,d(D));for(var k=!1,M=[],L=!1,P=c(D),N=P.next();!N.done;N=P.next()){var O=N.value;switch(O.type){case 1:case 0:var F=L=!0;break;case 19:case 20:case 21:k=F=L=!0;break;case 32:F=!0;break;case 33:F=!0;break;case 34:F=!0;break;case 35:L=F=!0;break;case 39:case 40:F=!0;break;default:F=!1}if(L&&F){var U=O.fullData.byteLength,B=new Uint8Array(4);B[0]=U>>24&255,B[1]=U>>16&255,B[2]=U>>8&255,B[3]=255&U,M.push(B),M.push(O.fullData)}}var G=M.length?{data:In.apply(bn,d(M)),Cd:k}:null;if(G){null==A&&null!=C.dts&&(A=C.dts);var j=void 0;j=R+1<x.length?(x[R+1].dts||0)-(C.dts||0):1<x.length?(C.dts||0)-(x[R-1].dts||0):9e4*(n.endTime-n.startTime),w.push({data:G.data,size:G.data.byteLength,duration:j,eb:Math.round((C.pts||0)-(C.dts||0)),flags:{hb:0,Xa:0,Wa:0,Ua:0,Va:G.Cd?2:1,ib:G.Cd?0:1}})}}var V=kI(I);if(!V||null==A)throw new Rt(2,3,3018,n?n.M()[0]:null);t.height=V.height,t.width=V.width,h={id:t.id,type:"video",codecs:"hvc1",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:9e4,duration:i,ab:[],ma:new Uint8Array([]),wa:V.wa,Ba:V.Ba,Ca:V.Ca,data:{sb:this.g,baseMediaDecodeTime:A,Za:w},stream:t}}h&&(u.push(h),h=null)}if("audio"==r){switch(f.audio){case"aac":for(var H,K=[],z=null,Z=c(l.Wb()),q=Z.next();!q.done;q=Z.next()){var Y=q.value,W=Y.data;if(W){var $=0;if(H=_I(W,$),!H)throw new Rt(2,3,3018,n?n.M()[0]:null);for(t.audioSamplingRate=H.sampleRate,t.channelsCount=H.channelCount,null==z&&null!==Y.pts&&(z=Y.pts);$<W.length;){var X=yI(W,$);if(X){var Q=X.le+X.ba;$+Q<=W.length&&K.push({data:W.subarray($+X.le,$+Q),size:X.ba,duration:1024,eb:0,flags:{hb:0,Xa:0,Wa:0,Ua:0,Va:2,ib:0}}),$+=Q}else $++}}}if(!H||null==z){if(!l.Ic().length)throw new Rt(2,3,3018,n?n.M()[0]:null);z=9e4*n.startTime;var J=kn("audio",t.codecs.split(","));if(!J||!t.channelsCount||!t.audioSamplingRate)throw new Rt(2,3,3018,n?n.M()[0]:null);H={sampleRate:t.audioSamplingRate,channelCount:t.channelsCount,Na:J};var ee=EI(J,t.channelsCount);if(!ee)throw new Rt(2,3,3018,n?n.M()[0]:null);for(var te=z+9e4*(n.endTime-n.startTime),ne=z;ne<te;)K.push({data:ee,size:ee.byteLength,duration:1024,eb:0,flags:{hb:0,Xa:0,Wa:0,Ua:0,Va:2,ib:0}}),ne+=1024/H.sampleRate*9e4}var ie=H.sampleRate,re=z/9e4*ie;h={id:t.id,type:"audio",codecs:H.Na,encrypted:t.encrypted&&0<t.drmInfos.length,timescale:ie,duration:i,ab:[],ma:new Uint8Array([]),wa:new Uint8Array([]),Ba:0,Ca:0,data:{sb:this.g,baseMediaDecodeTime:re,Za:K},stream:t};break;case"ac3":for(var ae=[],oe=0,se=new Uint8Array([]),le=null,ue=c(l.Wb()),ce=ue.next();!ce.done;ce=ue.next()){var de=ce.value,fe=de.data;null==le&&null!==de.pts&&(le=de.pts);for(var he=0;he<fe.length;){var pe=SI(fe,he);pe?(t.audioSamplingRate=pe.sampleRate,t.channelsCount=pe.channelCount,oe=pe.sampleRate,se=pe.ma,ae.push({data:fe.subarray(he,he+pe.ba),size:pe.ba,duration:1536,eb:0,flags:{hb:0,Xa:0,Wa:0,Ua:0,Va:2,ib:0}}),he+=pe.ba):he++}}if(0==oe||0==se.byteLength||null==le)throw new Rt(2,3,3018,n?n.M()[0]:null);var ge=le/9e4*oe;h={id:t.id,type:"audio",codecs:"ac-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:oe,duration:i,ab:[],ma:se,wa:new Uint8Array([]),Ba:0,Ca:0,data:{sb:this.g,baseMediaDecodeTime:ge,Za:ae},stream:t};break;case"ec3":for(var me=[],ve=0,ye=new Uint8Array([]),_e=null,be=c(l.Wb()),Ee=be.next();!Ee.done;Ee=be.next()){var Te=Ee.value,Se=Te.data;null==_e&&null!==Te.pts&&(_e=Te.pts);for(var Ae=0;Ae<Se.length;){var Ie=II(Se,Ae);Ie?(t.audioSamplingRate=Ie.sampleRate,t.channelsCount=Ie.channelCount,ve=Ie.sampleRate,ye=Ie.ma,me.push({data:Se.subarray(Ae,Ae+Ie.ba),size:Ie.ba,duration:1536,eb:0,flags:{hb:0,Xa:0,Wa:0,Ua:0,Va:2,ib:0}}),Ae+=Ie.ba):Ae++}}if(0==ve||0==ye.byteLength||null==_e)throw new Rt(2,3,3018,n?n.M()[0]:null);var xe=_e/9e4*ve;h={id:t.id,type:"audio",codecs:"ec-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:ve,duration:i,ab:[],ma:ye,wa:new Uint8Array([]),Ba:0,Ca:0,data:{sb:this.g,baseMediaDecodeTime:xe,Za:me},stream:t};break;case"mp3":for(var Re,Ce=[],De=null,ke=c(l.Wb()),Me=ke.next();!Me.done;Me=ke.next()){var Le=Me.value,Pe=Le.data;if(Pe){null==De&&null!==Le.pts&&(De=Le.pts);for(var Ne=0;Ne<Pe.length;){var Oe=OI(Pe,Ne);Oe?(Re||(Re=Oe),Ne+Oe.ba<=Pe.length&&Ce.push({data:Pe.subarray(Ne,Ne+Oe.ba),size:Oe.ba,duration:1152,eb:0,flags:{hb:0,Xa:0,Wa:0,Ua:0,Va:2,ib:0}}),Ne+=Oe.ba):Ne++}}}if(!Re||null==De)throw new Rt(2,3,3018,n?n.M()[0]:null);var Fe=Re.sampleRate,Ue=De/9e4*Fe;h={id:t.id,type:"audio",codecs:"mp3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:Fe,duration:i,ab:[],ma:new Uint8Array([]),wa:new Uint8Array([]),Ba:0,Ca:0,data:{sb:this.g,baseMediaDecodeTime:Ue,Za:Ce},stream:t};break;case"opus":var Be=[],Ge=null,je=l.F;if(!je)throw new Rt(2,3,3018,n?n.M()[0]:null);var Ve=[];switch(je.Jh){case 1:case 2:Ve=[0];break;case 0:Ve=[255,1,1,0,1];break;case 128:Ve=[255,2,0,0,1];break;case 3:Ve=[1,2,1,0,2,1];break;case 4:Ve=[1,2,2,0,1,2,3];break;case 5:Ve=[1,3,2,0,4,1,2,3];break;case 6:Ve=[1,4,2,0,4,1,2,3,5];break;case 7:Ve=[1,4,2,0,4,1,2,3,5,6];break;case 8:Ve=[1,5,3,0,6,1,2,3,4,5,7];break;case 130:Ve=[1,1,2,0,1];break;case 131:Ve=[1,1,3,0,1,2];break;case 132:Ve=[1,1,4,0,1,2,3];break;case 133:Ve=[1,1,5,0,1,2,3,4];break;case 134:Ve=[1,1,6,0,1,2,3,4,5];break;case 135:Ve=[1,1,7,0,1,2,3,4,5,6];break;case 136:Ve=[1,1,8,0,1,2,3,4,5,6,7]}for(var He=new Uint8Array([0,je.channelCount,0,0,je.sampleRate>>>24&255,je.sampleRate>>>17&255,je.sampleRate>>>8&255,je.sampleRate>>>0&255,0,0].concat(d(Ve))),Ke=je.sampleRate,ze=c(l.Wb()),Ze=ze.next();!Ze.done;Ze=ze.next()){var qe=Ze.value,Ye=qe.data;null==Ge&&null!==qe.pts&&(Ge=qe.pts);for(var We=0;We<Ye.length;){for(var $e=0!==(16&Ye[We+1]),Xe=0!==(8&Ye[We+1]),Qe=We+2,Je=0;255===Ye[Qe];)Je+=255,Qe+=1;Je+=Ye[Qe],Qe+=1,Qe+=$e?2:0,Qe+=Xe?2:0;var et=Ye.slice(Qe,Qe+Je);Be.push({data:et,size:et.byteLength,duration:960,eb:0,flags:{hb:0,Xa:0,Wa:0,Ua:0,Va:2,ib:0}}),We=Qe+Je}}if(0==He.byteLength||null==Ge)throw new Rt(2,3,3018,n?n.M()[0]:null);t.audioSamplingRate=je.sampleRate,t.channelsCount=je.channelCount;var tt=Ge/9e4*Ke;h={id:t.id,type:"audio",codecs:"opus",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:Ke,duration:i,ab:[],ma:He,wa:new Uint8Array([]),Ba:0,Ca:0,data:{sb:this.g,baseMediaDecodeTime:tt,Za:Be},stream:t}}h&&(u.push(h),h=null)}}catch(e){return e&&3023==e.code?Promise.resolve(new Uint8Array([])):Promise.reject(e)}if(!u.length)return Promise.reject(new Rt(2,3,3018,n?n.M()[0]:null));var nt=new Vb(u),it=t.id+"_"+n.i;if(this.i.has(it))var rt=this.i.get(it);else rt=Hb(nt),this.i.set(it,rt);var at=Yb(nt);this.g++;var ot=In(rt,at);return Promise.resolve(ot)},K("shaka.transmuxer.TsTransmuxer",WI),WI.prototype.transmux=WI.prototype.transmux,WI.prototype.getOriginalMimeType=WI.prototype.getOriginalMimeType,WI.prototype.convertCodecs=WI.prototype.convertCodecs,WI.prototype.isSupported=WI.prototype.isSupported,WI.prototype.destroy=WI.prototype.destroy;var $I,XI,QI=["aac","ac-3","ec-3","mp3","opus"],JI=["avc","hevc"];
/*
 @license
 EME Encryption Scheme Polyfill
 Copyright 2019 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
function ex(){}function tx(){$I||navigator.emeEncryptionSchemePolyfilled?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?($I=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=nx,navigator.emeEncryptionSchemePolyfilled=!0):console.debug("EmeEncryptionSchemePolyfill: EME not found")}function nx(e,t){var n,i=this;return O(function(r){return 1==r.g?(console.assert(i==navigator,'bad "this" for requestMediaKeySystemAccess'),T(r,$I.call(i,e,t),2)):(n=r.h,fx(n)?(console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=$I,r.return(n)):(console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.requestMediaKeySystemAccess=ix,r.return(ix.call(i,e,t))))})}function ix(e,t){var n,i,r,a,o,s,l,u,d,f,h,p,g=this;return O(function(m){if(1==m.g){for(console.assert(g==navigator,'bad "this" for requestMediaKeySystemAccess'),n=dx(e),i=[],r=c(t),a=r.next();!a.done;a=r.next())o=a.value,s=rx(o.videoCapabilities,n),l=rx(o.audioCapabilities,n),o.videoCapabilities&&o.videoCapabilities.length&&!s.length||o.audioCapabilities&&o.audioCapabilities.length&&!l.length||(u=Object.assign({},o),u.videoCapabilities=s,u.audioCapabilities=l,i.push(u));if(!i.length)throw d=Error("Unsupported keySystem or supportedConfigurations."),d.name="NotSupportedError",d.code=DOMException.NOT_SUPPORTED_ERR,d;return T(m,$I.call(g,e,i),2)}return f=m.h,p=h=null,i[0]&&(i[0].videoCapabilities&&(h=i[0].videoCapabilities[0].encryptionScheme),i[0].audioCapabilities&&(p=i[0].audioCapabilities[0].encryptionScheme)),m.return(new cx(f,h,p))})}function rx(e,t){return e?e.filter(function(e){return hx(e.encryptionScheme,t)}):e}function ax(){}function ox(){XI||navigator.mediaCapabilitiesEncryptionSchemePolyfilled?console.debug("McEncryptionSchemePolyfill: Already installed."):navigator.mediaCapabilities?(XI=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=sx,navigator.mediaCapabilitiesEncryptionSchemePolyfilled=!0):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}function sx(e){var t,n,i,r=this;return O(function(a){switch(a.g){case 1:return console.assert(r==navigator.mediaCapabilities,'bad "this" for decodingInfo'),T(a,XI.call(r,e),2);case 2:if(t=a.h,!e.keySystemConfiguration)return a.return(t);if((n=t.keySystemAccess)&&fx(n))return console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=XI,a.return(t);if(console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=lx,n){a.u(3);break}return i=t,T(a,ux(e),4);case 4:return i.keySystemAccess=a.h,a.return(t);case 3:return a.return(lx.call(r,e))}})}function lx(e){var t,n,i,r,a,o,s,l,u=this;return O(function(c){switch(c.g){case 1:return console.assert(u==navigator.mediaCapabilities,'bad "this" for decodingInfo'),n=t=null,!e.keySystemConfiguration||(i=e.keySystemConfiguration,r=i.keySystem,n=i.audio&&i.audio.encryptionScheme,t=i.video&&i.video.encryptionScheme,a=dx(r),o={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:e},hx(n,a)&&hx(t,a))?T(c,XI.call(u,e),2):c.return(o);case 2:if(s=c.h,s.keySystemAccess){s.keySystemAccess=new cx(s.keySystemAccess,t,n),c.u(3);break}if(!e.keySystemConfiguration){c.u(3);break}return l=s,T(c,ux(e),5);case 5:l.keySystemAccess=c.h;case 3:return c.return(s)}})}function ux(e){var t,n;return O(function(i){if(1==i.g){var r=e.keySystemConfiguration,a=[],o=[];return r.audio&&a.push({robustness:r.audio.robustness||"",contentType:e.audio.contentType,encryptionScheme:r.audio.encryptionScheme}),r.video&&o.push({robustness:r.video.robustness||"",contentType:e.video.contentType,encryptionScheme:r.video.encryptionScheme}),r={initDataTypes:r.initDataType?[r.initDataType]:[],distinctiveIdentifier:r.distinctiveIdentifier,persistentState:r.persistentState,sessionTypes:r.sessionTypes},a.length&&(r.audioCapabilities=a),o.length&&(r.videoCapabilities=o),t=r,T(i,navigator.requestMediaKeySystemAccess(e.keySystemConfiguration.keySystem,[t]),2)}return n=i.h,i.return(n)})}function cx(e,t,n){this.g=e,this.i=t||null,this.h=n||null,this.keySystem=e.keySystem}function dx(e){return e.startsWith("com.widevine")||e.startsWith("com.microsoft")||e.startsWith("com.chromecast")||e.startsWith("com.adobe")||e.startsWith("org.w3")?"cenc":e.startsWith("com.apple")?"cbcs":(console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",e,"Please contribute!"),null)}function fx(e){e=e.getConfiguration();var t=e.audioCapabilities&&e.audioCapabilities[0];return!(!(e=e.videoCapabilities&&e.videoCapabilities[0]||t)||void 0===e.encryptionScheme)}function hx(e,t){return!e||e==t||!("cbcs"!=e&&"cbcs-1-9"!=e||!vx&&!mx)}function px(){}function gx(){tx(),ox()}rt("video/mp2t",function(){return new WI("video/mp2t")},ut),K("EmeEncryptionSchemePolyfill",ex),ex.install=tx,K("McEncryptionSchemePolyfill",ax),ax.install=ox,cx.prototype.getConfiguration=function(){var e=this.g.getConfiguration();if(e.videoCapabilities)for(var t=c(e.videoCapabilities),n=t.next();!n.done;n=t.next())n.value.encryptionScheme=this.i;if(e.audioCapabilities)for(t=c(e.audioCapabilities),n=t.next();!n.done;n=t.next())n.value.encryptionScheme=this.h;return e},cx.prototype.createMediaKeys=function(){return this.g.createMediaKeys()},K("EncryptionSchemePolyfills",px),px.install=gx;var mx=navigator.userAgent.includes("CrKey"),vx=100<=parseInt(navigator.userAgent.split("Firefox/").pop(),10);"undefined"!==typeof n&&n.exports&&(n.exports=px)}.call(i,n,n,void 0),i.shaka)t[r]=i.shaka[r]})()}).call(this,n("c8ba"))},4573:function(e,t,n){var i=n("cbe5"),r=i.extend({type:"ring",shape:{cx:0,cy:0,r:0,r0:0},buildPath:function(e,t){var n=t.cx,i=t.cy,r=2*Math.PI;e.moveTo(n+t.r,i),e.arc(n,i,t.r,0,r,!1),e.moveTo(n+t.r0,i),e.arc(n,i,t.r0,0,r,!0)}});e.exports=r},4588:function(e,t){var n=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:n)(e)}},"45c1":function(e,t,n){"use strict";(function(e){var i=n("d708"),r=n("01e1");let a;a=r["a"]?self:i["a"]?e:window,t["a"]=a}).call(this,n("c8ba"))},4630:function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},4650:function(e,t,n){var i=n("3eba"),r=n("6d8b");function a(e,t,n){var i,a={},o="toggleSelected"===e;return n.eachComponent("legend",function(n){o&&null!=i?n[i?"select":"unSelect"](t.name):(n[e](t.name),i=n.isSelected(t.name));var s=n.getData();r.each(s,function(e){var t=e.get("name");if("\n"!==t&&""!==t){var i=n.isSelected(t);a.hasOwnProperty(t)?a[t]=a[t]&&i:a[t]=i}})}),{name:t.name,selected:a}}i.registerAction("legendToggleSelect","legendselectchanged",r.curry(a,"toggleSelected")),i.registerAction("legendSelect","legendselected",r.curry(a,"select")),i.registerAction("legendUnSelect","legendunselected",r.curry(a,"unSelect"))},"48a9":function(e,t,n){var i=n("6d8b"),r=n("42e5"),a=function(e,t,n,i,a,o){this.x=null==e?0:e,this.y=null==t?0:t,this.x2=null==n?1:n,this.y2=null==i?0:i,this.type="linear",this.global=o||!1,r.call(this,a)};a.prototype={constructor:a},i.inherits(a,r);var o=a;e.exports=o},"48ac":function(e,t,n){var i=n("3eba"),r=i.extendComponentModel({type:"axisPointer",coordSysAxesInfo:null,defaultOption:{show:"auto",triggerOn:null,zlevel:0,z:50,type:"line",snap:!1,triggerTooltip:!0,value:null,status:null,link:[],animation:null,animationDurationUpdate:200,lineStyle:{color:"#aaa",width:1,type:"solid"},shadowStyle:{color:"rgba(150,150,150,0.3)"},label:{show:!0,formatter:null,precision:"auto",margin:3,color:"#fff",padding:[5,7,5,7],backgroundColor:"auto",borderColor:null,borderWidth:0,shadowBlur:3,shadowColor:"#aaa"},handle:{show:!1,icon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",size:45,margin:50,color:"#333",shadowBlur:3,shadowColor:"#aaa",shadowOffsetX:0,shadowOffsetY:2,throttle:40}}}),a=r;e.exports=a},"48c7":function(e,t,n){var i=n("6d8b"),r=n("6cb7"),a=n("9e47"),o=n("2023"),s=r.extend({type:"cartesian2dAxis",axis:null,init:function(){s.superApply(this,"init",arguments),this.resetRange()},mergeOption:function(){s.superApply(this,"mergeOption",arguments),this.resetRange()},restoreData:function(){s.superApply(this,"restoreData",arguments),this.resetRange()},getCoordSysModel:function(){return this.ecModel.queryComponents({mainType:"grid",index:this.option.gridIndex,id:this.option.gridId})[0]}});function l(e,t){return t.type||(t.data?"category":"value")}i.merge(s.prototype,o);var u={offset:0};a("x",s,l,u),a("y",s,l,u);var c=s;e.exports=c},4917:function(e,t,n){n("214f")("match",1,function(e,t,n){return[function(n){"use strict";var i=e(this),r=void 0==n?void 0:n[t];return void 0!==r?r.call(n,i):new RegExp(n)[t](String(i))},n]})},4942:function(e,t,n){var i=n("2cf4"),r=i.debugMode,a=function(){};1===r?a=function(){for(var e in arguments)throw new Error(arguments[e])}:r>1&&(a=function(){for(var e in arguments)console.log(arguments[e])});var o=a;e.exports=o},"4a3f":function(e,t,n){var i=n("401b"),r=i.create,a=i.distSquare,o=Math.pow,s=Math.sqrt,l=1e-8,u=1e-4,c=s(3),d=1/3,f=r(),h=r(),p=r();function g(e){return e>-l&&e<l}function m(e){return e>l||e<-l}function v(e,t,n,i,r){var a=1-r;return a*a*(a*e+3*r*t)+r*r*(r*i+3*a*n)}function y(e,t,n,i,r){var a=1-r;return 3*(((t-e)*a+2*(n-t)*r)*a+(i-n)*r*r)}function _(e,t,n,i,r,a){var l=i+3*(t-n)-e,u=3*(n-2*t+e),f=3*(t-e),h=e-r,p=u*u-3*l*f,m=u*f-9*l*h,v=f*f-3*u*h,y=0;if(g(p)&&g(m))if(g(u))a[0]=0;else{var _=-f/u;_>=0&&_<=1&&(a[y++]=_)}else{var b=m*m-4*p*v;if(g(b)){var E=m/p,T=(_=-u/l+E,-E/2);_>=0&&_<=1&&(a[y++]=_),T>=0&&T<=1&&(a[y++]=T)}else if(b>0){var S=s(b),w=p*u+1.5*l*(-m+S),A=p*u+1.5*l*(-m-S);w=w<0?-o(-w,d):o(w,d),A=A<0?-o(-A,d):o(A,d);_=(-u-(w+A))/(3*l);_>=0&&_<=1&&(a[y++]=_)}else{var I=(2*p*u-3*l*m)/(2*s(p*p*p)),x=Math.acos(I)/3,R=s(p),C=Math.cos(x),D=(_=(-u-2*R*C)/(3*l),T=(-u+R*(C+c*Math.sin(x)))/(3*l),(-u+R*(C-c*Math.sin(x)))/(3*l));_>=0&&_<=1&&(a[y++]=_),T>=0&&T<=1&&(a[y++]=T),D>=0&&D<=1&&(a[y++]=D)}}return y}function b(e,t,n,i,r){var a=6*n-12*t+6*e,o=9*t+3*i-3*e-9*n,l=3*t-3*e,u=0;if(g(o)){if(m(a)){var c=-l/a;c>=0&&c<=1&&(r[u++]=c)}}else{var d=a*a-4*o*l;if(g(d))r[0]=-a/(2*o);else if(d>0){var f=s(d),h=(c=(-a+f)/(2*o),(-a-f)/(2*o));c>=0&&c<=1&&(r[u++]=c),h>=0&&h<=1&&(r[u++]=h)}}return u}function E(e,t,n,i,r,a){var o=(t-e)*r+e,s=(n-t)*r+t,l=(i-n)*r+n,u=(s-o)*r+o,c=(l-s)*r+s,d=(c-u)*r+u;a[0]=e,a[1]=o,a[2]=u,a[3]=d,a[4]=d,a[5]=c,a[6]=l,a[7]=i}function T(e,t,n,i,r,o,l,c,d,g,m){var y,_,b,E,T,S=.005,w=1/0;f[0]=d,f[1]=g;for(var A=0;A<1;A+=.05)h[0]=v(e,n,r,l,A),h[1]=v(t,i,o,c,A),E=a(f,h),E<w&&(y=A,w=E);w=1/0;for(var I=0;I<32;I++){if(S<u)break;_=y-S,b=y+S,h[0]=v(e,n,r,l,_),h[1]=v(t,i,o,c,_),E=a(h,f),_>=0&&E<w?(y=_,w=E):(p[0]=v(e,n,r,l,b),p[1]=v(t,i,o,c,b),T=a(p,f),b<=1&&T<w?(y=b,w=T):S*=.5)}return m&&(m[0]=v(e,n,r,l,y),m[1]=v(t,i,o,c,y)),s(w)}function S(e,t,n,i){var r=1-i;return r*(r*e+2*i*t)+i*i*n}function w(e,t,n,i){return 2*((1-i)*(t-e)+i*(n-t))}function A(e,t,n,i,r){var a=e-2*t+n,o=2*(t-e),l=e-i,u=0;if(g(a)){if(m(o)){var c=-l/o;c>=0&&c<=1&&(r[u++]=c)}}else{var d=o*o-4*a*l;if(g(d)){c=-o/(2*a);c>=0&&c<=1&&(r[u++]=c)}else if(d>0){var f=s(d),h=(c=(-o+f)/(2*a),(-o-f)/(2*a));c>=0&&c<=1&&(r[u++]=c),h>=0&&h<=1&&(r[u++]=h)}}return u}function I(e,t,n){var i=e+n-2*t;return 0===i?.5:(e-t)/i}function x(e,t,n,i,r){var a=(t-e)*i+e,o=(n-t)*i+t,s=(o-a)*i+a;r[0]=e,r[1]=a,r[2]=s,r[3]=s,r[4]=o,r[5]=n}function R(e,t,n,i,r,o,l,c,d){var g,m=.005,v=1/0;f[0]=l,f[1]=c;for(var y=0;y<1;y+=.05){h[0]=S(e,n,r,y),h[1]=S(t,i,o,y);var _=a(f,h);_<v&&(g=y,v=_)}v=1/0;for(var b=0;b<32;b++){if(m<u)break;var E=g-m,T=g+m;h[0]=S(e,n,r,E),h[1]=S(t,i,o,E);_=a(h,f);if(E>=0&&_<v)g=E,v=_;else{p[0]=S(e,n,r,T),p[1]=S(t,i,o,T);var w=a(p,f);T<=1&&w<v?(g=T,v=w):m*=.5}}return d&&(d[0]=S(e,n,r,g),d[1]=S(t,i,o,g)),s(v)}t.cubicAt=v,t.cubicDerivativeAt=y,t.cubicRootAt=_,t.cubicExtrema=b,t.cubicSubdivide=E,t.cubicProjectPoint=T,t.quadraticAt=S,t.quadraticDerivativeAt=w,t.quadraticRootAt=A,t.quadraticExtremum=I,t.quadraticSubdivide=x,t.quadraticProjectPoint=R},"4a59":function(e,t,n){var i=n("9b43"),r=n("1fa8"),a=n("33a4"),o=n("cb7c"),s=n("9def"),l=n("27ee"),u={},c={};t=e.exports=function(e,t,n,d,f){var h,p,g,m,v=f?function(){return e}:l(e),y=i(n,d,t?2:1),_=0;if("function"!=typeof v)throw TypeError(e+" is not iterable!");if(a(v)){for(h=s(e.length);h>_;_++)if(m=t?y(o(p=e[_])[0],p[1]):y(e[_]),m===u||m===c)return m}else for(g=v.call(e);!(p=g.next()).done;)if(m=r(g,y,p.value,t),m===u||m===c)return m};t.BREAK=u,t.RETURN=c},"4a9d":function(e,t,n){var i=n("2306"),r=n("dcb3"),a=n("ff2e"),o=n("0156"),s=n("6679"),l=r.extend({makeElOption:function(e,t,n,i,r){var s=n.axis,l=s.grid,d=i.get("type"),f=u(l,s).getOtherAxis(s).getGlobalExtent(),h=s.toGlobalCoord(s.dataToCoord(t,!0));if(d&&"none"!==d){var p=a.buildElStyle(i),g=c[d](s,h,f,p);g.style=p,e.graphicKey=g.type,e.pointer=g}var m=o.layout(l.model,n);a.buildCartesianSingleLabelElOption(t,e,m,n,i,r)},getHandleTransform:function(e,t,n){var i=o.layout(t.axis.grid.model,t,{labelInside:!1});return i.labelMargin=n.get("handle.margin"),{position:a.getTransformedPosition(t.axis,e,i),rotation:i.rotation+(i.labelDirection<0?Math.PI:0)}},updateHandleTransform:function(e,t,n,i){var r=n.axis,a=r.grid,o=r.getGlobalExtent(!0),s=u(a,r).getOtherAxis(r).getGlobalExtent(),l="x"===r.dim?0:1,c=e.position;c[l]+=t[l],c[l]=Math.min(o[1],c[l]),c[l]=Math.max(o[0],c[l]);var d=(s[1]+s[0])/2,f=[d,d];f[l]=c[l];var h=[{verticalAlign:"middle"},{align:"center"}];return{position:c,rotation:e.rotation,cursorPoint:f,tooltipOption:h[l]}}});function u(e,t){var n={};return n[t.dim+"AxisIndex"]=t.index,e.getCartesian(n)}var c={line:function(e,t,n,r){var o=a.makeLineShape([t,n[0]],[t,n[1]],d(e));return i.subPixelOptimizeLine({shape:o,style:r}),{type:"Line",shape:o}},shadow:function(e,t,n,i){var r=Math.max(1,e.getBandWidth()),o=n[1]-n[0];return{type:"Rect",shape:a.makeRectShape([t-r/2,n[0]],[r,o],d(e))}}};function d(e){return"x"===e.dim?0:1}s.registerAxisPointerClass("CartesianAxisPointer",l);var f=l;e.exports=f},"4aa2":function(e,t,n){var i=n("cbe5"),r=n("897a"),a=i.extend({type:"sector",shape:{cx:0,cy:0,r0:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},brush:r(i.prototype.brush),buildPath:function(e,t){var n=t.cx,i=t.cy,r=Math.max(t.r0||0,0),a=Math.max(t.r,0),o=t.startAngle,s=t.endAngle,l=t.clockwise,u=Math.cos(o),c=Math.sin(o);e.moveTo(u*r+n,c*r+i),e.lineTo(u*a+n,c*a+i),e.arc(n,i,a,o,s,!l),e.lineTo(Math.cos(s)*r+n,Math.sin(s)*r+i),0!==r&&e.arc(n,i,r,s,o,l),e.closePath()}});e.exports=a},"4b08":function(e,t,n){var i=n("7dcf"),r=i.extend({type:"dataZoom.select"});e.exports=r},"4bf8":function(e,t,n){var i=n("be13");e.exports=function(e){return Object(i(e))}},"4e08":function(e,t,n){(function(e){var n;"undefined"!==typeof window?n=window.__DEV__:"undefined"!==typeof e&&(n=e.__DEV__),"undefined"===typeof n&&(n=!0);var i=n;t.__DEV__=i}).call(this,n("c8ba"))},"4e9f":function(e,t,n){var i=n("22d1"),r=n("29a8"),a=n("2145"),o=r.toolbox.saveAsImage;function s(e){this.model=e}s.defaultOption={show:!0,icon:"M4.7,22.9L29.3,45.5L54.7,23.4M4.6,43.6L4.6,58L53.8,58L53.8,43.6M29.2,45.1L29.2,0",title:o.title,type:"png",name:"",excludeComponents:["toolbox"],pixelRatio:1,lang:o.lang.slice()},s.prototype.unusable=!i.canvasSupported;var l=s.prototype;l.onclick=function(e,t){var n=this.model,r=n.get("name")||e.get("title.0.text")||"echarts",a=document.createElement("a"),o=n.get("type",!0)||"png";a.download=r+"."+o,a.target="_blank";var s=t.getConnectedDataURL({type:o,backgroundColor:n.get("backgroundColor",!0)||e.get("backgroundColor")||"#fff",excludeComponents:n.get("excludeComponents"),pixelRatio:n.get("pixelRatio")});if(a.href=s,"function"!==typeof MouseEvent||i.browser.ie||i.browser.edge)if(window.navigator.msSaveOrOpenBlob){var l=atob(s.split(",")[1]),u=l.length,c=new Uint8Array(u);while(u--)c[u]=l.charCodeAt(u);var d=new Blob([c]);window.navigator.msSaveOrOpenBlob(d,r+"."+o)}else{var f=n.get("lang"),h='<body style="margin:0;"><img src="'+s+'" style="max-width:100%;" title="'+(f&&f[0]||"")+'" /></body>',p=window.open();p.document.write(h)}else{var g=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});a.dispatchEvent(g)}},a.register("saveAsImage",s);var u=s;e.exports=u},"4f85":function(e,t,n){var i=n("4e08"),r=(i.__DEV__,n("6d8b")),a=n("22d1"),o=n("eda2"),s=o.formatTime,l=o.encodeHTML,u=o.addCommas,c=o.getTooltipMarker,d=n("e0d3"),f=n("6cb7"),h=n("e47b"),p=n("38a2"),g=n("f934"),m=g.getLayoutParams,v=g.mergeLayoutParam,y=n("f47d"),_=y.createTask,b=n("0f99"),E=b.prepareSource,T=b.getSource,S=n("2b17"),w=S.retrieveRawValue,A=d.makeInner(),I=f.extend({type:"series.__base__",seriesIndex:0,coordinateSystem:null,defaultOption:null,legendDataProvider:null,visualColorAccessPath:"itemStyle.color",layoutMode:null,init:function(e,t,n,i){this.seriesIndex=this.componentIndex,this.dataTask=_({count:C,reset:D}),this.dataTask.context={model:this},this.mergeDefaultAndTheme(e,n),E(this);var r=this.getInitialData(e,n);M(r,this),this.dataTask.context.data=r,A(this).dataBeforeProcessed=r,x(this)},mergeDefaultAndTheme:function(e,t){var n=this.layoutMode,i=n?m(e):{},a=this.subType;f.hasClass(a)&&(a+="Series"),r.merge(e,t.getTheme().get(this.subType)),r.merge(e,this.getDefaultOption()),d.defaultEmphasis(e,"label",["show"]),this.fillDataTextStyle(e.data),n&&v(e,i,n)},mergeOption:function(e,t){e=r.merge(this.option,e,!0),this.fillDataTextStyle(e.data);var n=this.layoutMode;n&&v(this.option,e,n),E(this);var i=this.getInitialData(e,t);M(i,this),this.dataTask.dirty(),this.dataTask.context.data=i,A(this).dataBeforeProcessed=i,x(this)},fillDataTextStyle:function(e){if(e&&!r.isTypedArray(e))for(var t=["show"],n=0;n<e.length;n++)e[n]&&e[n].label&&d.defaultEmphasis(e[n],"label",t)},getInitialData:function(){},appendData:function(e){var t=this.getRawData();t.appendData(e.data)},getData:function(e){var t=P(this);if(t){var n=t.context.data;return null==e?n:n.getLinkedData(e)}return A(this).data},setData:function(e){var t=P(this);if(t){var n=t.context;n.data!==e&&t.modifyOutputEnd&&t.setOutputEnd(e.count()),n.outputData=e,t!==this.dataTask&&(n.data=e)}A(this).data=e},getSource:function(){return T(this)},getRawData:function(){return A(this).dataBeforeProcessed},getBaseAxis:function(){var e=this.coordinateSystem;return e&&e.getBaseAxis&&e.getBaseAxis()},formatTooltip:function(e,t,n){function i(n){var i=r.reduce(n,function(e,t,n){var i=o.getDimensionInfo(n);return e|(i&&!1!==i.tooltip&&null!=i.displayName)},0),a=[];function d(e,n){var r=o.getDimensionInfo(n);if(r&&!1!==r.otherDims.tooltip){var d=r.type,f=c({color:m,type:"subItem"}),h=(i?f+l(r.displayName||"-")+": ":"")+l("ordinal"===d?e+"":"time"===d?t?"":s("yyyy/MM/dd hh:mm:ss",e):u(e));h&&a.push(h)}}return f.length?r.each(f,function(t){d(w(o,e,t),t)}):r.each(n,d),(i?"<br/>":"")+a.join(i?"<br/>":", ")}function a(e){return l(u(e))}var o=this.getData(),f=o.mapDimension("defaultedTooltip",!0),h=f.length,p=this.getRawValue(e),g=r.isArray(p),m=o.getItemVisual(e,"color");r.isObject(m)&&m.colorStops&&(m=(m.colorStops[0]||{}).color),m=m||"transparent";var v=h>1||g&&!h?i(p):a(h?w(o,e,f[0]):g?p[0]:p),y=c(m),_=o.getName(e),b=this.name;return d.isNameSpecified(this)||(b=""),b=b?l(b)+(t?": ":"<br/>"):"",t?y+b+v:b+y+(_?l(_)+": "+v:v)},isAnimationEnabled:function(){if(a.node)return!1;var e=this.getShallow("animation");return e&&this.getData().count()>this.getShallow("animationThreshold")&&(e=!1),e},restoreData:function(){this.dataTask.dirty()},getColorFromPalette:function(e,t,n){var i=this.ecModel,r=h.getColorFromPalette.call(this,e,t,n);return r||(r=i.getColorFromPalette(e,t,n)),r},coordDimToDataDim:function(e){return this.getRawData().mapDimension(e,!0)},getProgressive:function(){return this.get("progressive")},getProgressiveThreshold:function(){return this.get("progressiveThreshold")},getAxisTooltipData:null,getTooltipPosition:null,pipeTask:null,preventIncremental:null,pipelineContext:null});function x(e){var t=e.name;d.isNameSpecified(e)||(e.name=R(e)||t)}function R(e){var t=e.getRawData(),n=t.mapDimension("seriesName",!0),i=[];return r.each(n,function(e){var n=t.getDimensionInfo(e);n.displayName&&i.push(n.displayName)}),i.join(" ")}function C(e){return e.model.getRawData().count()}function D(e){var t=e.model;return t.setData(t.getRawData().cloneShallow()),k}function k(e,t){e.end>t.outputData.count()&&t.model.getRawData().cloneShallow(t.outputData)}function M(e,t){r.each(e.CHANGABLE_METHODS,function(n){e.wrapMethod(n,r.curry(L,t))})}function L(e){var t=P(e);t&&t.setOutputEnd(this.count())}function P(e){var t=(e.ecModel||{}).scheduler,n=t&&t.getPipeline(e.uid);if(n){var i=n.currentTask;if(i){var r=i.agentStubMap;r&&(i=r.get(e.uid))}return i}}r.mixin(I,p),r.mixin(I,h);var N=I;e.exports=N},"4fac":function(e,t,n){var i=n("620b"),r=n("9c2c");function a(e,t,n){var a=t.points,o=t.smooth;if(a&&a.length>=2){if(o&&"spline"!==o){var s=r(a,o,n,t.smoothConstraint);e.moveTo(a[0][0],a[0][1]);for(var l=a.length,u=0;u<(n?l:l-1);u++){var c=s[2*u],d=s[2*u+1],f=a[(u+1)%l];e.bezierCurveTo(c[0],c[1],d[0],d[1],f[0],f[1])}}else{"spline"===o&&(a=i(a,n)),e.moveTo(a[0][0],a[0][1]);u=1;for(var h=a.length;u<h;u++)e.lineTo(a[u][0],a[u][1])}n&&e.closePath()}}t.buildPath=a},"50e5":function(e,t,n){var i=n("6d8b"),r=n("eda2"),a=["x","y","z","radius","angle","single"],o=["cartesian2d","polar","singleAxis"];function s(e){return i.indexOf(o,e)>=0}function l(e,t){e=e.slice();var n=i.map(e,r.capitalFirst);t=(t||[]).slice();var a=i.map(t,r.capitalFirst);return function(r,o){i.each(e,function(e,i){for(var s={name:e,capital:n[i]},l=0;l<t.length;l++)s[t[l]]=e+a[l];r.call(o,s)})}}var u=l(a,["axisIndex","axis","index","id"]);function c(e,t,n){return function(n){var i,s={nodes:[],records:{}};if(t(function(e){s.records[e.name]={}}),!n)return s;o(n,s);do{i=!1,e(l)}while(i);function l(e){!r(e,s)&&a(e,s)&&(o(e,s),i=!0)}return s};function r(e,t){return i.indexOf(t.nodes,e)>=0}function a(e,r){var a=!1;return t(function(t){i.each(n(e,t)||[],function(e){r.records[t.name][e]&&(a=!0)})}),a}function o(e,r){r.nodes.push(e),t(function(t){i.each(n(e,t)||[],function(e){r.records[t.name][e]=!0})})}}t.isCoordSupported=s,t.createNameEach=l,t.eachAxisDim=u,t.createLinkedNodesFinder=c},5147:function(e,t,n){var i=n("2b4c")("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[i]=!1,!"/./"[e](t)}catch(e){}}return!0}},"52a7":function(e,t){t.f={}.propertyIsEnumerable},"551c":function(e,t,n){"use strict";var i,r,a,o,s=n("2d00"),l=n("7726"),u=n("9b43"),c=n("23c6"),d=n("5ca1"),f=n("d3f4"),h=n("d8e8"),p=n("f605"),g=n("4a59"),m=n("ebd6"),v=n("1991").set,y=n("8079")(),_=n("a5b8"),b=n("9c80"),E=n("a25f"),T=n("bcaa"),S="Promise",w=l.TypeError,A=l.process,I=A&&A.versions,x=I&&I.v8||"",R=l[S],C="process"==c(A),D=function(){},k=r=_.f,M=!!function(){try{var e=R.resolve(1),t=(e.constructor={})[n("2b4c")("species")]=function(e){e(D,D)};return(C||"function"==typeof PromiseRejectionEvent)&&e.then(D)instanceof t&&0!==x.indexOf("6.6")&&-1===E.indexOf("Chrome/66")}catch(e){}}(),L=function(e){var t;return!(!f(e)||"function"!=typeof(t=e.then))&&t},P=function(e,t){if(!e._n){e._n=!0;var n=e._c;y(function(){var i=e._v,r=1==e._s,a=0,o=function(t){var n,a,o,s=r?t.ok:t.fail,l=t.resolve,u=t.reject,c=t.domain;try{s?(r||(2==e._h&&F(e),e._h=1),!0===s?n=i:(c&&c.enter(),n=s(i),c&&(c.exit(),o=!0)),n===t.promise?u(w("Promise-chain cycle")):(a=L(n))?a.call(n,l,u):l(n)):u(i)}catch(e){c&&!o&&c.exit(),u(e)}};while(n.length>a)o(n[a++]);e._c=[],e._n=!1,t&&!e._h&&N(e)})}},N=function(e){v.call(l,function(){var t,n,i,r=e._v,a=O(e);if(a&&(t=b(function(){C?A.emit("unhandledRejection",r,e):(n=l.onunhandledrejection)?n({promise:e,reason:r}):(i=l.console)&&i.error&&i.error("Unhandled promise rejection",r)}),e._h=C||O(e)?2:1),e._a=void 0,a&&t.e)throw t.v})},O=function(e){return 1!==e._h&&0===(e._a||e._c).length},F=function(e){v.call(l,function(){var t;C?A.emit("rejectionHandled",e):(t=l.onrejectionhandled)&&t({promise:e,reason:e._v})})},U=function(e){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=e,t._s=2,t._a||(t._a=t._c.slice()),P(t,!0))},B=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw w("Promise can't be resolved itself");(t=L(e))?y(function(){var i={_w:n,_d:!1};try{t.call(e,u(B,i,1),u(U,i,1))}catch(e){U.call(i,e)}}):(n._v=e,n._s=1,P(n,!1))}catch(e){U.call({_w:n,_d:!1},e)}}};M||(R=function(e){p(this,R,S,"_h"),h(e),i.call(this);try{e(u(B,this,1),u(U,this,1))}catch(e){U.call(this,e)}},i=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},i.prototype=n("dcbc")(R.prototype,{then:function(e,t){var n=k(m(this,R));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=C?A.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&P(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),a=function(){var e=new i;this.promise=e,this.resolve=u(B,e,1),this.reject=u(U,e,1)},_.f=k=function(e){return e===R||e===o?new a(e):r(e)}),d(d.G+d.W+d.F*!M,{Promise:R}),n("7f20")(R,S),n("7a56")(S),o=n("8378")[S],d(d.S+d.F*!M,S,{reject:function(e){var t=k(this),n=t.reject;return n(e),t.promise}}),d(d.S+d.F*(s||!M),S,{resolve:function(e){return T(s&&this===o?R:this,e)}}),d(d.S+d.F*!(M&&n("5cc5")(function(e){R.all(e)["catch"](D)})),S,{all:function(e){var t=this,n=k(t),i=n.resolve,r=n.reject,a=b(function(){var n=[],a=0,o=1;g(e,!1,function(e){var s=a++,l=!1;n.push(void 0),o++,t.resolve(e).then(function(e){l||(l=!0,n[s]=e,--o||i(n))},r)}),--o||i(n)});return a.e&&r(a.v),n.promise},race:function(e){var t=this,n=k(t),i=n.reject,r=b(function(){g(e,!1,function(e){t.resolve(e).then(n.resolve,i)})});return r.e&&i(r.v),n.promise}})},"551f":function(e,t,n){var i=n("282b"),r=i([["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["textPosition"],["textAlign"]]),a={getItemStyle:function(e,t){var n=r(this,e,t),i=this.getBorderLineDash();return i&&(n.lineDash=i),n},getBorderLineDash:function(){var e=this.get("borderType");return"solid"===e||null==e?null:"dashed"===e?[5,5]:[1,1]}};e.exports=a},5537:function(e,t,n){var i=n("8378"),r=n("7726"),a="__core-js_shared__",o=r[a]||(r[a]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:i.version,mode:n("2d00")?"pure":"global",copyright:" 2018 Denis Pushkarev (zloirock.ru)"})},5693:function(e,t){function n(e,t){var n,i,r,a,o,s=t.x,l=t.y,u=t.width,c=t.height,d=t.r;u<0&&(s+=u,u=-u),c<0&&(l+=c,c=-c),"number"===typeof d?n=i=r=a=d:d instanceof Array?1===d.length?n=i=r=a=d[0]:2===d.length?(n=r=d[0],i=a=d[1]):3===d.length?(n=d[0],i=a=d[1],r=d[2]):(n=d[0],i=d[1],r=d[2],a=d[3]):n=i=r=a=0,n+i>u&&(o=n+i,n*=u/o,i*=u/o),r+a>u&&(o=r+a,r*=u/o,a*=u/o),i+r>c&&(o=i+r,i*=c/o,r*=c/o),n+a>c&&(o=n+a,n*=c/o,a*=c/o),e.moveTo(s+n,l),e.lineTo(s+u-i,l),0!==i&&e.arc(s+u-i,l+i,i,-Math.PI/2,0),e.lineTo(s+u,l+c-r),0!==r&&e.arc(s+u-r,l+c-r,r,0,Math.PI/2),e.lineTo(s+a,l+c),0!==a&&e.arc(s+a,l+c-a,a,Math.PI/2,Math.PI),e.lineTo(s,l+n),0!==n&&e.arc(s+n,l+n,n,Math.PI,1.5*Math.PI)}t.buildPath=n},"5aa9":function(e,t,n){var i=n("4e08"),r=(i.__DEV__,n("6d8b")),a=r.isObject,o=r.each,s=r.map,l=r.indexOf,u=(r.retrieve,n("f934")),c=u.getLayoutRect,d=n("697e"),f=d.createScaleByModel,h=d.ifAxisCrossZero,p=d.niceScaleExtent,g=d.estimateLabelUnionRect,m=n("cbe9"),v=n("ec02"),y=n("2039"),_=n("ee1a"),b=_.getStackedDimension;function E(e,t,n){return e.getCoordSysModel()===t}function T(e,t,n){this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this._initCartesian(e,t,n),this.model=e}n("8ed2");var S=T.prototype;function w(e,t,n){n.getAxesOnZeroOf=function(){return i?[i]:[]};var i,r=e[t],a=n.model,o=a.get("axisLine.onZero"),s=a.get("axisLine.onZeroAxisIndex");if(o)if(null==s){for(var l in r)if(r.hasOwnProperty(l)&&A(r[l])){i=r[l];break}}else A(r[s])&&(i=r[s])}function A(e){return e&&"category"!==e.type&&"time"!==e.type&&h(e)}function I(e,t){var n=e.getExtent(),i=n[0]+n[1];e.toGlobalCoord="x"===e.dim?function(e){return e+t}:function(e){return i-e+t},e.toLocalCoord="x"===e.dim?function(e){return e-t}:function(e){return i-e+t}}S.type="grid",S.axisPointerEnabled=!0,S.getRect=function(){return this._rect},S.update=function(e,t){var n=this._axesMap;this._updateScale(e,this.model),o(n.x,function(e){p(e.scale,e.model)}),o(n.y,function(e){p(e.scale,e.model)}),o(n.x,function(e){w(n,"y",e)}),o(n.y,function(e){w(n,"x",e)}),this.resize(this.model,t)},S.resize=function(e,t,n){var i=c(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()});this._rect=i;var r=this._axesList;function a(){o(r,function(e){var t=e.isHorizontal(),n=t?[0,i.width]:[0,i.height],r=e.inverse?1:0;e.setExtent(n[r],n[1-r]),I(e,t?i.x:i.y)})}a(),!n&&e.get("containLabel")&&(o(r,function(e){if(!e.model.get("axisLabel.inside")){var t=g(e);if(t){var n=e.isHorizontal()?"height":"width",r=e.model.get("axisLabel.margin");i[n]-=t[n]+r,"top"===e.position?i.y+=t.height+r:"left"===e.position&&(i.x+=t.width+r)}}}),a())},S.getAxis=function(e,t){var n=this._axesMap[e];if(null!=n){if(null==t)for(var i in n)if(n.hasOwnProperty(i))return n[i];return n[t]}},S.getAxes=function(){return this._axesList.slice()},S.getCartesian=function(e,t){if(null!=e&&null!=t){var n="x"+e+"y"+t;return this._coordsMap[n]}a(e)&&(t=e.yAxisIndex,e=e.xAxisIndex);for(var i=0,r=this._coordsList;i<r.length;i++)if(r[i].getAxis("x").index===e||r[i].getAxis("y").index===t)return r[i]},S.getCartesians=function(){return this._coordsList.slice()},S.convertToPixel=function(e,t,n){var i=this._findConvertTarget(e,t);return i.cartesian?i.cartesian.dataToPoint(n):i.axis?i.axis.toGlobalCoord(i.axis.dataToCoord(n)):null},S.convertFromPixel=function(e,t,n){var i=this._findConvertTarget(e,t);return i.cartesian?i.cartesian.pointToData(n):i.axis?i.axis.coordToData(i.axis.toLocalCoord(n)):null},S._findConvertTarget=function(e,t){var n,i,r=t.seriesModel,a=t.xAxisModel||r&&r.getReferringComponents("xAxis")[0],o=t.yAxisModel||r&&r.getReferringComponents("yAxis")[0],s=t.gridModel,u=this._coordsList;if(r)n=r.coordinateSystem,l(u,n)<0&&(n=null);else if(a&&o)n=this.getCartesian(a.componentIndex,o.componentIndex);else if(a)i=this.getAxis("x",a.componentIndex);else if(o)i=this.getAxis("y",o.componentIndex);else if(s){var c=s.coordinateSystem;c===this&&(n=this._coordsList[0])}return{cartesian:n,axis:i}},S.containPoint=function(e){var t=this._coordsList[0];if(t)return t.containPoint(e)},S._initCartesian=function(e,t,n){var i={left:!1,right:!1,top:!1,bottom:!1},r={x:{},y:{}},a={x:0,y:0};if(t.eachComponent("xAxis",s("x"),this),t.eachComponent("yAxis",s("y"),this),!a.x||!a.y)return this._axesMap={},void(this._axesList=[]);function s(n){return function(o,s){if(E(o,e,t)){var l=o.get("position");"x"===n?"top"!==l&&"bottom"!==l&&(l="bottom",i[l]&&(l="top"===l?"bottom":"top")):"left"!==l&&"right"!==l&&(l="left",i[l]&&(l="left"===l?"right":"left")),i[l]=!0;var u=new v(n,f(o),[0,0],o.get("type"),l),c="category"===u.type;u.onBand=c&&o.get("boundaryGap"),u.inverse=o.get("inverse"),o.axis=u,u.model=o,u.grid=this,u.index=s,this._axesList.push(u),r[n][s]=u,a[n]++}}}this._axesMap=r,o(r.x,function(t,n){o(r.y,function(i,r){var a="x"+n+"y"+r,o=new m(a);o.grid=this,o.model=e,this._coordsMap[a]=o,this._coordsList.push(o),o.addAxis(t),o.addAxis(i)},this)},this)},S._updateScale=function(e,t){function n(e,t,n){o(e.mapDimension(t.dim,!0),function(n){t.scale.unionExtentFromData(e,b(e,n))})}o(this._axesList,function(e){e.scale.setExtent(1/0,-1/0)}),e.eachSeries(function(i){if(C(i)){var r=R(i,e),a=r[0],o=r[1];if(!E(a,t,e)||!E(o,t,e))return;var s=this.getCartesian(a.componentIndex,o.componentIndex),l=i.getData(),u=s.getAxis("x"),c=s.getAxis("y");"list"===l.type&&(n(l,u,i),n(l,c,i))}},this)},S.getTooltipAxes=function(e){var t=[],n=[];return o(this.getCartesians(),function(i){var r=null!=e&&"auto"!==e?i.getAxis(e):i.getBaseAxis(),a=i.getOtherAxis(r);l(t,r)<0&&t.push(r),l(n,a)<0&&n.push(a)}),{baseAxes:t,otherAxes:n}};var x=["xAxis","yAxis"];function R(e,t){return s(x,function(t){var n=e.getReferringComponents(t)[0];return n})}function C(e){return"cartesian2d"===e.get("coordinateSystem")}T.create=function(e,t){var n=[];return e.eachComponent("grid",function(i,r){var a=new T(i,e,t);a.name="grid_"+r,a.resize(i,t,!0),i.coordinateSystem=a,n.push(a)}),e.eachSeries(function(t){if(C(t)){var n=R(t,e),i=n[0],r=n[1],a=i.getCoordSysModel(),o=a.coordinateSystem;t.coordinateSystem=o.getCartesian(i.componentIndex,r.componentIndex)}}),n},T.dimensions=T.prototype.dimensions=m.prototype.dimensions,y.register("cartesian2d",T);var D=T;e.exports=D},"5ca1":function(e,t,n){var i=n("7726"),r=n("8378"),a=n("32e9"),o=n("2aba"),s=n("9b43"),l="prototype",u=function(e,t,n){var c,d,f,h,p=e&u.F,g=e&u.G,m=e&u.S,v=e&u.P,y=e&u.B,_=g?i:m?i[t]||(i[t]={}):(i[t]||{})[l],b=g?r:r[t]||(r[t]={}),E=b[l]||(b[l]={});for(c in g&&(n=t),n)d=!p&&_&&void 0!==_[c],f=(d?_:n)[c],h=y&&d?s(f,i):v&&"function"==typeof f?s(Function.call,f):f,_&&o(_,c,f,e&u.U),b[c]!=f&&a(b,c,h),v&&E[c]!=f&&(E[c]=f)};i.core=r,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},"5cc5":function(e,t,n){var i=n("2b4c")("iterator"),r=!1;try{var a=[7][i]();a["return"]=function(){r=!0},Array.from(a,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!r)return!1;var n=!1;try{var a=[7],o=a[i]();o.next=function(){return{done:n=!0}},a[i]=function(){return o},e(a)}catch(e){}return n}},"5dbc":function(e,t,n){var i=n("d3f4"),r=n("8b97").set;e.exports=function(e,t,n){var a,o=t.constructor;return o!==n&&"function"==typeof o&&(a=o.prototype)!==n.prototype&&i(a)&&r&&r(e,a),e}},"5e68":function(e,t,n){var i=n("6d8b"),r=n("2cf4"),a=r.devicePixelRatio,o=n("2b61"),s=n("dc2f");function l(){return!1}function u(e,t,n){var r=i.createCanvas(),a=t.getWidth(),o=t.getHeight(),s=r.style;return s&&(s.position="absolute",s.left=0,s.top=0,s.width=a+"px",s.height=o+"px",r.setAttribute("data-zr-dom-id",e)),r.width=a*n,r.height=o*n,r}var c=function(e,t,n){var r;n=n||a,"string"===typeof e?r=u(e,t,n):i.isObject(e)&&(r=e,e=r.id),this.id=e,this.dom=r;var o=r.style;o&&(r.onselectstart=l,o["-webkit-user-select"]="none",o["user-select"]="none",o["-webkit-touch-callout"]="none",o["-webkit-tap-highlight-color"]="rgba(0,0,0,0)",o["padding"]=0,o["margin"]=0,o["border-width"]=0),this.domBack=null,this.ctxBack=null,this.painter=t,this.config=null,this.clearColor=0,this.motionBlur=!1,this.lastFrameAlpha=.7,this.dpr=n};c.prototype={constructor:c,__dirty:!0,__used:!1,__drawIndex:0,__startIndex:0,__endIndex:0,incremental:!1,getElementCount:function(){return this.__endIndex-this.__startIndex},initContext:function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},createBackBuffer:function(){var e=this.dpr;this.domBack=u("back-"+this.id,this.painter,e),this.ctxBack=this.domBack.getContext("2d"),1!=e&&this.ctxBack.scale(e,e)},resize:function(e,t){var n=this.dpr,i=this.dom,r=i.style,a=this.domBack;r&&(r.width=e+"px",r.height=t+"px"),i.width=e*n,i.height=t*n,a&&(a.width=e*n,a.height=t*n,1!=n&&this.ctxBack.scale(n,n))},clear:function(e,t){var n,i=this.dom,r=this.ctx,a=i.width,l=i.height,u=(t=t||this.clearColor,this.motionBlur&&!e),c=this.lastFrameAlpha,d=this.dpr;(u&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(i,0,0,a/d,l/d)),r.clearRect(0,0,a,l),t&&"transparent"!==t)&&(t.colorStops?(n=t.__canvasGradient||o.getGradient(r,t,{x:0,y:0,width:a,height:l}),t.__canvasGradient=n):t.image&&(n=s.prototype.getCanvasPattern.call(t,r)),r.save(),r.fillStyle=n||t,r.fillRect(0,0,a,l),r.restore());if(u){var f=this.domBack;r.save(),r.globalAlpha=c,r.drawImage(f,0,0,a,l),r.restore()}}};var d=c;e.exports=d},"5e76":function(e,t,n){var i=n("d51b"),r=new i(50);function a(e){if("string"===typeof e){var t=r.get(e);return t&&t.image}return e}function o(e,t,n,i,a){if(e){if("string"===typeof e){if(t&&t.__zrImageSrc===e||!n)return t;var o=r.get(e),u={hostEl:n,cb:i,cbPayload:a};return o?(t=o.image,!l(t)&&o.pending.push(u)):(!t&&(t=new Image),t.onload=s,r.put(e,t.__cachedImgObj={image:t,pending:[u]}),t.src=t.__zrImageSrc=e),t}return e}return t}function s(){var e=this.__cachedImgObj;this.onload=this.__cachedImgObj=null;for(var t=0;t<e.pending.length;t++){var n=e.pending[t],i=n.cb;i&&i(this,n.cbPayload),n.hostEl.dirty()}e.pending.length=0}function l(e){return e&&e.width&&e.height}t.findExistImage=a,t.createOrUpdateImage=o,t.isImageReady=l},"5e97":function(e,t,n){var i=n("4e08"),r=(i.__DEV__,n("3eba")),a=n("6d8b"),o=n("a15a"),s=o.createSymbol,l=n("2306"),u=n("7919"),c=u.makeBackground,d=n("f934"),f=a.curry,h=a.each,p=l.Group,g=r.extendComponentView({type:"legend.plain",newlineDisabled:!1,init:function(){this.group.add(this._contentGroup=new p),this._backgroundEl},getContentGroup:function(){return this._contentGroup},render:function(e,t,n){if(this.resetInner(),e.get("show",!0)){var i=e.get("align");i&&"auto"!==i||(i="right"===e.get("left")&&"vertical"===e.get("orient")?"right":"left"),this.renderInner(i,e,t,n);var r=e.getBoxLayoutParams(),o={width:n.getWidth(),height:n.getHeight()},s=e.get("padding"),l=d.getLayoutRect(r,o,s),u=this.layoutInner(e,i,l),f=d.getLayoutRect(a.defaults({width:u.width,height:u.height},r),o,s);this.group.attr("position",[f.x-u.x,f.y-u.y]),this.group.add(this._backgroundEl=c(u,e))}},resetInner:function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl)},renderInner:function(e,t,n,i){var r=this.getContentGroup(),o=a.createHashMap(),s=t.get("selectedMode"),l=[];n.eachRawSeries(function(e){!e.get("legendHoverLink")&&l.push(e.id)}),h(t.getData(),function(a,u){var c=a.get("name");if(this.newlineDisabled||""!==c&&"\n"!==c){var d=n.getSeriesByName(c)[0];if(!o.get(c))if(d){var h=d.getData(),g=h.getVisual("color");"function"===typeof g&&(g=g(d.getDataParams(0)));var _=h.getVisual("legendSymbol")||"roundRect",b=h.getVisual("symbol"),E=this._createItem(c,u,a,t,_,b,e,g,s);E.on("click",f(m,c,i)).on("mouseover",f(v,d,null,i,l)).on("mouseout",f(y,d,null,i,l)),o.set(c,!0)}else n.eachRawSeries(function(n){if(!o.get(c)&&n.legendDataProvider){var r=n.legendDataProvider(),d=r.indexOfName(c);if(d<0)return;var h=r.getItemVisual(d,"color"),p="roundRect",g=this._createItem(c,u,a,t,p,null,e,h,s);g.on("click",f(m,c,i)).on("mouseover",f(v,n,c,i,l)).on("mouseout",f(y,n,c,i,l)),o.set(c,!0)}},this)}else r.add(new p({newline:!0}))},this)},_createItem:function(e,t,n,i,r,o,u,c,d){var f=i.get("itemWidth"),h=i.get("itemHeight"),g=i.get("inactiveColor"),m=i.get("symbolKeepAspect"),v=i.isSelected(e),y=new p,_=n.getModel("textStyle"),b=n.get("icon"),E=n.getModel("tooltip"),T=E.parentModel;if(r=b||r,y.add(s(r,0,0,f,h,v?c:g,null==m||m)),!b&&o&&(o!==r||"none"==o)){var S=.8*h;"none"===o&&(o="circle"),y.add(s(o,(f-S)/2,(h-S)/2,S,S,v?c:g,null==m||m))}var w="left"===u?f+5:-5,A=u,I=i.get("formatter"),x=e;"string"===typeof I&&I?x=I.replace("{name}",null!=e?e:""):"function"===typeof I&&(x=I(e)),y.add(new l.Text({style:l.setTextStyle({},_,{text:x,x:w,y:h/2,textFill:v?_.getTextColor():g,textAlign:A,textVerticalAlign:"middle"})}));var R=new l.Rect({shape:y.getBoundingRect(),invisible:!0,tooltip:E.get("show")?a.extend({content:e,formatter:T.get("formatter",!0)||function(){return e},formatterParams:{componentType:"legend",legendIndex:i.componentIndex,name:e,$vars:["name"]}},E.option):null});return y.add(R),y.eachChild(function(e){e.silent=!0}),R.silent=!d,this.getContentGroup().add(y),l.setHoverStyle(y),y.__legendDataIndex=t,y},layoutInner:function(e,t,n){var i=this.getContentGroup();d.box(e.get("orient"),i,e.get("itemGap"),n.width,n.height);var r=i.getBoundingRect();return i.attr("position",[-r.x,-r.y]),this.group.getBoundingRect()}});function m(e,t){t.dispatchAction({type:"legendToggleSelect",name:e})}function v(e,t,n,i){var r=n.getZr().storage.getDisplayList()[0];r&&r.useHoverLayer||n.dispatchAction({type:"highlight",seriesName:e.name,name:t,excludeSeriesId:i})}function y(e,t,n,i){var r=n.getZr().storage.getDisplayList()[0];r&&r.useHoverLayer||n.dispatchAction({type:"downplay",seriesName:e.name,name:t,excludeSeriesId:i})}e.exports=g},"607d":function(e,t,n){var i=n("1fab");t.Dispatcher=i;var r=n("22d1"),a="undefined"!==typeof window&&!!window.addEventListener,o=/^(?:mouse|pointer|contextmenu|drag|drop)|click/;function s(e){return e.getBoundingClientRect?e.getBoundingClientRect():{left:0,top:0}}function l(e,t,n,i){return n=n||{},i||!r.canvasSupported?u(e,t,n):r.browser.firefox&&null!=t.layerX&&t.layerX!==t.offsetX?(n.zrX=t.layerX,n.zrY=t.layerY):null!=t.offsetX?(n.zrX=t.offsetX,n.zrY=t.offsetY):u(e,t,n),n}function u(e,t,n){var i=s(e);n.zrX=t.clientX-i.left,n.zrY=t.clientY-i.top}function c(e,t,n){if(t=t||window.event,null!=t.zrX)return t;var i=t.type,r=i&&i.indexOf("touch")>=0;if(r){var a="touchend"!=i?t.targetTouches[0]:t.changedTouches[0];a&&l(e,a,t,n)}else l(e,t,t,n),t.zrDelta=t.wheelDelta?t.wheelDelta/120:-(t.detail||0)/3;var s=t.button;return null==t.which&&void 0!==s&&o.test(t.type)&&(t.which=1&s?1:2&s?3:4&s?2:0),t}function d(e,t,n){a?e.addEventListener(t,n):e.attachEvent("on"+t,n)}function f(e,t,n){a?e.removeEventListener(t,n):e.detachEvent("on"+t,n)}var h=a?function(e){e.preventDefault(),e.stopPropagation(),e.cancelBubble=!0}:function(e){e.returnValue=!1,e.cancelBubble=!0};function p(e){return e.which>1}t.clientToLocal=l,t.normalizeEvent=c,t.addEventListener=d,t.removeEventListener=f,t.stop=h,t.notLeftMouse=p},"613b":function(e,t,n){var i=n("5537")("keys"),r=n("ca5a");e.exports=function(e){return i[e]||(i[e]=r(e))}},6179:function(e,t,n){var i=n("4e08"),r=(i.__DEV__,n("6d8b")),a=n("4319"),o=n("80f0"),s=n("ec6f"),l=n("2b17"),u=l.defaultDimValueGetters,c=l.DefaultDataProvider,d=n("2f45"),f=d.summarizeDimensions,h=r.isObject,p="undefined",g="e\0\0",m={float:typeof Float64Array===p?Array:Float64Array,int:typeof Int32Array===p?Array:Int32Array,ordinal:Array,number:Array,time:Array},v=typeof Uint32Array===p?Array:Uint32Array,y=typeof Uint16Array===p?Array:Uint16Array;function _(e){return e._rawCount>65535?v:y}function b(e){var t=e.constructor;return t===Array?e.slice():new t(e)}var E=["hasItemOption","_nameList","_idList","_invertedIndicesMap","_rawData","_chunkSize","_chunkCount","_dimValueGetter","_count","_rawCount","_nameDimIdx","_idDimIdx"],T=["_extent","_approximateExtent","_rawExtent"];function S(e,t){r.each(E.concat(t.__wrappedMethods||[]),function(n){t.hasOwnProperty(n)&&(e[n]=t[n])}),e.__wrappedMethods=t.__wrappedMethods,r.each(T,function(n){e[n]=r.clone(t[n])}),e._calculationInfo=r.extend(t._calculationInfo)}var w=function(e,t){e=e||["x","y"];for(var n={},i=[],a={},o=0;o<e.length;o++){var s=e[o];r.isString(s)&&(s={name:s});var l=s.name;s.type=s.type||"float",s.coordDim||(s.coordDim=l,s.coordDimIndex=0),s.otherDims=s.otherDims||{},i.push(l),n[l]=s,s.index=o,s.createInvertedIndices&&(a[l]=[])}this.dimensions=i,this._dimensionInfos=n,this.hostModel=t,this.dataType,this._indices=null,this._count=0,this._rawCount=0,this._storage={},this._nameList=[],this._idList=[],this._optionModels=[],this._visual={},this._layout={},this._itemVisuals=[],this.hasItemVisual={},this._itemLayouts=[],this._graphicEls=[],this._chunkSize=1e5,this._chunkCount=0,this._rawData,this._rawExtent={},this._extent={},this._approximateExtent={},this._dimensionsSummary=f(this),this._invertedIndicesMap=a,this._calculationInfo={}},A=w.prototype;function I(e){var t=e._invertedIndicesMap;r.each(t,function(n,i){var r=e._dimensionInfos[i],a=r.ordinalMeta;if(a){n=t[i]=new v(a.categories.length);for(var o=0;o<n.length;o++)n[o]=NaN;for(o=0;o<e._count;o++)n[e.get(i,o)]=o}})}function x(e,t,n){var i;if(null!=t){var r=e._chunkSize,a=Math.floor(n/r),o=n%r,s=e.dimensions[t],l=e._storage[s][a];if(l){i=l[o];var u=e._dimensionInfos[s].ordinalMeta;u&&u.categories.length&&(i=u.categories[i])}}return i}function R(e){return e}function C(e){return e<this._count&&e>=0?this._indices[e]:-1}function D(e,t){var n=e._idList[t];return null==n&&(n=x(e,e._idDimIdx,t)),null==n&&(n=g+t),n}function k(e){return r.isArray(e)||(e=[e]),e}function M(e,t){var n=e.dimensions,i=new w(r.map(n,e.getDimensionInfo,e),e.hostModel);S(i,e);for(var a=i._storage={},o=e._storage,s=0;s<n.length;s++){var l=n[s];o[l]&&(r.indexOf(t,l)>=0?(a[l]=L(o[l]),i._rawExtent[l]=P(),i._extent[l]=null):a[l]=o[l])}return i}function L(e){for(var t=new Array(e.length),n=0;n<e.length;n++)t[n]=b(e[n]);return t}function P(){return[1/0,-1/0]}A.type="list",A.hasItemOption=!0,A.getDimension=function(e){return isNaN(e)||(e=this.dimensions[e]||e),e},A.getDimensionInfo=function(e){return this._dimensionInfos[this.getDimension(e)]},A.getDimensionsOnCoord=function(){return this._dimensionsSummary.dataDimsOnCoord.slice()},A.mapDimension=function(e,t){var n=this._dimensionsSummary;if(null==t)return n.encodeFirstDimNotExtra[e];var i=n.encode[e];return!0===t?(i||[]).slice():i&&i[t]},A.initData=function(e,t,n){var i=s.isInstance(e)||r.isArrayLike(e);i&&(e=new c(e,this.dimensions.length)),this._rawData=e,this._storage={},this._indices=null,this._nameList=t||[],this._idList=[],this._nameRepeatCount={},n||(this.hasItemOption=!1),this.defaultDimValueGetter=u[this._rawData.getSource().sourceFormat],this._dimValueGetter=n=n||this.defaultDimValueGetter,this._rawExtent={},this._initDataFromProvider(0,e.count()),e.pure&&(this.hasItemOption=!1)},A.getProvider=function(){return this._rawData},A.appendData=function(e){var t=this._rawData,n=this.count();t.appendData(e);var i=t.count();t.persistent||(i+=n),this._initDataFromProvider(n,i)},A._initDataFromProvider=function(e,t){if(!(e>=t)){for(var n,i=this._chunkSize,r=this._rawData,a=this._storage,o=this.dimensions,s=o.length,l=this._dimensionInfos,u=this._nameList,c=this._idList,d=this._rawExtent,f=this._nameRepeatCount={},h=this._chunkCount,p=h-1,g=0;g<s;g++){var v=o[g];d[v]||(d[v]=P());var y=l[v];0===y.otherDims.itemName&&(n=this._nameDimIdx=g),0===y.otherDims.itemId&&(this._idDimIdx=g);var _=m[y.type];a[v]||(a[v]=[]);var b=a[v][p];if(b&&b.length<i){for(var E=new _(Math.min(t-p*i,i)),T=0;T<b.length;T++)E[T]=b[T];a[v][p]=E}for(var S=h*i;S<t;S+=i)a[v].push(new _(Math.min(t-S,i)));this._chunkCount=a[v].length}for(var w=new Array(s),A=e;A<t;A++){w=r.getItem(A,w);var x=Math.floor(A/i),R=A%i;for(S=0;S<s;S++){v=o[S];var C=a[v][x],D=this._dimValueGetter(w,v,A,S);C[R]=D;var k=d[v];D<k[0]&&(k[0]=D),D>k[1]&&(k[1]=D)}if(!r.pure){var M=u[A];if(w&&null==M)if(null!=w.name)u[A]=M=w.name;else if(null!=n){var L=o[n],N=a[L][x];if(N){M=N[R];var O=l[L].ordinalMeta;O&&O.categories.length&&(M=O.categories[M])}}var F=null==w?null:w.id;null==F&&null!=M&&(f[M]=f[M]||0,F=M,f[M]>0&&(F+="__ec__"+f[M]),f[M]++),null!=F&&(c[A]=F)}}!r.persistent&&r.clean&&r.clean(),this._rawCount=this._count=t,this._extent={},I(this)}},A.count=function(){return this._count},A.getIndices=function(){var e=this._indices;if(e){var t=e.constructor,n=this._count;if(t===Array){r=new t(n);for(var i=0;i<n;i++)r[i]=e[i]}else r=new t(e.buffer,0,n)}else{t=_(this);var r=new t(this.count());for(i=0;i<r.length;i++)r[i]=i}return r},A.get=function(e,t){if(!(t>=0&&t<this._count))return NaN;var n=this._storage;if(!n[e])return NaN;t=this.getRawIndex(t);var i=Math.floor(t/this._chunkSize),r=t%this._chunkSize,a=n[e][i],o=a[r];return o},A.getByRawIndex=function(e,t){if(!(t>=0&&t<this._rawCount))return NaN;var n=this._storage[e];if(!n)return NaN;var i=Math.floor(t/this._chunkSize),r=t%this._chunkSize,a=n[i];return a[r]},A._getFast=function(e,t){var n=Math.floor(t/this._chunkSize),i=t%this._chunkSize,r=this._storage[e][n];return r[i]},A.getValues=function(e,t){var n=[];r.isArray(e)||(t=e,e=this.dimensions);for(var i=0,a=e.length;i<a;i++)n.push(this.get(e[i],t));return n},A.hasValue=function(e){for(var t=this._dimensionsSummary.dataDimsOnCoord,n=this._dimensionInfos,i=0,r=t.length;i<r;i++)if("ordinal"!==n[t[i]].type&&isNaN(this.get(t[i],e)))return!1;return!0},A.getDataExtent=function(e){e=this.getDimension(e);var t=this._storage[e],n=P();if(!t)return n;var i,r=this.count(),a=!this._indices;if(a)return this._rawExtent[e].slice();if(i=this._extent[e],i)return i.slice();i=n;for(var o=i[0],s=i[1],l=0;l<r;l++){var u=this._getFast(e,this.getRawIndex(l));u<o&&(o=u),u>s&&(s=u)}return i=[o,s],this._extent[e]=i,i},A.getApproximateExtent=function(e){return e=this.getDimension(e),this._approximateExtent[e]||this.getDataExtent(e)},A.setApproximateExtent=function(e,t){t=this.getDimension(t),this._approximateExtent[t]=e.slice()},A.getCalculationInfo=function(e){return this._calculationInfo[e]},A.setCalculationInfo=function(e,t){h(e)?r.extend(this._calculationInfo,e):this._calculationInfo[e]=t},A.getSum=function(e){var t=this._storage[e],n=0;if(t)for(var i=0,r=this.count();i<r;i++){var a=this.get(e,i);isNaN(a)||(n+=a)}return n},A.getMedian=function(e){var t=[];this.each(e,function(e,n){isNaN(e)||t.push(e)});var n=[].concat(t).sort(function(e,t){return e-t}),i=this.count();return 0===i?0:i%2===1?n[(i-1)/2]:(n[i/2]+n[i/2-1])/2},A.rawIndexOf=function(e,t){var n=e&&this._invertedIndicesMap[e],i=n[t];return null==i||isNaN(i)?-1:i},A.indexOfName=function(e){for(var t=0,n=this.count();t<n;t++)if(this.getName(t)===e)return t;return-1},A.indexOfRawIndex=function(e){if(!this._indices)return e;if(e>=this._rawCount||e<0)return-1;var t=this._indices,n=t[e];if(null!=n&&n<this._count&&n===e)return e;var i=0,r=this._count-1;while(i<=r){var a=(i+r)/2|0;if(t[a]<e)i=a+1;else{if(!(t[a]>e))return a;r=a-1}}return-1},A.indicesOfNearest=function(e,t,n){var i=this._storage,r=i[e],a=[];if(!r)return a;null==n&&(n=1/0);for(var o=Number.MAX_VALUE,s=-1,l=0,u=this.count();l<u;l++){var c=t-this.get(e,l),d=Math.abs(c);c<=n&&d<=o&&((d<o||c>=0&&s<0)&&(o=d,s=c,a.length=0),a.push(l))}return a},A.getRawIndex=R,A.getRawDataItem=function(e){if(this._rawData.persistent)return this._rawData.getItem(this.getRawIndex(e));for(var t=[],n=0;n<this.dimensions.length;n++){var i=this.dimensions[n];t.push(this.get(i,e))}return t},A.getName=function(e){var t=this.getRawIndex(e);return this._nameList[t]||x(this,this._nameDimIdx,t)||""},A.getId=function(e){return D(this,this.getRawIndex(e))},A.each=function(e,t,n,i){"use strict";if(this._count){"function"===typeof e&&(i=n,n=t,t=e,e=[]),n=n||i||this,e=r.map(k(e),this.getDimension,this);for(var a=e.length,o=0;o<this.count();o++)switch(a){case 0:t.call(n,o);break;case 1:t.call(n,this.get(e[0],o),o);break;case 2:t.call(n,this.get(e[0],o),this.get(e[1],o),o);break;default:for(var s=0,l=[];s<a;s++)l[s]=this.get(e[s],o);l[s]=o,t.apply(n,l)}}},A.filterSelf=function(e,t,n,i){"use strict";if(this._count){"function"===typeof e&&(i=n,n=t,t=e,e=[]),n=n||i||this,e=r.map(k(e),this.getDimension,this);for(var a=this.count(),o=_(this),s=new o(a),l=[],u=e.length,c=0,d=e[0],f=0;f<a;f++){var h,p=this.getRawIndex(f);if(0===u)h=t.call(n,f);else if(1===u){var g=this._getFast(d,p);h=t.call(n,g,f)}else{for(var m=0;m<u;m++)l[m]=this._getFast(d,p);l[m]=f,h=t.apply(n,l)}h&&(s[c++]=p)}return c<a&&(this._indices=s),this._count=c,this._extent={},this.getRawIndex=this._indices?C:R,this}},A.selectRange=function(e){"use strict";if(this._count){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);var i=t.length;if(i){var r=this.count(),a=_(this),o=new a(r),s=0,l=t[0],u=e[l][0],c=e[l][1],d=!1;if(!this._indices){var f=0;if(1===i){for(var h=this._storage[t[0]],p=0;p<this._chunkCount;p++)for(var g=h[p],m=Math.min(this._count-p*this._chunkSize,this._chunkSize),v=0;v<m;v++){var y=g[v];(y>=u&&y<=c||isNaN(y))&&(o[s++]=f),f++}d=!0}else if(2===i){h=this._storage[l];var b=this._storage[t[1]],E=e[t[1]][0],T=e[t[1]][1];for(p=0;p<this._chunkCount;p++){g=h[p];var S=b[p];for(m=Math.min(this._count-p*this._chunkSize,this._chunkSize),v=0;v<m;v++){y=g[v];var w=S[v];(y>=u&&y<=c||isNaN(y))&&(w>=E&&w<=T||isNaN(w))&&(o[s++]=f),f++}}d=!0}}if(!d)if(1===i)for(v=0;v<r;v++){var A=this.getRawIndex(v);y=this._getFast(l,A);(y>=u&&y<=c||isNaN(y))&&(o[s++]=A)}else for(v=0;v<r;v++){var I=!0;for(A=this.getRawIndex(v),p=0;p<i;p++){var x=t[p];y=this._getFast(n,A);(y<e[x][0]||y>e[x][1])&&(I=!1)}I&&(o[s++]=this.getRawIndex(v))}return s<r&&(this._indices=o),this._count=s,this._extent={},this.getRawIndex=this._indices?C:R,this}}},A.mapArray=function(e,t,n,i){"use strict";"function"===typeof e&&(i=n,n=t,t=e,e=[]),n=n||i||this;var r=[];return this.each(e,function(){r.push(t&&t.apply(this,arguments))},n),r},A.map=function(e,t,n,i){"use strict";n=n||i||this,e=r.map(k(e),this.getDimension,this);var a=M(this,e);a._indices=this._indices,a.getRawIndex=a._indices?C:R;for(var o=a._storage,s=[],l=this._chunkSize,u=e.length,c=this.count(),d=[],f=a._rawExtent,h=0;h<c;h++){for(var p=0;p<u;p++)d[p]=this.get(e[p],h);d[u]=h;var g=t&&t.apply(n,d);if(null!=g){"object"!==typeof g&&(s[0]=g,g=s);for(var m=this.getRawIndex(h),v=Math.floor(m/l),y=m%l,_=0;_<g.length;_++){var b=e[_],E=g[_],T=f[b],S=o[b];S&&(S[v][y]=E),E<T[0]&&(T[0]=E),E>T[1]&&(T[1]=E)}}}return a},A.downSample=function(e,t,n,i){for(var r=M(this,[e]),a=r._storage,o=[],s=Math.floor(1/t),l=a[e],u=this.count(),c=this._chunkSize,d=r._rawExtent[e],f=new(_(this))(u),h=0,p=0;p<u;p+=s){s>u-p&&(s=u-p,o.length=s);for(var g=0;g<s;g++){var m=this.getRawIndex(p+g),v=Math.floor(m/c),y=m%c;o[g]=l[v][y]}var b=n(o),E=this.getRawIndex(Math.min(p+i(o,b)||0,u-1)),T=Math.floor(E/c),S=E%c;l[T][S]=b,b<d[0]&&(d[0]=b),b>d[1]&&(d[1]=b),f[h++]=E}return r._count=h,r._indices=f,r.getRawIndex=C,r},A.getItemModel=function(e){var t=this.hostModel;return new a(this.getRawDataItem(e),t,t&&t.ecModel)},A.diff=function(e){var t=this;return new o(e?e.getIndices():[],this.getIndices(),function(t){return D(e,t)},function(e){return D(t,e)})},A.getVisual=function(e){var t=this._visual;return t&&t[e]},A.setVisual=function(e,t){if(h(e))for(var n in e)e.hasOwnProperty(n)&&this.setVisual(n,e[n]);else this._visual=this._visual||{},this._visual[e]=t},A.setLayout=function(e,t){if(h(e))for(var n in e)e.hasOwnProperty(n)&&this.setLayout(n,e[n]);else this._layout[e]=t},A.getLayout=function(e){return this._layout[e]},A.getItemLayout=function(e){return this._itemLayouts[e]},A.setItemLayout=function(e,t,n){this._itemLayouts[e]=n?r.extend(this._itemLayouts[e]||{},t):t},A.clearItemLayouts=function(){this._itemLayouts.length=0},A.getItemVisual=function(e,t,n){var i=this._itemVisuals[e],r=i&&i[t];return null!=r||n?r:this.getVisual(t)},A.setItemVisual=function(e,t,n){var i=this._itemVisuals[e]||{},r=this.hasItemVisual;if(this._itemVisuals[e]=i,h(t))for(var a in t)t.hasOwnProperty(a)&&(i[a]=t[a],r[a]=!0);else i[t]=n,r[t]=!0},A.clearAllVisual=function(){this._visual={},this._itemVisuals=[],this.hasItemVisual={}};var N=function(e){e.seriesIndex=this.seriesIndex,e.dataIndex=this.dataIndex,e.dataType=this.dataType};A.setItemGraphicEl=function(e,t){var n=this.hostModel;t&&(t.dataIndex=e,t.dataType=this.dataType,t.seriesIndex=n&&n.seriesIndex,"group"===t.type&&t.traverse(N,t)),this._graphicEls[e]=t},A.getItemGraphicEl=function(e){return this._graphicEls[e]},A.eachItemGraphicEl=function(e,t){r.each(this._graphicEls,function(n,i){n&&e&&e.call(t,n,i)})},A.cloneShallow=function(e){if(!e){var t=r.map(this.dimensions,this.getDimensionInfo,this);e=new w(t,this.hostModel)}if(e._storage=this._storage,S(e,this),this._indices){var n=this._indices.constructor;e._indices=new n(this._indices)}else e._indices=null;return e.getRawIndex=e._indices?C:R,e},A.wrapMethod=function(e,t){var n=this[e];"function"===typeof n&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(e),this[e]=function(){var e=n.apply(this,arguments);return t.apply(this,[e].concat(r.slice(arguments)))})},A.TRANSFERABLE_METHODS=["cloneShallow","downSample","map"],A.CHANGABLE_METHODS=["filterSelf","selectRange"];var O=w;e.exports=O},"620b":function(e,t,n){var i=n("401b"),r=i.distance;function a(e,t,n,i,r,a,o){var s=.5*(n-e),l=.5*(i-t);return(2*(t-n)+s+l)*o+(-3*(t-n)-2*s-l)*a+s*r+t}function o(e,t){for(var n=e.length,i=[],o=0,s=1;s<n;s++)o+=r(e[s-1],e[s]);var l=o/2;l=l<n?n:l;for(s=0;s<l;s++){var u,c,d,f=s/(l-1)*(t?n:n-1),h=Math.floor(f),p=f-h,g=e[h%n];t?(u=e[(h-1+n)%n],c=e[(h+1)%n],d=e[(h+2)%n]):(u=e[0===h?h:h-1],c=e[h>n-2?n-1:h+1],d=e[h>n-3?n-1:h+2]);var m=p*p,v=p*m;i.push([a(u[0],g[0],c[0],d[0],p,m,v),a(u[1],g[1],c[1],d[1],p,m,v)])}return i}e.exports=o},"625e":function(e,t,n){var i=n("4e08"),r=(i.__DEV__,n("6d8b")),a=".",o="___EC__COMPONENT__CONTAINER___";function s(e){var t={main:"",sub:""};return e&&(e=e.split(a),t.main=e[0]||"",t.sub=e[1]||""),t}function l(e){r.assert(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(e),'componentType "'+e+'" illegal')}function u(e,t){e.$constructor=e,e.extend=function(e){var t=this,n=function(){e.$constructor?e.$constructor.apply(this,arguments):t.apply(this,arguments)};return r.extend(n.prototype,e),n.extend=this.extend,n.superCall=f,n.superApply=h,r.inherits(n,this),n.superClass=t,n}}var c=0;function d(e){var t=["__\0is_clz",c++,Math.random().toFixed(3)].join("_");e.prototype[t]=!0,e.isInstance=function(e){return!(!e||!e[t])}}function f(e,t){var n=r.slice(arguments,2);return this.superClass.prototype[t].apply(e,n)}function h(e,t,n){return this.superClass.prototype[t].apply(e,n)}function p(e,t){t=t||{};var n={};function i(e){var t=n[e.main];return t&&t[o]||(t=n[e.main]={},t[o]=!0),t}if(e.registerClass=function(e,t){if(t)if(l(t),t=s(t),t.sub){if(t.sub!==o){var r=i(t);r[t.sub]=e}}else n[t.main]=e;return e},e.getClass=function(e,t,i){var r=n[e];if(r&&r[o]&&(r=t?r[t]:null),i&&!r)throw new Error(t?"Component "+e+"."+(t||"")+" not exists. Load it first.":e+".type should be specified.");return r},e.getClassesByMainType=function(e){e=s(e);var t=[],i=n[e.main];return i&&i[o]?r.each(i,function(e,n){n!==o&&t.push(e)}):t.push(i),t},e.hasClass=function(e){return e=s(e),!!n[e.main]},e.getAllClassMainTypes=function(){var e=[];return r.each(n,function(t,n){e.push(n)}),e},e.hasSubTypes=function(e){e=s(e);var t=n[e.main];return t&&t[o]},e.parseClassType=s,t.registerWhenExtend){var a=e.extend;a&&(e.extend=function(t){var n=a.call(this,t);return e.registerClass(n,t.type)})}return e}function g(e,t){}t.parseClassType=s,t.enableClassExtend=u,t.enableClassCheck=d,t.enableClassManagement=p,t.setReadOnly=g},"626a":function(e,t,n){var i=n("2d95");e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==i(e)?e.split(""):Object(e)}},6679:function(e,t,n){var i=n("4e08"),r=(i.__DEV__,n("3eba")),a=n("cd33"),o=r.extendComponentView({type:"axis",_axisPointer:null,axisPointerClass:null,render:function(e,t,n,i){this.axisPointerClass&&a.fixValue(e),o.superApply(this,"render",arguments),s(this,e,t,n,i,!0)},updateAxisPointer:function(e,t,n,i,r){s(this,e,t,n,i,!1)},remove:function(e,t){var n=this._axisPointer;n&&n.remove(t),o.superApply(this,"remove",arguments)},dispose:function(e,t){l(this,t),o.superApply(this,"dispose",arguments)}});function s(e,t,n,i,r,s){var u=o.getAxisPointerClass(e.axisPointerClass);if(u){var c=a.getAxisPointerModel(t);c?(e._axisPointer||(e._axisPointer=new u)).render(t,c,i,s):l(e,i)}}function l(e,t,n){var i=e._axisPointer;i&&i.dispose(t,n),e._axisPointer=null}var u=[];o.registerAxisPointerClass=function(e,t){u[e]=t},o.getAxisPointerClass=function(e){return e&&u[e]};var c=o;e.exports=c},"67cc":function(e,t,n){var i=n("4e08"),r=(i.__DEV__,n("3eba")),a=n("6d8b"),o=n("2306"),s=n("e7aa"),l=s.setLabel,u=n("4319"),c=n("b5c7"),d=n("cbe5"),f=["itemStyle","barBorderWidth"];a.extend(u.prototype,c);var h=r.extendChartView({type:"bar",render:function(e,t,n){this._updateDrawMode(e);var i=e.get("coordinateSystem");return"cartesian2d"!==i&&"polar"!==i||(this._isLargeDraw?this._renderLarge(e,t,n):this._renderNormal(e,t,n)),this.group},incrementalPrepareRender:function(e,t,n){this._clear(),this._updateDrawMode(e)},incrementalRender:function(e,t,n,i){this._incrementalRenderLarge(e,t)},_updateDrawMode:function(e){var t=e.pipelineContext.large;(null==this._isLargeDraw||t^this._isLargeDraw)&&(this._isLargeDraw=t,this._clear())},_renderNormal:function(e,t,n){var i,r=this.group,a=e.getData(),s=this._data,l=e.coordinateSystem,u=l.getBaseAxis();"cartesian2d"===l.type?i=u.isHorizontal():"polar"===l.type&&(i="angle"===u.dim);var c=e.isAnimationEnabled()?e:null;a.diff(s).add(function(t){if(a.hasValue(t)){var n=a.getItemModel(t),o=v[l.type](a,t,n),s=p[l.type](a,t,n,o,i,c);a.setItemGraphicEl(t,s),r.add(s),y(s,a,t,n,o,e,i,"polar"===l.type)}}).update(function(t,n){var u=s.getItemGraphicEl(n);if(a.hasValue(t)){var d=a.getItemModel(t),f=v[l.type](a,t,d);u?o.updateProps(u,{shape:f},c,t):u=p[l.type](a,t,d,f,i,c,!0),a.setItemGraphicEl(t,u),r.add(u),y(u,a,t,d,f,e,i,"polar"===l.type)}else r.remove(u)}).remove(function(e){var t=s.getItemGraphicEl(e);"cartesian2d"===l.type?t&&g(e,c,t):t&&m(e,c,t)}).execute(),this._data=a},_renderLarge:function(e,t,n){this._clear(),E(e,this.group)},_incrementalRenderLarge:function(e,t){E(t,this.group,!0)},dispose:a.noop,remove:function(e){this._clear(e)},_clear:function(e){var t=this.group,n=this._data;e&&e.get("animation")&&n&&!this._isLargeDraw?n.eachItemGraphicEl(function(t){"sector"===t.type?m(t.dataIndex,e,t):g(t.dataIndex,e,t)}):t.removeAll(),this._data=null}}),p={cartesian2d:function(e,t,n,i,r,s,l){var u=new o.Rect({shape:a.extend({},i)});if(s){var c=u.shape,d=r?"height":"width",f={};c[d]=0,f[d]=i[d],o[l?"updateProps":"initProps"](u,{shape:f},s,t)}return u},polar:function(e,t,n,i,r,s,l){var u=i.startAngle<i.endAngle,c=new o.Sector({shape:a.defaults({clockwise:u},i)});if(s){var d=c.shape,f=r?"r":"endAngle",h={};d[f]=r?0:i.startAngle,h[f]=i[f],o[l?"updateProps":"initProps"](c,{shape:h},s,t)}return c}};function g(e,t,n){n.style.text=null,o.updateProps(n,{shape:{width:0}},t,e,function(){n.parent&&n.parent.remove(n)})}function m(e,t,n){n.style.text=null,o.updateProps(n,{shape:{r:n.shape.r0}},t,e,function(){n.parent&&n.parent.remove(n)})}var v={cartesian2d:function(e,t,n){var i=e.getItemLayout(t),r=_(n,i),a=i.width>0?1:-1,o=i.height>0?1:-1;return{x:i.x+a*r/2,y:i.y+o*r/2,width:i.width-a*r,height:i.height-o*r}},polar:function(e,t,n){var i=e.getItemLayout(t);return{cx:i.cx,cy:i.cy,r0:i.r0,r:i.r,startAngle:i.startAngle,endAngle:i.endAngle}}};function y(e,t,n,i,r,s,u,c){var d=t.getItemVisual(n,"color"),f=t.getItemVisual(n,"opacity"),h=i.getModel("itemStyle"),p=i.getModel("emphasis.itemStyle").getBarItemStyle();c||e.setShape("r",h.get("barBorderRadius")||0),e.useStyle(a.defaults({fill:d,opacity:f},h.getBarItemStyle()));var g=i.getShallow("cursor");g&&e.attr("cursor",g);var m=u?r.height>0?"bottom":"top":r.width>0?"left":"right";c||l(e.style,p,i,d,s,n,m),o.setHoverStyle(e,p)}function _(e,t){var n=e.get(f)||0;return Math.min(n,Math.abs(t.width),Math.abs(t.height))}var b=d.extend({type:"largeBar",shape:{points:[]},buildPath:function(e,t){for(var n=t.points,i=this.__startPoint,r=this.__valueIdx,a=0;a<n.length;a+=2)i[this.__valueIdx]=n[a+r],e.moveTo(i[0],i[1]),e.lineTo(n[a],n[a+1])}});function E(e,t,n){var i=e.getData(),r=[],a=i.getLayout("valueAxisHorizontal")?1:0;r[1-a]=i.getLayout("valueAxisStart");var o=new b({shape:{points:i.getLayout("largePoints")},incremental:!!n,__startPoint:r,__valueIdx:a});t.add(o),T(o,e,i)}function T(e,t,n){var i=n.getVisual("borderColor")||n.getVisual("color"),r=t.getModel("itemStyle").getItemStyle(["color","borderColor"]);e.useStyle(r),e.style.fill=null,e.style.stroke=i,e.style.lineWidth=n.getLayout("barWidth")}e.exports=h},6821:function(e,t,n){var i=n("626a"),r=n("be13");e.exports=function(e){return i(r(e))}},"68ab":function(e,t,n){var i=n("4a3f"),r=i.quadraticProjectPoint;function a(e,t,n,i,a,o,s,l,u){if(0===s)return!1;var c=s;if(u>t+c&&u>i+c&&u>o+c||u<t-c&&u<i-c&&u<o-c||l>e+c&&l>n+c&&l>a+c||l<e-c&&l<n-c&&l<a-c)return!1;var d=r(e,t,n,i,a,o,l,u,null);return d<=c/2}t.containStroke=a},6932:function(e,t,n){var i=n("6cb7");i.registerSubTypeDefaulter("dataZoom",function(){return"slider"})},"697e":function(e,t,n){var i=n("4e08"),r=(i.__DEV__,n("6d8b")),a=n("18c0"),o=n("89e3"),s=n("e0d8"),l=n("3842"),u=n("9d57"),c=u.prepareLayoutBarSeries,d=u.makeColumnLayout,f=u.retrieveColumnLayout,h=n("9850");function p(e,t){var n,i,a,o=e.type,s=t.getMin(),u=t.getMax(),f=null!=s,h=null!=u,p=e.getExtent();"ordinal"===o?n=t.getCategories().length:(i=t.get("boundaryGap"),r.isArray(i)||(i=[i||0,i||0]),"boolean"===typeof i[0]&&(i=[0,0]),i[0]=l.parsePercent(i[0],1),i[1]=l.parsePercent(i[1],1),a=p[1]-p[0]||Math.abs(p[0])),null==s&&(s="ordinal"===o?n?0:NaN:p[0]-i[0]*a),null==u&&(u="ordinal"===o?n?n-1:NaN:p[1]+i[1]*a),"dataMin"===s?s=p[0]:"function"===typeof s&&(s=s({min:p[0],max:p[1]})),"dataMax"===u?u=p[1]:"function"===typeof u&&(u=u({min:p[0],max:p[1]})),(null==s||!isFinite(s))&&(s=NaN),(null==u||!isFinite(u))&&(u=NaN),e.setBlank(r.eqNaN(s)||r.eqNaN(u)||"ordinal"===o&&!e.getOrdinalMeta().categories.length),t.getNeedCrossZero()&&(s>0&&u>0&&!f&&(s=0),s<0&&u<0&&!h&&(u=0));var m=t.ecModel;if(m&&"time"===o){var v,y=c("bar",m);if(r.each(y,function(e){v|=e.getBaseAxis()===t.axis}),v){var _=d(y),b=g(s,u,t,_);s=b.min,u=b.max}}return[s,u]}function g(e,t,n,i){var a=n.axis.getExtent(),o=a[1]-a[0],s=f(i,n.axis);if(void 0===s)return{min:e,max:t};var l=1/0;r.each(s,function(e){l=Math.min(e.offset,l)});var u=-1/0;r.each(s,function(e){u=Math.max(e.offset+e.width,u)}),l=Math.abs(l),u=Math.abs(u);var c=l+u,d=t-e,h=1-(l+u)/o,p=d/h-d;return t+=p*(u/c),e-=p*(l/c),{min:e,max:t}}function m(e,t){var n=p(e,t),i=null!=t.getMin(),r=null!=t.getMax(),a=t.get("splitNumber");"log"===e.type&&(e.base=t.get("logBase"));var o=e.type;e.setExtent(n[0],n[1]),e.niceExtent({splitNumber:a,fixMin:i,fixMax:r,minInterval:"interval"===o||"time"===o?t.get("minInterval"):null,maxInterval:"interval"===o||"time"===o?t.get("maxInterval"):null});var s=t.get("interval");null!=s&&e.setInterval&&e.setInterval(s)}function v(e,t){if(t=t||e.get("type"),t)switch(t){case"category":return new a(e.getOrdinalMeta?e.getOrdinalMeta():e.getCategories(),[1/0,-1/0]);case"value":return new o;default:return(s.getClass(t)||o).create(e)}}function y(e){var t=e.scale.getExtent(),n=t[0],i=t[1];return!(n>0&&i>0||n<0&&i<0)}function _(e){var t=e.getLabelModel().get("formatter"),n="category"===e.type?e.scale.getExtent()[0]:null;return"string"===typeof t?(t=function(e){return function(t){return e.replace("{value}",null!=t?t:"")}}(t),t):"function"===typeof t?function(i,r){return null!=n&&(r=i-n),t(b(e,i),r)}:function(t){return e.scale.getLabel(t)}}function b(e,t){return"category"===e.type?e.scale.getLabel(t):t}function E(e){var t=e.model,n=e.scale;if(t.get("axisLabel.show")&&!n.isBlank()){var i,r,a="category"===e.type,o=n.getExtent();a?r=n.count():(i=n.getTicks(),r=i.length);var s,l=e.getLabelModel(),u=_(e),c=1;r>40&&(c=Math.ceil(r/40));for(var d=0;d<r;d+=c){var f=i?i[d]:o[0]+d,h=u(f),p=l.getTextRect(h),g=T(p,l.get("rotate")||0);s?s.union(g):s=g}return s}}function T(e,t){var n=t*Math.PI/180,i=e.plain(),r=i.width,a=i.height,o=r*Math.cos(n)+a*Math.sin(n),s=r*Math.sin(n)+a*Math.cos(n),l=new h(i.x,i.y,o,s);return l}n("216a"),n("8c2a"),t.getScaleExtent=p,t.niceScaleExtent=m,t.createScaleByModel=v,t.ifAxisCrossZero=y,t.makeLabelFormatter=_,t.getAxisRawValue=b,t.estimateLabelUnionRect=E},"697e7":function(e,t,n){var i=n("de00"),r=n("22d1"),a=n("6d8b"),o=n("d2cf"),s=n("afa0"),l=n("ed21"),u=n("30a3"),c=n("cdaa"),d=!r.canvasSupported,f={canvas:l},h={},p="4.0.4";function g(e,t){var n=new b(i(),e,t);return h[n.id]=n,n}function m(e){if(e)e.dispose();else{for(var t in h)h.hasOwnProperty(t)&&h[t].dispose();h={}}return this}function v(e){return h[e]}function y(e,t){f[e]=t}function _(e){delete h[e]}var b=function(e,t,n){n=n||{},this.dom=t,this.id=e;var i=this,l=new s,h=n.renderer;if(d){if(!f.vml)throw new Error("You need to require 'zrender/vml/vml' to support IE8");h="vml"}else h&&f[h]||(h="canvas");var p=new f[h](t,l,n,e);this.storage=l,this.painter=p;var g=r.node||r.worker?null:new c(p.getViewportRoot());this.handler=new o(l,p,g,p.root),this.animation=new u({stage:{update:a.bind(this.flush,this)}}),this.animation.start(),this._needsRefresh;var m=l.delFromStorage,v=l.addToStorage;l.delFromStorage=function(e){m.call(l,e),e&&e.removeSelfFromZr(i)},l.addToStorage=function(e){v.call(l,e),e.addSelfToZr(i)}};b.prototype={constructor:b,getId:function(){return this.id},add:function(e){this.storage.addRoot(e),this._needsRefresh=!0},remove:function(e){this.storage.delRoot(e),this._needsRefresh=!0},configLayer:function(e,t){this.painter.configLayer&&this.painter.configLayer(e,t),this._needsRefresh=!0},setBackgroundColor:function(e){this.painter.setBackgroundColor&&this.painter.setBackgroundColor(e),this._needsRefresh=!0},refreshImmediately:function(){this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1},refresh:function(){this._needsRefresh=!0},flush:function(){var e;this._needsRefresh&&(e=!0,this.refreshImmediately()),this._needsRefreshHover&&(e=!0,this.refreshHoverImmediately()),e&&this.trigger("rendered")},addHover:function(e,t){this.painter.addHover&&(this.painter.addHover(e,t),this.refreshHover())},removeHover:function(e){this.painter.removeHover&&(this.painter.removeHover(e),this.refreshHover())},clearHover:function(){this.painter.clearHover&&(this.painter.clearHover(),this.refreshHover())},refreshHover:function(){this._needsRefreshHover=!0},refreshHoverImmediately:function(){this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.refreshHover()},resize:function(e){e=e||{},this.painter.resize(e.width,e.height),this.handler.resize()},clearAnimation:function(){this.animation.clear()},getWidth:function(){return this.painter.getWidth()},getHeight:function(){return this.painter.getHeight()},pathToImage:function(e,t){return this.painter.pathToImage(e,t)},setCursorStyle:function(e){this.handler.setCursorStyle(e)},findHover:function(e,t){return this.handler.findHover(e,t)},on:function(e,t,n){this.handler.on(e,t,n)},off:function(e,t){this.handler.off(e,t)},trigger:function(e,t){this.handler.trigger(e,t)},clear:function(){this.storage.delRoot(),this.painter.clear()},dispose:function(){this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,_(this.id)}},t.version=p,t.init=g,t.dispose=m,t.getInstance=v,t.registerPainter=y},"69a8":function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},"69ff":function(e,t,n){var i=n("6d8b"),r=i.each,a=i.map,o=(i.isArray,i.isFunction),s=i.createHashMap,l=i.noop,u=n("f47d"),c=u.createTask,d=n("8918"),f=d.getUID,h=n("7e63"),p=n("843e"),g=n("e0d3"),m=g.normalizeToArray;function v(e,t,n,i){this.ecInstance=e,this.api=t,this.unfinished;n=this._dataProcessorHandlers=n.slice(),i=this._visualHandlers=i.slice();this._allHandlers=n.concat(i),this._stageTaskMap=s()}var y=v.prototype;function _(e,t,n,i,a){var o;function s(e,t){return e.setDirty&&(!e.dirtyMap||e.dirtyMap.get(t.__pipeline.id))}a=a||{},r(t,function(t,r){if(!a.visualType||a.visualType===t.visualType){var l=e._stageTaskMap.get(t.uid),u=l.seriesTaskMap,c=l.overallTask;if(c){var d,f=c.agentStubMap;f.each(function(e){s(a,e)&&(e.dirty(),d=!0)}),d&&c.dirty(),b(c,i);var h=e.getPerformArgs(c,a.block);f.each(function(e){e.perform(h)}),o|=c.perform(h)}else u&&u.each(function(r,l){s(a,r)&&r.dirty();var u=e.getPerformArgs(r,a.block);u.skip=!t.performRawSeries&&n.isSeriesFiltered(r.context.model),b(r,i),o|=r.perform(u)})}}),e.unfinished|=o}y.restoreData=function(e,t){e.restoreData(t),this._stageTaskMap.each(function(e){var t=e.overallTask;t&&t.dirty()})},y.getPerformArgs=function(e,t){if(e.__pipeline){var n=this._pipelineMap.get(e.__pipeline.id),i=n.context,r=!t&&n.progressiveEnabled&&(!i||i.progressiveRender)&&e.__idxInPipeline>n.blockIndex,a=r?n.step:null,o=i&&i.modDataCount,s=null!=o?Math.ceil(o/a):null;return{step:a,modBy:s,modDataCount:o}}},y.getPipeline=function(e){return this._pipelineMap.get(e)},y.updateStreamModes=function(e,t){var n=this._pipelineMap.get(e.uid),i=e.getData(),r=i.count(),a=n.progressiveEnabled&&t.incrementalPrepareRender&&r>=n.threshold,o=e.get("large")&&r>=e.get("largeThreshold"),s="mod"===e.get("progressiveChunkMode")?r:null;e.pipelineContext=n.context={progressiveRender:a,modDataCount:s,large:o}},y.restorePipelines=function(e){var t=this,n=t._pipelineMap=s();e.eachSeries(function(e){var i=e.getProgressive(),r=e.uid;n.set(r,{id:r,head:null,tail:null,threshold:e.getProgressiveThreshold(),progressiveEnabled:i&&!(e.preventIncremental&&e.preventIncremental()),blockIndex:-1,step:Math.round(i||700),count:0}),M(t,e,e.dataTask)})},y.prepareStageTasks=function(){var e=this._stageTaskMap,t=this.ecInstance.getModel(),n=this.api;r(this._allHandlers,function(i){var r=e.get(i.uid)||e.set(i.uid,[]);i.reset&&E(this,i,r,t,n),i.overallReset&&T(this,i,r,t,n)},this)},y.prepareView=function(e,t,n,i){var r=e.renderTask,a=r.context;a.model=t,a.ecModel=n,a.api=i,r.__block=!e.incrementalPrepareRender,M(this,t,r)},y.performDataProcessorTasks=function(e,t){_(this,this._dataProcessorHandlers,e,t,{block:!0})},y.performVisualTasks=function(e,t,n){_(this,this._visualHandlers,e,t,n)},y.performSeriesTasks=function(e){var t;e.eachSeries(function(e){t|=e.dataTask.perform()}),this.unfinished|=t},y.plan=function(){this._pipelineMap.each(function(e){var t=e.tail;do{if(t.__block){e.blockIndex=t.__idxInPipeline;break}t=t.getUpstream()}while(t)})};var b=y.updatePayload=function(e,t){"remain"!==t&&(e.context.payload=t)};function E(e,t,n,i,r){var a=n.seriesTaskMap||(n.seriesTaskMap=s()),o=t.seriesType,l=t.getTargetSeries;function u(n){var o=n.uid,s=a.get(o)||a.set(o,c({plan:x,reset:R,count:k}));s.context={model:n,ecModel:i,api:r,useClearVisual:t.isVisual&&!t.isLayout,plan:t.plan,reset:t.reset,scheduler:e},M(e,n,s)}t.createOnAllSeries?i.eachRawSeries(u):o?i.eachRawSeriesByType(o,u):l&&l(i,r).each(u);var d=e._pipelineMap;a.each(function(e,t){d.get(t)||(e.dispose(),a.removeKey(t))})}function T(e,t,n,i,a){var o=n.overallTask=n.overallTask||c({reset:S});o.context={ecModel:i,api:a,overallReset:t.overallReset,scheduler:e};var l=o.agentStubMap=o.agentStubMap||s(),u=t.seriesType,d=t.getTargetSeries,f=!0,h=t.modifyOutputEnd;function p(t){var n=t.uid,i=l.get(n);i||(i=l.set(n,c({reset:w,onDirty:I})),o.dirty()),i.context={model:t,overallProgress:f,modifyOutputEnd:h},i.agent=o,i.__block=f,M(e,t,i)}u?i.eachRawSeriesByType(u,p):d?d(i,a).each(p):(f=!1,r(i.getSeries(),p));var g=e._pipelineMap;l.each(function(e,t){g.get(t)||(e.dispose(),o.dirty(),l.removeKey(t))})}function S(e){e.overallReset(e.ecModel,e.api,e.payload)}function w(e,t){return e.overallProgress&&A}function A(){this.agent.dirty(),this.getDownstream().dirty()}function I(){this.agent&&this.agent.dirty()}function x(e){return e.plan&&e.plan(e.model,e.ecModel,e.api,e.payload)}function R(e){e.useClearVisual&&e.data.clearAllVisual();var t=e.resetDefines=m(e.reset(e.model,e.ecModel,e.api,e.payload));return t.length>1?a(t,function(e,t){return D(t)}):C}var C=D(0);function D(e){return function(t,n){var i=n.data,r=n.resetDefines[e];if(r&&r.dataEach)for(var a=t.start;a<t.end;a++)r.dataEach(i,a);else r&&r.progress&&r.progress(t,i)}}function k(e){return e.data.count()}function M(e,t,n){var i=t.uid,r=e._pipelineMap.get(i);!r.head&&(r.head=n),r.tail&&r.tail.pipe(n),r.tail=n,n.__idxInPipeline=r.count++,n.__pipeline=r}function L(e){P=null;try{e(N,O)}catch(e){}return P}v.wrapStageHandler=function(e,t){return o(e)&&(e={overallReset:e,seriesType:L(e)}),e.uid=f("stageHandler"),t&&(e.visualType=t),e};var P,N={},O={};function F(e,t){for(var n in t.prototype)e[n]=l}F(N,h),F(O,p),N.eachSeriesByType=N.eachRawSeriesByType=function(e){P=e},N.eachComponent=function(e){"series"===e.mainType&&e.subType&&(P=e.subType)};var U=v;e.exports=U},"6a99":function(e,t,n){var i=n("d3f4");e.exports=function(e,t){if(!i(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!i(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},"6b54":function(e,t,n){"use strict";n("3846");var i=n("cb7c"),r=n("0bfb"),a=n("9e1e"),o="toString",s=/./[o],l=function(e){n("2aba")(RegExp.prototype,o,e,!0)};n("79e5")(function(){return"/a/b"!=s.call({source:"a",flags:"b"})})?l(function(){var e=i(this);return"/".concat(e.source,"/","flags"in e?e.flags:!a&&e instanceof RegExp?r.call(e):void 0)}):s.name!=o&&l(function(){return s.call(this)})},"6cb7":function(e,t,n){var i=n("6d8b"),r=n("4319"),a=n("8918"),o=n("625e"),s=o.enableClassManagement,l=o.parseClassType,u=n("e0d3"),c=u.makeInner,d=n("f934"),f=n("de1c"),h=c(),p=r.extend({type:"component",id:"",name:"",mainType:"",subType:"",componentIndex:0,defaultOption:null,ecModel:null,dependentModels:[],uid:null,layoutMode:null,$constructor:function(e,t,n,i){r.call(this,e,t,n,i),this.uid=a.getUID("ec_cpt_model")},init:function(e,t,n,i){this.mergeDefaultAndTheme(e,n)},mergeDefaultAndTheme:function(e,t){var n=this.layoutMode,r=n?d.getLayoutParams(e):{},a=t.getTheme();i.merge(e,a.get(this.mainType)),i.merge(e,this.getDefaultOption()),n&&d.mergeLayoutParam(e,r,n)},mergeOption:function(e,t){i.merge(this.option,e,!0);var n=this.layoutMode;n&&d.mergeLayoutParam(this.option,e,n)},optionUpdated:function(e,t){},getDefaultOption:function(){var e=h(this);if(!e.defaultOption){var t=[],n=this.constructor;while(n){var r=n.prototype.defaultOption;r&&t.push(r),n=n.superClass}for(var a={},o=t.length-1;o>=0;o--)a=i.merge(a,t[o],!0);e.defaultOption=a}return e.defaultOption},getReferringComponents:function(e){return this.ecModel.queryComponents({mainType:e,index:this.get(e+"Index",!0),id:this.get(e+"Id",!0)})}});function g(e){var t=[];return i.each(p.getClassesByMainType(e),function(e){t=t.concat(e.prototype.dependencies||[])}),t=i.map(t,function(e){return l(e).main}),"dataset"!==e&&i.indexOf(t,"dataset")<=0&&t.unshift("dataset"),t}s(p,{registerWhenExtend:!0}),a.enableSubTypeDefaulter(p),a.enableTopologicalTravel(p,g),i.mixin(p,f);var m=p;e.exports=m},"6d8b":function(e,t){var n={"[object Function]":1,"[object RegExp]":1,"[object Date]":1,"[object Error]":1,"[object CanvasGradient]":1,"[object CanvasPattern]":1,"[object Image]":1,"[object Canvas]":1},i={"[object Int8Array]":1,"[object Uint8Array]":1,"[object Uint8ClampedArray]":1,"[object Int16Array]":1,"[object Uint16Array]":1,"[object Int32Array]":1,"[object Uint32Array]":1,"[object Float32Array]":1,"[object Float64Array]":1},r=Object.prototype.toString,a=Array.prototype,o=a.forEach,s=a.filter,l=a.slice,u=a.map,c=a.reduce,d={};function f(e,t){"createCanvas"===e&&(y=null),d[e]=t}function h(e){if(null==e||"object"!=typeof e)return e;var t=e,a=r.call(e);if("[object Array]"===a){if(!W(e)){t=[];for(var o=0,s=e.length;o<s;o++)t[o]=h(e[o])}}else if(i[a]){if(!W(e)){var l=e.constructor;if(e.constructor.from)t=l.from(e);else{t=new l(e.length);for(o=0,s=e.length;o<s;o++)t[o]=h(e[o])}}}else if(!n[a]&&!W(e)&&!U(e))for(var u in t={},e)e.hasOwnProperty(u)&&(t[u]=h(e[u]));return t}function p(e,t,n){if(!N(t)||!N(e))return n?h(t):e;for(var i in t)if(t.hasOwnProperty(i)){var r=e[i],a=t[i];!N(a)||!N(r)||M(a)||M(r)||U(a)||U(r)||O(a)||O(r)||W(a)||W(r)?!n&&i in e||(e[i]=h(t[i],!0)):p(r,a,n)}return e}function g(e,t){for(var n=e[0],i=1,r=e.length;i<r;i++)n=p(n,e[i],t);return n}function m(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function v(e,t,n){for(var i in t)t.hasOwnProperty(i)&&(n?null!=t[i]:null==e[i])&&(e[i]=t[i]);return e}var y,_=function(){return d.createCanvas()};function b(){return y||(y=_().getContext("2d")),y}function E(e,t){if(e){if(e.indexOf)return e.indexOf(t);for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n}return-1}function T(e,t){var n=e.prototype;function i(){}for(var r in i.prototype=t.prototype,e.prototype=new i,n)e.prototype[r]=n[r];e.prototype.constructor=e,e.superClass=t}function S(e,t,n){e="prototype"in e?e.prototype:e,t="prototype"in t?t.prototype:t,v(e,t,n)}function w(e){if(e)return"string"!=typeof e&&"number"==typeof e.length}function A(e,t,n){if(e&&t)if(e.forEach&&e.forEach===o)e.forEach(t,n);else if(e.length===+e.length)for(var i=0,r=e.length;i<r;i++)t.call(n,e[i],i,e);else for(var a in e)e.hasOwnProperty(a)&&t.call(n,e[a],a,e)}function I(e,t,n){if(e&&t){if(e.map&&e.map===u)return e.map(t,n);for(var i=[],r=0,a=e.length;r<a;r++)i.push(t.call(n,e[r],r,e));return i}}function x(e,t,n,i){if(e&&t){if(e.reduce&&e.reduce===c)return e.reduce(t,n,i);for(var r=0,a=e.length;r<a;r++)n=t.call(i,n,e[r],r,e);return n}}function R(e,t,n){if(e&&t){if(e.filter&&e.filter===s)return e.filter(t,n);for(var i=[],r=0,a=e.length;r<a;r++)t.call(n,e[r],r,e)&&i.push(e[r]);return i}}function C(e,t,n){if(e&&t)for(var i=0,r=e.length;i<r;i++)if(t.call(n,e[i],i,e))return e[i]}function D(e,t){var n=l.call(arguments,2);return function(){return e.apply(t,n.concat(l.call(arguments)))}}function k(e){var t=l.call(arguments,1);return function(){return e.apply(this,t.concat(l.call(arguments)))}}function M(e){return"[object Array]"===r.call(e)}function L(e){return"function"===typeof e}function P(e){return"[object String]"===r.call(e)}function N(e){var t=typeof e;return"function"===t||!!e&&"object"==t}function O(e){return!!n[r.call(e)]}function F(e){return!!i[r.call(e)]}function U(e){return"object"===typeof e&&"number"===typeof e.nodeType&&"object"===typeof e.ownerDocument}function B(e){return e!==e}function G(e){for(var t=0,n=arguments.length;t<n;t++)if(null!=arguments[t])return arguments[t]}function j(e,t){return null!=e?e:t}function V(e,t,n){return null!=e?e:null!=t?t:n}function H(){return Function.call.apply(l,arguments)}function K(e){if("number"===typeof e)return[e,e,e,e];var t=e.length;return 2===t?[e[0],e[1],e[0],e[1]]:3===t?[e[0],e[1],e[2],e[1]]:e}function z(e,t){if(!e)throw new Error(t)}function Z(e){return null==e?null:"function"===typeof e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}d.createCanvas=function(){return document.createElement("canvas")};var q="__ec_primitive__";function Y(e){e[q]=!0}function W(e){return e[q]}function $(e){var t=M(e),n=this;function i(e,i){t?n.set(e,i):n.set(i,e)}e instanceof $?e.each(i):e&&A(e,i)}function X(e){return new $(e)}function Q(e,t){for(var n=new e.constructor(e.length+t.length),i=0;i<e.length;i++)n[i]=e[i];var r=e.length;for(i=0;i<t.length;i++)n[i+r]=t[i];return n}function J(){}$.prototype={constructor:$,get:function(e){return this.hasOwnProperty(e)?this[e]:null},set:function(e,t){return this[e]=t},each:function(e,t){for(var n in void 0!==t&&(e=D(e,t)),this)this.hasOwnProperty(n)&&e(this[n],n)},removeKey:function(e){delete this[e]}},t.$override=f,t.clone=h,t.merge=p,t.mergeAll=g,t.extend=m,t.defaults=v,t.createCanvas=_,t.getContext=b,t.indexOf=E,t.inherits=T,t.mixin=S,t.isArrayLike=w,t.each=A,t.map=I,t.reduce=x,t.filter=R,t.find=C,t.bind=D,t.curry=k,t.isArray=M,t.isFunction=L,t.isString=P,t.isObject=N,t.isBuiltInObject=O,t.isTypedArray=F,t.isDom=U,t.eqNaN=B,t.retrieve=G,t.retrieve2=j,t.retrieve3=V,t.slice=H,t.normalizeCssArray=K,t.assert=z,t.trim=Z,t.setAsPrimitive=Y,t.isPrimitive=W,t.createHashMap=X,t.concatArray=Q,t.noop=J},"6fda":function(e,t,n){var i=n("6d8b"),r=i.each,a="\0_ec_hist_store";function o(e,t){var n=c(e);r(t,function(t,i){for(var r=n.length-1;r>=0;r--){var a=n[r];if(a[i])break}if(r<0){var o=e.queryComponents({mainType:"dataZoom",subType:"select",id:i})[0];if(o){var s=o.getPercentRange();n[0][i]={dataZoomId:i,start:s[0],end:s[1]}}}}),n.push(t)}function s(e){var t=c(e),n=t[t.length-1];t.length>1&&t.pop();var i={};return r(n,function(e,n){for(var r=t.length-1;r>=0;r--){e=t[r][n];if(e){i[n]=e;break}}}),i}function l(e){e[a]=null}function u(e){return c(e).length}function c(e){var t=e[a];return t||(t=e[a]=[{}]),t}t.push=o,t.pop=s,t.clear=l,t.count=u},"71ad":function(e,t,n){var i=n("6d8b"),r={show:!0,zlevel:0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisPointer:{},axisLine:{show:!0,onZero:!0,onZeroAxisIndex:null,lineStyle:{color:"#333",width:1,type:"solid"},symbol:["none","none"],symbolSize:[10,15]},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,showMinLabel:null,showMaxLabel:null,margin:8,fontSize:12},splitLine:{show:!0,lineStyle:{color:["#ccc"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},a={};a.categoryAxis=i.merge({boundaryGap:!0,deduplication:null,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"}},r),a.valueAxis=i.merge({boundaryGap:[0,0],splitNumber:5},r),a.timeAxis=i.defaults({scale:!0,min:"dataMin",max:"dataMax"},a.valueAxis),a.logAxis=i.defaults({scale:!0,logBase:10},a.valueAxis);var o=a;e.exports=o},"74cb":function(e,t){var n={linear:function(e){return e},quadraticIn:function(e){return e*e},quadraticOut:function(e){return e*(2-e)},quadraticInOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},cubicIn:function(e){return e*e*e},cubicOut:function(e){return--e*e*e+1},cubicInOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},quarticIn:function(e){return e*e*e*e},quarticOut:function(e){return 1- --e*e*e*e},quarticInOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},quinticIn:function(e){return e*e*e*e*e},quinticOut:function(e){return--e*e*e*e*e+1},quinticInOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},sinusoidalIn:function(e){return 1-Math.cos(e*Math.PI/2)},sinusoidalOut:function(e){return Math.sin(e*Math.PI/2)},sinusoidalInOut:function(e){return.5*(1-Math.cos(Math.PI*e))},exponentialIn:function(e){return 0===e?0:Math.pow(1024,e-1)},exponentialOut:function(e){return 1===e?1:1-Math.pow(2,-10*e)},exponentialInOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))},circularIn:function(e){return 1-Math.sqrt(1-e*e)},circularOut:function(e){return Math.sqrt(1- --e*e)},circularInOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},elasticIn:function(e){var t,n=.1,i=.4;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=i/4):t=i*Math.asin(1/n)/(2*Math.PI),-n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/i))},elasticOut:function(e){var t,n=.1,i=.4;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=i/4):t=i*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/i)+1)},elasticInOut:function(e){var t,n=.1,i=.4;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=i/4):t=i*Math.asin(1/n)/(2*Math.PI),(e*=2)<1?n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/i)*-.5:n*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/i)*.5+1)},backIn:function(e){var t=1.70158;return e*e*((t+1)*e-t)},backOut:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},backInOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)},bounceIn:function(e){return 1-n.bounceOut(1-e)},bounceOut:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},bounceInOut:function(e){return e<.5?.5*n.bounceIn(2*e):.5*n.bounceOut(2*e-1)+.5}},i=n;e.exports=i},"767c":function(e,t,n){var i=n("3eba"),r=n("6d8b"),a=n("607d"),o=n("29a8"),s=n("2145"),l=o.toolbox.dataView,u=new Array(60).join("-"),c="\t";function d(e){var t={},n=[],i=[];return e.eachRawSeries(function(e){var r=e.coordinateSystem;if(!r||"cartesian2d"!==r.type&&"polar"!==r.type)n.push(e);else{var a=r.getBaseAxis();if("category"===a.type){var o=a.dim+"_"+a.index;t[o]||(t[o]={categoryAxis:a,valueAxis:r.getOtherAxis(a),series:[]},i.push({axisDim:a.dim,axisIndex:a.index})),t[o].series.push(e)}else n.push(e)}}),{seriesGroupByCategoryAxis:t,other:n,meta:i}}function f(e){var t=[];return r.each(e,function(e,n){var i=e.categoryAxis,a=e.valueAxis,o=a.dim,s=[" "].concat(r.map(e.series,function(e){return e.name})),l=[i.model.getCategories()];r.each(e.series,function(e){l.push(e.getRawData().mapArray(o,function(e){return e}))});for(var u=[s.join(c)],d=0;d<l[0].length;d++){for(var f=[],h=0;h<l.length;h++)f.push(l[h][d]);u.push(f.join(c))}t.push(u.join("\n"))}),t.join("\n\n"+u+"\n\n")}function h(e){return r.map(e,function(e){var t=e.getRawData(),n=[e.name],i=[];return t.each(t.dimensions,function(){for(var e=arguments.length,r=arguments[e-1],a=t.getName(r),o=0;o<e-1;o++)i[o]=arguments[o];n.push((a?a+c:"")+i.join(c))}),n.join("\n")}).join("\n\n"+u+"\n\n")}function p(e){var t=d(e);return{value:r.filter([f(t.seriesGroupByCategoryAxis),h(t.other)],function(e){return e.replace(/[\n\t\s]/g,"")}).join("\n\n"+u+"\n\n"),meta:t.meta}}function g(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function m(e){var t=e.slice(0,e.indexOf("\n"));if(t.indexOf(c)>=0)return!0}var v=new RegExp("["+c+"]+","g");function y(e){for(var t=e.split(/\n+/g),n=g(t.shift()).split(v),i=[],a=r.map(n,function(e){return{name:e,data:[]}}),o=0;o<t.length;o++){var s=g(t[o]).split(v);i.push(s.shift());for(var l=0;l<s.length;l++)a[l]&&(a[l].data[o]=s[l])}return{series:a,categories:i}}function _(e){for(var t=e.split(/\n+/g),n=g(t.shift()),i=[],r=0;r<t.length;r++){var a,o=g(t[r]).split(v),s="",l=!1;isNaN(o[0])?(l=!0,s=o[0],o=o.slice(1),i[r]={name:s,value:[]},a=i[r].value):a=i[r]=[];for(var u=0;u<o.length;u++)a.push(+o[u]);1===a.length&&(l?i[r].value=a[0]:i[r]=a[0])}return{name:n,data:i}}function b(e,t){var n=e.split(new RegExp("\n*"+u+"\n*","g")),i={series:[]};return r.each(n,function(e,n){if(m(e)){var r=y(e),a=t[n],o=a.axisDim+"Axis";a&&(i[o]=i[o]||[],i[o][a.axisIndex]={data:r.categories},i.series=i.series.concat(r.series))}else{r=_(e);i.series.push(r)}}),i}function E(e){this._dom=null,this.model=e}function T(e,t){return r.map(e,function(e,n){var i=t&&t[n];return r.isObject(i)&&!r.isArray(i)?(r.isObject(e)&&!r.isArray(e)&&(e=e.value),r.defaults({value:e},i)):e})}E.defaultOption={show:!0,readOnly:!1,optionToContent:null,contentToOption:null,icon:"M17.5,17.3H33 M17.5,17.3H33 M45.4,29.5h-28 M11.5,2v56H51V14.8L38.4,2H11.5z M38.4,2.2v12.7H51 M45.4,41.7h-28",title:r.clone(l.title),lang:r.clone(l.lang),backgroundColor:"#fff",textColor:"#000",textareaColor:"#fff",textareaBorderColor:"#333",buttonColor:"#c23531",buttonTextColor:"#fff"},E.prototype.onclick=function(e,t){var n=t.getDom(),i=this.model;this._dom&&n.removeChild(this._dom);var o=document.createElement("div");o.style.cssText="position:absolute;left:5px;top:5px;bottom:5px;right:5px;",o.style.backgroundColor=i.get("backgroundColor")||"#fff";var s=document.createElement("h4"),l=i.get("lang")||[];s.innerHTML=l[0]||i.get("title"),s.style.cssText="margin: 10px 20px;",s.style.color=i.get("textColor");var u=document.createElement("div"),d=document.createElement("textarea");u.style.cssText="display:block;width:100%;overflow:auto;";var f=i.get("optionToContent"),h=i.get("contentToOption"),g=p(e);if("function"===typeof f){var m=f(t.getOption());"string"===typeof m?u.innerHTML=m:r.isDom(m)&&u.appendChild(m)}else u.appendChild(d),d.readOnly=i.get("readOnly"),d.style.cssText="width:100%;height:100%;font-family:monospace;font-size:14px;line-height:1.6rem;",d.style.color=i.get("textColor"),d.style.borderColor=i.get("textareaBorderColor"),d.style.backgroundColor=i.get("textareaColor"),d.value=g.value;var v=g.meta,y=document.createElement("div");y.style.cssText="position:absolute;bottom:0;left:0;right:0;";var _="float:right;margin-right:20px;border:none;cursor:pointer;padding:2px 5px;font-size:12px;border-radius:3px",E=document.createElement("div"),T=document.createElement("div");_+=";background-color:"+i.get("buttonColor"),_+=";color:"+i.get("buttonTextColor");var S=this;function w(){n.removeChild(o),S._dom=null}a.addEventListener(E,"click",w),a.addEventListener(T,"click",function(){var e;try{e="function"===typeof h?h(u,t.getOption()):b(d.value,v)}catch(e){throw w(),new Error("Data view format error "+e)}e&&t.dispatchAction({type:"changeDataView",newOption:e}),w()}),E.innerHTML=l[1],T.innerHTML=l[2],T.style.cssText=_,E.style.cssText=_,!i.get("readOnly")&&y.appendChild(T),y.appendChild(E),a.addEventListener(d,"keydown",function(e){if(9===(e.keyCode||e.which)){var t=this.value,n=this.selectionStart,i=this.selectionEnd;this.value=t.substring(0,n)+c+t.substring(i),this.selectionStart=this.selectionEnd=n+1,a.stop(e)}}),o.appendChild(s),o.appendChild(u),o.appendChild(y),u.style.height=n.clientHeight-80+"px",n.appendChild(o),this._dom=o},E.prototype.remove=function(e,t){this._dom&&t.getDom().removeChild(this._dom)},E.prototype.dispose=function(e,t){this.remove(e,t)},s.register("dataView",E),i.registerAction({type:"changeDataView",event:"dataViewChanged",update:"prepareAndUpdate"},function(e,t){var n=[];r.each(e.newOption.series,function(e){var i=t.getSeriesByName(e.name)[0];if(i){var a=i.get("data");n.push({name:e.name,data:T(e.data,a)})}else n.push(r.extend({type:"scatter"},e))}),t.mergeOption(r.defaults({series:n},e.newOption))});var S=E;e.exports=S},"76a5":function(e,t,n){var i=n("19eb"),r=n("6d8b"),a=n("e86a"),o=n("a73c"),s=function(e){i.call(this,e)};s.prototype={constructor:s,type:"text",brush:function(e,t){var n=this.style;this.__dirty&&o.normalizeTextStyle(n,!0),n.fill=n.stroke=n.shadowBlur=n.shadowColor=n.shadowOffsetX=n.shadowOffsetY=null;var i=n.text;null!=i&&(i+=""),n.bind(e,this,t),o.needDrawText(i,n)&&(this.setTransform(e),o.renderText(this,e,i,n),this.restoreTransform(e))},getBoundingRect:function(){var e=this.style;if(this.__dirty&&o.normalizeTextStyle(e,!0),!this._rect){var t=e.text;null!=t?t+="":t="";var n=a.getBoundingRect(e.text+"",e.font,e.textAlign,e.textVerticalAlign,e.textPadding,e.rich);if(n.x+=e.x||0,n.y+=e.y||0,o.getStroke(e.textStroke,e.textStrokeWidth)){var i=e.textStrokeWidth;n.x-=i/2,n.y-=i/2,n.width+=i,n.height+=i}this._rect=n}return this._rect}},r.inherits(s,i);var l=s;e.exports=l},7726:function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},"77f1":function(e,t,n){var i=n("4588"),r=Math.max,a=Math.min;e.exports=function(e,t){return e=i(e),e<0?r(e+t,0):a(e,t)}},7919:function(e,t,n){var i=n("f934"),r=i.getLayoutRect,a=i.box,o=i.positionElement,s=n("eda2"),l=n("2306");function u(e,t,n){var i=t.getBoxLayoutParams(),s=t.get("padding"),l={width:n.getWidth(),height:n.getHeight()},u=r(i,l,s);a(t.get("orient"),e,t.get("itemGap"),u.width,u.height),o(e,i,l,s)}function c(e,t){var n=s.normalizeCssArray(t.get("padding")),i=t.getItemStyle(["color","opacity"]);i.fill=t.get("backgroundColor");e=new l.Rect({shape:{x:e.x-n[3],y:e.y-n[0],width:e.width+n[1]+n[3],height:e.height+n[0]+n[2],r:t.get("borderRadius")},style:i,silent:!0,z2:-1});return e}t.layout=u,t.makeBackground=c},"79e5":function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},"7a56":function(e,t,n){"use strict";var i=n("7726"),r=n("86cc"),a=n("9e1e"),o=n("2b4c")("species");e.exports=function(e){var t=i[e];a&&t&&!t[o]&&r.f(t,o,{configurable:!0,get:function(){return this}})}},"7c4d":function(e,t,n){var i=n("3eba"),r=n("6d8b"),a=n("fc82"),o=n("bd9e"),s=n("6fda"),l=n("ef6a"),u=n("29a8"),c=n("2145");n("dd39");var d=u.toolbox.dataZoom,f=r.each,h="\0_ec_\0toolbox-dataZoom_";function p(e,t,n){(this._brushController=new a(n.getZr())).on("brush",r.bind(this._onBrush,this)).mount(),this._isZoomActive}p.defaultOption={show:!0,icon:{zoom:"M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1",back:"M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26"},title:r.clone(d.title)};var g=p.prototype;g.render=function(e,t,n,i){this.model=e,this.ecModel=t,this.api=n,_(e,t,this,i,n),y(e,t)},g.onclick=function(e,t,n){m[n].call(this)},g.remove=function(e,t){this._brushController.unmount()},g.dispose=function(e,t){this._brushController.dispose()};var m={zoom:function(){var e=!this._isZoomActive;this.api.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:e})},back:function(){this._dispatchZoomAction(s.pop(this.ecModel))}};function v(e){var t={};return r.each(["xAxisIndex","yAxisIndex"],function(n){t[n]=e[n],null==t[n]&&(t[n]="all"),(!1===t[n]||"none"===t[n])&&(t[n]=[])}),t}function y(e,t){e.setIconStatus("back",s.count(t)>1?"emphasis":"normal")}function _(e,t,n,i,r){var a=n._isZoomActive;i&&"takeGlobalCursor"===i.type&&(a="dataZoomSelect"===i.key&&i.dataZoomSelectActive),n._isZoomActive=a,e.setIconStatus("zoom",a?"emphasis":"normal");var s=new o(v(e.option),t,{include:["grid"]});n._brushController.setPanels(s.makePanelOpts(r,function(e){return e.xAxisDeclared&&!e.yAxisDeclared?"lineX":!e.xAxisDeclared&&e.yAxisDeclared?"lineY":"rect"})).enableBrush(!!a&&{brushType:"auto",brushStyle:{lineWidth:0,fill:"rgba(0,0,0,0.2)"}})}g._onBrush=function(e,t){if(t.isEnd&&e.length){var n={},i=this.ecModel;this._brushController.updateCovers([]);var r=new o(v(this.model.option),i,{include:["grid"]});r.matchOutputRanges(e,i,function(e,t,n){if("cartesian2d"===n.type){var i=e.brushType;"rect"===i?(a("x",n,t[0]),a("y",n,t[1])):a({lineX:"x",lineY:"y"}[i],n,t)}}),s.push(i,n),this._dispatchZoomAction(n)}function a(e,t,r){var a=t.getAxis(e),o=a.model,s=u(e,o,i),c=s.findRepresentativeAxisProxy(o).getMinMaxSpan();null==c.minValueSpan&&null==c.maxValueSpan||(r=l(0,r.slice(),a.scale.getExtent(),0,c.minValueSpan,c.maxValueSpan)),s&&(n[s.id]={dataZoomId:s.id,startValue:r[0],endValue:r[1]})}function u(e,t,n){var i;return n.eachComponent({mainType:"dataZoom",subType:"select"},function(n){var r=n.getAxisModel(e,t.componentIndex);r&&(i=n)}),i}},g._dispatchZoomAction=function(e){var t=[];f(e,function(e,n){t.push(r.clone(e))}),t.length&&this.api.dispatchAction({type:"dataZoom",from:this.uid,batch:t})},c.register("dataZoom",p),i.registerPreprocessor(function(e){if(e){var t=e.dataZoom||(e.dataZoom=[]);r.isArray(t)||(e.dataZoom=t=[t]);var n=e.toolbox;if(n&&(r.isArray(n)&&(n=n[0]),n&&n.feature)){var i=n.feature.dataZoom;a("xAxis",i),a("yAxis",i)}}function a(e,n){if(n){var i=e+"Index",a=n[i];null==a||"all"==a||r.isArray(a)||(a=!1===a||"none"===a?[]:[a]),o(e,function(n,o){if(null==a||"all"==a||-1!==r.indexOf(a,o)){var s={type:"select",$fromToolbox:!0,id:h+e+o};s[i]=o,t.push(s)}})}}function o(t,n){var i=e[t];r.isArray(i)||(i=i?[i]:[]),f(i,n)}});var b=p;e.exports=b},"7d6d":function(e,t){var n={shadowBlur:1,shadowOffsetX:1,shadowOffsetY:1,textShadowBlur:1,textShadowOffsetX:1,textShadowOffsetY:1,textBoxShadowBlur:1,textBoxShadowOffsetX:1,textBoxShadowOffsetY:1};function i(e,t,i){return n.hasOwnProperty(t)?i*e.dpr:i}e.exports=i},"7dcf":function(e,t,n){var i=n("b12f"),r=i.extend({type:"dataZoom",render:function(e,t,n,i){this.dataZoomModel=e,this.ecModel=t,this.api=n},getTargetCoordInfo:function(){var e=this.dataZoomModel,t=this.ecModel,n={};function i(e,t,n,i){for(var r,a=0;a<n.length;a++)if(n[a].model===e){r=n[a];break}r||n.push(r={model:e,axisModels:[],coordIndex:i}),r.axisModels.push(t)}return e.eachTargetAxis(function(e,r){var a=t.getComponent(e.axis,r);if(a){var o=a.getCoordSysModel();o&&i(o,a,n[o.mainType]||(n[o.mainType]=[]),o.componentIndex)}},this),n}});e.exports=r},"7e63":function(e,t,n){var i=n("4e08"),r=(i.__DEV__,n("6d8b")),a=r.each,o=r.filter,s=r.map,l=r.isArray,u=r.indexOf,c=r.isObject,d=r.isString,f=r.createHashMap,h=r.assert,p=r.clone,g=r.merge,m=r.extend,v=r.mixin,y=n("e0d3"),_=n("4319"),b=n("6cb7"),E=n("8971"),T=n("e47b"),S=n("0f99"),w=S.resetSourceDefaulter,A="\0_ec_inner",I=_.extend({init:function(e,t,n,i){n=n||{},this.option=null,this._theme=new _(n),this._optionManager=i},setOption:function(e,t){h(!(A in e),"please use chart.getOption()"),this._optionManager.setOption(e,t),this.resetOption(null)},resetOption:function(e){var t=!1,n=this._optionManager;if(!e||"recreate"===e){var i=n.mountOption("recreate"===e);this.option&&"recreate"!==e?(this.restoreData(),this.mergeOption(i)):C.call(this,i),t=!0}if("timeline"!==e&&"media"!==e||this.restoreData(),!e||"recreate"===e||"timeline"===e){var r=n.getTimelineOption(this);r&&(this.mergeOption(r),t=!0)}if(!e||"recreate"===e||"media"===e){var o=n.getMediaOption(this,this._api);o.length&&a(o,function(e){this.mergeOption(e,t=!0)},this)}return t},mergeOption:function(e){var t=this.option,n=this._componentsMap,i=[];function r(i,r){var o=y.normalizeToArray(e[i]),s=y.mappingToExists(n.get(i),o);y.makeIdAndName(s),a(s,function(e,t){var n=e.option;c(n)&&(e.keyInfo.mainType=i,e.keyInfo.subType=k(i,n,e.exist))});var l=D(n,r);t[i]=[],n.set(i,[]),a(s,function(e,r){var a=e.exist,o=e.option;if(h(c(o)||a,"Empty component definition"),o){var s=b.getClass(i,e.keyInfo.subType,!0);if(a&&a instanceof s)a.name=e.keyInfo.name,a.mergeOption(o,this),a.optionUpdated(o,!1);else{var u=m({dependentModels:l,componentIndex:r},e.keyInfo);a=new s(o,this,this,u),m(a,u),a.init(o,this,this,u),a.optionUpdated(null,!0)}}else a.mergeOption({},this),a.optionUpdated({},!1);n.get(i)[r]=a,t[i][r]=a.option},this),"series"===i&&M(this,n.get("series"))}w(this),a(e,function(e,n){null!=e&&(b.hasClass(n)?n&&i.push(n):t[n]=null==t[n]?p(e):g(t[n],e,!0))}),b.topologicalTravel(i,b.getAllClassMainTypes(),r,this),this._seriesIndicesMap=f(this._seriesIndices=this._seriesIndices||[])},getOption:function(){var e=p(this.option);return a(e,function(t,n){if(b.hasClass(n)){t=y.normalizeToArray(t);for(var i=t.length-1;i>=0;i--)y.isIdInner(t[i])&&t.splice(i,1);e[n]=t}}),delete e[A],e},getTheme:function(){return this._theme},getComponent:function(e,t){var n=this._componentsMap.get(e);if(n)return n[t||0]},queryComponents:function(e){var t=e.mainType;if(!t)return[];var n,i=e.index,r=e.id,a=e.name,c=this._componentsMap.get(t);if(!c||!c.length)return[];if(null!=i)l(i)||(i=[i]),n=o(s(i,function(e){return c[e]}),function(e){return!!e});else if(null!=r){var d=l(r);n=o(c,function(e){return d&&u(r,e.id)>=0||!d&&e.id===r})}else if(null!=a){var f=l(a);n=o(c,function(e){return f&&u(a,e.name)>=0||!f&&e.name===a})}else n=c.slice();return L(n,e)},findComponents:function(e){var t=e.query,n=e.mainType,i=a(t),r=i?this.queryComponents(i):this._componentsMap.get(n);return s(L(r,e));function a(e){var t=n+"Index",i=n+"Id",r=n+"Name";return!e||null==e[t]&&null==e[i]&&null==e[r]?null:{mainType:n,index:e[t],id:e[i],name:e[r]}}function s(t){return e.filter?o(t,e.filter):t}},eachComponent:function(e,t,n){var i=this._componentsMap;if("function"===typeof e)n=t,t=e,i.each(function(e,i){a(e,function(e,r){t.call(n,i,e,r)})});else if(d(e))a(i.get(e),t,n);else if(c(e)){var r=this.findComponents(e);a(r,t,n)}},getSeriesByName:function(e){var t=this._componentsMap.get("series");return o(t,function(t){return t.name===e})},getSeriesByIndex:function(e){return this._componentsMap.get("series")[e]},getSeriesByType:function(e){var t=this._componentsMap.get("series");return o(t,function(t){return t.subType===e})},getSeries:function(){return this._componentsMap.get("series").slice()},getSeriesCount:function(){return this._componentsMap.get("series").length},eachSeries:function(e,t){P(this),a(this._seriesIndices,function(n){var i=this._componentsMap.get("series")[n];e.call(t,i,n)},this)},eachRawSeries:function(e,t){a(this._componentsMap.get("series"),e,t)},eachSeriesByType:function(e,t,n){P(this),a(this._seriesIndices,function(i){var r=this._componentsMap.get("series")[i];r.subType===e&&t.call(n,r,i)},this)},eachRawSeriesByType:function(e,t,n){return a(this.getSeriesByType(e),t,n)},isSeriesFiltered:function(e){return P(this),null==this._seriesIndicesMap.get(e.componentIndex)},getCurrentSeriesIndices:function(){return(this._seriesIndices||[]).slice()},filterSeries:function(e,t){P(this);var n=o(this._componentsMap.get("series"),e,t);M(this,n)},restoreData:function(e){var t=this._componentsMap;M(this,t.get("series"));var n=[];t.each(function(e,t){n.push(t)}),b.topologicalTravel(n,b.getAllClassMainTypes(),function(n,i){a(t.get(n),function(t){("series"!==n||!x(t,e))&&t.restoreData()})})}});function x(e,t){if(t){var n=t.seiresIndex,i=t.seriesId,r=t.seriesName;return null!=n&&e.componentIndex!==n||null!=i&&e.id!==i||null!=r&&e.name!==r}}function R(e,t){var n=e.color&&!e.colorLayer;a(t,function(t,i){"colorLayer"===i&&n||b.hasClass(i)||("object"===typeof t?e[i]=e[i]?g(e[i],t,!1):p(t):null==e[i]&&(e[i]=t))})}function C(e){e=e,this.option={},this.option[A]=1,this._componentsMap=f({series:[]}),this._seriesIndices,this._seriesIndicesMap,R(e,this._theme.option),g(e,E,!1),this.mergeOption(e)}function D(e,t){l(t)||(t=t?[t]:[]);var n={};return a(t,function(t){n[t]=(e.get(t)||[]).slice()}),n}function k(e,t,n){var i=t.type?t.type:n?n.subType:b.determineSubType(e,t);return i}function M(e,t){e._seriesIndicesMap=f(e._seriesIndices=s(t,function(e){return e.componentIndex})||[])}function L(e,t){return t.hasOwnProperty("subType")?o(e,function(e){return e.subType===t.subType}):e}function P(e){}v(I,T);var N=I;e.exports=N},"7f20":function(e,t,n){var i=n("86cc").f,r=n("69a8"),a=n("2b4c")("toStringTag");e.exports=function(e,t,n){e&&!r(e=n?e:e.prototype,a)&&i(e,a,{configurable:!0,value:t})}},"7f96":function(e,t){function n(e,t,n){return{seriesType:e,performRawSeries:!0,reset:function(e,i,r){var a=e.getData(),o=e.get("symbol")||t,s=e.get("symbolSize"),l=e.get("symbolKeepAspect");if(a.setVisual({legendSymbol:n||o,symbol:o,symbolSize:s,symbolKeepAspect:l}),!i.isSeriesFiltered(e)){var u="function"===typeof s;return{dataEach:a.hasItemOption||u?c:null}}function c(t,n){if("function"===typeof s){var i=e.getRawValue(n),r=e.getDataParams(n);t.setItemVisual(n,"symbolSize",s(i,r))}if(t.hasItemOption){var a=t.getItemModel(n),o=a.getShallow("symbol",!0),l=a.getShallow("symbolSize",!0),u=a.getShallow("symbolKeepAspect",!0);null!=o&&t.setItemVisual(n,"symbol",o),null!=l&&t.setItemVisual(n,"symbolSize",l),null!=u&&t.setItemVisual(n,"symbolKeepAspect",u)}}}}}e.exports=n},8079:function(e,t,n){var i=n("7726"),r=n("1991").set,a=i.MutationObserver||i.WebKitMutationObserver,o=i.process,s=i.Promise,l="process"==n("2d95")(o);e.exports=function(){var e,t,n,u=function(){var i,r;l&&(i=o.domain)&&i.exit();while(e){r=e.fn,e=e.next;try{r()}catch(i){throw e?n():t=void 0,i}}t=void 0,i&&i.enter()};if(l)n=function(){o.nextTick(u)};else if(!a||i.navigator&&i.navigator.standalone)if(s&&s.resolve){var c=s.resolve(void 0);n=function(){c.then(u)}}else n=function(){r.call(i,u)};else{var d=!0,f=document.createTextNode("");new a(u).observe(f,{characterData:!0}),n=function(){f.data=d=!d}}return function(i){var r={fn:i,next:void 0};t&&(t.next=r),e||(e=r,n()),t=r}}},"80f0":function(e,t){function n(e){return e}function i(e,t,i,r,a){this._old=e,this._new=t,this._oldKeyGetter=i||n,this._newKeyGetter=r||n,this.context=a}function r(e,t,n,i,r){for(var a=0;a<e.length;a++){var o="_ec_"+r[i](e[a],a),s=t[o];null==s?(n.push(o),t[o]=a):(s.length||(t[o]=s=[s]),s.push(a))}}i.prototype={constructor:i,add:function(e){return this._add=e,this},update:function(e){return this._update=e,this},remove:function(e){return this._remove=e,this},execute:function(){var e=this._old,t=this._new,n={},i={},a=[],o=[];for(r(e,n,a,"_oldKeyGetter",this),r(t,i,o,"_newKeyGetter",this),c=0;c<e.length;c++){var s=a[c],l=i[s];if(null!=l){var u=l.length;u?(1===u&&(i[s]=null),l=l.unshift()):i[s]=null,this._update&&this._update(l,c)}else this._remove&&this._remove(c)}for(var c=0;c<o.length;c++){s=o[c];if(i.hasOwnProperty(s)){l=i[s];if(null==l)continue;if(l.length){var d=0;for(u=l.length;d<u;d++)this._add&&this._add(l[d])}else this._add&&this._add(l)}}}};var a=i;e.exports=a},8378:function(e,t){var n=e.exports={version:"2.5.7"};"number"==typeof __e&&(__e=n)},"843e":function(e,t,n){var i=n("6d8b"),r=["getDom","getZr","getWidth","getHeight","getDevicePixelRatio","dispatchAction","isDisposed","on","off","getDataURL","getConnectedDataURL","getModel","getOption","getViewOfComponentModel","getViewOfSeriesModel"];function a(e){i.each(r,function(t){this[t]=i.bind(e[t],e)},this)}var o=a;e.exports=o},"84ce":function(e,t,n){var i=n("6d8b"),r=i.each,a=i.map,o=n("3842"),s=o.linearMap,l=o.getPixelPrecision,u=n("e073"),c=u.createAxisTicks,d=u.createAxisLabels,f=u.calculateCategoryInterval,h=[0,1],p=function(e,t,n){this.dim=e,this.scale=t,this._extent=n||[0,0],this.inverse=!1,this.onBand=!1};function g(e,t){var n=e[1]-e[0],i=t,r=n/i/2;e[0]+=r,e[1]-=r}function m(e,t,n,i,a){var o=t.length;if(e.onBand&&!i&&o){var s,l=e.getExtent();if(1===o)t[0].coord=l[0],s=t[1]={coord:l[0]};else{var u=t[1].coord-t[0].coord;r(t,function(e){e.coord-=u/2;var t=t||0;t%2>0&&(e.coord-=u/(2*(t+1)))}),s={coord:t[o-1].coord+u},t.push(s)}var c=l[0]>l[1];d(t[0].coord,l[0])&&(a?t[0].coord=l[0]:t.shift()),a&&d(l[0],t[0].coord)&&t.unshift({coord:l[0]}),d(l[1],s.coord)&&(a?s.coord=l[1]:t.pop()),a&&d(s.coord,l[1])&&t.push({coord:l[1]})}function d(e,t){return c?e>t:e<t}}p.prototype={constructor:p,contain:function(e){var t=this._extent,n=Math.min(t[0],t[1]),i=Math.max(t[0],t[1]);return e>=n&&e<=i},containData:function(e){return this.contain(this.dataToCoord(e))},getExtent:function(){return this._extent.slice()},getPixelPrecision:function(e){return l(e||this.scale.getExtent(),this._extent)},setExtent:function(e,t){var n=this._extent;n[0]=e,n[1]=t},dataToCoord:function(e,t){var n=this._extent,i=this.scale;return e=i.normalize(e),this.onBand&&"ordinal"===i.type&&(n=n.slice(),g(n,i.count())),s(e,h,n,t)},coordToData:function(e,t){var n=this._extent,i=this.scale;this.onBand&&"ordinal"===i.type&&(n=n.slice(),g(n,i.count()));var r=s(e,n,h,t);return this.scale.scale(r)},pointToData:function(e,t){},getTicksCoords:function(e){e=e||{};var t=e.tickModel||this.getTickModel(),n=c(this,t),i=n.ticks,r=a(i,function(e){return{coord:this.dataToCoord(e),tickValue:e}},this),o=t.get("alignWithLabel");return m(this,r,n.tickCategoryInterval,o,e.clamp),r},getViewLabels:function(){return d(this).labels},getLabelModel:function(){return this.model.getModel("axisLabel")},getTickModel:function(){return this.model.getModel("axisTick")},getBandWidth:function(){var e=this._extent,t=this.scale.getExtent(),n=t[1]-t[0]+(this.onBand?1:0);0===n&&(n=1);var i=Math.abs(e[1]-e[0]);return Math.abs(i)/n},isHorizontal:null,getRotate:null,calculateCategoryInterval:function(){return f(this)}};var v=p;e.exports=v},"84d5":function(e,t,n){var i=n("3eba"),r=n("6d8b"),a=n("4319"),o=n("e0d3"),s=o.isNameSpecified,l=i.extendComponentModel({type:"legend.plain",dependencies:["series"],layoutMode:{type:"box",ignoreSize:!0},init:function(e,t,n){this.mergeDefaultAndTheme(e,n),e.selected=e.selected||{}},mergeOption:function(e){l.superCall(this,"mergeOption",e)},optionUpdated:function(){this._updateData(this.ecModel);var e=this._data;if(e[0]&&"single"===this.get("selectedMode")){for(var t=!1,n=0;n<e.length;n++){var i=e[n].get("name");if(this.isSelected(i)){this.select(i),t=!0;break}}!t&&this.select(e[0].get("name"))}},_updateData:function(e){var t=[],n=[];e.eachRawSeries(function(i){var r,a=i.name;if(n.push(a),i.legendDataProvider){var o=i.legendDataProvider(),l=o.mapArray(o.getName);e.isSeriesFiltered(i)||(n=n.concat(l)),l.length?t=t.concat(l):r=!0}else r=!0;r&&s(i)&&t.push(i.name)}),this._availableNames=n;var i=this.get("data")||t,o=r.map(i,function(e){return"string"!==typeof e&&"number"!==typeof e||(e={name:e}),new a(e,this,this.ecModel)},this);this._data=o},getData:function(){return this._data},select:function(e){var t=this.option.selected,n=this.get("selectedMode");if("single"===n){var i=this._data;r.each(i,function(e){t[e.get("name")]=!1})}t[e]=!0},unSelect:function(e){"single"!==this.get("selectedMode")&&(this.option.selected[e]=!1)},toggleSelected:function(e){var t=this.option.selected;t.hasOwnProperty(e)||(t[e]=!0),this[t[e]?"unSelect":"select"](e)},isSelected:function(e){var t=this.option.selected;return!(t.hasOwnProperty(e)&&!t[e])&&r.indexOf(this._availableNames,e)>=0},defaultOption:{zlevel:0,z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,inactiveColor:"#ccc",textStyle:{color:"#333"},selectedMode:!0,tooltip:{show:!1}}}),u=l;e.exports=u},"84f2":function(e,t){e.exports={}},"857d":function(e,t){var n=2*Math.PI;function i(e){return e%=n,e<0&&(e+=n),e}t.normalizeRadian=i},"862d":function(e,t,n){var i=n("6d8b"),r=i.createHashMap,a=i.each,o=i.isString,s=i.defaults,l=i.extend,u=i.isObject,c=i.clone,d=n("e0d3"),f=d.normalizeToArray,h=n("0f99"),p=h.guessOrdinal,g=n("ec6f"),m=n("2f45"),v=m.OTHER_DIMENSIONS;function y(e,t,n){g.isInstance(t)||(t=g.seriesDataToSource(t)),n=n||{},e=(e||[]).slice();for(var i=(n.dimsDef||[]).slice(),d=r(n.encodeDef),h=r(),m=r(),y=[],E=_(t,e,i,n.dimCount),T=0;T<E;T++){var S=i[T]=l({},u(i[T])?i[T]:{name:i[T]}),w=S.name,A=y[T]={otherDims:{}};null!=w&&null==h.get(w)&&(A.name=A.displayName=w,h.set(w,T)),null!=S.type&&(A.type=S.type),null!=S.displayName&&(A.displayName=S.displayName)}d.each(function(e,t){e=f(e).slice();var n=d.set(t,[]);a(e,function(e,i){o(e)&&(e=h.get(e)),null!=e&&e<E&&(n[i]=e,x(y[e],t,i))})});var I=0;function x(e,t,n){null!=v.get(t)?e.otherDims[t]=n:(e.coordDim=t,e.coordDimIndex=n,m.set(t,!0))}a(e,function(e,t){var n,i,r;if(o(e))n=e,e={};else{n=e.name;var l=e.ordinalMeta;e.ordinalMeta=null,e=c(e),e.ordinalMeta=l,i=e.dimsDef,r=e.otherDims,e.name=e.coordDim=e.coordDimIndex=e.dimsDef=e.otherDims=null}var h=f(d.get(n));if(!h.length)for(var p=0;p<(i&&i.length||1);p++){while(I<y.length&&null!=y[I].coordDim)I++;I<y.length&&h.push(I++)}a(h,function(t,a){var o=y[t];if(x(s(o,e),n,a),null==o.name&&i){var l=i[a];!u(l)&&(l={name:l}),o.name=o.displayName=l.name,o.defaultTooltip=l.defaultTooltip}r&&s(o.otherDims,r)})});var R=n.generateCoord,C=n.generateCoordCount,D=null!=C;C=R?C||1:0;for(var k=R||"value",M=0;M<E;M++){A=y[M]=y[M]||{};var L=A.coordDim;null==L&&(A.coordDim=b(k,m,D),A.coordDimIndex=0,(!R||C<=0)&&(A.isExtraCoord=!0),C--),null==A.name&&(A.name=b(A.coordDim,h)),null==A.type&&p(t,M,A.name)&&(A.type="ordinal")}return y}function _(e,t,n,i){var r=Math.max(e.dimensionsDetectCount||1,t.length,n.length,i||0);return a(t,function(e){var t=e.dimsDef;t&&(r=Math.max(r,t.length))}),r}function b(e,t,n){if(n||null!=t.get(e)){var i=0;while(null!=t.get(e+i))i++;e+=i}return t.set(e,!0),e}var E=y;e.exports=E},"86cc":function(e,t,n){var i=n("cb7c"),r=n("c69a"),a=n("6a99"),o=Object.defineProperty;t.f=n("9e1e")?Object.defineProperty:function(e,t,n){if(i(e),t=a(t,!0),i(n),r)try{return o(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},8728:function(e,t){function n(e,t,n,i,r,a){if(a>t&&a>i||a<t&&a<i)return 0;if(i===t)return 0;var o=i<t?1:-1,s=(a-t)/(i-t);1!==s&&0!==s||(o=i<t?.5:-.5);var l=s*(n-e)+e;return l===r?1/0:l>r?o:0}e.exports=n},"87b1":function(e,t,n){var i=n("cbe5"),r=n("4fac"),a=i.extend({type:"polygon",shape:{points:null,smooth:!1,smoothConstraint:null},buildPath:function(e,t){r.buildPath(e,t,!0)}});e.exports=a},"87c3":function(e,t,n){var i=n("6d8b"),r=i.map,a=n("cccd"),o=n("ee1a"),s=o.isDimensionStacked;function l(e){return{seriesType:e,plan:a(),reset:function(e){var t=e.getData(),n=e.coordinateSystem,i=e.pipelineContext,a=i.large;if(n){var o=r(n.dimensions,function(e){return t.mapDimension(e)}).slice(0,2),l=o.length,u=t.getCalculationInfo("stackResultDimension");return s(t,o[0])&&(o[0]=u),s(t,o[1])&&(o[1]=u),l&&{progress:c}}function c(e,t){for(var i=e.end-e.start,r=a&&new Float32Array(i*l),s=e.start,u=0,c=[],d=[];s<e.end;s++){var f;if(1===l){var h=t.get(o[0],s);f=!isNaN(h)&&n.dataToPoint(h,null,d)}else{h=c[0]=t.get(o[0],s);var p=c[1]=t.get(o[1],s);f=!isNaN(h)&&!isNaN(p)&&n.dataToPoint(c,null,d)}a?(r[u++]=f?f[0]:NaN,r[u++]=f?f[1]:NaN):t.setItemLayout(s,f&&f.slice()||[NaN,NaN])}a&&t.setLayout("symbolPoints",r)}}}}e.exports=l},"88b3":function(e,t){var n="\0__throttleOriginMethod",i="\0__throttleRate",r="\0__throttleType";function a(e,t,n){var i,r,a,o,s,l=0,u=0,c=null;function d(){u=(new Date).getTime(),c=null,e.apply(a,o||[])}t=t||0;var f=function(){i=(new Date).getTime(),a=this,o=arguments;var e=s||t,f=s||n;s=null,r=i-(f?l:u)-e,clearTimeout(c),f?c=setTimeout(d,e):r>=0?d():c=setTimeout(d,-r),l=i};return f.clear=function(){c&&(clearTimeout(c),c=null)},f.debounceNextCall=function(e){s=e},f}function o(e,t,o,s){var l=e[t];if(l){var u=l[n]||l,c=l[r],d=l[i];if(d!==o||c!==s){if(null==o||!s)return e[t]=u;l=e[t]=a(u,o,"debounce"===s),l[n]=u,l[r]=s,l[i]=o}return l}}function s(e,t){var i=e[t];i&&i[n]&&(e[t]=i[n])}t.throttle=a,t.createOrUpdate=o,t.clear=s},8918:function(e,t,n){var i=n("6d8b"),r=n("625e"),a=r.parseClassType,o=0;function s(e){return[e||"",o++,Math.random().toFixed(5)].join("_")}function l(e){var t={};return e.registerSubTypeDefaulter=function(e,n){e=a(e),t[e.main]=n},e.determineSubType=function(n,i){var r=i.type;if(!r){var o=a(n).main;e.hasSubTypes(n)&&t[o]&&(r=t[o](i))}return r},e}function u(e,t){function n(e){var n={},o=[];return i.each(e,function(s){var l=r(n,s),u=l.originalDeps=t(s),c=a(u,e);l.entryCount=c.length,0===l.entryCount&&o.push(s),i.each(c,function(e){i.indexOf(l.predecessor,e)<0&&l.predecessor.push(e);var t=r(n,e);i.indexOf(t.successor,e)<0&&t.successor.push(s)})}),{graph:n,noEntryList:o}}function r(e,t){return e[t]||(e[t]={predecessor:[],successor:[]}),e[t]}function a(e,t){var n=[];return i.each(e,function(e){i.indexOf(t,e)>=0&&n.push(e)}),n}e.topologicalTravel=function(e,t,r,a){if(e.length){var o=n(t),s=o.graph,l=o.noEntryList,u={};i.each(e,function(e){u[e]=!0});while(l.length){var c=l.pop(),d=s[c],f=!!u[c];f&&(r.call(a,c,d.originalDeps.slice()),delete u[c]),i.each(d.successor,f?p:h)}i.each(u,function(){throw new Error("Circle dependency may exists")})}function h(e){s[e].entryCount--,0===s[e].entryCount&&l.push(e)}function p(e){u[e]=!0,h(e)}}}t.getUID=s,t.enableSubTypeDefaulter=l,t.enableTopologicalTravel=u},8971:function(e,t){var n="";"undefined"!==typeof navigator&&(n=navigator.platform||"");var i={color:["#c23531","#2f4554","#61a0a8","#d48265","#91c7ae","#749f83","#ca8622","#bda29a","#6e7074","#546570","#c4ccd3"],gradientColor:["#f6efa6","#d88273","#bf444c"],textStyle:{fontFamily:n.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,animation:"auto",animationDuration:1e3,animationDurationUpdate:300,animationEasing:"exponentialOut",animationEasingUpdate:"cubicOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3,useUTC:!1};e.exports=i},"897a":function(e,t,n){var i=n("22d1"),r=[["shadowBlur",0],["shadowColor","#000"],["shadowOffsetX",0],["shadowOffsetY",0]];function a(e){return i.browser.ie&&i.browser.version>=11?function(){var t,n=this.__clipPaths,i=this.style;if(n)for(var a=0;a<n.length;a++){var o=n[a],s=o&&o.shape,l=o&&o.type;if(s&&("sector"===l&&s.startAngle===s.endAngle||"rect"===l&&(!s.width||!s.height))){for(var u=0;u<r.length;u++)r[u][2]=i[r[u][0]],i[r[u][0]]=r[u][1];t=!0;break}}if(e.apply(this,arguments),t)for(u=0;u<r.length;u++)i[r[u][0]]=r[u][2]}:e}e.exports=a},"89e3":function(e,t,n){var i=n("3842"),r=n("eda2"),a=n("e0d8"),o=n("944e"),s=i.round,l=a.extend({type:"interval",_interval:0,_intervalPrecision:2,setExtent:function(e,t){var n=this._extent;isNaN(e)||(n[0]=parseFloat(e)),isNaN(t)||(n[1]=parseFloat(t))},unionExtent:function(e){var t=this._extent;e[0]<t[0]&&(t[0]=e[0]),e[1]>t[1]&&(t[1]=e[1]),l.prototype.setExtent.call(this,t[0],t[1])},getInterval:function(){return this._interval},setInterval:function(e){this._interval=e,this._niceExtent=this._extent.slice(),this._intervalPrecision=o.getIntervalPrecision(e)},getTicks:function(){return o.intervalScaleGetTicks(this._interval,this._extent,this._niceExtent,this._intervalPrecision)},getLabel:function(e,t){if(null==e)return"";var n=t&&t.precision;return null==n?n=i.getPrecisionSafe(e)||0:"auto"===n&&(n=this._intervalPrecision),e=s(e,n,!0),r.addCommas(e)},niceTicks:function(e,t,n){e=e||5;var i=this._extent,r=i[1]-i[0];if(isFinite(r)){r<0&&(r=-r,i.reverse());var a=o.intervalScaleNiceTicks(i,e,t,n);this._intervalPrecision=a.intervalPrecision,this._interval=a.interval,this._niceExtent=a.niceTickExtent}},niceExtent:function(e){var t=this._extent;if(t[0]===t[1])if(0!==t[0]){var n=t[0];e.fixMax?t[0]-=n/2:(t[1]+=n/2,t[0]-=n/2)}else t[1]=1;var i=t[1]-t[0];isFinite(i)||(t[0]=0,t[1]=1),this.niceTicks(e.splitNumber,e.minInterval,e.maxInterval);var r=this._interval;e.fixMin||(t[0]=s(Math.floor(t[0]/r)*r)),e.fixMax||(t[1]=s(Math.ceil(t[1]/r)*r))}});l.create=function(){return new l};var u=l;e.exports=u},"8b7f":function(e,t,n){var i=n("4e08"),r=(i.__DEV__,n("6d8b")),a=r.createHashMap,o=(r.retrieve,r.each);function s(e){var t=e.get("coordinateSystem"),n={coordSysName:t,coordSysDims:[],axisMap:a(),categoryAxisMap:a()},i=l[t];if(i)return i(e,n,n.axisMap,n.categoryAxisMap),n}var l={cartesian2d:function(e,t,n,i){var r=e.getReferringComponents("xAxis")[0],a=e.getReferringComponents("yAxis")[0];t.coordSysDims=["x","y"],n.set("x",r),n.set("y",a),u(r)&&(i.set("x",r),t.firstCategoryDimIndex=0),u(a)&&(i.set("y",a),t.firstCategoryDimIndex=1)},singleAxis:function(e,t,n,i){var r=e.getReferringComponents("singleAxis")[0];t.coordSysDims=["single"],n.set("single",r),u(r)&&(i.set("single",r),t.firstCategoryDimIndex=0)},polar:function(e,t,n,i){var r=e.getReferringComponents("polar")[0],a=r.findAxisModel("radiusAxis"),o=r.findAxisModel("angleAxis");t.coordSysDims=["radius","angle"],n.set("radius",a),n.set("angle",o),u(a)&&(i.set("radius",a),t.firstCategoryDimIndex=0),u(o)&&(i.set("angle",o),t.firstCategoryDimIndex=1)},geo:function(e,t,n,i){t.coordSysDims=["lng","lat"]},parallel:function(e,t,n,i){var r=e.ecModel,a=r.getComponent("parallel",e.get("parallelIndex")),s=t.coordSysDims=a.dimensions.slice();o(a.parallelAxisIndex,function(e,a){var o=r.getComponent("parallelAxis",e),l=s[a];n.set(l,o),u(o)&&null==t.firstCategoryDimIndex&&(i.set(l,o),t.firstCategoryDimIndex=a)})}};function u(e){return"category"===e.get("type")}t.getCoordSysDefineBySeries=s},"8b97":function(e,t,n){var i=n("d3f4"),r=n("cb7c"),a=function(e,t){if(r(e),!i(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,i){try{i=n("9b43")(Function.call,n("11e9").f(Object.prototype,"__proto__").set,2),i(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return a(e,n),t?e.__proto__=n:i(e,n),e}}({},!1):void 0),check:a}},"8c2a":function(e,t,n){var i=n("6d8b"),r=n("e0d8"),a=n("3842"),o=n("89e3"),s=r.prototype,l=o.prototype,u=a.getPrecisionSafe,c=a.round,d=Math.floor,f=Math.ceil,h=Math.pow,p=Math.log,g=r.extend({type:"log",base:10,$constructor:function(){r.apply(this,arguments),this._originalScale=new o},getTicks:function(){var e=this._originalScale,t=this._extent,n=e.getExtent();return i.map(l.getTicks.call(this),function(i){var r=a.round(h(this.base,i));return r=i===t[0]&&e.__fixMin?m(r,n[0]):r,r=i===t[1]&&e.__fixMax?m(r,n[1]):r,r},this)},getLabel:l.getLabel,scale:function(e){return e=s.scale.call(this,e),h(this.base,e)},setExtent:function(e,t){var n=this.base;e=p(e)/p(n),t=p(t)/p(n),l.setExtent.call(this,e,t)},getExtent:function(){var e=this.base,t=s.getExtent.call(this);t[0]=h(e,t[0]),t[1]=h(e,t[1]);var n=this._originalScale,i=n.getExtent();return n.__fixMin&&(t[0]=m(t[0],i[0])),n.__fixMax&&(t[1]=m(t[1],i[1])),t},unionExtent:function(e){this._originalScale.unionExtent(e);var t=this.base;e[0]=p(e[0])/p(t),e[1]=p(e[1])/p(t),s.unionExtent.call(this,e)},unionExtentFromData:function(e,t){this.unionExtent(e.getApproximateExtent(t))},niceTicks:function(e){e=e||10;var t=this._extent,n=t[1]-t[0];if(!(n===1/0||n<=0)){var i=a.quantity(n),r=e/n*i;r<=.5&&(i*=10);while(!isNaN(i)&&Math.abs(i)<1&&Math.abs(i)>0)i*=10;var o=[a.round(f(t[0]/i)*i),a.round(d(t[1]/i)*i)];this._interval=i,this._niceExtent=o}},niceExtent:function(e){l.niceExtent.call(this,e);var t=this._originalScale;t.__fixMin=e.fixMin,t.__fixMax=e.fixMax}});function m(e,t){return c(e,u(t))}i.each(["contain","normalize"],function(e){g.prototype[e]=function(t){return t=p(t)/p(this.base),s[e].call(this,t)}}),g.create=function(){return new g};var v=g;e.exports=v},"8d32":function(e,t,n){var i=n("cbe5"),r=i.extend({type:"arc",shape:{cx:0,cy:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},style:{stroke:"#000",fill:null},buildPath:function(e,t){var n=t.cx,i=t.cy,r=Math.max(t.r,0),a=t.startAngle,o=t.endAngle,s=t.clockwise,l=Math.cos(a),u=Math.sin(a);e.moveTo(l*r+n,u*r+i),e.arc(n,i,r,a,o,!s)}});e.exports=r},"8e43":function(e,t,n){var i=n("6d8b"),r=i.createHashMap,a=i.isObject,o=i.map;function s(e){this.categories=e.categories||[],this._needCollect=e.needCollect,this._deduplication=e.deduplication,this._map}s.createByAxisModel=function(e){var t=e.option,n=t.data,i=n&&o(n,c);return new s({categories:i,needCollect:!i,deduplication:!1!==t.dedplication})};var l=s.prototype;function u(e){return e._map||(e._map=r(e.categories))}function c(e){return a(e)&&null!=e.value?e.value:e+""}l.getOrdinal=function(e){return u(this).get(e)},l.parseAndCollect=function(e){var t,n=this._needCollect;if("string"!==typeof e&&!n)return e;if(n&&!this._deduplication)return t=this.categories.length,this.categories[t]=e,t;var i=u(this);return t=i.get(e),null==t&&(n?(t=this.categories.length,this.categories[t]=e,i.set(e,t)):t=NaN),t};var d=s;e.exports=d},"8ec5":function(e,t,n){var i=n("3eba"),r=n("6d8b"),a=n("2145"),o=i.extendComponentModel({type:"toolbox",layoutMode:{type:"box",ignoreSize:!0},optionUpdated:function(){o.superApply(this,"optionUpdated",arguments),r.each(this.option.feature,function(e,t){var n=a.get(t);n&&r.merge(e,n.defaultOption)})},defaultOption:{show:!0,z:6,zlevel:0,orient:"horizontal",left:"right",top:"top",backgroundColor:"transparent",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemSize:15,itemGap:8,showTitle:!0,iconStyle:{borderColor:"#666",color:"none"},emphasis:{iconStyle:{borderColor:"#3E98C5"}}}}),s=o;e.exports=s},"8ed2":function(e,t,n){n("48c7");var i=n("6cb7"),r=i.extend({type:"grid",dependencies:["xAxis","yAxis"],layoutMode:"box",coordinateSystem:null,defaultOption:{show:!1,zlevel:0,z:0,left:"10%",top:60,right:"10%",bottom:60,containLabel:!1,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderColor:"#ccc"}});e.exports=r},"903c":function(e,t){function n(e){var t=e.findComponents({mainType:"legend"});t&&t.length&&e.filterSeries(function(e){for(var n=0;n<t.length;n++)if(!t[n].isSelected(e.name))return!1;return!0})}e.exports=n},9093:function(e,t,n){var i=n("ce10"),r=n("e11e").concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return i(e,r)}},9152:function(e,t){t.read=function(e,t,n,i,r){var a,o,s=8*r-i-1,l=(1<<s)-1,u=l>>1,c=-7,d=n?r-1:0,f=n?-1:1,h=e[t+d];for(d+=f,a=h&(1<<-c)-1,h>>=-c,c+=s;c>0;a=256*a+e[t+d],d+=f,c-=8);for(o=a&(1<<-c)-1,a>>=-c,c+=i;c>0;o=256*o+e[t+d],d+=f,c-=8);if(0===a)a=1-u;else{if(a===l)return o?NaN:1/0*(h?-1:1);o+=Math.pow(2,i),a-=u}return(h?-1:1)*o*Math.pow(2,a-i)},t.write=function(e,t,n,i,r,a){var o,s,l,u=8*a-r-1,c=(1<<u)-1,d=c>>1,f=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,h=i?0:a-1,p=i?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),t+=o+d>=1?f/l:f*Math.pow(2,1-d),t*l>=2&&(o++,l/=2),o+d>=c?(s=0,o=c):o+d>=1?(s=(t*l-1)*Math.pow(2,r),o+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,r),o=0));r>=8;e[n+h]=255&s,h+=p,s/=256,r-=8);for(o=o<<r|s,u+=r;u>0;e[n+h]=255&o,h+=p,o/=256,u-=8);e[n+h-p]|=128*g}},"93d0":function(e,t){var n="original",i="arrayRows",r="objectRows",a="keyedColumns",o="unknown",s="typedArray",l="column",u="row";t.SOURCE_FORMAT_ORIGINAL=n,t.SOURCE_FORMAT_ARRAY_ROWS=i,t.SOURCE_FORMAT_OBJECT_ROWS=r,t.SOURCE_FORMAT_KEYED_COLUMNS=a,t.SOURCE_FORMAT_UNKNOWN=o,t.SOURCE_FORMAT_TYPED_ARRAY=s,t.SERIES_LAYOUT_BY_COLUMN=l,t.SERIES_LAYOUT_BY_ROW=u},"944e":function(e,t,n){var i=n("3842"),r=i.round;function a(e,t,n,a){var s={},u=e[1]-e[0],c=s.interval=i.nice(u/t,!0);null!=n&&c<n&&(c=s.interval=n),null!=a&&c>a&&(c=s.interval=a);var d=s.intervalPrecision=o(c),f=s.niceTickExtent=[r(Math.ceil(e[0]/c)*c,d),r(Math.floor(e[1]/c)*c,d)];return l(f,e),s}function o(e){return i.getPrecisionSafe(e)+2}function s(e,t,n){e[t]=Math.max(Math.min(e[t],n[1]),n[0])}function l(e,t){!isFinite(e[0])&&(e[0]=t[0]),!isFinite(e[1])&&(e[1]=t[1]),s(e,0,t),s(e,1,t),e[0]>e[1]&&(e[0]=e[1])}function u(e,t,n,i){var a=[];if(!e)return a;var o=1e4;t[0]<n[0]&&a.push(t[0]);var s=n[0];while(s<=n[1]){if(a.push(s),s=r(s+e,i),s===a[a.length-1])break;if(a.length>o)return[]}return t[1]>(a.length?a[a.length-1]:n[1])&&a.push(t[1]),a}t.intervalScaleNiceTicks=a,t.getIntervalPrecision=o,t.fixExtent=l,t.intervalScaleGetTicks=u},"94b1":function(e,t,n){var i=n("3eba"),r=n("6d8b"),a=n("9d57"),o=a.layout,s=a.largeLayout;n("5aa9"),n("17b8"),n("67cc"),n("01ed"),i.registerLayout(r.curry(o,"bar")),i.registerLayout(s),i.registerVisual({seriesType:"bar",reset:function(e){e.getData().setVisual("legendSymbol","roundRect")}})},9680:function(e,t){function n(e,t,n,i,r,a,o){if(0===r)return!1;var s=r,l=0,u=e;if(o>t+s&&o>i+s||o<t-s&&o<i-s||a>e+s&&a>n+s||a<e-s&&a<n-s)return!1;if(e===n)return Math.abs(a-e)<=s/2;l=(t-i)/(e-n),u=(e*i-n*t)/(e-n);var c=l*a-o+u,d=c*c/(l*l+1);return d<=s/2*s/2}t.containStroke=n},"96cf":function(e,t,n){var i=function(e){"use strict";var t,n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"===typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function c(e,t,n,i){var a=t&&t.prototype instanceof v?t:v,o=Object.create(a.prototype),s=new D(i||[]);return r(o,"_invoke",{value:I(e,n,s)}),o}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var f="suspendedStart",h="suspendedYield",p="executing",g="completed",m={};function v(){}function y(){}function _(){}var b={};u(b,o,function(){return this});var E=Object.getPrototypeOf,T=E&&E(E(k([])));T&&T!==n&&i.call(T,o)&&(b=T);var S=_.prototype=v.prototype=Object.create(b);function w(e){["next","throw","return"].forEach(function(t){u(e,t,function(e){return this._invoke(t,e)})})}function A(e,t){function n(r,a,o,s){var l=d(e[r],e,a);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"===typeof c&&i.call(c,"__await")?t.resolve(c.__await).then(function(e){n("next",e,o,s)},function(e){n("throw",e,o,s)}):t.resolve(c).then(function(e){u.value=e,o(u)},function(e){return n("throw",e,o,s)})}s(l.arg)}var a;function o(e,i){function r(){return new t(function(t,r){n(e,i,t,r)})}return a=a?a.then(r,r):r()}r(this,"_invoke",{value:o})}function I(e,t,n){var i=f;return function(r,a){if(i===p)throw new Error("Generator is already running");if(i===g){if("throw"===r)throw a;return M()}n.method=r,n.arg=a;while(1){var o=n.delegate;if(o){var s=x(o,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=d(e,t,n);if("normal"===l.type){if(i=n.done?g:h,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=g,n.method="throw",n.arg=l.arg)}}}function x(e,n){var i=n.method,r=e.iterator[i];if(r===t)return n.delegate=null,"throw"===i&&e.iterator["return"]&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method)?m:("return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),m);var a=d(r,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,m;var o=a.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function R(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(R,this),this.reset(!0)}function k(e){if(null!=e){var n=e[o];if(n)return n.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function n(){while(++r<e.length)if(i.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(typeof e+" is not iterable")}function M(){return{value:t,done:!0}}return y.prototype=_,r(S,"constructor",{value:_,configurable:!0}),r(_,"constructor",{value:y,configurable:!0}),y.displayName=u(_,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,u(e,l,"GeneratorFunction")),e.prototype=Object.create(S),e},e.awrap=function(e){return{__await:e}},w(A.prototype),u(A.prototype,s,function(){return this}),e.AsyncIterator=A,e.async=function(t,n,i,r,a){void 0===a&&(a=Promise);var o=new A(c(t,n,i,r),a);return e.isGeneratorFunction(n)?o:o.next().then(function(e){return e.done?e.value:o.next()})},w(S),u(S,l,"Generator"),u(S,o,function(){return this}),u(S,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),n=[];for(var i in t)n.push(i);return n.reverse(),function e(){while(n.length){var i=n.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},e.values=k,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(i,r){return s.type="throw",s.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var l=i.call(o,"catchLoc"),u=i.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;C(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:k(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=i}catch(e){"object"===typeof globalThis?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}},9850:function(e,t,n){var i=n("401b"),r=n("1687"),a=i.applyTransform,o=Math.min,s=Math.max;function l(e,t,n,i){n<0&&(e+=n,n=-n),i<0&&(t+=i,i=-i),this.x=e,this.y=t,this.width=n,this.height=i}l.prototype={constructor:l,union:function(e){var t=o(e.x,this.x),n=o(e.y,this.y);this.width=s(e.x+e.width,this.x+this.width)-t,this.height=s(e.y+e.height,this.y+this.height)-n,this.x=t,this.y=n},applyTransform:function(){var e=[],t=[],n=[],i=[];return function(r){if(r){e[0]=n[0]=this.x,e[1]=i[1]=this.y,t[0]=i[0]=this.x+this.width,t[1]=n[1]=this.y+this.height,a(e,e,r),a(t,t,r),a(n,n,r),a(i,i,r),this.x=o(e[0],t[0],n[0],i[0]),this.y=o(e[1],t[1],n[1],i[1]);var l=s(e[0],t[0],n[0],i[0]),u=s(e[1],t[1],n[1],i[1]);this.width=l-this.x,this.height=u-this.y}}}(),calculateTransform:function(e){var t=this,n=e.width/t.width,i=e.height/t.height,a=r.create();return r.translate(a,a,[-t.x,-t.y]),r.scale(a,a,[n,i]),r.translate(a,a,[e.x,e.y]),a},intersect:function(e){if(!e)return!1;e instanceof l||(e=l.create(e));var t=this,n=t.x,i=t.x+t.width,r=t.y,a=t.y+t.height,o=e.x,s=e.x+e.width,u=e.y,c=e.y+e.height;return!(i<o||s<n||a<u||c<r)},contain:function(e,t){var n=this;return e>=n.x&&e<=n.x+n.width&&t>=n.y&&t<=n.y+n.height},clone:function(){return new l(this.x,this.y,this.width,this.height)},copy:function(e){this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height},plain:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}}},l.create=function(e){return new l(e.x,e.y,e.width,e.height)};var u=l;e.exports=u},"98b7":function(e,t){var n="undefined"!==typeof window&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(e){setTimeout(e,16)};e.exports=n},"998c":function(e,t,n){var i=n("6d8b"),r=n("2306"),a=Math.PI;function o(e,t){t=t||{},i.defaults(t,{text:"loading",color:"#c23531",textColor:"#000",maskColor:"rgba(255, 255, 255, 0.8)",zlevel:0});var n=new r.Rect({style:{fill:t.maskColor},zlevel:t.zlevel,z:1e4}),o=new r.Arc({shape:{startAngle:-a/2,endAngle:-a/2+.1,r:10},style:{stroke:t.color,lineCap:"round",lineWidth:5},zlevel:t.zlevel,z:10001}),s=new r.Rect({style:{fill:"none",text:t.text,textPosition:"right",textDistance:10,textFill:t.textColor},zlevel:t.zlevel,z:10001});o.animateShape(!0).when(1e3,{endAngle:3*a/2}).start("circularInOut"),o.animateShape(!0).when(1e3,{startAngle:3*a/2}).delay(300).start("circularInOut");var l=new r.Group;return l.add(o),l.add(s),l.add(n),l.resize=function(){var t=e.getWidth()/2,i=e.getHeight()/2;o.setShape({cx:t,cy:i});var r=o.shape.r;s.setShape({x:t-r,y:i-r,width:2*r,height:2*r}),n.setShape({x:0,y:0,width:e.getWidth(),height:e.getHeight()})},l.resize(),l}e.exports=o},"9b43":function(e,t,n){var i=n("d8e8");e.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)}}return function(){return e.apply(t,arguments)}}},"9bdb":function(e,t,n){var i=n("282b"),r=i([["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]]),a={getAreaStyle:function(e,t){return r(this,e,t)}};e.exports=a},"9c2c":function(e,t,n){var i=n("401b"),r=i.min,a=i.max,o=i.scale,s=i.distance,l=i.add,u=i.clone,c=i.sub;function d(e,t,n,i){var d,f,h,p,g=[],m=[],v=[],y=[];if(i){h=[1/0,1/0],p=[-1/0,-1/0];for(var _=0,b=e.length;_<b;_++)r(h,h,e[_]),a(p,p,e[_]);r(h,h,i[0]),a(p,p,i[1])}for(_=0,b=e.length;_<b;_++){var E=e[_];if(n)d=e[_?_-1:b-1],f=e[(_+1)%b];else{if(0===_||_===b-1){g.push(u(e[_]));continue}d=e[_-1],f=e[_+1]}c(m,f,d),o(m,m,t);var T=s(E,d),S=s(E,f),w=T+S;0!==w&&(T/=w,S/=w),o(v,m,-T),o(y,m,S);var A=l([],E,v),I=l([],E,y);i&&(a(A,A,h),r(A,A,p),a(I,I,h),r(I,I,p)),g.push(A),g.push(I)}return n&&g.push(g.shift()),g}e.exports=d},"9c6c":function(e,t,n){var i=n("2b4c")("unscopables"),r=Array.prototype;void 0==r[i]&&n("32e9")(r,i,{}),e.exports=function(e){r[i][e]=!0}},"9c80":function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},"9d57":function(e,t,n){var i=n("6d8b"),r=n("3842"),a=r.parsePercent,o=n("ee1a"),s=o.isDimensionStacked,l=n("cccd"),u="__ec_stack_",c=.5,d="undefined"!==typeof Float32Array?Float32Array:Array;function f(e){return e.get("stack")||u+e.seriesIndex}function h(e){return e.dim+e.index}function p(e){var t=[],n=e.axis,r="axis0";if("category"===n.type){for(var a=n.getBandWidth(),o=0;o<e.count;o++)t.push(i.defaults({bandWidth:a,axisKey:r,stackId:u+o},e));var s=v(t),l=[];for(o=0;o<e.count;o++){var c=s[r][u+o];c.offsetCenter=c.offset+c.width/2,l.push(c)}return l}}function g(e,t){var n=[];return t.eachSeriesByType(e,function(e){E(e)&&!T(e)&&n.push(e)}),n}function m(e){var t=[];return i.each(e,function(e){var n=e.getData(),i=e.coordinateSystem,r=i.getBaseAxis(),o=r.getExtent(),s="category"===r.type?r.getBandWidth():Math.abs(o[1]-o[0])/n.count(),l=a(e.get("barWidth"),s),u=a(e.get("barMaxWidth"),s),c=e.get("barGap"),d=e.get("barCategoryGap");t.push({bandWidth:s,barWidth:l,barMaxWidth:u,barGap:c,barCategoryGap:d,axisKey:h(r),stackId:f(e)})}),v(t)}function v(e){var t={};i.each(e,function(e,n){var i=e.axisKey,r=e.bandWidth,a=t[i]||{bandWidth:r,remainedWidth:r,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},o=a.stacks;t[i]=a;var s=e.stackId;o[s]||a.autoWidthCount++,o[s]=o[s]||{width:0,maxWidth:0};var l=e.barWidth;l&&!o[s].width&&(o[s].width=l,l=Math.min(a.remainedWidth,l),a.remainedWidth-=l);var u=e.barMaxWidth;u&&(o[s].maxWidth=u);var c=e.barGap;null!=c&&(a.gap=c);var d=e.barCategoryGap;null!=d&&(a.categoryGap=d)});var n={};return i.each(t,function(e,t){n[t]={};var r=e.stacks,o=e.bandWidth,s=a(e.categoryGap,o),l=a(e.gap,1),u=e.remainedWidth,c=e.autoWidthCount,d=(u-s)/(c+(c-1)*l);d=Math.max(d,0),i.each(r,function(e,t){var n=e.maxWidth;n&&n<d&&(n=Math.min(n,u),e.width&&(n=Math.min(n,e.width)),u-=n,e.width=n,c--)}),d=(u-s)/(c+(c-1)*l),d=Math.max(d,0);var f,h=0;i.each(r,function(e,t){e.width||(e.width=d),f=e,h+=e.width*(1+l)}),f&&(h-=f.width*l);var p=-h/2;i.each(r,function(e,i){n[t][i]=n[t][i]||{offset:p,width:e.width},p+=e.width*(1+l)})}),n}function y(e,t,n){if(e&&t){var i=e[h(t)];return null!=i&&null!=n&&(i=i[f(n)]),i}}function _(e,t){var n=g(e,t),r=m(n),a={},o={};i.each(n,function(e){var t=e.getData(),n=e.coordinateSystem,i=n.getBaseAxis(),l=f(e),u=r[h(i)][l],c=u.offset,d=u.width,p=n.getOtherAxis(i),g=e.get("barMinHeight")||0;a[l]=a[l]||[],o[l]=o[l]||[],t.setLayout({offset:c,size:d});for(var m=t.mapDimension(p.dim),v=t.mapDimension(i.dim),y=s(t,m),_=p.isHorizontal(),b=S(i,p,y),E=0,T=t.count();E<T;E++){var w=t.get(m,E),A=t.get(v,E);if(!isNaN(w)){var I,x,R,C,D=w>=0?"p":"n",k=b;if(y&&(a[l][A]||(a[l][A]={p:b,n:b}),k=a[l][A][D]),_){var M=n.dataToPoint([w,A]);I=k,x=M[1]+c,R=M[0]-b,C=d,Math.abs(R)<g&&(R=(R<0?-1:1)*g),y&&(a[l][A][D]+=R)}else{M=n.dataToPoint([A,w]);I=M[0]+c,x=k,R=d,C=M[1]-b,Math.abs(C)<g&&(C=(C<=0?-1:1)*g),y&&(a[l][A][D]+=C)}t.setItemLayout(E,{x:I,y:x,width:R,height:C})}}},this)}var b={seriesType:"bar",plan:l(),reset:function(e){if(E(e)&&T(e)){var t=e.getData(),n=e.coordinateSystem,i=n.getBaseAxis(),r=n.getOtherAxis(i),a=t.mapDimension(r.dim),o=t.mapDimension(i.dim),s=r.isHorizontal(),l=s?0:1,u=y(m([e]),i,e).width;return u>c||(u=c),{progress:f}}function f(e,t){var c,f=new d(2*e.count),h=[],p=[],g=0;while(null!=(c=e.next()))p[l]=t.get(a,c),p[1-l]=t.get(o,c),h=n.dataToPoint(p,null,h),f[g++]=h[0],f[g++]=h[1];t.setLayout({largePoints:f,barWidth:u,valueAxisStart:S(i,r,!1),valueAxisHorizontal:s})}}};function E(e){return e.coordinateSystem&&"cartesian2d"===e.coordinateSystem.type}function T(e){return e.pipelineContext&&e.pipelineContext.large}function S(e,t,n){return i.indexOf(e.getAxesOnZeroOf(),t)>=0||n?t.toGlobalCoord(t.dataToCoord(0)):t.getGlobalExtent()[0]}t.getLayoutOnAxis=p,t.prepareLayoutBarSeries=g,t.makeColumnLayout=m,t.retrieveColumnLayout=y,t.layout=_,t.largeLayout=b},"9def":function(e,t,n){var i=n("4588"),r=Math.min;e.exports=function(e){return e>0?r(i(e),9007199254740991):0}},"9e1e":function(e,t,n){e.exports=!n("79e5")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},"9e2e":function(e,t,n){var i=n("a73c"),r=n("9850"),a=new r,o=function(){};o.prototype={constructor:o,drawRectText:function(e,t){var n=this.style;t=n.textRect||t,this.__dirty&&i.normalizeTextStyle(n,!0);var r=n.text;if(null!=r&&(r+=""),i.needDrawText(r,n)){e.save();var o=this.transform;n.transformText?this.setTransform(e):o&&(a.copy(t),a.applyTransform(o),t=a),i.renderText(this,e,r,n,t),e.restore()}}};var s=o;e.exports=s},"9e47":function(e,t,n){var i=n("6d8b"),r=n("71ad"),a=n("6cb7"),o=n("f934"),s=o.getLayoutParams,l=o.mergeLayoutParam,u=n("8e43"),c=["value","category","time","log"];function d(e,t,n,o){i.each(c,function(a){t.extend({type:e+"Axis."+a,mergeDefaultAndTheme:function(t,r){var o=this.layoutMode,u=o?s(t):{},c=r.getTheme();i.merge(t,c.get(a+"Axis")),i.merge(t,this.getDefaultOption()),t.type=n(e,t),o&&l(t,u,o)},optionUpdated:function(){var e=this.option;"category"===e.type&&(this.__ordinalMeta=u.createByAxisModel(this))},getCategories:function(e){var t=this.option;if("category"===t.type)return e?t.data:this.__ordinalMeta.categories},getOrdinalMeta:function(){return this.__ordinalMeta},defaultOption:i.mergeAll([{},r[a+"Axis"],o],!0)})}),a.registerSubTypeDefaulter(e+"Axis",i.curry(n,e))}e.exports=d},"9e87":function(e,t,n){var i=n("3eba"),r=n("6d8b"),a=n("50e5");i.registerAction("dataZoom",function(e,t){var n=a.createLinkedNodesFinder(r.bind(t.eachComponent,t,"dataZoom"),a.eachAxisDim,function(e,t){return e.get(t.axisIndex)}),i=[];t.eachComponent({mainType:"dataZoom",query:e},function(e,t){i.push.apply(i,n(e).nodes)}),r.each(i,function(t,n){t.setRawRange({start:e.start,end:e.end,startValue:e.startValue,endValue:e.endValue})})})},"9f51":function(e,t,n){var i=n("857d"),r=i.normalizeRadian,a=2*Math.PI;function o(e,t,n,i,o,s,l,u,c){if(0===l)return!1;var d=l;u-=e,c-=t;var f=Math.sqrt(u*u+c*c);if(f-d>n||f+d<n)return!1;if(Math.abs(i-o)%a<1e-4)return!0;if(s){var h=i;i=r(o),o=r(h)}else i=r(i),o=r(o);i>o&&(o+=a);var p=Math.atan2(c,u);return p<0&&(p+=a),p>=i&&p<=o||p+a>=i&&p+a<=o}t.containStroke=o},"9f82":function(e,t,n){var i=n("ee1a"),r=i.isDimensionStacked,a=n("6d8b"),o=a.map;function s(e,t,n){var i,a=e.getBaseAxis(),s=e.getOtherAxis(a),u=l(s,n),c=a.dim,d=s.dim,f=t.mapDimension(d),h=t.mapDimension(c),p="x"===d||"radius"===d?1:0,g=o(e.dimensions,function(e){return t.mapDimension(e)}),m=t.getCalculationInfo("stackResultDimension");return(i|=r(t,g[0]))&&(g[0]=m),(i|=r(t,g[1]))&&(g[1]=m),{dataDimsForPoint:g,valueStart:u,valueAxisDim:d,baseAxisDim:c,stacked:!!i,valueDim:f,baseDim:h,baseDataOffset:p,stackedOverDimension:t.getCalculationInfo("stackedOverDimension")}}function l(e,t){var n=0,i=e.scale.getExtent();return"start"===t?n=i[0]:"end"===t?n=i[1]:i[0]>0?n=i[0]:i[1]<0&&(n=i[1]),n}function u(e,t,n,i){var r=NaN;e.stacked&&(r=n.get(n.getCalculationInfo("stackedOverDimension"),i)),isNaN(r)&&(r=e.valueStart);var a=e.baseDataOffset,o=[];return o[a]=n.get(e.baseDim,i),o[1-a]=r,t.dataToPoint(o)}t.prepareDataCoordInfo=s,t.getStackedOnPoint=u},a15a:function(e,t,n){var i=n("6d8b"),r=n("2306"),a=n("9850"),o=r.extendShape({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(e,t){var n=t.cx,i=t.cy,r=t.width/2,a=t.height/2;e.moveTo(n,i-a),e.lineTo(n+r,i+a),e.lineTo(n-r,i+a),e.closePath()}}),s=r.extendShape({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(e,t){var n=t.cx,i=t.cy,r=t.width/2,a=t.height/2;e.moveTo(n,i-a),e.lineTo(n+r,i),e.lineTo(n,i+a),e.lineTo(n-r,i),e.closePath()}}),l=r.extendShape({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(e,t){var n=t.x,i=t.y,r=t.width/5*3,a=Math.max(r,t.height),o=r/2,s=o*o/(a-o),l=i-a+o+s,u=Math.asin(s/o),c=Math.cos(u)*o,d=Math.sin(u),f=Math.cos(u),h=.6*o,p=.7*o;e.moveTo(n-c,l+s),e.arc(n,l,o,Math.PI-u,2*Math.PI+u),e.bezierCurveTo(n+c-d*h,l+s+f*h,n,i-p,n,i),e.bezierCurveTo(n,i-p,n-c+d*h,l+s+f*h,n-c,l+s),e.closePath()}}),u=r.extendShape({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(e,t){var n=t.height,i=t.width,r=t.x,a=t.y,o=i/3*2;e.moveTo(r,a),e.lineTo(r+o,a+n),e.lineTo(r,a+n/4*3),e.lineTo(r-o,a+n),e.lineTo(r,a),e.closePath()}}),c={line:r.Line,rect:r.Rect,roundRect:r.Rect,square:r.Rect,circle:r.Circle,diamond:s,pin:l,arrow:u,triangle:o},d={line:function(e,t,n,i,r){r.x1=e,r.y1=t+i/2,r.x2=e+n,r.y2=t+i/2},rect:function(e,t,n,i,r){r.x=e,r.y=t,r.width=n,r.height=i},roundRect:function(e,t,n,i,r){r.x=e,r.y=t,r.width=n,r.height=i,r.r=Math.min(n,i)/4},square:function(e,t,n,i,r){var a=Math.min(n,i);r.x=e,r.y=t,r.width=a,r.height=a},circle:function(e,t,n,i,r){r.cx=e+n/2,r.cy=t+i/2,r.r=Math.min(n,i)/2},diamond:function(e,t,n,i,r){r.cx=e+n/2,r.cy=t+i/2,r.width=n,r.height=i},pin:function(e,t,n,i,r){r.x=e+n/2,r.y=t+i/2,r.width=n,r.height=i},arrow:function(e,t,n,i,r){r.x=e+n/2,r.y=t+i/2,r.width=n,r.height=i},triangle:function(e,t,n,i,r){r.cx=e+n/2,r.cy=t+i/2,r.width=n,r.height=i}},f={};i.each(c,function(e,t){f[t]=new e});var h=r.extendShape({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},beforeBrush:function(){var e=this.style,t=this.shape;"pin"===t.symbolType&&"inside"===e.textPosition&&(e.textPosition=["50%","40%"],e.textAlign="center",e.textVerticalAlign="middle")},buildPath:function(e,t,n){var i=t.symbolType,r=f[i];"none"!==t.symbolType&&(r||(i="rect",r=f[i]),d[i](t.x,t.y,t.width,t.height,r.shape),r.buildPath(e,r.shape,n))}});function p(e,t){if("image"!==this.type){var n=this.style,i=this.shape;i&&"line"===i.symbolType?n.stroke=e:this.__isEmptyBrush?(n.stroke=e,n.fill=t||"#fff"):(n.fill&&(n.fill=e),n.stroke&&(n.stroke=e)),this.dirty(!1)}}function g(e,t,n,i,o,s,l){var u,c=0===e.indexOf("empty");return c&&(e=e.substr(5,1).toLowerCase()+e.substr(6)),u=0===e.indexOf("image://")?r.makeImage(e.slice(8),new a(t,n,i,o),l?"center":"cover"):0===e.indexOf("path://")?r.makePath(e.slice(7),{},new a(t,n,i,o),l?"center":"cover"):new h({shape:{symbolType:e,x:t,y:n,width:i,height:o}}),u.__isEmptyBrush=c,u.setColor=p,u.setColor(s),u}t.createSymbol=g},a25f:function(e,t,n){var i=n("7726"),r=i.navigator;e.exports=r&&r.userAgent||""},a481:function(e,t,n){n("214f")("replace",2,function(e,t,n){return[function(i,r){"use strict";var a=e(this),o=void 0==i?void 0:i[t];return void 0!==o?o.call(i,a,r):n.call(String(a),i,r)},n]})},a4fe:function(e,t,n){var i=n("3eba"),r="\0_ec_interaction_mutex";function a(e,t,n){var i=l(e);i[t]=n}function o(e,t,n){var i=l(e),r=i[t];r===n&&(i[t]=null)}function s(e,t){return!!l(e)[t]}function l(e){return e[r]||(e[r]={})}i.registerAction({type:"takeGlobalCursor",event:"globalCursorTaken",update:"update"},function(){}),t.take=a,t.release=o,t.isTaken=s},a567:function(e,t,n){"use strict";function i(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}n.d(t,"a",function(){return Il});var r={exports:{}};(function(e,t){(function(t){var n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,i=/^(?=([^\/?#]*))\1([^]*)$/,r=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,o={buildAbsoluteURL:function(e,t,n){if(n=n||{},e=e.trim(),t=t.trim(),!t){if(!n.alwaysNormalize)return e;var r=o.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=o.normalizePath(r.path),o.buildURLFromParts(r)}var a=o.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return n.alwaysNormalize?(a.path=o.normalizePath(a.path),o.buildURLFromParts(a)):t;var s=o.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var l=i.exec(s.path);s.netLoc=l[1],s.path=l[2]}s.netLoc&&!s.path&&(s.path="/");var u={scheme:s.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(u.netLoc=s.netLoc,"/"!==a.path[0]))if(a.path){var c=s.path,d=c.substring(0,c.lastIndexOf("/")+1)+a.path;u.path=o.normalizePath(d)}else u.path=s.path,a.params||(u.params=s.params,a.query||(u.query=s.query));return null===u.path&&(u.path=n.alwaysNormalize?o.normalizePath(a.path):a.path),o.buildURLFromParts(u)},parseURL:function(e){var t=n.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){e=e.split("").reverse().join("").replace(r,"");while(e.length!==(e=e.replace(a,"")).length);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};e.exports=o})()})(r);var a=r.exports;function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach(function(t){c(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function l(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function u(e){var t=l(e,"string");return"symbol"==typeof t?t:String(t)}function c(e,t,n){return t=u(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},d.apply(this,arguments)}const f=Number.isFinite||function(e){return"number"===typeof e&&isFinite(e)},h=Number.isSafeInteger||function(e){return"number"===typeof e&&Math.abs(e)<=p},p=Number.MAX_SAFE_INTEGER||9007199254740991;let g=function(e){return e["MEDIA_ATTACHING"]="hlsMediaAttaching",e["MEDIA_ATTACHED"]="hlsMediaAttached",e["MEDIA_DETACHING"]="hlsMediaDetaching",e["MEDIA_DETACHED"]="hlsMediaDetached",e["BUFFER_RESET"]="hlsBufferReset",e["BUFFER_CODECS"]="hlsBufferCodecs",e["BUFFER_CREATED"]="hlsBufferCreated",e["BUFFER_APPENDING"]="hlsBufferAppending",e["BUFFER_APPENDED"]="hlsBufferAppended",e["BUFFER_EOS"]="hlsBufferEos",e["BUFFER_FLUSHING"]="hlsBufferFlushing",e["BUFFER_FLUSHED"]="hlsBufferFlushed",e["MANIFEST_LOADING"]="hlsManifestLoading",e["MANIFEST_LOADED"]="hlsManifestLoaded",e["MANIFEST_PARSED"]="hlsManifestParsed",e["LEVEL_SWITCHING"]="hlsLevelSwitching",e["LEVEL_SWITCHED"]="hlsLevelSwitched",e["LEVEL_LOADING"]="hlsLevelLoading",e["LEVEL_LOADED"]="hlsLevelLoaded",e["LEVEL_UPDATED"]="hlsLevelUpdated",e["LEVEL_PTS_UPDATED"]="hlsLevelPtsUpdated",e["LEVELS_UPDATED"]="hlsLevelsUpdated",e["AUDIO_TRACKS_UPDATED"]="hlsAudioTracksUpdated",e["AUDIO_TRACK_SWITCHING"]="hlsAudioTrackSwitching",e["AUDIO_TRACK_SWITCHED"]="hlsAudioTrackSwitched",e["AUDIO_TRACK_LOADING"]="hlsAudioTrackLoading",e["AUDIO_TRACK_LOADED"]="hlsAudioTrackLoaded",e["SUBTITLE_TRACKS_UPDATED"]="hlsSubtitleTracksUpdated",e["SUBTITLE_TRACKS_CLEARED"]="hlsSubtitleTracksCleared",e["SUBTITLE_TRACK_SWITCH"]="hlsSubtitleTrackSwitch",e["SUBTITLE_TRACK_LOADING"]="hlsSubtitleTrackLoading",e["SUBTITLE_TRACK_LOADED"]="hlsSubtitleTrackLoaded",e["SUBTITLE_FRAG_PROCESSED"]="hlsSubtitleFragProcessed",e["CUES_PARSED"]="hlsCuesParsed",e["NON_NATIVE_TEXT_TRACKS_FOUND"]="hlsNonNativeTextTracksFound",e["INIT_PTS_FOUND"]="hlsInitPtsFound",e["FRAG_LOADING"]="hlsFragLoading",e["FRAG_LOAD_EMERGENCY_ABORTED"]="hlsFragLoadEmergencyAborted",e["FRAG_LOADED"]="hlsFragLoaded",e["FRAG_DECRYPTED"]="hlsFragDecrypted",e["FRAG_PARSING_INIT_SEGMENT"]="hlsFragParsingInitSegment",e["FRAG_PARSING_USERDATA"]="hlsFragParsingUserdata",e["FRAG_PARSING_METADATA"]="hlsFragParsingMetadata",e["FRAG_PARSED"]="hlsFragParsed",e["FRAG_BUFFERED"]="hlsFragBuffered",e["FRAG_CHANGED"]="hlsFragChanged",e["FPS_DROP"]="hlsFpsDrop",e["FPS_DROP_LEVEL_CAPPING"]="hlsFpsDropLevelCapping",e["MAX_AUTO_LEVEL_UPDATED"]="hlsMaxAutoLevelUpdated",e["ERROR"]="hlsError",e["DESTROYING"]="hlsDestroying",e["KEY_LOADING"]="hlsKeyLoading",e["KEY_LOADED"]="hlsKeyLoaded",e["LIVE_BACK_BUFFER_REACHED"]="hlsLiveBackBufferReached",e["BACK_BUFFER_REACHED"]="hlsBackBufferReached",e["STEERING_MANIFEST_LOADED"]="hlsSteeringManifestLoaded",e}({}),m=function(e){return e["NETWORK_ERROR"]="networkError",e["MEDIA_ERROR"]="mediaError",e["KEY_SYSTEM_ERROR"]="keySystemError",e["MUX_ERROR"]="muxError",e["OTHER_ERROR"]="otherError",e}({}),v=function(e){return e["KEY_SYSTEM_NO_KEYS"]="keySystemNoKeys",e["KEY_SYSTEM_NO_ACCESS"]="keySystemNoAccess",e["KEY_SYSTEM_NO_SESSION"]="keySystemNoSession",e["KEY_SYSTEM_NO_CONFIGURED_LICENSE"]="keySystemNoConfiguredLicense",e["KEY_SYSTEM_LICENSE_REQUEST_FAILED"]="keySystemLicenseRequestFailed",e["KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED"]="keySystemServerCertificateRequestFailed",e["KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED"]="keySystemServerCertificateUpdateFailed",e["KEY_SYSTEM_SESSION_UPDATE_FAILED"]="keySystemSessionUpdateFailed",e["KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED"]="keySystemStatusOutputRestricted",e["KEY_SYSTEM_STATUS_INTERNAL_ERROR"]="keySystemStatusInternalError",e["MANIFEST_LOAD_ERROR"]="manifestLoadError",e["MANIFEST_LOAD_TIMEOUT"]="manifestLoadTimeOut",e["MANIFEST_PARSING_ERROR"]="manifestParsingError",e["MANIFEST_INCOMPATIBLE_CODECS_ERROR"]="manifestIncompatibleCodecsError",e["LEVEL_EMPTY_ERROR"]="levelEmptyError",e["LEVEL_LOAD_ERROR"]="levelLoadError",e["LEVEL_LOAD_TIMEOUT"]="levelLoadTimeOut",e["LEVEL_PARSING_ERROR"]="levelParsingError",e["LEVEL_SWITCH_ERROR"]="levelSwitchError",e["AUDIO_TRACK_LOAD_ERROR"]="audioTrackLoadError",e["AUDIO_TRACK_LOAD_TIMEOUT"]="audioTrackLoadTimeOut",e["SUBTITLE_LOAD_ERROR"]="subtitleTrackLoadError",e["SUBTITLE_TRACK_LOAD_TIMEOUT"]="subtitleTrackLoadTimeOut",e["FRAG_LOAD_ERROR"]="fragLoadError",e["FRAG_LOAD_TIMEOUT"]="fragLoadTimeOut",e["FRAG_DECRYPT_ERROR"]="fragDecryptError",e["FRAG_PARSING_ERROR"]="fragParsingError",e["FRAG_GAP"]="fragGap",e["REMUX_ALLOC_ERROR"]="remuxAllocError",e["KEY_LOAD_ERROR"]="keyLoadError",e["KEY_LOAD_TIMEOUT"]="keyLoadTimeOut",e["BUFFER_ADD_CODEC_ERROR"]="bufferAddCodecError",e["BUFFER_INCOMPATIBLE_CODECS_ERROR"]="bufferIncompatibleCodecsError",e["BUFFER_APPEND_ERROR"]="bufferAppendError",e["BUFFER_APPENDING_ERROR"]="bufferAppendingError",e["BUFFER_STALLED_ERROR"]="bufferStalledError",e["BUFFER_FULL_ERROR"]="bufferFullError",e["BUFFER_SEEK_OVER_HOLE"]="bufferSeekOverHole",e["BUFFER_NUDGE_ON_STALL"]="bufferNudgeOnStall",e["INTERNAL_EXCEPTION"]="internalException",e["INTERNAL_ABORTED"]="aborted",e["UNKNOWN"]="unknown",e}({});const y=function(){},_={trace:y,debug:y,log:y,warn:y,info:y,error:y};let b=_;function E(e){const t=self.console[e];return t?t.bind(self.console,`[${e}] >`):y}function T(e,...t){t.forEach(function(t){b[t]=e[t]?e[t].bind(e):E(t)})}function S(e,t){if("object"===typeof console&&!0===e||"object"===typeof e){T(e,"debug","log","info","warn","error");try{b.log(`Debug logs enabled for "${t}" in hls.js version 1.5.14`)}catch(e){b=_}}else b=_}const w=b,A=/^(\d+)x(\d+)$/,I=/(.+?)=(".*?"|.*?)(?:,|$)/g;class x{constructor(e){"string"===typeof e&&(e=x.parseAttrList(e)),d(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>"X-"===e.substring(0,2))}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;const n=new Uint8Array(t.length/2);for(let e=0;e<t.length/2;e++)n[e]=parseInt(t.slice(2*e,2*e+2),16);return n}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}bool(e){return"YES"===this[e]}decimalResolution(e){const t=A.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;const n={},i='"';I.lastIndex=0;while(null!==(t=I.exec(e))){let e=t[2];0===e.indexOf(i)&&e.lastIndexOf(i)===e.length-1&&(e=e.slice(1,-1));const r=t[1].trim();n[r]=e}return n}}function R(e){return"ID"!==e&&"CLASS"!==e&&"START-DATE"!==e&&"DURATION"!==e&&"END-DATE"!==e&&"END-ON-NEXT"!==e}function C(e){return"SCTE35-OUT"===e||"SCTE35-IN"===e}class D{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){const n=t.attr;for(const t in n)if(Object.prototype.hasOwnProperty.call(e,t)&&e[t]!==n[t]){w.warn(`DATERANGE tag attribute: "${t}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=t;break}e=d(new x({}),n,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const e=new Date(this.attr["END-DATE"]);f(e.getTime())&&(this._endDate=e)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return null!==e?new Date(this._startDate.getTime()+1e3*e):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(f(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&f(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class k{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var M={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class L{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[M.AUDIO]:null,[M.VIDEO]:null,[M.AUDIOVIDEO]:null},this.baseurl=e}setByteRange(e,t){const n=e.split("@",2);let i;i=1===n.length?(null==t?void 0:t.byteRangeEndOffset)||0:parseInt(n[1]),this._byteRange=[i,parseInt(n[0])+i]}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=a.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class P extends L{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new k,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const e=this.levelkeys.identity;if(e)this._decryptdata=e.getDecryptData(this.sn);else{const e=Object.keys(this.levelkeys);if(1===e.length)return this._decryptdata=this.levelkeys[e[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(null===this.programDateTime)return null;if(!f(this.programDateTime))return null;const e=f(this.duration)?this.duration:0;return this.programDateTime+1e3*e}get encrypted(){var e;if(null!=(e=this._decryptdata)&&e.encrypted)return!0;if(this.levelkeys){const e=Object.keys(this.levelkeys),t=e.length;if(t>1||1===t&&this.levelkeys[e[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;null==(e=this.loader)||e.abort(),null==(t=this.keyLoader)||t.abort()}setElementaryStreamInfo(e,t,n,i,r,a=!1){const{elementaryStreams:o}=this,s=o[e];s?(s.startPTS=Math.min(s.startPTS,t),s.endPTS=Math.max(s.endPTS,n),s.startDTS=Math.min(s.startDTS,i),s.endDTS=Math.max(s.endDTS,r)):o[e]={startPTS:t,endPTS:n,startDTS:i,endDTS:r,partial:a}}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[M.AUDIO]=null,e[M.VIDEO]=null,e[M.AUDIOVIDEO]=null}}class N extends L{constructor(e,t,n,i,r){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new k,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=i;const a=e.enumeratedString("BYTERANGE");a&&this.setByteRange(a,r),r&&(this.fragOffset=r.fragOffset+r.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}const O=10;class F{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e)return this.advanced=!0,void(this.updated=!0);const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||0===t&&n>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return!!this.fragments.length&&f(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||O}get drift(){const e=this.driftEndTime-this.driftStartTime;if(e>0){const t=this.driftEnd-this.driftStart;return 1e3*t/e}return 1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return null!=(e=this.fragments)&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function U(e){return Uint8Array.from(atob(e),e=>e.charCodeAt(0))}function B(e){const t=V(e).subarray(0,16),n=new Uint8Array(16);return n.set(t,16-t.length),n}function G(e){const t=function(e,t,n){const i=e[t];e[t]=e[n],e[n]=i};t(e,0,3),t(e,1,2),t(e,4,5),t(e,6,7)}function j(e){const t=e.split(":");let n=null;if("data"===t[0]&&2===t.length){const e=t[1].split(";"),i=e[e.length-1].split(",");if(2===i.length){const t="base64"===i[0],r=i[1];t?(e.splice(-1,1),n=U(r)):n=B(r)}}return n}function V(e){return Uint8Array.from(unescape(encodeURIComponent(e)),e=>e.charCodeAt(0))}const H="undefined"!==typeof self?self:void 0;var K={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},z={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function Z(e){switch(e){case z.FAIRPLAY:return K.FAIRPLAY;case z.PLAYREADY:return K.PLAYREADY;case z.WIDEVINE:return K.WIDEVINE;case z.CLEARKEY:return K.CLEARKEY}}var q={WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function Y(e){if(e===q.WIDEVINE)return K.WIDEVINE}function W(e){switch(e){case K.FAIRPLAY:return z.FAIRPLAY;case K.PLAYREADY:return z.PLAYREADY;case K.WIDEVINE:return z.WIDEVINE;case K.CLEARKEY:return z.CLEARKEY}}function $(e){const{drmSystems:t,widevineLicenseUrl:n}=e,i=t?[K.FAIRPLAY,K.WIDEVINE,K.PLAYREADY,K.CLEARKEY].filter(e=>!!t[e]):[];return!i[K.WIDEVINE]&&n&&i.push(K.WIDEVINE),i}const X=function(e){return null!=H&&null!=(e=H.navigator)&&e.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function Q(e,t,n,i){let r;switch(e){case K.FAIRPLAY:r=["cenc","sinf"];break;case K.WIDEVINE:case K.PLAYREADY:r=["cenc"];break;case K.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${e}`)}return J(r,t,n,i)}function J(e,t,n,i){const r={initDataTypes:e,persistentState:i.persistentState||"optional",distinctiveIdentifier:i.distinctiveIdentifier||"optional",sessionTypes:i.sessionTypes||[i.sessionType||"temporary"],audioCapabilities:t.map(e=>({contentType:`audio/mp4; codecs="${e}"`,robustness:i.audioRobustness||"",encryptionScheme:i.audioEncryptionScheme||null})),videoCapabilities:n.map(e=>({contentType:`video/mp4; codecs="${e}"`,robustness:i.videoRobustness||"",encryptionScheme:i.videoEncryptionScheme||null}))};return[r]}function ee(e,t,n){return Uint8Array.prototype.slice?e.slice(t,n):new Uint8Array(Array.prototype.slice.call(e,t,n))}const te=(e,t)=>{return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},ne=(e,t)=>{return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},ie=(e,t)=>{const n=t;let i=0;while(te(e,t)){i+=10;const n=re(e,t+6);i+=n,ne(e,t+10)&&(i+=10),t+=i}if(i>0)return e.subarray(n,n+i)},re=(e,t)=>{let n=0;return n=(127&e[t])<<21,n|=(127&e[t+1])<<14,n|=(127&e[t+2])<<7,n|=127&e[t+3],n},ae=(e,t)=>{return te(e,t)&&re(e,t+6)+10<=e.length-t},oe=e=>{const t=ue(e);for(let n=0;n<t.length;n++){const e=t[n];if(se(e))return pe(e)}},se=e=>{return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},le=e=>{const t=String.fromCharCode(e[0],e[1],e[2],e[3]),n=re(e,4),i=10;return{type:t,size:n,data:e.subarray(i,i+n)}},ue=e=>{let t=0;const n=[];while(te(e,t)){const i=re(e,t+6);t+=10;const r=t+i;while(t+8<r){const i=le(e.subarray(t)),r=ce(i);r&&n.push(r),t+=i.size+10}ne(e,t)&&(t+=10)}return n},ce=e=>{return"PRIV"===e.type?de(e):"W"===e.type[0]?he(e):fe(e)},de=e=>{if(e.size<2)return;const t=ge(e.data,!0),n=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:n.buffer}},fe=e=>{if(e.size<2)return;if("TXXX"===e.type){let t=1;const n=ge(e.data.subarray(t),!0);t+=n.length+1;const i=ge(e.data.subarray(t));return{key:e.type,info:n,data:i}}const t=ge(e.data.subarray(1));return{key:e.type,data:t}},he=e=>{if("WXXX"===e.type){if(e.size<2)return;let t=1;const n=ge(e.data.subarray(t),!0);t+=n.length+1;const i=ge(e.data.subarray(t));return{key:e.type,info:n,data:i}}const t=ge(e.data);return{key:e.type,data:t}},pe=e=>{if(8===e.data.byteLength){const t=new Uint8Array(e.data),n=1&t[3];let i=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return i/=45,n&&(i+=47721858.84),Math.round(i)}},ge=(e,t=!1)=>{const n=ve();if(n){const i=n.decode(e);if(t){const e=i.indexOf("\0");return-1!==e?i.substring(0,e):i}return i.replace(/\0/g,"")}const i=e.length;let r,a,o,s="",l=0;while(l<i){if(r=e[l++],0===r&&t)return s;if(0!==r&&3!==r)switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:s+=String.fromCharCode(r);break;case 12:case 13:a=e[l++],s+=String.fromCharCode((31&r)<<6|63&a);break;case 14:a=e[l++],o=e[l++],s+=String.fromCharCode((15&r)<<12|(63&a)<<6|(63&o)<<0);break}}return s};let me;function ve(){if(!navigator.userAgent.includes("PlayStation 4"))return me||"undefined"===typeof self.TextDecoder||(me=new self.TextDecoder("utf-8")),me}const ye={hexDump:function(e){let t="";for(let n=0;n<e.length;n++){let i=e[n].toString(16);i.length<2&&(i="0"+i),t+=i}return t}},_e=Math.pow(2,32)-1,be=[].push,Ee={video:1,audio:2,id3:3,text:4};function Te(e){return String.fromCharCode.apply(null,e)}function Se(e,t){const n=e[t]<<8|e[t+1];return n<0?65536+n:n}function we(e,t){const n=Ie(e,t);return n<0?4294967296+n:n}function Ae(e,t){let n=we(e,t);return n*=Math.pow(2,32),n+=we(e,t+4),n}function Ie(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function xe(e,t,n){e[t]=n>>24,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n}function Re(e){const t=e.byteLength;for(let n=0;n<t;){const i=we(e,n);if(i>8&&109===e[n+4]&&111===e[n+5]&&111===e[n+6]&&102===e[n+7])return!0;n=i>1?n+i:t}return!1}function Ce(e,t){const n=[];if(!t.length)return n;const i=e.byteLength;for(let r=0;r<i;){const a=we(e,r),o=Te(e.subarray(r+4,r+8)),s=a>1?r+a:i;if(o===t[0])if(1===t.length)n.push(e.subarray(r+8,s));else{const i=Ce(e.subarray(r+8,s),t.slice(1));i.length&&be.apply(n,i)}r=s}return n}function De(e){const t=[],n=e[0];let i=8;const r=we(e,i);i+=4;let a=0,o=0;0===n?(a=we(e,i),o=we(e,i+4),i+=8):(a=Ae(e,i),o=Ae(e,i+8),i+=16),i+=2;let s=e.length+o;const l=Se(e,i);i+=2;for(let u=0;u<l;u++){let n=i;const a=we(e,n);n+=4;const o=2147483647&a,l=(2147483648&a)>>>31;if(1===l)return w.warn("SIDX has hierarchical references (not supported)"),null;const u=we(e,n);n+=4,t.push({referenceSize:o,subsegmentDuration:u,info:{duration:u/r,start:s,end:s+o-1}}),s+=o,n+=4,i=n}return{earliestPresentationTime:a,timescale:r,version:n,referencesCount:l,references:t}}function ke(e){const t=[],n=Ce(e,["moov","trak"]);for(let r=0;r<n.length;r++){const e=n[r],i=Ce(e,["tkhd"])[0];if(i){let n=i[0];const r=we(i,0===n?12:20),a=Ce(e,["mdia","mdhd"])[0];if(a){n=a[0];const i=we(a,0===n?12:20),o=Ce(e,["mdia","hdlr"])[0];if(o){const n=Te(o.subarray(8,12)),a={soun:M.AUDIO,vide:M.VIDEO}[n];if(a){const n=Ce(e,["mdia","minf","stbl","stsd"])[0],o=Me(n);t[r]={timescale:i,type:a},t[a]=s({timescale:i,id:r},o)}}}}}const i=Ce(e,["moov","mvex","trex"]);return i.forEach(e=>{const n=we(e,4),i=t[n];i&&(i.default={duration:we(e,12),flags:we(e,20)})}),t}function Me(e){const t=e.subarray(8),n=t.subarray(86),i=Te(t.subarray(4,8));let r=i;const a="enca"===i||"encv"===i;if(a){const e=Ce(t,[i])[0],n=e.subarray("enca"===i?28:78),a=Ce(n,["sinf"]);a.forEach(e=>{const t=Ce(e,["schm"])[0];if(t){const n=Te(t.subarray(4,8));if("cbcs"===n||"cenc"===n){const t=Ce(e,["frma"])[0];t&&(r=Te(t))}}})}switch(r){case"avc1":case"avc2":case"avc3":case"avc4":{const e=Ce(n,["avcC"])[0];r+="."+Pe(e[1])+Pe(e[2])+Pe(e[3]);break}case"mp4a":{const e=Ce(t,[i])[0],n=Ce(e.subarray(28),["esds"])[0];if(n&&n.length>12){let e=4;if(3!==n[e++])break;e=Le(n,e),e+=2;const t=n[e++];if(128&t&&(e+=2),64&t&&(e+=n[e++]),4!==n[e++])break;e=Le(n,e);const i=n[e++];if(64!==i)break;if(r+="."+Pe(i),e+=12,5!==n[e++])break;e=Le(n,e);const a=n[e++];let o=(248&a)>>3;31===o&&(o+=1+((7&a)<<3)+((224&n[e])>>5)),r+="."+o}break}case"hvc1":case"hev1":{const e=Ce(n,["hvcC"])[0],t=e[1],i=["","A","B","C"][t>>6],a=31&t,o=we(e,2),s=(32&t)>>5?"H":"L",l=e[12],u=e.subarray(6,12);r+="."+i+a,r+="."+o.toString(16).toUpperCase(),r+="."+s+l;let c="";for(let n=u.length;n--;){const e=u[n];if(e||c){const t=e.toString(16).toUpperCase();c="."+t+c}}r+=c;break}case"dvh1":case"dvhe":{const e=Ce(n,["dvcC"])[0],t=e[2]>>1&127,i=e[2]<<5&32|e[3]>>3&31;r+="."+Ne(t)+"."+Ne(i);break}case"vp09":{const e=Ce(n,["vpcC"])[0],t=e[4],i=e[5],a=e[6]>>4&15;r+="."+Ne(t)+"."+Ne(i)+"."+Ne(a);break}case"av01":{const e=Ce(n,["av1C"])[0],t=e[1]>>>5,i=31&e[1],a=e[2]>>>7?"H":"M",o=(64&e[2])>>6,s=(32&e[2])>>5,l=2===t&&o?s?12:10:o?10:8,u=(16&e[2])>>4,c=(8&e[2])>>3,d=(4&e[2])>>2,f=3&e[2],h=1,p=1,g=1,m=0;r+="."+t+"."+Ne(i)+a+"."+Ne(l)+"."+u+"."+c+d+f+"."+Ne(h)+"."+Ne(p)+"."+Ne(g)+"."+m;break}}return{codec:r,encrypted:a}}function Le(e,t){const n=t+5;while(128&e[t++]&&t<n);return t}function Pe(e){return("0"+e.toString(16).toUpperCase()).slice(-2)}function Ne(e){return(e<10?"0":"")+e}function Oe(e,t){if(!e||!t)return e;const n=t.keyId;if(n&&t.isCommonEncryption){const t=Ce(e,["moov","trak"]);t.forEach(e=>{const t=Ce(e,["mdia","minf","stbl","stsd"])[0],i=t.subarray(8);let r=Ce(i,["enca"]);const a=r.length>0;a||(r=Ce(i,["encv"])),r.forEach(e=>{const t=a?e.subarray(28):e.subarray(78),i=Ce(t,["sinf"]);i.forEach(e=>{const t=Fe(e);if(t){const e=t.subarray(8,24);e.some(e=>0!==e)||(w.log(`[eme] Patching keyId in 'enc${a?"a":"v"}>sinf>>tenc' box: ${ye.hexDump(e)} -> ${ye.hexDump(n)}`),t.set(n,8))}})})})}return e}function Fe(e){const t=Ce(e,["schm"])[0];if(t){const n=Te(t.subarray(4,8));if("cbcs"===n||"cenc"===n)return Ce(e,["schi","tenc"])[0]}return w.error("[eme] missing 'schm' box"),null}function Ue(e,t){return Ce(t,["moof","traf"]).reduce((t,n)=>{const i=Ce(n,["tfdt"])[0],r=i[0],a=Ce(n,["tfhd"]).reduce((t,n)=>{const a=we(n,4),o=e[a];if(o){let e=we(i,4);if(1===r){if(e===_e)return w.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),t;e*=_e+1,e+=we(i,8)}const n=o.timescale||9e4,a=e/n;if(f(a)&&(null===t||a<t))return a}return t},null);return null!==a&&f(a)&&(null===t||a<t)?a:t},null)}function Be(e,t){let n=0,i=0,r=0;const a=Ce(e,["moof","traf"]);for(let o=0;o<a.length;o++){const e=a[o],s=Ce(e,["tfhd"])[0],l=we(s,4),u=t[l];if(!u)continue;const c=u.default,d=we(s,0)|(null==c?void 0:c.flags);let f=null==c?void 0:c.duration;8&d&&(f=we(s,2&d?12:8));const h=u.timescale||9e4,p=Ce(e,["trun"]);for(let t=0;t<p.length;t++){if(n=Ge(p[t]),!n&&f){const e=we(p[t],4);n=f*e}u.type===M.VIDEO?i+=n/h:u.type===M.AUDIO&&(r+=n/h)}}if(0===i&&0===r){let t=1/0,n=0,i=0;const r=Ce(e,["sidx"]);for(let e=0;e<r.length;e++){const a=De(r[e]);if(null!=a&&a.references){t=Math.min(t,a.earliestPresentationTime/a.timescale);const e=a.references.reduce((e,t)=>e+t.info.duration||0,0);n=Math.max(n,e+a.earliestPresentationTime/a.timescale),i=n-t}}if(i&&f(i))return i}return i||r}function Ge(e){const t=we(e,0);let n=8;1&t&&(n+=4),4&t&&(n+=4);let i=0;const r=we(e,4);for(let a=0;a<r;a++){if(256&t){const t=we(e,n);i+=t,n+=4}512&t&&(n+=4),1024&t&&(n+=4),2048&t&&(n+=4)}return i}function je(e,t,n){Ce(t,["moof","traf"]).forEach(t=>{Ce(t,["tfhd"]).forEach(i=>{const r=we(i,4),a=e[r];if(!a)return;const o=a.timescale||9e4;Ce(t,["tfdt"]).forEach(e=>{const t=e[0],i=n*o;if(i){let n=we(e,4);if(0===t)n-=i,n=Math.max(n,0),xe(e,4,n);else{n*=Math.pow(2,32),n+=we(e,8),n-=i,n=Math.max(n,0);const t=Math.floor(n/(_e+1)),r=Math.floor(n%(_e+1));xe(e,4,t),xe(e,8,r)}}})})})}function Ve(e){const t={valid:null,remainder:null},n=Ce(e,["moof"]);if(n.length<2)return t.remainder=e,t;const i=n[n.length-1];return t.valid=ee(e,0,i.byteOffset-8),t.remainder=ee(e,i.byteOffset-8),t}function He(e,t){const n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function Ke(e,t){const n=[],i=t.samples,r=t.timescale,a=t.id;let o=!1;const s=Ce(i,["moof"]);return s.map(s=>{const l=s.byteOffset-8,u=Ce(s,["traf"]);u.map(s=>{const u=Ce(s,["tfdt"]).map(e=>{const t=e[0];let n=we(e,4);return 1===t&&(n*=Math.pow(2,32),n+=we(e,8)),n/r})[0];return void 0!==u&&(e=u),Ce(s,["tfhd"]).map(u=>{const c=we(u,4),d=16777215&we(u,0),f=0!==(1&d),h=0!==(2&d),p=0!==(8&d);let g=0;const m=0!==(16&d);let v=0;const y=0!==(32&d);let _=8;c===a&&(f&&(_+=8),h&&(_+=4),p&&(g=we(u,_),_+=4),m&&(v=we(u,_),_+=4),y&&(_+=4),"video"===t.type&&(o=ze(t.codec)),Ce(s,["trun"]).map(a=>{const s=a[0],u=16777215&we(a,0),c=0!==(1&u);let d=0;const f=0!==(4&u),h=0!==(256&u);let p=0;const m=0!==(512&u);let y=0;const _=0!==(1024&u),b=0!==(2048&u);let E=0;const T=we(a,4);let S=8;c&&(d=we(a,S),S+=4),f&&(S+=4);let w=d+l;for(let l=0;l<T;l++){if(h?(p=we(a,S),S+=4):p=g,m?(y=we(a,S),S+=4):y=v,_&&(S+=4),b&&(E=0===s?we(a,S):Ie(a,S),S+=4),t.type===M.VIDEO){let t=0;while(t<y){const a=we(i,w);if(w+=4,Ze(o,i[w])){const t=i.subarray(w,w+a);qe(t,o?2:1,e+E/r,n)}w+=a,t+=a+4}}e+=p/r}}))})})}),n}function ze(e){if(!e)return!1;const t=e.indexOf("."),n=t<0?e:e.substring(0,t);return"hvc1"===n||"hev1"===n||"dvh1"===n||"dvhe"===n}function Ze(e,t){if(e){const e=t>>1&63;return 39===e||40===e}{const e=31&t;return 6===e}}function qe(e,t,n,i){const r=Ye(e);let a=0;a+=t;let o=0,s=0,l=0;while(a<r.length){o=0;do{if(a>=r.length)break;l=r[a++],o+=l}while(255===l);s=0;do{if(a>=r.length)break;l=r[a++],s+=l}while(255===l);const e=r.length-a;let t=a;if(s<e)a+=s;else if(s>e){w.error(`Malformed SEI payload. ${s} is too small, only ${e} bytes left to parse.`);break}if(4===o){const e=r[t++];if(181===e){const e=Se(r,t);if(t+=2,49===e){const e=we(r,t);if(t+=4,1195456820===e){const e=r[t++];if(3===e){const a=r[t++],s=31&a,l=64&a,u=l?2+3*s:0,c=new Uint8Array(u);if(l){c[0]=a;for(let e=1;e<u;e++)c[e]=r[t++]}i.push({type:e,payloadType:o,pts:n,bytes:c})}}}}}else if(5===o&&s>16){const e=[];for(let n=0;n<16;n++){const i=r[t++].toString(16);e.push(1==i.length?"0"+i:i),3!==n&&5!==n&&7!==n&&9!==n||e.push("-")}const a=s-16,l=new Uint8Array(a);for(let n=0;n<a;n++)l[n]=r[t++];i.push({payloadType:o,pts:n,uuid:e.join(""),userData:ge(l),userDataBytes:l})}}}function Ye(e){const t=e.byteLength,n=[];let i=1;while(i<t-2)0===e[i]&&0===e[i+1]&&3===e[i+2]?(n.push(i+2),i+=2):i++;if(0===n.length)return e;const r=t-n.length,a=new Uint8Array(r);let o=0;for(i=0;i<r;o++,i++)o===n[0]&&(o++,n.shift()),a[i]=e[o];return a}function We(e){const t=e[0];let n="",i="",r=0,a=0,o=0,s=0,l=0,u=0;if(0===t){while("\0"!==Te(e.subarray(u,u+1)))n+=Te(e.subarray(u,u+1)),u+=1;n+=Te(e.subarray(u,u+1)),u+=1;while("\0"!==Te(e.subarray(u,u+1)))i+=Te(e.subarray(u,u+1)),u+=1;i+=Te(e.subarray(u,u+1)),u+=1,r=we(e,12),a=we(e,16),s=we(e,20),l=we(e,24),u=28}else if(1===t){u+=4,r=we(e,u),u+=4;const t=we(e,u);u+=4;const a=we(e,u);u+=4,o=2**32*t+a,h(o)||(o=Number.MAX_SAFE_INTEGER,w.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),s=we(e,u),u+=4,l=we(e,u),u+=4;while("\0"!==Te(e.subarray(u,u+1)))n+=Te(e.subarray(u,u+1)),u+=1;n+=Te(e.subarray(u,u+1)),u+=1;while("\0"!==Te(e.subarray(u,u+1)))i+=Te(e.subarray(u,u+1)),u+=1;i+=Te(e.subarray(u,u+1)),u+=1}const c=e.subarray(u,e.byteLength);return{schemeIdUri:n,value:i,timeScale:r,presentationTime:o,presentationTimeDelta:a,eventDuration:s,id:l,payload:c}}function $e(e,...t){const n=t.length;let i=8,r=n;while(r--)i+=t[r].byteLength;const a=new Uint8Array(i);for(a[0]=i>>24&255,a[1]=i>>16&255,a[2]=i>>8&255,a[3]=255&i,a.set(e,4),r=0,i=8;r<n;r++)a.set(t[r],i),i+=t[r].byteLength;return a}function Xe(e,t,n){if(16!==e.byteLength)throw new RangeError("Invalid system id");let i,r,a;if(t){i=1,r=new Uint8Array(16*t.length);for(let e=0;e<t.length;e++){const n=t[e];if(16!==n.byteLength)throw new RangeError("Invalid key");r.set(n,16*e)}}else i=0,r=new Uint8Array;i>0?(a=new Uint8Array(4),t.length>0&&new DataView(a.buffer).setUint32(0,t.length,!1)):a=new Uint8Array;const o=new Uint8Array(4);return n&&n.byteLength>0&&new DataView(o.buffer).setUint32(0,n.byteLength,!1),$e([112,115,115,104],new Uint8Array([i,0,0,0]),e,a,r,o,n||new Uint8Array)}function Qe(e){if(!(e instanceof ArrayBuffer)||e.byteLength<32)return null;const t={version:0,systemId:"",kids:null,data:null},n=new DataView(e),i=n.getUint32(0);if(e.byteLength!==i&&i>44)return null;const r=n.getUint32(4);if(1886614376!==r)return null;if(t.version=n.getUint32(8)>>>24,t.version>1)return null;t.systemId=ye.hexDump(new Uint8Array(e,12,16));const a=n.getUint32(28);if(0===t.version){if(i-32<a)return null;t.data=new Uint8Array(e,32,a)}else if(1===t.version){t.kids=[];for(let n=0;n<a;n++)t.kids.push(new Uint8Array(e,32+16*n,16))}return t}let Je={};class et{static clearKeyUriToKeyIdMap(){Je={}}constructor(e,t,n,i=[1],r=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=i,this.iv=r,this.encrypted=!!e&&"NONE"!==e,this.isCommonEncryption=this.encrypted&&"AES-128"!==e}isSupported(){if(this.method){if("AES-128"===this.method||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case z.FAIRPLAY:case z.WIDEVINE:case z.PLAYREADY:case z.CLEARKEY:return-1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if("AES-128"===this.method&&this.uri&&!this.iv){"number"!==typeof e&&("AES-128"!==this.method||this.iv||w.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const t=tt(e),n=new et(this.method,this.uri,"identity",this.keyFormatVersions,t);return n}const t=j(this.uri);if(t)switch(this.keyFormat){case z.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case z.PLAYREADY:{const e=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=Xe(e,null,t);const n=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),i=String.fromCharCode.apply(null,Array.from(n)),r=i.substring(i.indexOf("<"),i.length),a=new DOMParser,o=a.parseFromString(r,"text/xml"),s=o.getElementsByTagName("KID")[0];if(s){const e=s.childNodes[0]?s.childNodes[0].nodeValue:s.getAttribute("VALUE");if(e){const t=U(e).subarray(0,16);G(t),this.keyId=t}}break}default:{let e=t.subarray(0,16);if(16!==e.length){const t=new Uint8Array(16);t.set(e,16-e.length),e=t}this.keyId=e;break}}if(!this.keyId||16!==this.keyId.byteLength){let e=Je[this.uri];if(!e){const t=Object.keys(Je).length%Number.MAX_SAFE_INTEGER;e=new Uint8Array(16);const n=new DataView(e.buffer,12,4);n.setUint32(0,t),Je[this.uri]=e}this.keyId=e}return this}}function tt(e){const t=new Uint8Array(16);for(let n=12;n<16;n++)t[n]=e>>8*(15-n)&255;return t}const nt=/\{\$([a-zA-Z0-9-_]+)\}/g;function it(e){return nt.test(e)}function rt(e,t,n){if(null!==e.variableList||e.hasVariableRefs)for(let i=n.length;i--;){const r=n[i],a=t[r];a&&(t[r]=at(e,a))}}function at(e,t){if(null!==e.variableList||e.hasVariableRefs){const n=e.variableList;return t.replace(nt,t=>{const i=t.substring(2,t.length-1),r=null==n?void 0:n[i];return void 0===r?(e.playlistParsingError||(e.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${i}"`)),t):r})}return t}function ot(e,t,n){let i,r,a=e.variableList;if(a||(e.variableList=a={}),"QUERYPARAM"in t){i=t.QUERYPARAM;try{const t=new self.URL(n).searchParams;if(!t.has(i))throw new Error(`"${i}" does not match any query parameter in URI: "${n}"`);r=t.get(i)}catch(t){e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${t.message}`))}}else i=t.NAME,r=t.VALUE;i in a?e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${i}"`)):a[i]=r||""}function st(e,t,n){const i=t.IMPORT;if(n&&i in n){let t=e.variableList;t||(e.variableList=t={}),t[i]=n[i]}else e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${i}"`))}function lt(e=!0){if("undefined"===typeof self)return;const t=(e||!self.MediaSource)&&self.ManagedMediaSource;return t||self.MediaSource||self.WebKitMediaSource}function ut(e){return"undefined"!==typeof self&&e===self.ManagedMediaSource}const ct={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function dt(e,t){const n=ct[t];return!!n&&!!n[e.slice(0,4)]}function ft(e,t,n=!0){return!e.split(",").some(e=>!ht(e,t,n))}function ht(e,t,n=!0){var i;const r=lt(n);return null!=(i=null==r?void 0:r.isTypeSupported(pt(e,t)))&&i}function pt(e,t){return`${t}/mp4;codecs="${e}"`}function gt(e){if(e){const t=e.substring(0,4);return ct.video[t]}return 2}function mt(e){return e.split(",").reduce((e,t)=>{const n=ct.video[t];return n?(2*n+e)/(e?3:2):(ct.audio[t]+e)/(e?2:1)},0)}const vt={};function yt(e,t=!0){if(vt[e])return vt[e];const n={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"]}[e];for(let i=0;i<n.length;i++)if(ht(n[i],"audio",t))return vt[e]=n[i],n[i];return e}const _t=/flac|opus/i;function bt(e,t=!0){return e.replace(_t,e=>yt(e.toLowerCase(),t))}function Et(e,t){return e&&"mp4a"!==e?e:t?t.split(",")[0]:t}function Tt(e){const t=e.split(",");for(let n=0;n<t.length;n++){const e=t[n].split(".");if(e.length>2){let i=e.shift()+".";i+=parseInt(e.shift()).toString(16),i+=("000"+parseInt(e.shift()).toString(16)).slice(-4),t[n]=i}}return t.join(",")}const St=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,wt=/#EXT-X-MEDIA:(.*)/g,At=/^#EXT(?:INF|-X-TARGETDURATION):/m,It=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),xt=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class Rt{static findGroup(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(i.id===t)return i}}static resolve(e,t){return a.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return At.test(e)}static parseMasterPlaylist(e,t){const n=it(e),i={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:n},r=[];let a;St.lastIndex=0;while(null!=(a=St.exec(e)))if(a[1]){var o;const e=new x(a[1]);rt(i,e,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const n=at(i,a[2]),s={attrs:e,bitrate:e.decimalInteger("BANDWIDTH")||e.decimalInteger("AVERAGE-BANDWIDTH"),name:e.NAME,url:Rt.resolve(n,t)},l=e.decimalResolution("RESOLUTION");l&&(s.width=l.width,s.height=l.height),kt(e.CODECS,s),null!=(o=s.unknownCodecs)&&o.length||r.push(s),i.levels.push(s)}else if(a[3]){const e=a[3],n=a[4];switch(e){case"SESSION-DATA":{const e=new x(n);rt(i,e,["DATA-ID","LANGUAGE","VALUE","URI"]);const t=e["DATA-ID"];t&&(null===i.sessionData&&(i.sessionData={}),i.sessionData[t]=e);break}case"SESSION-KEY":{const e=Ct(n,t,i);e.encrypted&&e.isSupported()?(null===i.sessionKeys&&(i.sessionKeys=[]),i.sessionKeys.push(e)):w.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${n}"`);break}case"DEFINE":{const e=new x(n);rt(i,e,["NAME","VALUE","QUERYPARAM"]),ot(i,e,t)}break;case"CONTENT-STEERING":{const e=new x(n);rt(i,e,["SERVER-URI","PATHWAY-ID"]),i.contentSteering={uri:Rt.resolve(e["SERVER-URI"],t),pathwayId:e["PATHWAY-ID"]||"."};break}case"START":i.startTimeOffset=Dt(n);break}}const s=r.length>0&&r.length<i.levels.length;return i.levels=s?r:i.levels,0===i.levels.length&&(i.playlistParsingError=new Error("no levels found in manifest")),i}static parseMasterPlaylistMedia(e,t,n){let i;const r={},a=n.levels,o={AUDIO:a.map(e=>({id:e.attrs.AUDIO,audioCodec:e.audioCodec})),SUBTITLES:a.map(e=>({id:e.attrs.SUBTITLES,textCodec:e.textCodec})),"CLOSED-CAPTIONS":[]};let s=0;wt.lastIndex=0;while(null!==(i=wt.exec(e))){const e=new x(i[1]),a=e.TYPE;if(a){const i=o[a],l=r[a]||[];r[a]=l,rt(n,e,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const u=e.LANGUAGE,c=e["ASSOC-LANGUAGE"],d=e.CHANNELS,f=e.CHARACTERISTICS,h=e["INSTREAM-ID"],p={attrs:e,bitrate:0,id:s++,groupId:e["GROUP-ID"]||"",name:e.NAME||u||"",type:a,default:e.bool("DEFAULT"),autoselect:e.bool("AUTOSELECT"),forced:e.bool("FORCED"),lang:u,url:e.URI?Rt.resolve(e.URI,t):""};if(c&&(p.assocLang=c),d&&(p.channels=d),f&&(p.characteristics=f),h&&(p.instreamId=h),null!=i&&i.length){const e=Rt.findGroup(i,p.groupId)||i[0];Mt(p,e,"audioCodec"),Mt(p,e,"textCodec")}l.push(p)}}return r}static parseLevelPlaylist(e,t,n,i,r,a){const o=new F(t),s=o.fragments;let l,u,c,h=null,p=0,g=0,m=0,v=0,y=null,_=new P(i,t),b=-1,E=!1,T=null;It.lastIndex=0,o.m3u8=e,o.hasVariableRefs=it(e);while(null!==(l=It.exec(e))){E&&(E=!1,_=new P(i,t),_.start=m,_.sn=p,_.cc=v,_.level=n,h&&(_.initSegment=h,_.rawProgramDateTime=h.rawProgramDateTime,h.rawProgramDateTime=null,T&&(_.setByteRange(T),T=null)));const e=l[1];if(e){_.duration=parseFloat(e);const t=(" "+l[2]).slice(1);_.title=t||null,_.tagList.push(t?["INF",e,t]:["INF",e])}else if(l[3]){if(f(_.duration)){_.start=m,c&&Ot(_,c,o),_.sn=p,_.level=n,_.cc=v,s.push(_);const e=(" "+l[3]).slice(1);_.relurl=at(o,e),Pt(_,y),y=_,m+=_.duration,p++,g=0,E=!0}}else if(l[4]){const e=(" "+l[4]).slice(1);y?_.setByteRange(e,y):_.setByteRange(e)}else if(l[5])_.rawProgramDateTime=(" "+l[5]).slice(1),_.tagList.push(["PROGRAM-DATE-TIME",_.rawProgramDateTime]),-1===b&&(b=s.length);else{if(l=l[0].match(xt),!l){w.warn("No matches on slow regex match for level playlist!");continue}for(u=1;u<l.length;u++)if("undefined"!==typeof l[u])break;const e=(" "+l[u]).slice(1),r=(" "+l[u+1]).slice(1),m=l[u+2]?(" "+l[u+2]).slice(1):"";switch(e){case"PLAYLIST-TYPE":o.type=r.toUpperCase();break;case"MEDIA-SEQUENCE":p=o.startSN=parseInt(r);break;case"SKIP":{const e=new x(r);rt(o,e,["RECENTLY-REMOVED-DATERANGES"]);const t=e.decimalInteger("SKIPPED-SEGMENTS");if(f(t)){o.skippedSegments=t;for(let e=t;e--;)s.unshift(null);p+=t}const n=e.enumeratedString("RECENTLY-REMOVED-DATERANGES");n&&(o.recentlyRemovedDateranges=n.split("\t"));break}case"TARGETDURATION":o.targetduration=Math.max(parseInt(r),1);break;case"VERSION":o.version=parseInt(r);break;case"INDEPENDENT-SEGMENTS":case"EXTM3U":break;case"ENDLIST":o.live=!1;break;case"#":(r||m)&&_.tagList.push(m?[r,m]:[r]);break;case"DISCONTINUITY":v++,_.tagList.push(["DIS"]);break;case"GAP":_.gap=!0,_.tagList.push([e]);break;case"BITRATE":_.tagList.push([e,r]);break;case"DATERANGE":{const e=new x(r);rt(o,e,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),rt(o,e,e.clientAttrs);const t=new D(e,o.dateRanges[e.ID]);t.isValid||o.skippedSegments?o.dateRanges[t.id]=t:w.warn(`Ignoring invalid DATERANGE tag: "${r}"`),_.tagList.push(["EXT-X-DATERANGE",r]);break}case"DEFINE":{const e=new x(r);rt(o,e,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in e?st(o,e,a):ot(o,e,t)}break;case"DISCONTINUITY-SEQUENCE":v=parseInt(r);break;case"KEY":{const e=Ct(r,t,o);if(e.isSupported()){if("NONE"===e.method){c=void 0;break}c||(c={}),c[e.keyFormat]&&(c=d({},c)),c[e.keyFormat]=e}else w.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${r}"`);break}case"START":o.startTimeOffset=Dt(r);break;case"MAP":{const e=new x(r);if(rt(o,e,["BYTERANGE","URI"]),_.duration){const r=new P(i,t);Nt(r,e,n,c),h=r,_.initSegment=h,h.rawProgramDateTime&&!_.rawProgramDateTime&&(_.rawProgramDateTime=h.rawProgramDateTime)}else{const t=_.byteRangeEndOffset;if(t){const e=_.byteRangeStartOffset;T=`${t-e}@${e}`}else T=null;Nt(_,e,n,c),h=_,E=!0}break}case"SERVER-CONTROL":{const e=new x(r);o.canBlockReload=e.bool("CAN-BLOCK-RELOAD"),o.canSkipUntil=e.optionalFloat("CAN-SKIP-UNTIL",0),o.canSkipDateRanges=o.canSkipUntil>0&&e.bool("CAN-SKIP-DATERANGES"),o.partHoldBack=e.optionalFloat("PART-HOLD-BACK",0),o.holdBack=e.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const e=new x(r);o.partTarget=e.decimalFloatingPoint("PART-TARGET");break}case"PART":{let e=o.partList;e||(e=o.partList=[]);const n=g>0?e[e.length-1]:void 0,i=g++,a=new x(r);rt(o,a,["BYTERANGE","URI"]);const s=new N(a,_,t,i,n);e.push(s),_.duration+=s.duration;break}case"PRELOAD-HINT":{const e=new x(r);rt(o,e,["URI"]),o.preloadHint=e;break}case"RENDITION-REPORT":{const e=new x(r);rt(o,e,["URI"]),o.renditionReports=o.renditionReports||[],o.renditionReports.push(e);break}default:w.warn(`line parsed but not handled: ${l}`);break}}}y&&!y.relurl?(s.pop(),m-=y.duration,o.partList&&(o.fragmentHint=y)):o.partList&&(Pt(_,y),_.cc=v,o.fragmentHint=_,c&&Ot(_,c,o));const S=s.length,A=s[0],I=s[S-1];if(m+=o.skippedSegments*o.targetduration,m>0&&S&&I){o.averagetargetduration=m/S;const e=I.sn;o.endSN="initSegment"!==e?e:0,o.live||(I.endList=!0),A&&(o.startCC=A.cc)}else o.endSN=0,o.startCC=0;return o.fragmentHint&&(m+=o.fragmentHint.duration),o.totalduration=m,o.endCC=v,b>0&&Lt(s,b),o}}function Ct(e,t,n){var i,r;const a=new x(e);rt(n,a,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const o=null!=(i=a.METHOD)?i:"",s=a.URI,l=a.hexadecimalInteger("IV"),u=a.KEYFORMATVERSIONS,c=null!=(r=a.KEYFORMAT)?r:"identity";s&&a.IV&&!l&&w.error(`Invalid IV: ${a.IV}`);const d=s?Rt.resolve(s,t):"",f=(u||"1").split("/").map(Number).filter(Number.isFinite);return new et(o,d,c,f,l)}function Dt(e){const t=new x(e),n=t.decimalFloatingPoint("TIME-OFFSET");return f(n)?n:null}function kt(e,t){let n=(e||"").split(/[ ,]+/).filter(e=>e);["video","audio","text"].forEach(e=>{const i=n.filter(t=>dt(t,e));i.length&&(t[`${e}Codec`]=i.join(","),n=n.filter(e=>-1===i.indexOf(e)))}),t.unknownCodecs=n}function Mt(e,t,n){const i=t[n];i&&(e[n]=i)}function Lt(e,t){let n=e[t];for(let i=t;i--;){const t=e[i];if(!t)return;t.programDateTime=n.programDateTime-1e3*t.duration,n=t}}function Pt(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),f(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}function Nt(e,t,n,i){e.relurl=t.URI,t.BYTERANGE&&e.setByteRange(t.BYTERANGE),e.level=n,e.sn="initSegment",i&&(e.levelkeys=i),e.initSegment=null}function Ot(e,t,n){e.levelkeys=t;const{encryptedFragments:i}=n;i.length&&i[i.length-1].levelkeys===t||!Object.keys(t).some(e=>t[e].isCommonEncryption)||i.push(e)}var Ft={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},Ut={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function Bt(e){const{type:t}=e;switch(t){case Ft.AUDIO_TRACK:return Ut.AUDIO;case Ft.SUBTITLE_TRACK:return Ut.SUBTITLE;default:return Ut.MAIN}}function Gt(e,t){let n=e.url;return void 0!==n&&0!==n.indexOf("data:")||(n=t.url),n}class jt{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(g.MANIFEST_LOADING,this.onManifestLoading,this),e.on(g.LEVEL_LOADING,this.onLevelLoading,this),e.on(g.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(g.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(g.MANIFEST_LOADING,this.onManifestLoading,this),e.off(g.LEVEL_LOADING,this.onLevelLoading,this),e.off(g.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(g.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,i=t.loader,r=n||i,a=new r(t);return this.loaders[e.type]=a,a}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Ft.MANIFEST,url:n,deliveryDirectives:null})}onLevelLoading(e,t){const{id:n,level:i,pathwayId:r,url:a,deliveryDirectives:o}=t;this.load({id:n,level:i,pathwayId:r,responseType:"text",type:Ft.LEVEL,url:a,deliveryDirectives:o})}onAudioTrackLoading(e,t){const{id:n,groupId:i,url:r,deliveryDirectives:a}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:Ft.AUDIO_TRACK,url:r,deliveryDirectives:a})}onSubtitleTrackLoading(e,t){const{id:n,groupId:i,url:r,deliveryDirectives:a}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:Ft.SUBTITLE_TRACK,url:r,deliveryDirectives:a})}load(e){var t;const n=this.hls.config;let i,r=this.getInternalLoader(e);if(r){const t=r.context;if(t&&t.url===e.url&&t.level===e.level)return void w.trace("[playlist-loader]: playlist request ongoing");w.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),r.abort()}if(i=e.type===Ft.MANIFEST?n.manifestLoadPolicy.default:d({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(e),f(null==(t=e.deliveryDirectives)?void 0:t.part)){let t;if(e.type===Ft.LEVEL&&null!==e.level?t=this.hls.levels[e.level].details:e.type===Ft.AUDIO_TRACK&&null!==e.id?t=this.hls.audioTracks[e.id].details:e.type===Ft.SUBTITLE_TRACK&&null!==e.id&&(t=this.hls.subtitleTracks[e.id].details),t){const e=t.partTarget,n=t.targetduration;if(e&&n){const t=1e3*Math.max(3*e,.8*n);i=d({},i,{maxTimeToFirstByteMs:Math.min(t,i.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(t,i.maxTimeToFirstByteMs)})}}}const a=i.errorRetry||i.timeoutRetry||{},o={loadPolicy:i,timeout:i.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},s={onSuccess:(e,t,n,i)=>{const r=this.getInternalLoader(n);this.resetInternalLoader(n.type);const a=e.data;0===a.indexOf("#EXTM3U")?(t.parsing.start=performance.now(),Rt.isMediaPlaylist(a)?this.handleTrackOrLevelPlaylist(e,t,n,i||null,r):this.handleMasterPlaylist(e,t,n,i)):this.handleManifestParsingError(e,n,new Error("no EXTM3U delimiter"),i||null,t)},onError:(e,t,n,i)=>{this.handleNetworkError(t,n,!1,e,i)},onTimeout:(e,t,n)=>{this.handleNetworkError(t,n,!0,void 0,e)}};r.load(e,o,s)}handleMasterPlaylist(e,t,n,i){const r=this.hls,a=e.data,o=Gt(e,n),s=Rt.parseMasterPlaylist(a,o);if(s.playlistParsingError)return void this.handleManifestParsingError(e,n,s.playlistParsingError,i,t);const{contentSteering:l,levels:u,sessionData:c,sessionKeys:d,startTimeOffset:f,variableList:h}=s;this.variableList=h;const{AUDIO:p=[],SUBTITLES:m,"CLOSED-CAPTIONS":v}=Rt.parseMasterPlaylistMedia(a,o,s);if(p.length){const e=p.some(e=>!e.url);e||!u[0].audioCodec||u[0].attrs.AUDIO||(w.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),p.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new x({}),bitrate:0,url:""}))}r.trigger(g.MANIFEST_LOADED,{levels:u,audioTracks:p,subtitles:m,captions:v,contentSteering:l,url:o,stats:t,networkDetails:i,sessionData:c,sessionKeys:d,startTimeOffset:f,variableList:h})}handleTrackOrLevelPlaylist(e,t,n,i,r){const a=this.hls,{id:o,level:s,type:l}=n,u=Gt(e,n),c=0,d=f(s)?s:f(o)?o:0,h=Bt(n),p=Rt.parseLevelPlaylist(e.data,u,d,h,c,this.variableList);if(l===Ft.MANIFEST){const e={attrs:new x({}),bitrate:0,details:p,name:"",url:u};a.trigger(g.MANIFEST_LOADED,{levels:[e],audioTracks:[],url:u,stats:t,networkDetails:i,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=p,this.handlePlaylistLoaded(p,e,t,n,i,r)}handleManifestParsingError(e,t,n,i,r){this.hls.trigger(g.ERROR,{type:m.NETWORK_ERROR,details:v.MANIFEST_PARSING_ERROR,fatal:t.type===Ft.MANIFEST,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:i,stats:r})}handleNetworkError(e,t,n=!1,i,r){let a=`A network ${n?"timeout":"error"+(i?" (status "+i.code+")":"")} occurred while loading ${e.type}`;e.type===Ft.LEVEL?a+=`: ${e.level} id: ${e.id}`:e.type!==Ft.AUDIO_TRACK&&e.type!==Ft.SUBTITLE_TRACK||(a+=` id: ${e.id} group-id: "${e.groupId}"`);const o=new Error(a);w.warn(`[playlist-loader]: ${a}`);let l=v.UNKNOWN,u=!1;const c=this.getInternalLoader(e);switch(e.type){case Ft.MANIFEST:l=n?v.MANIFEST_LOAD_TIMEOUT:v.MANIFEST_LOAD_ERROR,u=!0;break;case Ft.LEVEL:l=n?v.LEVEL_LOAD_TIMEOUT:v.LEVEL_LOAD_ERROR,u=!1;break;case Ft.AUDIO_TRACK:l=n?v.AUDIO_TRACK_LOAD_TIMEOUT:v.AUDIO_TRACK_LOAD_ERROR,u=!1;break;case Ft.SUBTITLE_TRACK:l=n?v.SUBTITLE_TRACK_LOAD_TIMEOUT:v.SUBTITLE_LOAD_ERROR,u=!1;break}c&&this.resetInternalLoader(e.type);const d={type:m.NETWORK_ERROR,details:l,fatal:u,url:e.url,loader:c,context:e,error:o,networkDetails:t,stats:r};if(i){const n=(null==t?void 0:t.url)||e.url;d.response=s({url:n,data:void 0},i)}this.hls.trigger(g.ERROR,d)}handlePlaylistLoaded(e,t,n,i,r,a){const o=this.hls,{type:s,level:l,id:u,groupId:c,deliveryDirectives:d}=i,f=Gt(t,i),h=Bt(i),p="number"===typeof i.level&&h===Ut.MAIN?l:void 0;if(!e.fragments.length){const e=new Error("No Segments found in Playlist");return void o.trigger(g.ERROR,{type:m.NETWORK_ERROR,details:v.LEVEL_EMPTY_ERROR,fatal:!1,url:f,error:e,reason:e.message,response:t,context:i,level:p,parent:h,networkDetails:r,stats:n})}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const y=e.playlistParsingError;if(y)o.trigger(g.ERROR,{type:m.NETWORK_ERROR,details:v.LEVEL_PARSING_ERROR,fatal:!1,url:f,error:y,reason:y.message,response:t,context:i,level:p,parent:h,networkDetails:r,stats:n});else switch(e.live&&a&&(a.getCacheAge&&(e.ageHeader=a.getCacheAge()||0),a.getCacheAge&&!isNaN(e.ageHeader)||(e.ageHeader=0)),s){case Ft.MANIFEST:case Ft.LEVEL:o.trigger(g.LEVEL_LOADED,{details:e,level:p||0,id:u||0,stats:n,networkDetails:r,deliveryDirectives:d});break;case Ft.AUDIO_TRACK:o.trigger(g.AUDIO_TRACK_LOADED,{details:e,id:u||0,groupId:c||"",stats:n,networkDetails:r,deliveryDirectives:d});break;case Ft.SUBTITLE_TRACK:o.trigger(g.SUBTITLE_TRACK_LOADED,{details:e,id:u||0,groupId:c||"",stats:n,networkDetails:r,deliveryDirectives:d});break}}}function Vt(e,t){let n;try{n=new Event("addtrack")}catch(e){n=document.createEvent("Event"),n.initEvent("addtrack",!1,!1)}n.track=e,t.dispatchEvent(n)}function Ht(e,t){const n=e.mode;if("disabled"===n&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(t.id))try{if(e.addCue(t),!e.cues.getCueById(t.id))throw new Error(`addCue is failed for: ${t}`)}catch(n){w.debug(`[texttrack-utils]: ${n}`);try{const n=new self.TextTrackCue(t.startTime,t.endTime,t.text);n.id=t.id,e.addCue(n)}catch(e){w.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${e}`)}}"disabled"===n&&(e.mode=n)}function Kt(e){const t=e.mode;if("disabled"===t&&(e.mode="hidden"),e.cues)for(let n=e.cues.length;n--;)e.removeCue(e.cues[n]);"disabled"===t&&(e.mode=t)}function zt(e,t,n,i){const r=e.mode;if("disabled"===r&&(e.mode="hidden"),e.cues&&e.cues.length>0){const r=qt(e.cues,t,n);for(let t=0;t<r.length;t++)i&&!i(r[t])||e.removeCue(r[t])}"disabled"===r&&(e.mode=r)}function Zt(e,t){if(t<e[0].startTime)return 0;const n=e.length-1;if(t>e[n].endTime)return-1;let i=0,r=n;while(i<=r){const a=Math.floor((r+i)/2);if(t<e[a].startTime)r=a-1;else{if(!(t>e[a].startTime&&i<n))return a;i=a+1}}return e[i].startTime-t<t-e[r].startTime?i:r}function qt(e,t,n){const i=[],r=Zt(e,t);if(r>-1)for(let a=r,o=e.length;a<o;a++){const r=e[a];if(r.startTime>=t&&r.endTime<=n)i.push(r);else if(r.startTime>n)return i}return i}function Yt(e){const t=[];for(let n=0;n<e.length;n++){const i=e[n];"subtitles"!==i.kind&&"captions"!==i.kind||!i.label||t.push(e[n])}return t}var Wt={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};const $t=.25;function Xt(){if("undefined"!==typeof self)return self.VTTCue||self.TextTrackCue}function Qt(e,t,n,i,r){let a=new e(t,n,"");try{a.value=i,r&&(a.type=r)}catch(o){a=new e(t,n,JSON.stringify(r?s({type:r},i):i))}return a}const Jt=(()=>{const e=Xt();try{e&&new e(0,Number.POSITIVE_INFINITY,"")}catch(e){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function en(e,t){return e.getTime()/1e3-t}function tn(e){return Uint8Array.from(e.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class nn{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(g.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(g.MANIFEST_LOADING,this.onManifestLoading,this),e.on(g.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(g.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(g.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(g.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(g.MANIFEST_LOADING,this.onManifestLoading,this),e.off(g.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(g.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(g.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){this.id3Track&&(Kt(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const n=e[t];if("metadata"===n.kind&&"id3"===n.label)return Vt(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:n,enableID3MetadataCues:i}}}=this;if(!n&&!i)return;const{samples:r}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const a=Xt();if(a)for(let o=0;o<r.length;o++){const e=r[o].type;if(e===Wt.emsg&&!n||!i)continue;const t=ue(r[o].data);if(t){const n=r[o].pts;let i=n+r[o].duration;i>Jt&&(i=Jt);const s=i-n;s<=0&&(i=n+$t);for(let r=0;r<t.length;r++){const o=t[r];if(!se(o)){this.updateId3CueEnds(n,e);const t=Qt(a,n,i,o,e);t&&this.id3Track.addCue(t)}}}}}updateId3CueEnds(e,t){var n;const i=null==(n=this.id3Track)?void 0:n.cues;if(i)for(let r=i.length;r--;){const n=i[r];n.type===t&&n.startTime<e&&n.endTime===Jt&&(n.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:i}){const{id3Track:r,hls:a}=this;if(!a)return;const{config:{enableEmsgMetadataCues:o,enableID3MetadataCues:s}}=a;if(r&&(o||s)){let e;e="audio"===i?e=>e.type===Wt.audioId3&&s:"video"===i?e=>e.type===Wt.emsg&&o:e=>e.type===Wt.audioId3&&s||e.type===Wt.emsg&&o,zt(r,t,n,e)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:n,id3Track:i}=this,{dateRanges:r}=t,a=Object.keys(r);if(i){const e=Object.keys(n).filter(e=>!a.includes(e));for(let t=e.length;t--;){const r=e[t];Object.keys(n[r].cues).forEach(e=>{i.removeCue(n[r].cues[e])}),delete n[r]}}const o=t.fragments[t.fragments.length-1];if(0===a.length||!f(null==o?void 0:o.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const s=o.programDateTime/1e3-o.start,l=Xt();for(let u=0;u<a.length;u++){const e=a[u],t=r[e],i=en(t.startDate,s),o=n[e],c=(null==o?void 0:o.cues)||{};let d=(null==o?void 0:o.durationKnown)||!1,f=Jt;const h=t.endDate;if(h)f=en(h,s),d=!0;else if(t.endOnNext&&!d){const e=a.reduce((e,n)=>{if(n!==t.id){const i=r[n];if(i.class===t.class&&i.startDate>t.startDate&&(!e||t.startDate<e.startDate))return i}return e},null);e&&(f=en(e.startDate,s),d=!0)}const p=Object.keys(t.attr);for(let n=0;n<p.length;n++){const r=p[n];if(!R(r))continue;const a=c[r];if(a)d&&!o.durationKnown&&(a.endTime=f);else if(l){let n=t.attr[r];C(r)&&(n=tn(n));const a=Qt(l,i,f,{key:r,data:n},Wt.dateRange);a&&(a.id=e,this.id3Track.addCue(a),c[r]=a)}}n[e]={cues:c,dateRange:t,durationKnown:d}}}}class rn{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=(()=>this.timeupdate()),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:t}=this;return void 0!==e.liveMaxLatencyDuration?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(null===e)return null;const{holdBack:t,partHoldBack:n,targetduration:i}=e,{liveSyncDuration:r,liveSyncDurationCount:a,lowLatencyMode:o}=this.config,s=this.hls.userConfig;let l=o&&n||t;(s.liveSyncDuration||s.liveSyncDurationCount||0===l)&&(l=void 0!==r?r:a*i);const u=i,c=1;return l+Math.min(this.stallCount*c,u)}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency,n=this.levelDetails;if(null===e||null===t||null===n)return null;const i=n.edge,r=e-t-this.edgeStalled,a=i-n.totalduration,o=i-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(a,r),o)}get drift(){const{levelDetails:e}=this;return null===e?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;if(null===e)return 0;const t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration);return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e,levelDetails:t}=this;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(g.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(g.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(g.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(g.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(g.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(g.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(g.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(g.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(g.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(g.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var n;t.details===v.BUFFER_STALLED_ERROR&&(this.stallCount++,null!=(n=this.levelDetails)&&n.live&&w.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;const n=this.computeLatency();if(null===n)return;this._latency=n;const{lowLatencyMode:i,maxLiveSyncPlaybackRate:r}=this.config;if(!i||1===r||!t.live)return;const a=this.targetLatency;if(null===a)return;const o=n-a,s=Math.min(this.maxLatency,a+t.targetduration),l=o<s;if(l&&o>.05&&this.forwardBufferLength>1){const t=Math.min(2,Math.max(1,r)),n=Math.round(2/(1+Math.exp(-.75*o-this.edgeStalled))*20)/20;e.playbackRate=Math.min(t,Math.max(1,n))}else 1!==e.playbackRate&&0!==e.playbackRate&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return null===e?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return null===e?null:e-this.currentTime}}const an=["NONE","TYPE-0","TYPE-1",null];function on(e){return an.indexOf(e)>-1}const sn=["SDR","PQ","HLG"];function ln(e){return!!e&&sn.indexOf(e)>-1}var un={No:"",Yes:"YES",v2:"v2"};function cn(e){const{canSkipUntil:t,canSkipDateRanges:n,age:i}=e,r=i<t/2;return t&&r?n?un.v2:un.Yes:un.No}class dn{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class fn{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(e=>!!e).map(e=>e.substring(0,4)).join(","),this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return hn(this._audioGroups,e)}hasSubtitleGroup(e){return hn(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t)if("audio"===e){let e=this._audioGroups;e||(e=this._audioGroups=[]),-1===e.indexOf(t)&&e.push(t)}else if("text"===e){let e=this._subtitleGroups;e||(e=this._subtitleGroups=[]),-1===e.indexOf(t)&&e.push(t)}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return null==(e=this.audioGroups)?void 0:e[0]}get textGroupId(){var e;return null==(e=this.subtitleGroups)?void 0:e[0]}addFallback(){}}function hn(e,t){return!(!t||!e)&&-1!==e.indexOf(t)}function pn(e,t){const n=t.startPTS;if(f(n)){let i,r=0;t.sn>e.sn?(r=n-e.start,i=e):(r=e.start-n,i=t),i.duration!==r&&(i.duration=r)}else if(t.sn>e.sn){const n=e.cc===t.cc;n&&e.minEndPTS?t.start=e.start+(e.minEndPTS-e.start):t.start=e.start+e.duration}else t.start=Math.max(e.start-t.duration,0)}function gn(e,t,n,i,r,a){const o=i-n;o<=0&&(w.warn("Fragment should have a positive duration",t),i=n+t.duration,a=r+t.duration);let s=n,l=i;const u=t.startPTS,c=t.endPTS;if(f(u)){const e=Math.abs(u-n);f(t.deltaPTS)?t.deltaPTS=Math.max(e,t.deltaPTS):t.deltaPTS=e,s=Math.max(n,u),n=Math.min(n,u),r=Math.min(r,t.startDTS),l=Math.min(i,c),i=Math.max(i,c),a=Math.max(a,t.endDTS)}const d=n-t.start;0!==t.start&&(t.start=n),t.duration=i-t.start,t.startPTS=n,t.maxStartPTS=s,t.startDTS=r,t.endPTS=i,t.minEndPTS=l,t.endDTS=a;const h=t.sn;if(!e||h<e.startSN||h>e.endSN)return 0;let p;const g=h-e.startSN,m=e.fragments;for(m[g]=t,p=g;p>0;p--)pn(m[p],m[p-1]);for(p=g;p<m.length-1;p++)pn(m[p],m[p+1]);return e.fragmentHint&&pn(m[m.length-1],e.fragmentHint),e.PTSKnown=e.alignedSliding=!0,d}function mn(e,t){let n=null;const i=e.fragments;for(let l=i.length-1;l>=0;l--){const e=i[l].initSegment;if(e){n=e;break}}e.fragmentHint&&delete e.fragmentHint.endPTS;let r,a=0;if(_n(e,t,(e,i)=>{e.relurl&&(a=e.cc-i.cc),f(e.startPTS)&&f(e.endPTS)&&(i.start=i.startPTS=e.startPTS,i.startDTS=e.startDTS,i.maxStartPTS=e.maxStartPTS,i.endPTS=e.endPTS,i.endDTS=e.endDTS,i.minEndPTS=e.minEndPTS,i.duration=e.endPTS-e.startPTS,i.duration&&(r=i),t.PTSKnown=t.alignedSliding=!0),i.elementaryStreams=e.elementaryStreams,i.loader=e.loader,i.stats=e.stats,e.initSegment&&(i.initSegment=e.initSegment,n=e.initSegment)}),n){const e=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments;e.forEach(e=>{var t;!e||e.initSegment&&e.initSegment.relurl!==(null==(t=n)?void 0:t.relurl)||(e.initSegment=n)})}if(t.skippedSegments)if(t.deltaUpdateFailed=t.fragments.some(e=>!e),t.deltaUpdateFailed){w.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let e=t.skippedSegments;e--;)t.fragments.shift();t.startSN=t.fragments[0].sn,t.startCC=t.fragments[0].cc}else t.canSkipDateRanges&&(t.dateRanges=vn(e.dateRanges,t.dateRanges,t.recentlyRemovedDateranges));const o=t.fragments;if(a){w.warn("discontinuity sliding from playlist, take drift into account");for(let e=0;e<o.length;e++)o[e].cc+=a}t.skippedSegments&&(t.startCC=t.fragments[0].cc),yn(e.partList,t.partList,(e,t)=>{t.elementaryStreams=e.elementaryStreams,t.stats=e.stats}),r?gn(t,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS):bn(e,t),o.length&&(t.totalduration=t.edge-o[0].start),t.driftStartTime=e.driftStartTime,t.driftStart=e.driftStart;const s=t.advancedDateTime;if(t.advanced&&s){const e=t.edge;t.driftStart||(t.driftStartTime=s,t.driftStart=e),t.driftEndTime=s,t.driftEnd=e}else t.driftEndTime=e.driftEndTime,t.driftEnd=e.driftEnd,t.advancedDateTime=e.advancedDateTime}function vn(e,t,n){const i=d({},e);return n&&n.forEach(e=>{delete i[e]}),Object.keys(t).forEach(e=>{const n=new D(t[e].attr,i[e]);n.isValid?i[e]=n:w.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(t[e].attr)}"`)}),i}function yn(e,t,n){if(e&&t){let i=0;for(let r=0,a=e.length;r<=a;r++){const a=e[r],o=t[r+i];a&&o&&a.index===o.index&&a.fragment.sn===o.fragment.sn?n(a,o):i--}}}function _n(e,t,n){const i=t.skippedSegments,r=Math.max(e.startSN,t.startSN)-t.startSN,a=(e.fragmentHint?1:0)+(i?t.endSN:Math.min(e.endSN,t.endSN))-t.startSN,o=t.startSN-e.startSN,s=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments;for(let u=r;u<=a;u++){const e=l[o+u];let r=s[u];i&&!r&&u<i&&(r=t.fragments[u]=e),e&&r&&n(e,r)}}function bn(e,t){const n=t.startSN+t.skippedSegments-e.startSN,i=e.fragments;n<0||n>=i.length||En(t,i[n].start)}function En(e,t){if(t){const n=e.fragments;for(let i=e.skippedSegments;i<n.length;i++)n[i].start+=t;e.fragmentHint&&(e.fragmentHint.start+=t)}}function Tn(e,t=1/0){let n=1e3*e.targetduration;if(e.updated){const i=e.fragments,r=4;if(i.length&&n*r>t){const e=1e3*i[i.length-1].duration;e<n&&(n=e)}}else n/=2;return Math.round(n)}function Sn(e,t,n){if(null==e||!e.details)return null;const i=e.details;let r=i.fragments[t-i.startSN];return r||(r=i.fragmentHint,r&&r.sn===t?r:t<i.startSN&&n&&n.sn===t?n:null)}function wn(e,t,n){var i;return null!=e&&e.details?An(null==(i=e.details)?void 0:i.partList,t,n):null}function An(e,t,n){if(e)for(let i=e.length;i--;){const r=e[i];if(r.index===n&&r.fragment.sn===t)return r}return null}function In(e){e.forEach((e,t)=>{const{details:n}=e;null!=n&&n.fragments&&n.fragments.forEach(e=>{e.level=t})})}function xn(e){switch(e.details){case v.FRAG_LOAD_TIMEOUT:case v.KEY_LOAD_TIMEOUT:case v.LEVEL_LOAD_TIMEOUT:case v.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Rn(e,t){const n=xn(t);return e.default[`${n?"timeout":"error"}Retry`]}function Cn(e,t){const n="linear"===e.backoff?1:Math.pow(2,t);return Math.min(n*e.retryDelayMs,e.maxRetryDelayMs)}function Dn(e){return s(s({},e),{errorRetry:null,timeoutRetry:null})}function kn(e,t,n,i){if(!e)return!1;const r=null==i?void 0:i.code,a=t<e.maxNumRetry&&(Mn(r)||!!n);return e.shouldRetry?e.shouldRetry(e,t,n,i,a):a}function Mn(e){return 0===e&&!1===navigator.onLine||!!e&&(e<400||e>499)}const Ln={search:function(e,t){let n=0,i=e.length-1,r=null,a=null;while(n<=i){r=(n+i)/2|0,a=e[r];const o=t(a);if(o>0)n=r+1;else{if(!(o<0))return a;i=r-1}}return null}};function Pn(e,t,n){if(null===t||!Array.isArray(e)||!e.length||!f(t))return null;const i=e[0].programDateTime;if(t<(i||0))return null;const r=e[e.length-1].endProgramDateTime;if(t>=(r||0))return null;n=n||0;for(let a=0;a<e.length;++a){const i=e[a];if(Un(t,n,i))return i}return null}function Nn(e,t,n=0,i=0,r=.005){let a=null;if(e){a=t[e.sn-t[0].sn+1]||null;const i=e.endDTS-n;i>0&&i<15e-7&&(n+=15e-7)}else 0===n&&0===t[0].start&&(a=t[0]);if(a&&((!e||e.level===a.level)&&0===Fn(n,i,a)||On(a,e,Math.min(r,i))))return a;const o=Ln.search(t,Fn.bind(null,n,i));return!o||o===e&&a?a:o}function On(e,t,n){if(t&&0===t.start&&t.level<e.level&&(t.endPTS||0)>0){const i=t.tagList.reduce((e,t)=>{return"INF"===t[0]&&(e+=parseFloat(t[1])),e},n);return e.start<=i}return!1}function Fn(e=0,t=0,n){if(n.start<=e&&n.start+n.duration>e)return 0;const i=Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return n.start+n.duration-i<=e?1:n.start-i>e&&n.start?-1:0}function Un(e,t,n){const i=1e3*Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0)),r=n.endProgramDateTime||0;return r-i>e}function Bn(e,t){return Ln.search(e,e=>{return e.cc<t?1:e.cc>t?-1:0})}var Gn={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},jn={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4};class Vn{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=w.log.bind(w,"[info]:"),this.warn=w.warn.bind(w,"[warning]:"),this.error=w.error.bind(w,"[error]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(g.ERROR,this.onError,this),e.on(g.MANIFEST_LOADING,this.onManifestLoading,this),e.on(g.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(g.ERROR,this.onError,this),e.off(g.ERROR,this.onErrorOut,this),e.off(g.MANIFEST_LOADING,this.onManifestLoading,this),e.off(g.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(null==e?void 0:e.type)===Ut.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var n,i;if(t.fatal)return;const r=this.hls,a=t.context;switch(t.details){case v.FRAG_LOAD_ERROR:case v.FRAG_LOAD_TIMEOUT:case v.KEY_LOAD_ERROR:case v.KEY_LOAD_TIMEOUT:return void(t.errorAction=this.getFragRetryOrSwitchAction(t));case v.FRAG_PARSING_ERROR:if(null!=(n=t.frag)&&n.gap)return void(t.errorAction={action:Gn.DoNothing,flags:jn.None});case v.FRAG_GAP:case v.FRAG_DECRYPT_ERROR:return t.errorAction=this.getFragRetryOrSwitchAction(t),void(t.errorAction.action=Gn.SendAlternateToPenaltyBox);case v.LEVEL_EMPTY_ERROR:case v.LEVEL_PARSING_ERROR:{var o,s;const e=t.parent===Ut.MAIN?t.level:r.loadLevel;t.details===v.LEVEL_EMPTY_ERROR&&null!=(o=t.context)&&null!=(s=o.levelDetails)&&s.live?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,e):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,e))}return;case v.LEVEL_LOAD_ERROR:case v.LEVEL_LOAD_TIMEOUT:return void("number"===typeof(null==a?void 0:a.level)&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,a.level)));case v.AUDIO_TRACK_LOAD_ERROR:case v.AUDIO_TRACK_LOAD_TIMEOUT:case v.SUBTITLE_LOAD_ERROR:case v.SUBTITLE_TRACK_LOAD_TIMEOUT:if(a){const e=r.levels[r.loadLevel];if(e&&(a.type===Ft.AUDIO_TRACK&&e.hasAudioGroup(a.groupId)||a.type===Ft.SUBTITLE_TRACK&&e.hasSubtitleGroup(a.groupId)))return t.errorAction=this.getPlaylistRetryOrSwitchAction(t,r.loadLevel),t.errorAction.action=Gn.SendAlternateToPenaltyBox,void(t.errorAction.flags=jn.MoveAllAlternatesMatchingHost)}return;case v.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const e=r.levels[r.loadLevel],n=null==e?void 0:e.attrs["HDCP-LEVEL"];n?t.errorAction={action:Gn.SendAlternateToPenaltyBox,flags:jn.MoveAllAlternatesMatchingHDCP,hdcpLevel:n}:this.keySystemError(t)}return;case v.BUFFER_ADD_CODEC_ERROR:case v.REMUX_ALLOC_ERROR:case v.BUFFER_APPEND_ERROR:return void(t.errorAction=this.getLevelSwitchAction(t,null!=(i=t.level)?i:r.loadLevel));case v.INTERNAL_EXCEPTION:case v.BUFFER_APPENDING_ERROR:case v.BUFFER_FULL_ERROR:case v.LEVEL_SWITCH_ERROR:case v.BUFFER_STALLED_ERROR:case v.BUFFER_SEEK_OVER_HOLE:case v.BUFFER_NUDGE_ON_STALL:return void(t.errorAction={action:Gn.DoNothing,flags:jn.None})}t.type===m.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const n=this.hls,i=Rn(n.config.playlistLoadPolicy,e),r=this.playlistError++,a=kn(i,r,xn(e),e.response);if(a)return{action:Gn.RetryRequest,flags:jn.None,retryConfig:i,retryCount:r};const o=this.getLevelSwitchAction(e,t);return i&&(o.retryConfig=i,o.retryCount=r),o}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),i=t.levels[n],{fragLoadPolicy:r,keyLoadPolicy:a}=t.config,o=Rn(e.details.startsWith("key")?a:r,e),s=t.levels.reduce((e,t)=>e+t.fragmentError,0);if(i){e.details!==v.FRAG_GAP&&i.fragmentError++;const t=kn(o,s,xn(e),e.response);if(t)return{action:Gn.RetryRequest,flags:jn.None,retryConfig:o,retryCount:s}}const l=this.getLevelSwitchAction(e,n);return o&&(l.retryConfig=o,l.retryCount=s),l}getLevelSwitchAction(e,t){const n=this.hls;null!==t&&void 0!==t||(t=n.loadLevel);const i=this.hls.levels[t];if(i){var r,a;const t=e.details;i.loadError++,t===v.BUFFER_APPEND_ERROR&&i.fragmentError++;let l=-1;const{levels:u,loadLevel:c,minAutoLevel:d,maxAutoLevel:f}=n;n.autoLevelEnabled||(n.loadLevel=-1);const h=null==(r=e.frag)?void 0:r.type,p=h===Ut.AUDIO&&t===v.FRAG_PARSING_ERROR||"audio"===e.sourceBufferName&&(t===v.BUFFER_ADD_CODEC_ERROR||t===v.BUFFER_APPEND_ERROR),g=p&&u.some(({audioCodec:e})=>i.audioCodec!==e),m="video"===e.sourceBufferName&&(t===v.BUFFER_ADD_CODEC_ERROR||t===v.BUFFER_APPEND_ERROR),y=m&&u.some(({codecSet:e,audioCodec:t})=>i.codecSet!==e&&i.audioCodec===t),{type:_,groupId:b}=null!=(a=e.context)?a:{};for(let n=u.length;n--;){const r=(n+c)%u.length;if(r!==c&&r>=d&&r<=f&&0===u[r].loadError){var o,s;const n=u[r];if(t===v.FRAG_GAP&&h===Ut.MAIN&&e.frag){const t=u[r].details;if(t){const n=Nn(e.frag,t.fragments,e.frag.start);if(null!=n&&n.gap)continue}}else{if(_===Ft.AUDIO_TRACK&&n.hasAudioGroup(b)||_===Ft.SUBTITLE_TRACK&&n.hasSubtitleGroup(b))continue;if(h===Ut.AUDIO&&null!=(o=i.audioGroups)&&o.some(e=>n.hasAudioGroup(e))||h===Ut.SUBTITLE&&null!=(s=i.subtitleGroups)&&s.some(e=>n.hasSubtitleGroup(e))||g&&i.audioCodec===n.audioCodec||!g&&i.audioCodec!==n.audioCodec||y&&i.codecSet===n.codecSet)continue}l=r;break}}if(l>-1&&n.loadLevel!==l)return e.levelRetry=!0,this.playlistError=0,{action:Gn.SendAlternateToPenaltyBox,flags:jn.None,nextAutoLevel:l}}return{action:Gn.SendAlternateToPenaltyBox,flags:jn.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var n;switch(null==(n=t.errorAction)?void 0:n.action){case Gn.DoNothing:break;case Gn.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),t.errorAction.resolved||t.details===v.FRAG_GAP?/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError()):t.fatal=!0;break;case Gn.RetryRequest:break}t.fatal&&this.hls.stopLoad()}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:i,hdcpLevel:r,nextAutoLevel:a}=n;switch(i){case jn.None:this.switchLevel(e,a);break;case jn.MoveAllAlternatesMatchingHDCP:r&&(t.maxHdcpLevel=an[an.indexOf(r)-1],n.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}n.resolved||this.switchLevel(e,a)}switchLevel(e,t){void 0!==t&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}}class Hn{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=w.log.bind(w,`${t}:`),this.warn=w.warn.bind(w,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){-1!==this.timer&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,n){const i=null==t?void 0:t.renditionReports;if(i){let r=-1;for(let n=0;n<i.length;n++){const a=i[n];let o;try{o=new self.URL(a.URI,t.url).href}catch(e){w.warn(`Could not construct new URL for Rendition Report: ${e}`),o=a.URI||""}if(o===e){r=n;break}o===e.substring(0,o.length)&&(r=n)}if(-1!==r){const e=i[r],a=parseInt(e["LAST-MSN"])||(null==t?void 0:t.lastPartSn);let o=parseInt(e["LAST-PART"])||(null==t?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const e=Math.min(t.age-t.partTarget,t.targetduration);o>=0&&e>t.partTarget&&(o+=1)}const s=n&&cn(n);return new dn(a,o>=0?o:void 0,s)}}}loadPlaylist(e){-1===this.requestScheduled&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return-1===this.timer&&-1===this.requestScheduled&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,n){const{details:i,stats:r}=t,a=self.performance.now(),o=r.loading.first?Math.max(0,a-r.loading.first):0;if(i.advancedDateTime=Date.now()-o,i.live||null!=n&&n.live){if(i.reloaded(n),n&&this.log(`live playlist ${e} ${i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:i.updated?"UPDATED":"MISSED"}`),n&&i.fragments.length>0&&mn(n,i),!this.canLoad||!i.live)return;let o,s=void 0,l=void 0;if(i.canBlockReload&&i.endSN&&i.advanced){const e=this.hls.config.lowLatencyMode,r=i.lastPartSn,a=i.endSN,u=i.lastPartIndex,c=-1!==u,d=r===a,f=e?0:u;c?(s=d?a+1:r,l=d?f:u+1):s=a+1;const h=i.age,p=h+i.ageHeader;let g=Math.min(p-i.partTarget,1.5*i.targetduration);if(g>0){if(n&&g>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${g} with playlist age: ${i.age}`),g=0;else{const e=Math.floor(g/i.targetduration);if(s+=e,void 0!==l){const e=Math.round(g%i.targetduration/i.partTarget);l+=e}this.log(`CDN Tune-in age: ${i.ageHeader}s last advanced ${h.toFixed(2)}s goal: ${g} skip sn ${e} to part ${l}`)}i.tuneInGoal=g}if(o=this.getDeliveryDirectives(i,t.deliveryDirectives,s,l),e||!d)return void this.loadPlaylist(o)}else(i.canBlockReload||i.canSkipUntil)&&(o=this.getDeliveryDirectives(i,t.deliveryDirectives,s,l));const u=this.hls.mainForwardBufferInfo,c=u?u.end-u.len:0,d=1e3*(i.edge-c),f=Tn(i,d);i.updated&&a>this.requestScheduled+f&&(this.requestScheduled=r.loading.start),void 0!==s&&i.canBlockReload?this.requestScheduled=r.loading.first+f-(1e3*i.partTarget||1e3):-1===this.requestScheduled||this.requestScheduled+f<a?this.requestScheduled=a:this.requestScheduled-a<=0&&(this.requestScheduled+=f);let h=this.requestScheduled-a;h=Math.max(0,h),this.log(`reload live playlist ${e} in ${Math.round(h)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(o),h)}else this.clearTimer()}getDeliveryDirectives(e,t,n,i){let r=cn(e);return null!=t&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,i=t.part,r=un.No),new dn(n,i,r)}checkRetry(e){const t=e.details,n=xn(e),i=e.errorAction,{action:r,retryCount:a=0,retryConfig:o}=i||{},s=!!i&&!!o&&(r===Gn.RetryRequest||!i.resolved&&r===Gn.SendAlternateToPenaltyBox);if(s){var l;if(this.requestScheduled=-1,a>=o.maxNumRetry)return!1;if(n&&null!=(l=e.context)&&l.deliveryDirectives)this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const e=Cn(o,a);this.timer=self.setTimeout(()=>this.loadPlaylist(),e),this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${t}" in ${e}ms`)}e.levelRetry=!0,i.resolved=!0}return s}}class Kn{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class zn{constructor(e,t,n,i=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Kn(e),this.fast_=new Kn(t),this.defaultTTFB_=i,this.ttfb_=new Kn(e)}update(e,t){const{slow_:n,fast_:i,ttfb_:r}=this;n.halfLife!==e&&(this.slow_=new Kn(e,n.getEstimate(),n.getTotalWeight())),i.halfLife!==t&&(this.fast_=new Kn(t,i.getEstimate(),i.getTotalWeight())),r.halfLife!==e&&(this.ttfb_=new Kn(e,r.getEstimate(),r.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const n=8*t,i=e/1e3,r=n/i;this.fast_.sample(i,r),this.slow_.sample(i,r)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}const Zn={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},qn={};function Yn(e,t,n,i,r,a){const o=e.audioCodec?e.audioGroups:null,s=null==a?void 0:a.audioCodec,l=null==a?void 0:a.channels,u=l?parseInt(l):s?1/0:2;let c=null;if(null!=o&&o.length)try{c=1===o.length&&o[0]?t.groups[o[0]].channels:o.reduce((e,n)=>{if(n){const i=t.groups[n];if(!i)throw new Error(`Audio track group ${n} not found`);Object.keys(i.channels).forEach(t=>{e[t]=(e[t]||0)+i.channels[t]})}return e},{2:0})}catch(e){return!0}return void 0!==e.videoCodec&&(e.width>1920&&e.height>1088||e.height>1920&&e.width>1088||e.frameRate>Math.max(i,30)||"SDR"!==e.videoRange&&e.videoRange!==n||e.bitrate>Math.max(r,8e6))||!!c&&f(u)&&Object.keys(c).some(e=>parseInt(e)>u)}function Wn(e,t,n){const i=e.videoCodec,r=e.audioCodec;if(!i||!r||!n)return Promise.resolve(Zn);const a={width:e.width,height:e.height,bitrate:Math.ceil(Math.max(.9*e.bitrate,e.averageBitrate)),framerate:e.frameRate||30},o=e.videoRange;"SDR"!==o&&(a.transferFunction=o.toLowerCase());const l=i.split(",").map(e=>({type:"media-source",video:s(s({},a),{},{contentType:pt(e,"video")})}));return r&&e.audioGroups&&e.audioGroups.forEach(e=>{var n;e&&(null==(n=t.groups[e])||n.tracks.forEach(t=>{if(t.groupId===e){const e=t.channels||"",n=parseFloat(e);f(n)&&n>2&&l.push.apply(l,r.split(",").map(e=>({type:"media-source",audio:{contentType:pt(e,"audio"),channels:""+n}})))}}))}),Promise.all(l.map(e=>{const t=$n(e);return qn[t]||(qn[t]=n.decodingInfo(e))})).then(e=>({supported:!e.some(e=>!e.supported),configurations:l,decodingInfoResults:e})).catch(e=>({supported:!1,configurations:l,decodingInfoResults:[],error:e}))}function $n(e){const{audio:t,video:n}=e,i=n||t;if(i){const e=i.contentType.split('"')[1];if(n)return`r${n.height}x${n.width}f${Math.ceil(n.framerate)}${n.transferFunction||"sd"}_${e}_${Math.ceil(n.bitrate/1e5)}`;if(t)return`c${t.channels}${t.spatialRendering?"s":"n"}_${e}`}return""}function Xn(){if("function"===typeof matchMedia){const e=matchMedia("(dynamic-range: high)"),t=matchMedia("bad query");if(e.media!==t.media)return!0===e.matches}return!1}function Qn(e,t){let n=!1,i=[];return e&&(n="SDR"!==e,i=[e]),t&&(i=t.allowedVideoRanges||sn.slice(0),n=void 0!==t.preferHDR?t.preferHDR:Xn(),i=n?i.filter(e=>"SDR"!==e):["SDR"]),{preferHDR:n,allowedVideoRanges:i}}function Jn(e,t,n,i,r){const a=Object.keys(e),o=null==i?void 0:i.channels,s=null==i?void 0:i.audioCodec,l=o&&2===parseInt(o);let u=!0,c=!1,d=1/0,h=1/0,p=1/0,g=0,m=[];const{preferHDR:v,allowedVideoRanges:y}=Qn(t,r);for(let f=a.length;f--;){const t=e[a[f]];u=t.channels[2]>0,d=Math.min(d,t.minHeight),h=Math.min(h,t.minFramerate),p=Math.min(p,t.minBitrate);const n=y.filter(e=>t.videoRanges[e]>0);n.length>0&&(c=!0,m=n)}d=f(d)?d:0,h=f(h)?h:0;const _=Math.max(1080,d),b=Math.max(30,h);p=f(p)?p:n,n=Math.max(p,n),c||(t=void 0,m=[]);const E=a.reduce((t,i)=>{const r=e[i];if(i===t)return t;if(r.minBitrate>n)return ei(i,`min bitrate of ${r.minBitrate} > current estimate of ${n}`),t;if(!r.hasDefaultAudio)return ei(i,"no renditions with default or auto-select sound found"),t;if(s&&i.indexOf(s.substring(0,4))%5!==0)return ei(i,`audio codec preference "${s}" not found`),t;if(o&&!l){if(!r.channels[o])return ei(i,`no renditions with ${o} channel sound found (channels options: ${Object.keys(r.channels)})`),t}else if((!s||l)&&u&&0===r.channels["2"])return ei(i,"no renditions with stereo sound found"),t;return r.minHeight>_?(ei(i,`min resolution of ${r.minHeight} > maximum of ${_}`),t):r.minFramerate>b?(ei(i,`min framerate of ${r.minFramerate} > maximum of ${b}`),t):m.some(e=>r.videoRanges[e]>0)?r.maxScore<g?(ei(i,`max score of ${r.maxScore} < selected max of ${g}`),t):t&&(mt(i)>=mt(t)||r.fragmentError>e[t].fragmentError)?t:(g=r.maxScore,i):(ei(i,`no variants with VIDEO-RANGE of ${JSON.stringify(m)} found`),t)},void 0);return{codecSet:E,videoRanges:m,preferHDR:v,minFramerate:h,minBitrate:p}}function ei(e,t){w.log(`[abr] start candidates with "${e}" ignored because ${t}`)}function ti(e){return e.reduce((e,t)=>{let n=e.groups[t.groupId];n||(n=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(t);const i=t.channels||"2";return n.channels[i]=(n.channels[i]||0)+1,n.hasDefault=n.hasDefault||t.default,n.hasAutoSelect=n.hasAutoSelect||t.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function ni(e,t,n,i){return e.slice(n,i+1).reduce((e,n)=>{if(!n.codecSet)return e;const i=n.audioGroups;let r=e[n.codecSet];r||(e[n.codecSet]=r={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!i,fragmentError:0}),r.minBitrate=Math.min(r.minBitrate,n.bitrate);const a=Math.min(n.height,n.width);return r.minHeight=Math.min(r.minHeight,a),r.minFramerate=Math.min(r.minFramerate,n.frameRate),r.maxScore=Math.max(r.maxScore,n.score),r.fragmentError+=n.fragmentError,r.videoRanges[n.videoRange]=(r.videoRanges[n.videoRange]||0)+1,i&&i.forEach(e=>{if(!e)return;const n=t.groups[e];n&&(r.hasDefaultAudio=r.hasDefaultAudio||t.hasDefaultAudio?n.hasDefault:n.hasAutoSelect||!t.hasDefaultAudio&&!t.hasAutoSelectAudio,Object.keys(n.channels).forEach(e=>{r.channels[e]=(r.channels[e]||0)+n.channels[e]}))}),e},{})}function ii(e,t,n){if("attrs"in e){const n=t.indexOf(e);if(-1!==n)return n}for(let i=0;i<t.length;i++){const r=t[i];if(ri(e,r,n))return i}return-1}function ri(e,t,n){const{groupId:i,name:r,lang:a,assocLang:o,characteristics:s,default:l}=e,u=e.forced;return(void 0===i||t.groupId===i)&&(void 0===r||t.name===r)&&(void 0===a||t.lang===a)&&(void 0===a||t.assocLang===o)&&(void 0===l||t.default===l)&&(void 0===u||t.forced===u)&&(void 0===s||ai(s,t.characteristics))&&(void 0===n||n(e,t))}function ai(e,t=""){const n=e.split(","),i=t.split(",");return n.length===i.length&&!n.some(e=>-1===i.indexOf(e))}function oi(e,t){const{audioCodec:n,channels:i}=e;return(void 0===n||(t.audioCodec||"").substring(0,4)===n.substring(0,4))&&(void 0===i||i===(t.channels||"2"))}function si(e,t,n,i,r){const a=t[i],o=t.reduce((e,t,n)=>{const i=t.uri,r=e[i]||(e[i]=[]);return r.push(n),e},{}),s=o[a.uri];s.length>1&&(i=Math.max.apply(Math,s));const l=a.videoRange,u=a.frameRate,c=a.codecSet.substring(0,4),d=li(t,i,t=>{if(t.videoRange!==l||t.frameRate!==u||t.codecSet.substring(0,4)!==c)return!1;const i=t.audioGroups,a=n.filter(e=>!i||-1!==i.indexOf(e.groupId));return ii(e,a,r)>-1});return d>-1?d:li(t,i,t=>{const i=t.audioGroups,a=n.filter(e=>!i||-1!==i.indexOf(e.groupId));return ii(e,a,r)>-1})}function li(e,t,n){for(let i=t;i;i--)if(n(e[i]))return i;for(let i=t+1;i<e.length;i++)if(n(e[i]))return i;return-1}class ui{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this._abandonRulesCheck=(()=>{const{fragCurrent:e,partCurrent:t,hls:n}=this,{autoLevelEnabled:i,media:r}=n;if(!e||!r)return;const a=performance.now(),o=t?t.stats:e.stats,s=t?t.duration:e.duration,l=a-o.loading.start,u=n.minAutoLevel;if(o.aborted||o.loaded&&o.loaded===o.total||e.level<=u)return this.clearTimer(),void(this._nextAutoLevel=-1);if(!i||r.paused||!r.playbackRate||!r.readyState)return;const c=n.mainForwardBufferInfo;if(null===c)return;const d=this.bwEstimator.getEstimateTTFB(),h=Math.abs(r.playbackRate);if(l<=Math.max(d,s/(2*h)*1e3))return;const p=c.len/h,m=o.loading.first?o.loading.first-o.loading.start:-1,v=o.loaded&&m>-1,y=this.getBwEstimate(),_=n.levels,b=_[e.level],E=o.total||Math.max(o.loaded,Math.round(s*b.averageBitrate/8));let T=v?l-m:l;T<1&&v&&(T=Math.min(l,8*o.loaded/y));const S=v?1e3*o.loaded/T:0,A=S?(E-o.loaded)/S:8*E/y+d/1e3;if(A<=p)return;const I=S?8*S:y;let x,R=Number.POSITIVE_INFINITY;for(x=e.level-1;x>u;x--){const e=_[x].maxBitrate;if(R=this.getTimeToLoadFrag(d/1e3,I,s*e,!_[x].details),R<p)break}if(R>=A)return;if(R>10*s)return;n.nextLoadLevel=n.nextAutoLevel=x,v?this.bwEstimator.sample(l-Math.min(d,m),o.loaded):this.bwEstimator.sampleTTFB(l);const C=_[x].maxBitrate;this.getBwEstimate()*this.hls.config.abrBandWidthUpFactor>C&&this.resetEstimator(C),this.clearTimer(),w.warn(`[abr] Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} is loading too slowly;\n      Time to underbuffer: ${p.toFixed(3)} s\n      Estimated load time for current fragment: ${A.toFixed(3)} s\n      Estimated load time for down switch fragment: ${R.toFixed(3)} s\n      TTFB estimate: ${0|m} ms\n      Current BW estimate: ${f(y)?0|y:"Unknown"} bps\n      New BW estimate: ${0|this.getBwEstimate()} bps\n      Switching to level ${x} @ ${0|C} bps`),n.trigger(g.FRAG_LOAD_EMERGENCY_ABORTED,{frag:e,part:t,stats:o})}),this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(w.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new zn(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(g.MANIFEST_LOADING,this.onManifestLoading,this),e.on(g.FRAG_LOADING,this.onFragLoading,this),e.on(g.FRAG_LOADED,this.onFragLoaded,this),e.on(g.FRAG_BUFFERED,this.onFragBuffered,this),e.on(g.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(g.LEVEL_LOADED,this.onLevelLoaded,this),e.on(g.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(g.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(g.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(g.MANIFEST_LOADING,this.onManifestLoading,this),e.off(g.FRAG_LOADING,this.onFragLoading,this),e.off(g.FRAG_LOADED,this.onFragLoaded,this),e.off(g.FRAG_BUFFERED,this.onFragBuffered,this),e.off(g.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(g.LEVEL_LOADED,this.onLevelLoaded,this),e.off(g.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(g.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(g.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const n=t.frag;if(!this.ignoreFragment(n)){var i;if(!n.bitrateTest)this.fragCurrent=n,this.partCurrent=null!=(i=t.part)?i:null;this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case v.BUFFER_ADD_CODEC_ERROR:case v.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case v.FRAG_LOAD_TIMEOUT:{const e=t.frag,{fragCurrent:n,partCurrent:i}=this;if(e&&n&&e.sn===n.sn&&e.level===n.level){const t=performance.now(),n=i?i.stats:e.stats,r=t-n.loading.start,a=n.loading.first?n.loading.first-n.loading.start:-1,o=n.loaded&&a>-1;if(o){const e=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(r-Math.min(e,a),n.loaded)}else this.bwEstimator.sampleTTFB(r)}break}}}getTimeToLoadFrag(e,t,n,i){const r=e+n/t,a=i?this.lastLevelLoadSec:0;return r+a}onLevelLoaded(e,t){const n=this.hls.config,{loading:i}=t.stats,r=i.end-i.start;f(r)&&(this.lastLevelLoadSec=r/1e3),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD)}onFragLoaded(e,{frag:t,part:n}){const i=n?n.stats:t.stats;if(t.type===Ut.MAIN&&this.bwEstimator.sampleTTFB(i.loading.first-i.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const e=n?n.duration:t.duration,r=this.hls.levels[t.level],a=(r.loaded?r.loaded.bytes:0)+i.loaded,o=(r.loaded?r.loaded.duration:0)+e;r.loaded={bytes:a,duration:o},r.realBitrate=Math.round(8*a/o)}if(t.bitrateTest){const e={stats:i,frag:t,part:n,id:t.type};this.onFragBuffered(g.FRAG_BUFFERED,e),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:n,part:i}=t,r=null!=i&&i.stats.loaded?i.stats:n.stats;if(r.aborted)return;if(this.ignoreFragment(n))return;const a=r.parsing.end-r.loading.start-Math.min(r.loading.first-r.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(a,r.loaded),r.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==Ut.MAIN||"initSegment"===e.sn}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,n=this.getBwEstimate(),i=this.hls.config.maxStarvationDelay,r=this.findBestLevel(n,t,e,0,i,1,1);if(r>-1)return r;const a=this.hls.firstLevel,o=Math.min(Math.max(a,t),e);return w.warn(`[abr] Could not find best starting auto level. Defaulting to first in playlist ${a} clamped to ${o}`),o}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,t=this.bwEstimator,n=t.canEstimate(),i=this.lastLoadedFragLevel>-1;if(-1!==e&&(!n||!i||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const r=n&&i?this.getNextABRAutoLevel():this.firstAutoLevel;if(-1!==e){const t=this.hls.levels;if(t.length>Math.max(e,r)&&t[e].loadError<=t[r].loadError)return e}return this._nextAutoLevel=r,this.nextAutoLevelKey=this.getAutoLevelKey(),r}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this,{maxAutoLevel:i,config:r,minAutoLevel:a}=n,o=t?t.duration:e?e.duration:0,s=this.getBwEstimate(),l=this.getStarvationDelay();let u=r.abrBandWidthFactor,c=r.abrBandWidthUpFactor;if(l){const e=this.findBestLevel(s,a,i,l,0,u,c);if(e>=0)return e}let d=o?Math.min(o,r.maxStarvationDelay):r.maxStarvationDelay;if(!l){const e=this.bitrateTestDelay;if(e){const t=o?Math.min(o,r.maxLoadingDelay):r.maxLoadingDelay;d=t-e,w.info(`[abr] bitrate test took ${Math.round(1e3*e)}ms, set first fragment max fetchDuration to ${Math.round(1e3*d)} ms`),u=c=1}}const f=this.findBestLevel(s,a,i,l,d,u,c);if(w.info(`[abr] ${l?"rebuffering expected":"buffer is empty"}, optimal quality level ${f}`),f>-1)return f;const h=n.levels[a],p=n.levels[n.loadLevel];return(null==h?void 0:h.bitrate)<(null==p?void 0:p.bitrate)?a:n.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const n=t&&0!==t.playbackRate?Math.abs(t.playbackRate):1,i=e.mainForwardBufferInfo;return(i?i.len:0)/n}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,n,i,r,a,o){var s;const l=i+r,u=this.lastLoadedFragLevel,c=-1===u?this.hls.firstLevel:u,{fragCurrent:d,partCurrent:h}=this,{levels:p,allAudioTracks:g,loadLevel:m,config:v}=this.hls;if(1===p.length)return 0;const y=p[c],_=!(null==y||null==(s=y.details)||!s.live),b=-1===m||-1===u;let E,T="SDR",S=(null==y?void 0:y.frameRate)||0;const{audioPreference:A,videoPreference:I}=v,x=this.audioTracksByGroup||(this.audioTracksByGroup=ti(g));if(b){if(-1!==this.firstSelection)return this.firstSelection;const i=this.codecTiers||(this.codecTiers=ni(p,x,t,n)),r=Jn(i,T,e,A,I),{codecSet:a,videoRanges:o,minFramerate:s,minBitrate:l,preferHDR:u}=r;E=a,T=u?o[o.length-1]:o[0],S=s,e=Math.max(e,l),w.log(`[abr] picked start tier ${JSON.stringify(r)}`)}else E=null==y?void 0:y.codecSet,T=null==y?void 0:y.videoRange;const R=h?h.duration:d?d.duration:0,C=this.bwEstimator.getEstimateTTFB()/1e3,D=[];for(let M=n;M>=t;M--){var k;const t=p[M],s=M>c;if(!t)continue;if(v.useMediaCapabilities&&!t.supportedResult&&!t.supportedPromise){const n=navigator.mediaCapabilities;"function"===typeof(null==n?void 0:n.decodingInfo)&&Yn(t,x,T,S,e,A)?(t.supportedPromise=Wn(t,x,n),t.supportedPromise.then(e=>{if(!this.hls)return;t.supportedResult=e;const n=this.hls.levels,i=n.indexOf(t);e.error?w.warn(`[abr] MediaCapabilities decodingInfo error: "${e.error}" for level ${i} ${JSON.stringify(e)}`):e.supported||(w.warn(`[abr] Unsupported MediaCapabilities decodingInfo result for level ${i} ${JSON.stringify(e)}`),i>-1&&n.length>1&&(w.log(`[abr] Removing unsupported level ${i}`),this.hls.removeLevel(i)))})):t.supportedResult=Zn}if(E&&t.codecSet!==E||T&&t.videoRange!==T||s&&S>t.frameRate||!s&&S>0&&S<t.frameRate||t.supportedResult&&(null==(k=t.supportedResult.decodingInfoResults)||!k[0].smooth)){D.push(M);continue}const d=t.details,g=(h?null==d?void 0:d.partTarget:null==d?void 0:d.averagetargetduration)||R;let I;I=s?o*e:a*e;const L=R&&i>=2*R&&0===r?p[M].averageBitrate:p[M].maxBitrate,P=this.getTimeToLoadFrag(C,I,L*g,void 0===d),N=I>=L&&(M===u||0===t.loadError&&0===t.fragmentError)&&(P<=C||!f(P)||_&&!this.bitrateTestDelay||P<l);if(N){const e=this.forcedAutoLevel;return M===m||-1!==e&&e===m||(D.length&&w.trace(`[abr] Skipped level(s) ${D.join(",")} of ${n} max with CODECS and VIDEO-RANGE:"${p[D[0]].codecs}" ${p[D[0]].videoRange}; not compatible with "${y.codecs}" ${T}`),w.info(`[abr] switch candidate:${c}->${M} adjustedbw(${Math.round(I)})-bitrate=${Math.round(I-L)} ttfb:${C.toFixed(1)} avgDuration:${g.toFixed(1)} maxFetchDuration:${l.toFixed(1)} fetchDuration:${P.toFixed(1)} firstSelection:${b} codecSet:${E} videoRange:${T} hls.loadLevel:${m}`)),b&&(this.firstSelection=M),M}}return-1}set nextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:n}=this.hls,i=Math.min(Math.max(e,n),t);this._nextAutoLevel!==i&&(this.nextAutoLevelKey="",this._nextAutoLevel=i)}}class ci{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)}clearNextTick(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}var di={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class fi{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(g.BUFFER_APPENDED,this.onBufferAppended,this),e.on(g.FRAG_BUFFERED,this.onFragBuffered,this),e.on(g.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(g.BUFFER_APPENDED,this.onBufferAppended,this),e.off(g.FRAG_BUFFERED,this.onFragBuffered,this),e.off(g.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let i=n.length;i--;){const t=n[i];if(!t)break;const r=t.end;if(t.start<=e&&null!==r&&e<=r)return t}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){const{fragments:n}=this,i=Object.keys(n);for(let r=i.length;r--;){const a=n[i[r]];if((null==a?void 0:a.body.type)===t&&a.buffered){const t=a.body;if(t.start<=e&&e<=t.end)return t}}return null}detectEvictedFragments(e,t,n,i){this.timeRanges&&(this.timeRanges[e]=t);const r=(null==i?void 0:i.fragment.sn)||-1;Object.keys(this.fragments).forEach(i=>{const a=this.fragments[i];if(!a)return;if(r>=a.body.sn)return;if(!a.buffered&&!a.loaded)return void(a.body.type===n&&this.removeFragment(a.body));const o=a.range[e];o&&o.time.some(e=>{const n=!this.isTimeBuffered(e.startPTS,e.endPTS,t);return n&&this.removeFragment(a.body),n})})}detectPartialFragments(e){const t=this.timeRanges,{frag:n,part:i}=e;if(!t||"initSegment"===n.sn)return;const r=pi(n),a=this.fragments[r];if(!a||a.buffered&&n.gap)return;const o=!n.relurl;if(Object.keys(t).forEach(e=>{const r=n.elementaryStreams[e];if(!r)return;const s=t[e],l=o||!0===r.partial;a.range[e]=this.getBufferedTimes(n,i,l,s)}),a.loaded=null,Object.keys(a.range).length){a.buffered=!0;const e=a.body.endList=n.endList||a.body.endList;e&&(this.endListFragments[a.body.type]=a),hi(a)||this.removeParts(n.sn-1,n.type)}else this.removeFragment(a.body)}removeParts(e,t){const n=this.activePartLists[t];n&&(this.activePartLists[t]=n.filter(t=>t.fragment.sn>=e))}fragBuffered(e,t){const n=pi(e);let i=this.fragments[n];!i&&t&&(i=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),i&&(i.loaded=null,i.buffered=!0)}getBufferedTimes(e,t,n,i){const r={time:[],partial:n},a=e.start,o=e.end,s=e.minEndPTS||o,l=e.maxStartPTS||a;for(let u=0;u<i.length;u++){const e=i.start(u)-this.bufferPadding,t=i.end(u)+this.bufferPadding;if(l>=e&&s<=t){r.time.push({startPTS:Math.max(a,i.start(u)),endPTS:Math.min(o,i.end(u))});break}if(a<t&&o>e){const e=Math.max(a,i.start(u)),t=Math.min(o,i.end(u));t>e&&(r.partial=!0,r.time.push({startPTS:e,endPTS:t}))}else if(o<=e)break}return r}getPartialFragment(e){let t,n,i,r=null,a=0;const{bufferPadding:o,fragments:s}=this;return Object.keys(s).forEach(l=>{const u=s[l];u&&hi(u)&&(n=u.body.start-o,i=u.body.end+o,e>=n&&e<=i&&(t=Math.min(e-n,i-e),a<=t&&(r=u.body,a=t)))}),r}isEndListAppended(e){const t=this.endListFragments[e];return void 0!==t&&(t.buffered||hi(t))}getState(e){const t=pi(e),n=this.fragments[t];return n?n.buffered?hi(n)?di.PARTIAL:di.OK:di.APPENDING:di.NOT_LOADED}isTimeBuffered(e,t,n){let i,r;for(let a=0;a<n.length;a++){if(i=n.start(a)-this.bufferPadding,r=n.end(a)+this.bufferPadding,e>=i&&t<=r)return!0;if(t<=i)return!1}return!1}onFragLoaded(e,t){const{frag:n,part:i}=t;if("initSegment"===n.sn||n.bitrateTest)return;const r=i?null:t,a=pi(n);this.fragments[a]={body:n,appendedPTS:null,loaded:r,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:i,timeRanges:r}=t;if("initSegment"===n.sn)return;const a=n.type;if(i){let e=this.activePartLists[a];e||(this.activePartLists[a]=e=[]),e.push(i)}this.timeRanges=r,Object.keys(r).forEach(e=>{const t=r[e];this.detectEvictedFragments(e,t,a,i)})}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=pi(e);return!!this.fragments[t]}hasParts(e){var t;return!(null==(t=this.activePartLists[e])||!t.length)}removeFragmentsInRange(e,t,n,i,r){i&&!this.hasGaps||Object.keys(this.fragments).forEach(a=>{const o=this.fragments[a];if(!o)return;const s=o.body;s.type!==n||i&&!s.gap||s.start<t&&s.end>e&&(o.buffered||r)&&this.removeFragment(s)})}removeFragment(e){const t=pi(e);e.stats.loaded=0,e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const t=e.sn;this.activePartLists[e.type]=n.filter(e=>e.fragment.sn!==t)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function hi(e){var t,n,i;return e.buffered&&(e.body.gap||(null==(t=e.range.video)?void 0:t.partial)||(null==(n=e.range.audio)?void 0:n.partial)||(null==(i=e.range.audiovideo)?void 0:i.partial))}function pi(e){return`${e.type}_${e.level}_${e.sn}`}const gi={length:0,start:()=>0,end:()=>0};class mi{static isBuffered(e,t){try{if(e){const n=mi.getBuffered(e);for(let e=0;e<n.length;e++)if(t>=n.start(e)&&t<=n.end(e))return!0}}catch(e){}return!1}static bufferInfo(e,t,n){try{if(e){const i=mi.getBuffered(e),r=[];let a;for(a=0;a<i.length;a++)r.push({start:i.start(a),end:i.end(a)});return this.bufferedInfo(r,t,n)}}catch(e){}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.sort(function(e,t){const n=e.start-t.start;return n||t.end-e.end});let i=[];if(n)for(let l=0;l<e.length;l++){const t=i.length;if(t){const r=i[t-1].end;e[l].start-r<n?e[l].end>r&&(i[t-1].end=e[l].end):i.push(e[l])}else i.push(e[l])}else i=e;let r,a=0,o=t,s=t;for(let l=0;l<i.length;l++){const e=i[l].start,u=i[l].end;if(t+n>=e&&t<u)o=e,s=u,a=s-t;else if(t+n<e){r=e;break}}return{len:a,start:o||0,end:s||0,nextStart:r}}static getBuffered(e){try{return e.buffered}catch(e){return w.log("failed to get media.buffered",e),gi}}}class vi{constructor(e,t,n,i=0,r=-1,a=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=yi(),this.buffering={audio:yi(),video:yi(),audiovideo:yi()},this.level=e,this.sn=t,this.id=n,this.size=i,this.part=r,this.partial=a}}function yi(){return{start:0,executeStart:0,executeEnd:0,end:0}}function _i(e,t){for(let i=0,r=e.length;i<r;i++){var n;if((null==(n=e[i])?void 0:n.cc)===t)return e[i]}return null}function bi(e,t,n){return!(!t||!(n.endCC>n.startCC||e&&e.cc<n.startCC))}function Ei(e,t){const n=e.fragments,i=t.fragments;if(!i.length||!n.length)return void w.log("No fragments to align");const r=_i(n,i[0].cc);if(r&&(!r||r.startPTS))return r;w.log("No frag in previous level to align on")}function Ti(e,t){if(e){const n=e.start+t;e.start=e.startPTS=n,e.endPTS=n+e.duration}}function Si(e,t){const n=t.fragments;for(let i=0,r=n.length;i<r;i++)Ti(n[i],e);t.fragmentHint&&Ti(t.fragmentHint,e),t.alignedSliding=!0}function wi(e,t,n){t&&(Ai(e,n,t),!n.alignedSliding&&t&&Ii(n,t),n.alignedSliding||!t||n.skippedSegments||bn(t,n))}function Ai(e,t,n){if(bi(e,n,t)){const e=Ei(n,t);e&&f(e.start)&&(w.log(`Adjusting PTS using last level due to CC increase within current level ${t.url}`),Si(e.start,t))}}function Ii(e,t){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;const n=e.fragments,i=t.fragments;if(!n.length||!i.length)return;let r,a;const o=Math.min(t.endCC,e.endCC);t.startCC<o&&e.startCC<o&&(r=_i(i,o),a=_i(n,o)),r&&a||(r=i[Math.floor(i.length/2)],a=_i(n,r.cc)||n[Math.floor(n.length/2)]);const s=r.programDateTime,l=a.programDateTime;if(!s||!l)return;const u=(l-s)/1e3-(a.start-r.start);Si(u,e)}const xi=Math.pow(2,17);class Ri{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new ki({type:m.NETWORK_ERROR,details:v.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${n?"part list":"url"}`),networkDetails:null}));this.abort();const i=this.config,r=i.fLoader,a=i.loader;return new Promise((o,l)=>{if(this.loader&&this.loader.destroy(),e.gap){if(e.tagList.some(e=>"GAP"===e[0]))return void l(Di(e));e.gap=!1}const u=this.loader=e.loader=r?new r(i):new a(i),c=Ci(e),d=Dn(i.fragLoadPolicy.default),f={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===e.sn?1/0:xi};e.stats=u.stats,u.load(c,f,{onSuccess:(t,n,i,r)=>{this.resetLoader(e,u);let a=t.data;i.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(a.slice(0,16)),a=a.slice(16)),o({frag:e,part:null,payload:a,networkDetails:r})},onError:(t,i,r,a)=>{this.resetLoader(e,u),l(new ki({type:m.NETWORK_ERROR,details:v.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:s({url:n,data:void 0},t),error:new Error(`HTTP Error ${t.code} ${t.text}`),networkDetails:r,stats:a}))},onAbort:(t,n,i)=>{this.resetLoader(e,u),l(new ki({type:m.NETWORK_ERROR,details:v.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:i,stats:t}))},onTimeout:(t,n,i)=>{this.resetLoader(e,u),l(new ki({type:m.NETWORK_ERROR,details:v.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${f.timeout}ms`),networkDetails:i,stats:t}))},onProgress:(n,i,r,a)=>{t&&t({frag:e,part:null,payload:r,networkDetails:a})}})})}loadPart(e,t,n){this.abort();const i=this.config,r=i.fLoader,a=i.loader;return new Promise((o,l)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap)return void l(Di(e,t));const u=this.loader=e.loader=r?new r(i):new a(i),c=Ci(e,t),d=Dn(i.fragLoadPolicy.default),f={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:xi};t.stats=u.stats,u.load(c,f,{onSuccess:(i,r,a,s)=>{this.resetLoader(e,u),this.updateStatsFromPart(e,t);const l={frag:e,part:t,payload:i.data,networkDetails:s};n(l),o(l)},onError:(n,i,r,a)=>{this.resetLoader(e,u),l(new ki({type:m.NETWORK_ERROR,details:v.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:s({url:c.url,data:void 0},n),error:new Error(`HTTP Error ${n.code} ${n.text}`),networkDetails:r,stats:a}))},onAbort:(n,i,r)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,u),l(new ki({type:m.NETWORK_ERROR,details:v.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:r,stats:n}))},onTimeout:(n,i,r)=>{this.resetLoader(e,u),l(new ki({type:m.NETWORK_ERROR,details:v.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${f.timeout}ms`),networkDetails:r,stats:n}))}})})}updateStatsFromPart(e,t){const n=e.stats,i=t.stats,r=i.total;if(n.loaded+=i.loaded,r){const i=Math.round(e.duration/t.duration),a=Math.min(Math.round(n.loaded/r),i),o=i-a,s=o*Math.round(n.loaded/a);n.total=n.loaded+s}else n.total=Math.max(n.loaded,n.total);const a=n.loading,o=i.loading;a.start?a.first+=o.first-o.start:(a.start=o.start,a.first=o.first),a.end=o.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function Ci(e,t=null){const n=t||e,i={frag:e,part:t,responseType:"arraybuffer",url:n.url,headers:{},rangeStart:0,rangeEnd:0},r=n.byteRangeStartOffset,a=n.byteRangeEndOffset;if(f(r)&&f(a)){var o;let t=r,n=a;if("initSegment"===e.sn&&"AES-128"===(null==(o=e.decryptdata)?void 0:o.method)){const e=a-r;e%16&&(n=a+(16-e%16)),0!==r&&(i.resetIV=!0,t=r-16)}i.rangeStart=t,i.rangeEnd=n}return i}function Di(e,t){const n=new Error(`GAP ${e.gap?"tag":"attribute"} found`),i={type:m.MEDIA_ERROR,details:v.FRAG_GAP,fatal:!1,frag:e,error:n,networkDetails:null};return t&&(i.part=t),(t||e).stats.aborted=!0,new ki(i)}class ki extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class Mi{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}class Li{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}function Pi(e){const t=e.byteLength,n=t&&new DataView(e.buffer).getUint8(t-1);return n?ee(e,0,t-n):e}class Ni{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let i=0;i<4;i++)n[i]=t.getUint32(4*i);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,i=n[0],r=n[1],a=n[2],o=n[3],s=this.invSubMix,l=s[0],u=s[1],c=s[2],d=s[3],f=new Uint32Array(256);let h=0,p=0,g=0;for(g=0;g<256;g++)f[g]=g<128?g<<1:g<<1^283;for(g=0;g<256;g++){let n=p^p<<1^p<<2^p<<3^p<<4;n=n>>>8^255&n^99,e[h]=n,t[n]=h;const s=f[h],g=f[s],m=f[g];let v=257*f[n]^16843008*n;i[h]=v<<24|v>>>8,r[h]=v<<16|v>>>16,a[h]=v<<8|v>>>24,o[h]=v,v=16843009*m^65537*g^257*s^16843008*h,l[n]=v<<24|v>>>8,u[n]=v<<16|v>>>16,c[n]=v<<8|v>>>24,d[n]=v,h?(h=s^f[f[f[m^s]]],p^=f[f[p]]):h=p=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,i=0;while(i<t.length&&n)n=t[i]===this.key[i],i++;if(n)return;this.key=t;const r=this.keySize=t.length;if(4!==r&&6!==r&&8!==r)throw new Error("Invalid aes key size="+r);const a=this.ksRows=4*(r+6+1);let o,s;const l=this.keySchedule=new Uint32Array(a),u=this.invKeySchedule=new Uint32Array(a),c=this.sBox,d=this.rcon,f=this.invSubMix,h=f[0],p=f[1],g=f[2],m=f[3];let v,y;for(o=0;o<a;o++)o<r?v=l[o]=t[o]:(y=v,o%r===0?(y=y<<8|y>>>24,y=c[y>>>24]<<24|c[y>>>16&255]<<16|c[y>>>8&255]<<8|c[255&y],y^=d[o/r|0]<<24):r>6&&o%r===4&&(y=c[y>>>24]<<24|c[y>>>16&255]<<16|c[y>>>8&255]<<8|c[255&y]),l[o]=v=(l[o-r]^y)>>>0);for(s=0;s<a;s++)o=a-s,y=3&s?l[o]:l[o-4],u[s]=s<4||o<=4?y:h[c[y>>>24]]^p[c[y>>>16&255]]^g[c[y>>>8&255]]^m[c[255&y]],u[s]=u[s]>>>0}networkToHostOrderSwap(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}decrypt(e,t,n){const i=this.keySize+6,r=this.invKeySchedule,a=this.invSBox,o=this.invSubMix,s=o[0],l=o[1],u=o[2],c=o[3],d=this.uint8ArrayToUint32Array_(n);let f=d[0],h=d[1],p=d[2],g=d[3];const m=new Int32Array(e),v=new Int32Array(m.length);let y,_,b,E,T,S,w,A,I,x,R,C,D,k;const M=this.networkToHostOrderSwap;while(t<m.length){for(I=M(m[t]),x=M(m[t+1]),R=M(m[t+2]),C=M(m[t+3]),T=I^r[0],S=C^r[1],w=R^r[2],A=x^r[3],D=4,k=1;k<i;k++)y=s[T>>>24]^l[S>>16&255]^u[w>>8&255]^c[255&A]^r[D],_=s[S>>>24]^l[w>>16&255]^u[A>>8&255]^c[255&T]^r[D+1],b=s[w>>>24]^l[A>>16&255]^u[T>>8&255]^c[255&S]^r[D+2],E=s[A>>>24]^l[T>>16&255]^u[S>>8&255]^c[255&w]^r[D+3],T=y,S=_,w=b,A=E,D+=4;y=a[T>>>24]<<24^a[S>>16&255]<<16^a[w>>8&255]<<8^a[255&A]^r[D],_=a[S>>>24]<<24^a[w>>16&255]<<16^a[A>>8&255]<<8^a[255&T]^r[D+1],b=a[w>>>24]<<24^a[A>>16&255]<<16^a[T>>8&255]<<8^a[255&S]^r[D+2],E=a[A>>>24]<<24^a[T>>16&255]<<16^a[S>>8&255]<<8^a[255&w]^r[D+3],v[t]=M(y^f),v[t+1]=M(E^h),v[t+2]=M(b^p),v[t+3]=M(_^g),f=I,h=x,p=R,g=C,t+=4}return v.buffer}}const Oi=16;class Fi{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const e=self.crypto;e&&(this.subtle=e.subtle||e.webkitSubtle)}catch(e){}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?Pi(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n){return this.useSoftware?new Promise((i,r)=>{this.softwareDecrypt(new Uint8Array(e),t,n);const a=this.flush();a?i(a.buffer):r(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,n)}softwareDecrypt(e,t,n){const{currentIV:i,currentResult:r,remainderData:a}=this;this.logOnce("JS AES decrypt"),a&&(e=He(a,e),this.remainderData=null);const o=this.getValidChunk(e);if(!o.length)return null;i&&(n=i);let s=this.softwareDecrypter;s||(s=this.softwareDecrypter=new Ni),s.expandKey(t);const l=r;return this.currentResult=s.decrypt(o.buffer,0,n),this.currentIV=ee(o,-16).buffer,l||null}webCryptoDecrypt(e,t,n){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,n));this.key=t,this.fastAesKey=new Li(this.subtle,t)}return this.fastAesKey.expandKey().then(t=>{if(!this.subtle)return Promise.reject(new Error("web crypto not initialized"));this.logOnce("WebCrypto AES decrypt");const i=new Mi(this.subtle,new Uint8Array(n));return i.decrypt(e.buffer,t)}).catch(i=>{return w.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${i.name}: ${i.message}`),this.onWebCryptoError(e,t,n)})}onWebCryptoError(e,t,n){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n);const i=this.flush();if(i)return i.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%Oi;return n!==e.length&&(t=ee(e,0,n),this.remainderData=ee(e,n)),t}logOnce(e){this.logEnabled&&(w.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const Ui={toString:function(e){let t="";const n=e.length;for(let i=0;i<n;i++)t+=`[${e.start(i).toFixed(3)}-${e.end(i).toFixed(3)}]`;return t}},Bi={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Gi extends ci{constructor(e,t,n,i,r){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=Bi.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=r,this.logPrefix=i,this.log=w.log.bind(w,`${i}:`),this.warn=w.warn.bind(w,`${i}:`),this.hls=e,this.fragmentLoader=new Ri(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new Fi(e.config),e.on(g.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;null!=e&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=Bi.STOPPED}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;const n=t.partList;if(null!=n&&n.length){const e=n[n.length-1],t=mi.isBuffered(this.media,e.start+e.duration/2);return t}const i=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(i)}getLevelDetails(){var e;if(this.levels&&null!==this.levelLastLoaded)return null==(e=this.levelLastLoaded)?void 0:e.details}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("ended",this.onvended);const i=this.config;this.levels&&i.autoStartLoad&&this.state===Bi.STOPPED&&this.startLoad(i.startPosition)}onMediaDetaching(){const e=this.media;null!=e&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:t,media:n,mediaBuffer:i,state:r}=this,a=n?n.currentTime:0,o=mi.bufferInfo(i||n,a,e.maxBufferHole);if(this.log(`media seeking to ${f(a)?a.toFixed(3):a}, state: ${r}`),this.state===Bi.ENDED)this.resetLoadingState();else if(t){const n=e.maxFragLookUpTolerance,i=t.start-n,r=t.start+t.duration+n;if(!o.len||r<o.start||i>o.end){const e=a>r;(a<i||e)&&(e&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}n&&(this.fragmentTracker.removeFragmentsInRange(a,1/0,this.playlistType,!0),this.lastCurrentTime=a),this.loadedmetadata||o.len||(this.nextLoadPosition=this.startPosition=a),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.hls.off(g.MANIFEST_LOADED,this.onManifestLoaded,this),this.stopLoad(),super.onHandlerDestroying(),this.hls=null}onHandlerDestroyed(){this.state=Bi.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){const i=t=>{if(this.fragContextChanged(e))return this.warn(`Fragment ${e.sn}${t.part?" p: "+t.part.index:""} of level ${e.level} was dropped during download.`),void this.fragmentTracker.removeFragment(e);e.stats.chunkCount++,this._handleFragmentLoadProgress(t)};this._doFragLoad(e,t,n,i).then(t=>{if(!t)return;const n=this.state;this.fragContextChanged(e)?(n===Bi.FRAG_LOADING||!this.fragCurrent&&n===Bi.PARSING)&&(this.fragmentTracker.removeFragment(e),this.state=Bi.IDLE):("payload"in t&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(g.FRAG_LOADED,t)),this._handleFragmentLoadComplete(t))}).catch(t=>{this.state!==Bi.STOPPED&&this.state!==Bi.ERROR&&(this.warn(`Frag error: ${(null==t?void 0:t.message)||t}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this,i=n.getState(e);if(i===di.APPENDING){const t=e.type,i=this.getFwdBufferInfo(this.mediaBuffer,t),r=Math.max(e.duration,i?i.len:this.config.maxBufferLength),a=this.backtrackFragment,o=a?e.sn-a.sn:0;(1===o||this.reduceMaxBufferLength(r,e.duration))&&n.removeFragment(e)}else 0===(null==(t=this.mediaBuffer)?void 0:t.buffered.length)?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===di.PARTIAL&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}flushMainBuffer(e,t,n=null){if(!(e-t))return;const i={startOffset:e,endOffset:t,type:n};this.hls.trigger(g.BUFFER_FLUSHING,i)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(t=>{if(!t||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return t}).then(t=>{const{hls:n}=this,{payload:i}=t,r=e.decryptdata;if(i&&i.byteLength>0&&null!=r&&r.key&&r.iv&&"AES-128"===r.method){const a=self.performance.now();return this.decrypter.decrypt(new Uint8Array(i),r.key.buffer,r.iv.buffer).catch(t=>{throw n.trigger(g.ERROR,{type:m.MEDIA_ERROR,details:v.FRAG_DECRYPT_ERROR,fatal:!1,error:t,reason:t.message,frag:e}),t}).then(i=>{const r=self.performance.now();return n.trigger(g.FRAG_DECRYPTED,{frag:e,payload:i,stats:{tstart:a,tdecrypt:r}}),t.payload=i,this.completeInitSegmentLoad(t)})}return this.completeInitSegmentLoad(t)}).catch(t=>{this.state!==Bi.STOPPED&&this.state!==Bi.ERROR&&(this.warn(t),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const n=e.frag.stats;this.state=Bi.IDLE,e.frag.data=new Uint8Array(e.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){var n,i,r,a;const o=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===Ut.MAIN?"level":"track"} ${e.level} (frag:[${(null!=(n=e.startPTS)?n:NaN).toFixed(3)}-${(null!=(i=e.endPTS)?i:NaN).toFixed(3)}] > buffer:${o?Ui.toString(mi.getBuffered(o)):"(detached)"})`),"initSegment"!==e.sn){var s;if(e.type!==Ut.SUBTITLE){const t=e.elementaryStreams;if(!Object.keys(t).some(e=>!!t[e]))return void(this.state=Bi.IDLE)}const t=null==(s=this.levels)?void 0:s[e.level];null!=t&&t.fragmentError&&(this.log(`Resetting level fragment error count of ${t.fragmentError} on frag buffered`),t.fragmentError=0)}this.state=Bi.IDLE,o&&(!this.loadedmetadata&&e.type==Ut.MAIN&&o.buffered.length&&(null==(r=this.fragCurrent)?void 0:r.sn)===(null==(a=this.fragPrevious)?void 0:a.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:i,partsLoaded:r}=e,a=!r||0===r.length||r.some(e=>!e),o=new vi(n.level,n.sn,n.stats.chunkCount+1,0,i?i.index:-1,!a);t.flush(o)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,i){var r;const a=null==t?void 0:t.details;if(!this.levels||!a)throw new Error(`frag load aborted, missing level${a?"":" detail"}s`);let o=null;if(!e.encrypted||null!=(r=e.decryptdata)&&r.key?!e.encrypted&&a.encryptedFragments.length&&this.keyLoader.loadClear(e,a.encryptedFragments):(this.log(`Loading key for ${e.sn} of [${a.startSN}-${a.endSN}], ${"[stream-controller]"===this.logPrefix?"level":"track"} ${e.level}`),this.state=Bi.KEY_LOADING,this.fragCurrent=e,o=this.keyLoader.load(e).then(e=>{if(!this.fragContextChanged(e.frag))return this.hls.trigger(g.KEY_LOADED,e),this.state===Bi.KEY_LOADING&&(this.state=Bi.IDLE),e}),this.hls.trigger(g.KEY_LOADING,{frag:e}),null===this.fragCurrent&&(o=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))),n=Math.max(e.start,n||0),this.config.lowLatencyMode&&"initSegment"!==e.sn){const r=a.partList;if(r&&i){n>e.end&&a.fragmentHint&&(e=a.fragmentHint);const s=this.getNextPart(r,e,n);if(s>-1){const l=r[s];let u;return this.log(`Loading part sn: ${e.sn} p: ${l.index} cc: ${e.cc} of playlist [${a.startSN}-${a.endSN}] parts [0-${s}-${r.length-1}] ${"[stream-controller]"===this.logPrefix?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=l.start+l.duration,this.state=Bi.FRAG_LOADING,u=o?o.then(n=>{return!n||this.fragContextChanged(n.frag)?null:this.doFragPartsLoad(e,l,t,i)}).catch(e=>this.handleFragLoadError(e)):this.doFragPartsLoad(e,l,t,i).catch(e=>this.handleFragLoadError(e)),this.hls.trigger(g.FRAG_LOADING,{frag:e,part:l,targetBufferTime:n}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):u}if(!e.url||this.loadedEndOfParts(r,n))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${a?"of ["+a.startSN+"-"+a.endSN+"] ":""}${"[stream-controller]"===this.logPrefix?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),f(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=Bi.FRAG_LOADING;const s=this.config.progressive;let l;return l=s&&o?o.then(t=>{return!t||this.fragContextChanged(null==t?void 0:t.frag)?null:this.fragmentLoader.load(e,i)}).catch(e=>this.handleFragLoadError(e)):Promise.all([this.fragmentLoader.load(e,s?i:void 0),o]).then(([e])=>{return!s&&e&&i&&i(e),e}).catch(e=>this.handleFragLoadError(e)),this.hls.trigger(g.FRAG_LOADING,{frag:e,targetBufferTime:n}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):l}doFragPartsLoad(e,t,n,i){return new Promise((r,a)=>{var o;const s=[],l=null==(o=n.details)?void 0:o.partList,u=t=>{this.fragmentLoader.loadPart(e,t,i).then(i=>{s[t.index]=i;const a=i.part;this.hls.trigger(g.FRAG_LOADED,i);const o=wn(n,e.sn,t.index+1)||An(l,e.sn,t.index+1);if(!o)return r({frag:e,part:a,partsLoaded:s});u(o)}).catch(a)};u(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===v.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(g.ERROR,t)}else this.hls.trigger(g.ERROR,{type:m.OTHER_ERROR,details:v.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==Bi.PARSING)return void(this.fragCurrent||this.state===Bi.STOPPED||this.state===Bi.ERROR||(this.state=Bi.IDLE));const{frag:n,part:i,level:r}=t,a=self.performance.now();n.stats.parsing.end=a,i&&(i.stats.parsing.end=a),this.updateLevelTiming(n,i,r,e.partial)}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:i,sn:r,part:a}=e;if(null==t||!t[i])return this.warn(`Levels object was unset while buffering fragment ${r} of level ${i}. The current chunk will not be buffered.`),null;const o=t[i],s=a>-1?wn(o,r,a):null,l=s?s.fragment:Sn(o,r,n);return l?(n&&n!==l&&(l.stats=n.stats),{frag:l,part:s,level:o}):null}bufferFragmentData(e,t,n,i,r){var a;if(!e||this.state!==Bi.PARSING)return;const{data1:o,data2:s}=e;let l=o;if(o&&s&&(l=He(o,s)),null==(a=l)||!a.length)return;const u={type:e.type,frag:t,part:n,chunkMeta:i,parent:t.type,data:l};if(this.hls.trigger(g.BUFFER_APPENDING,u),e.dropped&&e.independent&&!n){if(r)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!mi.isBuffered(t,t.currentTime))return void this.flushMainBuffer(0,e.start);const n=t.currentTime,i=mi.bufferInfo(t,n,0),r=e.duration,a=Math.min(2*this.config.maxFragLookUpTolerance,.25*r),o=Math.max(Math.min(e.start-a,i.end-a),n+a);e.start-o>a&&this.flushMainBuffer(o,e.start)}getFwdBufferInfo(e,t){const n=this.getLoadPosition();return f(n)?this.getFwdBufferInfoAtPos(e,n,t):null}getFwdBufferInfoAtPos(e,t,n){const{config:{maxBufferHole:i}}=this,r=mi.bufferInfo(e,t,i);if(0===r.len&&void 0!==r.nextStart){const a=this.fragmentTracker.getBufferedFrag(t,n);if(a&&r.nextStart<a.end)return mi.bufferInfo(e,t,Math.max(r.nextStart,i))}return r}getMaxBufferLength(e){const{config:t}=this;let n;return n=e?Math.max(8*t.maxBufferSize/e,t.maxBufferLength):t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const n=this.config,i=Math.max(Math.min(e-t,n.maxBufferLength),t),r=Math.max(e-3*t,n.maxMaxBufferLength/2,i);return r>=i&&(n.maxMaxBufferLength=r,this.warn(`Reduce max buffer length to ${r}s`),!0)}getAppendedFrag(e,t=Ut.MAIN){const n=this.fragmentTracker.getAppendedFrag(e,Ut.MAIN);return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){const n=t.fragments,i=n.length;if(!i)return null;const{config:r}=this,a=n[0].start;let o;if(t.live){const s=r.initialLiveManifestSize;if(i<s)return this.warn(`Not enough fragments to start playback (have: ${i}, need: ${s})`),null;(!t.PTSKnown&&!this.startFragRequested&&-1===this.startPosition||e<a)&&(o=this.getInitialLiveFragment(t,n),this.startPosition=this.nextLoadPosition=o?this.hls.liveSyncPosition||o.start:e)}else e<=a&&(o=n[0]);if(!o){const n=r.lowLatencyMode?t.partEnd:t.fragmentEnd;o=this.getFragmentAtPosition(e,n,t)}return this.mapToInitFragWhenRequired(o)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===di.OK||n===di.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,i,r){const a=e.gap,o=this.getNextFragment(this.nextLoadPosition,t);if(null===o)return o;if(e=o,a&&e&&!e.gap&&n.nextStart){const t=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,i);if(null!==t&&n.len+t.len>=r)return this.log(`buffer full after gaps in "${i}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return null==e||!e.initSegment||null!=e&&e.initSegment.data||this.bitrateTest?e:e.initSegment}getNextPart(e,t,n){let i=-1,r=!1,a=!0;for(let o=0,s=e.length;o<s;o++){const s=e[o];if(a=a&&!s.independent,i>-1&&n<s.start)break;const l=s.loaded;l?i=-1:(r||s.independent||a)&&s.fragment===t&&(i=o),r=l}return i}loadedEndOfParts(e,t){const n=e[e.length-1];return n&&t>n.start&&n.loaded}getInitialLiveFragment(e,t){const n=this.fragPrevious;let i=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),i=Pn(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!i){const r=n.sn+1;if(r>=e.startSN&&r<=e.endSN){const a=t[r-e.startSN];n.cc===a.cc&&(i=a,this.log(`Live playlist, switching playlist, load frag with next SN: ${i.sn}`))}i||(i=Bn(t,n.cc),i&&this.log(`Live playlist, switching playlist, load frag with same CC: ${i.sn}`))}}else{const t=this.hls.liveSyncPosition;null!==t&&(i=this.getFragmentAtPosition(t,this.bitrateTest?e.fragmentEnd:e.edge,e))}return i}getFragmentAtPosition(e,t,n){const{config:i}=this;let{fragPrevious:r}=this,{fragments:a,endSN:o}=n;const{fragmentHint:s}=n,{maxFragLookUpTolerance:l}=i,u=n.partList,c=!!(i.lowLatencyMode&&null!=u&&u.length&&s);let d;if(c&&s&&!this.bitrateTest&&(a=a.concat(s),o=s.sn),e<t){const n=e>t-l?0:l;d=Nn(r,a,e,n)}else d=a[a.length-1];if(d){const e=d.sn-n.startSN,t=this.fragmentTracker.getState(d);if((t===di.OK||t===di.PARTIAL&&d.gap)&&(r=d),r&&d.sn===r.sn&&(!c||u[0].fragment.sn>d.sn)){const t=r&&d.level===r.level;if(t){const t=a[e+1];d=d.sn<o&&this.fragmentTracker.getState(t)!==di.OK?t:null}}}return d}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const i=this.hls.liveSyncPosition,r=n.currentTime,a=e.fragments[0].start,o=e.edge,s=r>=a-t.maxFragLookUpTolerance&&r<=o;if(null!==i&&n.duration>i&&(r<i||!s)){const a=void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!s&&n.readyState<4||r<o-a)&&(this.loadedmetadata||(this.nextLoadPosition=i),n.readyState&&(this.warn(`Playback: ${r.toFixed(3)} is located too far from the end of live sliding playlist: ${o}, reset currentTime to : ${i.toFixed(3)}`),n.currentTime=i))}}alignPlaylists(e,t,n){const i=e.fragments.length;if(!i)return this.warn("No fragments in live playlist"),0;const r=e.fragments[0].start,a=!t,o=e.alignedSliding&&f(r);if(a||!o&&!r){const{fragPrevious:r}=this;wi(r,n,e);const a=e.fragments[0].start;return this.log(`Live playlist sliding: ${a.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${r?r.sn:"na"} fragments: ${i}`),a}return r}waitForCdnTuneIn(e){const t=3;return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*t)}setStartPosition(e,t){let n=this.startPosition;if(n<t&&(n=-1),-1===n||-1===this.lastCurrentTime){const i=null!==this.startTimeOffset,r=i?this.startTimeOffset:e.startTimeOffset;null!==r&&f(r)?(n=t+r,r<0&&(n+=e.totalduration),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Start time offset ${r} found in ${i?"multivariant":"media"} playlist, adjust startPosition to ${n}`),this.startPosition=n):e.live?n=this.hls.liveSyncPosition||t:this.startPosition=n=0,this.lastCurrentTime=n}this.nextLoadPosition=n}getLoadPosition(){const{media:e}=this;let t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&"initSegment"!==e.sn&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){this.fragCurrent&&(this.fragContextChanged(e)||this.state===Bi.FRAG_LOADING_WAITING_RETRY)||(this.state=Bi.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const e=this.getCurrentContext(t.chunkMeta);e&&(t.frag=e.frag)}const n=t.frag;if(!n||n.type!==e||!this.levels)return;var i;if(this.fragContextChanged(n))return void this.warn(`Frag load error must match current frag to retry ${n.url} > ${null==(i=this.fragCurrent)?void 0:i.url}`);const r=t.details===v.FRAG_GAP;r&&this.fragmentTracker.fragBuffered(n,!0);const a=t.errorAction,{action:o,retryCount:s=0,retryConfig:l}=a||{};if(a&&o===Gn.RetryRequest&&l){this.resetStartWhenNotLoaded(this.levelLastLoaded);const i=Cn(l,s);this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${s+1}/${l.maxNumRetry} in ${i}ms`),a.resolved=!0,this.retryDate=self.performance.now()+i,this.state=Bi.FRAG_LOADING_WAITING_RETRY}else if(l&&a){if(this.resetFragmentErrors(e),!(s<l.maxNumRetry))return void w.warn(`${t.details} reached or exceeded max retry (${s})`);r||o===Gn.RemoveAlternatePermanently||(a.resolved=!0)}else(null==a?void 0:a.action)===Gn.SendAlternateToPenaltyBox?this.state=Bi.WAITING_LEVEL:this.state=Bi.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===Bi.PARSING||this.state===Bi.PARSED){const t=e.frag,n=e.parent,i=this.getFwdBufferInfo(this.mediaBuffer,n),r=i&&i.len>.5;r&&this.reduceMaxBufferLength(i.len,(null==t?void 0:t.duration)||10);const a=!r;return a&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${n} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),a}return!1}resetFragmentErrors(e){e===Ut.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==Bi.STOPPED&&(this.state=Bi.IDLE)}afterBufferFlushed(e,t,n){if(!e)return;const i=mi.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,i,n),this.state===Bi.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=Bi.IDLE}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const t=e?e.details:null;null!=t&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,i){var r;const a=n.details;if(!a)return void this.warn("level.details undefined");const o=Object.keys(e.elementaryStreams).reduce((t,r)=>{const o=e.elementaryStreams[r];if(o){const s=o.endPTS-o.startPTS;if(s<=0)return this.warn(`Could not parse fragment ${e.sn} ${r} duration reliably (${s})`),t||!1;const l=i?0:gn(a,e,o.startPTS,o.endPTS,o.startDTS,o.endDTS);return this.hls.trigger(g.LEVEL_PTS_UPDATED,{details:a,level:n,drift:l,type:r,frag:e,start:o.startPTS,end:o.endPTS}),!0}return t},!1);if(!o&&null===(null==(r=this.transmuxer)?void 0:r.error)){const t=new Error(`Found no media in fragment ${e.sn} of level ${e.level} resetting transmuxer to fallback to playlist timing`);if(0===n.fragmentError&&(n.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(t.message),this.hls.trigger(g.ERROR,{type:m.MEDIA_ERROR,details:v.FRAG_PARSING_ERROR,fatal:!1,error:t,frag:e,reason:`Found no media in msn ${e.sn} of level "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=Bi.PARSED,this.hls.trigger(g.FRAG_PARSED,{frag:e,part:t})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){"demuxerWorker"===e.event&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}class ji{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;return e.length?(n=1===e.length?e[0]:Vi(e,t),this.reset(),n):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}}function Vi(e,t){const n=new Uint8Array(t);let i=0;for(let r=0;r<e.length;r++){const t=e[r];n.set(t,i),i+=t.length}return n}function Hi(){return"function"===typeof __HLS_WORKER_BUNDLE__}function Ki(){const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e),n=new self.Worker(t);return{worker:n,objectURL:t}}function zi(e){const t=new self.URL(e,self.location.href).href,n=new self.Worker(t);return{worker:n,scriptURL:t}}function Zi(e="",t=9e4){return{type:e,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}class qi{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,i){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=He(this.cachedData,e),this.cachedData=null);let n,i=ie(e,0),r=i?i.length:0;const a=this._audioTrack,o=this._id3Track,s=i?oe(i):void 0,l=e.length;(null===this.basePTS||0===this.frameIndex&&f(s))&&(this.basePTS=Yi(s,t,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),i&&i.length>0&&o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:Wt.audioId3,duration:Number.POSITIVE_INFINITY});while(r<l){if(this.canParse(e,r)){const t=this.appendFrame(a,e,r);t?(this.frameIndex++,this.lastPTS=t.sample.pts,r+=t.length,n=r):r=l}else ae(e,r)?(i=ie(e,r),o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:Wt.audioId3,duration:Number.POSITIVE_INFINITY}),r+=i.length,n=r):r++;if(r===l&&n!==l){const t=ee(e,n);this.cachedData?this.cachedData=He(this.cachedData,t):this.cachedData=t}}return{audioTrack:a,videoTrack:Zi(),id3Track:o,textTrack:Zi()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:Zi(),id3Track:this._id3Track,textTrack:Zi()}}destroy(){}}const Yi=(e,t,n)=>{if(f(e))return 90*e;const i=n?9e4*n.baseTime/n.timescale:0;return 9e4*t+i};function Wi(e,t,n,i){let r,a,o,s;const l=navigator.userAgent.toLowerCase(),u=i,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];r=1+((192&t[n+2])>>>6);const d=(60&t[n+2])>>>2;if(!(d>c.length-1))return o=(1&t[n+2])<<2,o|=(192&t[n+3])>>>6,w.log(`manifest codec:${i}, ADTS type:${r}, samplingIndex:${d}`),/firefox/i.test(l)?d>=6?(r=5,s=new Array(4),a=d-3):(r=2,s=new Array(2),a=d):-1!==l.indexOf("android")?(r=2,s=new Array(2),a=d):(r=5,s=new Array(4),i&&(-1!==i.indexOf("mp4a.40.29")||-1!==i.indexOf("mp4a.40.5"))||!i&&d>=6?a=d-3:((i&&-1!==i.indexOf("mp4a.40.2")&&(d>=6&&1===o||/vivaldi/i.test(l))||!i&&1===o)&&(r=2,s=new Array(2)),a=d)),s[0]=r<<3,s[0]|=(14&d)>>1,s[1]|=(1&d)<<7,s[1]|=o<<3,5===r&&(s[1]|=(14&a)>>1,s[2]=(1&a)<<7,s[2]|=8,s[3]=0),{config:s,samplerate:c[d],channelCount:o,codec:"mp4a.40."+r,manifestCodec:u};{const t=new Error(`invalid ADTS sampling index:${d}`);e.emit(g.ERROR,g.ERROR,{type:m.MEDIA_ERROR,details:v.FRAG_PARSING_ERROR,fatal:!0,error:t,reason:t.message})}}function $i(e,t){return 255===e[t]&&240===(246&e[t+1])}function Xi(e,t){return 1&e[t+1]?7:9}function Qi(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function Ji(e,t){return t+5<e.length}function er(e,t){return t+1<e.length&&$i(e,t)}function tr(e,t){return Ji(e,t)&&$i(e,t)&&Qi(e,t)<=e.length-t}function nr(e,t){if(er(e,t)){const n=Xi(e,t);if(t+n>=e.length)return!1;const i=Qi(e,t);if(i<=n)return!1;const r=t+i;return r===e.length||er(e,r)}return!1}function ir(e,t,n,i,r){if(!e.samplerate){const a=Wi(t,n,i,r);if(!a)return;e.config=a.config,e.samplerate=a.samplerate,e.channelCount=a.channelCount,e.codec=a.codec,e.manifestCodec=a.manifestCodec,w.log(`parsed codec:${e.codec}, rate:${a.samplerate}, channels:${a.channelCount}`)}}function rr(e){return 9216e4/e}function ar(e,t){const n=Xi(e,t);if(t+n<=e.length){const i=Qi(e,t)-n;if(i>0)return{headerLength:n,frameLength:i}}}function or(e,t,n,i,r){const a=rr(e.samplerate),o=i+r*a,s=ar(t,n);let l;if(s){const{frameLength:i,headerLength:r}=s,a=r+i,u=Math.max(0,n+a-t.length);u?(l=new Uint8Array(a-r),l.set(t.subarray(n+r,t.length),0)):l=t.subarray(n+r,n+a);const c={unit:l,pts:o};return u||e.samples.push(c),{sample:c,length:a,missing:u}}const u=t.length-n;l=new Uint8Array(u),l.set(t.subarray(n,t.length),0);const c={unit:l,pts:o};return{sample:c,length:u,missing:-1}}let sr=null;const lr=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],ur=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],cr=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],dr=[0,1,1,4];function fr(e,t,n,i,r){if(n+24>t.length)return;const a=hr(t,n);if(a&&n+a.frameLength<=t.length){const o=9e4*a.samplesPerFrame/a.sampleRate,s=i+r*o,l={unit:t.subarray(n,n+a.frameLength),pts:s,dts:s};return e.config=[],e.channelCount=a.channelCount,e.samplerate=a.sampleRate,e.samples.push(l),{sample:l,length:a.frameLength,missing:0}}}function hr(e,t){const n=e[t+1]>>3&3,i=e[t+1]>>1&3,r=e[t+2]>>4&15,a=e[t+2]>>2&3;if(1!==n&&0!==r&&15!==r&&3!==a){const o=e[t+2]>>1&1,s=e[t+3]>>6,l=3===n?3-i:3===i?3:4,u=1e3*lr[14*l+r-1],c=3===n?0:2===n?1:2,d=ur[3*c+a],f=3===s?1:2,h=cr[n][i],p=dr[i],g=8*h*p,m=Math.floor(h*u/d+o)*p;if(null===sr){const e=navigator.userAgent||"",t=e.match(/Chrome\/(\d+)/i);sr=t?parseInt(t[1]):0}const v=!!sr&&sr<=87;return v&&2===i&&u>=224e3&&0===s&&(e[t+3]=128|e[t+3]),{sampleRate:d,channelCount:f,frameLength:m,samplesPerFrame:g}}}function pr(e,t){return 255===e[t]&&224===(224&e[t+1])&&0!==(6&e[t+1])}function gr(e,t){return t+1<e.length&&pr(e,t)}function mr(e,t){const n=4;return pr(e,t)&&n<=e.length-t}function vr(e,t){if(t+1<e.length&&pr(e,t)){const n=4,i=hr(e,t);let r=n;null!=i&&i.frameLength&&(r=i.frameLength);const a=t+r;return a===e.length||gr(e,a)}return!1}class yr extends qi{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=ie(e,0);let n=(null==t?void 0:t.length)||0;if(vr(e,n))return!1;for(let i=e.length;n<i;n++)if(nr(e,n))return w.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return tr(e,t)}appendFrame(e,t,n){ir(e,this.observer,t,n,e.manifestCodec);const i=or(e,t,n,this.basePTS,this.frameIndex);if(i&&0===i.missing)return i}}const _r=/\/emsg[-/]ID3/i;class br{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,i){const r=this.videoTrack=Zi("video",1),a=this.audioTrack=Zi("audio",1),o=this.txtTrack=Zi("text",1);if(this.id3Track=Zi("id3",1),this.timeOffset=0,null==e||!e.byteLength)return;const s=ke(e);if(s.video){const{id:e,timescale:t,codec:n}=s.video;r.id=e,r.timescale=o.timescale=t,r.codec=n}if(s.audio){const{id:e,timescale:t,codec:n}=s.audio;a.id=e,a.timescale=t,a.codec=n}o.id=Ee.text,r.sampleDuration=0,r.duration=a.duration=i}resetContiguity(){this.remainderData=null}static probe(e){return Re(e)}demux(e,t){this.timeOffset=t;let n=e;const i=this.videoTrack,r=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=He(this.remainderData,e));const t=Ve(n);this.remainderData=t.remainder,i.samples=t.valid||new Uint8Array}else i.samples=n;const a=this.extractID3Track(i,t);return r.samples=Ke(t,i),{videoTrack:i,audioTrack:this.audioTrack,id3Track:a,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const i=this.extractID3Track(t,this.timeOffset);return n.samples=Ke(e,t),{videoTrack:t,audioTrack:Zi(),id3Track:i,textTrack:Zi()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const i=Ce(e.samples,["emsg"]);i&&i.forEach(e=>{const i=We(e);if(_r.test(i.schemeIdUri)){const e=f(i.presentationTime)?i.presentationTime/i.timeScale:t+i.presentationTimeDelta/i.timeScale;let r=4294967295===i.eventDuration?Number.POSITIVE_INFINITY:i.eventDuration/i.timeScale;r<=.001&&(r=Number.POSITIVE_INFINITY);const a=i.payload;n.samples.push({data:a,len:a.byteLength,dts:e,pts:e,type:Wt.emsg,duration:r})}})}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}}const Er=(e,t)=>{let n=0,i=5;t+=i;const r=new Uint32Array(1),a=new Uint32Array(1),o=new Uint8Array(1);while(i>0){o[0]=e[t];const s=Math.min(i,8),l=8-s;a[0]=4278190080>>>24+l<<l,r[0]=(o[0]&a[0])>>l,n=n?n<<s|r[0]:r[0],t+=1,i-=s}return n};class Tr extends qi{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,n){const i=Sr(e,t,n,this.basePTS,this.frameIndex);if(-1!==i){const t=e.samples[e.samples.length-1];return{sample:t,length:i,missing:0}}}static probe(e){if(!e)return!1;const t=ie(e,0);if(!t)return!1;const n=t.length;return 11===e[n]&&119===e[n+1]&&void 0!==oe(t)&&Er(e,n)<16}}function Sr(e,t,n,i,r){if(n+8>t.length)return-1;if(11!==t[n]||119!==t[n+1])return-1;const a=t[n+4]>>6;if(a>=3)return-1;const o=[48e3,44100,32e3],s=o[a],l=63&t[n+4],u=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920],c=2*u[3*l+a];if(n+c>t.length)return-1;const d=t[n+6]>>5;let f=0;2===d?f+=2:(1&d&&1!==d&&(f+=2),4&d&&(f+=2));const h=(t[n+6]<<8|t[n+7])>>12-f&1,p=[2,1,2,3,3,4,4,5],g=p[d]+h,m=t[n+5]>>3,v=7&t[n+5],y=new Uint8Array([a<<6|m<<1|v>>2,(3&v)<<6|d<<3|h<<2|l>>4,l<<4&224]),_=1536/s*9e4,b=i+r*_,E=t.subarray(n,n+c);return e.config=y,e.channelCount=g,e.samplerate=s,e.samples.push({unit:E,pts:b}),c}class wr{constructor(){this.VideoSample=null}createVideoSample(e,t,n,i){return{key:e,frame:!1,pts:t,dts:n,units:[],debug:i,length:0}}getLastNalUnit(e){var t;let n,i=this.VideoSample;if(i&&0!==i.units.length||(i=e[e.length-1]),null!=(t=i)&&t.units){const e=i.units;n=e[e.length-1]}return n}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(void 0===e.pts){const n=t.samples,i=n.length;if(!i)return void t.dropped++;{const t=n[i-1];e.pts=t.pts,e.dts=t.dts}}t.samples.push(e)}e.debug.length&&w.log(e.pts+"/"+e.dts+":"+e.debug)}}class Ar{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,i=new Uint8Array(4),r=Math.min(4,t);if(0===r)throw new Error("no bytes available");i.set(e.subarray(n,n+r)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=8*r,this.bytesAvailable-=r}skipBits(e){let t;e=Math.min(e,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&w.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(0!==(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t,n=8,i=8;for(let r=0;r<e;r++)0!==i&&(t=this.readEG(),i=(n+t+256)%256),n=0===i?n:i}readSPS(){let e,t,n,i=0,r=0,a=0,o=0;const s=this.readUByte.bind(this),l=this.readBits.bind(this),u=this.readUEG.bind(this),c=this.readBoolean.bind(this),d=this.skipBits.bind(this),f=this.skipEG.bind(this),h=this.skipUEG.bind(this),p=this.skipScalingList.bind(this);s();const g=s();if(l(5),d(3),s(),h(),100===g||110===g||122===g||244===g||44===g||83===g||86===g||118===g||128===g){const e=u();if(3===e&&d(1),h(),h(),d(1),c())for(t=3!==e?8:12,n=0;n<t;n++)c()&&p(n<6?16:64)}h();const m=u();if(0===m)u();else if(1===m)for(d(1),f(),f(),e=u(),n=0;n<e;n++)f();h(),d(1);const v=u(),y=u(),_=l(1);0===_&&d(1),d(1),c()&&(i=u(),r=u(),a=u(),o=u());let b=[1,1];if(c()&&c()){const e=s();switch(e){case 1:b=[1,1];break;case 2:b=[12,11];break;case 3:b=[10,11];break;case 4:b=[16,11];break;case 5:b=[40,33];break;case 6:b=[24,11];break;case 7:b=[20,11];break;case 8:b=[32,11];break;case 9:b=[80,33];break;case 10:b=[18,11];break;case 11:b=[15,11];break;case 12:b=[64,33];break;case 13:b=[160,99];break;case 14:b=[4,3];break;case 15:b=[3,2];break;case 16:b=[2,1];break;case 255:b=[s()<<8|s(),s()<<8|s()];break}}return{width:Math.ceil(16*(v+1)-2*i-2*r),height:(2-_)*(y+1)*16-(_?2:4)*(a+o),pixelRatio:b}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class Ir extends wr{parseAVCPES(e,t,n,i,r){const a=this.parseAVCNALu(e,n.data);let o,s=this.VideoSample,l=!1;n.data=null,s&&a.length&&!e.audFound&&(this.pushAccessUnit(s,e),s=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"")),a.forEach(i=>{var a;switch(i.type){case 1:{let t=!1;o=!0;const r=i.data;if(l&&r.length>4){const e=new Ar(r).readSliceType();2!==e&&4!==e&&7!==e&&9!==e||(t=!0)}var u;if(t)null!=(u=s)&&u.frame&&!s.key&&(this.pushAccessUnit(s,e),s=this.VideoSample=null);s||(s=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts,"")),s.frame=!0,s.key=t;break}case 5:o=!0,null!=(a=s)&&a.frame&&!s.key&&(this.pushAccessUnit(s,e),s=this.VideoSample=null),s||(s=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts,"")),s.key=!0,s.frame=!0;break;case 6:o=!0,qe(i.data,1,n.pts,t.samples);break;case 7:{var c,d;o=!0,l=!0;const t=i.data,n=new Ar(t),a=n.readSPS();if(!e.sps||e.width!==a.width||e.height!==a.height||(null==(c=e.pixelRatio)?void 0:c[0])!==a.pixelRatio[0]||(null==(d=e.pixelRatio)?void 0:d[1])!==a.pixelRatio[1]){e.width=a.width,e.height=a.height,e.pixelRatio=a.pixelRatio,e.sps=[t],e.duration=r;const n=t.subarray(1,4);let i="avc1.";for(let e=0;e<3;e++){let t=n[e].toString(16);t.length<2&&(t="0"+t),i+=t}e.codec=i}break}case 8:o=!0,e.pps=[i.data];break;case 9:o=!0,e.audFound=!0,s&&this.pushAccessUnit(s,e),s=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"");break;case 12:o=!0;break;default:o=!1,s&&(s.debug+="unknown NAL "+i.type+" ");break}if(s&&o){const e=s.units;e.push(i)}}),i&&s&&(this.pushAccessUnit(s,e),this.VideoSample=null)}parseAVCNALu(e,t){const n=t.byteLength;let i=e.naluState||0;const r=i,a=[];let o,s,l,u=0,c=-1,d=0;-1===i&&(c=0,d=31&t[0],i=0,u=1);while(u<n)if(o=t[u++],i)if(1!==i)if(o)if(1===o){if(s=u-i-1,c>=0){const e={data:t.subarray(c,s),type:d};a.push(e)}else{const n=this.getLastNalUnit(e.samples);n&&(r&&u<=4-r&&n.state&&(n.data=n.data.subarray(0,n.data.byteLength-r)),s>0&&(n.data=He(n.data,t.subarray(0,s)),n.state=0))}u<n?(l=31&t[u],c=u,d=l,i=0):i=-1}else i=0;else i=3;else i=o?0:2;else i=o?0:1;if(c>=0&&i>=0){const e={data:t.subarray(c,n),type:d,state:i};a.push(e)}if(0===a.length){const n=this.getLastNalUnit(e.samples);n&&(n.data=He(n.data,t))}return e.naluState=i,a}}class xr{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new Fi(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,n){const i=e[t].unit;if(i.length<=16)return;const r=i.subarray(16,i.length-i.length%16),a=r.buffer.slice(r.byteOffset,r.byteOffset+r.length);this.decryptBuffer(a).then(r=>{const a=new Uint8Array(r);i.set(a,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)})}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length)return void n();if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=16*Math.floor((e.length-48)/160)+16,n=new Int8Array(t);let i=0;for(let r=32;r<e.length-16;r+=160,i+=16)n.set(e.subarray(r,r+16),i);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let i=0;for(let r=32;r<e.length-16;r+=160,i+=16)e.set(n.subarray(i,i+16),r);return e}decryptAvcSample(e,t,n,i,r){const a=Ye(r.data),o=this.getAvcEncryptedData(a);this.decryptBuffer(o.buffer).then(o=>{r.data=this.getAvcDecryptedUnit(a,o),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,i)})}decryptAvcSamples(e,t,n,i){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length)return void i();const r=e[t].units;for(;;n++){if(n>=r.length)break;const a=r[n];if(!(a.data.length<=48||1!==a.type&&5!==a.type)&&(this.decryptAvcSample(e,t,n,i,a),!this.decrypter.isSync()))return}}}}const Rr=188;class Cr{constructor(e,t,n){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.videoParser=new Ir}static probe(e){const t=Cr.syncOffset(e);return t>0&&w.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),-1!==t}static syncOffset(e){const t=e.length;let n=Math.min(5*Rr,t-Rr)+1,i=0;while(i<n){let r=!1,a=-1,o=0;for(let s=i;s<t;s+=Rr){if(71!==e[s]||t-s!==Rr&&71!==e[s+Rr]){if(o)return-1;break}if(o++,-1===a&&(a=s,0!==a&&(n=Math.min(a+99*Rr,e.length-Rr)+1)),r||(r=0===Dr(e,s)),r&&o>1&&(0===a&&o>2||s+Rr>n))return a}i++}return-1}static createTrack(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:Ee[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?t:void 0}}resetInitSegment(e,t,n,i){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=Cr.createTrack("video"),this._audioTrack=Cr.createTrack("audio",i),this._id3Track=Cr.createTrack("id3"),this._txtTrack=Cr.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n,this._duration=i}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,n=!1,i=!1){let r;n||(this.sampleAes=null);const a=this._videoTrack,o=this._audioTrack,s=this._id3Track,l=this._txtTrack;let u=a.pid,c=a.pesData,d=o.pid,f=s.pid,h=o.pesData,p=s.pesData,g=null,m=this.pmtParsed,v=this._pmtId,y=e.length;if(this.remainderData&&(e=He(this.remainderData,e),y=e.length,this.remainderData=null),y<Rr&&!i)return this.remainderData=e,{audioTrack:o,videoTrack:a,id3Track:s,textTrack:l};const _=Math.max(0,Cr.syncOffset(e));y-=(y-_)%Rr,y<e.byteLength&&!i&&(this.remainderData=new Uint8Array(e.buffer,y,e.buffer.byteLength-y));let b=0;for(let T=_;T<y;T+=Rr)if(71===e[T]){const t=!!(64&e[T+1]),i=Dr(e,T),y=(48&e[T+3])>>4;let b;if(y>1){if(b=T+5+e[T+4],b===T+Rr)continue}else b=T+4;switch(i){case u:t&&(c&&(r=Nr(c))&&this.videoParser.parseAVCPES(a,l,r,!1,this._duration),c={data:[],size:0}),c&&(c.data.push(e.subarray(b,T+Rr)),c.size+=T+Rr-b);break;case d:if(t){if(h&&(r=Nr(h)))switch(o.segmentCodec){case"aac":this.parseAACPES(o,r);break;case"mp3":this.parseMPEGPES(o,r);break;case"ac3":this.parseAC3PES(o,r);break}h={data:[],size:0}}h&&(h.data.push(e.subarray(b,T+Rr)),h.size+=T+Rr-b);break;case f:t&&(p&&(r=Nr(p))&&this.parseID3PES(s,r),p={data:[],size:0}),p&&(p.data.push(e.subarray(b,T+Rr)),p.size+=T+Rr-b);break;case 0:t&&(b+=e[b]+1),v=this._pmtId=kr(e,b);break;case v:{t&&(b+=e[b]+1);const i=Mr(e,b,this.typeSupported,n,this.observer);u=i.videoPid,u>0&&(a.pid=u,a.segmentCodec=i.segmentVideoCodec),d=i.audioPid,d>0&&(o.pid=d,o.segmentCodec=i.segmentAudioCodec),f=i.id3Pid,f>0&&(s.pid=f),null===g||m||(w.warn(`MPEG-TS PMT found at ${T} after unknown PID '${g}'. Backtracking to sync byte @${_} to parse all TS packets.`),g=null,T=_-188),m=this.pmtParsed=!0;break}case 17:case 8191:break;default:g=i;break}}else b++;b>0&&Lr(this.observer,new Error(`Found ${b} TS packet/s that do not start with 0x47`)),a.pesData=c,o.pesData=h,s.pesData=p;const E={audioTrack:o,videoTrack:a,id3Track:s,textTrack:l};return i&&this.extractRemainingSamples(E),E}flush(){const{remainderData:e}=this;let t;return this.remainderData=null,t=e?this.demux(e,-1,!1,!0):{videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:i,textTrack:r}=e,a=n.pesData,o=t.pesData,s=i.pesData;let l;if(a&&(l=Nr(a))?(this.videoParser.parseAVCPES(n,r,l,!0,this._duration),n.pesData=null):n.pesData=a,o&&(l=Nr(o))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,l);break;case"mp3":this.parseMPEGPES(t,l);break;case"ac3":this.parseAC3PES(t,l);break}t.pesData=null}else null!=o&&o.size&&w.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=o;s&&(l=Nr(s))?(this.parseID3PES(i,l),i.pesData=null):i.pesData=s}demuxSampleAes(e,t,n){const i=this.demux(e,n,!0,!this.config.progressive),r=this.sampleAes=new xr(this.observer,this.config,t);return this.decrypt(i,r)}decrypt(e,t){return new Promise(n=>{const{audioTrack:i,videoTrack:r}=e;i.samples&&"aac"===i.segmentCodec?t.decryptAacSamples(i.samples,0,()=>{r.samples?t.decryptAvcSamples(r.samples,0,0,()=>{n(e)}):n(e)}):r.samples&&t.decryptAvcSamples(r.samples,0,0,()=>{n(e)})})}destroy(){this._duration=0}parseAACPES(e,t){let n=0;const i=this.aacOverFlow;let r,a,o,s=t.data;if(i){this.aacOverFlow=null;const t=i.missing,r=i.sample.unit.byteLength;if(-1===t)s=He(i.sample.unit,s);else{const a=r-t;i.sample.unit.set(s.subarray(0,t),a),e.samples.push(i.sample),n=i.missing}}for(r=n,a=s.length;r<a-1;r++)if(er(s,r))break;if(r!==n){let e;const t=r<a-1;if(e=t?`AAC PES did not start with ADTS header,offset:${r}`:"No ADTS header found in AAC PES",Lr(this.observer,new Error(e),t),!t)return}if(ir(e,this.observer,s,r,this.audioCodec),void 0!==t.pts)o=t.pts;else{if(!i)return void w.warn("[tsdemuxer]: AAC PES unknown PTS");{const t=rr(e.samplerate);o=i.sample.pts+t}}let l,u=0;while(r<a){if(l=or(e,s,r,o,u),r+=l.length,l.missing){this.aacOverFlow=l;break}for(u++;r<a-1;r++)if(er(s,r))break}}parseMPEGPES(e,t){const n=t.data,i=n.length;let r=0,a=0;const o=t.pts;if(void 0!==o)while(a<i)if(gr(n,a)){const t=fr(e,n,a,o,r);if(!t)break;a+=t.length,r++}else a++;else w.warn("[tsdemuxer]: MPEG PES unknown PTS")}parseAC3PES(e,t){{const n=t.data,i=t.pts;if(void 0===i)return void w.warn("[tsdemuxer]: AC3 PES unknown PTS");const r=n.length;let a,o=0,s=0;while(s<r&&(a=Sr(e,n,s,i,o++))>0)s+=a}}parseID3PES(e,t){if(void 0===t.pts)return void w.warn("[tsdemuxer]: ID3 PES unknown PTS");const n=d({},t,{type:this._videoTrack?Wt.emsg:Wt.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function Dr(e,t){return((31&e[t+1])<<8)+e[t+2]}function kr(e,t){return(31&e[t+10])<<8|e[t+11]}function Mr(e,t,n,i,r){const a={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},o=(15&e[t+1])<<8|e[t+2],s=t+3+o-4,l=(15&e[t+10])<<8|e[t+11];t+=12+l;while(t<s){const o=Dr(e,t),s=(15&e[t+3])<<8|e[t+4];switch(e[t]){case 207:if(!i){Pr("ADTS AAC");break}case 15:-1===a.audioPid&&(a.audioPid=o);break;case 21:-1===a.id3Pid&&(a.id3Pid=o);break;case 219:if(!i){Pr("H.264");break}case 27:-1===a.videoPid&&(a.videoPid=o,a.segmentVideoCodec="avc");break;case 3:case 4:n.mpeg||n.mp3?-1===a.audioPid&&(a.audioPid=o,a.segmentAudioCodec="mp3"):w.log("MPEG audio found, not supported in this browser");break;case 193:if(!i){Pr("AC-3");break}case 129:n.ac3?-1===a.audioPid&&(a.audioPid=o,a.segmentAudioCodec="ac3"):w.log("AC-3 audio found, not supported in this browser");break;case 6:if(-1===a.audioPid&&s>0){let i=t+5,r=s;while(r>2){const t=e[i];switch(t){case 106:!0!==n.ac3?w.log("AC-3 audio found, not supported in this browser for now"):(a.audioPid=o,a.segmentAudioCodec="ac3");break}const s=e[i+1]+2;i+=s,r-=s}}break;case 194:case 135:return Lr(r,new Error("Unsupported EC-3 in M2TS found")),a;case 36:return Lr(r,new Error("Unsupported HEVC in M2TS found")),a}t+=s+5}return a}function Lr(e,t,n){w.warn(`parsing error: ${t.message}`),e.emit(g.ERROR,g.ERROR,{type:m.MEDIA_ERROR,details:v.FRAG_PARSING_ERROR,fatal:!1,levelRetry:n,error:t,reason:t.message})}function Pr(e){w.log(`${e} with AES-128-CBC encryption found in unencrypted stream`)}function Nr(e){let t,n,i,r,a,o=0;const s=e.data;if(!e||0===e.size)return null;while(s[0].length<19&&s.length>1)s[0]=He(s[0],s[1]),s.splice(1,1);t=s[0];const l=(t[0]<<16)+(t[1]<<8)+t[2];if(1===l){if(n=(t[4]<<8)+t[5],n&&n>e.size-6)return null;const l=t[7];192&l&&(r=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,64&l?(a=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2,r-a>54e5&&(w.warn(`${Math.round((r-a)/9e4)}s delta between PTS and DTS, align them`),r=a)):a=r),i=t[8];let u=i+9;if(e.size<=u)return null;e.size-=u;const c=new Uint8Array(e.size);for(let e=0,n=s.length;e<n;e++){t=s[e];let n=t.byteLength;if(u){if(u>n){u-=n;continue}t=t.subarray(u),n-=u,u=0}c.set(t,o),o+=n}return n&&(n-=i+3),{data:c,pts:r,dts:a,len:n}}return null}class Or extends qi{resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=ie(e,0);let n=(null==t?void 0:t.length)||0;if(t&&11===e[n]&&119===e[n+1]&&void 0!==oe(t)&&Er(e,n)<=16)return!1;for(let i=e.length;n<i;n++)if(vr(e,n))return w.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return mr(e,t)}appendFrame(e,t,n){if(null!==this.basePTS)return fr(e,t,n,this.basePTS,this.frameIndex)}}class Fr{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const Ur=Math.pow(2,32)-1;class Br{static init(){let e;for(e in Br.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},Br.types)Br.types.hasOwnProperty(e)&&(Br.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);Br.HDLR_TYPES={video:t,audio:n};const i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r=new Uint8Array([0,0,0,0,0,0,0,0]);Br.STTS=Br.STSC=Br.STCO=r,Br.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Br.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Br.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Br.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const a=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),s=new Uint8Array([0,0,0,1]);Br.FTYP=Br.box(Br.types.ftyp,a,s,a,o),Br.DINF=Br.box(Br.types.dinf,Br.box(Br.types.dref,i))}static box(e,...t){let n=8,i=t.length;const r=i;while(i--)n+=t[i].byteLength;const a=new Uint8Array(n);for(a[0]=n>>24&255,a[1]=n>>16&255,a[2]=n>>8&255,a[3]=255&n,a.set(e,4),i=0,n=8;i<r;i++)a.set(t[i],n),n+=t[i].byteLength;return a}static hdlr(e){return Br.box(Br.types.hdlr,Br.HDLR_TYPES[e])}static mdat(e){return Br.box(Br.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(Ur+1)),i=Math.floor(t%(Ur+1));return Br.box(Br.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))}static mdia(e){return Br.box(Br.types.mdia,Br.mdhd(e.timescale,e.duration),Br.hdlr(e.type),Br.minf(e))}static mfhd(e){return Br.box(Br.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))}static minf(e){return"audio"===e.type?Br.box(Br.types.minf,Br.box(Br.types.smhd,Br.SMHD),Br.DINF,Br.stbl(e)):Br.box(Br.types.minf,Br.box(Br.types.vmhd,Br.VMHD),Br.DINF,Br.stbl(e))}static moof(e,t,n){return Br.box(Br.types.moof,Br.mfhd(e),Br.traf(n,t))}static moov(e){let t=e.length;const n=[];while(t--)n[t]=Br.trak(e[t]);return Br.box.apply(null,[Br.types.moov,Br.mvhd(e[0].timescale,e[0].duration)].concat(n).concat(Br.mvex(e)))}static mvex(e){let t=e.length;const n=[];while(t--)n[t]=Br.trex(e[t]);return Br.box.apply(null,[Br.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(Ur+1)),i=Math.floor(t%(Ur+1)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Br.box(Br.types.mvhd,r)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let i,r;for(i=0;i<t.length;i++)r=t[i].flags,n[i+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return Br.box(Br.types.sdtp,n)}static stbl(e){return Br.box(Br.types.stbl,Br.stsd(e),Br.box(Br.types.stts,Br.STTS),Br.box(Br.types.stsc,Br.STSC),Br.box(Br.types.stsz,Br.STSZ),Br.box(Br.types.stco,Br.STCO))}static avc1(e){let t,n,i,r=[],a=[];for(t=0;t<e.sps.length;t++)n=e.sps[t],i=n.byteLength,r.push(i>>>8&255),r.push(255&i),r=r.concat(Array.prototype.slice.call(n));for(t=0;t<e.pps.length;t++)n=e.pps[t],i=n.byteLength,a.push(i>>>8&255),a.push(255&i),a=a.concat(Array.prototype.slice.call(n));const o=Br.box(Br.types.avcC,new Uint8Array([1,r[3],r[4],r[5],255,224|e.sps.length].concat(r).concat([e.pps.length]).concat(a))),s=e.width,l=e.height,u=e.pixelRatio[0],c=e.pixelRatio[1];return Br.box(Br.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,s>>8&255,255&s,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,Br.box(Br.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Br.box(Br.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,c>>24,c>>16&255,c>>8&255,255&c])))}static esds(e){const t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static audioStsd(e){const t=e.samplerate;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0])}static mp4a(e){return Br.box(Br.types.mp4a,Br.audioStsd(e),Br.box(Br.types.esds,Br.esds(e)))}static mp3(e){return Br.box(Br.types[".mp3"],Br.audioStsd(e))}static ac3(e){return Br.box(Br.types["ac-3"],Br.audioStsd(e),Br.box(Br.types.dac3,e.config))}static stsd(e){return"audio"===e.type?"mp3"===e.segmentCodec&&"mp3"===e.codec?Br.box(Br.types.stsd,Br.STSD,Br.mp3(e)):"ac3"===e.segmentCodec?Br.box(Br.types.stsd,Br.STSD,Br.ac3(e)):Br.box(Br.types.stsd,Br.STSD,Br.mp4a(e)):Br.box(Br.types.stsd,Br.STSD,Br.avc1(e))}static tkhd(e){const t=e.id,n=e.duration*e.timescale,i=e.width,r=e.height,a=Math.floor(n/(Ur+1)),o=Math.floor(n%(Ur+1));return Br.box(Br.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,o>>24,o>>16&255,o>>8&255,255&o,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,r>>8&255,255&r,0,0]))}static traf(e,t){const n=Br.sdtp(e),i=e.id,r=Math.floor(t/(Ur+1)),a=Math.floor(t%(Ur+1));return Br.box(Br.types.traf,Br.box(Br.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),Br.box(Br.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,a>>24,a>>16&255,a>>8&255,255&a])),Br.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,Br.box(Br.types.trak,Br.tkhd(e),Br.mdia(e))}static trex(e){const t=e.id;return Br.box(Br.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],i=n.length,r=12+16*i,a=new Uint8Array(r);let o,s,l,u,c,d;for(t+=8+r,a.set(["video"===e.type?1:0,0,15,1,i>>>24&255,i>>>16&255,i>>>8&255,255&i,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0),o=0;o<i;o++)s=n[o],l=s.duration,u=s.size,c=s.flags,d=s.cts,a.set([l>>>24&255,l>>>16&255,l>>>8&255,255&l,u>>>24&255,u>>>16&255,u>>>8&255,255&u,c.isLeading<<2|c.dependsOn,c.isDependedOn<<6|c.hasRedundancy<<4|c.paddingValue<<1|c.isNonSync,61440&c.degradPrio,15&c.degradPrio,d>>>24&255,d>>>16&255,d>>>8&255,255&d],12+16*o);return Br.box(Br.types.trun,a)}static initSegment(e){Br.types||Br.init();const t=Br.moov(e),n=He(Br.FTYP,t);return n}}Br.types=void 0,Br.HDLR_TYPES=void 0,Br.STTS=void 0,Br.STSC=void 0,Br.STCO=void 0,Br.STSZ=void 0,Br.VMHD=void 0,Br.SMHD=void 0,Br.STSD=void 0,Br.FTYP=void 0,Br.DINF=void 0;const Gr=9e4;function jr(e,t,n=1,i=!1){const r=e*t*n;return i?Math.round(r):r}function Vr(e,t,n=1,i=!1){return jr(e,t,1/n,i)}function Hr(e,t=!1){return jr(e,1e3,1/Gr,t)}function Kr(e,t=1){return jr(e,Gr,1/t)}const zr=1e4,Zr=1024,qr=1152,Yr=1536;let Wr,$r=null,Xr=null;class Qr{constructor(e,t,n,i=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,null===$r){const e=navigator.userAgent||"",t=e.match(/Chrome\/(\d+)/i);$r=t?parseInt(t[1]):0}if(null===Xr){const e=navigator.userAgent.match(/Safari\/(\d+)/i);Xr=e?parseInt(e[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){w.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){w.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){w.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const n=e.reduce((e,n)=>{const i=n.pts-e;return i<-4294967296?(t=!0,Jr(e,n.pts)):i>0?e:n.pts},e[0].pts);return t&&w.debug("PTS rollover detected"),n}remux(e,t,n,i,r,a,o,s){let l,u,c,d,f,h,p=r,g=r;const m=e.pid>-1,v=t.pid>-1,y=t.samples.length,_=e.samples.length>0,b=o&&y>0||y>1,E=(!m||_)&&(!v||b)||this.ISGenerated||o;if(E){if(this.ISGenerated){var T,S,A,I;const e=this.videoTrackConfig;!e||t.width===e.width&&t.height===e.height&&(null==(T=t.pixelRatio)?void 0:T[0])===(null==(S=e.pixelRatio)?void 0:S[0])&&(null==(A=t.pixelRatio)?void 0:A[1])===(null==(I=e.pixelRatio)?void 0:I[1])||this.resetInitSegment()}else c=this.generateIS(e,t,r,a);const n=this.isVideoContiguous;let i,o=-1;if(b&&(o=ea(t.samples),!n&&this.config.forceKeyFrameOnDiscontinuity))if(h=!0,o>0){w.warn(`[mp4-remuxer]: Dropped ${o} out of ${y} video samples due to a missing keyframe`);const e=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(o),t.dropped+=o,g+=(t.samples[0].pts-e)/t.inputTimeScale,i=g}else-1===o&&(w.warn(`[mp4-remuxer]: No keyframe found out of ${y} video samples`),h=!1);if(this.ISGenerated){if(_&&b){const n=this.getVideoStartPts(t.samples),i=Jr(e.samples[0].pts,n)-n,r=i/t.inputTimeScale;p+=Math.max(0,r),g+=Math.max(0,-r)}if(_){if(e.samplerate||(w.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),c=this.generateIS(e,t,r,a)),u=this.remuxAudio(e,p,this.isAudioContiguous,a,v||b||s===Ut.AUDIO?g:void 0),b){const i=u?u.endPTS-u.startPTS:0;t.inputTimeScale||(w.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),c=this.generateIS(e,t,r,a)),l=this.remuxVideo(t,g,n,i)}}else b&&(l=this.remuxVideo(t,g,n,0));l&&(l.firstKeyFrame=o,l.independent=-1!==o,l.firstKeyFramePTS=i)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(f=ta(n,r,this._initPTS,this._initDTS)),i.samples.length&&(d=na(i,r,this._initPTS))),{audio:u,video:l,initSegment:c,independent:h,text:d,id3:f}}generateIS(e,t,n,i){const r=e.samples,a=t.samples,o=this.typeSupported,s={},l=this._initPTS;let u,c,d,f=!l||i,h="audio/mp4";if(f&&(u=c=1/0),e.config&&r.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":o.mpeg?(h="audio/mpeg",e.codec=""):o.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}s.audio={id:"audio",container:h,codec:e.codec,initSegment:"mp3"===e.segmentCodec&&o.mpeg?new Uint8Array(0):Br.initSegment([e]),metadata:{channelCount:e.channelCount}},f&&(d=e.inputTimeScale,l&&d===l.timescale?f=!1:u=c=r[0].pts-Math.round(d*n))}if(t.sps&&t.pps&&a.length){if(t.timescale=t.inputTimeScale,s.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:Br.initSegment([t]),metadata:{width:t.width,height:t.height}},f)if(d=t.inputTimeScale,l&&d===l.timescale)f=!1;else{const e=this.getVideoStartPts(a),t=Math.round(d*n);c=Math.min(c,Jr(a[0].dts,e)-t),u=Math.min(u,e-t)}this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(s).length)return this.ISGenerated=!0,f?(this._initPTS={baseTime:u,timescale:d},this._initDTS={baseTime:c,timescale:d}):u=d=void 0,{tracks:s,initPTS:u,timescale:d}}remuxVideo(e,t,n,i){const r=e.inputTimeScale,a=e.samples,o=[],s=a.length,l=this._initPTS;let u,c,f=this.nextAvcDts,h=8,p=this.videoSampleDuration,y=Number.POSITIVE_INFINITY,_=Number.NEGATIVE_INFINITY,b=!1;if(!n||null===f){const e=t*r,i=a[0].pts-Jr(a[0].dts,a[0].pts);$r&&null!==f&&Math.abs(e-i-f)<15e3?n=!0:f=e-i}const E=l.baseTime*r/l.timescale;for(let d=0;d<s;d++){const e=a[d];e.pts=Jr(e.pts-E,f),e.dts=Jr(e.dts-E,f),e.dts<a[d>0?d-1:d].dts&&(b=!0)}b&&a.sort(function(e,t){const n=e.dts-t.dts,i=e.pts-t.pts;return n||i}),u=a[0].dts,c=a[a.length-1].dts;const T=c-u,S=T?Math.round(T/(s-1)):p||e.inputTimeScale/30;if(n){const e=u-f,n=e>S,i=e<-1;if((n||i)&&(n?w.warn(`AVC: ${Hr(e,!0)} ms (${e}dts) hole between fragments detected at ${t.toFixed(3)}`):w.warn(`AVC: ${Hr(-e,!0)} ms (${e}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!i||f>=a[0].pts||$r)){u=f;const t=a[0].pts-e;if(n)a[0].dts=u,a[0].pts=t;else for(let n=0;n<a.length;n++){if(a[n].dts>t)break;a[n].dts-=e,a[n].pts-=e}w.log(`Video: Initial PTS/DTS adjusted: ${Hr(t,!0)}/${Hr(u,!0)}, delta: ${Hr(e,!0)} ms`)}}u=Math.max(0,u);let A=0,I=0,x=u;for(let d=0;d<s;d++){const e=a[d],t=e.units,n=t.length;let i=0;for(let r=0;r<n;r++)i+=t[r].data.length;I+=i,A+=n,e.length=i,e.dts<x?(e.dts=x,x+=S/4|0||1):x=e.dts,y=Math.min(e.pts,y),_=Math.max(e.pts,_)}c=a[s-1].dts;const R=I+4*A+8;let C;try{C=new Uint8Array(R)}catch(e){return void this.observer.emit(g.ERROR,g.ERROR,{type:m.MUX_ERROR,details:v.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:R,reason:`fail allocating video mdat ${R}`})}const D=new DataView(C.buffer);D.setUint32(0,R),C.set(Br.types.mdat,4);let k=!1,M=Number.POSITIVE_INFINITY,L=Number.POSITIVE_INFINITY,P=Number.NEGATIVE_INFINITY,N=Number.NEGATIVE_INFINITY;for(let d=0;d<s;d++){const e=a[d],t=e.units;let n,l=0;for(let i=0,r=t.length;i<r;i++){const e=t[i],n=e.data,r=e.data.byteLength;D.setUint32(h,r),h+=4,C.set(n,h),h+=r,l+=4+r}if(d<s-1)p=a[d+1].dts-e.dts,n=a[d+1].pts-e.pts;else{const t=this.config,o=d>0?e.dts-a[d-1].dts:S;if(n=d>0?e.pts-a[d-1].pts:S,t.stretchShortVideoTrack&&null!==this.nextAudioPts){const n=Math.floor(t.maxBufferHole*r),a=(i?y+i*r:this.nextAudioPts)-e.pts;a>n?(p=a-o,p<0?p=o:k=!0,w.log(`[mp4-remuxer]: It is approximately ${a/90} ms to the next segment; using duration ${p/90} ms for the last video frame.`)):p=o}else p=o}const u=Math.round(e.pts-e.dts);M=Math.min(M,p),P=Math.max(P,p),L=Math.min(L,n),N=Math.max(N,n),o.push(new ia(e.key,p,l,u))}if(o.length)if($r){if($r<70){const e=o[0].flags;e.dependsOn=2,e.isNonSync=0}}else if(Xr&&N-L<P-M&&S/P<.025&&0===o[0].cts){w.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let e=u;for(let t=0,n=o.length;t<n;t++){const i=e+o[t].duration,r=e+o[t].cts;if(t<n-1){const e=i+o[t+1].cts;o[t].duration=e-r}else o[t].duration=t?o[t-1].duration:S;o[t].cts=0,e=i}}p=k||!p?S:p,this.nextAvcDts=f=c+p,this.videoSampleDuration=p,this.isVideoContiguous=!0;const O=Br.moof(e.sequenceNumber++,u,d({},e,{samples:o})),F="video",U={data1:O,data2:C,startPTS:y/r,endPTS:(_+p)/r,startDTS:u/r,endDTS:f/r,type:F,hasAudio:!1,hasVideo:!0,nb:o.length,dropped:e.dropped};return e.samples=[],e.dropped=0,U}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return qr;case"ac3":return Yr;default:return Zr}}remuxAudio(e,t,n,i,r){const a=e.inputTimeScale,o=e.samplerate?e.samplerate:a,s=a/o,l=this.getSamplesPerFrame(e),u=l*s,c=this._initPTS,f="mp3"===e.segmentCodec&&this.typeSupported.mpeg,h=[],p=void 0!==r;let y=e.samples,_=f?0:8,b=this.nextAudioPts||-1;const E=t*a,T=c.baseTime*a/c.timescale;if(this.isAudioContiguous=n=n||y.length&&b>0&&(i&&Math.abs(E-b)<9e3||Math.abs(Jr(y[0].pts-T,E)-b)<20*u),y.forEach(function(e){e.pts=Jr(e.pts-T,E)}),!n||b<0){if(y=y.filter(e=>e.pts>=0),!y.length)return;b=0===r?0:i&&!p?Math.max(0,E):y[0].pts}if("aac"===e.segmentCodec){const t=this.config.maxAudioFramesDrift;for(let n=0,i=b;n<y.length;n++){const r=y[n],o=r.pts,s=o-i,l=Math.abs(1e3*s/a);if(s<=-t*u&&p)0===n&&(w.warn(`Audio frame @ ${(o/a).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*s/a)} ms.`),this.nextAudioPts=b=i=o);else if(s>=t*u&&l<zr&&p){let t=Math.round(s/u);i=o-t*u,i<0&&(t--,i+=u),0===n&&(this.nextAudioPts=b=i),w.warn(`[mp4-remuxer]: Injecting ${t} audio frame @ ${(i/a).toFixed(3)}s due to ${Math.round(1e3*s/a)} ms gap.`);for(let a=0;a<t;a++){const t=Math.max(i,0);let a=Fr.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);a||(w.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),a=r.unit.subarray()),y.splice(n,0,{unit:a,pts:t}),i+=u,n++}}r.pts=i,i+=u}}let S,A=null,I=null,x=0,R=y.length;while(R--)x+=y[R].unit.byteLength;for(let d=0,w=y.length;d<w;d++){const t=y[d],i=t.unit;let r=t.pts;if(null!==I){const e=h[d-1];e.duration=Math.round((r-I)/s)}else{if(n&&"aac"===e.segmentCodec&&(r=b),A=r,!(x>0))return;x+=_;try{S=new Uint8Array(x)}catch(e){return void this.observer.emit(g.ERROR,g.ERROR,{type:m.MUX_ERROR,details:v.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:x,reason:`fail allocating audio mdat ${x}`})}if(!f){const e=new DataView(S.buffer);e.setUint32(0,x),S.set(Br.types.mdat,4)}}S.set(i,_);const a=i.byteLength;_+=a,h.push(new ia(!0,l,a,0)),I=r}const C=h.length;if(!C)return;const D=h[h.length-1];this.nextAudioPts=b=I+s*D.duration;const k=f?new Uint8Array(0):Br.moof(e.sequenceNumber++,A/s,d({},e,{samples:h}));e.samples=[];const M=A/a,L=b/a,P="audio",N={data1:k,data2:S,startPTS:M,endPTS:L,startDTS:M,endDTS:L,type:P,hasAudio:!0,hasVideo:!1,nb:C};return this.isAudioContiguous=!0,N}remuxEmptyAudio(e,t,n,i){const r=e.inputTimeScale,a=e.samplerate?e.samplerate:r,o=r/a,s=this.nextAudioPts,l=this._initDTS,u=9e4*l.baseTime/l.timescale,c=(null!==s?s:i.startDTS*r)+u,d=i.endDTS*r+u,f=o*Zr,h=Math.ceil((d-c)/f),p=Fr.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(w.warn("[mp4-remuxer]: remux empty Audio"),!p)return void w.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");const g=[];for(let m=0;m<h;m++){const e=c+m*f;g.push({unit:p,pts:e,dts:e})}return e.samples=g,this.remuxAudio(e,t,n,!1)}}function Jr(e,t){let n;if(null===t)return e;n=t<e?-8589934592:8589934592;while(Math.abs(e-t)>4294967296)e+=n;return e}function ea(e){for(let t=0;t<e.length;t++)if(e[t].key)return t;return-1}function ta(e,t,n,i){const r=e.samples.length;if(!r)return;const a=e.inputTimeScale;for(let s=0;s<r;s++){const r=e.samples[s];r.pts=Jr(r.pts-n.baseTime*a/n.timescale,t*a)/a,r.dts=Jr(r.dts-i.baseTime*a/i.timescale,t*a)/a}const o=e.samples;return e.samples=[],{samples:o}}function na(e,t,n){const i=e.samples.length;if(!i)return;const r=e.inputTimeScale;for(let o=0;o<i;o++){const i=e.samples[o];i.pts=Jr(i.pts-n.baseTime*r/n.timescale,t*r)/r}e.samples.sort((e,t)=>e.pts-t.pts);const a=e.samples;return e.samples=[],{samples:a}}class ia{constructor(e,t,n,i){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=n,this.cts=i,this.flags={isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}}}class ra{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,n,i){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(Oe(e,i)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:n}=this;if(null==e||!e.byteLength)return this.initTracks=void 0,void(this.initData=void 0);const i=this.initData=ke(e);i.audio&&(t=oa(i.audio,M.AUDIO)),i.video&&(n=oa(i.video,M.VIDEO));const r={};i.audio&&i.video?r.audiovideo={container:"video/mp4",codec:t+","+n,initSegment:e,id:"main"}:i.audio?r.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:i.video?r.video={container:"video/mp4",codec:n,initSegment:e,id:"main"}:w.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=r}remux(e,t,n,i,r,a){var o,s;let{initPTS:l,lastEndTime:u}=this;const c={audio:void 0,video:void 0,text:i,id3:n,initSegment:void 0};f(u)||(u=this.lastEndTime=r||0);const d=t.samples;if(null==d||!d.length)return c;const h={initPTS:void 0,timescale:1};let p=this.initData;if(null!=(o=p)&&o.length||(this.generateInitSegment(d),p=this.initData),null==(s=p)||!s.length)return w.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),c;this.emitInitSegment&&(h.tracks=this.initTracks,this.emitInitSegment=!1);const g=Be(d,p),m=Ue(p,d),v=null===m?r:m;(aa(l,v,r,g)||h.timescale!==l.timescale&&a)&&(h.initPTS=v-r,l&&1===l.timescale&&w.warn(`Adjusting initPTS by ${h.initPTS-l.baseTime}`),this.initPTS=l={baseTime:h.initPTS,timescale:1});const y=e?v-l.baseTime/l.timescale:u,_=y+g;je(p,d,l.baseTime/l.timescale),g>0?this.lastEndTime=_:(w.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const b=!!p.audio,E=!!p.video;let T="";b&&(T+="audio"),E&&(T+="video");const S={data1:d,startPTS:y,startDTS:y,endPTS:_,endDTS:_,type:T,hasAudio:b,hasVideo:E,nb:1,dropped:0};return c.audio="audio"===S.type?S:void 0,c.video="audio"!==S.type?S:void 0,c.initSegment=h,c.id3=ta(n,r,l,l),i.samples.length&&(c.text=na(i,r,l)),c}}function aa(e,t,n,i){if(null===e)return!0;const r=Math.max(i,1),a=t-e.baseTime/e.timescale;return Math.abs(a-n)>r}function oa(e,t){const n=null==e?void 0:e.codec;if(n&&n.length>4)return n;if(t===M.AUDIO){if("ec-3"===n||"ac-3"===n||"alac"===n)return n;if("fLaC"===n||"Opus"===n){const e=!1;return bt(n,e)}const e="mp4a.40.5";return w.info(`Parsed audio codec "${n}" or audio object type not handled. Using "${e}"`),e}return w.warn(`Unhandled video codec "${n}"`),"hvc1"===n||"hev1"===n?"hvc1.1.6.L120.90":"av01"===n?"av01.0.04M.08":"avc1.42e01e"}try{Wr=self.performance.now.bind(self.performance)}catch(e){w.debug("Unable to use Performance API on this environment"),Wr=null==H?void 0:H.Date.now}const sa=[{demux:br,remux:ra},{demux:Cr,remux:Qr},{demux:yr,remux:Qr},{demux:Or,remux:Qr}];sa.splice(2,0,{demux:Tr,remux:Qr});class la{constructor(e,t,n,i,r){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.vendor=i,this.id=r}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,i){const r=n.transmuxing;r.executeStart=Wr();let a=new Uint8Array(e);const{currentTransmuxState:o,transmuxConfig:s}=this;i&&(this.currentTransmuxState=i);const{contiguous:l,discontinuity:u,trackSwitch:c,accurateTimeOffset:d,timeOffset:f,initSegmentChange:h}=i||o,{audioCodec:p,videoCodec:y,defaultInitPts:_,duration:b,initSegmentData:E}=s,T=ua(a,t);if(T&&"AES-128"===T.method){const e=this.getDecrypter();if(!e.isSync())return this.decryptionPromise=e.webCryptoDecrypt(a,T.key.buffer,T.iv.buffer).then(e=>{const t=this.push(e,null,n);return this.decryptionPromise=null,t}),this.decryptionPromise;{let t=e.softwareDecrypt(a,T.key.buffer,T.iv.buffer);const i=n.part>-1;if(i&&(t=e.flush()),!t)return r.executeEnd=Wr(),ca(n);a=new Uint8Array(t)}}const S=this.needsProbing(u,c);if(S){const e=this.configureTransmuxer(a);if(e)return w.warn(`[transmuxer] ${e.message}`),this.observer.emit(g.ERROR,g.ERROR,{type:m.MEDIA_ERROR,details:v.FRAG_PARSING_ERROR,fatal:!1,error:e,reason:e.message}),r.executeEnd=Wr(),ca(n)}(u||c||h||S)&&this.resetInitSegment(E,p,y,b,t),(u||h||S)&&this.resetInitialTimestamp(_),l||this.resetContiguity();const A=this.transmux(a,T,f,d,n),I=this.currentTransmuxState;return I.contiguous=!0,I.discontinuity=!1,I.trackSwitch=!1,r.executeEnd=Wr(),A}flush(e){const t=e.transmuxing;t.executeStart=Wr();const{decrypter:n,currentTransmuxState:i,decryptionPromise:r}=this;if(r)return r.then(()=>{return this.flush(e)});const a=[],{timeOffset:o}=i;if(n){const t=n.flush();t&&a.push(this.push(t,null,e))}const{demuxer:s,remuxer:l}=this;if(!s||!l)return t.executeEnd=Wr(),[ca(e)];const u=s.flush(o);return da(u)?u.then(t=>{return this.flushRemux(a,t,e),a}):(this.flushRemux(a,u,e),a)}flushRemux(e,t,n){const{audioTrack:i,videoTrack:r,id3Track:a,textTrack:o}=t,{accurateTimeOffset:s,timeOffset:l}=this.currentTransmuxState;w.log(`[transmuxer.ts]: Flushed fragment ${n.sn}${n.part>-1?" p: "+n.part:""} of level ${n.level}`);const u=this.remuxer.remux(i,r,a,o,l,s,!0,this.id);e.push({remuxResult:u,chunkMeta:n}),n.transmuxing.executeEnd=Wr()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;t&&n&&(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;e&&t&&(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,i,r){const{demuxer:a,remuxer:o}=this;a&&o&&(a.resetInitSegment(e,t,n,i),o.resetInitSegment(e,t,n,r))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,i,r){let a;return a=t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(e,t,n,i,r):this.transmuxUnencrypted(e,n,i,r),a}transmuxUnencrypted(e,t,n,i){const{audioTrack:r,videoTrack:a,id3Track:o,textTrack:s}=this.demuxer.demux(e,t,!1,!this.config.progressive),l=this.remuxer.remux(r,a,o,s,t,n,!1,this.id);return{remuxResult:l,chunkMeta:i}}transmuxSampleAes(e,t,n,i,r){return this.demuxer.demuxSampleAes(e,t,n).then(e=>{const t=this.remuxer.remux(e.audioTrack,e.videoTrack,e.id3Track,e.textTrack,n,i,!1,this.id);return{remuxResult:t,chunkMeta:r}})}configureTransmuxer(e){const{config:t,observer:n,typeSupported:i,vendor:r}=this;let a;for(let d=0,f=sa.length;d<f;d++){var o;if(null!=(o=sa[d].demux)&&o.probe(e)){a=sa[d];break}}if(!a)return new Error("Failed to find demuxer by probing fragment data");const s=this.demuxer,l=this.remuxer,u=a.remux,c=a.demux;l&&l instanceof u||(this.remuxer=new u(n,t,i,r)),s&&s instanceof c||(this.demuxer=new c(n,t,i),this.probe=c.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Fi(this.config)),e}}function ua(e,t){let n=null;return e.byteLength>0&&null!=(null==t?void 0:t.key)&&null!==t.iv&&null!=t.method&&(n=t),n}const ca=e=>({remuxResult:{},chunkMeta:e});function da(e){return"then"in e&&e.then instanceof Function}class fa{constructor(e,t,n,i,r){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=i,this.defaultInitPts=r||null}}class ha{constructor(e,t,n,i,r,a){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=i,this.timeOffset=r,this.initSegmentChange=a}}var pa={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}function r(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function a(e,t,i,a,o){if("function"!==typeof i)throw new TypeError("The listener must be a function");var s=new r(i,a||e,o),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function o(e,t){0===--e._eventsCount?e._events=new i:delete e._events[t]}function s(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,i,r=[];if(0===this._eventsCount)return r;for(i in e=this._events)t.call(e,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},s.prototype.listeners=function(e){var t=n?n+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,a=i.length,o=new Array(a);r<a;r++)o[r]=i[r].fn;return o},s.prototype.listenerCount=function(e){var t=n?n+e:e,i=this._events[t];return i?i.fn?1:i.length:0},s.prototype.emit=function(e,t,i,r,a,o){var s=n?n+e:e;if(!this._events[s])return!1;var l,u,c=this._events[s],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,i),!0;case 4:return c.fn.call(c.context,t,i,r),!0;case 5:return c.fn.call(c.context,t,i,r,a),!0;case 6:return c.fn.call(c.context,t,i,r,a,o),!0}for(u=1,l=new Array(d-1);u<d;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var f,h=c.length;for(u=0;u<h;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),d){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,i);break;case 4:c[u].fn.call(c[u].context,t,i,r);break;default:if(!l)for(f=1,l=new Array(d-1);f<d;f++)l[f-1]=arguments[f];c[u].fn.apply(c[u].context,l)}}return!0},s.prototype.on=function(e,t,n){return a(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return a(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,i,r){var a=n?n+e:e;if(!this._events[a])return this;if(!t)return o(this,a),this;var s=this._events[a];if(s.fn)s.fn!==t||r&&!s.once||i&&s.context!==i||o(this,a);else{for(var l=0,u=[],c=s.length;l<c;l++)(s[l].fn!==t||r&&!s[l].once||i&&s[l].context!==i)&&u.push(s[l]);u.length?this._events[a]=1===u.length?u[0]:u:o(this,a)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&o(this,t)):(this._events=new i,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s})(pa);var ga=pa.exports,ma=i(ga);class va{constructor(e,t,n,i){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const r=e.config;this.hls=e,this.id=t,this.useWorker=!!r.enableWorker,this.onTransmuxComplete=n,this.onFlush=i;const a=(e,t)=>{t=t||{},t.frag=this.frag,t.id=this.id,e===g.ERROR&&(this.error=t.error),this.hls.trigger(e,t)};this.observer=new ma,this.observer.on(g.FRAG_DECRYPTED,a),this.observer.on(g.ERROR,a);const o=lt(r.preferManagedMediaSource)||{isTypeSupported:()=>!1},s={mpeg:o.isTypeSupported("audio/mpeg"),mp3:o.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:o.isTypeSupported('audio/mp4; codecs="ac-3"')};if(this.useWorker&&"undefined"!==typeof Worker){const e=r.workerPath||Hi();if(e){try{r.workerPath?(w.log(`loading Web Worker ${r.workerPath} for "${t}"`),this.workerContext=zi(r.workerPath)):(w.log(`injecting Web Worker for "${t}"`),this.workerContext=Ki()),this.onwmsg=(e=>this.onWorkerMessage(e));const{worker:e}=this.workerContext;e.addEventListener("message",this.onwmsg),e.onerror=(e=>{const n=new Error(`${e.message}  (${e.filename}:${e.lineno})`);r.enableWorker=!1,w.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(g.ERROR,{type:m.OTHER_ERROR,details:v.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:n})}),e.postMessage({cmd:"init",typeSupported:s,vendor:"",id:t,config:JSON.stringify(r)})}catch(e){w.warn(`Error setting up "${t}" Web Worker, fallback to inline`,e),this.resetWorker(),this.error=null,this.transmuxer=new la(this.observer,s,r,"",t)}return}}this.transmuxer=new la(this.observer,s,r,"",t)}resetWorker(){if(this.workerContext){const{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,n,i,r,a,o,s,l,u){var c,d;l.transmuxing.start=self.performance.now();const{transmuxer:f}=this,h=a?a.start:r.start,p=r.decryptdata,g=this.frag,m=!(g&&r.cc===g.cc),v=!(g&&l.level===g.level),y=g?l.sn-g.sn:-1,_=this.part?l.part-this.part.index:-1,b=0===y&&l.id>1&&l.id===(null==g?void 0:g.stats.chunkCount),E=!v&&(1===y||0===y&&(1===_||b&&_<=0)),T=self.performance.now();(v||y||0===r.stats.parsing.start)&&(r.stats.parsing.start=T),!a||!_&&E||(a.stats.parsing.start=T);const S=!(g&&(null==(c=r.initSegment)?void 0:c.url)===(null==(d=g.initSegment)?void 0:d.url)),A=new ha(m,E,s,v,h,S);if(!E||m||S){w.log(`[transmuxer-interface, ${r.type}]: Starting new transmux session for sn: ${l.sn} p: ${l.part} level: ${l.level} id: ${l.id}\n        discontinuity: ${m}\n        trackSwitch: ${v}\n        contiguous: ${E}\n        accurateTimeOffset: ${s}\n        timeOffset: ${h}\n        initSegmentChange: ${S}`);const e=new fa(n,i,t,o,u);this.configureTransmuxer(e)}if(this.frag=r,this.part=a,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:p,chunkMeta:l,state:A},e instanceof ArrayBuffer?[e]:[]);else if(f){const t=f.push(e,p,l,A);da(t)?(f.async=!0,t.then(e=>{this.handleTransmuxComplete(e)}).catch(e=>{this.transmuxerError(e,l,"transmuxer-interface push error")})):(f.async=!1,this.handleTransmuxComplete(t))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let n=t.flush(e);const i=da(n);i||t.async?(da(n)||(n=Promise.resolve(n)),n.then(t=>{this.handleFlushResult(t,e)}).catch(t=>{this.transmuxerError(t,e,"transmuxer-interface flush error")})):this.handleFlushResult(n,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(g.ERROR,{type:m.MEDIA_ERROR,details:v.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach(e=>{this.handleTransmuxComplete(e)}),this.onFlush(t)}onWorkerMessage(e){const t=e.data;if(null==t||!t.event)return void w.warn(`worker message received with no ${t?"event name":"data"}`);const n=this.hls;if(this.hls)switch(t.event){case"init":{var i;const e=null==(i=this.workerContext)?void 0:i.objectURL;e&&self.URL.revokeObjectURL(e);break}case"transmuxComplete":this.handleTransmuxComplete(t.data);break;case"flush":this.onFlush(t.data);break;case"workerLog":w[t.data.logType]&&w[t.data.logType](t.data.message);break;default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data);break}}configureTransmuxer(e){const{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}function ya(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!_a(e[n].attrs,t[n].attrs))return!1;return!0}function _a(e,t,n){const i=e["STABLE-RENDITION-ID"];return i&&!n?i===t["STABLE-RENDITION-ID"]:!(n||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(n=>e[n]!==t[n])}function ba(e,t){return t.label.toLowerCase()===e.name.toLowerCase()&&(!t.language||t.language.toLowerCase()===(e.lang||"").toLowerCase())}const Ea=100;class Ta extends Gi{constructor(e,t,n){super(e,t,n,"[audio-stream-controller]",Ut.AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(g.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(g.MANIFEST_LOADING,this.onManifestLoading,this),e.on(g.LEVEL_LOADED,this.onLevelLoaded,this),e.on(g.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(g.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(g.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(g.ERROR,this.onError,this),e.on(g.BUFFER_RESET,this.onBufferReset,this),e.on(g.BUFFER_CREATED,this.onBufferCreated,this),e.on(g.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(g.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(g.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(g.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(g.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(g.MANIFEST_LOADING,this.onManifestLoading,this),e.off(g.LEVEL_LOADED,this.onLevelLoaded,this),e.off(g.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(g.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(g.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(g.ERROR,this.onError,this),e.off(g.BUFFER_RESET,this.onBufferReset,this),e.off(g.BUFFER_CREATED,this.onBufferCreated,this),e.off(g.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(g.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(g.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(g.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:r}){if("main"===n){const e=t.cc;this.initPTS[t.cc]={baseTime:i,timescale:r},this.log(`InitPTS for cc: ${e} found from main: ${i}`),this.videoTrackCC=e,this.state===Bi.WAITING_INIT_PTS&&this.tick()}}startLoad(e){if(!this.levels)return this.startPosition=e,void(this.state=Bi.STOPPED);const t=this.lastCurrentTime;this.stopLoad(),this.setInterval(Ea),t>0&&-1===e?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=Bi.IDLE):(this.loadedmetadata=!1,this.state=Bi.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case Bi.IDLE:this.doTickIdle();break;case Bi.WAITING_TRACK:{var e;const{levels:t,trackId:n}=this,i=null==t?void 0:null==(e=t[n])?void 0:e.details;if(i){if(this.waitForCdnTuneIn(i))break;this.state=Bi.WAITING_INIT_PTS}break}case Bi.FRAG_LOADING_WAITING_RETRY:{var t;const e=performance.now(),n=this.retryDate;if(!n||e>=n||null!=(t=this.media)&&t.seeking){const{levels:e,trackId:t}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((null==e?void 0:e[t])||null),this.state=Bi.IDLE}break}case Bi.WAITING_INIT_PTS:{const e=this.waitingData;if(e){const{frag:t,part:n,cache:i,complete:r}=e;if(void 0!==this.initPTS[t.cc]){this.waitingData=null,this.waitingVideoCC=-1,this.state=Bi.FRAG_LOADING;const e=i.flush(),a={frag:t,part:n,payload:e,networkDetails:null};this._handleFragmentLoadProgress(a),r&&super._handleFragmentLoadComplete(a)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${t.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const e=this.getLoadPosition(),n=mi.bufferInfo(this.mediaBuffer,e,this.config.maxBufferHole),i=Fn(n.end,this.config.maxFragLookUpTolerance,t);i<0&&(this.log(`Waiting fragment cc (${t.cc}) @ ${t.start} cancelled because another fragment at ${n.end} is needed`),this.clearWaitingFragment())}}else this.state=Bi.IDLE}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=Bi.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;null!=e&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:t,media:n,trackId:i}=this,r=e.config;if(!n&&(this.startFragRequested||!r.startFragPrefetch)||null==t||!t[i])return;const a=t[i],o=a.details;if(!o||o.live&&this.levelLastLoaded!==a||this.waitForCdnTuneIn(o))return void(this.state=Bi.WAITING_TRACK);const s=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&s&&(this.bufferFlushed=!1,this.afterBufferFlushed(s,M.AUDIO,Ut.AUDIO));const l=this.getFwdBufferInfo(s,Ut.AUDIO);if(null===l)return;const{bufferedTrack:u,switchingTrack:c}=this;if(!c&&this._streamEnded(l,o))return e.trigger(g.BUFFER_EOS,{type:"audio"}),void(this.state=Bi.ENDED);const d=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,Ut.MAIN),f=l.len,h=this.getMaxBufferLength(null==d?void 0:d.len),p=o.fragments,m=p[0].start;let v=this.flushing?this.getLoadPosition():l.end;if(c&&n){const e=this.getLoadPosition();u&&!_a(c.attrs,u.attrs)&&(v=e),o.PTSKnown&&e<m&&(l.end>m||l.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=m+.05)}if(f>=h&&!c&&v<p[p.length-1].start)return;let y=this.getNextFragment(v,o),_=!1;if(y&&this.isLoopLoading(y,v)&&(_=!!y.gap,y=this.getNextFragmentLoopLoading(y,o,l,Ut.MAIN,h)),!y)return void(this.bufferFlushed=!0);const b=d&&y.start>d.end+o.targetduration;if(b||(null==d||!d.len)&&l.len){const e=this.getAppendedFrag(y.start,Ut.MAIN);if(null===e)return;if(_||(_=!!e.gap||!!b&&0===d.len),b&&!_||_&&l.nextStart&&l.nextStart<e.end)return}this.loadFragment(y,a,v)}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,this.bufferFlushed=this.flushing=!1,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(e=>new fn(e))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:i}=this;i&&(i.abortRequests(),this.removeUnbufferedFrags(i.start)),this.resetLoadingState(),n?this.setInterval(Ea):this.resetTransmuxer(),n?(this.switchingTrack=t,this.state=Bi.IDLE,this.flushAudioIfNeeded(t)):(this.switchingTrack=null,this.bufferedTrack=t,this.state=Bi.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=this.flushing=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,null!==this.cachedTrackLoadedData&&(this.hls.trigger(g.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var n;if(null==this.mainDetails)return void(this.cachedTrackLoadedData=t);const{levels:i}=this,{details:r,id:a}=t;if(!i)return void this.warn(`Audio tracks were reset while loading level ${a}`);this.log(`Audio track ${a} loaded [${r.startSN},${r.endSN}]${r.lastPartSn?`[part-${r.lastPartSn}-${r.lastPartIndex}]`:""},duration:${r.totalduration}`);const o=i[a];let s=0;if(r.live||null!=(n=o.details)&&n.live){this.checkLiveUpdate(r);const e=this.mainDetails;if(r.deltaUpdateFailed||!e)return;var l;if(!o.details&&r.hasProgramDateTime&&e.hasProgramDateTime)Ii(r,e),s=r.fragments[0].start;else s=this.alignPlaylists(r,o.details,null==(l=this.levelLastLoaded)?void 0:l.details)}o.details=r,this.levelLastLoaded=o,this.startFragRequested||!this.mainDetails&&r.live||this.setStartPosition(this.mainDetails||r,s),this.state!==Bi.WAITING_TRACK||this.waitForCdnTuneIn(r)||(this.state=Bi.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:i,payload:r}=e,{config:a,trackId:o,levels:s}=this;if(!s)return void this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);const l=s[o];if(!l)return void this.warn("Audio track is undefined on fragment load progress");const u=l.details;if(!u)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(n.start);const c=a.defaultAudioCodec||l.audioCodec||"mp4a.40.2";let d=this.transmuxer;d||(d=this.transmuxer=new va(this.hls,Ut.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const f=this.initPTS[n.cc],h=null==(t=n.initSegment)?void 0:t.data;if(void 0!==f){const e=!1,t=i?i.index:-1,a=-1!==t,o=new vi(n.level,n.sn,n.stats.chunkCount,r.byteLength,t,a);d.push(r,h,c,"",n,i,u.totalduration,e,o,f)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${u.startSN} ,${u.endSN}],track ${o}`);const{cache:e}=this.waitingData=this.waitingData||{frag:n,part:i,cache:new ji,complete:!1};e.push(new Uint8Array(r)),this.waitingVideoCC=this.videoTrackCC,this.state=Bi.WAITING_INIT_PTS}}_handleFragmentLoadComplete(e){this.waitingData?this.waitingData.complete=!0:super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){const{frag:n,part:i}=t;if(n.type===Ut.AUDIO)if(this.fragContextChanged(n))this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);else{if("initSegment"!==n.sn){this.fragPrevious=n;const e=this.switchingTrack;e&&(this.bufferedTrack=e,this.switchingTrack=null,this.hls.trigger(g.AUDIO_TRACK_SWITCHED,s({},e)))}this.fragBufferedComplete(n,i)}else if(!this.loadedmetadata&&n.type===Ut.MAIN){const e=this.videoBuffer||this.media;if(e){const t=mi.getBuffered(e);t.length&&(this.loadedmetadata=!0)}}}onError(e,t){var n;if(t.fatal)this.state=Bi.ERROR;else switch(t.details){case v.FRAG_GAP:case v.FRAG_PARSING_ERROR:case v.FRAG_DECRYPT_ERROR:case v.FRAG_LOAD_ERROR:case v.FRAG_LOAD_TIMEOUT:case v.KEY_LOAD_ERROR:case v.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Ut.AUDIO,t);break;case v.AUDIO_TRACK_LOAD_ERROR:case v.AUDIO_TRACK_LOAD_TIMEOUT:case v.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==Bi.WAITING_TRACK||(null==(n=t.context)?void 0:n.type)!==Ft.AUDIO_TRACK||(this.state=Bi.IDLE);break;case v.BUFFER_APPEND_ERROR:case v.BUFFER_FULL_ERROR:if(!t.parent||"audio"!==t.parent)return;if(t.details===v.BUFFER_APPEND_ERROR)return void this.resetLoadingState();this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case v.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==M.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==M.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===Bi.ENDED&&(this.state=Bi.IDLE);const e=this.mediaBuffer||this.media;e&&(this.afterBufferFlushed(e,t,Ut.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const n="audio",{hls:i}=this,{remuxResult:r,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o)return void this.resetWhenMissingContext(a);const{frag:s,part:l,level:u}=o,{details:c}=u,{audio:f,text:h,id3:p,initSegment:m}=r;if(!this.fragContextChanged(s)&&c){if(this.state=Bi.PARSING,this.switchingTrack&&f&&this.completeAudioSwitch(this.switchingTrack),null!=m&&m.tracks){const e=s.initSegment||s;this._bufferInitSegment(u,m.tracks,e,a),i.trigger(g.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:n,tracks:m.tracks})}if(f){const{startPTS:e,endPTS:t,startDTS:n,endDTS:i}=f;l&&(l.elementaryStreams[M.AUDIO]={startPTS:e,endPTS:t,startDTS:n,endDTS:i}),s.setElementaryStreamInfo(M.AUDIO,e,t,n,i),this.bufferFragmentData(f,s,l,a)}if(null!=p&&null!=(t=p.samples)&&t.length){const e=d({id:n,frag:s,details:c},p);i.trigger(g.FRAG_PARSING_METADATA,e)}if(h){const e=d({id:n,frag:s,details:c},h);i.trigger(g.FRAG_PARSING_USERDATA,e)}}else this.fragmentTracker.removeFragment(s)}_bufferInitSegment(e,t,n,i){if(this.state!==Bi.PARSING)return;t.video&&delete t.video;const r=t.audio;if(!r)return;r.id="audio";const a=e.audioCodec;this.log(`Init audio buffer, container:${r.container}, codecs[level/parsed]=[${a}/${r.codec}]`),a&&1===a.split(",").length&&(r.levelCodec=a),this.hls.trigger(g.BUFFER_CODECS,t);const o=r.initSegment;if(null!=o&&o.byteLength){const e={type:"audio",frag:n,part:null,chunkMeta:i,parent:n.type,data:o};this.hls.trigger(g.BUFFER_APPENDING,e)}this.tickImmediate()}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);var r;if(this.fragCurrent=e,this.switchingTrack||i===di.NOT_LOADED||i===di.PARTIAL)if("initSegment"===e.sn)this._loadInitSegment(e,t);else if(null!=(r=t.details)&&r.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=Bi.WAITING_INIT_PTS;const n=this.mainDetails;n&&n.fragments[0].start!==t.details.fragments[0].start&&Ii(t.details,n)}else this.startFragRequested=!0,super.loadFragment(e,t,n);else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){const{media:t,bufferedTrack:n}=this,i=null==n?void 0:n.attrs,r=e.attrs;t&&i&&(i.CHANNELS!==r.CHANNELS||n.name!==e.name||n.lang!==e.lang)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null)}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(g.AUDIO_TRACK_SWITCHED,s({},e))}}class Sa extends Hn{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(g.MANIFEST_LOADING,this.onManifestLoading,this),e.on(g.MANIFEST_PARSED,this.onManifestParsed,this),e.on(g.LEVEL_LOADING,this.onLevelLoading,this),e.on(g.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(g.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(g.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(g.MANIFEST_LOADING,this.onManifestLoading,this),e.off(g.MANIFEST_PARSED,this.onManifestParsed,this),e.off(g.LEVEL_LOADING,this.onLevelLoading,this),e.off(g.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(g.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(g.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:i,details:r}=t,a=this.tracksInGroup[n];if(!a||a.groupId!==i)return void this.warn(`Audio track with id:${n} and group:${i} not found in active group ${null==a?void 0:a.groupId}`);const o=a.details;a.details=t.details,this.log(`Audio track ${n} "${a.name}" lang:${a.lang} group:${i} loaded [${r.startSN}-${r.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,o)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.audioGroups||null,i=this.groupIds;let r=this.currentTrack;if(!n||(null==i?void 0:i.length)!==(null==n?void 0:n.length)||null!=n&&n.some(e=>-1===(null==i?void 0:i.indexOf(e)))){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const e=this.tracks.filter(e=>!n||-1!==n.indexOf(e.groupId));if(e.length)this.selectDefaultTrack&&!e.some(e=>e.default)&&(this.selectDefaultTrack=!1),e.forEach((e,t)=>{e.id=t});else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=e;const t=this.hls.config.audioPreference;if(!r&&t){const n=ii(t,e,oi);if(n>-1)r=e[n];else{const e=ii(t,this.tracks);r=this.tracks[e]}}let i=this.findTrackId(r);-1===i&&r&&(i=this.findTrackId(null));const o={audioTracks:e};this.log(`Updating audio tracks, ${e.length} track(s) found in group(s): ${null==n?void 0:n.join(",")}`),this.hls.trigger(g.AUDIO_TRACKS_UPDATED,o);const s=this.trackId;if(-1!==i&&-1===s)this.setAudioTrack(i);else if(e.length&&-1===s){var a;const t=new Error(`No audio track selected for current audio group-ID(s): ${null==(a=this.groupIds)?void 0:a.join(",")} track count: ${e.length}`);this.warn(t.message),this.hls.trigger(g.ERROR,{type:m.MEDIA_ERROR,details:v.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:t})}}else this.shouldReloadPlaylist(r)&&this.setAudioTrack(this.trackId)}onError(e,t){!t.fatal&&t.context&&(t.context.type!==Ft.AUDIO_TRACK||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||(this.requestScheduled=-1,this.checkRetry(t)))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){const i=this.currentTrack;if(i&&ri(e,i,oi))return i;const r=ii(e,this.tracksInGroup,oi);if(r>-1){const e=this.tracksInGroup[r];return this.setAudioTrack(r),e}if(i){let i=t.loadLevel;-1===i&&(i=t.firstAutoLevel);const r=si(e,t.levels,n,i,oi);if(-1===r)return null;t.nextLoadLevel=r}if(e.channels||e.audioCodec){const t=ii(e,n);if(t>-1)return n[t]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length)return void this.warn(`Invalid audio track id: ${e}`);this.clearTimer(),this.selectDefaultTrack=!1;const n=this.currentTrack,i=t[e],r=i.details&&!i.details.live;if(e===this.trackId&&i===n&&r)return;if(this.log(`Switching to audio-track ${e} "${i.name}" lang:${i.lang} group:${i.groupId} channels:${i.channels}`),this.trackId=e,this.currentTrack=i,this.hls.trigger(g.AUDIO_TRACK_SWITCHING,s({},i)),r)return;const a=this.switchParams(i.url,null==n?void 0:n.details,i.details);this.loadPlaylist(a)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if((!this.selectDefaultTrack||i.default)&&(!e||ri(e,i,oi)))return n}if(e){const{name:n,lang:i,assocLang:r,characteristics:a,audioCodec:o,channels:s}=e;for(let e=0;e<t.length;e++){const l=t[e];if(ri({name:n,lang:i,assocLang:r,characteristics:a,audioCodec:o,channels:s},l,oi))return e}for(let l=0;l<t.length;l++){const n=t[l];if(_a(e.attrs,n.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return l}for(let l=0;l<t.length;l++){const n=t[l];if(_a(e.attrs,n.attrs,["LANGUAGE"]))return l}}return-1}loadPlaylist(e){const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){super.loadPlaylist();const n=t.id,i=t.groupId;let r=t.url;if(e)try{r=e.addDirectives(r)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}this.log(`loading audio-track playlist ${n} "${t.name}" lang:${t.lang} group:${i}`),this.clearTimer(),this.hls.trigger(g.AUDIO_TRACK_LOADING,{url:r,id:n,groupId:i,deliveryDirectives:e||null})}}}const wa=500;class Aa extends Gi{constructor(e,t,n){super(e,t,n,"[subtitle-stream-controller]",Ut.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(g.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(g.MANIFEST_LOADING,this.onManifestLoading,this),e.on(g.LEVEL_LOADED,this.onLevelLoaded,this),e.on(g.ERROR,this.onError,this),e.on(g.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(g.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(g.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(g.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(g.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(g.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(g.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(g.MANIFEST_LOADING,this.onManifestLoading,this),e.off(g.LEVEL_LOADED,this.onLevelLoaded,this),e.off(g.ERROR,this.onError,this),e.off(g.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(g.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(g.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(g.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(g.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(g.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=Bi.IDLE,this.setInterval(wa),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:i}=t;if(this.fragPrevious=n,this.state=Bi.IDLE,!i)return;const r=this.tracksBuffered[this.currentTrackId];if(!r)return;let a;const o=n.start;for(let l=0;l<r.length;l++)if(o>=r[l].start&&o<=r[l].end){a=r[l];break}const s=n.start+n.duration;a?a.end=s:(a={start:o,end:s},r.push(a)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null)}onBufferFlushing(e,t){const{startOffset:n,endOffset:i}=t;if(0===n&&i!==Number.POSITIVE_INFINITY){const e=i-1;if(e<=0)return;t.endOffsetSubtitles=Math.max(0,e),this.tracksBuffered.forEach(t=>{for(let n=0;n<t.length;)if(t[n].end<=e)t.shift();else{if(!(t[n].start<e))break;t[n].start=e,n++}}),this.fragmentTracker.removeFragmentsInRange(n,e,Ut.SUBTITLE)}}onFragBuffered(e,t){var n;this.loadedmetadata||t.frag.type!==Ut.MAIN||null!=(n=this.media)&&n.buffered.length&&(this.loadedmetadata=!0)}onError(e,t){const n=t.frag;(null==n?void 0:n.type)===Ut.SUBTITLE&&(t.details===v.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==Bi.STOPPED&&(this.state=Bi.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){this.levels&&ya(this.levels,t)?this.levels=t.map(e=>new fn(e)):(this.tracksBuffered=[],this.levels=t.map(e=>{const t=new fn(e);return this.tracksBuffered[t.id]=[],t}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Ut.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null)}onSubtitleTrackSwitch(e,t){var n;if(this.currentTrackId=t.id,null==(n=this.levels)||!n.length||-1===this.currentTrackId)return void this.clearInterval();const i=this.levels[this.currentTrackId];null!=i&&i.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,i&&this.setInterval(wa)}onSubtitleTrackLoaded(e,t){var n;const{currentTrackId:i,levels:r}=this,{details:a,id:o}=t;if(!r)return void this.warn(`Subtitle tracks were reset while loading level ${o}`);const s=r[o];if(o>=r.length||!s)return;this.log(`Subtitle track ${o} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""},duration:${a.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let l=0;if(a.live||null!=(n=s.details)&&n.live){const e=this.mainDetails;if(a.deltaUpdateFailed||!e)return;const t=e.fragments[0];var u;if(s.details)l=this.alignPlaylists(a,s.details,null==(u=this.levelLastLoaded)?void 0:u.details),0===l&&t&&(l=t.start,En(a,l));else a.hasProgramDateTime&&e.hasProgramDateTime?(Ii(a,e),l=a.fragments[0].start):t&&(l=t.start,En(a,l))}if(s.details=a,this.levelLastLoaded=s,o===i&&(this.startFragRequested||!this.mainDetails&&a.live||this.setStartPosition(this.mainDetails||a,l),this.tick(),a.live&&!this.fragCurrent&&this.media&&this.state===Bi.IDLE)){const e=Nn(null,a.fragments,this.media.currentTime,0);e||(this.warn("Subtitle playlist not aligned with playback"),s.details=void 0)}}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,i=t.decryptdata,r=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&null!=i&&i.key&&i.iv&&"AES-128"===i.method){const e=performance.now();this.decrypter.decrypt(new Uint8Array(n),i.key.buffer,i.iv.buffer).catch(e=>{throw r.trigger(g.ERROR,{type:m.MEDIA_ERROR,details:v.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:t}),e}).then(n=>{const i=performance.now();r.trigger(g.FRAG_DECRYPTED,{frag:t,payload:n,stats:{tstart:e,tdecrypt:i}})}).catch(e=>{this.warn(`${e.name}: ${e.message}`),this.state=Bi.IDLE})}}doTick(){if(this.media){if(this.state===Bi.IDLE){const{currentTrackId:e,levels:t}=this,n=null==t?void 0:t[e];if(!n||!t.length||!n.details)return;const{config:i}=this,r=this.getLoadPosition(),a=mi.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],r,i.maxBufferHole),{end:o,len:s}=a,l=this.getFwdBufferInfo(this.media,Ut.MAIN),u=n.details,c=this.getMaxBufferLength(null==l?void 0:l.len)+u.levelTargetDuration;if(s>c)return;const d=u.fragments,f=d.length,h=u.edge;let p=null;const g=this.fragPrevious;if(o<h){const e=i.maxFragLookUpTolerance,t=o>h-e?0:e;p=Nn(g,d,Math.max(d[0].start,o),t),!p&&g&&g.start<d[0].start&&(p=d[0])}else p=d[f-1];if(!p)return;if(p=this.mapToInitFragWhenRequired(p),"initSegment"!==p.sn){const e=p.sn-u.startSN,t=d[e-1];t&&t.cc===p.cc&&this.fragmentTracker.getState(t)===di.NOT_LOADED&&(p=t)}this.fragmentTracker.getState(p)===di.NOT_LOADED&&this.loadFragment(p,n,o)}}else this.state=Bi.IDLE}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,n){this.fragCurrent=e,"initSegment"===e.sn?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,n))}get mediaBufferTimeRanges(){return new Ia(this.tracksBuffered[this.currentTrackId]||[])}}class Ia{constructor(e){this.buffered=void 0;const t=(t,n,i)=>{if(n>>>=0,n>i-1)throw new DOMException(`Failed to execute '${t}' on 'TimeRanges': The index provided (${n}) is greater than the maximum bound (${i})`);return e[n][t]};this.buffered={get length(){return e.length},end(n){return t("end",n,e.length)},start(n){return t("start",n,e.length)}}}}class xa extends Hn{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.asyncPollTrackChange=(()=>this.pollTrackChange(0)),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.onTextTracksChanged=(()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=null;const t=Yt(this.media.textTracks);for(let i=0;i<t.length;i++)if("hidden"===t[i].mode)e=t[i];else if("showing"===t[i].mode){e=t[i];break}const n=this.findTrackForTextTrack(e);this.subtitleTrack!==n&&this.setSubtitleTrack(n)}),this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(g.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(g.MANIFEST_LOADING,this.onManifestLoading,this),e.on(g.MANIFEST_PARSED,this.onManifestParsed,this),e.on(g.LEVEL_LOADING,this.onLevelLoading,this),e.on(g.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(g.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(g.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(g.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(g.MANIFEST_LOADING,this.onManifestLoading,this),e.off(g.MANIFEST_PARSED,this.onManifestParsed,this),e.off(g.LEVEL_LOADING,this.onLevelLoading,this),e.off(g.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(g.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(g.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);const e=Yt(this.media.textTracks);e.forEach(e=>{Kt(e)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,groupId:i,details:r}=t,a=this.tracksInGroup[n];if(!a||a.groupId!==i)return void this.warn(`Subtitle track with id:${n} and group:${i} not found in active group ${null==a?void 0:a.groupId}`);const o=a.details;a.details=t.details,this.log(`Subtitle track ${n} "${a.name}" lang:${a.lang} group:${i} loaded [${r.startSN}-${r.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,o)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.subtitleGroups||null,i=this.groupIds;let r=this.currentTrack;if(!n||(null==i?void 0:i.length)!==(null==n?void 0:n.length)||null!=n&&n.some(e=>-1===(null==i?void 0:i.indexOf(e)))){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const e=this.tracks.filter(e=>!n||-1!==n.indexOf(e.groupId));if(e.length)this.selectDefaultTrack&&!e.some(e=>e.default)&&(this.selectDefaultTrack=!1),e.forEach((e,t)=>{e.id=t});else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=e;const t=this.hls.config.subtitlePreference;if(!r&&t){this.selectDefaultTrack=!1;const n=ii(t,e);if(n>-1)r=e[n];else{const e=ii(t,this.tracks);r=this.tracks[e]}}let i=this.findTrackId(r);-1===i&&r&&(i=this.findTrackId(null));const a={subtitleTracks:e};this.log(`Updating subtitle tracks, ${e.length} track(s) found in "${null==n?void 0:n.join(",")}" group-id`),this.hls.trigger(g.SUBTITLE_TRACKS_UPDATED,a),-1!==i&&-1===this.trackId&&this.setSubtitleTrack(i)}else this.shouldReloadPlaylist(r)&&this.setSubtitleTrack(this.trackId)}findTrackId(e){const t=this.tracksInGroup,n=this.selectDefaultTrack;for(let i=0;i<t.length;i++){const r=t[i];if((!n||r.default)&&(n||e)&&(!e||ri(r,e)))return i}if(e){for(let n=0;n<t.length;n++){const i=t[n];if(_a(e.attrs,i.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return n}for(let n=0;n<t.length;n++){const i=t[n];if(_a(e.attrs,i.attrs,["LANGUAGE"]))return n}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if(ba(i,e))return n}}return-1}onError(e,t){!t.fatal&&t.context&&(t.context.type!==Ft.SUBTITLE_TRACK||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||this.checkRetry(t))}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const n=this.currentTrack;if(n&&ri(e,n))return n;const i=ii(e,this.tracksInGroup);if(i>-1){const e=this.tracksInGroup[i];return this.setSubtitleTrack(i),e}if(n)return null;{const n=ii(e,t);if(n>-1)return t[n]}}}return null}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){const n=t.id,i=t.groupId;let r=t.url;if(e)try{r=e.addDirectives(r)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}this.log(`Loading subtitle playlist for id ${n}`),this.hls.trigger(g.SUBTITLE_TRACK_LOADING,{url:r,id:n,groupId:i,deliveryDirectives:e||null})}}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=Yt(e.textTracks),n=this.currentTrack;let i;if(n&&(i=t.filter(e=>ba(n,e))[0],i||this.warn(`Unable to find subtitle TextTrack with name "${n.name}" and language "${n.lang}"`)),[].slice.call(t).forEach(e=>{"disabled"!==e.mode&&e!==i&&(e.mode="disabled")}),i){const e=this.subtitleDisplay?"showing":"hidden";i.mode!==e&&(i.mode=e)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media)return void(this.queuedDefaultTrack=e);if(e<-1||e>=t.length||!f(e))return void this.warn(`Invalid subtitle track id: ${e}`);this.clearTimer(),this.selectDefaultTrack=!1;const n=this.currentTrack,i=t[e]||null;if(this.trackId=e,this.currentTrack=i,this.toggleTrackModes(),!i)return void this.hls.trigger(g.SUBTITLE_TRACK_SWITCH,{id:e});const r=!!i.details&&!i.details.live;if(e===this.trackId&&i===n&&r)return;this.log(`Switching to subtitle-track ${e}`+(i?` "${i.name}" lang:${i.lang} group:${i.groupId}`:""));const{id:a,groupId:o="",name:s,type:l,url:u}=i;this.hls.trigger(g.SUBTITLE_TRACK_SWITCH,{id:a,groupId:o,name:s,type:l,url:u});const c=this.switchParams(i.url,null==n?void 0:n.details,i.details);this.loadPlaylist(c)}}class Ra{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t,n){const i=this.queues[t];i.push(e),1!==i.length||n||this.executeNext(t)}insertAbort(e,t){const n=this.queues[t];n.unshift(e),this.executeNext(t)}appendBlocker(e){let t;const n=new Promise(e=>{t=e}),i={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(i,e),n}executeNext(e){const t=this.queues[e];if(t.length){const n=t[0];try{n.execute()}catch(t){w.warn(`[buffer-operation-queue]: Exception executing "${e}" SourceBuffer operation: ${t}`),n.onError(t);const i=this.buffers[e];null!=i&&i.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}const Ca=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/;class Da{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendSource=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this.log=void 0,this.warn=void 0,this.error=void 0,this._onEndStreaming=(e=>{this.hls&&this.hls.pauseBuffering()}),this._onStartStreaming=(e=>{this.hls&&this.hls.resumeBuffering()}),this._onMediaSourceOpen=(()=>{const{media:e,mediaSource:t}=this;this.log("Media source opened"),e&&(e.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(g.MEDIA_ATTACHED,{media:e,mediaSource:t})),t&&t.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()}),this._onMediaSourceClose=(()=>{this.log("Media source closed")}),this._onMediaSourceEnded=(()=>{this.log("Media source ended")}),this._onMediaEmptied=(()=>{const{mediaSrc:e,_objectUrl:t}=this;e!==t&&w.error(`Media element src was set while attaching MediaSource (${t} > ${e})`)}),this.hls=e;const t="[buffer-controller]";this.appendSource=ut(lt(e.config.preferManagedMediaSource)),this.log=w.log.bind(w,t),this.warn=w.warn.bind(w,t),this.error=w.error.bind(w,t),this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null,this.hls=null}registerListeners(){const{hls:e}=this;e.on(g.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(g.MANIFEST_LOADING,this.onManifestLoading,this),e.on(g.MANIFEST_PARSED,this.onManifestParsed,this),e.on(g.BUFFER_RESET,this.onBufferReset,this),e.on(g.BUFFER_APPENDING,this.onBufferAppending,this),e.on(g.BUFFER_CODECS,this.onBufferCodecs,this),e.on(g.BUFFER_EOS,this.onBufferEos,this),e.on(g.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(g.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(g.FRAG_PARSED,this.onFragParsed,this),e.on(g.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(g.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(g.MANIFEST_LOADING,this.onManifestLoading,this),e.off(g.MANIFEST_PARSED,this.onManifestParsed,this),e.off(g.BUFFER_RESET,this.onBufferReset,this),e.off(g.BUFFER_APPENDING,this.onBufferAppending,this),e.off(g.BUFFER_CODECS,this.onBufferCodecs,this),e.off(g.BUFFER_EOS,this.onBufferEos,this),e.off(g.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(g.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(g.FRAG_PARSED,this.onFragParsed,this),e.off(g.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new Ra(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.appendErrors={audio:0,video:0,audiovideo:0},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n,this.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){const n=this.media=t.media,i=lt(this.appendSource);if(n&&i){var r;const e=this.mediaSource=new i;this.log(`created media source: ${null==(r=e.constructor)?void 0:r.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming));const t=this._objectUrl=self.URL.createObjectURL(e);if(this.appendSource)try{n.removeAttribute("src");const i=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||i&&e instanceof i,ka(n),Ma(n,t),n.load()}catch(e){n.src=t}else n.src=t;n.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:t,_objectUrl:n}=this;if(t){if(this.log("media source detaching"),"open"===t.readyState)try{t.endOfStream()}catch(e){this.warn(`onMediaDetaching: ${e.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(t.removeEventListener("startstreaming",this._onStartStreaming),t.removeEventListener("endstreaming",this._onEndStreaming)),e&&(e.removeEventListener("emptied",this._onMediaEmptied),n&&self.URL.revokeObjectURL(n),this.mediaSrc===n?(e.removeAttribute("src"),this.appendSource&&ka(e),e.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(g.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(e=>{this.resetBuffer(e)}),this._initSourceBuffer()}resetBuffer(e){const t=this.sourceBuffer[e];try{var n;if(t)this.removeBufferListeners(e),this.sourceBuffer[e]=void 0,null!=(n=this.mediaSource)&&n.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(t)}catch(t){this.warn(`onBufferReset ${e}`,t)}}onBufferCodecs(e,t){const n=this.getSourceBufferTypes().length,i=Object.keys(t);if(i.forEach(e=>{if(n){const n=this.tracks[e];if(n&&"function"===typeof n.buffer.changeType){var i;const{id:r,codec:a,levelCodec:o,container:s,metadata:l}=t[e],u=Et(n.codec,n.levelCodec),c=null==u?void 0:u.replace(Ca,"$1");let d=Et(a,o);const f=null==(i=d)?void 0:i.replace(Ca,"$1");if(d&&c!==f){"audio"===e.slice(0,5)&&(d=bt(d,this.appendSource));const t=`${s};codecs=${d}`;this.appendChangeType(e,t),this.log(`switching codec ${u} to ${d}`),this.tracks[e]={buffer:n.buffer,codec:a,container:s,levelCodec:o,metadata:l,id:r}}}}else this.pendingTracks[e]=t[e]}),n)return;const r=Math.max(this.bufferCodecEventsExpected-1,0);this.bufferCodecEventsExpected!==r&&(this.log(`${r} bufferCodec event(s) expected ${i.join(",")}`),this.bufferCodecEventsExpected=r),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks()}appendChangeType(e,t){const{operationQueue:n}=this,i={execute:()=>{const i=this.sourceBuffer[e];i&&(this.log(`changing ${e} sourceBuffer type to ${t}`),i.changeType(t)),n.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:t=>{this.warn(`Failed to change ${e} SourceBuffer type`,t)}};n.append(i,e,!!this.pendingTracks[e])}onBufferAppending(e,t){const{hls:n,operationQueue:i,tracks:r}=this,{data:a,type:o,frag:s,part:l,chunkMeta:u}=t,c=u.buffering[o],d=self.performance.now();c.start=d;const f=s.stats.buffering,h=l?l.stats.buffering:null;0===f.start&&(f.start=d),h&&0===h.start&&(h.start=d);const p=r.audio;let y=!1;"audio"===o&&"audio/mpeg"===(null==p?void 0:p.container)&&(y=!this.lastMpegAudioChunk||1===u.id||this.lastMpegAudioChunk.sn!==u.sn,this.lastMpegAudioChunk=u);const _=s.start,b={execute:()=>{if(c.executeStart=self.performance.now(),y){const e=this.sourceBuffer[o];if(e){const t=_-e.timestampOffset;Math.abs(t)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${_} (delta: ${t}) sn: ${s.sn})`),e.timestampOffset=_)}}this.appendExecutor(a,o)},onStart:()=>{},onComplete:()=>{const e=self.performance.now();c.executeEnd=c.end=e,0===f.first&&(f.first=e),h&&0===h.first&&(h.first=e);const{sourceBuffer:t}=this,n={};for(const i in t)n[i]=mi.getBuffered(t[i]);this.appendErrors[o]=0,"audio"===o||"video"===o?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(g.BUFFER_APPENDED,{type:o,frag:s,part:l,chunkMeta:u,parent:s.type,timeRanges:n})},onError:e=>{const t={type:m.MEDIA_ERROR,parent:s.type,details:v.BUFFER_APPEND_ERROR,sourceBufferName:o,frag:s,part:l,chunkMeta:u,error:e,err:e,fatal:!1};if(e.code===DOMException.QUOTA_EXCEEDED_ERR)t.details=v.BUFFER_FULL_ERROR;else{const e=++this.appendErrors[o];t.details=v.BUFFER_APPEND_ERROR,this.warn(`Failed ${e}/${n.config.appendErrorMaxRetry} times to append segment in "${o}" sourceBuffer`),e>=n.config.appendErrorMaxRetry&&(t.fatal=!0)}n.trigger(g.ERROR,t)}};i.append(b,o,!!this.pendingTracks[o])}onBufferFlushing(e,t){const{operationQueue:n}=this,i=e=>({execute:this.removeExecutor.bind(this,e,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(g.BUFFER_FLUSHED,{type:e})},onError:t=>{this.warn(`Failed to remove from ${e} SourceBuffer`,t)}});t.type?n.append(i(t.type),t.type):this.getSourceBufferTypes().forEach(e=>{n.append(i(e),e)})}onFragParsed(e,t){const{frag:n,part:i}=t,r=[],a=i?i.elementaryStreams:n.elementaryStreams;a[M.AUDIOVIDEO]?r.push("audiovideo"):(a[M.AUDIO]&&r.push("audio"),a[M.VIDEO]&&r.push("video"));const o=()=>{const e=self.performance.now();n.stats.buffering.end=e,i&&(i.stats.buffering.end=e);const t=i?i.stats:n.stats;this.hls.trigger(g.FRAG_BUFFERED,{frag:n,part:i,stats:t,id:n.type})};0===r.length&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(o,r)}onFragChanged(e,t){this.trimBuffers()}onBufferEos(e,t){const n=this.getSourceBufferTypes().reduce((e,n)=>{const i=this.sourceBuffer[n];return!i||t.type&&t.type!==n||(i.ending=!0,i.ended||(i.ended=!0,this.log(`${n} sourceBuffer now EOS`))),e&&!(i&&!i.ended)},!0);n&&(this.log("Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(e=>{const t=this.sourceBuffer[e];t&&(t.ending=!1)});const{mediaSource:e}=this;e&&"open"===e.readyState?(this.log("Calling mediaSource.endOfStream()"),e.endOfStream()):e&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${e.readyState}`)}))}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}trimBuffers(){const{hls:e,details:t,media:n}=this;if(!n||null===t)return;const i=this.getSourceBufferTypes();if(!i.length)return;const r=e.config,a=n.currentTime,o=t.levelTargetDuration,s=t.live&&null!==r.liveBackBufferLength?r.liveBackBufferLength:r.backBufferLength;if(f(s)&&s>0){const e=Math.max(s,o),t=Math.floor(a/o)*o-e;this.flushBackBuffer(a,o,t)}if(f(r.frontBufferFlushThreshold)&&r.frontBufferFlushThreshold>0){const e=Math.max(r.maxBufferLength,r.frontBufferFlushThreshold),t=Math.max(e,o),n=Math.floor(a/o)*o+t;this.flushFrontBuffer(a,o,n)}}flushBackBuffer(e,t,n){const{details:i,sourceBuffer:r}=this,a=this.getSourceBufferTypes();a.forEach(a=>{const o=r[a];if(o){const r=mi.getBuffered(o);if(r.length>0&&n>r.start(0)){if(this.hls.trigger(g.BACK_BUFFER_REACHED,{bufferEnd:n}),null!=i&&i.live)this.hls.trigger(g.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(o.ended&&r.end(r.length-1)-e<2*t)return void this.log(`Cannot flush ${a} back buffer while SourceBuffer is in ended state`);this.hls.trigger(g.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:a})}}})}flushFrontBuffer(e,t,n){const{sourceBuffer:i}=this,r=this.getSourceBufferTypes();r.forEach(r=>{const a=i[r];if(a){const i=mi.getBuffered(a),o=i.length;if(o<2)return;const s=i.start(o-1),l=i.end(o-1);if(n>s||e>=s&&e<=l)return;if(a.ended&&e-l<2*t)return void this.log(`Cannot flush ${r} front buffer while SourceBuffer is in ended state`);this.hls.trigger(g.BUFFER_FLUSHING,{startOffset:s,endOffset:1/0,type:r})}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||"open"!==this.mediaSource.readyState)return;const{details:e,hls:t,media:n,mediaSource:i}=this,r=e.fragments[0].start+e.totalduration,a=n.duration,o=f(i.duration)?i.duration:0;e.live&&t.config.liveDurationInfinity?(i.duration=1/0,this.updateSeekableRange(e)):(r>o&&r>a||!f(a))&&(this.log(`Updating Media Source duration to ${r.toFixed(3)}`),i.duration=r)}updateSeekableRange(e){const t=this.mediaSource,n=e.fragments,i=n.length;if(i&&e.live&&null!=t&&t.setLiveSeekableRange){const i=Math.max(0,n[0].start),r=Math.max(i,i+e.totalduration);this.log(`Media Source duration is set to ${t.duration}. Setting seekable range to ${i}-${r}.`),t.setLiveSeekableRange(i,r)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:n}=this,i=Object.keys(n).length;if(i&&(!e||2===i||"audiovideo"in n)){this.createSourceBuffers(n),this.pendingTracks={};const e=this.getSourceBufferTypes();if(e.length)this.hls.trigger(g.BUFFER_CREATED,{tracks:this.tracks}),e.forEach(e=>{t.executeNext(e)});else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(g.ERROR,{type:m.MEDIA_ERROR,details:v.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}}createSourceBuffers(e){const{sourceBuffer:t,mediaSource:n}=this;if(!n)throw Error("createSourceBuffers called when mediaSource was null");for(const r in e)if(!t[r]){var i;const a=e[r];if(!a)throw Error(`source buffer exists for track ${r}, however track does not`);let o=-1===(null==(i=a.levelCodec)?void 0:i.indexOf(","))?a.levelCodec:a.codec;o&&"audio"===r.slice(0,5)&&(o=bt(o,this.appendSource));const s=`${a.container};codecs=${o}`;this.log(`creating sourceBuffer(${s})`);try{const e=t[r]=n.addSourceBuffer(s),i=r;this.addBufferListener(i,"updatestart",this._onSBUpdateStart),this.addBufferListener(i,"updateend",this._onSBUpdateEnd),this.addBufferListener(i,"error",this._onSBUpdateError),this.appendSource&&this.addBufferListener(i,"bufferedchange",(e,t)=>{const n=t.removedRanges;null!=n&&n.length&&this.hls.trigger(g.BUFFER_FLUSHED,{type:r})}),this.tracks[r]={buffer:e,codec:o,container:a.container,levelCodec:a.levelCodec,metadata:a.metadata,id:a.id}}catch(e){this.error(`error while trying to add sourceBuffer: ${e.message}`),this.hls.trigger(g.ERROR,{type:m.MEDIA_ERROR,details:v.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:e,sourceBufferName:r,mimeType:s})}}}get mediaSrc(){var e,t;const n=(null==(e=this.media)?void 0:null==(t=e.querySelector)?void 0:t.call(e,"source"))||this.media;return null==n?void 0:n.src}_onSBUpdateStart(e){const{operationQueue:t}=this,n=t.current(e);n.onStart()}_onSBUpdateEnd(e){var t;if("closed"===(null==(t=this.mediaSource)?void 0:t.readyState))return void this.resetBuffer(e);const{operationQueue:n}=this,i=n.current(e);i.onComplete(),n.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){var n;const i=new Error(`${e} SourceBuffer error. MediaSource readyState: ${null==(n=this.mediaSource)?void 0:n.readyState}`);this.error(`${i}`,t),this.hls.trigger(g.ERROR,{type:m.MEDIA_ERROR,details:v.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:i,fatal:!1});const r=this.operationQueue.current(e);r&&r.onError(i)}removeExecutor(e,t,n){const{media:i,mediaSource:r,operationQueue:a,sourceBuffer:o}=this,s=o[e];if(!i||!r||!s)return this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),void a.shiftAndExecuteNext(e);const l=f(i.duration)?i.duration:1/0,u=f(r.duration)?r.duration:1/0,c=Math.max(0,t),d=Math.min(n,l,u);d>c&&(!s.ending||s.ended)?(s.ended=!1,this.log(`Removing [${c},${d}] from the ${e} SourceBuffer`),s.remove(c,d)):a.shiftAndExecuteNext(e)}appendExecutor(e,t){const n=this.sourceBuffer[t];if(n)n.ended=!1,n.appendBuffer(e);else if(!this.pendingTracks[t])throw new Error(`Attempting to append to the ${t} SourceBuffer, but it does not exist`)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve().then(e);const{operationQueue:n}=this,i=t.map(e=>n.appendBlocker(e));Promise.all(i).then(()=>{e(),t.forEach(e=>{const t=this.sourceBuffer[e];null!=t&&t.updating||n.shiftAndExecuteNext(e)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,n){const i=this.sourceBuffer[e];if(!i)return;const r=n.bind(this,e);this.listeners[e].push({event:t,listener:r}),i.addEventListener(t,r)}removeBufferListeners(e){const t=this.sourceBuffer[e];t&&this.listeners[e].forEach(e=>{t.removeEventListener(e.event,e.listener)})}}function ka(e){const t=e.querySelectorAll("source");[].slice.call(t).forEach(t=>{e.removeChild(t)})}function Ma(e,t){const n=self.document.createElement("source");n.type="video/mp4",n.src=t,e.appendChild(n)}const La={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Pa=e=>String.fromCharCode(La[e]||e),Na=15,Oa=100,Fa={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Ua={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Ba={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Ga={25:2,26:4,29:6,30:8,31:10,27:13,28:15},ja=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class Va{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n="function"===typeof t?t():t;w.log(`${this.time} [${e}] ${n}`)}}}const Ha=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class Ka{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const i=t[n];e.hasOwnProperty(i)&&(this[i]=e[i])}}isDefault(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class za{constructor(){this.uchar=" ",this.penState=new Ka}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return" "===this.uchar&&this.penState.isDefault()}}class Za{constructor(e){this.chars=[],this.pos=0,this.currPenState=new Ka,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<Oa;t++)this.chars.push(new za);this.logger=e}equals(e){for(let t=0;t<Oa;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<Oa;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<Oa;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Oa&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Oa)}moveCursor(e){const t=this.pos+e;if(e>1)for(let n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=Pa(e);this.pos>=Oa?this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))}clearFromPos(e){let t;for(t=e;t<Oa;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<Oa;n++){const i=this.chars[n].uchar;" "!==i&&(t=!1),e.push(i)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e);const t=this.chars[this.pos];t.setPenState(this.currPenState)}}class qa{constructor(e){this.rows=[],this.currRow=Na-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<Na;t++)this.rows.push(new Za(e));this.logger=e}reset(){for(let e=0;e<Na;e++)this.rows[e].clear();this.currRow=Na-1}equals(e){let t=!0;for(let n=0;n<Na;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<Na;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<Na;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){const e=this.rows[this.currRow];e.backSpace()}clearToEndOfRow(){const e=this.rows[this.currRow];e.clearToEndOfRow()}insertChar(e){const t=this.rows[this.currRow];t.insertChar(e)}setPen(e){const t=this.rows[this.currRow];t.setPenStyles(e)}moveCursor(e){const t=this.rows[this.currRow];t.moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e);const t=this.rows[this.currRow];t.setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+JSON.stringify(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let t=0;t<Na;t++)this.rows[t].clear();const e=this.currRow+1-this.nrRollUpRows,n=this.lastOutputScreen;if(n){const i=n.rows[e].cueStartTime,r=this.logger.time;if(null!==i&&null!==r&&i<r)for(let a=0;a<this.nrRollUpRows;a++)this.rows[t-this.nrRollUpRows+a+1].copy(n.rows[e+a])}}this.currRow=t;const n=this.rows[this.currRow];if(null!==e.indent){const t=e.indent,i=Math.max(t-1,0);n.setCursor(e.indent),e.color=n.chars[i].penState.foreground}const i={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(i)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(null===this.nrRollUpRows)return void this.logger.log(3,"roll_up but nrRollUpRows not set yet");this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",i=-1;for(let r=0;r<Na;r++){const n=this.rows[r].getTextString();n&&(i=r+1,e?t.push("Row "+i+": '"+n+"'"):t.push(n.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n}getTextAndFormat(){return this.rows}}class Ya{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new qa(n),this.nonDisplayedMemory=new qa(n),this.lastOutputScreen=new qa(n),this.currRollUpRow=this.displayedMemory.rows[Na-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[Na-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,i=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=i[n]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class Wa{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=Qa(),this.logger=void 0;const i=this.logger=new Va;this.channels=[null,new Ya(e,t,i),new Ya(e+1,n,i)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let n=0;n<t.length;n+=2){const e=127&t[n],i=127&t[n+1];let r=!1,a=null;if(0===e&&0===i)continue;this.logger.log(3,()=>"["+Ha([t[n],t[n+1]])+"] -> ("+Ha([e,i])+")");const o=this.cmdHistory,s=e>=16&&e<=31;if(s){if(Xa(e,i,o)){$a(null,null,o),this.logger.log(3,()=>"Repeated command ("+Ha([e,i])+") is dropped");continue}$a(e,i,this.cmdHistory),r=this.parseCmd(e,i),r||(r=this.parseMidrow(e,i)),r||(r=this.parsePAC(e,i)),r||(r=this.parseBackgroundAttributes(e,i))}else $a(null,null,o);if(!r&&(a=this.parseChars(e,i),a)){const e=this.currentChannel;if(e&&e>0){const t=this.channels[e];t.insertChars(a)}else this.logger.log(2,"No channel found yet. TEXT-MODE?")}r||a||this.logger.log(2,()=>"Couldn't parse cleaned data "+Ha([e,i])+" orig: "+Ha([t[n],t[n+1]]))}}parseCmd(e,t){const n=(20===e||28===e||21===e||29===e)&&t>=32&&t<=47,i=(23===e||31===e)&&t>=33&&t<=35;if(!n&&!i)return!1;const r=20===e||21===e||23===e?1:2,a=this.channels[r];return 20===e||21===e||28===e||29===e?32===t?a.ccRCL():33===t?a.ccBS():34===t?a.ccAOF():35===t?a.ccAON():36===t?a.ccDER():37===t?a.ccRU(2):38===t?a.ccRU(3):39===t?a.ccRU(4):40===t?a.ccFON():41===t?a.ccRDC():42===t?a.ccTR():43===t?a.ccRTD():44===t?a.ccEDM():45===t?a.ccCR():46===t?a.ccENM():47===t&&a.ccEOC():a.ccTO(t-32),this.currentChannel=r,!0}parseMidrow(e,t){let n=0;if((17===e||25===e)&&t>=32&&t<=47){if(n=17===e?1:2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const i=this.channels[n];return!!i&&(i.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+Ha([e,t])+")"),!0)}return!1}parsePAC(e,t){let n;const i=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,r=(16===e||24===e)&&t>=64&&t<=95;if(!i&&!r)return!1;const a=e<=23?1:2;n=t>=64&&t<=95?1===a?Fa[e]:Ba[e]:1===a?Ua[e]:Ga[e];const o=this.channels[a];return!!o&&(o.setPAC(this.interpretPAC(n,t)),this.currentChannel=a,!0)}interpretPAC(e,t){let n;const i={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,i.underline=1===(1&n),n<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(i.italics=!0,i.color="white"):i.indent=4*Math.floor((n-16)/2),i}parseChars(e,t){let n,i=null,r=null;if(e>=25?(n=2,r=e-8):(n=1,r=e),r>=17&&r<=19){let e;e=17===r?t+80:18===r?t+112:t+144,this.logger.log(2,()=>"Special char '"+Pa(e)+"' in channel "+n),i=[e]}else e>=32&&e<=127&&(i=0===t?[e]:[e,t]);return i&&this.logger.log(3,()=>"Char codes =  "+Ha(i).join(",")),i}parseBackgroundAttributes(e,t){const n=(16===e||24===e)&&t>=32&&t<=47,i=(23===e||31===e)&&t>=45&&t<=47;if(!n&&!i)return!1;let r;const a={};16===e||24===e?(r=Math.floor((t-32)/2),a.background=ja[r],t%2===1&&(a.background=a.background+"_semi")):45===t?a.background="transparent":(a.foreground="black",47===t&&(a.underline=!0));const o=e<=23?1:2,s=this.channels[o];return s.setBkgData(a),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}$a(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function $a(e,t,n){n.a=e,n.b=t}function Xa(e,t,n){return n.a===e&&n.b===t}function Qa(){return{a:null,b:null}}class Ja{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var eo=function(){if(null!=H&&H.VTTCue)return self.VTTCue;const e=["","lr","rl"],t=["start","middle","end","left","right"];function n(e,t){if("string"!==typeof t)return!1;if(!Array.isArray(e))return!1;const n=t.toLowerCase();return!!~e.indexOf(n)&&n}function i(t){return n(e,t)}function r(e){return n(t,e)}function a(e,...t){let n=1;for(;n<arguments.length;n++){const t=arguments[n];for(const n in t)e[n]=t[n]}return e}function o(e,t,n){const o=this,s={enumerable:!0};o.hasBeenReset=!1;let l="",u=!1,c=e,d=t,f=n,h=null,p="",g=!0,m="auto",v="start",y=50,_="middle",b=50,E="middle";Object.defineProperty(o,"id",a({},s,{get:function(){return l},set:function(e){l=""+e}})),Object.defineProperty(o,"pauseOnExit",a({},s,{get:function(){return u},set:function(e){u=!!e}})),Object.defineProperty(o,"startTime",a({},s,{get:function(){return c},set:function(e){if("number"!==typeof e)throw new TypeError("Start time must be set to a number.");c=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"endTime",a({},s,{get:function(){return d},set:function(e){if("number"!==typeof e)throw new TypeError("End time must be set to a number.");d=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"text",a({},s,{get:function(){return f},set:function(e){f=""+e,this.hasBeenReset=!0}})),Object.defineProperty(o,"region",a({},s,{get:function(){return h},set:function(e){h=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"vertical",a({},s,{get:function(){return p},set:function(e){const t=i(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");p=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"snapToLines",a({},s,{get:function(){return g},set:function(e){g=!!e,this.hasBeenReset=!0}})),Object.defineProperty(o,"line",a({},s,{get:function(){return m},set:function(e){if("number"!==typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");m=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"lineAlign",a({},s,{get:function(){return v},set:function(e){const t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"position",a({},s,{get:function(){return y},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"positionAlign",a({},s,{get:function(){return _},set:function(e){const t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");_=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"size",a({},s,{get:function(){return b},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");b=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"align",a({},s,{get:function(){return E},set:function(e){const t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");E=t,this.hasBeenReset=!0}})),o.displayState=void 0}return o.prototype.getCueAsHTML=function(){const e=self.WebVTT;return e.convertCueToDOMTree(self,this.text)},o}();class to{decode(e,t){if(!e)return"";if("string"!==typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function no(e){function t(e,t,n,i){return 3600*(0|e)+60*(0|t)+(0|n)+parseFloat(i||0)}const n=e.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return n?parseFloat(n[2])>59?t(n[2],n[3],0,n[4]):t(n[1],n[2],n[3],n[4]):null}class io{constructor(){this.values=Object.create(null)}set(e,t){this.get(e)||""===t||(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let i=0;i<n.length;++i)if(t===n[i]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function ro(e,t,n,i){const r=i?e.split(i):[e];for(const a in r){if("string"!==typeof r[a])continue;const e=r[a].split(n);if(2!==e.length)continue;const i=e[0],o=e[1];t(i,o)}}const ao=new eo(0,0,""),oo="middle"===ao.align?"middle":"center";function so(e,t,n){const i=e;function r(){const t=no(e);if(null===t)throw new Error("Malformed timestamp: "+i);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function a(e,t){const i=new io;ro(e,function(e,t){let r;switch(e){case"region":for(let r=n.length-1;r>=0;r--)if(n[r].id===t){i.set(e,n[r].region);break}break;case"vertical":i.alt(e,t,["rl","lr"]);break;case"line":r=t.split(","),i.integer(e,r[0]),i.percent(e,r[0])&&i.set("snapToLines",!1),i.alt(e,r[0],["auto"]),2===r.length&&i.alt("lineAlign",r[1],["start",oo,"end"]);break;case"position":r=t.split(","),i.percent(e,r[0]),2===r.length&&i.alt("positionAlign",r[1],["start",oo,"end","line-left","line-right","auto"]);break;case"size":i.percent(e,t);break;case"align":i.alt(e,t,["start",oo,"end","left","right"]);break}},/:/,/\s/),t.region=i.get("region",null),t.vertical=i.get("vertical","");let r=i.get("line","auto");"auto"===r&&-1===ao.line&&(r=-1),t.line=r,t.lineAlign=i.get("lineAlign","start"),t.snapToLines=i.get("snapToLines",!0),t.size=i.get("size",100),t.align=i.get("align",oo);let a=i.get("position","auto");"auto"===a&&50===ao.position&&(a="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=a}function o(){e=e.replace(/^\s+/,"")}if(o(),t.startTime=r(),o(),"--\x3e"!==e.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+i);e=e.slice(3),o(),t.endTime=r(),o(),a(e,t)}function lo(e){return e.replace(/<br(?: \/)?>/gi,"\n")}class uo{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new to,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;function n(){let e=t.buffer,n=0;e=lo(e);while(n<e.length&&"\r"!==e[n]&&"\n"!==e[n])++n;const i=e.slice(0,n);return"\r"===e[n]&&++n,"\n"===e[n]&&++n,t.buffer=e.slice(n),i}function i(e){ro(e,function(e,t){},/:/)}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{let e="";if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;e=n();const i=e.match(/^()?WEBVTT([ \t].*)?$/);if(null==i||!i[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let r=!1;while(t.buffer){if(!/\r\n|\n/.test(t.buffer))return this;switch(r?r=!1:e=n(),t.state){case"HEADER":/:/.test(e)?i(e):e||(t.state="ID");continue;case"NOTE":e||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(e)){t.state="NOTE";break}if(!e)continue;if(t.cue=new eo(0,0,""),t.state="CUE",-1===e.indexOf("--\x3e")){t.cue.id=e;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{so(e,t.cue,t.regionList)}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const n=-1!==e.indexOf("--\x3e");if(!e||n&&(r=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(null===t.cue)continue;t.cue.text&&(t.cue.text+="\n"),t.cue.text+=e}continue;case"BADCUE":e||(t.state="ID")}}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state||"BADWEBVTT"===e.state)throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const co=/\r\n|\n\r|\n|\r/g,fo=function(e,t,n=0){return e.slice(n,n+t.length)===t},ho=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),i=parseInt(e.slice(-9,-7)),r=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!f(t)||!f(n)||!f(i)||!f(r))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=6e4*i,t+=36e5*r,t},po=function(e){let t=5381,n=e.length;while(n)t=33*t^e.charCodeAt(--n);return(t>>>0).toString()};function go(e,t,n){return po(e.toString())+po(t.toString())+po(n)}const mo=function(e,t,n){let i=e[t],r=e[i.prevCC];if(!r||!r.new&&i.new)return e.ccOffset=e.presentationOffset=i.start,void(i.new=!1);while(null!=(a=r)&&a.new){var a;e.ccOffset+=i.start-r.start,i.new=!1,i=r,r=e[i.prevCC]}e.presentationOffset=n};function vo(e,t,n,i,r,a,o){const s=new uo,l=ge(new Uint8Array(e)).trim().replace(co,"\n").split("\n"),u=[],c=t?Kr(t.baseTime,t.timescale):0;let d,f="00:00.000",h=0,p=0,g=!0;s.oncue=function(e){const a=n[i];let o=n.ccOffset;const s=(h-c)/9e4;if(null!=a&&a.new&&(void 0!==p?o=n.ccOffset=a.start:mo(n,i,s)),s){if(!t)return void(d=new Error("Missing initPTS for VTT MPEGTS"));o=s-n.presentationOffset}const l=e.endTime-e.startTime,f=Jr(9e4*(e.startTime+o-p),9e4*r)/9e4;e.startTime=Math.max(f,0),e.endTime=Math.max(f+l,0);const g=e.text.trim();e.text=decodeURIComponent(encodeURIComponent(g)),e.id||(e.id=go(e.startTime,e.endTime,g)),e.endTime>0&&u.push(e)},s.onparsingerror=function(e){d=e},s.onflush=function(){d?o(d):a(u)},l.forEach(e=>{if(g){if(fo(e,"X-TIMESTAMP-MAP=")){g=!1,e.slice(16).split(",").forEach(e=>{fo(e,"LOCAL:")?f=e.slice(6):fo(e,"MPEGTS:")&&(h=parseInt(e.slice(7)))});try{p=ho(f)/1e3}catch(e){d=e}return}""===e&&(g=!1)}s.parse(e+"\n")}),s.flush()}const yo="stpp.ttml.im1t",_o=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,bo=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,Eo={left:"start",center:"center",right:"end",start:"start",end:"end"};function To(e,t,n,i){const r=Ce(new Uint8Array(e),["mdat"]);if(0===r.length)return void i(new Error("Could not parse IMSC1 mdat"));const a=r.map(e=>ge(e)),o=Vr(t.baseTime,1,t.timescale);try{a.forEach(e=>n(So(e,o)))}catch(e){i(e)}}function So(e,t){const n=new DOMParser,i=n.parseFromString(e,"text/xml"),r=i.getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");const a={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},o=Object.keys(a).reduce((e,t)=>{return e[t]=r.getAttribute(`ttp:${t}`)||a[t],e},{}),s="preserve"!==r.getAttribute("xml:space"),l=Ao(wo(r,"styling","style")),u=Ao(wo(r,"layout","region")),c=wo(r,"body","[begin]");return[].map.call(c,e=>{const n=Io(e,s);if(!n||!e.hasAttribute("begin"))return null;const i=Do(e.getAttribute("begin"),o),r=Do(e.getAttribute("dur"),o);let a=Do(e.getAttribute("end"),o);if(null===i)throw Co(e);if(null===a){if(null===r)throw Co(e);a=i+r}const c=new eo(i-t,a-t,n);c.id=go(c.startTime,c.endTime,c.text);const f=u[e.getAttribute("region")],h=l[e.getAttribute("style")],p=xo(f,h,l),{textAlign:g}=p;if(g){const e=Eo[g];e&&(c.lineAlign=e),c.align=g}return d(c,p),c}).filter(e=>null!==e)}function wo(e,t,n){const i=e.getElementsByTagName(t)[0];return i?[].slice.call(i.querySelectorAll(n)):[]}function Ao(e){return e.reduce((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e},{})}function Io(e,t){return[].slice.call(e.childNodes).reduce((e,n,i)=>{var r;return"br"===n.nodeName&&i?e+"\n":null!=(r=n.childNodes)&&r.length?Io(n,t):t?e+n.textContent.trim().replace(/\s+/g," "):e+n.textContent},"")}function xo(e,t,n){const i="http://www.w3.org/ns/ttml#styling";let r=null;const a=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],o=null!=e&&e.hasAttribute("style")?e.getAttribute("style"):null;return o&&n.hasOwnProperty(o)&&(r=n[o]),a.reduce((n,a)=>{const o=Ro(t,i,a)||Ro(e,i,a)||Ro(r,i,a);return o&&(n[a]=o),n},{})}function Ro(e,t,n){return e&&e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null}function Co(e){return new Error(`Could not parse ttml timestamp ${e}`)}function Do(e,t){if(!e)return null;let n=no(e);return null===n&&(_o.test(e)?n=ko(e,t):bo.test(e)&&(n=Mo(e,t))),n}function ko(e,t){const n=_o.exec(e),i=(0|n[4])+(0|n[5])/t.subFrameRate;return 3600*(0|n[1])+60*(0|n[2])+(0|n[3])+i/t.frameRate}function Mo(e,t){const n=bo.exec(e),i=Number(n[1]),r=n[2];switch(r){case"h":return 3600*i;case"m":return 60*i;case"ms":return 1e3*i;case"f":return i/t.frameRate;case"t":return i/t.tickRate}return i}class Lo{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Fo(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(g.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(g.MANIFEST_LOADING,this.onManifestLoading,this),e.on(g.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(g.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(g.FRAG_LOADING,this.onFragLoading,this),e.on(g.FRAG_LOADED,this.onFragLoaded,this),e.on(g.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(g.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(g.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(g.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(g.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(g.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(g.MANIFEST_LOADING,this.onManifestLoading,this),e.off(g.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(g.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(g.FRAG_LOADING,this.onFragLoading,this),e.off(g.FRAG_LOADED,this.onFragLoaded,this),e.off(g.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(g.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(g.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(g.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(g.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){if(this.config.enableCEA708Captions&&(!this.cea608Parser1||!this.cea608Parser2)){const e=new Ja(this,"textTrack1"),t=new Ja(this,"textTrack2"),n=new Ja(this,"textTrack3"),i=new Ja(this,"textTrack4");this.cea608Parser1=new Wa(1,e,t),this.cea608Parser2=new Wa(3,n,i)}}addCues(e,t,n,i,r){let a=!1;for(let o=r.length;o--;){const e=r[o],i=Oo(e[0],e[1],t,n);if(i>=0&&(e[0]=Math.min(e[0],t),e[1]=Math.max(e[1],n),a=!0,i/(n-t)>.5))return}if(a||r.push([t,n]),this.config.renderTextTracksNatively){const r=this.captionsTracks[e];this.Cues.newCue(r,t,n,i)}else{const r=this.Cues.newCue(null,t,n,i);this.hls.trigger(g.CUES_PARSED,{type:"captions",cues:r,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:r}){const{unparsedVttFrags:a}=this;"main"===n&&(this.initPTS[t.cc]={baseTime:i,timescale:r}),a.length&&(this.unparsedVttFrags=[],a.forEach(e=>{this.onFragLoaded(g.FRAG_LOADED,e)}))}getExistingTrack(e,t){const{media:n}=this;if(n)for(let i=0;i<n.textTracks.length;i++){const r=n.textTracks[i];if(No(r,{name:e,lang:t,attrs:{}}))return r}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:i}=this,{label:r,languageCode:a}=t[e],o=this.getExistingTrack(r,a);if(o)n[e]=o,Kt(n[e]),Vt(n[e],i);else{const t=this.createTextTrack("captions",r,a);t&&(t[e]=!0,n[e]=t)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n=t.label,i={_id:e,label:n,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=i,this.hls.trigger(g.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[i]})}createTextTrack(e,t,n){const i=this.media;if(i)return i.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach(t=>{Kt(e[t]),delete e[t]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Fo(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let n=0;n<t.length;n++)Kt(t[n])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],i=n.some(e=>e.textCodec===yo);if(this.config.enableWebVTT||i&&this.config.enableIMSC1){const e=ya(this.tracks,n);if(e)return void(this.tracks=n);if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const e=this.media,t=e?Yt(e.textTracks):null;if(this.tracks.forEach((e,n)=>{let i;if(t){let n=null;for(let i=0;i<t.length;i++)if(t[i]&&No(t[i],e)){n=t[i],t[i]=null;break}n&&(i=n)}if(i)Kt(i);else{const t=Po(e);i=this.createTextTrack(t,e.name,e.lang),i&&(i.mode="disabled")}i&&this.textTracks.push(i)}),null!=t&&t.length){const e=t.filter(e=>null!==e).map(e=>e.label);e.length&&w.warn(`Media element contains unused subtitle tracks: ${e.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const e=this.tracks.map(e=>{return{label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e}});this.hls.trigger(g.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:e})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(e=>{const t=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(!t)return;const n=`textTrack${t[1]}`,i=this.captionsProperties[n];i&&(i.label=e.name,e.lang&&(i.languageCode=e.lang),i.media=e)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return null==t?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===Ut.MAIN){var n,i;const{cea608Parser1:e,cea608Parser2:r,lastSn:a}=this,{cc:o,sn:s}=t.frag,l=null!=(n=null==(i=t.part)?void 0:i.index)?n:-1;e&&r&&(s!==a+1||s===a&&l!==this.lastPartIndex+1||o!==this.lastCc)&&(e.reset(),r.reset()),this.lastCc=o,this.lastSn=s,this.lastPartIndex=l}}onFragLoaded(e,t){const{frag:n,payload:i}=t;if(n.type===Ut.SUBTITLE)if(i.byteLength){const e=n.decryptdata,r="stats"in t;if(null==e||!e.encrypted||r){const e=this.tracks[n.level],r=this.vttCCs;r[n.cc]||(r[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),e&&e.textCodec===yo?this._parseIMSC1(n,i):this._parseVTTs(t)}}else this.hls.trigger(g.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;To(t,this.initPTS[e.cc],t=>{this._appendCues(t,e.level),n.trigger(g.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},t=>{w.log(`Failed to parse IMSC1: ${t}`),n.trigger(g.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:t})})}_parseVTTs(e){var t;const{frag:n,payload:i}=e,{initPTS:r,unparsedVttFrags:a}=this,o=r.length-1;if(!r[n.cc]&&-1===o)return void a.push(e);const s=this.hls,l=null!=(t=n.initSegment)&&t.data?He(n.initSegment.data,new Uint8Array(i)):i;vo(l,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,e=>{this._appendCues(e,n.level),s.trigger(g.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},t=>{const r="Missing initPTS for VTT MPEGTS"===t.message;r?a.push(e):this._fallbackToIMSC1(n,i),w.log(`Failed to parse VTT cue: ${t}`),r&&o>n.cc||s.trigger(g.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:t})})}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||To(t,this.initPTS[e.cc],()=>{n.textCodec=yo,this._parseIMSC1(e,t)},()=>{n.textCodec="wvtt"})}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const n=this.textTracks[t];if(!n||"disabled"===n.mode)return;e.forEach(e=>Ht(n,e))}else{const i=this.tracks[t];if(!i)return;const r=i.default?"default":"subtitles"+t;n.trigger(g.CUES_PARSED,{type:"subtitles",cues:e,track:r})}}onFragDecrypted(e,t){const{frag:n}=t;n.type===Ut.SUBTITLE&&this.onFragLoaded(g.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){this.initCea608Parsers();const{cea608Parser1:n,cea608Parser2:i}=this;if(!this.enabled||!n||!i)return;const{frag:r,samples:a}=t;if(r.type!==Ut.MAIN||"NONE"!==this.closedCaptionsForLevel(r))for(let o=0;o<a.length;o++){const e=a[o].bytes;if(e){const t=this.extractCea608Data(e);n.addData(a[o].pts,t[0]),i.addData(a[o].pts,t[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:i,type:r}){const{media:a}=this;if(a&&!(a.currentTime<n)){if(!r||"video"===r){const{captionsTracks:e}=this;Object.keys(e).forEach(i=>zt(e[i],t,n))}if(this.config.renderTextTracksNatively&&0===t&&void 0!==i){const{textTracks:e}=this;Object.keys(e).forEach(n=>zt(e[n],t,i))}}}extractCea608Data(e){const t=[[],[]],n=31&e[0];let i=2;for(let r=0;r<n;r++){const n=e[i++],r=127&e[i++],a=127&e[i++];if(0===r&&0===a)continue;const o=0!==(4&n);if(o){const e=3&n;0!==e&&1!==e||(t[e].push(r),t[e].push(a))}}return t}}function Po(e){return e.characteristics&&/transcribes-spoken-dialog/gi.test(e.characteristics)&&/describes-music-and-sound/gi.test(e.characteristics)?"captions":"subtitles"}function No(e,t){return!!e&&e.kind===Po(t)&&ba(t,e)}function Oo(e,t,n,i){return Math.min(t,i)-Math.max(e,n)}function Fo(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class Uo{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(g.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(g.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(g.MANIFEST_PARSED,this.onManifestParsed,this),e.on(g.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(g.BUFFER_CODECS,this.onBufferCodecs,this),e.on(g.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(g.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(g.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(g.MANIFEST_PARSED,this.onManifestParsed,this),e.off(g.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(g.BUFFER_CODECS,this.onBufferCodecs,this),e.off(g.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&f(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){const n=this.hls;n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0)return void(this.clientRect=null);const e=this.hls.levels;if(e.length){const t=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&w.log(`Setting autoLevelCapping to ${n}: ${e[n].height}p@${e[n].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=n,t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter((t,n)=>this.isLevelAllowed(t)&&n<=e);return this.clientRect=null,Uo.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,t.width||t.height||(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch(e){}return e}isLevelAllowed(e){const t=this.restrictedLevels;return!t.some(t=>{return e.bitrate===t.bitrate&&e.width===t.width&&e.height===t.height})}static getMaxLevelByMediaSize(e,t,n){if(null==e||!e.length)return-1;const i=(e,t)=>{return!t||(e.width!==t.width||e.height!==t.height)};let r=e.length-1;const a=Math.max(t,n);for(let o=0;o<e.length;o+=1){const t=e[o];if((t.width>=a||t.height>=a)&&i(t,e[o+1])){r=o;break}}return r}}class Bo{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(g.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(g.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const e=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=e,e&&"function"===typeof e.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,n){const i=performance.now();if(t){if(this.lastTime){const e=i-this.lastTime,r=n-this.lastDroppedFrames,a=t-this.lastDecodedFrames,o=1e3*r/e,s=this.hls;if(s.trigger(g.FPS_DROP,{currentDropped:r,currentDecoded:a,totalDroppedFrames:n}),o>0&&r>s.config.fpsDroppedMonitoringThreshold*a){let e=s.currentLevel;w.warn("drop FPS ratio greater than max allowed value for currentLevel: "+e),e>0&&(-1===s.autoLevelCapping||s.autoLevelCapping>=e)&&(e-=1,s.trigger(g.FPS_DROP_LEVEL_CAPPING,{level:e,droppedLevel:s.currentLevel}),s.autoLevelCapping=e,this.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}const Go="[eme]";class jo{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=jo.CDMCleanupPromise?[jo.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=w.debug.bind(w,Go),this.log=w.log.bind(w,Go),this.warn=w.warn.bind(w,Go),this.error=w.error.bind(w,Go),this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(g.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(g.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(g.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(g.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(g.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(g.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(g.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(g.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,i=t[e];if(i)return i.licenseUrl;if(e===K.WIDEVINE&&n)return n;throw new Error(`no license server URL configured for key-system "${e}"`)}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=t[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,n=(e,t,n)=>!!e&&n.indexOf(e)===t,i=t.map(e=>e.audioCodec).filter(n),r=t.map(e=>e.videoCodec).filter(n);return i.length+r.length===0&&r.push("avc1.42e01e"),new Promise((t,n)=>{const a=e=>{const o=e.shift();this.getMediaKeysPromise(o,i,r).then(e=>t({keySystem:o,mediaKeys:e})).catch(t=>{e.length?a(e):n(t instanceof Vo?t:new Vo({type:m.KEY_SYSTEM_ERROR,details:v.KEY_SYSTEM_NO_ACCESS,error:t,fatal:!0},t.message))})};a(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if("function"!==typeof n){let e=`Configured requestMediaKeySystemAccess is not a function ${n}`;return null===X&&"http:"===self.location.protocol&&(e=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(e))}return n(e,t)}getMediaKeysPromise(e,t,n){const i=Q(e,t,n,this.config.drmSystemOptions),r=this.keySystemAccessPromises[e];let a=null==r?void 0:r.keySystemAccess;if(!a){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(i)}`),a=this.requestMediaKeySystemAccess(e,i);const t=this.keySystemAccessPromises[e]={keySystemAccess:a};return a.catch(t=>{this.log(`Failed to obtain access to key-system "${e}": ${t}`)}),a.then(n=>{this.log(`Access for key-system "${n.keySystem}" obtained`);const i=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),t.mediaKeys=n.createMediaKeys().then(t=>{return this.log(`Media-keys created for "${e}"`),i.then(n=>{return n?this.setMediaKeysServerCertificate(t,e,n):t})}),t.mediaKeys.catch(t=>{this.error(`Failed to create media-keys for "${e}"}: ${t}`)}),t.mediaKeys})}return a.then(()=>r.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${ye.hexDump(e.keyId||[])}`);const i=n.createSession(),r={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:i,keyStatus:"status-pending"};return this.mediaKeySessions.push(r),r}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),i=this.getKeyIdString(t),r="cenc";this.keyIdToKeySessionPromise[i]=this.generateRequestWithPreferredKeySession(n,r,t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(null===e.keyId)throw new Error("keyId is null");return ye.hexDump(e.keyId)}updateKeySession(e,t){var n;const i=e.mediaKeysSession;return this.log(`Updating key-session "${i.sessionId}" for keyID ${ye.hexDump((null==(n=e.decryptdata)?void 0:n.keyId)||[])}\n      } (data length: ${t?t.byteLength:t})`),i.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise((t,n)=>{const i=$(this.config),r=e.map(Z).filter(e=>!!e&&-1!==i.indexOf(e));return this.getKeySystemSelectionPromise(r).then(({keySystem:e})=>{const i=W(e);i?t(i):n(new Error(`Unable to find format for key-system "${e}"`))}).catch(n)})}loadKey(e){const t=e.keyInfo.decryptdata,n=this.getKeyIdString(t),i=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${i}`);let r=this.keyIdToKeySessionPromise[n];return r||(r=this.keyIdToKeySessionPromise[n]=this.getKeySystemForKeyPromise(t).then(({keySystem:n,mediaKeys:r})=>{return this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${i}`),this.attemptSetMediaKeys(n,r).then(()=>{this.throwIfDestroyed();const e=this.createMediaKeySessionContext({keySystem:n,mediaKeys:r,decryptdata:t}),i="cenc";return this.generateRequestWithPreferredKeySession(e,i,t.pssh,"playlist-key")})}),r.catch(e=>this.handleError(e))),r}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof Vo?this.hls.trigger(g.ERROR,e.data):this.hls.trigger(g.ERROR,{type:m.KEY_SYSTEM_ERROR,details:v.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),n=this.keyIdToKeySessionPromise[t];if(!n){const t=Z(e.keyFormat),n=t?[t]:$(this.config);return this.attemptKeySystemAccess(n)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=$(this.config)),0===e.length)throw new Vo({type:m.KEY_SYSTEM_ERROR,details:v.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}_onMediaEncrypted(e){const{initDataType:t,initData:n}=e;if(this.debug(`"${e.type}" event: init data type: "${t}"`),null===n)return;let i,r;if("sinf"===t&&this.config.drmSystems[K.FAIRPLAY]){const e=Te(new Uint8Array(n));try{const t=U(JSON.parse(e).sinf),n=Fe(new Uint8Array(t));if(!n)return;i=n.subarray(8,24),r=K.FAIRPLAY}catch(e){return void this.warn('Failed to parse sinf "encrypted" event message initData')}}else{const e=Qe(n);if(null===e)return;0===e.version&&e.systemId===q.WIDEVINE&&e.data&&(i=e.data.subarray(8,24)),r=Y(e.systemId)}if(!r||!i)return;const a=ye.hexDump(i),{keyIdToKeySessionPromise:o,mediaKeySessions:s}=this;let l=o[a];for(let u=0;u<s.length;u++){const e=s[u],r=e.decryptdata;if(r.pssh||!r.keyId)continue;const c=ye.hexDump(r.keyId);if(a===c||-1!==r.uri.replace(/-/g,"").indexOf(a)){l=o[c],delete o[c],r.pssh=new Uint8Array(n),r.keyId=i,l=o[a]=l.then(()=>{return this.generateRequestWithPreferredKeySession(e,t,n,"encrypted-event-key-match")});break}}l||(l=o[a]=this.getKeySystemSelectionPromise([r]).then(({keySystem:e,mediaKeys:r})=>{var o;this.throwIfDestroyed();const s=new et("ISO-23001-7",a,null!=(o=W(e))?o:"");return s.pssh=new Uint8Array(n),s.keyId=i,this.attemptSetMediaKeys(e,r).then(()=>{this.throwIfDestroyed();const i=this.createMediaKeySessionContext({decryptdata:s,keySystem:e,mediaKeys:r});return this.generateRequestWithPreferredKeySession(i,t,n,"encrypted-event-no-match")})})),l.catch(e=>this.handleError(e))}_onWaitingForKey(e){this.log(`"${e.type}" event`)}attemptSetMediaKeys(e,t){const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const i=Promise.all(n).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.setMediaKeysQueue.push(i),i.then(()=>{this.log(`Media-keys set for "${e}"`),n.push(i),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(e=>-1===n.indexOf(e))})}generateRequestWithPreferredKeySession(e,t,n,i){var r,a;const o=null==(r=this.config.drmSystems)?void 0:null==(a=r[e.keySystem])?void 0:a.generateRequest;if(o)try{const i=o.call(this.hls,t,n,e);if(!i)throw new Error("Invalid response from configured generateRequest filter");t=i.initDataType,n=e.decryptdata.pssh=i.initData?new Uint8Array(i.initData):null}catch(e){var s;if(this.warn(e.message),null!=(s=this.hls)&&s.config.debug)throw e}if(null===n)return this.log(`Skipping key-session request for "${i}" (no initData)`),Promise.resolve(e);const l=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${i}": ${l} (init data type: ${t} length: ${n?n.byteLength:null})`);const u=new ma,c=e._onmessage=(t=>{const n=e.mediaKeysSession;if(!n)return void u.emit("error",new Error("invalid state"));const{messageType:i,message:r}=t;this.log(`"${i}" message event for session "${n.sessionId}" message size: ${r.byteLength}`),"license-request"===i||"license-renewal"===i?this.renewLicense(e,r).catch(e=>{this.handleError(e),u.emit("error",e)}):"license-release"===i?e.keySystem===K.FAIRPLAY&&(this.updateKeySession(e,V("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${i}"`)}),d=e._onkeystatuseschange=(t=>{const n=e.mediaKeysSession;if(!n)return void u.emit("error",new Error("invalid state"));this.onKeyStatusChange(e);const i=e.keyStatus;u.emit("keyStatus",i),"expired"===i&&(this.warn(`${e.keySystem} expired for key ${l}`),this.renewKeySession(e))});e.mediaKeysSession.addEventListener("message",c),e.mediaKeysSession.addEventListener("keystatuseschange",d);const f=new Promise((e,t)=>{u.on("error",t),u.on("keyStatus",n=>{n.startsWith("usable")?e():"output-restricted"===n?t(new Vo({type:m.KEY_SYSTEM_ERROR,details:v.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):"internal-error"===n?t(new Vo({type:m.KEY_SYSTEM_ERROR,details:v.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${n}"`)):"expired"===n?t(new Error("key expired while generating request")):this.warn(`unhandled key status change "${n}"`)})});return e.mediaKeysSession.generateRequest(t,n).then(()=>{var t;this.log(`Request generated for key-session "${null==(t=e.mediaKeysSession)?void 0:t.sessionId}" keyId: ${l}`)}).catch(e=>{throw new Vo({type:m.KEY_SYSTEM_ERROR,details:v.KEY_SYSTEM_NO_SESSION,error:e,fatal:!1},`Error generating key-session request: ${e}`)}).then(()=>f).catch(t=>{throw u.removeAllListeners(),this.removeSession(e),t}).then(()=>{return u.removeAllListeners(),e})}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,n)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${ye.hexDump("buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n))} session keyId: ${ye.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,n=t.loader,i=new n(t),r=this.getServerCertificateUrl(e);return r?(this.log(`Fetching server certificate for "${e}"`),new Promise((n,a)=>{const o={responseType:"arraybuffer",url:r},l=t.certLoadPolicy.default,u={loadPolicy:l,timeout:l.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},c={onSuccess:(e,t,i,r)=>{n(e.data)},onError:(t,n,i,l)=>{a(new Vo({type:m.KEY_SYSTEM_ERROR,details:v.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:i,response:s({url:o.url,data:void 0},t)},`"${e}" certificate request failed (${r}). Status: ${t.code} (${t.text})`))},onTimeout:(t,n,i)=>{a(new Vo({type:m.KEY_SYSTEM_ERROR,details:v.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:i,response:{url:o.url,data:void 0}},`"${e}" certificate request timed out (${r})`))},onAbort:(e,t,n)=>{a(new Error("aborted"))}};i.load(o,u,c)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise((i,r)=>{e.setServerCertificate(n).then(r=>{this.log(`setServerCertificate ${r?"success":"not supported by CDM"} (${null==n?void 0:n.byteLength}) on "${t}"`),i(e)}).catch(e=>{r(new Vo({type:m.KEY_SYSTEM_ERROR,details:v.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:e,fatal:!0},e.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(t=>{return this.updateKeySession(e,new Uint8Array(t)).catch(e=>{throw new Vo({type:m.KEY_SYSTEM_ERROR,details:v.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:e,fatal:!0},e.message)})})}unpackPlayReadyKeyMessage(e,t){const n=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!n.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const i=(new DOMParser).parseFromString(n,"application/xml"),r=i.querySelectorAll("HttpHeader");if(r.length>0){let t;for(let n=0,i=r.length;n<i;n++){var a,o;t=r[n];const i=null==(a=t.querySelector("name"))?void 0:a.textContent,s=null==(o=t.querySelector("value"))?void 0:o.textContent;i&&s&&e.setRequestHeader(i,s)}}const s=i.querySelector("Challenge"),l=null==s?void 0:s.textContent;if(!l)throw new Error("Cannot find <Challenge> in key message");return V(atob(l))}setupLicenseXHR(e,t,n,i){const r=this.config.licenseXhrSetup;return r?Promise.resolve().then(()=>{if(!n.decryptdata)throw new Error("Key removed");return r.call(this.hls,e,t,n,i)}).catch(a=>{if(!n.decryptdata)throw a;return e.open("POST",t,!0),r.call(this.hls,e,t,n,i)}).then(n=>{e.readyState||e.open("POST",t,!0);const r=n||i;return{xhr:e,licenseChallenge:r}}):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:i}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise((i,r)=>{const a=this.getLicenseServerUrl(e.keySystem);this.log(`Sending license request to URL: ${a}`);const o=new XMLHttpRequest;o.responseType="arraybuffer",o.onreadystatechange=(()=>{if(!this.hls||!e.mediaKeysSession)return r(new Error("invalid state"));if(4===o.readyState)if(200===o.status){this._requestLicenseFailureCount=0;let t=o.response;this.log(`License received ${t instanceof ArrayBuffer?t.byteLength:t}`);const n=this.config.licenseResponseCallback;if(n)try{t=n.call(this.hls,o,a,e)}catch(e){this.error(e)}i(t)}else{const s=n.errorRetry,l=s?s.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>l||o.status>=400&&o.status<500)r(new Vo({type:m.KEY_SYSTEM_ERROR,details:v.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:o,response:{url:a,data:void 0,code:o.status,text:o.statusText}},`License Request XHR failed (${a}). Status: ${o.status} (${o.statusText})`));else{const n=l-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${n} attempts left`),this.requestLicense(e,t).then(i,r)}}}),e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=o,this.setupLicenseXHR(o,a,e,t).then(({xhr:t,licenseChallenge:n})=>{e.keySystem==K.PLAYREADY&&(n=this.unpackPlayReadyKeyMessage(t,n)),t.send(n)})})}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,n.addEventListener("encrypted",this.onMediaEncrypted),n.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media,t=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},et.clearKeyUriToKeyIdMap();const n=t.length;jo.CDMCleanupPromise=Promise.all(t.map(e=>this.removeSession(e)).concat(null==e?void 0:e.setMediaKeys(null).catch(e=>{this.log(`Could not clear media keys: ${e}`)}))).then(()=>{n&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)}).catch(e=>{this.log(`Could not close sessions and clear media keys: ${e}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(t&&this.config.emeEnabled&&!this.keyFormatPromise){const e=t.reduce((e,t)=>{return-1===e.indexOf(t.keyFormat)&&e.push(t.keyFormat),e},[]);this.log(`Selecting key-system from session-keys ${e.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(e)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const i=this.mediaKeySessions.indexOf(e);return i>-1&&this.mediaKeySessions.splice(i,1),t.remove().catch(e=>{this.log(`Could not remove session: ${e}`)}).then(()=>{return t.close()}).catch(e=>{this.log(`Could not close session: ${e}`)})}}}jo.CDMCleanupPromise=void 0;class Vo extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}var Ho,Ko,zo;(function(e){e["MANIFEST"]="m",e["AUDIO"]="a",e["VIDEO"]="v",e["MUXED"]="av",e["INIT"]="i",e["CAPTION"]="c",e["TIMED_TEXT"]="tt",e["KEY"]="k",e["OTHER"]="o"})(Ho||(Ho={})),function(e){e["DASH"]="d",e["HLS"]="h",e["SMOOTH"]="s",e["OTHER"]="o"}(Ko||(Ko={})),function(e){e["OBJECT"]="CMCD-Object",e["REQUEST"]="CMCD-Request",e["SESSION"]="CMCD-Session",e["STATUS"]="CMCD-Status"}(zo||(zo={}));const Zo={[zo.OBJECT]:["br","d","ot","tb"],[zo.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[zo.SESSION]:["cid","pr","sf","sid","st","v"],[zo.STATUS]:["bs","rtp"]};class qo{constructor(e,t){this.value=void 0,this.params=void 0,Array.isArray(e)&&(e=e.map(e=>e instanceof qo?e:new qo(e))),this.value=e,this.params=t}}class Yo{constructor(e){this.description=void 0,this.description=e}}const Wo="Dict";function $o(e){return Array.isArray(e)?JSON.stringify(e):e instanceof Map?"Map{}":e instanceof Set?"Set{}":"object"===typeof e?JSON.stringify(e):String(e)}function Xo(e,t,n,i){return new Error(`failed to ${e} "${$o(t)}" as ${n}`,{cause:i})}const Qo="Bare Item",Jo="Boolean",es="Byte Sequence",ts="Decimal",ns="Integer";function is(e){return e<-999999999999999||999999999999999<e}const rs=/[\x00-\x1f\x7f]+/,as="Token",os="Key";function ss(e,t,n){return Xo("serialize",e,t,n)}function ls(e){if("boolean"!==typeof e)throw ss(e,Jo);return e?"?1":"?0"}function us(e){return btoa(String.fromCharCode(...e))}function cs(e){if(!1===ArrayBuffer.isView(e))throw ss(e,es);return`:${us(e)}:`}function ds(e){if(is(e))throw ss(e,ns);return e.toString()}function fs(e){return`@${ds(e.getTime()/1e3)}`}function hs(e,t){if(e<0)return-hs(-e,t);const n=Math.pow(10,t),i=Math.abs(e*n%1-.5)<Number.EPSILON;if(i){const t=Math.floor(e*n);return(t%2===0?t:t+1)/n}return Math.round(e*n)/n}function ps(e){const t=hs(e,3);if(Math.floor(Math.abs(t)).toString().length>12)throw ss(e,ts);const n=t.toString();return n.includes(".")?n:`${n}.0`}const gs="String";function ms(e){if(rs.test(e))throw ss(e,gs);return`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function vs(e){return e.description||e.toString().slice(7,-1)}function ys(e){const t=vs(e);if(!1===/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(t))throw ss(t,as);return t}function _s(e){switch(typeof e){case"number":if(!f(e))throw ss(e,Qo);return Number.isInteger(e)?ds(e):ps(e);case"string":return ms(e);case"symbol":return ys(e);case"boolean":return ls(e);case"object":if(e instanceof Date)return fs(e);if(e instanceof Uint8Array)return cs(e);if(e instanceof Yo)return ys(e);default:throw ss(e,Qo)}}function bs(e){if(!1===/^[a-z*][a-z0-9\-_.*]*$/.test(e))throw ss(e,os);return e}function Es(e){return null==e?"":Object.entries(e).map(([e,t])=>{return!0===t?`;${bs(e)}`:`;${bs(e)}=${_s(t)}`}).join("")}function Ts(e){return e instanceof qo?`${_s(e.value)}${Es(e.params)}`:_s(e)}function Ss(e){return`(${e.value.map(Ts).join(" ")})${Es(e.params)}`}function ws(e,t={whitespace:!0}){if("object"!==typeof e)throw ss(e,Wo);const n=e instanceof Map?e.entries():Object.entries(e),i=null!=t&&t.whitespace?" ":"";return Array.from(n).map(([e,t])=>{t instanceof qo===!1&&(t=new qo(t));let n=bs(e);return!0===t.value?n+=Es(t.params):(n+="=",Array.isArray(t.value)?n+=Ss(t):n+=Ts(t)),n}).join(`,${i}`)}function As(e,t){return ws(e,t)}const Is=e=>"ot"===e||"sf"===e||"st"===e,xs=e=>{return"number"===typeof e?f(e):null!=e&&""!==e&&!1!==e};function Rs(e,t){const n=new URL(e),i=new URL(t);if(n.origin!==i.origin)return e;const r=n.pathname.split("/").slice(1),a=i.pathname.split("/").slice(1,-1);while(r[0]===a[0])r.shift(),a.shift();while(a.length)a.shift(),r.unshift("..");return r.join("/")}function Cs(){try{return crypto.randomUUID()}catch(e){try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch(e){let t=(new Date).getTime();const n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)});return n}}}const Ds=e=>Math.round(e),ks=(e,t)=>{return null!=t&&t.baseUrl&&(e=Rs(e,t.baseUrl)),encodeURIComponent(e)},Ms=e=>100*Ds(e/100),Ls={br:Ds,d:Ds,bl:Ms,dl:Ms,mtp:Ms,nor:ks,rtp:Ms,tb:Ds};function Ps(e,t){const n={};if(null==e||"object"!==typeof e)return n;const i=Object.keys(e).sort(),r=d({},Ls,null==t?void 0:t.formatters),a=null==t?void 0:t.filter;return i.forEach(i=>{if(null!=a&&a(i))return;let o=e[i];const s=r[i];s&&(o=s(o,t)),"v"===i&&1===o||"pr"==i&&1===o||xs(o)&&(Is(i)&&"string"===typeof o&&(o=new Yo(o)),n[i]=o)}),n}function Ns(e,t={}){return e?As(Ps(e,t),d({whitespace:!1},t)):""}function Os(e,t={}){if(!e)return{};const n=Object.entries(e),i=Object.entries(Zo).concat(Object.entries((null==t?void 0:t.customHeaderMap)||{})),r=n.reduce((e,t)=>{var n;const[r,a]=t,o=(null==(n=i.find(e=>e[1].includes(r)))?void 0:n[0])||zo.REQUEST;return null!=e[o]||(e[o]={}),e[o][r]=a,e},{});return Object.entries(r).reduce((e,[n,i])=>{return e[n]=Ns(i,t),e},{})}function Fs(e,t,n){return d(e,Os(t,n))}const Us="CMCD";function Bs(e,t={}){if(!e)return"";const n=Ns(e,t);return`${Us}=${encodeURIComponent(n)}`}const Gs=/CMCD=[^&#]+/;function js(e,t,n){const i=Bs(t,n);if(!i)return e;if(Gs.test(e))return e.replace(Gs,i);const r=e.includes("?")?"&":"?";return`${e}${r}${i}`}class Vs{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=(()=>{this.initialized&&(this.starved=!0),this.buffering=!0}),this.onPlaying=(()=>{this.initialized||(this.initialized=!0),this.buffering=!1}),this.applyPlaylistData=(e=>{try{this.apply(e,{ot:Ho.MANIFEST,su:!this.initialized})}catch(e){w.warn("Could not generate manifest CMCD data.",e)}}),this.applyFragmentData=(e=>{try{const t=e.frag,n=this.hls.levels[t.level],i=this.getObjectType(t),r={d:1e3*t.duration,ot:i};i!==Ho.VIDEO&&i!==Ho.AUDIO&&i!=Ho.MUXED||(r.br=n.bitrate/1e3,r.tb=this.getTopBandwidth(i)/1e3,r.bl=this.getBufferLength(i)),this.apply(e,r)}catch(e){w.warn("Could not generate segment CMCD data.",e)}}),this.hls=e;const t=this.config=e.config,{cmcd:n}=t;null!=n&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||Cs(),this.cid=n.contentId,this.useHeaders=!0===n.useHeaders,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(g.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(g.MEDIA_DETACHED,this.onMediaDetached,this),e.on(g.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(g.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(g.MEDIA_DETACHED,this.onMediaDetached,this),e.off(g.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,i;this.audioBuffer=null==(n=t.tracks.audio)?void 0:n.buffer,this.videoBuffer=null==(i=t.tracks.video)?void 0:i.buffer}createData(){var e;return{v:1,sf:Ko.HLS,sid:this.sid,cid:this.cid,pr:null==(e=this.media)?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){d(t,this.createData());const n=t.ot===Ho.INIT||t.ot===Ho.VIDEO||t.ot===Ho.MUXED;this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),null==t.su&&(t.su=this.buffering);const{includeKeys:i}=this;i&&(t=Object.keys(t).reduce((e,n)=>{return i.includes(n)&&(e[n]=t[n]),e},{})),this.useHeaders?(e.headers||(e.headers={}),Fs(e.headers,t)):e.url=js(e.url,t)}getObjectType(e){const{type:t}=e;return"subtitle"===t?Ho.TIMED_TEXT:"initSegment"===e.sn?Ho.INIT:"audio"===t?Ho.AUDIO:"main"===t?this.hls.audioTracks.length?Ho.VIDEO:Ho.MUXED:void 0}getTopBandwidth(e){let t,n=0;const i=this.hls;if(e===Ho.AUDIO)t=i.audioTracks;else{const e=i.maxAutoLevel,n=e>-1?e+1:i.levels.length;t=i.levels.slice(0,n)}for(const r of t)r.bitrate>n&&(n=r.bitrate);return n>0?n:NaN}getBufferLength(e){const t=this.hls.media,n=e===Ho.AUDIO?this.audioBuffer:this.videoBuffer;if(!n||!t)return NaN;const i=mi.bufferInfo(n,t.currentTime,this.config.maxBufferHole);return 1e3*i.len}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new n(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,n,i){t(e),this.loader.load(e,n,i)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new n(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,n,i){t(e),this.loader.load(e,n,i)}}}}const Hs=3e5;class Ks{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=w.log.bind(w,"[content-steering]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(g.MANIFEST_LOADING,this.onManifestLoading,this),e.on(g.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(g.MANIFEST_PARSED,this.onManifestParsed,this),e.on(g.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(g.MANIFEST_LOADING,this.onManifestLoading,this),e.off(g.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(g.MANIFEST_PARSED,this.onManifestParsed,this),e.off(g.ERROR,this.onError,this))}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=1e3*this.timeToLoad-(performance.now()-this.updated);if(e>0)return void this.scheduleRefresh(this.uri,e)}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){-1!==this.reloadTimer&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(t=>t!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;null!==n&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if((null==n?void 0:n.action)===Gn.SendAlternateToPenaltyBox&&n.flags===jn.MoveAllAlternatesMatchingHost){const e=this.levels;let i=this.pathwayPriority,r=this.pathwayId;if(t.context){const{groupId:n,pathwayId:i,type:a}=t.context;n&&e?r=this.getPathwayForGroupId(n,a,r):i&&(r=i)}r in this.penalizedPathways||(this.penalizedPathways[r]=performance.now()),!i&&e&&(i=e.reduce((e,t)=>{return-1===e.indexOf(t.pathwayId)&&e.push(t.pathwayId),e},[])),i&&i.length>1&&(this.updatePathwayPriority(i),n.resolved=this.pathwayId!==r),n.resolved||w.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${r} levels: ${e?e.length:e} priorities: ${JSON.stringify(i)} penalized: ${JSON.stringify(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(0===t.length){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length?(this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t):e}getLevelsForPathway(e){return null===this.levels?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){let t;this.pathwayPriority=e;const n=this.penalizedPathways,i=performance.now();Object.keys(n).forEach(e=>{i-n[e]>Hs&&delete n[e]});for(let r=0;r<e.length;r++){const i=e[r];if(i in n)continue;if(i===this.pathwayId)return;const a=this.hls.nextLoadLevel,o=this.hls.levels[a];if(t=this.getLevelsForPathway(i),t.length>0){this.log(`Setting Pathway to "${i}"`),this.pathwayId=i,In(t),this.hls.trigger(g.LEVELS_UPDATED,{levels:t});const e=this.hls.levels[a];o&&e&&this.levels&&(e.attrs["STABLE-VARIANT-ID"]!==o.attrs["STABLE-VARIANT-ID"]&&e.bitrate!==o.bitrate&&this.log(`Unstable Pathways change from bitrate ${o.bitrate} to ${e.bitrate}`),this.hls.nextLoadLevel=a);break}}}getPathwayForGroupId(e,t,n){const i=this.getLevelsForPathway(n).concat(this.levels||[]);for(let r=0;r<i.length;r++)if(t===Ft.AUDIO_TRACK&&i[r].hasAudioGroup(e)||t===Ft.SUBTITLE_TRACK&&i[r].hasSubtitleGroup(e))return i[r].pathwayId;return n}clonePathways(e){const t=this.levels;if(!t)return;const n={},i={};e.forEach(e=>{const{ID:r,"BASE-ID":a,"URI-REPLACEMENT":o}=e;if(t.some(e=>e.pathwayId===r))return;const s=this.getLevelsForPathway(a).map(e=>{const t=new x(e.attrs);t["PATHWAY-ID"]=r;const a=t.AUDIO&&`${t.AUDIO}_clone_${r}`,s=t.SUBTITLES&&`${t.SUBTITLES}_clone_${r}`;a&&(n[t.AUDIO]=a,t.AUDIO=a),s&&(i[t.SUBTITLES]=s,t.SUBTITLES=s);const l=Zs(e.uri,t["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",o),u=new fn({attrs:t,audioCodec:e.audioCodec,bitrate:e.bitrate,height:e.height,name:e.name,url:l,videoCodec:e.videoCodec,width:e.width});if(e.audioGroups)for(let n=1;n<e.audioGroups.length;n++)u.addGroupId("audio",`${e.audioGroups[n]}_clone_${r}`);if(e.subtitleGroups)for(let n=1;n<e.subtitleGroups.length;n++)u.addGroupId("text",`${e.subtitleGroups[n]}_clone_${r}`);return u});t.push(...s),zs(this.audioTracks,n,o,r),zs(this.subtitleTracks,i,o,r)})}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;let i;this.loader&&this.loader.destroy(),this.loader=new n(t);try{i=new self.URL(e)}catch(t){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest URI: ${e}`)}if("data:"!==i.protocol){const e=0|(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate);i.searchParams.set("_HLS_pathway",this.pathwayId),i.searchParams.set("_HLS_throughput",""+e)}const r={responseType:"json",url:i.href},a=t.steeringManifestLoadPolicy.default,o=a.errorRetry||a.timeoutRetry||{},s={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},l={onSuccess:(e,t,n,r)=>{this.log(`Loaded steering manifest: "${i}"`);const a=e.data;if(1!==a.VERSION)return void this.log(`Steering VERSION ${a.VERSION} not supported!`);this.updated=performance.now(),this.timeToLoad=a.TTL;const{"RELOAD-URI":o,"PATHWAY-CLONES":s,"PATHWAY-PRIORITY":l}=a;if(o)try{this.uri=new self.URL(o,i).href}catch(e){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest RELOAD-URI: ${o}`)}this.scheduleRefresh(this.uri||n.url),s&&this.clonePathways(s);const u={steeringManifest:a,url:i.toString()};this.hls.trigger(g.STEERING_MANIFEST_LOADED,u),l&&this.updatePathwayPriority(l)},onError:(e,t,n,i)=>{if(this.log(`Error loading steering manifest: ${e.code} ${e.text} (${t.url})`),this.stopLoad(),410===e.code)return this.enabled=!1,void this.log(`Steering manifest ${t.url} no longer available`);let r=1e3*this.timeToLoad;if(429!==e.code)this.scheduleRefresh(this.uri||t.url,r);else{const e=this.loader;if("function"===typeof(null==e?void 0:e.getResponseHeader)){const t=e.getResponseHeader("Retry-After");t&&(r=1e3*parseFloat(t))}this.log(`Steering manifest ${t.url} rate limited`)}},onTimeout:(e,t,n)=>{this.log(`Timeout loading steering manifest (${t.url})`),this.scheduleRefresh(this.uri||t.url)}};this.log(`Requesting steering manifest: ${i}`),this.loader.load(r,s,l)}scheduleRefresh(e,t=1e3*this.timeToLoad){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var t;const n=null==(t=this.hls)?void 0:t.media;!n||n.ended?this.scheduleRefresh(e,1e3*this.timeToLoad):this.loadSteeringManifest(e)},t)}}function zs(e,t,n,i){e&&Object.keys(t).forEach(r=>{const a=e.filter(e=>e.groupId===r).map(e=>{const a=d({},e);return a.details=void 0,a.attrs=new x(a.attrs),a.url=a.attrs.URI=Zs(e.url,e.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",n),a.groupId=a.attrs["GROUP-ID"]=t[r],a.attrs["PATHWAY-ID"]=i,a});e.push(...a)})}function Zs(e,t,n,i){const{HOST:r,PARAMS:a,[n]:o}=i;let s;t&&(s=null==o?void 0:o[t],s&&(e=s));const l=new self.URL(e);return r&&!s&&(l.host=r),a&&Object.keys(a).sort().forEach(e=>{e&&l.searchParams.set(e,a[e])}),l.href}const qs=/^age:\s*[\d.]+\s*$/im;class Ys{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new k,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const n=this.loader=new self.XMLHttpRequest,i=this.stats;i.loading.first=0,i.loaded=0,i.aborted=!1;const r=this.xhrSetup;r?Promise.resolve().then(()=>{if(this.loader===n&&!this.stats.aborted)return r(n,t.url)}).catch(e=>{if(this.loader===n&&!this.stats.aborted)return n.open("GET",t.url,!0),r(n,t.url)}).then(()=>{this.loader!==n||this.stats.aborted||this.openAndSendXhr(n,t,e)}).catch(e=>{this.callbacks.onError({code:n.status,text:e.message},t,n,i)}):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const i=t.headers,{maxTimeToFirstByteMs:r,maxLoadTimeMs:a}=n.loadPolicy;if(i)for(const o in i)e.setRequestHeader(o,i[o]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=r&&f(r)?r:a,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const i=t.readyState,r=this.config;if(!n.aborted&&i>=2&&(0===n.loading.first&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),r.timeout!==r.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),r.timeout=r.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),4===i)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const i=t.status,a="text"!==t.responseType;if(i>=200&&i<300&&(a&&t.response||null!==t.responseText)){n.loading.end=Math.max(self.performance.now(),n.loading.first);const r=a?t.response:t.responseText,o="arraybuffer"===t.responseType?r.byteLength:r.length;if(n.loaded=n.total=o,n.bwEstimate=8e3*n.total/(n.loading.end-n.loading.first),!this.callbacks)return;const s=this.callbacks.onProgress;if(s&&s(n,e,r,t),!this.callbacks)return;const l={url:t.responseURL,data:r,code:i};this.callbacks.onSuccess(l,n,e,t)}else{const a=r.loadPolicy.errorRetry,o=n.retry,s={url:e.url,data:void 0,code:i};kn(a,o,!1,s)?this.retry(a):(w.error(`${i} while loading ${e.url}`),this.callbacks.onError({code:i,text:t.statusText},e,t,n))}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(kn(e,t,!0))this.retry(e);else{var n;w.warn(`timeout while loading ${null==(n=this.context)?void 0:n.url}`);const e=this.callbacks;e&&(this.abortInternal(),e.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=Cn(e,n.retry),n.retry++,w.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${null==t?void 0:t.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&qs.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}function Ws(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1}const $s=/(\d+)-(\d+)\/(\d+)/;class Xs{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||tl,this.controller=new self.AbortController,this.stats=new k}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const i=this.stats;if(i.loading.start)throw new Error("Loader can only be used once.");i.loading.start=self.performance.now();const r=Qs(e,this.controller.signal),a=n.onProgress,o="arraybuffer"===e.responseType,s=o?"byteLength":"length",{maxTimeToFirstByteMs:l,maxLoadTimeMs:u}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,r),self.clearTimeout(this.requestTimeout),t.timeout=l&&f(l)?l:u,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(i,e,this.response)},t.timeout),self.fetch(this.request).then(r=>{this.response=this.loader=r;const s=Math.max(self.performance.now(),i.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=u,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(i,e,this.response)},u-(s-i.loading.start)),!r.ok){const{status:e,statusText:t}=r;throw new nl(t||"fetch, bad network response",e,r)}return i.loading.first=s,i.total=el(r.headers)||i.total,a&&f(t.highWaterMark)?this.loadProgressively(r,i,e,t.highWaterMark,a):o?r.arrayBuffer():"json"===e.responseType?r.json():r.text()}).then(r=>{const o=this.response;if(!o)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),i.loading.end=Math.max(self.performance.now(),i.loading.first);const l=r[s];l&&(i.loaded=i.total=l);const u={url:o.url,data:r,code:o.status};a&&!f(t.highWaterMark)&&a(i,e,r,o),n.onSuccess(u,i,e,o)}).catch(t=>{if(self.clearTimeout(this.requestTimeout),i.aborted)return;const r=t&&t.code||0,a=t?t.message:null;n.onError({code:r,text:a},e,t?t.details:null,i)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,i=0,r){const a=new ji,o=e.body.getReader(),s=()=>{return o.read().then(o=>{if(o.done)return a.dataLength&&r(t,n,a.flush(),e),Promise.resolve(new ArrayBuffer(0));const l=o.value,u=l.length;return t.loaded+=u,u<i||a.dataLength?(a.push(l),a.dataLength>=i&&r(t,n,a.flush(),e)):r(t,n,l,e),s()}).catch(()=>{return Promise.reject()})};return s()}}function Qs(e,t){const n={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(d({},e.headers))};return e.rangeEnd&&n.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1)),n}function Js(e){const t=$s.exec(e);if(t)return parseInt(t[2])-parseInt(t[1])+1}function el(e){const t=e.get("Content-Range");if(t){const e=Js(t);if(f(e))return e}const n=e.get("Content-Length");if(n)return parseInt(n)}function tl(e,t){return new self.Request(e.url,t)}class nl extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const il=/\s/,rl={newCue(e,t,n,i){const r=[];let a,o,s,l,u;const c=self.VTTCue||self.TextTrackCue;for(let f=0;f<i.rows.length;f++)if(a=i.rows[f],s=!0,l=0,u="",!a.isEmpty()){var d;for(let e=0;e<a.chars.length;e++)il.test(a.chars[e].uchar)&&s?l++:(u+=a.chars[e].uchar,s=!1);a.cueStartTime=t,t===n&&(n+=1e-4),l>=16?l--:l++;const i=lo(u.trim()),h=go(t,n,i);null!=e&&null!=(d=e.cues)&&d.getCueById(h)||(o=new c(t,n,i),o.id=h,o.line=f+1,o.align="left",o.position=10+Math.min(80,10*Math.floor(8*l/32)),r.push(o))}return e&&r.length&&(r.sort((e,t)=>{return"auto"===e.line||"auto"===t.line?0:e.line>8&&t.line>8?t.line-e.line:e.line-t.line}),r.forEach(t=>Ht(e,t))),r}},al={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},ol=s(s({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Ys,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:ui,bufferController:Da,capLevelController:Uo,errorController:Vn,fpsController:Bo,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:X,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,useMediaCapabilities:!0,certLoadPolicy:{default:al},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},sl()),{},{subtitleStreamController:Aa,subtitleTrackController:xa,timelineController:Lo,audioStreamController:Ta,audioTrackController:Sa,emeController:jo,cmcdController:Vs,contentSteeringController:Ks});function sl(){return{cueHandler:rl,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function ll(e,t){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const n=ul(e),i=["manifest","level","frag"],r=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return i.forEach(e=>{const i=`${"level"===e?"playlist":e}LoadPolicy`,a=void 0===t[i],o=[];r.forEach(r=>{const s=`${e}Loading${r}`,l=t[s];if(void 0!==l&&a){o.push(s);const e=n[i].default;switch(t[i]={default:e},r){case"TimeOut":e.maxLoadTimeMs=l,e.maxTimeToFirstByteMs=l;break;case"MaxRetry":e.errorRetry.maxNumRetry=l,e.timeoutRetry.maxNumRetry=l;break;case"RetryDelay":e.errorRetry.retryDelayMs=l,e.timeoutRetry.retryDelayMs=l;break;case"MaxRetryTimeout":e.errorRetry.maxRetryDelayMs=l,e.timeoutRetry.maxRetryDelayMs=l;break}}}),o.length&&w.warn(`hls.js config: "${o.join('", "')}" setting(s) are deprecated, use "${i}": ${JSON.stringify(t[i])}`)}),s(s({},n),t)}function ul(e){return e&&"object"===typeof e?Array.isArray(e)?e.map(ul):Object.keys(e).reduce((t,n)=>{return t[n]=ul(e[n]),t},{}):e}function cl(e){const t=e.loader;if(t!==Xs&&t!==Ys)w.log("[config]: Custom loader detected, cannot enable progressive streaming"),e.progressive=!1;else{const t=Ws();t&&(e.loader=Xs,e.progressive=!0,e.enableSoftwareAES=!0,w.log("[config]: Progressive streaming enabled, using FetchLoader"))}}let dl;class fl extends Hn{constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(g.MANIFEST_LOADING,this.onManifestLoading,this),e.on(g.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(g.LEVEL_LOADED,this.onLevelLoaded,this),e.on(g.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(g.FRAG_BUFFERED,this.onFragBuffered,this),e.on(g.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(g.MANIFEST_LOADING,this.onManifestLoading,this),e.off(g.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(g.LEVEL_LOADED,this.onLevelLoaded,this),e.off(g.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(g.FRAG_BUFFERED,this.onFragBuffered,this),e.off(g.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){const e=this._levels;e.forEach(e=>{e.loadError=0,e.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=this.hls.config.preferManagedMediaSource,i=[],r={},a={};let o=!1,s=!1,l=!1;t.levels.forEach(e=>{var t,u;const c=e.attrs;let{audioCodec:d,videoCodec:f}=e;-1!==(null==(t=d)?void 0:t.indexOf("mp4a.40.34"))&&(dl||(dl=/chrome|firefox/i.test(navigator.userAgent)),dl&&(e.audioCodec=d=void 0)),d&&(e.audioCodec=d=bt(d,n)),0===(null==(u=f)?void 0:u.indexOf("avc1"))&&(f=e.videoCodec=Tt(f));const{width:h,height:p,unknownCodecs:g}=e;if(o||(o=!(!h||!p)),s||(s=!!f),l||(l=!!d),null!=g&&g.length||d&&!ft(d,"audio",n)||f&&!ft(f,"video",n))return;const{CODECS:m,"FRAME-RATE":v,"HDCP-LEVEL":y,"PATHWAY-ID":_,RESOLUTION:b,"VIDEO-RANGE":E}=c,T=`${_||"."}-`,S=`${T}${e.bitrate}-${b}-${v}-${m}-${E}-${y}`;if(r[S])if(r[S].uri===e.url||e.attrs["PATHWAY-ID"])r[S].addGroupId("audio",c.AUDIO),r[S].addGroupId("text",c.SUBTITLES);else{const t=a[S]+=1;e.attrs["PATHWAY-ID"]=new Array(t+1).join(".");const n=new fn(e);r[S]=n,i.push(n)}else{const t=new fn(e);r[S]=t,a[S]=1,i.push(t)}}),this.filterAndSortMediaOptions(i,t,o,s,l)}filterAndSortMediaOptions(e,t,n,i,r){let a=[],o=[],s=e;if((n||i)&&r&&(s=s.filter(({videoCodec:e,videoRange:t,width:n,height:i})=>(!!e||!(!n||!i))&&ln(t))),0===s.length)return void Promise.resolve().then(()=>{if(this.hls){t.levels.length&&this.warn(`One or more CODECS in variant not supported: ${JSON.stringify(t.levels[0].attrs)}`);const e=new Error("no level with compatible codecs found in manifest");this.hls.trigger(g.ERROR,{type:m.MEDIA_ERROR,details:v.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:e,reason:e.message})}});if(t.audioTracks){const{preferManagedMediaSource:e}=this.hls.config;a=t.audioTracks.filter(t=>!t.audioCodec||ft(t.audioCodec,"audio",e)),hl(a)}t.subtitles&&(o=t.subtitles,hl(o));const l=s.slice(0);s.sort((e,t)=>{if(e.attrs["HDCP-LEVEL"]!==t.attrs["HDCP-LEVEL"])return(e.attrs["HDCP-LEVEL"]||"")>(t.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&e.height!==t.height)return e.height-t.height;if(e.frameRate!==t.frameRate)return e.frameRate-t.frameRate;if(e.videoRange!==t.videoRange)return sn.indexOf(e.videoRange)-sn.indexOf(t.videoRange);if(e.videoCodec!==t.videoCodec){const n=gt(e.videoCodec),i=gt(t.videoCodec);if(n!==i)return i-n}if(e.uri===t.uri&&e.codecSet!==t.codecSet){const n=mt(e.codecSet),i=mt(t.codecSet);if(n!==i)return i-n}return e.averageBitrate!==t.averageBitrate?e.averageBitrate-t.averageBitrate:0});let u=l[0];if(this.steering&&(s=this.steering.filterParsedLevels(s),s.length!==l.length))for(let h=0;h<l.length;h++)if(l[h].pathwayId===s[0].pathwayId){u=l[h];break}this._levels=s;for(let h=0;h<s.length;h++)if(s[h]===u){var c;this._firstLevel=h;const e=u.bitrate,t=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${s.length} level(s) found, first bitrate: ${e}`),void 0===(null==(c=this.hls.userConfig)?void 0:c.abrEwmaDefaultEstimate)){const n=Math.min(e,this.hls.config.abrEwmaDefaultEstimateMax);n>t&&t===ol.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=n)}break}const d=r&&!i,f={levels:s,audioTracks:a,subtitleTracks:o,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:r,video:i,altAudio:!d&&a.some(e=>!!e.url)};this.hls.trigger(g.MANIFEST_PARSED,f),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return 0===this._levels.length?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(0===t.length)return;if(e<0||e>=t.length){const n=new Error("invalid level idx"),i=e<0;if(this.hls.trigger(g.ERROR,{type:m.OTHER_ERROR,details:v.LEVEL_SWITCH_ERROR,level:e,fatal:i,error:n,reason:n.message}),i)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,i=this.currentLevel,r=i?i.attrs["PATHWAY-ID"]:void 0,a=t[e],o=a.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=a,n===e&&a.details&&i&&r===o)return;this.log(`Switching to level ${e} (${a.height?a.height+"p ":""}${a.videoRange?a.videoRange+" ":""}${a.codecSet?a.codecSet+" ":""}@${a.bitrate})${o?" with Pathway "+o:""} from level ${n}${r?" with Pathway "+r:""}`);const s={level:e,attrs:a.attrs,details:a.details,bitrate:a.bitrate,averageBitrate:a.averageBitrate,maxBitrate:a.maxBitrate,realBitrate:a.realBitrate,width:a.width,height:a.height,codecSet:a.codecSet,audioCodec:a.audioCodec,videoCodec:a.videoCodec,audioGroups:a.audioGroups,subtitleGroups:a.subtitleGroups,loaded:a.loaded,loadError:a.loadError,fragmentError:a.fragmentError,name:a.name,id:a.id,uri:a.uri,url:a.url,urlId:0,audioGroupIds:a.audioGroupIds,textGroupIds:a.textGroupIds};this.hls.trigger(g.LEVEL_SWITCHING,s);const l=a.details;if(!l||l.live){const e=this.switchParams(a.uri,null==i?void 0:i.details,l);this.loadPlaylist(e)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(void 0===this._startLevel){const e=this.hls.config.startLevel;return void 0!==e?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){!t.fatal&&t.context&&t.context.type===Ft.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(void 0!==t&&t.type===Ut.MAIN){const e=t.elementaryStreams;if(!Object.keys(e).some(t=>!!e[t]))return;const n=this._levels[t.level];null!=n&&n.loadError&&(this.log(`Resetting level error count of ${n.loadError} on frag buffered`),n.loadError=0)}}onLevelLoaded(e,t){var n;const{level:i,details:r}=t,a=this._levels[i];var o;if(!a)return this.warn(`Invalid level index ${i}`),void(null!=(o=t.deliveryDirectives)&&o.skip&&(r.deltaUpdateFailed=!0));i===this.currentLevelIndex?(0===a.fragmentError&&(a.loadError=0),this.playlistLoaded(i,t,a.details)):null!=(n=t.deliveryDirectives)&&n.skip&&(r.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist();const t=this.currentLevelIndex,n=this.currentLevel;if(n&&this.shouldLoadPlaylist(n)){let i=n.uri;if(e)try{i=e.addDirectives(i)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}const r=n.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${void 0!==(null==e?void 0:e.msn)?" at sn "+e.msn+" part "+e.part:""} with${r?" Pathway "+r:""} ${i}`),this.clearTimer(),this.hls.trigger(g.LEVEL_LOADING,{url:i,level:t,pathwayId:n.attrs["PATHWAY-ID"],id:0,deliveryDirectives:e||null})}}get nextLoadLevel(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;const n=this._levels.filter((t,n)=>{return n!==e||(this.steering&&this.steering.removeLevel(t),t===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,t.details&&t.details.fragments.forEach(e=>e.level=-1)),!1)});In(n),this._levels=n,this.currentLevelIndex>-1&&null!=(t=this.currentLevel)&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.hls.trigger(g.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(g.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}}function hl(e){const t={};e.forEach(e=>{const n=e.groupId||"";e.id=t[n]=t[n]||0,t[n]++})}class pl{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const n in this.keyUriToKeyInfo){const i=this.keyUriToKeyInfo[n].loader;if(i){var t;if(e&&e!==(null==(t=i.context)?void 0:t.frag.type))return;i.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=v.KEY_LOAD_ERROR,n,i,r){return new ki({type:m.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:r,error:n,networkDetails:i})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:n,cc:i}=e;for(let e=0;e<t.length;e++){const r=t[e];if(i<=r.cc&&("initSegment"===n||"initSegment"===r.sn||n<r.sn)){this.emeController.selectKeySystemFormat(r).then(e=>{r.setKeyFormat(e)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then(t=>{return this.loadInternal(e,t)}):this.loadInternal(e)}loadInternal(e,t){var n,i;t&&e.setKeyFormat(t);const r=e.decryptdata;if(!r){const n=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,v.KEY_LOAD_ERROR,n))}const a=r.uri;if(!a)return Promise.reject(this.createKeyLoadError(e,v.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${a}"`)));let o=this.keyUriToKeyInfo[a];if(null!=(n=o)&&n.decryptdata.key)return r.key=o.decryptdata.key,Promise.resolve({frag:e,keyInfo:o});var s;if(null!=(i=o)&&i.keyLoadPromise)switch(null==(s=o.mediaKeySessionContext)?void 0:s.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return o.keyLoadPromise.then(t=>{return r.key=t.keyInfo.decryptdata.key,{frag:e,keyInfo:o}})}switch(o=this.keyUriToKeyInfo[a]={decryptdata:r,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},r.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===r.keyFormat?this.loadKeyHTTP(o,e):this.loadKeyEME(o,e);case"AES-128":return this.loadKeyHTTP(o,e);default:return Promise.reject(this.createKeyLoadError(e,v.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${r.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const t=this.emeController.loadKey(n);if(t)return(e.keyLoadPromise=t.then(t=>{return e.mediaKeySessionContext=t,n})).catch(t=>{throw e.keyLoadPromise=null,t})}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,i=n.loader,r=new i(n);return t.keyLoader=e.loader=r,e.keyLoadPromise=new Promise((i,a)=>{const o={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},l=n.keyLoadPolicy.default,u={loadPolicy:l,timeout:l.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},c={onSuccess:(e,t,n,r)=>{const{frag:o,keyInfo:s,url:l}=n;if(!o.decryptdata||s!==this.keyUriToKeyInfo[l])return a(this.createKeyLoadError(o,v.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),r));s.decryptdata.key=o.decryptdata.key=new Uint8Array(e.data),o.keyLoader=null,s.loader=null,i({frag:o,keyInfo:s})},onError:(e,n,i,r)=>{this.resetLoader(n),a(this.createKeyLoadError(t,v.KEY_LOAD_ERROR,new Error(`HTTP Error ${e.code} loading key ${e.text}`),i,s({url:o.url,data:void 0},e)))},onTimeout:(e,n,i)=>{this.resetLoader(n),a(this.createKeyLoadError(t,v.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),i))},onAbort:(e,n,i)=>{this.resetLoader(n),a(this.createKeyLoadError(t,v.INTERNAL_ABORTED,new Error("key loading aborted"),i))}};r.load(o,u,c)})}resetLoader(e){const{frag:t,keyInfo:n,url:i}=e,r=n.loader;t.keyLoader===r&&(t.keyLoader=null,n.loader=null),delete this.keyUriToKeyInfo[i],r&&r.destroy()}}function gl(){return self.SourceBuffer||self.WebKitSourceBuffer}function ml(){const e=lt();if(!e)return!1;const t=gl();return!t||t.prototype&&"function"===typeof t.prototype.appendBuffer&&"function"===typeof t.prototype.remove}function vl(){if(!ml())return!1;const e=lt();return"function"===typeof(null==e?void 0:e.isTypeSupported)&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(t=>e.isTypeSupported(pt(t,"video")))||["mp4a.40.2","fLaC"].some(t=>e.isTypeSupported(pt(t,"audio"))))}function yl(){var e;const t=gl();return"function"===typeof(null==t?void 0:null==(e=t.prototype)?void 0:e.changeType)}const _l=250,bl=2,El=.1,Tl=.05;class Sl{constructor(e,t,n,i){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=n,this.hls=i}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){const{config:n,media:i,stalled:r}=this;if(null===i)return;const{currentTime:a,seeking:o}=i,s=this.seeking&&!o,l=!this.seeking&&o;if(this.seeking=o,a!==e){if(this.moved=!0,o||(this.nudgeRetry=0),null!==r){if(this.stallReported){const e=self.performance.now()-r;w.warn(`playback not stuck anymore @${a}, after ${Math.round(e)}ms`),this.stallReported=!1}this.stalled=null}return}if(l||s)return void(this.stalled=null);if(i.paused&&!o||i.ended||0===i.playbackRate||!mi.getBuffered(i).length)return void(this.nudgeRetry=0);const u=mi.bufferInfo(i,a,0),c=u.nextStart||0;if(o){const e=u.len>bl,n=!c||t&&t.start<=a||c-a>bl&&!this.fragmentTracker.getPartialFragment(a);if(e||n)return;this.moved=!1}if(!this.moved&&null!==this.stalled){var d;const e=u.len>0;if(!e&&!c)return;const t=Math.max(c,u.start||0)-a,n=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,r=null==n?void 0:null==(d=n.details)?void 0:d.live,o=r?2*n.details.targetduration:bl,s=this.fragmentTracker.getPartialFragment(a);if(t>0&&(t<=o||s))return void(i.paused||this._trySkipBufferHole(s))}const f=self.performance.now();if(null===r)return void(this.stalled=f);const h=f-r;if(!o&&h>=_l&&(this._reportStall(u),!this.media))return;const p=mi.bufferInfo(i,a,n.maxBufferHole);this._tryFixBufferStall(p,h)}_tryFixBufferStall(e,t){const{config:n,fragmentTracker:i,media:r}=this;if(null===r)return;const a=r.currentTime,o=i.getPartialFragment(a);if(o){const e=this._trySkipBufferHole(o);if(e||!this.media)return}(e.len>n.maxBufferHole||e.nextStart&&e.nextStart-a<n.maxBufferHole)&&t>1e3*n.highBufferWatchdogPeriod&&(w.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:t,media:n,stallReported:i}=this;if(!i&&n){this.stallReported=!0;const i=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${JSON.stringify(e)})`);w.warn(i.message),t.trigger(g.ERROR,{type:m.MEDIA_ERROR,details:v.BUFFER_STALLED_ERROR,fatal:!1,error:i,buffer:e.len})}}_trySkipBufferHole(e){const{config:t,hls:n,media:i}=this;if(null===i)return 0;const r=i.currentTime,a=mi.bufferInfo(i,r,0),o=r<a.start?a.start:a.nextStart;if(o){const s=a.len<=t.maxBufferHole,l=a.len>0&&a.len<1&&i.readyState<3,u=o-r;if(u>0&&(s||l)){if(u>t.maxBufferHole){const{fragmentTracker:t}=this;let n=!1;if(0===r){const e=t.getAppendedFrag(0,Ut.MAIN);e&&o<e.end&&(n=!0)}if(!n){const n=e||t.getAppendedFrag(r,Ut.MAIN);if(n){let e=!1,i=n.end;while(i<o){const n=t.getPartialFragment(i);if(!n){e=!0;break}i+=n.duration}if(e)return 0}}}const a=Math.max(o+Tl,r+El);if(w.warn(`skipping hole, adjusting currentTime from ${r} to ${a}`),this.moved=!0,this.stalled=null,i.currentTime=a,e&&!e.gap){const t=new Error(`fragment loaded with buffer holes, seeking from ${r} to ${a}`);n.trigger(g.ERROR,{type:m.MEDIA_ERROR,details:v.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:t,reason:t.message,frag:e})}return a}}return 0}_tryNudgeBuffer(){const{config:e,hls:t,media:n,nudgeRetry:i}=this;if(null===n)return;const r=n.currentTime;if(this.nudgeRetry++,i<e.nudgeMaxRetry){const a=r+(i+1)*e.nudgeOffset,o=new Error(`Nudging 'currentTime' from ${r} to ${a}`);w.warn(o.message),n.currentTime=a,t.trigger(g.ERROR,{type:m.MEDIA_ERROR,details:v.BUFFER_NUDGE_ON_STALL,error:o,fatal:!1})}else{const n=new Error(`Playhead still not moving while enough data buffered @${r} after ${e.nudgeMaxRetry} nudges`);w.error(n.message),t.trigger(g.ERROR,{type:m.MEDIA_ERROR,details:v.BUFFER_STALLED_ERROR,error:n,fatal:!0})}}}const wl=100;class Al extends Gi{constructor(e,t,n){super(e,t,n,"[stream-controller]",Ut.MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(g.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(g.MANIFEST_LOADING,this.onManifestLoading,this),e.on(g.MANIFEST_PARSED,this.onManifestParsed,this),e.on(g.LEVEL_LOADING,this.onLevelLoading,this),e.on(g.LEVEL_LOADED,this.onLevelLoaded,this),e.on(g.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(g.ERROR,this.onError,this),e.on(g.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(g.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(g.BUFFER_CREATED,this.onBufferCreated,this),e.on(g.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(g.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(g.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(g.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(g.MANIFEST_LOADING,this.onManifestLoading,this),e.off(g.MANIFEST_PARSED,this.onManifestParsed,this),e.off(g.LEVEL_LOADED,this.onLevelLoaded,this),e.off(g.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(g.ERROR,this.onError,this),e.off(g.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(g.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(g.BUFFER_CREATED,this.onBufferCreated,this),e.off(g.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(g.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(g.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying()}startLoad(e){if(this.levels){const{lastCurrentTime:t,hls:n}=this;if(this.stopLoad(),this.setInterval(wl),this.level=-1,!this.startFragRequested){let e=n.startLevel;-1===e&&(n.config.testBandwidth&&this.levels.length>1?(e=0,this.bitrateTest=!0):e=n.firstAutoLevel),n.nextLoadLevel=e,this.level=n.loadLevel,this.loadedmetadata=!1}t>0&&-1===e&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=Bi.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=Bi.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case Bi.WAITING_LEVEL:{const{levels:e,level:t}=this,n=null==e?void 0:e[t],i=null==n?void 0:n.details;if(i&&(!i.live||this.levelLastLoaded===n)){if(this.waitForCdnTuneIn(i))break;this.state=Bi.IDLE;break}if(this.hls.nextLoadLevel!==this.level){this.state=Bi.IDLE;break}break}case Bi.FRAG_LOADING_WAITING_RETRY:{var e;const t=self.performance.now(),n=this.retryDate;if(!n||t>=n||null!=(e=this.media)&&e.seeking){const{levels:e,level:t}=this,n=null==e?void 0:e[t];this.resetStartWhenNotLoaded(n||null),this.state=Bi.IDLE}}break}this.state===Bi.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:i}=this;if(null===t||!i&&(this.startFragRequested||!e.config.startFragPrefetch))return;if(this.altAudio&&this.audioOnly)return;const r=e.nextLoadLevel;if(null==n||!n[r])return;const a=n[r],o=this.getMainFwdBufferInfo();if(null===o)return;const s=this.getLevelDetails();if(s&&this._streamEnded(o,s)){const e={};return this.altAudio&&(e.type="video"),this.hls.trigger(g.BUFFER_EOS,e),void(this.state=Bi.ENDED)}e.loadLevel!==r&&-1===e.manualLevel&&this.log(`Adapting to level ${r} from level ${this.level}`),this.level=e.nextLoadLevel=r;const l=a.details;if(!l||this.state===Bi.WAITING_LEVEL||l.live&&this.levelLastLoaded!==a)return this.level=r,void(this.state=Bi.WAITING_LEVEL);const u=o.len,c=this.getMaxBufferLength(a.maxBitrate);if(u>=c)return;this.backtrackFragment&&this.backtrackFragment.start>o.end&&(this.backtrackFragment=null);const d=this.backtrackFragment?this.backtrackFragment.start:o.end;let f=this.getNextFragment(d,l);if(this.couldBacktrack&&!this.fragPrevious&&f&&"initSegment"!==f.sn&&this.fragmentTracker.getState(f)!==di.OK){var h;const e=(null!=(h=this.backtrackFragment)?h:f).sn,t=e-l.startSN,n=l.fragments[t-1];n&&f.cc===n.cc&&(f=n,this.fragmentTracker.removeFragment(n))}else this.backtrackFragment&&o.len&&(this.backtrackFragment=null);if(f&&this.isLoopLoading(f,d)){const e=f.gap;if(!e){const e=this.audioOnly&&!this.altAudio?M.AUDIO:M.VIDEO,t=(e===M.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;t&&this.afterBufferFlushed(t,e,Ut.MAIN)}f=this.getNextFragmentLoopLoading(f,l,o,Ut.MAIN,c)}f&&(!f.initSegment||f.initSegment.data||this.bitrateTest||(f=f.initSegment),this.loadFragment(f,a,d))}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);this.fragCurrent=e,i===di.NOT_LOADED||i===di.PARTIAL?"initSegment"===e.sn?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,n)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,Ut.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(null!=t&&t.readyState){let n;const i=this.getAppendedFrag(t.currentTime);i&&i.start>1&&this.flushMainBuffer(0,i.start-1);const r=this.getLevelDetails();if(null!=r&&r.live){const e=this.getMainFwdBufferInfo();if(!e||e.len<2*r.targetduration)return}if(!t.paused&&e){const t=this.hls.nextLoadLevel,i=e[t],r=this.fragLastKbps;n=r&&this.fragCurrent?this.fragCurrent.duration*i.maxBitrate/(1e3*r)+1:0}else n=0;const a=this.getBufferedFrag(t.currentTime+n);if(a){const e=this.followingBufferedFrag(a);if(e){this.abortCurrentFrag();const t=e.maxStartPTS?e.maxStartPTS:e.start,n=e.duration,i=Math.max(a.end,t+Math.min(Math.max(n-this.config.maxFragLookUpTolerance,n*(this.couldBacktrack?.5:.125)),n*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(i,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case Bi.KEY_LOADING:case Bi.FRAG_LOADING:case Bi.FRAG_LOADING_WAITING_RETRY:case Bi.PARSING:case Bi.PARSED:this.state=Bi.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),n.addEventListener("playing",this.onvplaying),n.addEventListener("seeked",this.onvseeked),this.gapController=new Sl(this.config,n,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,t=e?e.currentTime:null;f(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);const n=this.getMainFwdBufferInfo();null!==n&&0!==n.len?this.tick():this.warn(`Main forward buffer length on "seeked" event ${n?n.len:"empty"})`)}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(g.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=this.fragLastKbps=0,this.levels=this.fragPlaying=this.backtrackFragment=this.levelLastLoaded=null,this.altAudio=this.audioOnly=this.startFragRequested=!1}onManifestParsed(e,t){let n=!1,i=!1;t.levels.forEach(e=>{const t=e.audioCodec;t&&(n=n||-1!==t.indexOf("mp4a.40.2"),i=i||-1!==t.indexOf("mp4a.40.5"))}),this.audioCodecSwitch=n&&i&&!yl(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==Bi.IDLE)return;const i=n[t.level];(!i.details||i.details.live&&this.levelLastLoaded!==i||this.waitForCdnTuneIn(i.details))&&(this.state=Bi.WAITING_LEVEL)}onLevelLoaded(e,t){var n;const{levels:i}=this,r=t.level,a=t.details,o=a.totalduration;if(!i)return void this.warn(`Levels were reset while loading level ${r}`);this.log(`Level ${r} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""}, cc [${a.startCC}, ${a.endCC}] duration:${o}`);const s=i[r],l=this.fragCurrent;!l||this.state!==Bi.FRAG_LOADING&&this.state!==Bi.FRAG_LOADING_WAITING_RETRY||l.level!==t.level&&l.loader&&this.abortCurrentFrag();let u=0;if(a.live||null!=(n=s.details)&&n.live){var c;if(this.checkLiveUpdate(a),a.deltaUpdateFailed)return;u=this.alignPlaylists(a,s.details,null==(c=this.levelLastLoaded)?void 0:c.details)}if(s.details=a,this.levelLastLoaded=s,this.hls.trigger(g.LEVEL_UPDATED,{details:a,level:r}),this.state===Bi.WAITING_LEVEL){if(this.waitForCdnTuneIn(a))return;this.state=Bi.IDLE}this.startFragRequested?a.live&&this.synchronizeToLiveEdge(a):this.setStartPosition(a,u),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:i,payload:r}=e,{levels:a}=this;if(!a)return void this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);const o=a[n.level],s=o.details;if(!s)return this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),void this.fragmentTracker.removeFragment(n);const l=o.videoCodec,u=s.PTSKnown||!s.live,c=null==(t=n.initSegment)?void 0:t.data,d=this._getAudioCodec(o),f=this.transmuxer=this.transmuxer||new va(this.hls,Ut.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),h=i?i.index:-1,p=-1!==h,g=new vi(n.level,n.sn,n.stats.chunkCount,r.byteLength,h,p),m=this.initPTS[n.cc];f.push(r,c,d,l,n,i,s.totalduration,u,g,m)}onAudioTrackSwitching(e,t){const n=this.altAudio,i=!!t.url;if(!i){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const e=this.fragCurrent;e&&(this.log("Switching to main audio track, cancel main fragment load"),e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const e=this.hls;n&&(e.trigger(g.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),e.trigger(g.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=t.id,i=!!this.hls.audioTracks[n].url;if(i){const e=this.videoBuffer;e&&this.mediaBuffer!==e&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=e)}this.altAudio=i,this.tick()}onBufferCreated(e,t){const n=t.tracks;let i,r,a=!1;for(const o in n){const e=n[o];if("main"===e.id){if(r=o,i=e,"video"===o){const e=n[o];e&&(this.videoBuffer=e.buffer)}}else a=!0}a&&i?(this.log(`Alternate track found, use ${r}.buffered to schedule main fragment loading`),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:i}=t;if(n&&n.type!==Ut.MAIN)return;if(this.fragContextChanged(n))return this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),void(this.state===Bi.PARSED&&(this.state=Bi.IDLE));const r=i?i.stats:n.stats;this.fragLastKbps=Math.round(8*r.total/(r.buffering.end-r.loading.first)),"initSegment"!==n.sn&&(this.fragPrevious=n),this.fragBufferedComplete(n,i)}onError(e,t){var n;if(t.fatal)this.state=Bi.ERROR;else switch(t.details){case v.FRAG_GAP:case v.FRAG_PARSING_ERROR:case v.FRAG_DECRYPT_ERROR:case v.FRAG_LOAD_ERROR:case v.FRAG_LOAD_TIMEOUT:case v.KEY_LOAD_ERROR:case v.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Ut.MAIN,t);break;case v.LEVEL_LOAD_ERROR:case v.LEVEL_LOAD_TIMEOUT:case v.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==Bi.WAITING_LEVEL||(null==(n=t.context)?void 0:n.type)!==Ft.LEVEL||(this.state=Bi.IDLE);break;case v.BUFFER_APPEND_ERROR:case v.BUFFER_FULL_ERROR:if(!t.parent||"main"!==t.parent)return;if(t.details===v.BUFFER_APPEND_ERROR)return void this.resetLoadingState();this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case v.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}checkBuffer(){const{media:e,gapController:t}=this;if(e&&t&&e.readyState){if(this.loadedmetadata||!mi.getBuffered(e).length){const e=this.state!==Bi.IDLE?this.fragCurrent:null;t.poll(this.lastCurrentTime,e)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=Bi.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==M.AUDIO||this.audioOnly&&!this.altAudio){const e=(t===M.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(e,t,Ut.MAIN),this.tick()}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking)return void this.log(`could not seek to ${n}, already seeking at ${t}`);const i=mi.getBuffered(e),r=i.length?i.start(0):0,a=r-n;a>0&&(a<this.config.maxBufferHole||a<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${a} to match buffer start`),n+=a,this.startPosition=n),this.log(`seek to target start position ${n} from current time ${t}`),e.currentTime=n}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(n=>{const{hls:i}=this;if(!n||this.fragContextChanged(e))return;t.fragmentError=0,this.state=Bi.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const r=e.stats;r.parsing.start=r.parsing.end=r.buffering.start=r.buffering.end=self.performance.now(),i.trigger(g.FRAG_LOADED,n),e.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const n="main",{hls:i}=this,{remuxResult:r,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o)return void this.resetWhenMissingContext(a);const{frag:s,part:l,level:u}=o,{video:c,text:d,id3:h,initSegment:p}=r,{details:m}=u,v=this.altAudio?void 0:r.audio;if(this.fragContextChanged(s))this.fragmentTracker.removeFragment(s);else{if(this.state=Bi.PARSING,p){if(null!=p&&p.tracks){const e=s.initSegment||s;this._bufferInitSegment(u,p.tracks,e,a),i.trigger(g.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:n,tracks:p.tracks})}const e=p.initPTS,t=p.timescale;f(e)&&(this.initPTS[s.cc]={baseTime:e,timescale:t},i.trigger(g.INIT_PTS_FOUND,{frag:s,id:n,initPTS:e,timescale:t}))}if(c&&m&&"initSegment"!==s.sn){const e=m.fragments[s.sn-1-m.startSN],t=s.sn===m.startSN,n=!e||s.cc>e.cc;if(!1!==r.independent){const{startPTS:e,endPTS:i,startDTS:r,endDTS:o}=c;if(l)l.elementaryStreams[c.type]={startPTS:e,endPTS:i,startDTS:r,endDTS:o};else if(c.firstKeyFrame&&c.independent&&1===a.id&&!n&&(this.couldBacktrack=!0),c.dropped&&c.independent){const r=this.getMainFwdBufferInfo(),a=(r?r.end:this.getLoadPosition())+this.config.maxBufferHole,l=c.firstKeyFramePTS?c.firstKeyFramePTS:e;if(!t&&a<l-this.config.maxBufferHole&&!n)return void this.backtrack(s);n&&(s.gap=!0),s.setElementaryStreamInfo(c.type,s.start,i,s.start,o,!0)}else t&&e>bl&&(s.gap=!0);s.setElementaryStreamInfo(c.type,e,i,r,o),this.backtrackFragment&&(this.backtrackFragment=s),this.bufferFragmentData(c,s,l,a,t||n)}else{if(!t&&!n)return void this.backtrack(s);s.gap=!0}}if(v){const{startPTS:e,endPTS:t,startDTS:n,endDTS:i}=v;l&&(l.elementaryStreams[M.AUDIO]={startPTS:e,endPTS:t,startDTS:n,endDTS:i}),s.setElementaryStreamInfo(M.AUDIO,e,t,n,i),this.bufferFragmentData(v,s,l,a)}if(m&&null!=h&&null!=(t=h.samples)&&t.length){const e={id:n,frag:s,details:m,samples:h.samples};i.trigger(g.FRAG_PARSING_METADATA,e)}if(m&&d){const e={id:n,frag:s,details:m,samples:d.samples};i.trigger(g.FRAG_PARSING_USERDATA,e)}}}_bufferInitSegment(e,t,n,i){if(this.state!==Bi.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:r,video:a,audiovideo:o}=t;if(r){let t=e.audioCodec;const n=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){t&&(t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5");const e=r.metadata;e&&"channelCount"in e&&1!==(e.channelCount||1)&&-1===n.indexOf("firefox")&&(t="mp4a.40.5")}t&&-1!==t.indexOf("mp4a.40.5")&&-1!==n.indexOf("android")&&"audio/mpeg"!==r.container&&(t="mp4a.40.2",this.log(`Android: force audio codec to ${t}`)),e.audioCodec&&e.audioCodec!==t&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${t}"`),r.levelCodec=t,r.id="main",this.log(`Init audio buffer, container:${r.container}, codecs[selected/level/parsed]=[${t||""}/${e.audioCodec||""}/${r.codec}]`)}a&&(a.levelCodec=e.videoCodec,a.id="main",this.log(`Init video buffer, container:${a.container}, codecs[level/parsed]=[${e.videoCodec||""}/${a.codec}]`)),o&&this.log(`Init audiovideo buffer, container:${o.container}, codecs[level/parsed]=[${e.codecs}/${o.codec}]`),this.hls.trigger(g.BUFFER_CODECS,t),Object.keys(t).forEach(e=>{const r=t[e],a=r.initSegment;null!=a&&a.byteLength&&this.hls.trigger(g.BUFFER_APPENDING,{type:e,data:a,frag:n,part:null,chunkMeta:i,parent:n.type})}),this.tickImmediate()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,Ut.MAIN)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=Bi.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&!1===e.seeking){const n=e.currentTime;if(mi.isBuffered(e,n)?t=this.getAppendedFrag(n):mi.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const e=this.fragPlaying,n=t.level;e&&t.sn===e.sn&&e.level===n||(this.fragPlaying=t,this.hls.trigger(g.FRAG_CHANGED,{frag:t}),e&&e.level===n||this.hls.trigger(g.LEVEL_SWITCHED,{level:n}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const t=e.currentTime,n=this.currentFrag;if(n&&f(t)&&f(n.programDateTime)){const e=n.programDateTime+1e3*(t-n.start);return new Date(e)}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class Il{static get version(){return"1.5.14"}static isMSESupported(){return ml()}static isSupported(){return vl()}static getMediaSource(){return lt()}static get Events(){return g}static get ErrorTypes(){return m}static get ErrorDetails(){return v}static get DefaultConfig(){return Il.defaultConfig?Il.defaultConfig:ol}static set DefaultConfig(e){Il.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this.started=!1,this._emitter=new ma,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,this.triggeringException=void 0,S(e.debug||!1,"Hls instance");const t=this.config=ll(Il.DefaultConfig,e);this.userConfig=e,t.progressive&&cl(t);const{abrController:n,bufferController:i,capLevelController:r,errorController:a,fpsController:o}=t,s=new a(this),l=this.abrController=new n(this),u=this.bufferController=new i(this),c=this.capLevelController=new r(this),d=new o(this),f=new jt(this),h=new nn(this),p=t.contentSteeringController,m=p?new p(this):null,v=this.levelController=new fl(this,m),y=new fi(this),_=new pl(this.config),b=this.streamController=new Al(this,y,_);c.setStreamController(b),d.setStreamController(b);const E=[f,v,b];m&&E.splice(1,0,m),this.networkControllers=E;const T=[l,u,c,d,h,y];this.audioTrackController=this.createController(t.audioTrackController,E);const w=t.audioStreamController;w&&E.push(new w(this,y,_)),this.subtitleTrackController=this.createController(t.subtitleTrackController,E);const A=t.subtitleStreamController;A&&E.push(new A(this,y,_)),this.createController(t.timelineController,T),_.emeController=this.emeController=this.createController(t.emeController,T),this.cmcdController=this.createController(t.cmcdController,T),this.latencyController=this.createController(rn,T),this.coreComponents=T,E.push(s);const I=s.onErrorOut;"function"===typeof I&&this.on(g.ERROR,I,s)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,i){this._emitter.off(e,t,n,i)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(t){if(w.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),!this.triggeringException){this.triggeringException=!0;const n=e===g.ERROR;this.trigger(g.ERROR,{type:m.OTHER_ERROR,details:v.INTERNAL_EXCEPTION,fatal:n,event:e,error:t}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){w.log("destroy"),this.trigger(g.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(e=>e.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(e=>e.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){w.log("attachMedia"),this._media=e,this.trigger(g.MEDIA_ATTACHING,{media:e})}detachMedia(){w.log("detachMedia"),this.trigger(g.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();const t=this.media,n=this.url,i=this.url=a.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,w.log(`loadSource:${i}`),t&&n&&(n!==i||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(g.MANIFEST_LOADING,{url:e})}startLoad(e=-1){w.log(`startLoad(${e})`),this.started=!0,this.networkControllers.forEach(t=>{t.startLoad(e)})}stopLoad(){w.log("stopLoad"),this.started=!1,this.networkControllers.forEach(e=>{e.stopLoad()})}resumeBuffering(){this.started&&this.networkControllers.forEach(e=>{"fragmentLoader"in e&&e.startLoad(-1)})}pauseBuffering(){this.networkControllers.forEach(e=>{"fragmentLoader"in e&&e.stopLoad()})}swapAudioCodec(){w.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){w.log("recoverMediaError");const e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e){this.levelController.removeLevel(e)}get levels(){const e=this.levelController.levels;return e||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){w.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){w.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){w.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){w.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return-1===e&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){w.log(`set startLevel:${e}`),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(w.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){on(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return-1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let i=0;i<n;i++)if(e[i].maxBitrate>=t)return i;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let i;if(i=-1===t&&null!=e&&e.length?e.length-1:t,n)for(let r=i;r--;){const t=e[r].attrs["HDCP-LEVEL"];if(t&&t<=n)return r}return i}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}setAudioOption(e){var t;return null==(t=this.audioTrackController)?void 0:t.setAudioOption(e)}setSubtitleOption(e){var t;return null==(t=this.subtitleTrackController)||t.setSubtitleOption(e),null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return!!e&&e.subtitleDisplay}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}Il.defaultConfig=void 0},a5b8:function(e,t,n){"use strict";var i=n("d8e8");function r(e){var t,n;this.promise=new e(function(e,i){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=i}),this.resolve=i(t),this.reject=i(n)}e.exports.f=function(e){return new r(e)}},a73c:function(e,t,n){var i=n("6d8b"),r=i.retrieve2,a=i.retrieve3,o=i.each,s=i.normalizeCssArray,l=i.isString,u=i.isObject,c=n("e86a"),d=n("5693"),f=n("5e76"),h=n("7d6d"),p={left:1,right:1,center:1},g={top:1,bottom:1,middle:1};function m(e){return v(e),o(e.rich,v),e}function v(e){if(e){e.font=c.makeFont(e);var t=e.textAlign;"middle"===t&&(t="center"),e.textAlign=null==t||p[t]?t:"left";var n=e.textVerticalAlign||e.textBaseline;"center"===n&&(n="middle"),e.textVerticalAlign=null==n||g[n]?n:"top";var i=e.textPadding;i&&(e.textPadding=s(e.textPadding))}}function y(e,t,n,i,r){i.rich?b(e,t,n,i,r):_(e,t,n,i,r)}function _(e,t,n,i,r){var a=R(t,"font",i.font||c.DEFAULT_FONT),o=i.textPadding,s=e.__textCotentBlock;s&&!e.__dirty||(s=e.__textCotentBlock=c.parsePlainText(n,a,o,i.truncate));var l=s.outerHeight,u=s.lines,d=s.lineHeight,f=x(l,i,r),h=f.baseX,p=f.baseY,g=f.textAlign,m=f.textVerticalAlign;T(t,i,r,h,p);var v=c.adjustTextY(p,l,m),y=h,_=v,b=w(i);if(b||o){var E=c.getWidth(n,a),S=E;o&&(S+=o[1]+o[3]);var I=c.adjustTextX(h,S,g);b&&A(e,t,i,I,v,S,l),o&&(y=M(h,g,o),_+=o[0])}R(t,"textAlign",g||"left"),R(t,"textBaseline","middle"),R(t,"shadowBlur",i.textShadowBlur||0),R(t,"shadowColor",i.textShadowColor||"transparent"),R(t,"shadowOffsetX",i.textShadowOffsetX||0),R(t,"shadowOffsetY",i.textShadowOffsetY||0),_+=d/2;var k=i.textStrokeWidth,L=C(i.textStroke,k),P=D(i.textFill);L&&(R(t,"lineWidth",k),R(t,"strokeStyle",L)),P&&R(t,"fillStyle",P);for(var N=0;N<u.length;N++)L&&t.strokeText(u[N],y,_),P&&t.fillText(u[N],y,_),_+=d}function b(e,t,n,i,r){var a=e.__textCotentBlock;a&&!e.__dirty||(a=e.__textCotentBlock=c.parseRichText(n,i)),E(e,t,a,i,r)}function E(e,t,n,i,r){var a=n.width,o=n.outerWidth,s=n.outerHeight,l=i.textPadding,u=x(s,i,r),d=u.baseX,f=u.baseY,h=u.textAlign,p=u.textVerticalAlign;T(t,i,r,d,f);var g=c.adjustTextX(d,o,h),m=c.adjustTextY(f,s,p),v=g,y=m;l&&(v+=l[3],y+=l[0]);var _=v+a;w(i)&&A(e,t,i,g,m,o,s);for(var b=0;b<n.lines.length;b++){var E,I=n.lines[b],R=I.tokens,C=R.length,D=I.lineHeight,k=I.width,M=0,L=v,P=_,N=C-1;while(M<C&&(E=R[M],!E.textAlign||"left"===E.textAlign))S(e,t,E,i,D,y,L,"left"),k-=E.width,L+=E.width,M++;while(N>=0&&(E=R[N],"right"===E.textAlign))S(e,t,E,i,D,y,P,"right"),k-=E.width,P-=E.width,N--;L+=(a-(L-v)-(_-P)-k)/2;while(M<=N)E=R[M],S(e,t,E,i,D,y,L+E.width/2,"center"),L+=E.width,M++;y+=D}}function T(e,t,n,i,r){if(n&&t.textRotation){var a=t.textOrigin;"center"===a?(i=n.width/2+n.x,r=n.height/2+n.y):a&&(i=a[0]+n.x,r=a[1]+n.y),e.translate(i,r),e.rotate(-t.textRotation),e.translate(-i,-r)}}function S(e,t,n,i,o,s,l,u){var d=i.rich[n.styleName]||{},f=n.textVerticalAlign,h=s+o/2;"top"===f?h=s+n.height/2:"bottom"===f&&(h=s+o-n.height/2),!n.isLineHolder&&w(d)&&A(e,t,d,"right"===u?l-n.width:"center"===u?l-n.width/2:l,h-n.height/2,n.width,n.height);var p=n.textPadding;p&&(l=M(l,u,p),h-=n.height/2-p[2]-n.textHeight/2),R(t,"shadowBlur",a(d.textShadowBlur,i.textShadowBlur,0)),R(t,"shadowColor",d.textShadowColor||i.textShadowColor||"transparent"),R(t,"shadowOffsetX",a(d.textShadowOffsetX,i.textShadowOffsetX,0)),R(t,"shadowOffsetY",a(d.textShadowOffsetY,i.textShadowOffsetY,0)),R(t,"textAlign",u),R(t,"textBaseline","middle"),R(t,"font",n.font||c.DEFAULT_FONT);var g=C(d.textStroke||i.textStroke,v),m=D(d.textFill||i.textFill),v=r(d.textStrokeWidth,i.textStrokeWidth);g&&(R(t,"lineWidth",v),R(t,"strokeStyle",g),t.strokeText(n.text,l,h)),m&&(R(t,"fillStyle",m),t.fillText(n.text,l,h))}function w(e){return e.textBackgroundColor||e.textBorderWidth&&e.textBorderColor}function A(e,t,n,i,r,a,o){var s=n.textBackgroundColor,c=n.textBorderWidth,h=n.textBorderColor,p=l(s);if(R(t,"shadowBlur",n.textBoxShadowBlur||0),R(t,"shadowColor",n.textBoxShadowColor||"transparent"),R(t,"shadowOffsetX",n.textBoxShadowOffsetX||0),R(t,"shadowOffsetY",n.textBoxShadowOffsetY||0),p||c&&h){t.beginPath();var g=n.textBorderRadius;g?d.buildPath(t,{x:i,y:r,width:a,height:o,r:g}):t.rect(i,r,a,o),t.closePath()}if(p)R(t,"fillStyle",s),t.fill();else if(u(s)){var m=s.image;m=f.createOrUpdateImage(m,null,e,I,s),m&&f.isImageReady(m)&&t.drawImage(m,i,r,a,o)}c&&h&&(R(t,"lineWidth",c),R(t,"strokeStyle",h),t.stroke())}function I(e,t){t.image=e}function x(e,t,n){var i=t.x||0,r=t.y||0,a=t.textAlign,o=t.textVerticalAlign;if(n){var s=t.textPosition;if(s instanceof Array)i=n.x+k(s[0],n.width),r=n.y+k(s[1],n.height);else{var l=c.adjustTextPositionOnRect(s,n,t.textDistance);i=l.x,r=l.y,a=a||l.textAlign,o=o||l.textVerticalAlign}var u=t.textOffset;u&&(i+=u[0],r+=u[1])}return{baseX:i,baseY:r,textAlign:a,textVerticalAlign:o}}function R(e,t,n){return e[t]=h(e,t,n),e[t]}function C(e,t){return null==e||t<=0||"transparent"===e||"none"===e?null:e.image||e.colorStops?"#000":e}function D(e){return null==e||"none"===e?null:e.image||e.colorStops?"#000":e}function k(e,t){return"string"===typeof e?e.lastIndexOf("%")>=0?parseFloat(e)/100*t:parseFloat(e):e}function M(e,t,n){return"right"===t?e-n[1]:"center"===t?e+n[3]/2-n[1]/2:e+n[3]}function L(e,t){return null!=e&&(e||t.textBackgroundColor||t.textBorderWidth&&t.textBorderColor||t.textPadding)}t.normalizeTextStyle=m,t.renderText=y,t.getStroke=C,t.getFill=D,t.needDrawText=L},a96b:function(e,t,n){var i=n("3eba"),r=i.extendComponentModel({type:"tooltip",dependencies:["axisPointer"],defaultOption:{zlevel:0,z:8,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove|click",alwaysShowContent:!1,displayMode:"single",confine:!1,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"rgba(50,50,50,0.7)",borderColor:"#333",borderRadius:4,borderWidth:0,padding:5,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:"auto",animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",crossStyle:{color:"#999",width:1,type:"dashed",textStyle:{}}},textStyle:{color:"#fff",fontSize:14}}});e.exports=r},aa77:function(e,t,n){var i=n("5ca1"),r=n("be13"),a=n("79e5"),o=n("fdef"),s="["+o+"]",l="",u=RegExp("^"+s+s+"*"),c=RegExp(s+s+"*$"),d=function(e,t,n){var r={},s=a(function(){return!!o[e]()||l[e]()!=l}),u=r[e]=s?t(f):o[e];n&&(r[n]=u),i(i.P+i.F*s,"String",r)},f=d.trim=function(e,t){return e=String(r(e)),1&t&&(e=e.replace(u,"")),2&t&&(e=e.replace(c,"")),e};e.exports=d},aae3:function(e,t,n){var i=n("d3f4"),r=n("2d95"),a=n("2b4c")("match");e.exports=function(e){var t;return i(e)&&(void 0!==(t=e[a])?!!t:"RegExp"==r(e))}},ac0f:function(e,t,n){var i=n("cbe5"),r=n("401b"),a=n("4a3f"),o=a.quadraticSubdivide,s=a.cubicSubdivide,l=a.quadraticAt,u=a.cubicAt,c=a.quadraticDerivativeAt,d=a.cubicDerivativeAt,f=[];function h(e,t,n){var i=e.cpx2,r=e.cpy2;return null===i||null===r?[(n?d:u)(e.x1,e.cpx1,e.cpx2,e.x2,t),(n?d:u)(e.y1,e.cpy1,e.cpy2,e.y2,t)]:[(n?c:l)(e.x1,e.cpx1,e.x2,t),(n?c:l)(e.y1,e.cpy1,e.y2,t)]}var p=i.extend({type:"bezier-curve",shape:{x1:0,y1:0,x2:0,y2:0,cpx1:0,cpy1:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function(e,t){var n=t.x1,i=t.y1,r=t.x2,a=t.y2,l=t.cpx1,u=t.cpy1,c=t.cpx2,d=t.cpy2,h=t.percent;0!==h&&(e.moveTo(n,i),null==c||null==d?(h<1&&(o(n,l,r,h,f),l=f[1],r=f[2],o(i,u,a,h,f),u=f[1],a=f[2]),e.quadraticCurveTo(l,u,r,a)):(h<1&&(s(n,l,c,r,h,f),l=f[1],c=f[2],r=f[3],s(i,u,d,a,h,f),u=f[1],d=f[2],a=f[3]),e.bezierCurveTo(l,u,c,d,r,a)))},pointAt:function(e){return h(this.shape,e,!1)},tangentAt:function(e){var t=h(this.shape,e,!0);return r.normalize(t,t)}});e.exports=p},ac6a:function(e,t,n){for(var i=n("cadf"),r=n("0d58"),a=n("2aba"),o=n("7726"),s=n("32e9"),l=n("84f2"),u=n("2b4c"),c=u("iterator"),d=u("toStringTag"),f=l.Array,h={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=r(h),g=0;g<p.length;g++){var m,v=p[g],y=h[v],_=o[v],b=_&&_.prototype;if(b&&(b[c]||s(b,c,f),b[d]||s(b,d,v),l[v]=f,y))for(m in i)b[m]||a(b,m,i[m],!0)}},aef6:function(e,t,n){"use strict";var i=n("5ca1"),r=n("9def"),a=n("d2c8"),o="endsWith",s=""[o];i(i.P+i.F*n("5147")(o),"String",{endsWith:function(e){var t=a(this,e,o),n=arguments.length>1?arguments[1]:void 0,i=r(t.length),l=void 0===n?i:Math.min(r(n),i),u=String(e);return s?s.call(t,u,l):t.slice(l-u.length,l)===u}})},af24:function(e,t,n){n("48c7"),n("f273")},afa0:function(e,t,n){var i=n("6d8b"),r=n("22d1"),a=n("e1fc"),o=n("04f6");function s(e,t){return e.zlevel===t.zlevel?e.z===t.z?e.z2-t.z2:e.z-t.z:e.zlevel-t.zlevel}var l=function(){this._roots=[],this._displayList=[],this._displayListLen=0};l.prototype={constructor:l,traverse:function(e,t){for(var n=0;n<this._roots.length;n++)this._roots[n].traverse(e,t)},getDisplayList:function(e,t){return t=t||!1,e&&this.updateDisplayList(t),this._displayList},updateDisplayList:function(e){this._displayListLen=0;for(var t=this._roots,n=this._displayList,i=0,a=t.length;i<a;i++)this._updateAndAddDisplayable(t[i],null,e);n.length=this._displayListLen,r.canvasSupported&&o(n,s)},_updateAndAddDisplayable:function(e,t,n){if(!e.ignore||n){e.beforeUpdate(),e.__dirty&&e.update(),e.afterUpdate();var i=e.clipPath;if(i){t=t?t.slice():[];var r=i,a=e;while(r)r.parent=a,r.updateTransform(),t.push(r),a=r,r=r.clipPath}if(e.isGroup){for(var o=e._children,s=0;s<o.length;s++){var l=o[s];e.__dirty&&(l.__dirty=!0),this._updateAndAddDisplayable(l,t,n)}e.__dirty=!1}else e.__clipPaths=t,this._displayList[this._displayListLen++]=e}},addRoot:function(e){e.__storage!==this&&(e instanceof a&&e.addChildrenToStorage(this),this.addToStorage(e),this._roots.push(e))},delRoot:function(e){if(null==e){for(var t=0;t<this._roots.length;t++){var n=this._roots[t];n instanceof a&&n.delChildrenFromStorage(this)}return this._roots=[],this._displayList=[],void(this._displayListLen=0)}if(e instanceof Array){t=0;for(var r=e.length;t<r;t++)this.delRoot(e[t])}else{var o=i.indexOf(this._roots,e);o>=0&&(this.delFromStorage(e),this._roots.splice(o,1),e instanceof a&&e.delChildrenFromStorage(this))}},addToStorage:function(e){return e&&(e.__storage=this,e.dirty(!1)),this},delFromStorage:function(e){return e&&(e.__storage=null),this},dispose:function(){this._renderList=this._roots=null},displayableSortFunc:s};var u=l;e.exports=u},b11c:function(e,t,n){n("8ec5"),n("db9e"),n("4e9f"),n("d3a0"),n("767c"),n("7c4d"),n("df70")},b12f:function(e,t,n){var i=n("e1fc"),r=n("8918"),a=n("625e"),o=function(){this.group=new i,this.uid=r.getUID("viewComponent")};o.prototype={constructor:o,init:function(e,t){},render:function(e,t,n,i){},dispose:function(){}};var s=o.prototype;s.updateView=s.updateLayout=s.updateVisual=function(e,t,n,i){},a.enableClassExtend(o),a.enableClassManagement(o,{registerWhenExtend:!0});var l=o;e.exports=l},b1d4:function(e,t,n){var i=n("862d");function r(e,t){return t=t||{},i(t.coordDimensions||[],e,{dimsDef:t.dimensionsDefine||e.dimensionsDefine,encodeDef:t.encodeDefine||e.encodeDefine,dimCount:t.dimensionsCount,generateCoord:t.generateCoord,generateCoordCount:t.generateCoordCount})}e.exports=r},b5c7:function(e,t,n){var i=n("282b"),r=i([["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["stroke","barBorderColor"],["lineWidth","barBorderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]),a={getBarItemStyle:function(e){var t=r(this,e);if(this.getBorderLineDash){var n=this.getBorderLineDash();n&&(t.lineDash=n)}return t}};e.exports=a},b639:function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var i=n("1fb5"),r=n("9152"),a=n("e3db");function o(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"===typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}function s(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function l(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=u.prototype):(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,n){if(!u.TYPED_ARRAY_SUPPORT&&!(this instanceof u))return new u(e,t,n);if("number"===typeof e){if("string"===typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return c(this,e,t,n)}function c(e,t,n,i){if("number"===typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!==typeof ArrayBuffer&&t instanceof ArrayBuffer?m(e,t,n,i):"string"===typeof t?p(e,t,n):v(e,t)}function d(e){if("number"!==typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function f(e,t,n,i){return d(t),t<=0?l(e,t):void 0!==n?"string"===typeof i?l(e,t).fill(n,i):l(e,t).fill(n):l(e,t)}function h(e,t){if(d(t),e=l(e,t<0?0:0|y(t)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function p(e,t,n){if("string"===typeof n&&""!==n||(n="utf8"),!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|b(t,n);e=l(e,i);var r=e.write(t,n);return r!==i&&(e=e.slice(0,r)),e}function g(e,t){var n=t.length<0?0:0|y(t.length);e=l(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}function m(e,t,n,i){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,n):new Uint8Array(t,n,i),u.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=u.prototype):e=g(e,t),e}function v(e,t){if(u.isBuffer(t)){var n=0|y(t.length);return e=l(e,n),0===e.length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!==typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!==typeof t.length||te(t.length)?l(e,0):g(e,t);if("Buffer"===t.type&&a(t.data))return g(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function y(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function _(e){return+e!=e&&(e=0),u.alloc(+e)}function b(e,t){if(u.isBuffer(e))return e.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!==typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return $(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return J(e).length;default:if(i)return $(e).length;t=(""+t).toLowerCase(),i=!0}}function E(e,t,n){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";e||(e="utf8");while(1)switch(e){case"hex":return F(this,t,n);case"utf8":case"utf-8":return M(this,t,n);case"ascii":return N(this,t,n);case"latin1":case"binary":return O(this,t,n);case"base64":return k(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function T(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function S(e,t,n,i,r){if(0===e.length)return-1;if("string"===typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"===typeof t&&(t=u.from(t,i)),u.isBuffer(t))return 0===t.length?-1:w(e,t,n,i,r);if("number"===typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):w(e,[t],n,i,r);throw new TypeError("val must be string, number or Buffer")}function w(e,t,n,i,r){var a,o=1,s=e.length,l=t.length;if(void 0!==i&&(i=String(i).toLowerCase(),"ucs2"===i||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;o=2,s/=2,l/=2,n/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(r){var c=-1;for(a=n;a<s;a++)if(u(e,a)===u(t,-1===c?0:a-c)){if(-1===c&&(c=a),a-c+1===l)return c*o}else-1!==c&&(a-=a-c),c=-1}else for(n+l>s&&(n=s-l),a=n;a>=0;a--){for(var d=!0,f=0;f<l;f++)if(u(e,a+f)!==u(t,f)){d=!1;break}if(d)return a}return-1}function A(e,t,n,i){n=Number(n)||0;var r=e.length-n;i?(i=Number(i),i>r&&(i=r)):i=r;var a=t.length;if(a%2!==0)throw new TypeError("Invalid hex string");i>a/2&&(i=a/2);for(var o=0;o<i;++o){var s=parseInt(t.substr(2*o,2),16);if(isNaN(s))return o;e[n+o]=s}return o}function I(e,t,n,i){return ee($(t,e.length-n),e,n,i)}function x(e,t,n,i){return ee(X(t),e,n,i)}function R(e,t,n,i){return x(e,t,n,i)}function C(e,t,n,i){return ee(J(t),e,n,i)}function D(e,t,n,i){return ee(Q(t,e.length-n),e,n,i)}function k(e,t,n){return 0===t&&n===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,n))}function M(e,t,n){n=Math.min(e.length,n);var i=[],r=t;while(r<n){var a,o,s,l,u=e[r],c=null,d=u>239?4:u>223?3:u>191?2:1;if(r+d<=n)switch(d){case 1:u<128&&(c=u);break;case 2:a=e[r+1],128===(192&a)&&(l=(31&u)<<6|63&a,l>127&&(c=l));break;case 3:a=e[r+1],o=e[r+2],128===(192&a)&&128===(192&o)&&(l=(15&u)<<12|(63&a)<<6|63&o,l>2047&&(l<55296||l>57343)&&(c=l));break;case 4:a=e[r+1],o=e[r+2],s=e[r+3],128===(192&a)&&128===(192&o)&&128===(192&s)&&(l=(15&u)<<18|(63&a)<<12|(63&o)<<6|63&s,l>65535&&l<1114112&&(c=l))}null===c?(c=65533,d=1):c>65535&&(c-=65536,i.push(c>>>10&1023|55296),c=56320|1023&c),i.push(c),r+=d}return P(i)}t.Buffer=u,t.SlowBuffer=_,t.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:o(),t.kMaxLength=s(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,n){return c(null,e,t,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,n){return f(null,e,t,n)},u.allocUnsafe=function(e){return h(null,e)},u.allocUnsafeSlow=function(e){return h(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,r=0,a=Math.min(n,i);r<a;++r)if(e[r]!==t[r]){n=e[r],i=t[r];break}return n<i?-1:i<n?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var i=u.allocUnsafe(t),r=0;for(n=0;n<e.length;++n){var o=e[n];if(!u.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(i,r),r+=o.length}return i},u.byteLength=b,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)T(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)T(this,t,t+3),T(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)T(this,t,t+7),T(this,t+1,t+6),T(this,t+2,t+5),T(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?M(this,0,e):E.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,n,i,r){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),t<0||n>e.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&t>=n)return 0;if(i>=r)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,i>>>=0,r>>>=0,this===e)return 0;for(var a=r-i,o=n-t,s=Math.min(a,o),l=this.slice(i,r),c=e.slice(t,n),d=0;d<s;++d)if(l[d]!==c[d]){a=l[d],o=c[d];break}return a<o?-1:o<a?1:0},u.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},u.prototype.indexOf=function(e,t,n){return S(this,e,t,n,!0)},u.prototype.lastIndexOf=function(e,t,n){return S(this,e,t,n,!1)},u.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"===typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-t;if((void 0===n||n>r)&&(n=r),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var a=!1;;)switch(i){case"hex":return A(this,e,t,n);case"utf8":case"utf-8":return I(this,e,t,n);case"ascii":return x(this,e,t,n);case"latin1":case"binary":return R(this,e,t,n);case"base64":return C(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),a=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var L=4096;function P(e){var t=e.length;if(t<=L)return String.fromCharCode.apply(String,e);var n="",i=0;while(i<t)n+=String.fromCharCode.apply(String,e.slice(i,i+=L));return n}function N(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(127&e[r]);return i}function O(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(e[r]);return i}function F(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var r="",a=t;a<n;++a)r+=W(e[a]);return r}function U(e,t,n){for(var i=e.slice(t,n),r="",a=0;a<i.length;a+=2)r+=String.fromCharCode(i[a]+256*i[a+1]);return r}function B(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function G(e,t,n,i,r,a){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<a)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function j(e,t,n,i){t<0&&(t=65535+t+1);for(var r=0,a=Math.min(e.length-n,2);r<a;++r)e[n+r]=(t&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function V(e,t,n,i){t<0&&(t=4294967295+t+1);for(var r=0,a=Math.min(e.length-n,4);r<a;++r)e[n+r]=t>>>8*(i?r:3-r)&255}function H(e,t,n,i,r,a){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function K(e,t,n,i,a){return a||H(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),r.write(e,t,n,i,23,4),n+4}function z(e,t,n,i,a){return a||H(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),r.write(e,t,n,i,52,8),n+8}u.prototype.slice=function(e,t){var n,i=this.length;if(e=~~e,t=void 0===t?i:~~t,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)n=this.subarray(e,t),n.__proto__=u.prototype;else{var r=t-e;n=new u(r,void 0);for(var a=0;a<r;++a)n[a]=this[a+e]}return n},u.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||B(e,t,this.length);var i=this[e],r=1,a=0;while(++a<t&&(r*=256))i+=this[e+a]*r;return i},u.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||B(e,t,this.length);var i=this[e+--t],r=1;while(t>0&&(r*=256))i+=this[e+--t]*r;return i},u.prototype.readUInt8=function(e,t){return t||B(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||B(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||B(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||B(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||B(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||B(e,t,this.length);var i=this[e],r=1,a=0;while(++a<t&&(r*=256))i+=this[e+a]*r;return r*=128,i>=r&&(i-=Math.pow(2,8*t)),i},u.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||B(e,t,this.length);var i=t,r=1,a=this[e+--i];while(i>0&&(r*=256))a+=this[e+--i]*r;return r*=128,a>=r&&(a-=Math.pow(2,8*t)),a},u.prototype.readInt8=function(e,t){return t||B(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){t||B(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(e,t){t||B(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(e,t){return t||B(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||B(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||B(e,4,this.length),r.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||B(e,4,this.length),r.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||B(e,8,this.length),r.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||B(e,8,this.length),r.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,n,i){if(e=+e,t|=0,n|=0,!i){var r=Math.pow(2,8*n)-1;G(this,e,t,n,r,0)}var a=1,o=0;this[t]=255&e;while(++o<n&&(a*=256))this[t+o]=e/a&255;return t+n},u.prototype.writeUIntBE=function(e,t,n,i){if(e=+e,t|=0,n|=0,!i){var r=Math.pow(2,8*n)-1;G(this,e,t,n,r,0)}var a=n-1,o=1;this[t+a]=255&e;while(--a>=0&&(o*=256))this[t+a]=e/o&255;return t+n},u.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||G(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||G(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):j(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||G(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):j(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||G(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):V(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||G(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):V(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);G(this,e,t,n,r-1,-r)}var a=0,o=1,s=0;this[t]=255&e;while(++a<n&&(o*=256))e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},u.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);G(this,e,t,n,r-1,-r)}var a=n-1,o=1,s=0;this[t+a]=255&e;while(--a>=0&&(o*=256))e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},u.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||G(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||G(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):j(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||G(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):j(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||G(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):V(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||G(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):V(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,n){return K(this,e,t,!0,n)},u.prototype.writeFloatBE=function(e,t,n){return K(this,e,t,!1,n)},u.prototype.writeDoubleLE=function(e,t,n){return z(this,e,t,!0,n)},u.prototype.writeDoubleBE=function(e,t,n){return z(this,e,t,!1,n)},u.prototype.copy=function(e,t,n,i){if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var r,a=i-n;if(this===e&&n<t&&t<i)for(r=a-1;r>=0;--r)e[r+t]=this[r+n];else if(a<1e3||!u.TYPED_ARRAY_SUPPORT)for(r=0;r<a;++r)e[r+t]=this[r+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},u.prototype.fill=function(e,t,n,i){if("string"===typeof e){if("string"===typeof t?(i=t,t=0,n=this.length):"string"===typeof n&&(i=n,n=this.length),1===e.length){var r=e.charCodeAt(0);r<256&&(e=r)}if(void 0!==i&&"string"!==typeof i)throw new TypeError("encoding must be a string");if("string"===typeof i&&!u.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"===typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var a;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"===typeof e)for(a=t;a<n;++a)this[a]=e;else{var o=u.isBuffer(e)?e:$(new u(e,i).toString()),s=o.length;for(a=0;a<n-t;++a)this[a+t]=o[a%s]}return this};var Z=/[^+\/0-9A-Za-z-_]/g;function q(e){if(e=Y(e).replace(Z,""),e.length<2)return"";while(e.length%4!==0)e+="=";return e}function Y(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function W(e){return e<16?"0"+e.toString(16):e.toString(16)}function $(e,t){var n;t=t||1/0;for(var i=e.length,r=null,a=[],o=0;o<i;++o){if(n=e.charCodeAt(o),n>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(o+1===i){(t-=3)>-1&&a.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(t-=3)>-1&&a.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function X(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function Q(e,t){for(var n,i,r,a=[],o=0;o<e.length;++o){if((t-=2)<0)break;n=e.charCodeAt(o),i=n>>8,r=n%256,a.push(r),a.push(i)}return a}function J(e){return i.toByteArray(q(e))}function ee(e,t,n,i){for(var r=0;r<i;++r){if(r+n>=t.length||r>=e.length)break;t[r+n]=e[r]}return r}function te(e){return e!==e}}).call(this,n("c8ba"))},b69a:function(e,t,n){(function(e){function n(e,t){for(var n=0,i=e.length-1;i>=0;i--){var r=e[i];"."===r?e.splice(i,1):".."===r?(e.splice(i,1),n++):n&&(e.splice(i,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}var i=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,r=function(e){return i.exec(e).slice(1)};function a(e,t){if(e.filter)return e.filter(t);for(var n=[],i=0;i<e.length;i++)t(e[i],i,e)&&n.push(e[i]);return n}t.resolve=function(){for(var t="",i=!1,r=arguments.length-1;r>=-1&&!i;r--){var o=r>=0?arguments[r]:e.cwd();if("string"!==typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(t=o+"/"+t,i="/"===o.charAt(0))}return t=n(a(t.split("/"),function(e){return!!e}),!i).join("/"),(i?"/":"")+t||"."},t.normalize=function(e){var i=t.isAbsolute(e),r="/"===o(e,-1);return e=n(a(e.split("/"),function(e){return!!e}),!i).join("/"),e||i||(e="."),e&&r&&(e+="/"),(i?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(a(e,function(e,t){if("string"!==typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},t.relative=function(e,n){function i(e){for(var t=0;t<e.length;t++)if(""!==e[t])break;for(var n=e.length-1;n>=0;n--)if(""!==e[n])break;return t>n?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var r=i(e.split("/")),a=i(n.split("/")),o=Math.min(r.length,a.length),s=o,l=0;l<o;l++)if(r[l]!==a[l]){s=l;break}var u=[];for(l=s;l<r.length;l++)u.push("..");return u=u.concat(a.slice(s)),u.join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){var t=r(e),n=t[0],i=t[1];return n||i?(i&&(i=i.substr(0,i.length-1)),n+i):"."},t.basename=function(e,t){var n=r(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},t.extname=function(e){return r(e)[3]};var o="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,n("4362"))},b719:function(e,t,n){var i=n("697e7");t.zrender=i;var r=n("1687");t.matrix=r;var a=n("401b");t.vector=a;var o=n("6d8b"),s=n("41ef");t.color=s;var l=n("2306");t.graphic=l;var u=n("3842");t.number=u;var c=n("eda2");t.format=c;var d=n("88b3");d.throttle;t.throttle=d.throttle;var f=n("1548");t.helper=f;var h=n("bda7");t.parseGeoJSON=h;var p=n("6179");t.List=p;var g=n("4319");t.Model=g;var m=n("84ce");t.Axis=m;var v=n("22d1");t.env=v;var y=h,_={};o.each(["map","each","filter","indexOf","inherits","reduce","filter","bind","curry","isArray","isString","isObject","isFunction","extend","defaults","clone","merge"],function(e){_[e]=o[e]}),t.parseGeoJson=y,t.util=_},b809:function(e,t,n){var i=n("6d8b"),r=n("29a8"),a=n("2b17"),o=a.retrieveRawValue;function s(e,t){var n=t.getModel("aria");if(n.get("show"))if(n.get("description"))e.setAttribute("aria-label",n.get("description"));else{var a=0;t.eachSeries(function(e,t){++a},this);var s,l=n.get("data.maxCount")||10,u=n.get("series.maxCount")||10,c=Math.min(a,u);if(!(a<1)){var d=m();s=d?p(g("general.withTitle"),{title:d}):g("general.withoutTitle");var f=[],h=a>1?"series.multiple.prefix":"series.single.prefix";s+=p(g(h),{seriesCount:a}),t.eachSeries(function(e,t){if(t<c){var n,i=e.get("name"),r="series."+(a>1?"multiple":"single")+".";n=g(i?r+"withName":r+"withoutName"),n=p(n,{seriesId:e.seriesIndex,seriesName:e.get("name"),seriesType:v(e.subType)});var s=e.getData();window.data=s,s.count()>l?n+=p(g("data.partialData"),{displayCnt:l}):n+=g("data.allData");for(var u=[],d=0;d<s.count();d++)if(d<l){var h=s.getName(d),m=o(s,d);u.push(p(g(h?"data.withName":"data.withoutName"),{name:h,value:m}))}n+=u.join(g("data.separator.middle"))+g("data.separator.end"),f.push(n)}}),s+=f.join(g("series.multiple.separator.middle"))+g("series.multiple.separator.end"),e.setAttribute("aria-label",s)}}function p(e,t){if("string"!==typeof e)return e;var n=e;return i.each(t,function(e,t){n=n.replace(new RegExp("\\{\\s*"+t+"\\s*\\}","g"),e)}),n}function g(e){var t=n.get(e);if(null==t){for(var i=e.split("."),a=r.aria,o=0;o<i.length;++o)a=a[i[o]];return a}return t}function m(){var e=t.getModel("title").option;return e&&e.length&&(e=e[0]),e&&e.text}function v(e){return r.series.typeNames[e]||""}}e.exports=s},bcaa:function(e,t,n){var i=n("cb7c"),r=n("d3f4"),a=n("a5b8");e.exports=function(e,t){if(i(e),r(t)&&t.constructor===e)return t;var n=a.f(e),o=n.resolve;return o(t),n.promise}},bd6b:function(e,t,n){var i=n("06ad"),r=n("4942"),a=n("6d8b"),o=a.isString,s=a.isFunction,l=a.isObject,u=a.isArrayLike,c=a.indexOf,d=function(){this.animators=[]};d.prototype={constructor:d,animate:function(e,t){var n,a=!1,o=this,s=this.__zr;if(e){var l=e.split("."),u=o;a="shape"===l[0];for(var d=0,f=l.length;d<f;d++)u&&(u=u[l[d]]);u&&(n=u)}else n=o;if(n){var h=o.animators,p=new i(n,t);return p.during(function(e){o.dirty(a)}).done(function(){h.splice(c(h,p),1)}),h.push(p),s&&s.animation.addAnimator(p),p}r('Property "'+e+'" is not existed in element '+o.id)},stopAnimation:function(e){for(var t=this.animators,n=t.length,i=0;i<n;i++)t[i].stop(e);return t.length=0,this},animateTo:function(e,t,n,i,r,a){o(n)?(r=i,i=n,n=0):s(i)?(r=i,i="linear",n=0):s(n)?(r=n,n=0):s(t)?(r=t,t=500):t||(t=500),this.stopAnimation(),this._animateToShallow("",this,e,t,n);var l=this.animators.slice(),u=l.length;function c(){u--,u||r&&r()}u||r&&r();for(var d=0;d<l.length;d++)l[d].done(c).start(i,a)},_animateToShallow:function(e,t,n,i,r){var a={},o=0;for(var s in n)if(n.hasOwnProperty(s))if(null!=t[s])l(n[s])&&!u(n[s])?this._animateToShallow(e?e+"."+s:s,t[s],n[s],i,r):(a[s]=n[s],o++);else if(null!=n[s])if(e){var c={};c[e]={},c[e][s]=n[s],this.attr(c)}else this.attr(s,n[s]);return o>0&&this.animate(e,!1).when(null==i?500:i,a).delay(r||0),this}};var f=d;e.exports=f},bd9e:function(e,t,n){var i=n("4e08"),r=(i.__DEV__,n("6d8b")),a=n("2306"),o=n("e0d3"),s=n("f4a2"),l=r.each,u=r.indexOf,c=r.curry,d=["dataToPoint","pointToData"],f=["grid","xAxis","yAxis","geo","graph","polar","radiusAxis","angleAxis","bmap"];function h(e,t,n){var i=this._targetInfoList=[],r={},a=m(t,e);l(v,function(e,t){(!n||!n.include||u(n.include,t)>=0)&&e(a,i,r)})}var p=h.prototype;function g(e){return e[0]>e[1]&&e.reverse(),e}function m(e,t){return o.parseFinder(e,t,{includeMainTypes:f})}p.setOutputRanges=function(e,t){this.matchOutputRanges(e,t,function(e,t,n){if((e.coordRanges||(e.coordRanges=[])).push(t),!e.coordRange){e.coordRange=t;var i=b[e.brushType](0,n,t);e.__rangeOffset={offset:T[e.brushType](i.values,e.range,[1,1]),xyMinMax:i.xyMinMax}}})},p.matchOutputRanges=function(e,t,n){l(e,function(e){var i=this.findTargetInfo(e,t);i&&!0!==i&&r.each(i.coordSyses,function(i){var r=b[e.brushType](1,i,e.range);n(e,r.values,i,t)})},this)},p.setInputRanges=function(e,t){l(e,function(e){var n=this.findTargetInfo(e,t);if(e.range=e.range||[],n&&!0!==n){e.panelId=n.panelId;var i=b[e.brushType](0,n.coordSys,e.coordRange),r=e.__rangeOffset;e.range=r?T[e.brushType](i.values,r.offset,w(i.xyMinMax,r.xyMinMax)):i.values}},this)},p.makePanelOpts=function(e,t){return r.map(this._targetInfoList,function(n){var i=n.getPanelRect();return{panelId:n.panelId,defaultBrushType:t&&t(n),clipPath:s.makeRectPanelClipPath(i),isTargetByCursor:s.makeRectIsTargetByCursor(i,e,n.coordSysModel),getLinearBrushOtherExtent:s.makeLinearBrushOtherExtent(i)}})},p.controlSeries=function(e,t,n){var i=this.findTargetInfo(e,n);return!0===i||i&&u(i.coordSyses,t.coordinateSystem)>=0},p.findTargetInfo=function(e,t){for(var n=this._targetInfoList,i=m(t,e),r=0;r<n.length;r++){var a=n[r],o=e.panelId;if(o){if(a.panelId===o)return a}else for(r=0;r<y.length;r++)if(y[r](i,a))return a}return!0};var v={grid:function(e,t){var n=e.xAxisModels,i=e.yAxisModels,a=e.gridModels,o=r.createHashMap(),s={},c={};(n||i||a)&&(l(n,function(e){var t=e.axis.grid.model;o.set(t.id,t),s[t.id]=!0}),l(i,function(e){var t=e.axis.grid.model;o.set(t.id,t),c[t.id]=!0}),l(a,function(e){o.set(e.id,e),s[e.id]=!0,c[e.id]=!0}),o.each(function(e){var r=e.coordinateSystem,a=[];l(r.getCartesians(),function(e,t){(u(n,e.getAxis("x").model)>=0||u(i,e.getAxis("y").model)>=0)&&a.push(e)}),t.push({panelId:"grid--"+e.id,gridModel:e,coordSysModel:e,coordSys:a[0],coordSyses:a,getPanelRect:_.grid,xAxisDeclared:s[e.id],yAxisDeclared:c[e.id]})}))},geo:function(e,t){l(e.geoModels,function(e){var n=e.coordinateSystem;t.push({panelId:"geo--"+e.id,geoModel:e,coordSysModel:e,coordSys:n,coordSyses:[n],getPanelRect:_.geo})})}},y=[function(e,t){var n=e.xAxisModel,i=e.yAxisModel,r=e.gridModel;return!r&&n&&(r=n.axis.grid.model),!r&&i&&(r=i.axis.grid.model),r&&r===t.gridModel},function(e,t){var n=e.geoModel;return n&&n===t.geoModel}],_={grid:function(){return this.coordSys.grid.getRect().clone()},geo:function(){var e=this.coordSys,t=e.getBoundingRect().clone();return t.applyTransform(a.getTransform(e)),t}},b={lineX:c(E,0),lineY:c(E,1),rect:function(e,t,n){var i=t[d[e]]([n[0][0],n[1][0]]),r=t[d[e]]([n[0][1],n[1][1]]),a=[g([i[0],r[0]]),g([i[1],r[1]])];return{values:a,xyMinMax:a}},polygon:function(e,t,n){var i=[[1/0,-1/0],[1/0,-1/0]],a=r.map(n,function(n){var r=t[d[e]](n);return i[0][0]=Math.min(i[0][0],r[0]),i[1][0]=Math.min(i[1][0],r[1]),i[0][1]=Math.max(i[0][1],r[0]),i[1][1]=Math.max(i[1][1],r[1]),r});return{values:a,xyMinMax:i}}};function E(e,t,n,i){var a=n.getAxis(["x","y"][e]),o=g(r.map([0,1],function(e){return t?a.coordToData(a.toLocalCoord(i[e])):a.toGlobalCoord(a.dataToCoord(i[e]))})),s=[];return s[e]=o,s[1-e]=[NaN,NaN],{values:o,xyMinMax:s}}var T={lineX:c(S,0),lineY:c(S,1),rect:function(e,t,n){return[[e[0][0]-n[0]*t[0][0],e[0][1]-n[0]*t[0][1]],[e[1][0]-n[1]*t[1][0],e[1][1]-n[1]*t[1][1]]]},polygon:function(e,t,n){return r.map(e,function(e,i){return[e[0]-n[0]*t[i][0],e[1]-n[1]*t[i][1]]})}};function S(e,t,n,i){return[t[0]-i[e]*n[0],t[1]-i[e]*n[1]]}function w(e,t){var n=A(e),i=A(t),r=[n[0]/i[0],n[1]/i[1]];return isNaN(r[0])&&(r[0]=1),isNaN(r[1])&&(r[1]=1),r}function A(e){return e?[e[0][1]-e[0][0],e[1][1]-e[1][0]]:[NaN,NaN]}var I=h;e.exports=I},bda7:function(e,t,n){var i=n("6d8b"),r=n("f279");function a(e){if(!e.UTF8Encoding)return e;var t=e.UTF8Scale;null==t&&(t=1024);for(var n=e.features,i=0;i<n.length;i++)for(var r=n[i],a=r.geometry,s=a.coordinates,l=a.encodeOffsets,u=0;u<s.length;u++){var c=s[u];if("Polygon"===a.type)s[u]=o(c,l[u],t);else if("MultiPolygon"===a.type)for(var d=0;d<c.length;d++){var f=c[d];c[d]=o(f,l[u][d],t)}}return e.UTF8Encoding=!1,e}function o(e,t,n){for(var i=[],r=t[0],a=t[1],o=0;o<e.length;o+=2){var s=e.charCodeAt(o)-64,l=e.charCodeAt(o+1)-64;s=s>>1^-(1&s),l=l>>1^-(1&l),s+=r,l+=a,r=s,a=l,i.push([s/n,l/n])}return i}function s(e){return a(e),i.map(i.filter(e.features,function(e){return e.geometry&&e.properties&&e.geometry.coordinates.length>0}),function(e){var t=e.properties,n=e.geometry,a=n.coordinates,o=[];"Polygon"===n.type&&o.push({type:"polygon",exterior:a[0],interiors:a.slice(1)}),"MultiPolygon"===n.type&&i.each(a,function(e){e[0]&&o.push({type:"polygon",exterior:e[0],interiors:e.slice(1)})});var s=new r(t.name,o,t.cp);return s.properties=t,s})}e.exports=s},be13:function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},c366:function(e,t,n){var i=n("6821"),r=n("9def"),a=n("77f1");e.exports=function(e){return function(t,n,o){var s,l=i(t),u=r(l.length),c=a(o,u);if(e&&n!=n){while(u>c)if(s=l[c++],s!=s)return!0}else for(;u>c;c++)if((e||c in l)&&l[c]===n)return e||c||0;return!e&&-1}}},c526:function(e,t){var n={axisPointer:1,tooltip:1,brush:1};function i(e,t,i){var r=t.getComponentByElement(e.topTarget),a=r&&r.coordinateSystem;return r&&r!==i&&!n[r.mainType]&&a&&a.model!==i}t.onIrrelevantElement=i},c533:function(e,t){var n=["#37A2DA","#32C5E9","#67E0E3","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#E062AE","#E690D1","#e7bcf3","#9d96f5","#8378EA","#96BFFF"],i={color:n,colorLayer:[["#37A2DA","#ffd85c","#fd7b5f"],["#37A2DA","#67E0E3","#FFDB5C","#ff9f7f","#E062AE","#9d96f5"],["#37A2DA","#32C5E9","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#e7bcf3","#8378EA","#96BFFF"],n]};e.exports=i},c5f6:function(e,t,n){"use strict";var i=n("7726"),r=n("69a8"),a=n("2d95"),o=n("5dbc"),s=n("6a99"),l=n("79e5"),u=n("9093").f,c=n("11e9").f,d=n("86cc").f,f=n("aa77").trim,h="Number",p=i[h],g=p,m=p.prototype,v=a(n("2aeb")(m))==h,y="trim"in String.prototype,_=function(e){var t=s(e,!1);if("string"==typeof t&&t.length>2){t=y?t.trim():f(t,3);var n,i,r,a=t.charCodeAt(0);if(43===a||45===a){if(n=t.charCodeAt(2),88===n||120===n)return NaN}else if(48===a){switch(t.charCodeAt(1)){case 66:case 98:i=2,r=49;break;case 79:case 111:i=8,r=55;break;default:return+t}for(var o,l=t.slice(2),u=0,c=l.length;u<c;u++)if(o=l.charCodeAt(u),o<48||o>r)return NaN;return parseInt(l,i)}}return+t};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof p&&(v?l(function(){m.valueOf.call(n)}):a(n)!=h)?o(new g(_(t)),n,p):_(t)};for(var b,E=n("9e1e")?u(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),T=0;E.length>T;T++)r(g,b=E[T])&&!r(p,b)&&d(p,b,c(g,b));p.prototype=m,m.constructor=p,n("2aba")(i,h,p)}},c69a:function(e,t,n){e.exports=!n("9e1e")&&!n("79e5")(function(){return 7!=Object.defineProperty(n("230e")("div"),"a",{get:function(){return 7}}).a})},c775:function(e,t,n){var i=n("2b17"),r=i.retrieveRawValue;function a(e,t){var n=e.mapDimension("defaultedLabel",!0),i=n.length;if(1===i)return r(e,t,n[0]);if(i){for(var a=[],o=0;o<n.length;o++){var s=r(e,t,n[o]);a.push(s)}return a.join(" ")}}t.getDefaultLabel=a},c7a2:function(e,t,n){var i=n("cbe5"),r=n("5693"),a=i.extend({type:"rect",shape:{r:0,x:0,y:0,width:0,height:0},buildPath:function(e,t){var n=t.x,i=t.y,a=t.width,o=t.height;t.r?r.buildPath(e,t):e.rect(n,i,a,o),e.closePath()}});e.exports=a},c8ba:function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"===typeof window&&(n=window)}e.exports=n},ca5a:function(e,t){var n=0,i=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+i).toString(36))}},ca98:function(e,t,n){var i=n("6d8b"),r=n("e0d3"),a=n("6cb7"),o=i.each,s=i.clone,l=i.map,u=i.merge,c=/^(min|max)?(.+)$/;function d(e){this._api=e,this._timelineOptions=[],this._mediaList=[],this._mediaDefault,this._currentMediaIndices=[],this._optionBackup,this._newBaseOption}function f(e,t,n){var r,a,s=[],l=[],u=e.timeline;if(e.baseOption&&(a=e.baseOption),(u||e.options)&&(a=a||{},s=(e.options||[]).slice()),e.media){a=a||{};var c=e.media;o(c,function(e){e&&e.option&&(e.query?l.push(e):r||(r=e))})}return a||(a=e),a.timeline||(a.timeline=u),o([a].concat(s).concat(i.map(l,function(e){return e.option})),function(e){o(t,function(t){t(e,n)})}),{baseOption:a,timelineOptions:s,mediaDefault:r,mediaList:l}}function h(e,t,n){var r={width:t,height:n,aspectratio:t/n},a=!0;return i.each(e,function(e,t){var n=t.match(c);if(n&&n[1]&&n[2]){var i=n[1],o=n[2].toLowerCase();p(r[o],e,i)||(a=!1)}}),a}function p(e,t,n){return"min"===n?e>=t:"max"===n?e<=t:e===t}function g(e,t){return e.join(",")===t.join(",")}function m(e,t){t=t||{},o(t,function(t,n){if(null!=t){var i=e[n];if(a.hasClass(n)){t=r.normalizeToArray(t),i=r.normalizeToArray(i);var o=r.mappingToExists(i,t);e[n]=l(o,function(e){return e.option&&e.exist?u(e.exist,e.option,!0):e.exist||e.option})}else e[n]=u(i,t,!0)}})}d.prototype={constructor:d,setOption:function(e,t){e&&i.each(r.normalizeToArray(e.series),function(e){e&&e.data&&i.isTypedArray(e.data)&&i.setAsPrimitive(e.data)}),e=s(e,!0);var n=this._optionBackup,a=f.call(this,e,t,!n);this._newBaseOption=a.baseOption,n?(m(n.baseOption,a.baseOption),a.timelineOptions.length&&(n.timelineOptions=a.timelineOptions),a.mediaList.length&&(n.mediaList=a.mediaList),a.mediaDefault&&(n.mediaDefault=a.mediaDefault)):this._optionBackup=a},mountOption:function(e){var t=this._optionBackup;return this._timelineOptions=l(t.timelineOptions,s),this._mediaList=l(t.mediaList,s),this._mediaDefault=s(t.mediaDefault),this._currentMediaIndices=[],s(e?t.baseOption:this._newBaseOption)},getTimelineOption:function(e){var t,n=this._timelineOptions;if(n.length){var i=e.getComponent("timeline");i&&(t=s(n[i.getCurrentIndex()],!0))}return t},getMediaOption:function(e){var t=this._api.getWidth(),n=this._api.getHeight(),i=this._mediaList,r=this._mediaDefault,a=[],o=[];if(!i.length&&!r)return o;for(var u=0,c=i.length;u<c;u++)h(i[u].query,t,n)&&a.push(u);return!a.length&&r&&(a=[-1]),a.length&&!g(a,this._currentMediaIndices)&&(o=l(a,function(e){return s(-1===e?r.option:i[e].option)})),this._currentMediaIndices=a,o}};var v=d;e.exports=v},cadf:function(e,t,n){"use strict";var i=n("9c6c"),r=n("d53b"),a=n("84f2"),o=n("6821");e.exports=n("01f9")(Array,"Array",function(e,t){this._t=o(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,r(1)):r(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),a.Arguments=a.Array,i("keys"),i("values"),i("entries")},cb0c:function(e,t,n){"use strict";function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,r){var a=e.apply(t,n);function o(e,t){try{var n=a[e](t),o=n.value}catch(e){return void r(e)}n.done?i(o):Promise.resolve(o).then(s,l)}function s(e){o("next",e)}function l(e){o("throw",e)}s()})}}n.d(t,"a",function(){return i})},cb11:function(e,t,n){var i=n("cbe5"),r=i.extend({type:"line",shape:{x1:0,y1:0,x2:0,y2:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function(e,t){var n=t.x1,i=t.y1,r=t.x2,a=t.y2,o=t.percent;0!==o&&(e.moveTo(n,i),o<1&&(r=n*(1-o)+r*o,a=i*(1-o)+a*o),e.lineTo(r,a))},pointAt:function(e){var t=this.shape;return[t.x1*(1-e)+t.x2*e,t.y1*(1-e)+t.y2*e]}});e.exports=r},cb6d:function(e,t){function n(){this.on("mousedown",this._dragStart,this),this.on("mousemove",this._drag,this),this.on("mouseup",this._dragEnd,this),this.on("globalout",this._dragEnd,this)}function i(e,t){return{target:e,topTarget:t&&t.topTarget}}n.prototype={constructor:n,_dragStart:function(e){var t=e.target;t&&t.draggable&&(this._draggingTarget=t,t.dragging=!0,this._x=e.offsetX,this._y=e.offsetY,this.dispatchToElement(i(t,e),"dragstart",e.event))},_drag:function(e){var t=this._draggingTarget;if(t){var n=e.offsetX,r=e.offsetY,a=n-this._x,o=r-this._y;this._x=n,this._y=r,t.drift(a,o,e),this.dispatchToElement(i(t,e),"drag",e.event);var s=this.findHover(n,r,t).target,l=this._dropTarget;this._dropTarget=s,t!==s&&(l&&s!==l&&this.dispatchToElement(i(l,e),"dragleave",e.event),s&&s!==l&&this.dispatchToElement(i(s,e),"dragenter",e.event))}},_dragEnd:function(e){var t=this._draggingTarget;t&&(t.dragging=!1),this.dispatchToElement(i(t,e),"dragend",e.event),this._dropTarget&&this.dispatchToElement(i(this._dropTarget,e),"drop",e.event),this._draggingTarget=null,this._dropTarget=null}};var r=n;e.exports=r},cb7c:function(e,t,n){var i=n("d3f4");e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},cb8f:function(e,t,n){var i=n("3eba"),r=n("6d8b"),a=n("cd33"),o=n("eb6b");n("48ac"),n("d4b1"),n("4a9d"),i.registerPreprocessor(function(e){if(e){(!e.axisPointer||0===e.axisPointer.length)&&(e.axisPointer={});var t=e.axisPointer.link;t&&!r.isArray(t)&&(e.axisPointer.link=[t])}}),i.registerProcessor(i.PRIORITY.PROCESSOR.STATISTIC,function(e,t){e.getComponent("axisPointer").coordSysAxesInfo=a.collect(e,t)}),i.registerAction({type:"updateAxisPointer",event:"updateAxisPointer",update:":updateAxisPointer"},o)},cbe5:function(e,t,n){var i=n("19eb"),r=n("6d8b"),a=n("20c8"),o=n("d833"),s=n("dc2f"),l=s.prototype.getCanvasPattern,u=Math.abs,c=new a(!0);function d(e){i.call(this,e),this.path=null}d.prototype={constructor:d,type:"path",__dirtyPath:!0,strokeContainThreshold:5,brush:function(e,t){var n,i=this.style,r=this.path||c,a=i.hasStroke(),o=i.hasFill(),s=i.fill,u=i.stroke,d=o&&!!s.colorStops,f=a&&!!u.colorStops,h=o&&!!s.image,p=a&&!!u.image;(i.bind(e,this,t),this.setTransform(e),this.__dirty)&&(d&&(n=n||this.getBoundingRect(),this._fillGradient=i.getGradient(e,s,n)),f&&(n=n||this.getBoundingRect(),this._strokeGradient=i.getGradient(e,u,n)));d?e.fillStyle=this._fillGradient:h&&(e.fillStyle=l.call(s,e)),f?e.strokeStyle=this._strokeGradient:p&&(e.strokeStyle=l.call(u,e));var g=i.lineDash,m=i.lineDashOffset,v=!!e.setLineDash,y=this.getGlobalScale();r.setScale(y[0],y[1]),this.__dirtyPath||g&&!v&&a?(r.beginPath(e),g&&!v&&(r.setLineDash(g),r.setLineDashOffset(m)),this.buildPath(r,this.shape,!1),this.path&&(this.__dirtyPath=!1)):(e.beginPath(),this.path.rebuildPath(e)),o&&r.fill(e),g&&v&&(e.setLineDash(g),e.lineDashOffset=m),a&&r.stroke(e),g&&v&&e.setLineDash([]),null!=i.text&&(this.restoreTransform(e),this.drawRectText(e,this.getBoundingRect()))},buildPath:function(e,t,n){},createPathProxy:function(){this.path=new a},getBoundingRect:function(){var e=this._rect,t=this.style,n=!e;if(n){var i=this.path;i||(i=this.path=new a),this.__dirtyPath&&(i.beginPath(),this.buildPath(i,this.shape,!1)),e=i.getBoundingRect()}if(this._rect=e,t.hasStroke()){var r=this._rectWithStroke||(this._rectWithStroke=e.clone());if(this.__dirty||n){r.copy(e);var o=t.lineWidth,s=t.strokeNoScale?this.getLineScale():1;t.hasFill()||(o=Math.max(o,this.strokeContainThreshold||4)),s>1e-10&&(r.width+=o/s,r.height+=o/s,r.x-=o/s/2,r.y-=o/s/2)}return r}return e},contain:function(e,t){var n=this.transformCoordToLocal(e,t),i=this.getBoundingRect(),r=this.style;if(e=n[0],t=n[1],i.contain(e,t)){var a=this.path.data;if(r.hasStroke()){var s=r.lineWidth,l=r.strokeNoScale?this.getLineScale():1;if(l>1e-10&&(r.hasFill()||(s=Math.max(s,this.strokeContainThreshold)),o.containStroke(a,s/l,e,t)))return!0}if(r.hasFill())return o.contain(a,e,t)}return!1},dirty:function(e){null==e&&(e=!0),e&&(this.__dirtyPath=e,this._rect=null),this.__dirty=!0,this.__zr&&this.__zr.refresh(),this.__clipTarget&&this.__clipTarget.dirty()},animateShape:function(e){return this.animate("shape",e)},attrKV:function(e,t){"shape"===e?(this.setShape(t),this.__dirtyPath=!0,this._rect=null):i.prototype.attrKV.call(this,e,t)},setShape:function(e,t){var n=this.shape;if(n){if(r.isObject(e))for(var i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);else n[e]=t;this.dirty(!0)}return this},getLineScale:function(){var e=this.transform;return e&&u(e[0]-1)>1e-10&&u(e[3]-1)>1e-10?Math.sqrt(u(e[0]*e[3]-e[2]*e[1])):1}},d.extend=function(e){var t=function(t){d.call(this,t),e.style&&this.style.extendFrom(e.style,!1);var n=e.shape;if(n){this.shape=this.shape||{};var i=this.shape;for(var r in n)!i.hasOwnProperty(r)&&n.hasOwnProperty(r)&&(i[r]=n[r])}e.init&&e.init.call(this,t)};for(var n in r.inherits(t,d),e)"style"!==n&&"shape"!==n&&(t.prototype[n]=e[n]);return t},r.inherits(d,i);var f=d;e.exports=f},cbe9:function(e,t,n){var i=n("6d8b"),r=n("cf7e");function a(e){r.call(this,e)}a.prototype={constructor:a,type:"cartesian2d",dimensions:["x","y"],getBaseAxis:function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x")},containPoint:function(e){var t=this.getAxis("x"),n=this.getAxis("y");return t.contain(t.toLocalCoord(e[0]))&&n.contain(n.toLocalCoord(e[1]))},containData:function(e){return this.getAxis("x").containData(e[0])&&this.getAxis("y").containData(e[1])},dataToPoint:function(e,t,n){var i=this.getAxis("x"),r=this.getAxis("y");return n=n||[],n[0]=i.toGlobalCoord(i.dataToCoord(e[0])),n[1]=r.toGlobalCoord(r.dataToCoord(e[1])),n},clampData:function(e,t){var n=this.getAxis("x").scale,i=this.getAxis("y").scale,r=n.getExtent(),a=i.getExtent(),o=n.parse(e[0]),s=i.parse(e[1]);return t=t||[],t[0]=Math.min(Math.max(Math.min(r[0],r[1]),o),Math.max(r[0],r[1])),t[1]=Math.min(Math.max(Math.min(a[0],a[1]),s),Math.max(a[0],a[1])),t},pointToData:function(e,t){var n=this.getAxis("x"),i=this.getAxis("y");return t=t||[],t[0]=n.coordToData(n.toLocalCoord(e[0])),t[1]=i.coordToData(i.toLocalCoord(e[1])),t},getOtherAxis:function(e){return this.getAxis("x"===e.dim?"y":"x")}},i.inherits(a,r);var o=a;e.exports=o},cc39:function(e,t,n){var i=n("6d8b"),r=n("3842"),a=n("50e5"),o=i.each,s=r.asc,l=function(e,t,n,i){this._dimName=e,this._axisIndex=t,this._valueWindow,this._percentWindow,this._dataExtent,this._minMaxSpan,this.ecModel=i,this._dataZoomModel=n};function u(e,t,n){var i=[1/0,-1/0];return o(n,function(e){var n=e.getData();n&&o(n.mapDimension(t,!0),function(e){var t=n.getApproximateExtent(e);t[0]<i[0]&&(i[0]=t[0]),t[1]>i[1]&&(i[1]=t[1])})}),i[1]<i[0]&&(i=[NaN,NaN]),c(e,i),i}function c(e,t){var n=e.getAxisModel(),i=n.getMin(!0),r="category"===n.get("type"),a=r&&n.getCategories().length;null!=i&&"dataMin"!==i&&"function"!==typeof i?t[0]=i:r&&(t[0]=a>0?0:NaN);var o=n.getMax(!0);return null!=o&&"dataMax"!==o&&"function"!==typeof o?t[1]=o:r&&(t[1]=a>0?a-1:NaN),n.get("scale",!0)||(t[0]>0&&(t[0]=0),t[1]<0&&(t[1]=0)),t}function d(e,t){var n=e.getAxisModel(),i=e._percentWindow,a=e._valueWindow;if(i){var o=r.getPixelPrecision(a,[0,500]);o=Math.min(o,20);var s=t||0===i[0]&&100===i[1];n.setRange(s?null:+a[0].toFixed(o),s?null:+a[1].toFixed(o))}}function f(e){var t=e._minMaxSpan={},n=e._dataZoomModel;o(["min","max"],function(i){t[i+"Span"]=n.get(i+"Span");var a=n.get(i+"ValueSpan");if(null!=a&&(t[i+"ValueSpan"]=a,a=e.getAxisModel().axis.scale.parse(a),null!=a)){var o=e._dataExtent;t[i+"Span"]=r.linearMap(o[0]+a,o,[0,100],!0)}})}l.prototype={constructor:l,hostedBy:function(e){return this._dataZoomModel===e},getDataValueWindow:function(){return this._valueWindow.slice()},getDataPercentWindow:function(){return this._percentWindow.slice()},getTargetSeriesModels:function(){var e=[],t=this.ecModel;return t.eachSeries(function(n){if(a.isCoordSupported(n.get("coordinateSystem"))){var i=this._dimName,r=t.queryComponents({mainType:i+"Axis",index:n.get(i+"AxisIndex"),id:n.get(i+"AxisId")})[0];this._axisIndex===(r&&r.componentIndex)&&e.push(n)}},this),e},getAxisModel:function(){return this.ecModel.getComponent(this._dimName+"Axis",this._axisIndex)},getOtherAxisModel:function(){var e,t,n,i=this._dimName,r=this.ecModel,a=this.getAxisModel(),o="x"===i||"y"===i;return o?(t="gridIndex",e="x"===i?"y":"x"):(t="polarIndex",e="angle"===i?"radius":"angle"),r.eachComponent(e+"Axis",function(e){(e.get(t)||0)===(a.get(t)||0)&&(n=e)}),n},getMinMaxSpan:function(){return i.clone(this._minMaxSpan)},calculateDataWindow:function(e){var t=this._dataExtent,n=this.getAxisModel(),i=n.axis.scale,a=this._dataZoomModel.getRangePropMode(),l=[0,100],u=[e.start,e.end],c=[];return o(["startValue","endValue"],function(t){c.push(null!=e[t]?i.parse(e[t]):null)}),o([0,1],function(e){var n=c[e],o=u[e];"percent"===a[e]?(null==o&&(o=l[e]),n=i.parse(r.linearMap(o,l,t,!0))):o=r.linearMap(n,t,l,!0),c[e]=n,u[e]=o}),{valueWindow:s(c),percentWindow:s(u)}},reset:function(e){if(e===this._dataZoomModel){var t=this.getTargetSeriesModels();this._dataExtent=u(this,this._dimName,t);var n=this.calculateDataWindow(e.option);this._valueWindow=n.valueWindow,this._percentWindow=n.percentWindow,f(this),d(this)}},restore:function(e){e===this._dataZoomModel&&(this._valueWindow=this._percentWindow=null,d(this,!0))},filterData:function(e,t){if(e===this._dataZoomModel){var n=this._dimName,i=this.getTargetSeriesModels(),r=e.get("filterMode"),a=this._valueWindow;"none"!==r&&o(i,function(e){var t=e.getData(),i=t.mapDimension(n,!0);"weakFilter"===r?t.filterSelf(function(e){for(var n,r,o,s=0;s<i.length;s++){var l=t.get(i[s],e),u=!isNaN(l),c=l<a[0],d=l>a[1];if(u&&!c&&!d)return!0;u&&(o=!0),c&&(n=!0),d&&(r=!0)}return o&&n&&r}):o(i,function(n){if("empty"===r)e.setData(t.map(n,function(e){return s(e)?e:NaN}));else{var i={};i[n]=a,t.selectRange(i)}}),o(i,function(e){t.setApproximateExtent(a,e)})})}function s(e){return e>=a[0]&&e<=a[1]}}};var h=l;e.exports=h},cccd:function(e,t,n){var i=n("e0d3"),r=i.makeInner;function a(){var e=r();return function(t){var n=e(t),i=t.pipelineContext,r=n.large,a=n.progressiveRender,o=n.large=i.large,s=n.progressiveRender=i.progressiveRender;return!!(r^o||a^s)&&"reset"}}e.exports=a},cd33:function(e,t,n){var i=n("6d8b"),r=n("4319"),a=i.each,o=i.curry;function s(e,t){var n={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return l(n,e,t),n.seriesInvolved&&c(n,e),n}function l(e,t,n){var i=t.getComponent("tooltip"),r=t.getComponent("axisPointer"),s=r.get("link",!0)||[],l=[];a(n.getCoordinateSystems(),function(n){if(n.axisPointerEnabled){var c=v(n.model),f=e.coordSysAxesInfo[c]={};e.coordSysMap[c]=n;var h=n.model,p=h.getModel("tooltip",i);if(a(n.getAxes(),o(b,!1,null)),n.getTooltipAxes&&i&&p.get("show")){var g="axis"===p.get("trigger"),y="cross"===p.get("axisPointer.type"),_=n.getTooltipAxes(p.get("axisPointer.axis"));(g||y)&&a(_.baseAxes,o(b,!y||"cross",g)),y&&a(_.otherAxes,o(b,"cross",!1))}}function b(i,a,o){var c=o.model.getModel("axisPointer",r),h=c.get("show");if(h&&("auto"!==h||i||m(c))){null==a&&(a=c.get("triggerTooltip")),c=i?u(o,p,r,t,i,a):c;var g=c.get("snap"),y=v(o.model),_=a||g||"category"===o.type,b=e.axesInfo[y]={key:y,axis:o,coordSys:n,axisPointerModel:c,triggerTooltip:a,involveSeries:_,snap:g,useHandle:m(c),seriesModels:[]};f[y]=b,e.seriesInvolved|=_;var E=d(s,o);if(null!=E){var T=l[E]||(l[E]={axesInfo:{}});T.axesInfo[y]=b,T.mapper=s[E].mapper,b.linkGroup=T}}}})}function u(e,t,n,o,s,l){var u=t.getModel("axisPointer"),c={};a(["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],function(e){c[e]=i.clone(u.get(e))}),c.snap="category"!==e.type&&!!l,"cross"===u.get("type")&&(c.type="line");var d=c.label||(c.label={});if(null==d.show&&(d.show=!1),"cross"===s){var f=u.get("label.show");if(d.show=null==f||f,!l){var h=c.lineStyle=u.get("crossStyle");h&&i.defaults(d,h.textStyle)}}return e.model.getModel("axisPointer",new r(c,n,o))}function c(e,t){t.eachSeries(function(t){var n=t.coordinateSystem,i=t.get("tooltip.trigger",!0),r=t.get("tooltip.show",!0);n&&"none"!==i&&!1!==i&&"item"!==i&&!1!==r&&!1!==t.get("axisPointer.show",!0)&&a(e.coordSysAxesInfo[v(n.model)],function(e){var i=e.axis;n.getAxis(i.dim)===i&&(e.seriesModels.push(t),null==e.seriesDataCount&&(e.seriesDataCount=0),e.seriesDataCount+=t.getData().count())})},this)}function d(e,t){for(var n=t.model,i=t.dim,r=0;r<e.length;r++){var a=e[r]||{};if(f(a[i+"AxisId"],n.id)||f(a[i+"AxisIndex"],n.componentIndex)||f(a[i+"AxisName"],n.name))return r}}function f(e,t){return"all"===e||i.isArray(e)&&i.indexOf(e,t)>=0||e===t}function h(e){var t=p(e);if(t){var n=t.axisPointerModel,i=t.axis.scale,r=n.option,a=n.get("status"),o=n.get("value");null!=o&&(o=i.parse(o));var s=m(n);null==a&&(r.status=s?"show":"hide");var l=i.getExtent().slice();l[0]>l[1]&&l.reverse(),(null==o||o>l[1])&&(o=l[1]),o<l[0]&&(o=l[0]),r.value=o,s&&(r.status=t.axis.scale.isBlank()?"hide":"show")}}function p(e){var t=(e.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return t&&t.axesInfo[v(e)]}function g(e){var t=p(e);return t&&t.axisPointerModel}function m(e){return!!e.get("handle.show")}function v(e){return e.type+"||"+e.id}t.collect=s,t.fixValue=h,t.getAxisInfo=p,t.getAxisPointerModel=g,t.makeKey=v},cdaa:function(e,t,n){var i=n("607d"),r=i.addEventListener,a=i.removeEventListener,o=i.normalizeEvent,s=n("6d8b"),l=n("1fab"),u=n("22d1"),c=n("0b44"),d=300,f=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],h=["touchstart","touchend","touchmove"],p={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},g=s.map(f,function(e){var t=e.replace("mouse","pointer");return p[t]?t:e});function m(e){return"mousewheel"===e&&u.browser.firefox?"DOMMouseScroll":e}function v(e,t,n){var i=e._gestureMgr;"start"===n&&i.clear();var r=i.recognize(t,e.handler.findHover(t.zrX,t.zrY,null).target,e.dom);if("end"===n&&i.clear(),r){var a=r.type;t.gestureEvent=a,e.handler.dispatchToElement({target:r.target},a,r.event)}}function y(e){e._touching=!0,clearTimeout(e._touchTimer),e._touchTimer=setTimeout(function(){e._touching=!1},700)}var _={mousemove:function(e){e=o(this.dom,e),this.trigger("mousemove",e)},mouseout:function(e){e=o(this.dom,e);var t=e.toElement||e.relatedTarget;if(t!=this.dom)while(t&&9!=t.nodeType){if(t===this.dom)return;t=t.parentNode}this.trigger("mouseout",e)},touchstart:function(e){e=o(this.dom,e),e.zrByTouch=!0,this._lastTouchMoment=new Date,v(this,e,"start"),_.mousemove.call(this,e),_.mousedown.call(this,e),y(this)},touchmove:function(e){e=o(this.dom,e),e.zrByTouch=!0,v(this,e,"change"),_.mousemove.call(this,e),y(this)},touchend:function(e){e=o(this.dom,e),e.zrByTouch=!0,v(this,e,"end"),_.mouseup.call(this,e),+new Date-this._lastTouchMoment<d&&_.click.call(this,e),y(this)},pointerdown:function(e){_.mousedown.call(this,e)},pointermove:function(e){b(e)||_.mousemove.call(this,e)},pointerup:function(e){_.mouseup.call(this,e)},pointerout:function(e){b(e)||_.mouseout.call(this,e)}};function b(e){var t=e.pointerType;return"pen"===t||"touch"===t}function E(e){function t(e,t){return function(){if(!t._touching)return e.apply(t,arguments)}}s.each(h,function(t){e._handlers[t]=s.bind(_[t],e)}),s.each(g,function(t){e._handlers[t]=s.bind(_[t],e)}),s.each(f,function(n){e._handlers[n]=t(_[n],e)})}function T(e){function t(t,n){s.each(t,function(t){r(e,m(t),n._handlers[t])},n)}l.call(this),this.dom=e,this._touching=!1,this._touchTimer,this._gestureMgr=new c,this._handlers={},E(this),u.pointerEventsSupported?t(g,this):(u.touchEventsSupported&&t(h,this),t(f,this))}s.each(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(e){_[e]=function(t){t=o(this.dom,t),this.trigger(e,t)}});var S=T.prototype;S.dispose=function(){for(var e=f.concat(h),t=0;t<e.length;t++){var n=e[t];a(this.dom,m(n),this._handlers[n])}},S.setCursor=function(e){this.dom.style&&(this.dom.style.cursor=e||"default")},s.mixin(T,l);var w=T;e.exports=w},ce10:function(e,t,n){var i=n("69a8"),r=n("6821"),a=n("c366")(!1),o=n("613b")("IE_PROTO");e.exports=function(e,t){var n,s=r(e),l=0,u=[];for(n in s)n!=o&&i(s,n)&&u.push(n);while(t.length>l)i(s,n=t[l++])&&(~a(u,n)||u.push(n));return u}},cf7e:function(e,t,n){var i=n("6d8b");function r(e){return this._axes[e]}var a=function(e){this._axes={},this._dimList=[],this.name=e||""};a.prototype={constructor:a,type:"cartesian",getAxis:function(e){return this._axes[e]},getAxes:function(){return i.map(this._dimList,r,this)},getAxesByScale:function(e){return e=e.toLowerCase(),i.filter(this.getAxes(),function(t){return t.scale.type===e})},addAxis:function(e){var t=e.dim;this._axes[t]=e,this._dimList.push(t)},dataToCoord:function(e){return this._dataCoordConvert(e,"dataToCoord")},coordToData:function(e){return this._dataCoordConvert(e,"coordToData")},_dataCoordConvert:function(e,t){for(var n=this._dimList,i=e instanceof Array?[]:{},r=0;r<n.length;r++){var a=n[r],o=this._axes[a];i[a]=o[t](e[a])}return i}};var o=a;e.exports=o},d136:function(e,t,n){(function(t){var n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,i=/^(?=([^\/?#]*))\1([^]*)$/,r=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,o={buildAbsoluteURL:function(e,t,n){if(n=n||{},e=e.trim(),t=t.trim(),!t){if(!n.alwaysNormalize)return e;var r=o.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=o.normalizePath(r.path),o.buildURLFromParts(r)}var a=o.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return n.alwaysNormalize?(a.path=o.normalizePath(a.path),o.buildURLFromParts(a)):t;var s=o.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var l=i.exec(s.path);s.netLoc=l[1],s.path=l[2]}s.netLoc&&!s.path&&(s.path="/");var u={scheme:s.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(u.netLoc=s.netLoc,"/"!==a.path[0]))if(a.path){var c=s.path,d=c.substring(0,c.lastIndexOf("/")+1)+a.path;u.path=o.normalizePath(d)}else u.path=s.path,a.params||(u.params=s.params,a.query||(u.query=s.query));return null===u.path&&(u.path=n.alwaysNormalize?o.normalizePath(a.path):a.path),o.buildURLFromParts(u)},parseURL:function(e){var t=n.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){e=e.split("").reverse().join("").replace(r,"");while(e.length!==(e=e.replace(a,"")).length);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};e.exports=o})()},d15d:function(e,t,n){var i=n("6d8b"),r=i.createHashMap,a=i.each;function o(e){var t=r();e.eachSeries(function(e){var n=e.get("stack");if(n){var i=t.get(n)||t.set(n,[]),r=e.getData(),a={stackResultDimension:r.getCalculationInfo("stackResultDimension"),stackedOverDimension:r.getCalculationInfo("stackedOverDimension"),stackedDimension:r.getCalculationInfo("stackedDimension"),stackedByDimension:r.getCalculationInfo("stackedByDimension"),isStackedByIndex:r.getCalculationInfo("isStackedByIndex"),data:r,seriesModel:e};if(!a.stackedDimension||!a.isStackedByIndex&&!a.stackedByDimension)return;i.length&&r.setCalculationInfo("stackedOnSeries",i[i.length-1].seriesModel),i.push(a)}}),t.each(s)}function s(e){a(e,function(t,n){var i=[],r=[NaN,NaN],a=[t.stackResultDimension,t.stackedOverDimension],o=t.data,s=t.isStackedByIndex,l=o.map(a,function(a,l,u){var c,d,f=o.get(t.stackedDimension,u);if(isNaN(f))return r;s?d=o.getRawIndex(u):c=o.get(t.stackedByDimension,u);for(var h=NaN,p=n-1;p>=0;p--){var g=e[p];if(s||(d=g.data.rawIndexOf(g.stackedByDimension,c)),d>=0){var m=g.data.getByRawIndex(g.stackResultDimension,d);if(f>=0&&m>0||f<=0&&m<0){f+=m,h=m;break}}}return i[0]=f,i[1]=h,i});o.hostModel.setData(l),t.data=l})}e.exports=o},d28f:function(e,t,n){var i=n("3eba");n("84d5"),n("4650"),n("5e97");var r=n("903c"),a=n("6cb7");i.registerProcessor(r),a.registerSubTypeDefaulter("legend",function(){return"plain"})},d2c8:function(e,t,n){var i=n("aae3"),r=n("be13");e.exports=function(e,t,n){if(i(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(r(e))}},d2cf:function(e,t,n){var i=n("6d8b"),r=n("401b"),a=n("cb6d"),o=n("1fab"),s="silent";function l(e,t,n){return{type:e,event:n,target:t.target,topTarget:t.topTarget,cancelBubble:!1,offsetX:n.zrX,offsetY:n.zrY,gestureEvent:n.gestureEvent,pinchX:n.pinchX,pinchY:n.pinchY,pinchScale:n.pinchScale,wheelDelta:n.zrDelta,zrByTouch:n.zrByTouch,which:n.which}}function u(){}u.prototype.dispose=function(){};var c=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],d=function(e,t,n,i){o.call(this),this.storage=e,this.painter=t,this.painterRoot=i,n=n||new u,this.proxy=null,this._hovered={},this._lastTouchMoment,this._lastX,this._lastY,a.call(this),this.setHandlerProxy(n)};function f(e,t,n){if(e[e.rectHover?"rectContain":"contain"](t,n)){var i,r=e;while(r){if(r.clipPath&&!r.clipPath.contain(t,n))return!1;r.silent&&(i=!0),r=r.parent}return!i||s}return!1}d.prototype={constructor:d,setHandlerProxy:function(e){this.proxy&&this.proxy.dispose(),e&&(i.each(c,function(t){e.on&&e.on(t,this[t],this)},this),e.handler=this),this.proxy=e},mousemove:function(e){var t=e.zrX,n=e.zrY,i=this._hovered,r=i.target;r&&!r.__zr&&(i=this.findHover(i.x,i.y),r=i.target);var a=this._hovered=this.findHover(t,n),o=a.target,s=this.proxy;s.setCursor&&s.setCursor(o?o.cursor:"default"),r&&o!==r&&this.dispatchToElement(i,"mouseout",e),this.dispatchToElement(a,"mousemove",e),o&&o!==r&&this.dispatchToElement(a,"mouseover",e)},mouseout:function(e){this.dispatchToElement(this._hovered,"mouseout",e);var t,n=e.toElement||e.relatedTarget;do{n=n&&n.parentNode}while(n&&9!=n.nodeType&&!(t=n===this.painterRoot));!t&&this.trigger("globalout",{event:e})},resize:function(e){this._hovered={}},dispatch:function(e,t){var n=this[e];n&&n.call(this,t)},dispose:function(){this.proxy.dispose(),this.storage=this.proxy=this.painter=null},setCursorStyle:function(e){var t=this.proxy;t.setCursor&&t.setCursor(e)},dispatchToElement:function(e,t,n){e=e||{};var i=e.target;if(!i||!i.silent){var r="on"+t,a=l(t,e,n);while(i)if(i[r]&&(a.cancelBubble=i[r].call(i,a)),i.trigger(t,a),i=i.parent,a.cancelBubble)break;a.cancelBubble||(this.trigger(t,a),this.painter&&this.painter.eachOtherLayer(function(e){"function"==typeof e[r]&&e[r].call(e,a),e.trigger&&e.trigger(t,a)}))}},findHover:function(e,t,n){for(var i=this.storage.getDisplayList(),r={x:e,y:t},a=i.length-1;a>=0;a--){var o;if(i[a]!==n&&!i[a].ignore&&(o=f(i[a],e,t))&&(!r.topTarget&&(r.topTarget=i[a]),o!==s)){r.target=i[a];break}}return r}},i.each(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(e){d.prototype[e]=function(t){var n=this.findHover(t.zrX,t.zrY),i=n.target;if("mousedown"===e)this._downEl=i,this._downPoint=[t.zrX,t.zrY],this._upEl=i;else if("mouseup"===e)this._upEl=i;else if("click"===e){if(this._downEl!==this._upEl||!this._downPoint||r.dist(this._downPoint,[t.zrX,t.zrY])>4)return;this._downPoint=null}this.dispatchToElement(n,e,t)}}),i.mixin(d,o),i.mixin(d,a);var h=d;e.exports=h},d3a0:function(e,t,n){var i=n("3eba"),r=n("6d8b"),a=n("29a8"),o=n("2145"),s=a.toolbox.magicType;function l(e){this.model=e}l.defaultOption={show:!0,type:[],icon:{line:"M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4",bar:"M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7",stack:"M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z",tiled:"M2.3,2.2h22.8V25H2.3V2.2z M35,2.2h22.8V25H35V2.2zM2.3,35h22.8v22.8H2.3V35z M35,35h22.8v22.8H35V35z"},title:r.clone(s.title),option:{},seriesIndex:{}};var u=l.prototype;u.getIcons=function(){var e=this.model,t=e.get("icon"),n={};return r.each(e.get("type"),function(e){t[e]&&(n[e]=t[e])}),n};var c={line:function(e,t,n,i){if("bar"===e)return r.merge({id:t,type:"line",data:n.get("data"),stack:n.get("stack"),markPoint:n.get("markPoint"),markLine:n.get("markLine")},i.get("option.line")||{},!0)},bar:function(e,t,n,i){if("line"===e)return r.merge({id:t,type:"bar",data:n.get("data"),stack:n.get("stack"),markPoint:n.get("markPoint"),markLine:n.get("markLine")},i.get("option.bar")||{},!0)},stack:function(e,t,n,i){if("line"===e||"bar"===e)return r.merge({id:t,stack:"__ec_magicType_stack__"},i.get("option.stack")||{},!0)},tiled:function(e,t,n,i){if("line"===e||"bar"===e)return r.merge({id:t,stack:""},i.get("option.tiled")||{},!0)}},d=[["line","bar"],["stack","tiled"]];u.onclick=function(e,t,n){var i=this.model,a=i.get("seriesIndex."+n);if(c[n]){var o={series:[]},s=function(t){var a=t.subType,s=t.id,l=c[n](a,s,t,i);l&&(r.defaults(l,t.option),o.series.push(l));var u=t.coordinateSystem;if(u&&"cartesian2d"===u.type&&("line"===n||"bar"===n)){var d=u.getAxesByScale("ordinal")[0];if(d){var f=d.dim,h=f+"Axis",p=e.queryComponents({mainType:h,index:t.get(name+"Index"),id:t.get(name+"Id")})[0],g=p.componentIndex;o[h]=o[h]||[];for(var m=0;m<=g;m++)o[h][g]=o[h][g]||{};o[h][g].boundaryGap="bar"===n}}};r.each(d,function(e){r.indexOf(e,n)>=0&&r.each(e,function(e){i.setIconStatus(e,"normal")})}),i.setIconStatus(n,"emphasis"),e.eachComponent({mainType:"series",query:null==a?null:{seriesIndex:a}},s),t.dispatchAction({type:"changeMagicType",currentType:n,newOption:o})}},i.registerAction({type:"changeMagicType",event:"magicTypeChanged",update:"prepareAndUpdate"},function(e,t){t.mergeOption(e.newOption)}),o.register("magicType",l);var f=l;e.exports=f},d3f4:function(e,t){e.exports=function(e){return"object"===typeof e?null!==e:"function"===typeof e}},d498:function(e,t,n){var i=n("cbe5"),r=n("4fac"),a=i.extend({type:"polyline",shape:{points:null,smooth:!1,smoothConstraint:null},style:{stroke:"#000",fill:null},buildPath:function(e,t){r.buildPath(e,t,!1)}});e.exports=a},d4b1:function(e,t,n){var i=n("3eba"),r=n("17d6"),a=i.extendComponentView({type:"axisPointer",render:function(e,t,n){var i=t.getComponent("tooltip"),a=e.get("triggerOn")||i&&i.get("triggerOn")||"mousemove|click";r.register("axisPointer",n,function(e,t,n){"none"!==a&&("leave"===e||a.indexOf(e)>=0)&&n({type:"updateAxisPointer",currTrigger:e,x:t&&t.offsetX,y:t&&t.offsetY})})},remove:function(e,t){r.unregister(t.getZr(),"axisPointer"),a.superApply(this._model,"remove",arguments)},dispose:function(e,t){r.unregister("axisPointer",t),a.superApply(this._model,"dispose",arguments)}}),o=a;e.exports=o},d4c6:function(e,t,n){var i=n("cbe5"),r=i.extend({type:"compound",shape:{paths:null},_updatePathDirty:function(){for(var e=this.__dirtyPath,t=this.shape.paths,n=0;n<t.length;n++)e=e||t[n].__dirtyPath;this.__dirtyPath=e,this.__dirty=this.__dirty||e},beforeBrush:function(){this._updatePathDirty();for(var e=this.shape.paths||[],t=this.getGlobalScale(),n=0;n<e.length;n++)e[n].path||e[n].createPathProxy(),e[n].path.setScale(t[0],t[1])},buildPath:function(e,t){for(var n=t.paths||[],i=0;i<n.length;i++)n[i].buildPath(e,n[i].shape,!0)},afterBrush:function(){for(var e=this.shape.paths||[],t=0;t<e.length;t++)e[t].__dirtyPath=!1},getBoundingRect:function(){return this._updatePathDirty(),i.prototype.getBoundingRect.call(this)}});e.exports=r},d4d1:function(e,t,n){var i=n("cbe5"),r=n("401b"),a=n("897a"),o=r.min,s=r.max,l=r.scaleAndAdd,u=r.copy,c=[],d=[],f=[];function h(e){return isNaN(e[0])||isNaN(e[1])}function p(e,t,n,i,r,a,o,s,l,u,c){return"none"!==u&&u?g.apply(this,arguments):m.apply(this,arguments)}function g(e,t,n,i,r,a,o,s,l,c,p){for(var g=0,m=n,v=0;v<i;v++){var y=t[m];if(m>=r||m<0)break;if(h(y)){if(p){m+=a;continue}break}if(m===n)e[a>0?"moveTo":"lineTo"](y[0],y[1]);else if(l>0){var _=t[g],b="y"===c?1:0,E=(y[b]-_[b])*l;u(d,_),d[b]=_[b]+E,u(f,y),f[b]=y[b]-E,e.bezierCurveTo(d[0],d[1],f[0],f[1],y[0],y[1])}else e.lineTo(y[0],y[1]);g=m,m+=a}return v}function m(e,t,n,i,a,p,g,m,v,y,_){for(var b=0,E=n,T=0;T<i;T++){var S=t[E];if(E>=a||E<0)break;if(h(S)){if(_){E+=p;continue}break}if(E===n)e[p>0?"moveTo":"lineTo"](S[0],S[1]),u(d,S);else if(v>0){var w=E+p,A=t[w];if(_)while(A&&h(t[w]))w+=p,A=t[w];var I=.5,x=t[b];A=t[w];if(!A||h(A))u(f,S);else{var R,C;if(h(A)&&!_&&(A=S),r.sub(c,A,x),"x"===y||"y"===y){var D="x"===y?0:1;R=Math.abs(S[D]-x[D]),C=Math.abs(S[D]-A[D])}else R=r.dist(S,x),C=r.dist(S,A);I=C/(C+R),l(f,S,c,-v*(1-I))}o(d,d,m),s(d,d,g),o(f,f,m),s(f,f,g),e.bezierCurveTo(d[0],d[1],f[0],f[1],S[0],S[1]),l(d,S,c,v*I)}else e.lineTo(S[0],S[1]);b=E,E+=p}return T}function v(e,t){var n=[1/0,1/0],i=[-1/0,-1/0];if(t)for(var r=0;r<e.length;r++){var a=e[r];a[0]<n[0]&&(n[0]=a[0]),a[1]<n[1]&&(n[1]=a[1]),a[0]>i[0]&&(i[0]=a[0]),a[1]>i[1]&&(i[1]=a[1])}return{min:t?n:i,max:t?i:n}}var y=i.extend({type:"ec-polyline",shape:{points:[],smooth:0,smoothConstraint:!0,smoothMonotone:null,connectNulls:!1},style:{fill:null,stroke:"#000"},brush:a(i.prototype.brush),buildPath:function(e,t){var n=t.points,i=0,r=n.length,a=v(n,t.smoothConstraint);if(t.connectNulls){for(;r>0;r--)if(!h(n[r-1]))break;for(;i<r;i++)if(!h(n[i]))break}while(i<r)i+=p(e,n,i,r,r,1,a.min,a.max,t.smooth,t.smoothMonotone,t.connectNulls)+1}}),_=i.extend({type:"ec-polygon",shape:{points:[],stackedOnPoints:[],smooth:0,stackedOnSmooth:0,smoothConstraint:!0,smoothMonotone:null,connectNulls:!1},brush:a(i.prototype.brush),buildPath:function(e,t){var n=t.points,i=t.stackedOnPoints,r=0,a=n.length,o=t.smoothMonotone,s=v(n,t.smoothConstraint),l=v(i,t.smoothConstraint);if(t.connectNulls){for(;a>0;a--)if(!h(n[a-1]))break;for(;r<a;r++)if(!h(n[r]))break}while(r<a){var u=p(e,n,r,a,a,1,s.min,s.max,t.smooth,o,t.connectNulls);p(e,i,r+u-1,u,a,-1,l.min,l.max,t.stackedOnSmooth,o,t.connectNulls),r+=u+1,e.closePath()}}});t.Polyline=y,t.Polygon=_},d51b:function(e,t){var n=function(){this.head=null,this.tail=null,this._len=0},i=n.prototype;i.insert=function(e){var t=new r(e);return this.insertEntry(t),t},i.insertEntry=function(e){this.head?(this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e):this.head=this.tail=e,this._len++},i.remove=function(e){var t=e.prev,n=e.next;t?t.next=n:this.head=n,n?n.prev=t:this.tail=t,e.next=e.prev=null,this._len--},i.len=function(){return this._len},i.clear=function(){this.head=this.tail=null,this._len=0};var r=function(e){this.value=e,this.next,this.prev},a=function(e){this._list=new n,this._map={},this._maxSize=e||10,this._lastRemovedEntry=null},o=a.prototype;o.put=function(e,t){var n=this._list,i=this._map,a=null;if(null==i[e]){var o=n.len(),s=this._lastRemovedEntry;if(o>=this._maxSize&&o>0){var l=n.head;n.remove(l),delete i[l.key],a=l.value,this._lastRemovedEntry=l}s?s.value=t:s=new r(t),s.key=e,n.insertEntry(s),i[e]=s}return a},o.get=function(e){var t=this._map[e],n=this._list;if(null!=t)return t!==n.tail&&(n.remove(t),n.insertEntry(t)),t.value},o.clear=function(){this._list.clear(),this._map={}};var s=a;e.exports=s},d53b:function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},d5b7:function(e,t,n){var i=n("de00"),r=n("1fab"),a=n("0cde"),o=n("bd6b"),s=n("6d8b"),l=function(e){a.call(this,e),r.call(this,e),o.call(this,e),this.id=e.id||i()};l.prototype={type:"element",name:"",__zr:null,ignore:!1,clipPath:null,isGroup:!1,drift:function(e,t){switch(this.draggable){case"horizontal":t=0;break;case"vertical":e=0;break}var n=this.transform;n||(n=this.transform=[1,0,0,1,0,0]),n[4]+=e,n[5]+=t,this.decomposeTransform(),this.dirty(!1)},beforeUpdate:function(){},afterUpdate:function(){},update:function(){this.updateTransform()},traverse:function(e,t){},attrKV:function(e,t){if("position"===e||"scale"===e||"origin"===e){if(t){var n=this[e];n||(n=this[e]=[]),n[0]=t[0],n[1]=t[1]}}else this[e]=t},hide:function(){this.ignore=!0,this.__zr&&this.__zr.refresh()},show:function(){this.ignore=!1,this.__zr&&this.__zr.refresh()},attr:function(e,t){if("string"===typeof e)this.attrKV(e,t);else if(s.isObject(e))for(var n in e)e.hasOwnProperty(n)&&this.attrKV(n,e[n]);return this.dirty(!1),this},setClipPath:function(e){var t=this.__zr;t&&e.addSelfToZr(t),this.clipPath&&this.clipPath!==e&&this.removeClipPath(),this.clipPath=e,e.__zr=t,e.__clipTarget=this,this.dirty(!1)},removeClipPath:function(){var e=this.clipPath;e&&(e.__zr&&e.removeSelfFromZr(e.__zr),e.__zr=null,e.__clipTarget=null,this.clipPath=null,this.dirty(!1))},addSelfToZr:function(e){this.__zr=e;var t=this.animators;if(t)for(var n=0;n<t.length;n++)e.animation.addAnimator(t[n]);this.clipPath&&this.clipPath.addSelfToZr(e)},removeSelfFromZr:function(e){this.__zr=null;var t=this.animators;if(t)for(var n=0;n<t.length;n++)e.animation.removeAnimator(t[n]);this.clipPath&&this.clipPath.removeSelfFromZr(e)}},s.mixin(l,o),s.mixin(l,a),s.mixin(l,r);var u=l;e.exports=u},d708:function(e,t,n){"use strict";var i=n("01e1");const r="undefined"===typeof window&&!i["a"];t["a"]=r},d833:function(e,t,n){var i=n("20c8"),r=n("9680"),a=n("e7d2"),o=n("68ab"),s=n("9f51"),l=n("857d"),u=l.normalizeRadian,c=n("4a3f"),d=n("8728"),f=i.CMD,h=2*Math.PI,p=1e-4;function g(e,t){return Math.abs(e-t)<p}var m=[-1,-1,-1],v=[-1,-1];function y(){var e=v[0];v[0]=v[1],v[1]=e}function _(e,t,n,i,r,a,o,s,l,u){if(u>t&&u>i&&u>a&&u>s||u<t&&u<i&&u<a&&u<s)return 0;var d=c.cubicRootAt(t,i,a,s,u,m);if(0===d)return 0;for(var f,h,p=0,g=-1,_=0;_<d;_++){var b=m[_],E=0===b||1===b?.5:1,T=c.cubicAt(e,n,r,o,b);T<l||(g<0&&(g=c.cubicExtrema(t,i,a,s,v),v[1]<v[0]&&g>1&&y(),f=c.cubicAt(t,i,a,s,v[0]),g>1&&(h=c.cubicAt(t,i,a,s,v[1]))),2==g?b<v[0]?p+=f<t?E:-E:b<v[1]?p+=h<f?E:-E:p+=s<h?E:-E:b<v[0]?p+=f<t?E:-E:p+=s<f?E:-E)}return p}function b(e,t,n,i,r,a,o,s){if(s>t&&s>i&&s>a||s<t&&s<i&&s<a)return 0;var l=c.quadraticRootAt(t,i,a,s,m);if(0===l)return 0;var u=c.quadraticExtremum(t,i,a);if(u>=0&&u<=1){for(var d=0,f=c.quadraticAt(t,i,a,u),h=0;h<l;h++){var p=0===m[h]||1===m[h]?.5:1,g=c.quadraticAt(e,n,r,m[h]);g<o||(m[h]<u?d+=f<t?p:-p:d+=a<f?p:-p)}return d}p=0===m[0]||1===m[0]?.5:1,g=c.quadraticAt(e,n,r,m[0]);return g<o?0:a<t?p:-p}function E(e,t,n,i,r,a,o,s){if(s-=t,s>n||s<-n)return 0;var l=Math.sqrt(n*n-s*s);m[0]=-l,m[1]=l;var c=Math.abs(i-r);if(c<1e-4)return 0;if(c%h<1e-4){i=0,r=h;var d=a?1:-1;return o>=m[0]+e&&o<=m[1]+e?d:0}if(a){l=i;i=u(r),r=u(l)}else i=u(i),r=u(r);i>r&&(r+=h);for(var f=0,p=0;p<2;p++){var g=m[p];if(g+e>o){var v=Math.atan2(s,g);d=a?1:-1;v<0&&(v=h+v),(v>=i&&v<=r||v+h>=i&&v+h<=r)&&(v>Math.PI/2&&v<1.5*Math.PI&&(d=-d),f+=d)}}return f}function T(e,t,n,i,l){for(var u=0,c=0,h=0,p=0,m=0,v=0;v<e.length;){var y=e[v++];switch(y===f.M&&v>1&&(n||(u+=d(c,h,p,m,i,l))),1==v&&(c=e[v],h=e[v+1],p=c,m=h),y){case f.M:p=e[v++],m=e[v++],c=p,h=m;break;case f.L:if(n){if(r.containStroke(c,h,e[v],e[v+1],t,i,l))return!0}else u+=d(c,h,e[v],e[v+1],i,l)||0;c=e[v++],h=e[v++];break;case f.C:if(n){if(a.containStroke(c,h,e[v++],e[v++],e[v++],e[v++],e[v],e[v+1],t,i,l))return!0}else u+=_(c,h,e[v++],e[v++],e[v++],e[v++],e[v],e[v+1],i,l)||0;c=e[v++],h=e[v++];break;case f.Q:if(n){if(o.containStroke(c,h,e[v++],e[v++],e[v],e[v+1],t,i,l))return!0}else u+=b(c,h,e[v++],e[v++],e[v],e[v+1],i,l)||0;c=e[v++],h=e[v++];break;case f.A:var T=e[v++],S=e[v++],w=e[v++],A=e[v++],I=e[v++],x=e[v++],R=(e[v++],1-e[v++]),C=Math.cos(I)*w+T,D=Math.sin(I)*A+S;v>1?u+=d(c,h,C,D,i,l):(p=C,m=D);var k=(i-T)*A/w+T;if(n){if(s.containStroke(T,S,A,I,I+x,R,t,k,l))return!0}else u+=E(T,S,A,I,I+x,R,k,l);c=Math.cos(I+x)*w+T,h=Math.sin(I+x)*A+S;break;case f.R:p=c=e[v++],m=h=e[v++];var M=e[v++],L=e[v++];C=p+M,D=m+L;if(n){if(r.containStroke(p,m,C,m,t,i,l)||r.containStroke(C,m,C,D,t,i,l)||r.containStroke(C,D,p,D,t,i,l)||r.containStroke(p,D,p,m,t,i,l))return!0}else u+=d(C,m,C,D,i,l),u+=d(p,D,p,m,i,l);break;case f.Z:if(n){if(r.containStroke(c,h,p,m,t,i,l))return!0}else u+=d(c,h,p,m,i,l);c=p,h=m;break}}return n||g(h,m)||(u+=d(c,h,p,m,i,l)||0),0!==u}function S(e,t,n){return T(e,0,!1,t,n)}function w(e,t,n,i){return T(e,t,!0,n,i)}t.contain=S,t.containStroke=w},d8e8:function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},d9fc:function(e,t,n){var i=n("cbe5"),r=i.extend({type:"circle",shape:{cx:0,cy:0,r:0},buildPath:function(e,t,n){n&&e.moveTo(t.cx+t.r,t.cy),e.arc(t.cx,t.cy,t.r,0,2*Math.PI,!0)}});e.exports=r},db9e:function(e,t,n){var i=n("3eba"),r=n("6d8b"),a=n("e86a"),o=n("2145"),s=n("2306"),l=n("4319"),u=n("80f0"),c=n("7919"),d=i.extendComponentView({type:"toolbox",render:function(e,t,n,i){var d=this.group;if(d.removeAll(),e.get("show")){var h=+e.get("itemSize"),p=e.get("feature")||{},g=this._features||(this._features={}),m=[];r.each(p,function(e,t){m.push(t)}),new u(this._featureNames||[],m).add(v).update(v).remove(r.curry(v,null)).execute(),this._featureNames=m,c.layout(d,e,n),d.add(c.makeBackground(d.getBoundingRect(),e)),d.eachChild(function(e){var t=e.__title,i=e.hoverStyle;if(i&&t){var r=a.getBoundingRect(t,a.makeFont(i)),o=e.position[0]+d.position[0],s=e.position[1]+d.position[1]+h,l=!1;s+r.height>n.getHeight()&&(i.textPosition="top",l=!0);var u=l?-5-r.height:h+8;o+r.width/2>n.getWidth()?(i.textPosition=["100%",u],i.textAlign="right"):o-r.width/2<0&&(i.textPosition=[0,u],i.textAlign="left")}})}function v(r,a){var s,u=m[r],c=m[a],d=p[u],h=new l(d,e,e.ecModel);if(u&&!c){if(f(u))s={model:h,onclick:h.option.onclick,featureName:u};else{var v=o.get(u);if(!v)return;s=new v(h,t,n)}g[u]=s}else{if(s=g[c],!s)return;s.model=h,s.ecModel=t,s.api=n}u||!c?h.get("show")&&!s.unusable?(y(h,s,u),h.setIconStatus=function(e,t){var n=this.option,i=this.iconPaths;n.iconStatus=n.iconStatus||{},n.iconStatus[e]=t,i[e]&&i[e].trigger(t)},s.render&&s.render(h,t,n,i)):s.remove&&s.remove(t,n):s.dispose&&s.dispose(t,n)}function y(i,a,o){var l=i.getModel("iconStyle"),u=i.getModel("emphasis.iconStyle"),c=a.getIcons?a.getIcons():i.get("icon"),f=i.get("title")||{};if("string"===typeof c){var p=c,g=f;c={},f={},c[o]=p,f[o]=g}var m=i.iconPaths={};r.each(c,function(o,c){var p=s.createIcon(o,{},{x:-h/2,y:-h/2,width:h,height:h});p.setStyle(l.getItemStyle()),p.hoverStyle=u.getItemStyle(),s.setHoverStyle(p),e.get("showTitle")&&(p.__title=f[c],p.on("mouseover",function(){var e=u.getItemStyle();p.setStyle({text:f[c],textPosition:e.textPosition||"bottom",textFill:e.fill||e.stroke||"#000",textAlign:e.textAlign||"center"})}).on("mouseout",function(){p.setStyle({textFill:null})})),p.trigger(i.get("iconStatus."+c)||"normal"),d.add(p),p.on("click",r.bind(a.onclick,a,t,n,c)),m[c]=p})}},updateView:function(e,t,n,i){r.each(this._features,function(e){e.updateView&&e.updateView(e.model,t,n,i)})},remove:function(e,t){r.each(this._features,function(n){n.remove&&n.remove(e,t)}),this.group.removeAll()},dispose:function(e,t){r.each(this._features,function(n){n.dispose&&n.dispose(e,t)})}});function f(e){return 0===e.indexOf("my")}e.exports=d},dc2f:function(e,t){var n=function(e,t){this.image=e,this.repeat=t,this.type="pattern"};n.prototype.getCanvasPattern=function(e){return e.createPattern(this.image,this.repeat||"repeat")};var i=n;e.exports=i},dcb3:function(e,t,n){var i=n("6d8b"),r=n("625e"),a=n("2306"),o=n("cd33"),s=n("607d"),l=n("88b3"),u=n("e0d3"),c=u.makeInner,d=c(),f=i.clone,h=i.bind;function p(){}function g(e,t,n,i){m(d(n).lastProp,i)||(d(n).lastProp=i,t?a.updateProps(n,i,e):(n.stopAnimation(),n.attr(i)))}function m(e,t){if(i.isObject(e)&&i.isObject(t)){var n=!0;return i.each(t,function(t,i){n=n&&m(e[i],t)}),!!n}return e===t}function v(e,t){e[t.get("label.show")?"show":"hide"]()}function y(e){return{position:e.position.slice(),rotation:e.rotation||0}}function _(e,t,n){var i=t.get("z"),r=t.get("zlevel");e&&e.traverse(function(e){"group"!==e.type&&(null!=i&&(e.z=i),null!=r&&(e.zlevel=r),e.silent=n)})}p.prototype={_group:null,_lastGraphicKey:null,_handle:null,_dragging:!1,_lastValue:null,_lastStatus:null,_payloadInfo:null,animationThreshold:15,render:function(e,t,n,r){var o=t.get("value"),s=t.get("status");if(this._axisModel=e,this._axisPointerModel=t,this._api=n,r||this._lastValue!==o||this._lastStatus!==s){this._lastValue=o,this._lastStatus=s;var l=this._group,u=this._handle;if(!s||"hide"===s)return l&&l.hide(),void(u&&u.hide());l&&l.show(),u&&u.show();var c={};this.makeElOption(c,o,e,t,n);var d=c.graphicKey;d!==this._lastGraphicKey&&this.clear(n),this._lastGraphicKey=d;var f=this._moveAnimation=this.determineAnimation(e,t);if(l){var h=i.curry(g,t,f);this.updatePointerEl(l,c,h,t),this.updateLabelEl(l,c,h,t)}else l=this._group=new a.Group,this.createPointerEl(l,c,e,t),this.createLabelEl(l,c,e,t),n.getZr().add(l);_(l,t,!0),this._renderHandle(o)}},remove:function(e){this.clear(e)},dispose:function(e){this.clear(e)},determineAnimation:function(e,t){var n=t.get("animation"),i=e.axis,r="category"===i.type,a=t.get("snap");if(!a&&!r)return!1;if("auto"===n||null==n){var s=this.animationThreshold;if(r&&i.getBandWidth()>s)return!0;if(a){var l=o.getAxisInfo(e).seriesDataCount,u=i.getExtent();return Math.abs(u[0]-u[1])/l>s}return!1}return!0===n},makeElOption:function(e,t,n,i,r){},createPointerEl:function(e,t,n,i){var r=t.pointer;if(r){var o=d(e).pointerEl=new a[r.type](f(t.pointer));e.add(o)}},createLabelEl:function(e,t,n,i){if(t.label){var r=d(e).labelEl=new a.Rect(f(t.label));e.add(r),v(r,i)}},updatePointerEl:function(e,t,n){var i=d(e).pointerEl;i&&(i.setStyle(t.pointer.style),n(i,{shape:t.pointer.shape}))},updateLabelEl:function(e,t,n,i){var r=d(e).labelEl;r&&(r.setStyle(t.label.style),n(r,{shape:t.label.shape,position:t.label.position}),v(r,i))},_renderHandle:function(e){if(!this._dragging&&this.updateHandleTransform){var t,n=this._axisPointerModel,r=this._api.getZr(),o=this._handle,u=n.getModel("handle"),c=n.get("status");if(!u.get("show")||!c||"hide"===c)return o&&r.remove(o),void(this._handle=null);this._handle||(t=!0,o=this._handle=a.createIcon(u.get("icon"),{cursor:"move",draggable:!0,onmousemove:function(e){s.stop(e.event)},onmousedown:h(this._onHandleDragMove,this,0,0),drift:h(this._onHandleDragMove,this),ondragend:h(this._onHandleDragEnd,this)}),r.add(o)),_(o,n,!1);var d=["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"];o.setStyle(u.getItemStyle(null,d));var f=u.get("size");i.isArray(f)||(f=[f,f]),o.attr("scale",[f[0]/2,f[1]/2]),l.createOrUpdate(this,"_doDispatchAxisPointer",u.get("throttle")||0,"fixRate"),this._moveHandleToValue(e,t)}},_moveHandleToValue:function(e,t){g(this._axisPointerModel,!t&&this._moveAnimation,this._handle,y(this.getHandleTransform(e,this._axisModel,this._axisPointerModel)))},_onHandleDragMove:function(e,t){var n=this._handle;if(n){this._dragging=!0;var i=this.updateHandleTransform(y(n),[e,t],this._axisModel,this._axisPointerModel);this._payloadInfo=i,n.stopAnimation(),n.attr(y(i)),d(n).lastProp=null,this._doDispatchAxisPointer()}},_doDispatchAxisPointer:function(){var e=this._handle;if(e){var t=this._payloadInfo,n=this._axisModel;this._api.dispatchAction({type:"updateAxisPointer",x:t.cursorPoint[0],y:t.cursorPoint[1],tooltipOption:t.tooltipOption,axesInfo:[{axisDim:n.axis.dim,axisIndex:n.componentIndex}]})}},_onHandleDragEnd:function(e){this._dragging=!1;var t=this._handle;if(t){var n=this._axisPointerModel.get("value");this._moveHandleToValue(n),this._api.dispatchAction({type:"hideTip"})}},getHandleTransform:null,updateHandleTransform:null,clear:function(e){this._lastValue=null,this._lastStatus=null;var t=e.getZr(),n=this._group,i=this._handle;t&&n&&(this._lastGraphicKey=null,n&&t.remove(n),i&&t.remove(i),this._group=null,this._handle=null,this._payloadInfo=null)},doClear:function(){},buildLabel:function(e,t,n){return n=n||0,{x:e[n],y:e[1-n],width:t[n],height:t[1-n]}}},p.prototype.constructor=p,r.enableClassExtend(p);var b=p;e.exports=b},dcbc:function(e,t,n){var i=n("2aba");e.exports=function(e,t,n){for(var r in t)i(e,r,t[r],n);return e}},dd39:function(e,t,n){n("6932"),n("3a56"),n("7dcf"),n("414c"),n("4b08"),n("2c17"),n("9e87")},dded:function(e,t,n){var i=n("6d8b"),r=n("42e5"),a=function(e,t,n,i,a){this.x=null==e?.5:e,this.y=null==t?.5:t,this.r=null==n?.5:n,this.type="radial",this.global=a||!1,r.call(this,i)};a.prototype={constructor:a},i.inherits(a,r);var o=a;e.exports=o},de00:function(e,t){var n=2311;function i(){return n++}e.exports=i},de1c:function(e,t){var n={getBoxLayoutParams:function(){return{left:this.get("left"),top:this.get("top"),right:this.get("right"),bottom:this.get("bottom"),width:this.get("width"),height:this.get("height")}}};e.exports=n},df70:function(e,t,n){var i=n("3eba"),r=n("6fda"),a=n("29a8"),o=n("2145"),s=a.toolbox.restore;function l(e){this.model=e}l.defaultOption={show:!0,icon:"M3.8,33.4 M47,18.9h9.8V8.7 M56.3,20.1 C52.1,9,40.5,0.6,26.8,2.1C12.6,3.7,1.6,16.2,2.1,30.6 M13,41.1H3.1v10.2 M3.7,39.9c4.2,11.1,15.8,19.5,29.5,18 c14.2-1.6,25.2-14.1,24.7-28.5",title:s.title};var u=l.prototype;u.onclick=function(e,t,n){r.clear(e),t.dispatchAction({type:"restore",from:this.uid})},o.register("restore",l),i.registerAction({type:"restore",event:"restore",update:"prepareAndUpdate"},function(e,t){t.resetOption("recreate")});var c=l;e.exports=c},e073:function(e,t,n){var i=n("6d8b"),r=n("e86a"),a=n("e0d3"),o=a.makeInner,s=n("697e"),l=s.makeLabelFormatter,u=o();function c(e){return"category"===e.type?f(e):g(e)}function d(e,t){return"category"===e.type?p(e,t):{ticks:e.scale.getTicks()}}function f(e){var t=e.getLabelModel(),n=h(e,t);return!t.get("show")||e.scale.isBlank()?{labels:[],labelCategoryInterval:n.labelCategoryInterval}:n}function h(e,t){var n,r,a=m(e,"labels"),o=w(t),s=v(a,o);return s||(i.isFunction(o)?n=S(e,o):(r="auto"===o?_(e):o,n=T(e,r)),y(a,o,{labels:n,labelCategoryInterval:r}))}function p(e,t){var n,r,a=m(e,"ticks"),o=w(t),s=v(a,o);if(s)return s;if(t.get("show")&&!e.scale.isBlank()||(n=[]),i.isFunction(o))n=S(e,o,!0);else if("auto"===o){var l=h(e,e.getLabelModel());r=l.labelCategoryInterval,n=i.map(l.labels,function(e){return e.tickValue})}else r=o,n=T(e,r,!0);return y(a,o,{ticks:n,tickCategoryInterval:r})}function g(e){var t=e.scale.getTicks(),n=l(e);return{labels:i.map(t,function(t,i){return{formattedLabel:n(t,i),rawLabel:e.scale.getLabel(t),tickValue:t}})}}function m(e,t){return u(e)[t]||(u(e)[t]=[])}function v(e,t){for(var n=0;n<e.length;n++)if(e[n].key===t)return e[n].value}function y(e,t,n){return e.push({key:t,value:n}),n}function _(e){var t=u(e).autoInterval;return null!=t?t:u(e).autoInterval=e.calculateCategoryInterval()}function b(e){var t=E(e),n=l(e),i=(t.axisRotate-t.labelRotate)/180*Math.PI,a=e.scale,o=a.getExtent(),s=a.count();if(o[1]-o[0]<1)return 0;var c=1;s>40&&(c=Math.max(1,Math.floor(s/40)));for(var d=o[0],f=e.dataToCoord(d+1)-e.dataToCoord(d),h=Math.abs(f*Math.cos(i)),p=Math.abs(f*Math.sin(i)),g=0,m=0;d<=o[1];d+=c){var v=0,y=0,_=r.getBoundingRect(n(d),t.font,"center","top");v=1.3*_.width,y=1.3*_.height,g=Math.max(g,v,7),m=Math.max(m,y,7)}var b=g/h,T=m/p;isNaN(b)&&(b=1/0),isNaN(T)&&(T=1/0);var S=Math.max(0,Math.floor(Math.min(b,T))),w=u(e.model),A=w.lastAutoInterval,I=w.lastTickCount;return null!=A&&null!=I&&Math.abs(A-S)<=1&&Math.abs(I-s)<=1&&A>S?S=A:(w.lastTickCount=s,w.lastAutoInterval=S),S}function E(e){var t=e.getLabelModel();return{axisRotate:e.getRotate?e.getRotate():e.isHorizontal&&!e.isHorizontal()?90:0,labelRotate:t.get("rotate")||0,font:t.getFont()}}function T(e,t,n){var i=l(e),r=e.scale,a=r.getExtent(),o=e.getLabelModel(),s=[],u=Math.max((t||0)+1,1),c=a[0],d=r.count();0!==c&&u>1&&d/u>2&&(c=Math.round(Math.ceil(c/u)*u));var f={min:o.get("showMinLabel"),max:o.get("showMaxLabel")};f.min&&c!==a[0]&&p(a[0]);for(var h=c;h<=a[1];h+=u)p(h);function p(e){s.push(n?e:{formattedLabel:i(e),rawLabel:r.getLabel(e),tickValue:e})}return f.max&&h!==a[1]&&p(a[1]),s}function S(e,t,n){var r=e.scale,a=l(e),o=[];return i.each(r.getTicks(),function(e){var i=r.getLabel(e);t(e,i)&&o.push(n?e:{formattedLabel:a(e),rawLabel:i,tickValue:e})}),o}function w(e){var t=e.get("interval");return null==t?"auto":t}t.createAxisLabels=c,t.createAxisTicks=d,t.calculateCategoryInterval=b},e0d3:function(e,t,n){var i=n("6d8b"),r=i.each,a=i.isObject,o=i.isArray,s="series\0";function l(e){return e instanceof Array?e:null==e?[]:[e]}function u(e,t,n){if(e){e[t]=e[t]||{},e.emphasis=e.emphasis||{},e.emphasis[t]=e.emphasis[t]||{};for(var i=0,r=n.length;i<r;i++){var a=n[i];!e.emphasis[t].hasOwnProperty(a)&&e[t].hasOwnProperty(a)&&(e.emphasis[t][a]=e[t][a])}}}var c=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"];function d(e){return!a(e)||o(e)||e instanceof Date?e:e.value}function f(e){return a(e)&&!(e instanceof Array)}function h(e,t){t=(t||[]).slice();var n=i.map(e||[],function(e,t){return{exist:e}});return r(t,function(e,i){if(a(e)){for(var r=0;r<n.length;r++)if(!n[r].option&&null!=e.id&&n[r].exist.id===e.id+"")return n[r].option=e,void(t[i]=null);for(r=0;r<n.length;r++){var o=n[r].exist;if(!n[r].option&&(null==o.id||null==e.id)&&null!=e.name&&!m(e)&&!m(o)&&o.name===e.name+"")return n[r].option=e,void(t[i]=null)}}}),r(t,function(e,t){if(a(e)){for(var i=0;i<n.length;i++){var r=n[i].exist;if(!n[i].option&&!m(r)&&null==e.id){n[i].option=e;break}}i>=n.length&&n.push({option:e})}}),n}function p(e){var t=i.createHashMap();r(e,function(e,n){var i=e.exist;i&&t.set(i.id,e)}),r(e,function(e,n){var r=e.option;i.assert(!r||null==r.id||!t.get(r.id)||t.get(r.id)===e,"id duplicates: "+(r&&r.id)),r&&null!=r.id&&t.set(r.id,e),!e.keyInfo&&(e.keyInfo={})}),r(e,function(e,n){var i=e.exist,r=e.option,o=e.keyInfo;if(a(r)){if(o.name=null!=r.name?r.name+"":i?i.name:s+n,i)o.id=i.id;else if(null!=r.id)o.id=r.id+"";else{var l=0;do{o.id="\0"+o.name+"\0"+l++}while(t.get(o.id))}t.set(o.id,e)}})}function g(e){var t=e.name;return!(!t||!t.indexOf(s))}function m(e){return a(e)&&e.id&&0===(e.id+"").indexOf("\0_ec_\0")}function v(e,t){var n={},i={};return r(e||[],n),r(t||[],i,n),[a(n),a(i)];function r(e,t,n){for(var i=0,r=e.length;i<r;i++)for(var a=e[i].seriesId,o=l(e[i].dataIndex),s=n&&n[a],u=0,c=o.length;u<c;u++){var d=o[u];s&&s[d]?s[d]=null:(t[a]||(t[a]={}))[d]=1}}function a(e,t){var n=[];for(var i in e)if(e.hasOwnProperty(i)&&null!=e[i])if(t)n.push(+i);else{var r=a(e[i],!0);r.length&&n.push({seriesId:i,dataIndex:r})}return n}}function y(e,t){return null!=t.dataIndexInside?t.dataIndexInside:null!=t.dataIndex?i.isArray(t.dataIndex)?i.map(t.dataIndex,function(t){return e.indexOfRawIndex(t)}):e.indexOfRawIndex(t.dataIndex):null!=t.name?i.isArray(t.name)?i.map(t.name,function(t){return e.indexOfName(t)}):e.indexOfName(t.name):void 0}function _(){var e="__\0ec_inner_"+b+++"_"+Math.random().toFixed(5);return function(t){return t[e]||(t[e]={})}}var b=0;function E(e,t,n){if(i.isString(t)){var a={};a[t+"Index"]=0,t=a}var o=n&&n.defaultMainType;!o||T(t,o+"Index")||T(t,o+"Id")||T(t,o+"Name")||(t[o+"Index"]=0);var s={};return r(t,function(r,a){r=t[a];if("dataIndex"!==a&&"dataIndexInside"!==a){var o=a.match(/^(\w+)(Index|Id|Name)$/)||[],l=o[1],u=(o[2]||"").toLowerCase();if(!(!l||!u||null==r||"index"===u&&"none"===r||n&&n.includeMainTypes&&i.indexOf(n.includeMainTypes,l)<0)){var c={mainType:l};"index"===u&&"all"===r||(c[u]=r);var d=e.queryComponents(c);s[l+"Models"]=d,s[l+"Model"]=d[0]}}else s[a]=r}),s}function T(e,t){return e&&e.hasOwnProperty(t)}function S(e,t,n){e.setAttribute?e.setAttribute(t,n):e[t]=n}function w(e,t){return e.getAttribute?e.getAttribute(t):e[t]}t.normalizeToArray=l,t.defaultEmphasis=u,t.TEXT_STYLE_OPTIONS=c,t.getDataItemValue=d,t.isDataItemOption=f,t.mappingToExists=h,t.makeIdAndName=p,t.isNameSpecified=g,t.isIdInner=m,t.compressBatches=v,t.queryDataIndex=y,t.makeInner=_,t.parseFinder=E,t.setAttribute=S,t.getAttribute=w},e0d8:function(e,t,n){var i=n("625e");function r(e){this._setting=e||{},this._extent=[1/0,-1/0],this._interval=0,this.init&&this.init.apply(this,arguments)}r.prototype.parse=function(e){return e},r.prototype.getSetting=function(e){return this._setting[e]},r.prototype.contain=function(e){var t=this._extent;return e>=t[0]&&e<=t[1]},r.prototype.normalize=function(e){var t=this._extent;return t[1]===t[0]?.5:(e-t[0])/(t[1]-t[0])},r.prototype.scale=function(e){var t=this._extent;return e*(t[1]-t[0])+t[0]},r.prototype.unionExtent=function(e){var t=this._extent;e[0]<t[0]&&(t[0]=e[0]),e[1]>t[1]&&(t[1]=e[1])},r.prototype.unionExtentFromData=function(e,t){this.unionExtent(e.getApproximateExtent(t))},r.prototype.getExtent=function(){return this._extent.slice()},r.prototype.setExtent=function(e,t){var n=this._extent;isNaN(e)||(n[0]=e),isNaN(t)||(n[1]=t)},r.prototype.isBlank=function(){return this._isBlank},r.prototype.setBlank=function(e){this._isBlank=e},r.prototype.getLabel=null,i.enableClassExtend(r),i.enableClassManagement(r,{registerWhenExtend:!0});var a=r;e.exports=a},e11e:function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},e1fc:function(e,t,n){var i=n("6d8b"),r=n("d5b7"),a=n("9850"),o=function(e){for(var t in e=e||{},r.call(this,e),e)e.hasOwnProperty(t)&&(this[t]=e[t]);this._children=[],this.__storage=null,this.__dirty=!0};o.prototype={constructor:o,isGroup:!0,type:"group",silent:!1,children:function(){return this._children.slice()},childAt:function(e){return this._children[e]},childOfName:function(e){for(var t=this._children,n=0;n<t.length;n++)if(t[n].name===e)return t[n]},childCount:function(){return this._children.length},add:function(e){return e&&e!==this&&e.parent!==this&&(this._children.push(e),this._doAdd(e)),this},addBefore:function(e,t){if(e&&e!==this&&e.parent!==this&&t&&t.parent===this){var n=this._children,i=n.indexOf(t);i>=0&&(n.splice(i,0,e),this._doAdd(e))}return this},_doAdd:function(e){e.parent&&e.parent.remove(e),e.parent=this;var t=this.__storage,n=this.__zr;t&&t!==e.__storage&&(t.addToStorage(e),e instanceof o&&e.addChildrenToStorage(t)),n&&n.refresh()},remove:function(e){var t=this.__zr,n=this.__storage,r=this._children,a=i.indexOf(r,e);return a<0?this:(r.splice(a,1),e.parent=null,n&&(n.delFromStorage(e),e instanceof o&&e.delChildrenFromStorage(n)),t&&t.refresh(),this)},removeAll:function(){var e,t,n=this._children,i=this.__storage;for(t=0;t<n.length;t++)e=n[t],i&&(i.delFromStorage(e),e instanceof o&&e.delChildrenFromStorage(i)),e.parent=null;return n.length=0,this},eachChild:function(e,t){for(var n=this._children,i=0;i<n.length;i++){var r=n[i];e.call(t,r,i)}return this},traverse:function(e,t){for(var n=0;n<this._children.length;n++){var i=this._children[n];e.call(t,i),"group"===i.type&&i.traverse(e,t)}return this},addChildrenToStorage:function(e){for(var t=0;t<this._children.length;t++){var n=this._children[t];e.addToStorage(n),n instanceof o&&n.addChildrenToStorage(e)}},delChildrenFromStorage:function(e){for(var t=0;t<this._children.length;t++){var n=this._children[t];e.delFromStorage(n),n instanceof o&&n.delChildrenFromStorage(e)}},dirty:function(){return this.__dirty=!0,this.__zr&&this.__zr.refresh(),this},getBoundingRect:function(e){for(var t=null,n=new a(0,0,0,0),i=e||this._children,r=[],o=0;o<i.length;o++){var s=i[o];if(!s.ignore&&!s.invisible){var l=s.getBoundingRect(),u=s.getLocalTransform(r);u?(n.copy(l),n.applyTransform(u),t=t||n.clone(),t.union(n)):(t=t||l.clone(),t.union(l))}}return t||n}},i.inherits(o,r);var s=o;e.exports=s},e263:function(e,t,n){var i=n("401b"),r=n("4a3f"),a=Math.min,o=Math.max,s=Math.sin,l=Math.cos,u=2*Math.PI,c=i.create(),d=i.create(),f=i.create();function h(e,t,n){if(0!==e.length){var i,r=e[0],s=r[0],l=r[0],u=r[1],c=r[1];for(i=1;i<e.length;i++)r=e[i],s=a(s,r[0]),l=o(l,r[0]),u=a(u,r[1]),c=o(c,r[1]);t[0]=s,t[1]=u,n[0]=l,n[1]=c}}function p(e,t,n,i,r,s){r[0]=a(e,n),r[1]=a(t,i),s[0]=o(e,n),s[1]=o(t,i)}var g=[],m=[];function v(e,t,n,i,s,l,u,c,d,f){var h,p=r.cubicExtrema,v=r.cubicAt,y=p(e,n,s,u,g);for(d[0]=1/0,d[1]=1/0,f[0]=-1/0,f[1]=-1/0,h=0;h<y;h++){var _=v(e,n,s,u,g[h]);d[0]=a(_,d[0]),f[0]=o(_,f[0])}for(y=p(t,i,l,c,m),h=0;h<y;h++){var b=v(t,i,l,c,m[h]);d[1]=a(b,d[1]),f[1]=o(b,f[1])}d[0]=a(e,d[0]),f[0]=o(e,f[0]),d[0]=a(u,d[0]),f[0]=o(u,f[0]),d[1]=a(t,d[1]),f[1]=o(t,f[1]),d[1]=a(c,d[1]),f[1]=o(c,f[1])}function y(e,t,n,i,s,l,u,c){var d=r.quadraticExtremum,f=r.quadraticAt,h=o(a(d(e,n,s),1),0),p=o(a(d(t,i,l),1),0),g=f(e,n,s,h),m=f(t,i,l,p);u[0]=a(e,s,g),u[1]=a(t,l,m),c[0]=o(e,s,g),c[1]=o(t,l,m)}function _(e,t,n,r,a,o,h,p,g){var m=i.min,v=i.max,y=Math.abs(a-o);if(y%u<1e-4&&y>1e-4)return p[0]=e-n,p[1]=t-r,g[0]=e+n,void(g[1]=t+r);if(c[0]=l(a)*n+e,c[1]=s(a)*r+t,d[0]=l(o)*n+e,d[1]=s(o)*r+t,m(p,c,d),v(g,c,d),a%=u,a<0&&(a+=u),o%=u,o<0&&(o+=u),a>o&&!h?o+=u:a<o&&h&&(a+=u),h){var _=o;o=a,a=_}for(var b=0;b<o;b+=Math.PI/2)b>a&&(f[0]=l(b)*n+e,f[1]=s(b)*r+t,m(p,f,p),v(g,f,g))}t.fromPoints=h,t.fromLine=p,t.fromCubic=v,t.fromQuadratic=y,t.fromArc=_},e3db:function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},e47b:function(e,t,n){var i=n("e0d3"),r=i.makeInner,a=i.normalizeToArray,o=r();function s(e,t){for(var n=e.length,i=0;i<n;i++)if(e[i].length>t)return e[i];return e[n-1]}var l={clearColorPalette:function(){o(this).colorIdx=0,o(this).colorNameMap={}},getColorFromPalette:function(e,t,n){t=t||this;var i=o(t),r=i.colorIdx||0,l=i.colorNameMap=i.colorNameMap||{};if(l.hasOwnProperty(e))return l[e];var u=a(this.get("color",!0)),c=this.get("colorLayer",!0),d=null!=n&&c?s(c,n):u;if(d=d||u,d&&d.length){var f=d[r];return e&&(l[e]=f),i.colorIdx=(r+1)%d.length,f}}};e.exports=l},e7aa:function(e,t,n){var i=n("2306"),r=n("c775"),a=r.getDefaultLabel;function o(e,t,n,r,o,l,u){var c=n.getModel("label"),d=n.getModel("emphasis.label");i.setLabelStyle(e,t,c,d,{labelFetcher:o,labelDataIndex:l,defaultText:a(o.getData(),l),isRectText:!0,autoColor:r}),s(e),s(t)}function s(e,t){"outside"===e.textPosition&&(e.textPosition=t)}t.setLabel=o},e7d2:function(e,t,n){var i=n("4a3f");function r(e,t,n,r,a,o,s,l,u,c,d){if(0===u)return!1;var f=u;if(d>t+f&&d>r+f&&d>o+f&&d>l+f||d<t-f&&d<r-f&&d<o-f&&d<l-f||c>e+f&&c>n+f&&c>a+f&&c>s+f||c<e-f&&c<n-f&&c<a-f&&c<s-f)return!1;var h=i.cubicProjectPoint(e,t,n,r,a,o,s,l,c,d,null);return h<=f/2}t.containStroke=r},e7e3:function(e,t,n){(function(t,n){/*! For license information please see dash.all.min.js.LICENSE.txt */
!function(t,n){e.exports=n()}(self,function(){return function(){var e={4593:function(e,t){var n,i,r,o,l,u=function(e){for(var t=[],n=0;n<e.length;++n){var i=e.charCodeAt(n);i<128?t.push(i):i<2048?(t.push(192|i>>6),t.push(128|63&i)):i<65536?(t.push(224|i>>12),t.push(128|63&i>>6),t.push(128|63&i)):(t.push(240|i>>18),t.push(128|63&i>>12),t.push(128|63&i>>6),t.push(128|63&i))}return t},c=function(e){for(var t=[],n=0;n<e.length;){var i=e[n++];i<128||(i<224?(i=(31&i)<<6,i|=63&e[n++]):i<240?(i=(15&i)<<12,i|=(63&e[n++])<<6,i|=63&e[n++]):(i=(7&i)<<18,i|=(63&e[n++])<<12,i|=(63&e[n++])<<6,i|=63&e[n++])),t.push(String.fromCharCode(i))}return t.join("")},d={};n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=function(e){for(var t=0,i=[],r=0|e.length/3;0<r--;){var a=(e[t]<<16)+(e[t+1]<<8)+e[t+2];t+=3,i.push(n.charAt(63&a>>18)),i.push(n.charAt(63&a>>12)),i.push(n.charAt(63&a>>6)),i.push(n.charAt(63&a))}return 2==e.length-t?(a=(e[t]<<16)+(e[t+1]<<8),i.push(n.charAt(63&a>>18)),i.push(n.charAt(63&a>>12)),i.push(n.charAt(63&a>>6)),i.push("=")):1==e.length-t&&(a=e[t]<<16,i.push(n.charAt(63&a>>18)),i.push(n.charAt(63&a>>12)),i.push("==")),i.join("")},r=function(){for(var e=[],t=0;t<n.length;++t)e[n.charCodeAt(t)]=t;return e["=".charCodeAt(0)]=0,e}(),o=function(e){for(var t=0,n=[],i=0|e.length/4;0<i--;){var a=(r[e.charCodeAt(t)]<<18)+(r[e.charCodeAt(t+1)]<<12)+(r[e.charCodeAt(t+2)]<<6)+r[e.charCodeAt(t+3)];n.push(255&a>>16),n.push(255&a>>8),n.push(255&a),t+=4}return n&&("="==e.charAt(t-2)?(n.pop(),n.pop()):"="==e.charAt(t-1)&&n.pop()),n},l={encode:function(e){for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t},decode:function(e){for(var t=0;t<s.length;++t)a[t]=String.fromCharCode(a[t]);return a.join("")}},d.decodeArray=function(e){var t=o(e);return new Uint8Array(t)},d.encodeASCII=function(e){var t=l.encode(e);return i(t)},d.decodeASCII=function(e){var t=o(e);return l.decode(t)},d.encode=function(e){var t=u(e);return i(t)},d.decode=function(e){var t=o(e);return c(t)},t.decode=d.decode,t.decodeArray=d.decodeArray,t.encode=d.encode,t.encodeASCII=d.encodeASCII},452:function(e,t){!function(e){"use strict";var t={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},n=function(e){var n=e;return t.hasOwnProperty(e)&&(n=t[e]),String.fromCharCode(n)},i=15,r=32,a={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},o={17:2,18:4,21:6,22:8,23:10,19:13,20:15},s={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},l={25:2,26:4,29:6,30:8,31:10,27:13,28:15},u=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],c={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){var n=this.verboseFilter[e];this.verboseLevel>=n&&console.log(this.time+" ["+e+"] "+t)}},d=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toString(16));return t},f=function(e,t,n,i,r){this.foreground=e||"white",this.underline=t||!1,this.italics=n||!1,this.background=i||"black",this.flash=r||!1};f.prototype={reset:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},setStyles:function(e){for(var t=["foreground","underline","italics","background","flash"],n=0;n<t.length;n++){var i=t[n];e.hasOwnProperty(i)&&(this[i]=e[i])}},isDefault:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},equals:function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},copy:function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},toString:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}};var h=function(e,t,n,i,r,a){this.uchar=e||" ",this.penState=new f(t,n,i,r,a)};h.prototype={reset:function(){this.uchar=" ",this.penState.reset()},setChar:function(e,t){this.uchar=e,this.penState.copy(t)},setPenState:function(e){this.penState.copy(e)},equals:function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},copy:function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},isEmpty:function(){return" "===this.uchar&&this.penState.isDefault()}};var p=function(){this.chars=[];for(var e=0;e<r;e++)this.chars.push(new h);this.pos=0,this.currPenState=new f};p.prototype={equals:function(e){for(var t=!0,n=0;n<r;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t},copy:function(e){for(var t=0;t<r;t++)this.chars[t].copy(e.chars[t])},isEmpty:function(){for(var e=!0,t=0;t<r;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},setCursor:function(e){this.pos!==e&&(this.pos=e),this.pos<0?(c.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>r&&(c.log("ERROR","Too large cursor position "+this.pos),this.pos=r)},moveCursor:function(e){var t=this.pos+e;if(e>1)for(var n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)},backSpace:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},insertChar:function(e){e>=144&&this.backSpace();var t=n(e);this.pos>=r?c.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},clearFromPos:function(e){var t;for(t=e;t<r;t++)this.chars[t].reset()},clear:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},clearToEndOfRow:function(){this.clearFromPos(this.pos)},getTextString:function(){for(var e=[],t=!0,n=0;n<r;n++){var i=this.chars[n].uchar;" "!==i&&(t=!1),e.push(i)}return t?"":e.join("")},setPenStyles:function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}};var g=function(){this.rows=[];for(var e=0;e<i;e++)this.rows.push(new p);this.currRow=14,this.nrRollUpRows=null,this.reset()};g.prototype={reset:function(){for(var e=0;e<i;e++)this.rows[e].clear();this.currRow=14},equals:function(e){for(var t=!0,n=0;n<i;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t},copy:function(e){for(var t=0;t<i;t++)this.rows[t].copy(e.rows[t])},isEmpty:function(){for(var e=!0,t=0;t<i;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},backSpace:function(){this.rows[this.currRow].backSpace()},clearToEndOfRow:function(){this.rows[this.currRow].clearToEndOfRow()},insertChar:function(e){this.rows[this.currRow].insertChar(e)},setPen:function(e){this.rows[this.currRow].setPenStyles(e)},moveCursor:function(e){this.rows[this.currRow].moveCursor(e)},setCursor:function(e){c.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e)},setPAC:function(e){c.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.currRow=t;var n=this.rows[this.currRow];if(null!==e.indent){var i=e.indent,r=Math.max(i-1,0);n.setCursor(e.indent),e.color=n.chars[r].penState.foreground}var a={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(a)},setBkgData:function(e){c.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},setRollUpRows:function(e){this.nrRollUpRows=e},rollUp:function(){if(null!==this.nrRollUpRows){c.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),c.log("INFO","Rolling up")}else c.log("DEBUG","roll_up but nrRollUpRows not set yet")},getDisplayText:function(e){e=e||!1;for(var t=[],n="",r=-1,a=0;a<i;a++){var o=this.rows[a].getTextString();o&&(r=a+1,e?t.push("Row "+r+': "'+o+'"'):t.push(o.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n},getTextAndFormat:function(){return this.rows}};var m=function(e,t){this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new g,this.nonDisplayedMemory=new g,this.lastOutputScreen=new g,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null};m.prototype={modes:["MODE_ROLL-UP","MODE_POP-ON","MODE_PAINT-ON","MODE_TEXT"],reset:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},getHandler:function(){return this.outputFilter},setHandler:function(e){this.outputFilter=e},setPAC:function(e){this.writeScreen.setPAC(e)},setBkgData:function(e){this.writeScreen.setBkgData(e)},setMode:function(e){e!==this.mode&&(this.mode=e,c.log("INFO","MODE="+e),"MODE_POP-ON"==this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},insertChars:function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";c.log("INFO",n+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(c.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},cc_RCL:function(){c.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},cc_BS:function(){c.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},cc_AOF:function(){},cc_AON:function(){},cc_DER:function(){c.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},cc_RU:function(e){c.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},cc_FON:function(){c.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},cc_RDC:function(){c.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},cc_TR:function(){c.log("INFO","TR"),this.setMode("MODE_TEXT")},cc_RTD:function(){c.log("INFO","RTD"),this.setMode("MODE_TEXT")},cc_EDM:function(){c.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()},cc_CR:function(){c.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()},cc_ENM:function(){c.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},cc_EOC:function(){if(c.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,c.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()},cc_TO:function(e){c.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},cc_MIDROW:function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var n=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][n]}c.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},outputDataUpdate:function(){var e=c.time;null!==e&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(e,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))},cueSplitAtTime:function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}};var v=function(e,t,n){this.field=e||1,this.outputs=[t,n],this.channels=[new m(1,t),new m(2,n)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}};v.prototype={getHandler:function(e){return this.channels[e].getHandler()},setHandler:function(e,t){this.channels[e].setHandler(t)},addData:function(e,t){var n,i,r,a=!1;this.lastTime=e,c.setTime(e);for(var o=0;o<t.length;o+=2)i=127&t[o],r=127&t[o+1],i>=16&&i<=31&&i===this.lastCmdA&&r===this.lastCmdB?(this.lastCmdA=null,this.lastCmdB=null,c.log("DEBUG","Repeated command ("+d([i,r])+") is dropped")):0!==i||0!==r?(c.log("DATA","["+d([t[o],t[o+1]])+"] -> ("+d([i,r])+")"),(n=this.parseCmd(i,r))||(n=this.parseMidrow(i,r)),n||(n=this.parsePAC(i,r)),n||(n=this.parseBackgroundAttributes(i,r)),n||(a=this.parseChars(i,r))&&(this.currChNr&&this.currChNr>=0?this.channels[this.currChNr-1].insertChars(a):c.log("WARNING","No channel found yet. TEXT-MODE?")),n?this.dataCounters.cmd+=2:a?this.dataCounters.char+=2:(this.dataCounters.other+=2,c.log("WARNING","Couldn't parse cleaned data "+d([i,r])+" orig: "+d([t[o],t[o+1]])))):this.dataCounters.padding+=2},parseCmd:function(e,t){var n;if(!((20===e||21===e||28===e||29===e)&&32<=t&&t<=47||(23===e||31===e)&&33<=t&&t<=35))return!1;n=20===e||21===e||23===e?1:2;var i=this.channels[n-1];return 20===e||21===e||28===e||29===e?32===t?i.cc_RCL():33===t?i.cc_BS():34===t?i.cc_AOF():35===t?i.cc_AON():36===t?i.cc_DER():37===t?i.cc_RU(2):38===t?i.cc_RU(3):39===t?i.cc_RU(4):40===t?i.cc_FON():41===t?i.cc_RDC():42===t?i.cc_TR():43===t?i.cc_RTD():44===t?i.cc_EDM():45===t?i.cc_CR():46===t?i.cc_ENM():47===t&&i.cc_EOC():i.cc_TO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},parseMidrow:function(e,t){var n=null;if((17===e||25===e)&&32<=t&&t<=47){if((n=17===e?1:2)!==this.currChNr)return c.log("ERROR","Mismatch channel in midrow parsing"),!1;var i=this.channels[n-1];return i.insertChars([32]),i.cc_MIDROW(t),c.log("DEBUG","MIDROW ("+d([e,t])+")"),this.lastCmdA=e,this.lastCmdB=t,!0}return!1},parsePAC:function(e,t){var n,i;if(!((17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127||(16===e||24===e)&&64<=t&&t<=95))return!1;n=e<=23?1:2,i=64<=t&&t<=95?1===n?a[e]:s[e]:1===n?o[e]:l[e];var r=this.interpretPAC(i,t);return this.channels[n-1].setPAC(r),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},interpretPAC:function(e,t){var n,i={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,i.underline=1==(1&n),n<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(i.italics=!0,i.color="white"):i.indent=4*Math.floor((n-16)/2),i},parseChars:function(e,t){var i,r=null,a=null,o=null;(e>=25?(r=2,o=e-8):(r=1,o=e),17<=o&&o<=19)?(i=17===o?t+80:18===o?t+112:t+144,c.log("INFO","Special char '"+n(i)+"' in channel "+r),a=[i],this.lastCmdA=e,this.lastCmdB=t):32<=e&&e<=127&&(a=0===t?[e]:[e,t],this.lastCmdA=null,this.lastCmdB=null);if(a){var s=d(a);c.log("DEBUG","Char codes =  "+s.join(","))}return a},parseBackgroundAttributes:function(e,t){var n,i,r;return((16===e||24===e)&&32<=t&&t<=47||(23===e||31===e)&&45<=t&&t<=47)&&(n={},16===e||24===e?(i=Math.floor((t-32)/2),n.background=u[i],t%2==1&&(n.background=n.background+"_semi")):45===t?n.background="transparent":(n.foreground="black",47===t&&(n.underline=!0)),r=e<24?1:2,this.channels[r-1].setBkgData(n),this.lastCmdA=e,this.lastCmdB=t,!0)},reset:function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},cueSplitAtTime:function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)}},e.logger=c,e.PenState=f,e.CaptionScreen=g,e.Cea608Parser=v,e.findCea608Nalus=function(e,t,n){for(var i=0,r=t,a=[],o=function(e,t,n,i){if(4!==e||t<8)return null;var r=n.getUint8(i),a=n.getUint16(i+1),o=n.getUint32(i+3),s=n.getUint8(i+7);return 181==r&&49==a&&1195456820==o&&3==s};r<t+n;){if(i=e.getUint32(r),6==(31&e.getUint8(r+4)))for(var s=r+5,l=-1;s<r+4+i-1;){l=0;for(var u=255;255===u;)l+=u=e.getUint8(s),s++;var c=0;for(u=255;255===u;)c+=u=e.getUint8(s),s++;o(l,c,e,s)&&a.push([s,c]),s+=c}r+=i+4}return a},e.extractCea608DataFromRange=function(e,t){var n=t[0],i=[[],[]];n+=8;var r=31&e.getUint8(n);n+=2;for(var a=0;a<r;a++){var o=e.getUint8(n),s=4&o,l=3&o;n++;var u=e.getUint8(n);n++;var c=e.getUint8(n);n++,s&&(127&u)+(127&c)!=0&&(0===l?(i[0].push(u),i[0].push(c)):1===l&&(i[1].push(u),i[1].push(c)))}return i}}(t)},8416:function(e,t,n){"use strict";var i=n(1139),r=n(5448),a=n(6398),o=n(2032),s=(n(5530),"undefined"!=typeof window&&window||n.g),l=s.dashjs;l||(l=s.dashjs={}),l.MediaPlayer=i.Z,l.FactoryMaker=r.Z,l.Debug=a.Z,l.Version=(0,o.e)()},6398:function(e,t,n){"use strict";var i=n(5595),r=n(8512),a=n(5448),o=1,s=2,l=3,u=4,c=5;function d(e){e=e||{};var t,n,a,d,f=this.context,h=(0,i.Z)(f).getInstance(),p=e.settings,g=[];function m(e){return e&&e.bind?e.bind(window.console):window.console.log.bind(window.console)}function v(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];T.apply(void 0,[o,this].concat(t))}function y(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];T.apply(void 0,[s,this].concat(t))}function _(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];T.apply(void 0,[l,this].concat(t))}function b(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];T.apply(void 0,[u,this].concat(t))}function E(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];T.apply(void 0,[c,this].concat(t))}function T(e,t){var i="",o=null;n&&(o=(new Date).getTime(),i+="["+(o-d)+"]"),a&&t&&t.getClassName&&(i+="["+t.getClassName()+"]",t.getType&&(i+="["+t.getType()+"]")),i.length>0&&(i+=" ");for(var s=arguments.length,l=new Array(s>2?s-2:0),u=2;u<s;u++)l[u-2]=arguments[u];Array.apply(null,l).forEach(function(e){i+=e+" "}),g[e]&&p&&p.get().debug.logLevel>=e&&g[e](i),p&&p.get().debug.dispatchEvent&&h.trigger(r.Z.LOG,{message:i,level:e})}return t={getLogger:function(e){return{fatal:v.bind(e),error:y.bind(e),warn:_.bind(e),info:b.bind(e),debug:E.bind(e)}},setLogTimestampVisible:function(e){n=e},setCalleeNameVisible:function(e){a=e}},n=!0,a=!0,d=(new Date).getTime(),"undefined"!=typeof window&&window.console&&(g[o]=m(window.console.error),g[s]=m(window.console.error),g[l]=m(window.console.warn),g[u]=m(window.console.info),g[c]=m(window.console.debug)),t}d.__dashjs_factory_name="Debug";var f=a.Z.getSingletonFactory(d);f.LOG_LEVEL_NONE=0,f.LOG_LEVEL_FATAL=o,f.LOG_LEVEL_ERROR=s,f.LOG_LEVEL_WARNING=l,f.LOG_LEVEL_INFO=u,f.LOG_LEVEL_DEBUG=c,a.Z.updateSingletonFactory(d.__dashjs_factory_name,f),t.Z=f},5595:function(e,t,n){"use strict";var i=n(5448),r=n(8825);function a(){var e={};function t(t,n,i){var r=-1;return e[t]?(e[t].some(function(e,t){if(e&&e.callback===n&&(!i||i===e.scope))return r=t,!0}),r):r}var n={on:function(n,i,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!n)throw new Error("event type cannot be null or undefined");if(!i||"function"!=typeof i)throw new Error("listener must be a function: "+i);var o=a.priority||0;if(!(t(n,i,r)>=0)){e[n]=e[n]||[];var s={callback:i,scope:r,priority:o};r&&r.getStreamId&&(s.streamId=r.getStreamId()),r&&r.getType&&(s.mediaType=r.getType()),a&&a.mode&&(s.mode=a.mode);var l=e[n].some(function(t,i){if(t&&o>t.priority)return e[n].splice(i,0,s),!0});l||e[n].push(s)}},off:function(n,i,r){if(n&&i&&e[n]){var a=t(n,i,r);a<0||(e[n][a]=null)}},trigger:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t&&e[t]){if((n=n||{}).hasOwnProperty("type"))throw new Error("'type' is a reserved word for event dispatching");n.type=t,i.streamId&&(n.streamId=i.streamId),i.mediaType&&(n.mediaType=i.mediaType),e[t].filter(function(e){return!(!e||i.streamId&&e.streamId&&e.streamId!==i.streamId||i.mediaType&&e.mediaType&&e.mediaType!==i.mediaType||i.mode&&e.mode&&e.mode!==i.mode||!e.mode&&i.mode&&i.mode===r.Z.EVENT_MODE_ON_RECEIVE)}).forEach(function(e){return e&&e.callback.call(e.scope,n)})}},reset:function(){e={}}};return n}a.__dashjs_factory_name="EventBus";var o=i.Z.getSingletonFactory(a);o.EVENT_PRIORITY_LOW=0,o.EVENT_PRIORITY_HIGH=5e3,i.Z.updateSingletonFactory(a.__dashjs_factory_name,o),t.Z=o},5448:function(e,t){"use strict";var n=function(){var e,t=[],n={},i={};function r(e,n){for(var i in t){var r=t[i];if(r.context===e&&r.name===n)return r.instance}return null}function a(e,t){return t[e]}function o(e,t,n){e in n&&(n[e]=t)}function s(t,n,i){var r,a=t.__dashjs_factory_name,o=n[a];if(o){var s=o.instance;if(!o.override)return s.apply({context:n,factory:e},i);for(var l in r=t.apply({context:n},i),s=s.apply({context:n,factory:e,parent:r},i))r.hasOwnProperty(l)&&(r[l]=s[l])}else r=t.apply({context:n},i);return r.getClassName=function(){return a},r}return e={extend:function(e,t,n,i){!i[e]&&t&&(i[e]={instance:t,override:n})},getSingletonInstance:r,setSingletonInstance:function(e,n,i){for(var r in t){var a=t[r];if(a.context===e&&a.name===n)return void(t[r].instance=i)}t.push({name:n,context:e,instance:i})},deleteSingletonInstances:function(e){t=t.filter(function(t){return t.context!==e})},getSingletonFactory:function(e){var i=a(e.__dashjs_factory_name,n);return i||(i=function(n){var i;return void 0===n&&(n={}),{getInstance:function(){return i||(i=r(n,e.__dashjs_factory_name)),i||(i=s(e,n,arguments),t.push({name:e.__dashjs_factory_name,context:n,instance:i})),i}}},n[e.__dashjs_factory_name]=i),i},getSingletonFactoryByName:function(e){return a(e,n)},updateSingletonFactory:function(e,t){o(e,t,n)},getClassFactory:function(e){var t=a(e.__dashjs_factory_name,i);return t||(t=function(t){return void 0===t&&(t={}),{create:function(){return s(e,t,arguments)}}},i[e.__dashjs_factory_name]=t),t},getClassFactoryByName:function(e){return a(e,i)},updateClassFactory:function(e,t){o(e,t,i)}},e}();t.Z=n},1264:function(e,t,n){"use strict";var i=n(5448),r=n(703),a=n(6398),o=n(3393),s=n(7855),l=n(5595),u=n(8512);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(){var e,t,n=this.context,i=(0,l.Z)(n).getInstance(),f={"streaming.delay.liveDelay":u.Z.SETTING_UPDATED_LIVE_DELAY,"streaming.delay.liveDelayFragmentCount":u.Z.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,"streaming.liveCatchup.enabled":u.Z.SETTING_UPDATED_CATCHUP_ENABLED,"streaming.liveCatchup.playbackRate.min":u.Z.SETTING_UPDATED_PLAYBACK_RATE_MIN,"streaming.liveCatchup.playbackRate.max":u.Z.SETTING_UPDATED_PLAYBACK_RATE_MAX},h={debug:{logLevel:a.Z.LOG_LEVEL_WARNING,dispatchEvent:!1},streaming:{abandonLoadTimeout:1e4,wallclockTimeUpdateInterval:100,manifestUpdateRetryInterval:100,liveUpdateTimeThresholdInMilliseconds:0,cacheInitSegments:!1,applyServiceDescription:!0,applyProducerReferenceTime:!0,applyContentSteering:!0,eventControllerRefreshDelay:100,enableManifestDurationMismatchFix:!0,parseInbandPrft:!1,enableManifestTimescaleMismatchFix:!1,capabilities:{filterUnsupportedEssentialProperties:!0,useMediaCapabilitiesApi:!1},timeShiftBuffer:{calcFromSegmentTimeline:!1,fallbackToSegmentTimeline:!0},metrics:{maxListDepth:100},delay:{liveDelayFragmentCount:NaN,liveDelay:NaN,useSuggestedPresentationDelay:!0},protection:{keepProtectionMediaKeys:!1,ignoreEmeEncryptedEvent:!1,detectPlayreadyMessageFormat:!0},buffer:{enableSeekDecorrelationFix:!1,fastSwitchEnabled:!0,flushBufferAtTrackSwitch:!1,reuseExistingSourceBuffers:!0,bufferPruningInterval:10,bufferToKeep:20,bufferTimeAtTopQuality:30,bufferTimeAtTopQualityLongForm:60,initialBufferLevel:NaN,stableBufferTime:12,longFormContentDurationThreshold:600,stallThreshold:.3,useAppendWindow:!0,setStallState:!0,avoidCurrentTimeRangePruning:!1,useChangeTypeForTrackSwitch:!0,mediaSourceDurationInfinity:!0,resetSourceBuffersForTrackSwitch:!1},gaps:{jumpGaps:!0,jumpLargeGaps:!0,smallGapLimit:1.5,threshold:.3,enableSeekFix:!0,enableStallFix:!1,stallSeek:.1},utcSynchronization:{enabled:!0,useManifestDateHeaderTimeSource:!0,backgroundAttempts:2,timeBetweenSyncAttempts:30,maximumTimeBetweenSyncAttempts:600,minimumTimeBetweenSyncAttempts:2,timeBetweenSyncAttemptsAdjustmentFactor:2,maximumAllowedDrift:100,enableBackgroundSyncAfterSegmentDownloadError:!0,defaultTimingSource:{scheme:"urn:mpeg:dash:utc:http-xsdate:2014",value:"https://time.akamai.com/?iso&ms"}},scheduling:{defaultTimeout:500,lowLatencyTimeout:0,scheduleWhilePaused:!0},text:{defaultEnabled:!0,dispatchForManualRendering:!1,extendSegmentedCues:!0,imsc:{displayForcedOnlyMode:!1,enableRollUp:!0},webvtt:{customRenderingEnabled:!1}},liveCatchup:{maxDrift:NaN,playbackRate:{min:NaN,max:NaN},playbackBufferMin:.5,enabled:null,mode:o.Z.LIVE_CATCHUP_MODE_DEFAULT},lastBitrateCachingInfo:{enabled:!0,ttl:36e4},lastMediaSettingsCachingInfo:{enabled:!0,ttl:36e4},saveLastMediaSettingsForCurrentStreamingSession:!0,cacheLoadThresholds:{video:50,audio:5},trackSwitchMode:{audio:o.Z.TRACK_SWITCH_MODE_ALWAYS_REPLACE,video:o.Z.TRACK_SWITCH_MODE_NEVER_REPLACE},selectionModeForInitialTrack:o.Z.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY,fragmentRequestTimeout:2e4,fragmentRequestProgressTimeout:-1,manifestRequestTimeout:1e4,retryIntervals:(e={},d(e,s.w.MPD_TYPE,500),d(e,s.w.XLINK_EXPANSION_TYPE,500),d(e,s.w.MEDIA_SEGMENT_TYPE,1e3),d(e,s.w.INIT_SEGMENT_TYPE,1e3),d(e,s.w.BITSTREAM_SWITCHING_SEGMENT_TYPE,1e3),d(e,s.w.INDEX_SEGMENT_TYPE,1e3),d(e,s.w.MSS_FRAGMENT_INFO_SEGMENT_TYPE,1e3),d(e,s.w.LICENSE,1e3),d(e,s.w.OTHER_TYPE,1e3),d(e,"lowLatencyReductionFactor",10),e),retryAttempts:(t={},d(t,s.w.MPD_TYPE,3),d(t,s.w.XLINK_EXPANSION_TYPE,1),d(t,s.w.MEDIA_SEGMENT_TYPE,3),d(t,s.w.INIT_SEGMENT_TYPE,3),d(t,s.w.BITSTREAM_SWITCHING_SEGMENT_TYPE,3),d(t,s.w.INDEX_SEGMENT_TYPE,3),d(t,s.w.MSS_FRAGMENT_INFO_SEGMENT_TYPE,3),d(t,s.w.LICENSE,3),d(t,s.w.OTHER_TYPE,3),d(t,"lowLatencyMultiplyFactor",5),t),abr:{movingAverageMethod:o.Z.MOVING_AVERAGE_SLIDING_WINDOW,ABRStrategy:o.Z.ABR_STRATEGY_DYNAMIC,additionalAbrRules:{insufficientBufferRule:!0,switchHistoryRule:!0,droppedFramesRule:!0,abandonRequestsRule:!0},abrRulesParameters:{abandonRequestsRule:{graceTimeThreshold:500,abandonMultiplier:1.8,minLengthToAverage:5}},bandwidthSafetyFactor:.9,useDefaultABRRules:!0,useDeadTimeLatency:!0,limitBitrateByPortal:!1,usePixelRatioInLimitBitrateByPortal:!1,maxBitrate:{audio:-1,video:-1},minBitrate:{audio:-1,video:-1},maxRepresentationRatio:{audio:1,video:1},initialBitrate:{audio:-1,video:-1},initialRepresentationRatio:{audio:-1,video:-1},autoSwitchBitrate:{audio:!0,video:!0},fetchThroughputCalculationMode:o.Z.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING},cmcd:{enabled:!1,sid:null,cid:null,rtp:null,rtpSafetyFactor:5,mode:o.Z.CMCD_MODE_QUERY,enabledKeys:["br","d","ot","tb","bl","dl","mtp","nor","nrr","su","bs","rtp","cid","pr","sf","sid","st","v"]},cmsd:{enabled:!1,abr:{applyMb:!1,etpWeightRatio:0}}},errors:{recoverAttempts:{mediaErrorDecode:5}}},p=r.Z.clone(h);function g(e,t,n){for(var a in e)e.hasOwnProperty(a)&&(t.hasOwnProperty(a)?"object"!==c(e[a])||e[a]instanceof Array||null===e[a]?(t[a]=r.Z.clone(e[a]),f[n+a]&&i.trigger(f[n+a])):g(e[a],t[a],n.slice()+a+"."):console.error("Settings parameter "+n+a+" is not supported"))}return{get:function(){return p},update:function(e){"object"===c(e)&&g(e,p,"")},reset:function(){p=r.Z.clone(h)}}}f.__dashjs_factory_name="Settings";var h=i.Z.getSingletonFactory(f);t.Z=h},703:function(e,t,n){"use strict";var i=n(3875),r=n.n(i),a=n(1067);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"mixin",value:function(t,n,i){var r,a={};if(t)for(var s in n)n.hasOwnProperty(s)&&(r=n[s],s in t&&(t[s]===r||s in a&&a[s]===r)||("object"===o(t[s])&&null!==t[s]?t[s]=e.mixin(t[s],r,i):t[s]=i(r)));return t}},{key:"clone",value:function(t){if(!t||"object"!==o(t))return t;var n;if(t instanceof Array){n=[];for(var i=0,r=t.length;i<r;++i)i in t&&n.push(e.clone(t[i]))}else n={};return e.mixin(n,t,e.clone)}},{key:"addAditionalQueryParameterToUrl",value:function(e,t){try{if(!t||0===t.length)return e;var n=new URL(e);return t.forEach(function(e){e.key&&e.value&&n.searchParams.set(e.key,e.value)}),n.href}catch(t){return e}}},{key:"parseHttpHeaders",value:function(e){var t={};if(!e)return t;for(var n=e.trim().split("\r\n"),i=0,r=n.length;i<r;i++){var a=n[i],o=a.indexOf(": ");o>0&&(t[a.substring(0,o)]=a.substring(o+2))}return t}},{key:"generateUuid",value:function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)})}},{key:"generateHashCode",value:function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t}},{key:"getRelativeUrl",value:function(e,t){try{var n=new URL(e),i=new URL(t);if(n.protocol=i.protocol,n.origin!==i.origin)return t;var a=r().relative(n.pathname.substr(0,n.pathname.lastIndexOf("/")),i.pathname.substr(0,i.pathname.lastIndexOf("/"))),o=0===a.length?1:0;return a+=i.pathname.substr(i.pathname.lastIndexOf("/")+o,i.pathname.length-1),i.pathname.length<a.length?i.pathname:a}catch(e){return t}}},{key:"parseUserAgent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{var t=null===e&&"undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"";return(0,a.UAParser)(t)}catch(e){return{}}}},{key:"stringHasProtocol",value:function(e){return/(http(s?)):\/\//i.test(e)}}],n&&s(t,n),e}();t.Z=l},2032:function(e,t,n){"use strict";function i(){return"4.7.4"}n.d(t,{e:function(){return i}})},2230:function(e,t){"use strict";function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i;return t=e,(i=[{key:"extend",value:function(e,t){if(e){var n=!!t&&t.override,i=!!t&&t.publicOnly;for(var r in e)!e.hasOwnProperty(r)||this[r]&&!n||i&&-1===e[r].indexOf("public_")||(this[r]=e[r])}}}])&&n(t.prototype,i),e}();t.Z=i},4351:function(e,t,n){"use strict";function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function r(e,t){return r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(e,t)}function a(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function o(e){return o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},o(e)}var s=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=o(t);if(n){var r=o(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return a(this,e)});function s(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(e=i.call(this)).ATTEMPT_BACKGROUND_SYNC="attemptBackgroundSync",e.BUFFERING_COMPLETED="bufferingCompleted",e.BUFFER_CLEARED="bufferCleared",e.BYTES_APPENDED_END_FRAGMENT="bytesAppendedEndFragment",e.BUFFER_REPLACEMENT_STARTED="bufferReplacementStarted",e.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",e.CMSD_STATIC_HEADER="cmsdStaticHeader",e.CURRENT_TRACK_CHANGED="currentTrackChanged",e.DATA_UPDATE_COMPLETED="dataUpdateCompleted",e.INBAND_EVENTS="inbandEvents",e.INITIAL_STREAM_SWITCH="initialStreamSwitch",e.INIT_FRAGMENT_LOADED="initFragmentLoaded",e.INIT_FRAGMENT_NEEDED="initFragmentNeeded",e.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",e.ORIGINAL_MANIFEST_LOADED="originalManifestLoaded",e.LOADING_COMPLETED="loadingCompleted",e.LOADING_PROGRESS="loadingProgress",e.LOADING_DATA_PROGRESS="loadingDataProgress",e.LOADING_ABANDONED="loadingAborted",e.MANIFEST_UPDATED="manifestUpdated",e.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",e.MEDIA_FRAGMENT_NEEDED="mediaFragmentNeeded",e.QUOTA_EXCEEDED="quotaExceeded",e.SEGMENT_LOCATION_BLACKLIST_ADD="segmentLocationBlacklistAdd",e.SEGMENT_LOCATION_BLACKLIST_CHANGED="segmentLocationBlacklistChanged",e.SERVICE_LOCATION_BASE_URL_BLACKLIST_ADD="serviceLocationBlacklistAdd",e.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",e.SERVICE_LOCATION_LOCATION_BLACKLIST_ADD="serviceLocationLocationBlacklistAdd",e.SERVICE_LOCATION_LOCATION_BLACKLIST_CHANGED="serviceLocationLocationBlacklistChanged",e.SET_FRAGMENTED_TEXT_AFTER_DISABLED="setFragmentedTextAfterDisabled",e.SET_NON_FRAGMENTED_TEXT="setNonFragmentedText",e.SOURCE_BUFFER_ERROR="sourceBufferError",e.STREAMS_COMPOSED="streamsComposed",e.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",e.STREAM_REQUESTING_COMPLETED="streamRequestingCompleted",e.TEXT_TRACKS_QUEUE_INITIALIZED="textTracksQueueInitialized",e.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",e.UPDATE_TIME_SYNC_OFFSET="updateTimeSyncOffset",e.URL_RESOLUTION_FAILED="urlResolutionFailed",e.VIDEO_CHUNK_RECEIVED="videoChunkReceived",e.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",e.XLINK_ELEMENT_LOADED="xlinkElementLoaded",e.XLINK_READY="xlinkReady",e.SEEK_TARGET="seekTarget",e.SETTING_UPDATED_LIVE_DELAY="settingUpdatedLiveDelay",e.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT="settingUpdatedLiveDelayFragmentCount",e.SETTING_UPDATED_CATCHUP_ENABLED="settingUpdatedCatchupEnabled",e.SETTING_UPDATED_PLAYBACK_RATE_MIN="settingUpdatedPlaybackRateMin",e.SETTING_UPDATED_PLAYBACK_RATE_MAX="settingUpdatedPlaybackRateMax",e}return s}(n(8342).Z);t.Z=s},8512:function(e,t,n){"use strict";function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){return a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},a(e,t)}function o(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(l,e);var t,n,i=(t=l,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=s(t);if(n){var r=s(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return o(this,e)});function l(){return r(this,l),i.apply(this,arguments)}return l}(n(4351).Z),u=new l;t.Z=u},8342:function(e,t){"use strict";function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i;return t=e,(i=[{key:"extend",value:function(e,t){if(e){var n=!!t&&t.override,i=!!t&&t.publicOnly;for(var r in e)!e.hasOwnProperty(r)||this[r]&&!n||i&&-1===e[r].indexOf("public_")||(this[r]=e[r])}}}])&&n(t.prototype,i),e}();t.Z=i},9326:function(e,t,n){"use strict";var i=n(3186),r=n(7855),a=n(5448),o=n(8825),s=n(7387),l=n(1553);function u(e){var t,n,a,u,c,d=(e=e||{}).eventBus,f=e.debug,h=e.urlUtils,p=e.type,g=e.streamInfo,m=e.segmentsController,v=e.timelineConverter,y=e.baseURLController;function _(){return p}function b(){a=null}function E(e,t,n){var i,r,a=y.resolve(n.path),o={};return a&&t!==a.url&&h.isRelative(t)?(i=a.url,r=a.serviceLocation,o=a.queryParams,t&&(i=h.resolve(t,i))):i=t,!h.isRelative(i)&&(e.url=i,e.serviceLocation=r,e.queryParams=o,!0)}function T(e,t){if(null==t)return null;var n=new i.Z,a=t.representation,o=a.adaptation.period.mpd.manifest.Period_asArray[a.adaptation.period.index].AdaptationSet_asArray[a.adaptation.index].Representation_asArray[a.index].bandwidth,l=t.media;return l=(0,s.vi)(l,"Number",t.replacementNumber),l=(0,s.vi)(l,"Time",t.replacementTime),l=(0,s.vi)(l,"Bandwidth",o),l=(0,s.Aj)(l,a.id),l=(0,s.eR)(l),n.mediaType=_(),n.type=r.w.MEDIA_SEGMENT_TYPE,n.range=t.mediaRange,n.startTime=t.presentationStartTime,n.mediaStartTime=t.mediaStartTime,n.duration=t.duration,n.timescale=a.timescale,n.availabilityStartTime=t.availabilityStartTime,n.availabilityEndTime=t.availabilityEndTime,n.availabilityTimeComplete=a.availabilityTimeComplete,n.wallStartTime=t.wallStartTime,n.quality=a.index,n.index=t.index,n.mediaInfo=e,n.adaptationIndex=a.adaptation.index,n.representationId=a.id,E(n,l,a)?n:void 0}function S(e,t,i){var r=null;if(!t||!t.segmentInfoType)return r;var o=m.getSegmentByTime(t,i);return o&&(a=o,n.debug("Index for time "+i+" is "+o.index),r=T(e,o)),r}function w(e,t,i){var r=null,o=m.getSegmentByIndex(t,i,a?a.mediaStartTime:-1);if(o)r=T(e,o),a=o;else{if(u&&!c)return n.debug(_()+" No segment found at index: "+i+". Wait for next loop"),null;c=!0}return r}function A(){n.debug("Dynamic stream complete"),c=!0}return t={getCurrentIndex:function(){return a?a.index:-1},getInitRequest:function(e,t){return t?function(e,t,n){var a=new i.Z,o=t.adaptation.period,l=o.start;if(a.mediaType=n,a.type=r.w.INIT_SEGMENT_TYPE,a.range=t.range,a.availabilityStartTime=v.calcAvailabilityStartTimeFromPresentationTime(l,t,u),a.availabilityEndTime=v.calcAvailabilityEndTimeFromPresentationTime(l+o.duration,t,u),a.quality=t.index,a.mediaInfo=e,a.representationId=t.id,E(a,t.initialization,t))return a.url=(0,s.vi)(a.url,"Bandwidth",t.bandwidth),a}(e,t,_()):null},getNextSegmentRequest:function(e,t){return t&&t.segmentInfoType?w(e,t,a?a.index+1:0):null},getNextSegmentRequestIdempotent:function(e,t){var n=a?a.index+1:0,i=m.getSegmentByIndex(t,n,a?a.mediaStartTime:-1);return i?T(e,i):null},getSegmentRequestForTime:S,getStreamId:function(){return g.id},getStreamInfo:function(){return g},getType:_,getValidTimeAheadOfTargetTime:function(e,t,n,i){try{if(isNaN(e)||!t||!n)return NaN;if(e<0&&(e=0),isNaN(i)&&(i=.5),S(t,n,e))return e;if(n.adaptation.period.start+n.adaptation.period.duration<e)return NaN;for(var r=isFinite(n.adaptation.period.duration)?n.adaptation.period.start+n.adaptation.period.duration:e+30,a=Math.min(e+i,r),o=NaN,s=null;a<=r;){var l=null;if(a<=r&&(l=S(t,n,a)),l){o=a,s=l;break}a+=i}if(s){var u=s.startTime+s.duration;return e>s.startTime&&u-e>i?e:!isNaN(s.startTime)&&e<s.startTime&&o>s.startTime?s.startTime+.001:Math.min(u-i,o)}return o}catch(e){return NaN}},initialize:function(e){u=e,c=!1,m.initialize(e)},isLastSegmentRequested:function(e,t){if(!e||!a)return!1;if(c)return!0;if(!isFinite(e.adaptation.period.duration))return!1;if(a.presentationStartTime+a.duration>t)return!1;if(e.mediaFinishedInformation&&!isNaN(e.mediaFinishedInformation.numberOfSegments)&&!isNaN(a.index)&&a.index>=e.mediaFinishedInformation.numberOfSegments-1){if(!u||e.segmentInfoType===l.Z.SEGMENT_TEMPLATE)return!0;if(u&&e.segmentInfoType===l.Z.SEGMENT_LIST&&e.adaptation.period.nextPeriodId)return!0}return!!(u&&e.adaptation.period.nextPeriodId&&e.segmentInfoType===l.Z.SEGMENT_TIMELINE&&e.mediaFinishedInformation&&!isNaN(e.mediaFinishedInformation.mediaTimeOfLastSignaledSegment)&&a&&!isNaN(a.mediaStartTime)&&!isNaN(a.duration)&&a.mediaStartTime+a.duration>=e.mediaFinishedInformation.mediaTimeOfLastSignaledSegment-.05)},repeatSegmentRequest:function(e,t){return t&&t.segmentInfoType?w(e,t,a?a.index:0):null},reset:function(){b(),d.off(o.Z.DYNAMIC_TO_STATIC,A,t)}},n=f.getLogger(t),b(),d.on(o.Z.DYNAMIC_TO_STATIC,A,t),t}u.__dashjs_factory_name="DashHandler",t.Z=a.Z.getClassFactory(u)},1553:function(e,t){"use strict";function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}var t,i;return t=e,(i=[{key:"init",value:function(){this.BASE_URL="BaseURL",this.SEGMENT_BASE="SegmentBase",this.SEGMENT_TEMPLATE="SegmentTemplate",this.SEGMENT_LIST="SegmentList",this.SEGMENT_URL="SegmentURL",this.SEGMENT_TIMELINE="SegmentTimeline",this.SEGMENT_PROFILES="segmentProfiles",this.ADAPTATION_SET="AdaptationSet",this.REPRESENTATION="Representation",this.REPRESENTATION_INDEX="RepresentationIndex",this.SUB_REPRESENTATION="SubRepresentation",this.INITIALIZATION="Initialization",this.INITIALIZATION_MINUS="initialization",this.MPD="MPD",this.PERIOD="Period",this.ASSET_IDENTIFIER="AssetIdentifier",this.EVENT_STREAM="EventStream",this.ID="id",this.PROFILES="profiles",this.SERVICE_LOCATION="serviceLocation",this.RANGE="range",this.INDEX="index",this.MEDIA="media",this.BYTE_RANGE="byteRange",this.INDEX_RANGE="indexRange",this.MEDIA_RANGE="mediaRange",this.VALUE="value",this.CONTENT_TYPE="contentType",this.MIME_TYPE="mimeType",this.BITSTREAM_SWITCHING="BitstreamSwitching",this.BITSTREAM_SWITCHING_MINUS="bitstreamSwitching",this.CODECS="codecs",this.DEPENDENCY_ID="dependencyId",this.MEDIA_STREAM_STRUCTURE_ID="mediaStreamStructureId",this.METRICS="Metrics",this.METRICS_MINUS="metrics",this.REPORTING="Reporting",this.WIDTH="width",this.HEIGHT="height",this.SAR="sar",this.FRAMERATE="frameRate",this.AUDIO_SAMPLING_RATE="audioSamplingRate",this.MAXIMUM_SAP_PERIOD="maximumSAPPeriod",this.START_WITH_SAP="startWithSAP",this.MAX_PLAYOUT_RATE="maxPlayoutRate",this.CODING_DEPENDENCY="codingDependency",this.SCAN_TYPE="scanType",this.FRAME_PACKING="FramePacking",this.AUDIO_CHANNEL_CONFIGURATION="AudioChannelConfiguration",this.CONTENT_PROTECTION="ContentProtection",this.ESSENTIAL_PROPERTY="EssentialProperty",this.ESSENTIAL_PROPERTY_ASARRAY="EssentialProperty_asArray",this.SUPPLEMENTAL_PROPERTY="SupplementalProperty",this.SUPPLEMENTAL_PROPERTY_ASARRAY="SupplementalProperty_asArray",this.INBAND_EVENT_STREAM="InbandEventStream",this.PRODUCER_REFERENCE_TIME="ProducerReferenceTime",this.INBAND="inband",this.TYPE="type",this.ACCESSIBILITY="Accessibility",this.ROLE="Role",this.RATING="Rating",this.CONTENT_COMPONENT="ContentComponent",this.SUBSET="Subset",this.LANG="lang",this.VIEWPOINT="Viewpoint",this.VIEWPOINT_ASARRAY="Viewpoint_asArray",this.ROLE_ASARRAY="Role_asArray",this.REPRESENTATION_ASARRAY="Representation_asArray",this.PRODUCERREFERENCETIME_ASARRAY="ProducerReferenceTime_asArray",this.ACCESSIBILITY_ASARRAY="Accessibility_asArray",this.AUDIOCHANNELCONFIGURATION_ASARRAY="AudioChannelConfiguration_asArray",this.CONTENTPROTECTION_ASARRAY="ContentProtection_asArray",this.MAIN="main",this.DYNAMIC="dynamic",this.STATIC="static",this.MEDIA_PRESENTATION_DURATION="mediaPresentationDuration",this.MINIMUM_UPDATE_PERIOD="minimumUpdatePeriod",this.CODEC_PRIVATE_DATA="codecPrivateData",this.BANDWITH="bandwidth",this.SOURCE_URL="sourceURL",this.TIMESCALE="timescale",this.DURATION="duration",this.START_NUMBER="startNumber",this.PRESENTATION_TIME_OFFSET="presentationTimeOffset",this.AVAILABILITY_START_TIME="availabilityStartTime",this.AVAILABILITY_END_TIME="availabilityEndTime",this.TIMESHIFT_BUFFER_DEPTH="timeShiftBufferDepth",this.MAX_SEGMENT_DURATION="maxSegmentDuration",this.PRESENTATION_TIME="presentationTime",this.MIN_BUFFER_TIME="minBufferTime",this.MAX_SUBSEGMENT_DURATION="maxSubsegmentDuration",this.START="start",this.AVAILABILITY_TIME_OFFSET="availabilityTimeOffset",this.AVAILABILITY_TIME_COMPLETE="availabilityTimeComplete",this.CENC_DEFAULT_KID="cenc:default_KID",this.DVB_PRIORITY="dvb:priority",this.DVB_WEIGHT="dvb:weight",this.DVB_URL="dvb:url",this.DVB_MIMETYPE="dvb:mimeType",this.DVB_FONTFAMILY="dvb:fontFamily",this.SUGGESTED_PRESENTATION_DELAY="suggestedPresentationDelay",this.SERVICE_DESCRIPTION="ServiceDescription",this.SERVICE_DESCRIPTION_SCOPE="Scope",this.SERVICE_DESCRIPTION_LATENCY="Latency",this.SERVICE_DESCRIPTION_PLAYBACK_RATE="PlaybackRate",this.SERVICE_DESCRIPTION_OPERATING_QUALITY="OperatingQuality",this.SERVICE_DESCRIPTION_OPERATING_BANDWIDTH="OperatingBandwidth",this.PATCH_LOCATION="PatchLocation",this.PATCH_LOCATION_AS_ARRAY="PatchLocation_asArray",this.LOCATION="Location",this.LOCATION_AS_ARRAY="Location_asArray",this.PUBLISH_TIME="publishTime",this.ORIGINAL_PUBLISH_TIME="originalPublishTime",this.ORIGINAL_MPD_ID="mpdId",this.WALL_CLOCK_TIME="wallClockTime",this.PRESENTATION_TIME="presentationTime",this.LABEL="Label",this.GROUP_LABEL="GroupLabel",this.CONTENT_STEERING="ContentSteering",this.CONTENT_STEERING_AS_ARRAY="ContentSteering_asArray",this.DEFAULT_SERVICE_LOCATION="defaultServiceLocation",this.QUERY_BEFORE_START="queryBeforeStart",this.CLIENT_REQUIREMENT="clientRequirement",this.TTL="ttl",this.CONTENT_STEERING_RESPONSE={VERSION:"VERSION",TTL:"TTL",RELOAD_URI:"RELOAD-URI",PATHWAY_PRIORITY:"PATHWAY-PRIORITY",PATHWAY_CLONES:"PATHWAY-CLONES",BASE_ID:"BASE-ID",ID:"ID",URI_REPLACEMENT:"URI-REPLACEMENT",HOST:"HOST",PARAMS:"PARAMS"},this.PRODUCER_REFERENCE_TIME_TYPE={ENCODER:"encoder",CAPTURED:"captured",APPLICATION:"application"},this.SEGMENT_ALIGNMENT="segmentAlignment",this.SUB_SEGMENT_ALIGNMENT="subsegmentAlignment"}}])&&n(t.prototype,i),e}());t.Z=i},7802:function(e,t,n){"use strict";var i=n(5448),r=n(1724),a=n(3636),o=n(1736),s=n(5246);function l(e){e=e||{};var t,n,i=this.context,l=e.dashConstants,u=e.type,c=e.segmentBaseController;function d(e){return e?e.segments?n[l.SEGMENT_BASE]:n[e.segmentInfoType]:null}return t={initialize:function(t){n[l.SEGMENT_TIMELINE]=(0,r.Z)(i).create(e,t),n[l.SEGMENT_TEMPLATE]=(0,a.Z)(i).create(e,t),n[l.SEGMENT_LIST]=(0,o.Z)(i).create(e,t),n[l.SEGMENT_BASE]=(0,s.Z)(i).create(e,t)},updateInitData:function(e,t){return t?Promise.resolve():c.getSegmentBaseInitSegment({representation:e,mediaType:u})},updateSegmentData:function(e,t){return t?Promise.resolve():c.getSegmentList({mimeType:e.mimeType,representation:e,mediaType:u})},getSegmentByIndex:function(e,t,n){var i=d(e);return i?i.getSegmentByIndex(e,t,n):null},getSegmentByTime:function(e,t){var n=d(e);return n?n.getSegmentByTime(e,t):null},getMediaFinishedInformation:function(e){var t=d(e);return t?t.getMediaFinishedInformation(e):{numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN}}},n={},t}l.__dashjs_factory_name="SegmentsController";var u=i.Z.getClassFactory(l);t.Z=u},1736:function(e,t,n){"use strict";var i=n(5448),r=n(3393),a=n(7387);function o(e,t){var n=(e=e||{}).timelineConverter;function i(){if(!n||!n.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(r.Z.MISSING_CONFIG_ERROR)}function o(e,r){if(i(),!e)return null;var o=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,s=o.SegmentURL_asArray.length,l=e&&!isNaN(e.startNumber)?e.startNumber:1,u=Math.max(l-1,0),c=Math.max(r-u,0),d=null;if(c<s){var f=o.SegmentURL_asArray[c];(d=(0,a.NF)(n,t,e,r))&&(d.replacementTime=(l+r-1)*e.segmentDuration,d.media=f.media?f.media:"",d.mediaRange=f.mediaRange,d.indexRange=f.indexRange)}return d}return{getSegmentByIndex:o,getSegmentByTime:function(e,t){if(i(),!e)return null;var r=e.segmentDuration;if(isNaN(r))return null;var a=n.calcPeriodRelativeTimeFromMpdRelativeTime(e,t);return o(e,Math.floor(a/r))},getMediaFinishedInformation:function(e){var t={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};if(!e)return t;var n=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,i=e&&!isNaN(e.startNumber)?e.startNumber:1,r=Math.max(i-1,0);return t.numberOfSegments=r+n.SegmentURL_asArray.length,t}}}o.__dashjs_factory_name="ListSegmentsGetter";var s=i.Z.getClassFactory(o);t.Z=s},5246:function(e,t,n){"use strict";var i=n(5448),r=n(3393);function a(e){var t=(e=e||{}).timelineConverter;function n(){if(!t||!t.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(r.Z.MISSING_CONFIG_ERROR)}function i(e,t){if(n(),!e)return null;var i,r=e.segments?e.segments.length:-1;if(t<r&&(i=e.segments[t])&&i.index===t)return i;for(var a=0;a<r;a++)if((i=e.segments[a])&&i.index===t)return i;return null}return{getSegmentByIndex:i,getSegmentByTime:function(e,t){n();var r=function(e,t){if(!e)return-1;var n,i,r,a,o,s=e.segments,l=s?s.length:null,u=-1;if(s&&l>0)for(o=0;o<l;o++)if(r=(i=s[o]).presentationStartTime,t+(n=(a=i.duration)/2)>=r&&t-n<r+a){u=i.index;break}return u}(e,t);return i(e,r)},getMediaFinishedInformation:function(e){var t={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};return e&&e.segments?(t.numberOfSegments=e.segments.length,t):t}}}a.__dashjs_factory_name="SegmentBaseGetter";var o=i.Z.getClassFactory(a);t.Z=o},7387:function(e,t,n){"use strict";n.d(t,{Aj:function(){return o},NF:function(){return c},TJ:function(){return d},eR:function(){return a},vi:function(){return s}});var i=n(2011);function r(e,t){for(;e.length<t;)e="0"+e;return e}function a(e){return e?e.split("$$").join("$"):e}function o(e,t){if(!t||!e||-1===e.indexOf("$RepresentationID$"))return e;var n=t.toString();return e.split("$RepresentationID$").join(n)}function s(e,t,n){var i,a,o,s,l,u,c=t.length,d="%0".length;if(!e)return e;for(;;){if((i=e.indexOf("$"+t))<0)return e;if((a=e.indexOf("$",i+c))<0)return e;if((o=e.indexOf("%0",i+c))>i&&o<a)switch(s=e.charAt(a-1),l=parseInt(e.substring(o+d,a-1),10),s){case"d":case"i":case"u":u=r(n.toString(),l);break;case"x":u=r(n.toString(16),l);break;case"X":u=r(n.toString(16),l).toUpperCase();break;case"o":u=r(n.toString(8),l);break;default:return e}else u=n;e=e.substring(0,i)+u+e.substring(a+1)}}function l(e,t,n,r,a,o,s,l){var u,c=new i.Z;return c.representation=e,c.duration=t,c.presentationStartTime=n,c.mediaStartTime=r,c.availabilityStartTime=a.calcAvailabilityStartTimeFromPresentationTime(o,e,s),c.availabilityEndTime=a.calcAvailabilityEndTimeFromPresentationTime(o+t,e,s),c.wallStartTime=a.calcWallTimeForSegment(c,s),c.replacementNumber=(u=l,c.representation.startNumber+u),c.index=l,c}function u(e,t,n,i){var r=t.adaptation.period;if(isFinite(r.duration)&&r.start+r.duration<=n.presentationStartTime)return!1;if(i){if("INF"===t.availabilityTimeOffset)return!0;var a=e.getClientReferenceTime();return n.availabilityStartTime.getTime()<=a&&(!isFinite(n.availabilityEndTime)||n.availabilityEndTime.getTime()>=a)}return!0}function c(e,t,n,i){var r,a,o;r=n.segmentDuration,isNaN(r)&&(r=n.adaptation.period.duration),a=parseFloat((n.adaptation.period.start+i*r).toFixed(5)),o=parseFloat((a+r).toFixed(5));var s=l(n,r,a,e.calcMediaTimeFromPresentationTime(a,n),e,o,t,i);return u(e,n,s,t)?s:null}function d(e,t,n,i,r,a,o,c,d,f){var h,p,g=i/a,m=r/a;return h=e.calcPresentationTimeFromMediaTime(g,n),u(e,n,p=l(n,m,h,g,e,h+m,t,d),t)?(p.replacementTime=f||i,o=s(o,"Number",p.replacementNumber),o=s(o,"Time",p.replacementTime),p.media=o,p.mediaRange=c,p):null}},3636:function(e,t,n){"use strict";var i=n(5448),r=n(3393),a=n(7387);function o(e,t){var n=(e=e||{}).timelineConverter;function i(){if(!n||!n.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(r.Z.MISSING_CONFIG_ERROR)}function o(e,r){if(i(),!e)return null;var o=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate;r=Math.max(r,0);var s=(0,a.NF)(n,t,e,r);if(s){s.replacementTime=Math.round((r-1)*e.segmentDuration*e.timescale,10);var l=o.media;l=(0,a.vi)(l,"Number",s.replacementNumber),l=(0,a.vi)(l,"Time",s.replacementTime),s.media=l}return s}return{getSegmentByIndex:o,getSegmentByTime:function(e,t){if(i(),!e)return null;var r=e.segmentDuration;if(isNaN(r))return null;var a=n.calcPeriodRelativeTimeFromMpdRelativeTime(e,t);return o(e,Math.floor(a/r))},getMediaFinishedInformation:function(e){var t={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};if(!e)return t;var n=e.segmentDuration;return isNaN(n)?t.numberOfSegments=1:t.numberOfSegments=Math.ceil(e.adaptation.period.duration/n),t}}}o.__dashjs_factory_name="TemplateSegmentsGetter";var s=i.Z.getClassFactory(o);t.Z=s},1724:function(e,t,n){"use strict";var i=n(5448),r=n(3393),a=n(7387);function o(e,t){var n=(e=e||{}).timelineConverter,i=e.dashMetrics;function o(){if(!n)throw new Error(r.Z.MISSING_CONFIG_ERROR)}function s(e,t){var n,i,r,a,o,s,u,c=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate||e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,d=c.SegmentTimeline,f=c.SegmentURL_asArray,h=0,p=-1;u=e.timescale;var g=!1;for(r=0,a=(n=d.S_asArray).length;r<a&&!g;r++)for(s=0,(i=n[r]).hasOwnProperty("r")&&(s=i.r),i.hasOwnProperty("t")&&(h=i.t),s<0&&(s=l(e,n[r+1],i,u,h/u)),o=0;o<=s&&!g;o++)(g=t(h,c,f,i,u,++p,r))&&(e.segmentDuration=i.d/u),h+=i.d}function l(e,t,r,a,o){var s;if(t&&t.hasOwnProperty("t"))s=t.t/a;else try{var l=0;if(isNaN(e.adaptation.period.start)||isNaN(e.adaptation.period.duration)||!isFinite(e.adaptation.period.duration)){var u=i.getCurrentDVRInfo();l=isNaN(u.end)?0:u.end}else l=e.adaptation.period.start+e.adaptation.period.duration;s=n.calcMediaTimeFromPresentationTime(l,e),e.segmentDuration=r.d/a}catch(e){s=0}return Math.max(Math.ceil((s-o)/(r.d/a))-1,0)}return{getSegmentByIndex:function(e,i,r){if(o(),!e)return null;var l=null,u=!1;return s(e,function(i,o,s,c,d,f,h){if(u||r<0){var p=o.media,g=c.mediaRange;return s&&(p=s[h].media||"",g=s[h].mediaRange),l=(0,a.TJ)(n,t,e,i,c.d,d,p,g,f,c.tManifest),!0}return i>=r*d-.5*c.d&&(u=!0),!1}),l},getSegmentByTime:function(e,i){if(o(),!e)return null;void 0===i&&(i=null);var r=null,l=n.calcMediaTimeFromPresentationTime(i,e);return s(e,function(i,o,s,u,c,d,f){var h=parseFloat((l*c).toPrecision(15));if(h<i+u.d&&h>=i){var p=o.media,g=u.mediaRange;return s&&(p=s[f].media||"",g=s[f].mediaRange),r=(0,a.TJ)(n,t,e,i,u.d,c,p,g,d,u.tManifest),!0}return!1}),r},getMediaFinishedInformation:function(e){if(!e)return 0;var t,n,i,r,a,o,s,u=(e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate||e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList).SegmentTimeline,c=0,d=0,f=0;for(s=e.timescale,r=(t=u.S_asArray).length,i=0;i<r;i++)for(o=0,(n=t[i]).hasOwnProperty("r")&&(o=n.r),n.hasOwnProperty("t")&&(d=(c=n.t)/s),o<0&&(o=l(e,t[i+1],n,s,d)),a=0;a<=o;a++)f++,d=(c+=n.d)/s;return{numberOfSegments:f,mediaTimeOfLastSignaledSegment:d}}}}o.__dashjs_factory_name="TimelineSegmentsGetter";var s=i.Z.getClassFactory(o);t.Z=s},2011:function(e,t){"use strict";t.Z=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.wallStartTime=NaN,this.representation=null}},2610:function(e,t){"use strict";t.Z=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.schemeIdUri="",this.value=""}},1139:function(e,t,n){"use strict";n.d(t,{Z:function(){return Ja}});var i=n(452),r=n.n(i),a=n(3393),o=n(1553),s=n(3860),l=n(5595),u=n(8512),c=n(5448),d=n(6398),f=n(8825);function h(){var e,t,n,i,r,o,c,h,p,g,m,v,y,_,b,E,T,S,w,A,I,x,R,C,D,k=this.context,M=(0,l.Z)(k).getInstance();function L(){F(),_=!1,g=0,m=0,T=0,R=!1,S=!0,w=!1,C=!1,A=NaN,E=NaN,c&&(M.off(u.Z.DATA_UPDATE_COMPLETED,Q,e),M.off(u.Z.LOADING_PROGRESS,ye,e),M.off(u.Z.MANIFEST_UPDATED,Te,e),M.off(u.Z.STREAMS_COMPOSED,Se,e),M.off(f.Z.PLAYBACK_ENDED,ge,e),M.off(f.Z.STREAM_INITIALIZING,be,e),M.off(f.Z.REPRESENTATION_SWITCH,Ee,e),M.off(f.Z.BUFFER_LEVEL_STATE_CHANGED,te,e),X(),c.removeEventListener("canplay",J),c.removeEventListener("canplaythrough",ee),c.removeEventListener("play",ne),c.removeEventListener("waiting",ie),c.removeEventListener("playing",re),c.removeEventListener("pause",ae),c.removeEventListener("error",me),c.removeEventListener("seeking",oe),c.removeEventListener("seeked",se),c.removeEventListener("timeupdate",le),c.removeEventListener("progress",ue),c.removeEventListener("ratechange",ce),c.removeEventListener("loadedmetadata",de),c.removeEventListener("loadeddata",fe),c.removeEventListener("stalled",_e),c.removeEventListener("ended",he),c.removeEventListener("volumechange",pe)),p=null,c=null,v=null,y=null}function P(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return parseFloat((N(e)-j()).toFixed(5))}function N(e){var t=e||v;return t.start+t.duration}function O(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];v&&c&&c.getElement()?(e&&y&&G(j()),c.play()):_=!0}function F(){v&&c&&c.pause()}function U(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(v&&c&&c.getElement()){var a=isNaN(A)?c.getTime():A;e!==a&&((I=!0===i)||(A=e),t.info("Requesting seek to time: "+e+(I?" (internal)":"")),y&&r&&G(e),c.setCurrentTime(e,n))}}function B(){if(v&&c&&y){var e=n&&n.hasVideoTrack()?a.Z.VIDEO:a.Z.AUDIO,t=r.getCurrentDVRInfo(e);return t&&t.range?t.range.end:0}}function G(e){var t=new Date(h.getClientReferenceTime()),n=o.getRegularPeriods()[0],i=h.calcPresentationTimeFromWallTime(t,n);g=i-e}function j(){return v&&c?c.getTime():null}function V(){return v&&c?c.isPaused():null}function H(){return v&&c?c.isSeeking():null}function K(){return v&&c?c.isStalled():null}function z(){return v&&c?c.getPlaybackRate():null}function Z(){return v&&c?c.getEnded():null}function q(){return y}function Y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!V()&&y&&0!==c.getReadyState()&&!H()&&!R){e||(e=n.hasVideoTrack()?a.Z.VIDEO:a.Z.AUDIO);var i=j(),r=W(i,e),o=!isNaN(r)&&r!==i;o&&!H()&&(K()||x||1===c.getReadyState())&&(t.debug("UpdateCurrentTime: Seek to actual time: ".concat(r," from currentTime: ").concat(i)),U(r,!1,!1))}}function W(e,t){var n=r.getCurrentDVRInfo(t),i=n?n.range:null;return i?e>i.end?Math.max(i.end-g,i.start):e>0&&e+.25<i.start&&Math.abs(e-i.start)<31536e4?w?Math.max(i.end-g,i.start):i.start:e:NaN}function $(){null===p&&(p=setInterval(function(){!function(){if(M.trigger(u.Z.WALLCLOCK_TIME_UPDATED,{isDynamic:y,time:new Date}),q()){var e=Date.now();(isNaN(E)||e>E+D.get().streaming.liveUpdateTimeThresholdInMilliseconds)&&(n.addDVRMetric(),V()?function(){var e=Date.now();(!b||e>b+500)&&(b=e,le())}():Y(),E=e)}}()},D.get().streaming.wallclockTimeUpdateInterval))}function X(){clearInterval(p),p=null}function Q(e){var t=o.convertRepresentationToRepresentationInfo(e.currentRepresentation),n=t?t.mediaInfo.streamInfo:null;null!==n&&v.id===n.id&&(v=n)}function J(){M.trigger(u.Z.CAN_PLAY)}function ee(){M.trigger(u.Z.CAN_PLAY_THROUGH)}function te(e){e.streamId===n.getActiveStreamInfo().id&&(x=e.state===s.Z.BUFFER_EMPTY,D.get().streaming.buffer.setStallState&&c.setStallState(e.mediaType,e.state===s.Z.BUFFER_EMPTY))}function ne(){t.info("Native video element event: play"),Y(),$(),M.trigger(u.Z.PLAYBACK_STARTED,{startTime:j()})}function ie(){t.info("Native video element event: waiting"),M.trigger(u.Z.PLAYBACK_WAITING,{playingTime:j()})}function re(){t.info("Native video element event: playing"),I=!1,M.trigger(u.Z.PLAYBACK_PLAYING,{playingTime:j()})}function ae(){t.info("Native video element event: pause"),M.trigger(u.Z.PLAYBACK_PAUSED,{ended:Z()})}function oe(){if(!I){var e=j();isNaN(A)||A===e||(e=A),A=NaN,t.info("Seeking to: "+e),$(),M.trigger(u.Z.PLAYBACK_SEEKING,{seekTime:e,streamId:v.id})}}function se(){t.info("Native video element event: seeked"),I=!1,M.trigger(u.Z.PLAYBACK_SEEKED)}function le(){v&&M.trigger(u.Z.PLAYBACK_TIME_UPDATED,{timeToEnd:P(),time:j(),streamId:v.id})}function ue(){M.trigger(u.Z.PLAYBACK_PROGRESS,{streamId:v.id})}function ce(){var e=z();t.info("Native video element event: ratechange: ",e),M.trigger(u.Z.PLAYBACK_RATE_CHANGED,{playbackRate:e})}function de(){t.info("Native video element event: loadedmetadata"),M.trigger(u.Z.PLAYBACK_METADATA_LOADED),$()}function fe(){t.info("Native video element event: loadeddata"),M.trigger(u.Z.PLAYBACK_LOADED_DATA)}function he(){t.info("Native video element event: ended"),F(),X();var e=n?n.getActiveStreamInfo():null;e&&M.trigger(u.Z.PLAYBACK_ENDED,{isLast:e.isLast})}function pe(){M.trigger(u.Z.PLAYBACK_VOLUME_CHANGED)}function ge(e){if(p&&e.isLast){t.info("onPlaybackEnded -- PLAYBACK_ENDED but native video element didn't fire ended");var n=e.seekTime?e.seekTime:N();c.setCurrentTime(n),F(),X()}}function me(e){var t=e.target||e.srcElement;M.trigger(u.Z.PLAYBACK_ERROR,{error:t.error})}function ve(){y=!1}function ye(e){if(!1===e.stream&&w&&!isNaN(e.request.duration)){var n=1.2*e.request.duration;n>g&&(t.warn("Browser does not support fetch API with StreamReader. Increasing live delay to be 20% higher than segment duration:",n.toFixed(2)),g=n,m=n)}}function _e(e){M.trigger(u.Z.PLAYBACK_STALLED,{e:e})}function be(e){var n;(n=e.mediaInfo)&&n.supplementalProperties&&n.supplementalProperties[a.Z.SUPPLEMENTAL_PROPERTY_DVB_LL_SCHEME]&&"true"===n.supplementalProperties[a.Z.SUPPLEMENTAL_PROPERTY_DVB_LL_SCHEME].value&&(t.debug("Low Latency critical SupplementalProperty set: Enabling low Latency"),w=!0)}function Ee(e){var t=n.getActiveStreamInfo();e&&t&&e.currentRepresentation&&e.streamId&&e.streamId===t.id&&e.mediaType&&(e.mediaType===a.Z.VIDEO||e.mediaType===a.Z.AUDIO)&&(S=e.currentRepresentation.availabilityTimeComplete,(w=!S)&&!C&&(C=!0))}function Te(){R=!0}function Se(){R=!1}return e={initialize:function(t,n){v=t,!0!==n&&(c.addEventListener("canplay",J),c.addEventListener("canplaythrough",ee),c.addEventListener("play",ne),c.addEventListener("waiting",ie),c.addEventListener("playing",re),c.addEventListener("pause",ae),c.addEventListener("error",me),c.addEventListener("seeking",oe),c.addEventListener("seeked",se),c.addEventListener("timeupdate",le),c.addEventListener("progress",ue),c.addEventListener("ratechange",ce),c.addEventListener("loadedmetadata",de),c.addEventListener("loadeddata",fe),c.addEventListener("stalled",_e),c.addEventListener("ended",he),c.addEventListener("volumechange",pe),y=v.manifestInfo.isDynamic,x=!1,I=!1,M.on(u.Z.DATA_UPDATE_COMPLETED,Q,e),M.on(u.Z.LOADING_PROGRESS,ye,e),M.on(u.Z.MANIFEST_UPDATED,Te,e),M.on(u.Z.STREAMS_COMPOSED,Se,e),M.on(f.Z.PLAYBACK_ENDED,ge,e,{priority:l.Z.EVENT_PRIORITY_HIGH}),M.on(f.Z.STREAM_INITIALIZING,be,e),M.on(f.Z.REPRESENTATION_SWITCH,Ee,e),M.on(f.Z.BUFFER_LEVEL_STATE_CHANGED,te,e),M.on(f.Z.DYNAMIC_TO_STATIC,ve,e),_&&(_=!1,O()))},setConfig:function(e){e&&(e.streamController&&(n=e.streamController),e.serviceDescriptionController&&(i=e.serviceDescriptionController),e.dashMetrics&&(r=e.dashMetrics),e.adapter&&(o=e.adapter),e.videoModel&&(c=e.videoModel),e.timelineConverter&&(h=e.timelineConverter),e.settings&&(D=e.settings))},getTimeToStreamEnd:P,getBufferLevel:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=null;return n.getActiveStreamProcessors().forEach(function(n){if(!e||0===e.length||-1===e.indexOf(n.getType())){var i=n.getBufferLevel();t=null===t?i:Math.min(t,i)}}),t},getPlaybackStalled:function(){return x},getTime:j,getLowLatencyModeEnabled:function(){return w},getInitialCatchupModeActivated:function(){return C},getIsManifestUpdateInProgress:function(){return R},getPlaybackRate:z,getPlayedRanges:function(){return v&&c?c.getPlayedRanges():null},getEnded:Z,getIsDynamic:q,getStreamController:function(){return n},computeAndSetLiveDelay:function(e,t){var n,r,a,s=!isNaN(e)&&isFinite(e)?e:NaN,l=o.getSuggestedPresentationDelay(),u=i.getServiceDescriptionSettings();return n=isNaN(D.get().streaming.delay.liveDelay)?null===D.get().streaming.delay.liveDelayFragmentCount||isNaN(D.get().streaming.delay.liveDelayFragmentCount)||isNaN(s)?u&&!isNaN(u.liveDelay)&&u.liveDelay>0?u.liveDelay:!0===D.get().streaming.delay.useSuggestedPresentationDelay&&null!==l&&!isNaN(l)&&l>0?l:isNaN(s)?t&&!isNaN(t.minBufferTime)?4*t.minBufferTime:4*v.manifestInfo.minBufferTime:4*s:s*D.get().streaming.delay.liveDelayFragmentCount:D.get().streaming.delay.liveDelay,null!==(a=o.getAvailabilityStartTime())&&(T=a),r=t&&t.dvrWindowSize>0?Math.min(n,t.dvrWindowSize):n,g=r,m=r,r},getLiveDelay:function(){return g},getOriginalLiveDelay:function(){return m},getCurrentLiveLatency:function(){if(!y||isNaN(T))return NaN;var e=j();if(isNaN(e)||0===e)return 0;var t=(new Date).getTime()+1e3*h.getClientTimeOffset();return Math.max(((t-T-1e3*e)/1e3).toFixed(3),0)},play:O,isPaused:V,isStalled:K,pause:F,isSeeking:H,getStreamEndTime:N,seek:U,seekToOriginalLive:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=B();if(0!==i){var r=i-(g=m);U(r,e,t,n)}},seekToCurrentLive:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=B();if(0!==i){var r=i-g;U(r,e,t,n)}},reset:L,updateCurrentTime:Y,getAvailabilityStartTime:function(){return T}},t=(0,d.Z)(k).getInstance().getLogger(e),L(),e}h.__dashjs_factory_name="PlaybackController";var p=c.Z.getSingletonFactory(h),g=n(3186),m="loading",v="executed",y="failed";function _(e){var t,n,i,r,a=(e=e||{}).eventBus,o=e.events,s=e.dashMetrics,l=e.fragmentLoader,u=e.debug,c=e.streamInfo,d=e.type;function f(e){var t;return!!e&&(t=!1,i.some(function(n){if(i=e,r=n,!isNaN(i.index)&&i.startTime===r.startTime&&i.adaptationIndex===r.adaptationIndex&&i.type===r.type||function(e,t){return isNaN(e.index)&&isNaN(t.index)&&e.quality===t.quality}(e,n)||function(e,t){return e.action===g.Z.ACTION_COMPLETE&&e.action===t.action}(e,n))return t=!0;var i,r}),t)}function h(e){return isNaN(e.duration)?.25:Math.min(e.duration/8,.5)}function p(e){i=i.filter(function(t){var n=h(t);return isNaN(t.startTime)||void 0!==e&&t.startTime>=e-n})}function _(e,t){t<=e+.5||(i=i.filter(function(n){var i=h(n);return isNaN(n.startTime)||n.startTime>=t-i||isNaN(n.duration)||n.startTime+n.duration<=e+i}))}function b(e,t,n){for(var i=e.length-1;i>=0;i--){var r=e[i],a=r.startTime,o=a+r.duration;if(n=isNaN(n)?h(r):n,!isNaN(a)&&!isNaN(o)&&t+n>=a&&t-n<o||isNaN(a)&&isNaN(t))return r}return null}function E(e,t){s.addSchedulingInfo(e,t),s.addRequestsQueue(e.mediaType,r,i)}function T(e){e.sender===l&&(r.splice(r.indexOf(e.request),1),e.response&&!e.error&&i.push(e.request),E(e.request,e.error?y:v),a.trigger(o.FRAGMENT_LOADING_COMPLETED,{request:e.request,response:e.response,error:e.error,sender:this},{streamId:c.id,mediaType:d}))}function S(e){e.sender===l&&a.trigger(o.FRAGMENT_LOADING_PROGRESS,{request:e.request,response:e.response,error:e.error,sender:this},{streamId:c.id,mediaType:d})}function w(e){e.sender===l&&a.trigger(o.FRAGMENT_LOADING_ABANDONED,{request:e.request},{streamId:c.id,mediaType:d})}function A(){i=[],r=[]}return t={getStreamId:function(){return c.id},getType:function(){return d},getRequests:function(e){var t=e?e.state instanceof Array?e.state:[e.state]:[],n=[];return t.forEach(function(t){var a=function(e){var t;switch(e){case m:t=r;break;case v:t=i;break;default:t=[]}return t}(t);n=n.concat(function(e,t){return t.hasOwnProperty("time")?[b(e,t.time,t.threshold)]:e.filter(function(e){for(var n in t)if("state"!==n&&t.hasOwnProperty(n)&&e[n]!=t[n])return!1;return!0})}(a,e))}),n},isFragmentLoaded:f,isFragmentLoadedOrPending:function(e){var t,n=!1,i=0;if(!(n=f(e)))for(i=0;i<r.length;i++)t=r[i],e.url===t.url&&e.startTime===t.startTime&&(n=!0);return n},removeExecutedRequestsBeforeTime:p,removeExecutedRequestsAfterTime:function(e){i=i.filter(function(t){return isNaN(t.startTime)||void 0!==e&&t.startTime<e})},syncExecutedRequestsWithBufferedRange:function(e,t){if(e&&0!==e.length){for(var n=0,i=0,r=e.length;i<r;i++)_(n,e.start(i)),n=e.end(i);t>0&&_(n,t)}else p()},abortRequests:function(){n.debug("abort requests"),l.abort(),r=[]},executeRequest:function(e){e.action===g.Z.ACTION_DOWNLOAD?(E(e,m),r.push(e),function(e){a.trigger(o.FRAGMENT_LOADING_STARTED,{request:e},{streamId:c.id,mediaType:d}),l.load(e)}(e)):n.warn("Unknown request action.")},reset:function(){a.off(o.LOADING_COMPLETED,T,this),a.off(o.LOADING_DATA_PROGRESS,S,this),a.off(o.LOADING_ABANDONED,w,this),l&&l.reset(),A()},resetInitialSettings:A,addExecutedRequest:function(e){i.push(e)}},n=u.getLogger(t),A(),a.on(o.LOADING_COMPLETED,T,t),a.on(o.LOADING_DATA_PROGRESS,S,t),a.on(o.LOADING_ABANDONED,w,t),t}_.__dashjs_factory_name="FragmentModel";var b=c.Z.getClassFactory(_);b.FRAGMENT_MODEL_LOADING=m,b.FRAGMENT_MODEL_EXECUTED=v,b.FRAGMENT_MODEL_CANCELED="canceled",b.FRAGMENT_MODEL_FAILED=y,c.Z.updateClassFactory(_.__dashjs_factory_name,b);var E=b,T=n(5459);function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function w(e,t){return w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},w(e,t)}function A(e,t){return!t||"object"!==S(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function I(e){return I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},I(e)}var x=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(r,e);var t,n,i=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=I(t);if(n){var r=I(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return A(this,e)});function r(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(e=i.call(this)).MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE=10,e.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE=11,e.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE=12,e.SEGMENT_BASE_LOADER_ERROR_CODE=15,e.TIME_SYNC_FAILED_ERROR_CODE=16,e.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE=17,e.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE=18,e.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=19,e.APPEND_ERROR_CODE=20,e.REMOVE_ERROR_CODE=21,e.DATA_UPDATE_FAILED_ERROR_CODE=22,e.CAPABILITY_MEDIASOURCE_ERROR_CODE=23,e.CAPABILITY_MEDIAKEYS_ERROR_CODE=24,e.DOWNLOAD_ERROR_ID_MANIFEST_CODE=25,e.DOWNLOAD_ERROR_ID_SIDX_CODE=26,e.DOWNLOAD_ERROR_ID_CONTENT_CODE=27,e.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE=28,e.DOWNLOAD_ERROR_ID_XLINK_CODE=29,e.MANIFEST_ERROR_ID_PARSE_CODE=31,e.MANIFEST_ERROR_ID_NOSTREAMS_CODE=32,e.TIMED_TEXT_ERROR_ID_PARSE_CODE=33,e.MANIFEST_ERROR_ID_MULTIPLEXED_CODE=34,e.MEDIASOURCE_TYPE_UNSUPPORTED_CODE=35,e.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE="parsing failed for ",e.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading manifest: ",e.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading Xlink element: ",e.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE="Segments update failed",e.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE="no segments are available yet",e.SEGMENT_BASE_LOADER_ERROR_MESSAGE="error loading segment ranges from sidx",e.TIME_SYNC_FAILED_ERROR_MESSAGE="Failed to synchronize client and server time",e.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE="request is null",e.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE="Failed to resolve a valid URL",e.APPEND_ERROR_MESSAGE="chunk is not defined",e.REMOVE_ERROR_MESSAGE="Removing data from the SourceBuffer",e.DATA_UPDATE_FAILED_ERROR_MESSAGE="Data update failed",e.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE="mediasource is not supported",e.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE="mediakeys is not supported",e.TIMED_TEXT_ERROR_MESSAGE_PARSE="parsing error :",e.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE="Error creating source buffer of type : ",e}return r}(n(2230).Z)),R=n(1264),C=n(7855);function D(e){var t,n,i,r,o,s,l=this.context,c=(0,R.Z)(l).getInstance(),f=e.textController,h=e.eventBus,p=[],g=[],m=!1,v=e.mediaSource,y=null;function _(e){return new Promise(function(t){M(function(){r.changeType&&r.changeType(e),t()})})}function b(e){return r=f.getTextSourceBuffer(e),Promise.resolve()}function E(){if("function"==typeof r.addEventListener)try{r.addEventListener("updateend",D,!1),r.addEventListener("error",k,!1),r.addEventListener("abort",k,!1)}catch(e){s=setInterval(D,50)}else s=setInterval(D,50)}function S(e){return new Promise(function(t){r&&c.get().streaming.buffer.useAppendWindow?M(function(){try{if(!r)return void t();var n=v.duration,a=0;e&&!isNaN(e.start)&&!isNaN(e.duration)&&isFinite(e.duration)&&(n=e.start+e.duration),e&&!isNaN(e.start)&&(a=e.start),r.appendWindowEnd===n&&r.appendWindowStart===a||(r.appendWindowStart=0,r.appendWindowEnd=n+.01,r.appendWindowStart=Math.max(a-.1,0),i.debug("Updated append window for ".concat(o.type,". Set start to ").concat(r.appendWindowStart," and end to ").concat(r.appendWindowEnd))),t()}catch(e){i.warn("Failed to set append window"),t()}}):t()})}function w(e){return new Promise(function(t){r?M(function(){try{r.timestampOffset===e||isNaN(e)||(r.timestampOffset=e,i.debug("Set MSE timestamp offset to ".concat(e))),t()}catch(e){t()}}):t()})}function A(){if(!m&&g.length>0){m=!0;var e=g[0];g.splice(0,1);var t=function(){m=!1,g.length>0&&A.call(this),e&&e.data&&e.data.segmentType&&e.data.segmentType!==C.w.INIT_SEGMENT_TYPE&&delete e.data.bytes,e.promise.resolve({chunk:e.data})};try{y=e.request,0===e.data.bytes.byteLength?t.call(this):(r.appendBuffer?r.appendBuffer(e.data.bytes):r.append(e.data.bytes,e.data),M(t.bind(this)))}catch(t){i.fatal('SourceBuffer append failed "'+t+'"'),g.length>0?A():m=!1,delete e.data.bytes,e.promise.reject({chunk:e.data,error:new T.Z(t.code,t.message)})}}}function I(){p.length>0&&(r.updating||(p.shift()(),I()))}function D(){r.updating||I()}function k(e){var t,i,r=e.target||{};t=u.Z.SOURCE_BUFFER_ERROR,i={error:r,lastRequestAppended:y}||{},h.trigger(t,i,{streamId:o.streamInfo.id,mediaType:n})}function M(e){p.push(e),r.updating||I()}return t={getType:function(){return n},getAllBufferRanges:function(){try{return r.buffered}catch(e){return i.error("getAllBufferRanges exception: "+e.message),null}},getBuffer:function(){return r},append:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new Promise(function(i,r){e?(g.push({data:e,promise:{resolve:i,reject:r},request:n}),M(A.bind(t))):r({chunk:e,error:new T.Z(x.APPEND_ERROR_CODE,x.APPEND_ERROR_MESSAGE)})})},remove:function(e){return new Promise(function(t,n){var i=e.start,a=e.end;i>=0&&a>i?M(function(){try{r.remove(i,a),M(function(){t({from:i,to:a,unintended:!1}),e.resolve&&e.resolve()})}catch(t){n({from:i,to:a,unintended:!1,error:new T.Z(x.REMOVE_ERROR_CODE,x.REMOVE_ERROR_MESSAGE)}),e.reject&&e.reject(t)}}):t()})},abort:function(){return new Promise(function(e){try{g=[],"open"===v.readyState?M(function(){try{r&&r.abort(),e()}catch(t){e()}}):r&&r.setTextTrack&&"ended"===v.readyState?(r.abort(),e()):e()}catch(t){e()}})},reset:function(){if(r){try{p=[],function(){try{"function"==typeof r.removeEventListener&&(r.removeEventListener("updateend",D,!1),r.removeEventListener("error",k,!1),r.removeEventListener("abort",k,!1)),clearInterval(s)}catch(e){i.error(e)}}(),m=!1,g=[],r.getClassName&&"TextSourceBuffer"===r.getClassName()||(i.debug("Removing sourcebuffer from media source"),v.removeSourceBuffer(r))}catch(e){}r=null}y=null},updateTimestampOffset:w,initializeForStreamSwitch:function(e,t,i){n=(o=e).type;var a=o.codec;!function(e){r=e.getBuffer()}(i),E();var s=[];return s.push(new Promise(function(e){M(function(){var t=r.appendWindowStart,n=r.appendWindowEnd;r&&(r.abort(),r.appendWindowStart=t,r.appendWindowEnd=n),e()})})),s.push(S(o.streamInfo)),c.get().streaming.buffer.useChangeTypeForTrackSwitch&&s.push(_(a)),t&&void 0!==t.MSETimeOffset&&s.push(w(t.MSETimeOffset)),Promise.all(s)},initializeForFirstUse:function(e,t,i){n=(o=t).type;var s=o.codec;try{if(s.match(/application\/mp4;\s*codecs="(stpp|wvtt).*"/i))return b(e);r=v.addSourceBuffer(s),E();var l=[];return l.push(S(o.streamInfo)),i&&void 0!==i.MSETimeOffset&&l.push(w(i.MSETimeOffset)),Promise.all(l)}catch(t){return o.type==a.Z.TEXT&&!o.isFragmented||-1!==s.indexOf('codecs="stpp')||-1!==s.indexOf('codecs="vtt')||-1!==s.indexOf("text/vtt")?b(e):Promise.reject(t)}},updateAppendWindow:S,changeType:_},i=(0,d.Z)(l).getInstance().getLogger(t),t}D.__dashjs_factory_name="SourceBufferSink";var k=c.Z.getClassFactory(D);function M(e){var t,n,i,r=this.context,a=[],o=e;function s(e,t){return a=a.filter(function(n){return!((isNaN(t)||n.start<t)&&(isNaN(e)||n.end>e))}),Promise.resolve()}return t={getAllBufferRanges:function(){for(var e=[],t=0;t<a.length;t++){var n=a[t];0===e.length||n.start>e[e.length-1].end?e.push({start:n.start,end:n.end}):e[e.length-1].end=n.end}var i={start:function(t){return e[t].start},end:function(t){return e[t].end}};return Object.defineProperty(i,"length",{get:function(){return e.length}}),i},append:function(e){return"InitializationSegment"!==e.segmentType?(a.push(e),a.sort(function(e,t){return e.start-t.start}),i=null):i=e,n.debug("PreBufferSink appended chunk s: "+e.start+"; e: "+e.end),o&&o({chunk:e}),Promise.resolve()},remove:s,abort:function(){return Promise.resolve()},discharge:function(e,t){var n=function(e,t){return a.filter(function(n){return(isNaN(t)||n.start<t)&&(isNaN(e)||n.end>e)})}(e,t);return i&&(n.push(i),i=null),s(e,t),n},reset:function(){a=[],i=null,o=null},updateTimestampOffset:function(){return Promise.resolve()},waitForUpdateEnd:function(e){e()},getBuffer:function(){return this}},n=(0,d.Z)(r).getInstance().getLogger(t),t}M.__dashjs_factory_name="PreBufferSink";var L=c.Z.getClassFactory(M);function P(){var e={};return{save:function(t){var n=t.streamId,i=t.representationId;e[n]=e[n]||{},e[n][i]=t},extract:function(t,n){return e&&e[t]&&e[t][n]?e[t][n]:null},reset:function(){e={}}}}P.__dashjs_factory_name="InitCache";var N=c.Z.getSingletonFactory(P),O=.01,F="BufferController";function U(e){e=e||{};var t,n,i,r,o,c,h,p,g,m,v,y,_,b,S,w,A,I,R,D,M,P=this.context,U=(0,l.Z)(P).getInstance(),B=e.errHandler,G=e.fragmentModel,j=e.representationController,V=e.adapter,H=e.textController,K=e.abrController,z=e.playbackController,Z=e.streamInfo,q=e.type,Y=e.settings;function W(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new Promise(function(n,i){c=e,g&&t&&"function"==typeof g.discharge?(m=g,X(t).then(function(){n()}).catch(function(e){i(e)})):n()})}function $(e){return V.convertRepresentationToRepresentationInfo(j.getRepresentationForQuality(e))}function X(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return new Promise(function(n,i){I&&e?c?(v=!1,J(e,t).then(function(e){n(e)}).catch(function(e){i(e)})):(v=!0,Q().then(function(e){n(e)}).catch(function(e){i(e)})):n(null)})}function Q(){var e=this;return new Promise(function(t,n){var i=K.getQualityFor(q,Z.id);g=L(P).create(re.bind(e)),be($(i)).then(function(){t(g)}).catch(function(){n()})})}function J(e,t){return new Promise(function(i,r){var o=K.getQualityFor(q,Z.id);g=k(P).create({mediaSource:c,textController:H,eventBus:U}),function(e,t,n){var i=$(n);return t&&t[q]&&(q===a.Z.VIDEO||q===a.Z.AUDIO)?g.initializeForStreamSwitch(e,i,t[q]):g.initializeForFirstUse(Z,e,i)}(e,t,o).then(function(){return be($(o))}).then(function(){i(g)}).catch(function(e){n.fatal("Caught error on create SourceBuffer: "+e),B.error(new T.Z(x.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,x.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+q)),r(e)})})}function ee(e){Y.get().streaming.cacheInitSegments&&(n.info("Init fragment finished loading saving to",q+"'s init cache"),I.save(e.chunk)),n.debug("Append Init fragment",q," with representationId:",e.chunk.representationId," and quality:",e.chunk.quality,", data size:",e.chunk.bytes.byteLength),ne(e.chunk)}function te(e){ne(e.chunk,e.request)}function ne(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;g&&(g.append(e,t).then(function(e){re(e)}).catch(function(e){re(e)}),e.mediaInfo.type===a.Z.VIDEO&&Re(u.Z.VIDEO_CHUNK_RECEIVED,{chunk:e}))}function ie(e){if(e&&e.length>0)for(var t=0,i=e.length;t<i;t++)n.debug("Buffered range: "+e.start(t)+" - "+e.end(t)+", currentTime = ",z.getTime())}function re(e){if(e.error)return 22===e.error.code&&function(){if(A=!0,o=.8*Ae(),n.warn("Quota exceeded, Critical Buffer: "+o),o>0){var e=Math.max(.2*o,1),t=o-e,i=Math.min(Y.get().streaming.buffer.bufferTimeAtTopQuality,.9*t),r=Math.min(Y.get().streaming.buffer.bufferTimeAtTopQualityLongForm,.9*t),a={streaming:{buffer:{bufferToKeep:parseFloat(e.toFixed(5)),bufferTimeAtTopQuality:parseFloat(i.toFixed(5)),bufferTimeAtTopQualityLongForm:parseFloat(r.toFixed(5))}}};Y.update(a)}}(),void(22!==e.error.code&&xe()||(n.warn("Clearing playback buffer to overcome quota exceed situation"),Re(u.Z.QUOTA_EXCEEDED,{criticalBufferLevel:o,quotaExceededTime:e.chunk.start}),ve(me())));if(g&&(de(),A=!1,(b=e.chunk)&&b.endFragment)){b&&!isNaN(b.index)&&(h=Math.max(b.index,h),fe());var t=g.getAllBufferRanges();b.segmentType===C.w.MEDIA_SEGMENT_TYPE&&(ie(t),se(),function(){if(!isNaN(M)&&!v)if(q===a.Z.AUDIO||q===a.Z.VIDEO){var e=z.getTime(),t=ce(e,0),n=ce(M,0);if(t&&n&&t.start===n.start)M=NaN;else{var i=j.getCurrentRepresentation().segmentDuration,r=ce(M,i);r&&(Y.get().streaming.buffer.enableSeekDecorrelationFix&&Math.abs(e-M)>i?M<=r.end&&z.seek(Math.max(M,r.start),!1,!0):e<r.start&&z.seek(r.start,!1,!0))}}else M=NaN}());var i=!1;y&&(y.indexOf(b)>0&&(i=!0),y=null),b&&!i&&Re(u.Z.BYTES_APPENDED_END_FRAGMENT,{quality:b.quality,startTime:b.start,index:b.index,bufferedRanges:t,segmentType:b.segmentType,mediaType:q})}}function ae(){return new Promise(function(e,t){var n=oe();if(!n||0===n.length)return se(),void e();ve(n).then(function(){e()}).catch(function(e){t(e)})})}function oe(e){var t=[],i=g.getAllBufferRanges();if(!i||0===i.length)return t;if(!e&&0!==e||isNaN(e))t.push({start:i.start(0),end:i.end(i.length-1)+.5});else{var r=function(e,t){var n=Y.get().streaming.buffer.bufferToKeep,i=t.start(0);if(e-i>n){var r=Math.max(0,e-n),a=G.getRequests({state:E.FRAGMENT_MODEL_EXECUTED,time:e,threshold:O})[0];if(a&&(r=Math.min(a.startTime,r)),r>0)return{start:i,end:r}}return null}(e,i),a=function(e,t){var i=t.end(t.length-1)+.5,r=Ie(e),a=Z.manifestInfo.duration>=Y.get().streaming.buffer.longFormContentDurationThreshold?Y.get().streaming.buffer.bufferTimeAtTopQualityLongForm:Y.get().streaming.buffer.bufferTimeAtTopQuality,o=isNaN(r)?e:Math.min(r,e+a);if(o>=t.end(t.length-1))return null;var s=G.getRequests({state:E.FRAGMENT_MODEL_EXECUTED,time:e,threshold:O})[0];if(s&&(o=Math.max(s.startTime+s.duration,o)),Y.get().streaming.buffer.avoidCurrentTimeRangePruning)for(var l=0;l<t.length;l++)if(t.start(l)<=e&&e<=t.end(l)&&t.start(l)<=o&&o<=t.end(l)){var u=o;o=l+1<t.length?t.start(l+1):t.end(l)+1,n.debug("Buffered range ["+t.start(l)+", "+t.end(l)+"] overlaps with targetTime "+e+" and range to be pruned ["+u+", "+i+"], using ["+o+", "+i+"] instead"+(o<i?"":" (no actual pruning)"));break}return o<t.end(t.length-1)?{start:o,end:i}:null}(e,i);r&&t.push(r),a&&t.push(a)}return t}function se(){(!D||q===a.Z.TEXT&&H.isTextEnabled())&&de()}function le(){he()}function ue(){he(),M=NaN}function ce(e,t){if(!g)return null;var n,i,r=g.getAllBufferRanges(),a=0,o=0,s=null,l=null,u=0,c=isNaN(t)?.15:t;if(null!=r){for(i=0,n=r.length;i<n;i++)if(a=r.start(i),o=r.end(i),null===s)u=Math.abs(a-e),(e>=a&&e<o||u<=c)&&(s=a,l=o);else{if(!((u=a-l)<=c))break;l=o}if(null!==s)return{start:s,end:l}}return null}function de(){if(z){var e=z.getTime()||0;v&&(e=isNaN(M)?0:M);var t=Y.get().streaming.gaps.jumpGaps&&!isNaN(Y.get().streaming.gaps.smallGapLimit)?Y.get().streaming.gaps.smallGapLimit:NaN;r=Math.max(function(e,t){var n;return Y.get().streaming.gaps.jumpGaps&&(t=Y.get().streaming.gaps.smallGapLimit),null===(n=ce(e,t))?0:n.end-e}(e,t),0),Re(u.Z.BUFFER_LEVEL_UPDATED,{mediaType:q,bufferLevel:r}),he()}}function fe(){var e=h>=p-1,t=z.getTimeToStreamEnd(Z)-r<1e-5;!e&&!t||i||(we(!0),n.debug("checkIfBufferingCompleted trigger BUFFERING_COMPLETED for stream id ".concat(Z.id," and type ").concat(q)))}function he(){q!==a.Z.AUDIO&&q!==a.Z.VIDEO||((!z.getLowLatencyModeEnabled()&&r<Y.get().streaming.buffer.stallThreshold||0===r)&&!i?pe(s.Z.BUFFER_EMPTY):(i||r>=Y.get().streaming.buffer.stallThreshold||z.getLowLatencyModeEnabled()&&r>0)&&pe(s.Z.BUFFER_LOADED))}function pe(e){_===e||e===s.Z.BUFFER_EMPTY&&0===z.getTime()||q===a.Z.TEXT&&!H.isTextEnabled()||(_=e,Re(u.Z.BUFFER_LEVEL_STATE_CHANGED,{state:e}),Re(e===s.Z.BUFFER_LOADED?u.Z.BUFFER_LOADED:u.Z.BUFFER_EMPTY),n.debug(e===s.Z.BUFFER_LOADED?"Got enough buffer to start":"Waiting for more buffer before starting playback"))}function ge(){g&&q!==a.Z.TEXT&&(i||ve(me()))}function me(){var e=[],t=g.getAllBufferRanges();if(!t||0===t.length)return e;var n=z.getTime(),i=Math.max(0,n-Y.get().streaming.buffer.bufferToKeep),r=G.getRequests({state:E.FRAGMENT_MODEL_EXECUTED,time:n,threshold:O})[0];if(r)i=Math.min(r.startTime,i);else if(0===n&&z.getIsDynamic())return[];if(t.start(0)<=i){for(var a={start:0,end:i},o=0;o<t.length&&t.end(o)<=i;o++)a.end=t.end(o);a.start<a.end&&e.push(a)}return e}function ve(e){return new Promise(function(t,n){if(e&&g&&0!==e.length){var i=[];e.forEach(function(e){i.push(function(e){return new Promise(function(t,n){e.resolve=t,e.reject=n,R.push(e)})}(e))}),w||ye(),Promise.all(i).then(function(){t()}).catch(function(e){n(e)})}else t()})}function ye(){try{if(0===R.length||!g)return n.debug("Nothing to prune, halt pruning"),R=[],void(w=!1);var e=g.getBuffer();if(!e||!e.buffered||0===e.buffered.length)return n.debug("SourceBuffer is empty (or does not exist), halt pruning"),R=[],void(w=!1);var t=R.shift();n.debug("".concat(q,": Removing buffer from: ").concat(t.start," to ").concat(t.end)),w=!0,z.getTime()<t.end&&we(!1),g.remove(t).then(function(e){_e(e)}).catch(function(e){_e(e)})}catch(e){w=!1}}function _e(e){n.debug("onRemoved buffer from:",e.from,"to",e.to),g&&(ie(g.getAllBufferRanges()),0===R.length&&(w=!1,de()),e.unintended&&(n.warn("Detected unintended removal from:",e.from,"to",e.to,"setting streamprocessor time to",e.from),Re(u.Z.SEEK_TARGET,{time:e.from})),w?ye():(D?D=!1:de(),Re(u.Z.BUFFER_CLEARED,{from:e.from,to:e.to,unintended:e.unintended,hasEnoughSpaceToAppend:xe(),quotaExceeded:A})))}function be(e){return new Promise(function(t){e&&void 0!==e.MSETimeOffset&&g&&g.updateTimestampOffset?g.updateTimestampOffset(e.MSETimeOffset).then(function(){t()}).catch(function(){t()}):t()})}function Ee(){return g&&!i?g.updateAppendWindow(Z):Promise.resolve()}function Te(){++S*(Y.get().streaming.wallclockTimeUpdateInterval/1e3)>=Y.get().streaming.buffer.bufferPruningInterval&&(S=0,ge())}function Se(){he()}function we(e){(i=e)?Re(u.Z.BUFFERING_COMPLETED):p=Number.POSITIVE_INFINITY}function Ae(){try{var e,t,n=g.getAllBufferRanges(),i=0;if(!n)return i;for(t=0,e=n.length;t<e;t++)i+=n.end(t)-n.start(t);return i}catch(e){return 0}}function Ie(e){try{var t=e,n=g.getAllBufferRanges();if(!n||0===n.length)return NaN;for(var i=0;t===e&&i<n.length;){var r=n.start(i),a=n.end(i);t>=r&&t<=a&&(t=a),i+=1}return t===e?NaN:t}catch(e){}}function xe(){var e=Ae();return isNaN(e)||e<o}function Re(e,t){var n=t||{};U.trigger(e,n,{streamId:Z.id,mediaType:q})}function Ce(e,t){if(o=Number.POSITIVE_INFINITY,_=void 0,p=Number.POSITIVE_INFINITY,h=0,b=null,i=!1,w=!1,A=!1,r=0,S=0,R=[],M=NaN,v=!1,g){var n=g;g=null,e||t||n.abort().then(function(){n.reset(t),n=null})}D=!1}return t={initialize:function(e){W(e),U.on(u.Z.INIT_FRAGMENT_LOADED,ee,t),U.on(u.Z.MEDIA_FRAGMENT_LOADED,te,t),U.on(u.Z.WALLCLOCK_TIME_UPDATED,Te,t),U.on(f.Z.PLAYBACK_PLAYING,ue,t),U.on(f.Z.PLAYBACK_PROGRESS,se,t),U.on(f.Z.PLAYBACK_TIME_UPDATED,se,t),U.on(f.Z.PLAYBACK_RATE_CHANGED,Se,t),U.on(f.Z.PLAYBACK_STALLED,le,t)},getStreamId:function(){return Z.id},getType:function(){return q},getBufferControllerType:function(){return F},createBufferSink:X,dischargePreBuffer:function(){if(g&&m&&"function"==typeof m.discharge){var e=m.getAllBufferRanges();if(e.length>0){for(var t="Beginning "+q+"PreBuffer discharge, adding buffer for:",i=0;i<e.length;i++)t+=" start: "+e.start(i)+", end: "+e.end(i)+";";n.debug(t)}else n.debug("PreBuffer discharge requested, but there were no media segments in the PreBuffer.");y=[];for(var r=m.discharge(),a=null,o=0;o<r.length;o++){var s=r[o];if(s.segmentType!==C.w.INIT_SEGMENT_TYPE){var l=I.extract(s.streamId,s.representationId);l&&a!==l&&(y.push(l),g.append(l),a=l)}y.push(s),g.append(s)}m.reset(),m=null}},getBuffer:function(){return g},getBufferLevel:function(){return r},getRangeAt:ce,hasBufferAtTime:function(e){try{var t=g.getAllBufferRanges();if(!t||0===t.length)return!1;for(var i=0;i<t.length;){var r=t.start(i),a=t.end(i);if(e>=r&&e<=a)return!0;i+=1}return!1}catch(e){return n.error(e),!1}},pruneBuffer:ge,setMediaSource:W,getMediaSource:function(){return c},appendInitSegmentFromCache:function(e){var t=I.extract(Z.id,e);return!!t&&(n.info("Append Init fragment",q," with representationId:",t.representationId," and quality:",t.quality,", data size:",t.bytes.byteLength),ne(t),!0)},getIsBufferingCompleted:function(){return i},setIsBufferingCompleted:we,getIsPruningInProgress:function(){return w},reset:function(e,t){U.off(u.Z.INIT_FRAGMENT_LOADED,ee,this),U.off(u.Z.MEDIA_FRAGMENT_LOADED,te,this),U.off(u.Z.WALLCLOCK_TIME_UPDATED,Te,this),U.off(f.Z.PLAYBACK_PLAYING,ue,this),U.off(f.Z.PLAYBACK_PROGRESS,se,this),U.off(f.Z.PLAYBACK_TIME_UPDATED,se,this),U.off(f.Z.PLAYBACK_RATE_CHANGED,Se,this),U.off(f.Z.PLAYBACK_STALLED,le,this),Ce(e,t)},prepareForPlaybackSeek:function(){return i&&we(!1),g.abort()},prepareForReplacementTrackSwitch:function(e){return new Promise(function(t,n){g.abort().then(function(){return Ee()}).then(function(){return Y.get().streaming.buffer.useChangeTypeForTrackSwitch?g.changeType(e):Promise.resolve()}).then(function(){return ae()}).then(function(){we(!1),t()}).catch(function(e){n(e)})})},prepareForNonReplacementTrackSwitch:function(e){return new Promise(function(t,n){Ee().then(function(){return Y.get().streaming.buffer.useChangeTypeForTrackSwitch?g.changeType(e):Promise.resolve()}).then(function(){t()}).catch(function(e){n(e)})})},prepareForForceReplacementQualitySwitch:function(e){return new Promise(function(t,n){g.abort().then(function(){return Ee()}).then(function(){return ae()}).then(function(){return be(e)}).then(function(){we(!1),t()}).catch(function(e){n(e)})})},updateAppendWindow:Ee,getAllRangesWithSafetyFactor:oe,getContinuousBufferTimeForTargetTime:Ie,clearBuffers:ve,pruneAllSafely:ae,updateBufferTimestampOffset:be,setSeekTarget:function(e){M=e},segmentRequestingCompleted:function(e){isNaN(e)||(p=e,fe())}},n=(0,d.Z)(P).getInstance().getLogger(t),I=N(P).getInstance(),Ce(),t}U.__dashjs_factory_name=F;var B=c.Z.getClassFactory(U),G="NotFragmentedTextBufferController";function j(e){e=e||{};var t,n,i,r,a,o,s=this.context,c=(0,l.Z)(s).getInstance(),d=e.textController,f=e.errHandler,h=e.streamInfo,p=e.type;function g(e){r=e}function m(e){var t,i;n!==e&&(n=e)&&(t=u.Z.BUFFERING_COMPLETED,i={},c.trigger(t,i,{streamId:h.id,mediaType:p}))}function v(e){e.chunk.bytes&&!n&&(o.save(e.chunk),a.append(e.chunk),m(!0))}return t={initialize:function(e){g(e)},getStreamId:function(){return h.id},getType:function(){return p},getBufferControllerType:function(){return G},createBufferSink:function(e){return new Promise(function(t,n){try{(a=k(s).create({mediaSource:r,textController:d,eventBus:c})).initializeForFirstUse(h,e),i||(a.getBuffer()&&"function"==typeof a.getBuffer().initialize&&a.getBuffer().initialize(),i=!0),t(a)}catch(e){f.error(new T.Z(x.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,x.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+p)),n(e)}})},dischargePreBuffer:function(){},getBuffer:function(){return a},getBufferLevel:function(){return 0},getRangeAt:function(){return null},pruneBuffer:function(){},hasBufferAtTime:function(){return!0},getAllRangesWithSafetyFactor:function(){return[]},getContinuousBufferTimeForTargetTime:function(){return Number.POSITIVE_INFINITY},setMediaSource:g,getMediaSource:function(){return r},appendInitSegmentFromCache:function(e){return null!==o.extract(h.id,e)},getIsBufferingCompleted:function(){return n},setIsBufferingCompleted:m,getIsPruningInProgress:function(){return!1},reset:function(e){c.off(u.Z.INIT_FRAGMENT_LOADED,v,t),!e&&a&&(a.abort(),a.reset(),a=null)},clearBuffers:function(){return Promise.resolve()},prepareForPlaybackSeek:function(){return Promise.resolve()},prepareForReplacementTrackSwitch:function(){return n=!1,Promise.resolve()},setSeekTarget:function(){},updateAppendWindow:function(){return Promise.resolve()},pruneAllSafely:function(){return Promise.resolve()},updateBufferTimestampOffset:function(){return Promise.resolve()},segmentRequestingCompleted:function(){}},i=!1,r=null,n=!1,o=N(s).getInstance(),c.on(u.Z.INIT_FRAGMENT_LOADED,v,t),t}j.__dashjs_factory_name=G;var V=c.Z.getClassFactory(j);function H(e){e=e||{};var t,n,i,r,o,c,h,p,g,m,v,y,_,b=this.context,T=(0,l.Z)(b).getInstance(),S=e.dashMetrics,w=e.mediaPlayerModel,A=e.fragmentModel,I=e.abrController,x=e.playbackController,R=e.textController,C=e.type,D=e.bufferController,k=e.representationController,M=e.settings;function L(){y=!0}function P(){y=!1}function N(e){if(!D.getIsBufferingCompleted()){O();var t=isNaN(e)?0:e;o=setTimeout(F,t)}}function O(){o&&(clearTimeout(o),o=null)}function F(){try{if(function(){try{return C===a.Z.TEXT&&!R.isTextEnabled()||x.isPaused()&&(!x.getStreamController().getInitialPlayback()||!x.getStreamController().getAutoPlay())&&!M.get().streaming.scheduling.scheduleWhilePaused}catch(e){return!1}}())return void O();if(function(){try{return!!y&&k.getCurrentRepresentationInfo()&&(isNaN(g)||m||(e=n.id,t=I.getMaxAllowedIndexFor(C,e),!(!isNaN(p)&&p==t||(i.info("Top quality "+C+" index has changed from "+p+" to "+t),p=t,0)))||function(){var e=k.getCurrentRepresentationInfo();return!C||!e||S.getCurrentBufferLevel(C)<U()}())}catch(e){return!1}var e,t}()){var e=!1;_&&(e=I.checkPlaybackQuality(C,n.id)),e||(r=k.getCurrentRepresentationInfo(),v||r.quality!==g||m?(m?(i.debug("Switch track for "+C+", representation id = "+r.id),m=!1):i.debug("Quality has changed, get init request for representationid = "+r.id),T.trigger(u.Z.INIT_FRAGMENT_NEEDED,{representationId:r.id,sender:t},{streamId:n.id,mediaType:C}),_=!1,v=!1):(i.debug("Media segment needed for ".concat(C," and stream id ").concat(n.id)),T.trigger(u.Z.MEDIA_FRAGMENT_NEEDED,{},{streamId:n.id,mediaType:C}),_=!0))}else N(x.getLowLatencyModeEnabled()?M.get().streaming.scheduling.lowLatencyTimeout:M.get().streaming.scheduling.defaultTimeout)}catch(e){N(x.getLowLatencyModeEnabled()?M.get().streaming.scheduling.lowLatencyTimeout:M.get().streaming.scheduling.defaultTimeout)}var r}function U(){var e=NaN,t=k.getCurrentRepresentationInfo();return C&&t?(e=C===a.Z.TEXT?function(){try{if(R.isTextEnabled()){var e=k.getCurrentRepresentationInfo();if(isNaN(e.fragmentDuration)){var t=S.getCurrentSchedulingInfo(s.Z.SCHEDULING_INFO);return t?t.duration:0}return e.fragmentDuration}return 0}catch(e){return 0}}():C===a.Z.AUDIO&&c?function(){try{var e=S.getCurrentBufferLevel(a.Z.VIDEO),t=k.getCurrentRepresentationInfo();return isNaN(t.fragmentDuration)?e+1:Math.max(e+1,t.fragmentDuration)}catch(e){return 0}}():function(){try{var e=k.getCurrentRepresentationInfo().mediaInfo.streamInfo;return I.isPlayingAtTopQuality(e)?e.manifestInfo.duration>=M.get().streaming.buffer.longFormContentDurationThreshold?M.get().streaming.buffer.bufferTimeAtTopQualityLongForm:M.get().streaming.buffer.bufferTimeAtTopQuality:w.getStableBufferTime()}catch(e){return w.getStableBufferTime()}}(),e):e}function B(){G(!0)}function G(e){if(x&&A){var t=A.getRequests({state:E.FRAGMENT_MODEL_EXECUTED,time:x.getTime(),threshold:0})[0];t&&x.getTime()>=t.startTime&&((!h.mediaInfo||t.mediaInfo.type===h.mediaInfo.type&&t.mediaInfo.index!==h.mediaInfo.index)&&e&&T.trigger(u.Z.TRACK_CHANGE_RENDERED,{mediaType:C,oldMediaInfo:h.mediaInfo,newMediaInfo:t.mediaInfo,streamId:n.id}),t.quality===h.quality&&t.adaptationIndex===h.adaptationIndex||!e||(i.debug("Quality change rendered for streamId ".concat(n.id," and type ").concat(C)),T.trigger(u.Z.QUALITY_CHANGE_RENDERED,{mediaType:C,oldQuality:h.quality,newQuality:t.quality,streamId:n.id})),h={mediaInfo:t.mediaInfo,quality:t.quality,adaptationIndex:t.adaptationIndex})}}function j(){A.abortRequests(),O()}function V(){M.get().streaming.scheduling.scheduleWhilePaused||N()}function H(e){S.updatePlayListTraceMetrics({playbackspeed:e.playbackRate.toString()})}function K(){_=!0,r=0,g=NaN,h={mediaInfo:void 0,quality:NaN,adaptationIndex:NaN},p=NaN,m=!1,v=!1,y=!0}return t={initialize:function(e){c=e,T.on(u.Z.URL_RESOLUTION_FAILED,j,t),T.on(f.Z.PLAYBACK_STARTED,V,t),T.on(f.Z.PLAYBACK_RATE_CHANGED,H,t),T.on(f.Z.PLAYBACK_TIME_UPDATED,B,t),T.on(f.Z.MANAGED_MEDIA_SOURCE_START_STREAMING,L,t),T.on(f.Z.MANAGED_MEDIA_SOURCE_END_STREAMING,P,t)},getType:function(){return C},getStreamId:function(){return n.id},setTimeToLoadDelay:function(e){r=e},getTimeToLoadDelay:function(){return r},setSwitchTrack:function(e){m=e},getSwitchTrack:function(){return m},startScheduleTimer:N,clearScheduleTimer:O,reset:function(){T.off(u.Z.URL_RESOLUTION_FAILED,j,t),T.off(f.Z.PLAYBACK_STARTED,V,t),T.off(f.Z.PLAYBACK_RATE_CHANGED,H,t),T.off(f.Z.PLAYBACK_TIME_UPDATED,B,t),T.off(f.Z.MANAGED_MEDIA_SOURCE_START_STREAMING,L,t),T.off(f.Z.MANAGED_MEDIA_SOURCE_END_STREAMING,P,t),O(),G(!1),K(),n=null},getBufferTarget:U,getPlaybackController:function(){return x},setCheckPlaybackQuality:function(e){_=e},setInitSegmentRequired:function(e){v=e},setLastInitializedQuality:function(e){g=e}},i=(0,d.Z)(b).getInstance().getLogger(t),K(),n=e.streamInfo,t}H.__dashjs_factory_name="ScheduleController";var K=c.Z.getClassFactory(H),z=n(7387);function Z(e){var t,n,i,r,o,s,l=(e=e||{}).eventBus,u=e.events,c=e.abrController,d=e.dashMetrics,h=e.playbackController,p=e.timelineConverter,g=e.type,m=e.streamInfo,v=e.dashConstants,y=e.segmentsController,_=e.isDynamic,b=e.adapter;function E(){return g}function T(){return i}function S(){return s}function w(){n=null,i=!0,r=[],o=null}function A(e){return new Promise(function(t,n){var i=e.hasInitialization(),a=e.hasSegments(),o=[];o.push(y.updateInitData(e,i)),o.push(y.updateSegmentData(e,a)),Promise.all(o).then(function(n){var i;n[0]&&!n[0].error&&(e=function(e,t){return t&&!t.error&&t.representation?t.representation:e}(e,n[0])),n[1]&&!n[1].error&&(e=function(e,t){if(t&&!t.error){var n,i,r,a,o=t.segments,s=[],l=0;for(n=0,i=o?o.length:0;n<i;n++)r=o[n],(a=(0,z.TJ)(p,_,e,r.startTime,r.duration,r.timescale,r.media,r.mediaRange,l))&&(s.push(a),a=null,l++);return s.length>0&&(e.segments=s),e}}(e,n[1])),(i=e).mediaFinishedInformation=y.getMediaFinishedInformation(i),function(e){if(T()){var t,n,i=d.getCurrentManifestUpdate(),a=!1;if(i){for(var o=0;o<i.representationInfo.length;o++)if((t=i.representationInfo[o]).index===e.index&&t.mediaType===E()){a=!0;break}a||d.addManifestUpdateRepresentationInfo(e,E())}if(function(){for(var e=0,t=r.length;e<t;e++){var n=r[e].segmentInfoType;if(!r[e].hasInitialization()||(n===v.SEGMENT_BASE||n===v.BASE_URL)&&!r[e].segments)return!1}return!0}()){c.setPlaybackQuality(g,m,(n=s,r.indexOf(n)));var l=d.getCurrentDVRInfo(g);l&&d.updateManifestUpdateInfo({latency:l.range.end-h.getTime()}),d.getCurrentRepresentationSwitch(S().adaptation.type)||I(),R()}}}(e),t()}).catch(function(e){n(e)})})}function I(){!function(){if(!(c&&d&&h&&p))throw new Error(a.Z.MISSING_CONFIG_ERROR)}();var e=new Date,t=S(),n=1e3*h.getTime();t&&d.addRepresentationSwitch(t.adaptation.type,e,n,t.id),l.trigger(f.Z.REPRESENTATION_SWITCH,{mediaType:g,streamId:m.id,currentRepresentation:t,numberOfRepresentations:r.length},{streamId:m.id,mediaType:g})}function x(e){return null==e||e>=r.length?null:r[e]}function R(e){i=!1,l.trigger(u.DATA_UPDATE_COMPLETED,{data:n,currentRepresentation:s,error:e},{streamId:m.id,mediaType:g})}function C(e){s=e,o=b.convertRepresentationToRepresentationInfo(s)}function D(e){if(e.newDuration){var t=S();t&&t.adaptation.period&&(t.adaptation.period.duration=e.newDuration)}}return t={getStreamId:function(){return m.id},getType:E,getData:function(){return n},isUpdating:T,updateData:function(e,t,o,s,l){return new Promise(function(u,c){if(i=!0,r=t,n=e,C(x(l)),o!==a.Z.VIDEO&&o!==a.Z.AUDIO&&(o!==a.Z.TEXT||!s))return R(),void u();for(var d=[],f=0,h=r.length;f<h;f++){var p=r[f];d.push(A(p))}Promise.all(d).then(function(){C(x(l)),u()}).catch(function(e){c(e)})})},getCurrentRepresentation:S,getCurrentRepresentationInfo:function(){return o},getRepresentationForQuality:x,prepareQualityChange:function(e){C(x(e)),I()},reset:function(){l.off(f.Z.MANIFEST_VALIDITY_CHANGED,D,t),w()}},w(),l.on(f.Z.MANIFEST_VALIDITY_CHANGED,D,t),t}Z.__dashjs_factory_name="RepresentationController";var q=c.Z.getClassFactory(Z),Y=n(3106),W=n(9326),$=n(7473),X=n(2594);function Q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var J=function e(){Q(this,e),this.start=null,this.mstart=null,this.starttype=null,this.trace=[]};J.INITIAL_PLAYOUT_START_REASON="initial_playout",J.SEEK_START_REASON="seek",J.RESUME_FROM_PAUSE_START_REASON="resume",J.METRICS_COLLECTION_START_REASON="metrics_collection_start";var ee=function e(){Q(this,e),this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null};ee.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",ee.REBUFFERING_REASON="rebuffering",ee.USER_REQUEST_STOP_REASON="user_request",ee.END_OF_PERIOD_STOP_REASON="end_of_period",ee.END_OF_CONTENT_STOP_REASON="end_of_content",ee.METRICS_COLLECTION_STOP_REASON="metrics_collection_end",ee.FAILURE_STOP_REASON="failure";var te=n(7802);function ne(){return{ntpToUTC:function(e){var t=new Date(Date.UTC(1900,0,1,0,0,0));return new Date(t.getTime()+e).getTime()}}}ne.__dashjs_factory_name="TimeUtils";var ie=c.Z.getSingletonFactory(ne);function re(e){e=e||{};var t,n,i,r,c,h,p,g,m,v,y,_,b,S,w,A=this.context,I=(0,l.Z)(A).getInstance(),R=e.streamInfo,D=e.type,k=e.errHandler,M=e.mimeType,L=e.timelineConverter,P=e.adapter,N=e.manifestModel,O=e.mediaPlayerModel,F=e.fragmentModel,U=e.abrController,G=e.playbackController,j=e.mediaController,H=e.textController,z=e.dashMetrics,Z=e.settings,Q=e.boxParser,J=e.segmentBlacklistController;function ne(){return R.id}function re(){return D}function ae(){return P.getIsTextTrack(g.getData())}function oe(){c=[],r=null,S=0,m=!1,v=!1,y=!1,w=null}function se(e){return!isNaN(e)&&!isNaN(R.duration)&&isFinite(R.duration)&&e>=R.start+R.duration}function le(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.sender)if(G.getIsManifestUpdateInProgress())he();else if((!ae()||H.isTextEnabled())&&h&&e.representationId&&!h.appendInitSegmentFromCache(e.representationId)){var n=g.getCurrentRepresentation();if(0===n.range)return void ue();var i=_?_.getInitRequest(r,n):null;i?F.executeRequest(i):t&&(p.setInitSegmentRequired(!0),he())}}function ue(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(G.getIsManifestUpdateInProgress()||h.getIsPruningInProgress())he();else{var n=fe();n?(m=!1,v=!1,ce(n)):de(t)}}function ce(e){isNaN(e.startTime+e.duration)||(S=e.startTime+e.duration),e.delayLoadingTime=(new Date).getTime()+p.getTimeToLoadDelay(),p.setTimeToLoadDelay(0),function(e){var t=e.url;return e.range&&(t=t.concat("_",e.range)),J.contains(t)}(e)?(n.warn("Fragment request url ".concat(e.url," for stream id ").concat(R.id," and media type ").concat(D," is on the ignore list and will be skipped")),he()):(n.debug("Next fragment request url for stream id ".concat(R.id," and media type ").concat(D," is ").concat(e.url)),F.executeRequest(e))}function de(e){var t,a=g.getCurrentRepresentation();if(!Z.get().streaming.gaps.enableSeekFix||!m&&0!==G.getTime()||(i?i&&a.segmentInfoType===o.Z.SEGMENT_TIMELINE&&(t=_.getValidTimeAheadOfTargetTime(S,r,a,Z.get().streaming.gaps.threshold)):t=_.getValidTimeAheadOfTargetTime(S,r,a,Z.get().streaming.gaps.threshold),isNaN(t)||t===S)){if(_.isLastSegmentRequested(a,S)){var s=_.getCurrentIndex();return n.debug("Segment requesting for stream ".concat(R.id," has finished")),I.trigger(u.Z.STREAM_REQUESTING_COMPLETED,{segmentIndex:s},{streamId:R.id,mediaType:D}),h.segmentRequestingCompleted(s),void p.clearScheduleTimer()}e&&he()}else G.isSeeking()||0===G.getTime()?(n.warn("Adjusting playback time ".concat(t," because of gap in the manifest. Seeking by ").concat(t-S)),G.seek(t,!1,!1)):(n.warn("Adjusting buffering time ".concat(t," because of gap in the manifest. Adjusting time by ").concat(t-S)),Ne(t),e&&he())}function fe(){var e,t=Re();if(isNaN(S)||re()===a.Z.TEXT&&!H.isTextEnabled())return null;if(_){var n=g&&t?g.getRepresentationForQuality(t.quality):null;e=m?_.getSegmentRequestForTime(r,n,S):v?_.repeatSegmentRequest(r,n):_.getNextSegmentRequest(r,n)}return e}function he(){p.startScheduleTimer(G.getLowLatencyModeEnabled()?Z.get().streaming.scheduling.lowLatencyTimeout:Z.get().streaming.scheduling.defaultTimeout)}function pe(e){e.error||h.getIsBufferingCompleted()||h.updateBufferTimestampOffset(e.currentRepresentation)}function ge(e){z.addBufferState(D,e.state,p.getBufferTarget()),e.state!==s.Z.BUFFER_EMPTY||G.isSeeking()||(n.info("Buffer is empty! Stalling!"),z.pushPlayListTraceMetrics(new Date,ee.REBUFFERING_REASON))}function me(e){F.syncExecutedRequestsWithBufferedRange(h.getBuffer().getAllBufferRanges(),R.duration),e.quotaExceeded&&e.from>G.getTime()&&Ne(e.from),e.hasEnoughSpaceToAppend&&e.quotaExceeded&&p.startScheduleTimer()}function ve(e){if(e&&e.lastRequestAppended&&e.lastRequestAppended.url){var t=e.lastRequestAppended.url;e.lastRequestAppended.range&&(t=t.concat("_",e.lastRequestAppended.range)),n.warn("Blacklisting segment with url ".concat(t)),J.add(t)}}function ye(e){if(n.debug("Appended bytes for ".concat(e.mediaType," and stream id ").concat(e.streamId)),e.segmentType===C.w.INIT_SEGMENT_TYPE){var t=e.quality;p.setLastInitializedQuality(t),n.info("["+D+"] lastInitializedRepresentationInfo changed to "+e.quality)}w?_e(w):p.startScheduleTimer(0)}function _e(e){var t=F.getRequests({state:E.FRAGMENT_MODEL_LOADING});if(t&&t.length>0)return n.debug("Preparing for default quality switch: Waiting for ongoing segment request to be finished before applying switch."),void(w=e);h.updateBufferTimestampOffset(e).then(function(){p.setCheckPlaybackQuality(!1),r.segmentAlignment||r.subSegmentAlignment?p.startScheduleTimer():Le(),w=null,y=!1}).catch(function(){w=null,y=!1})}function be(e){n.info("onFragmentLoadingAbandoned request: "+e.request.url+" has been aborted"),G.isSeeking()||p.getSwitchTrack()||y||(n.info("onFragmentLoadingAbandoned request: "+e.request.url+" has to be downloaded again, origin is not seeking process or switch track call"),e.request&&e.request.isInitializationRequest()?p.setInitSegmentRequired(!0):Ne(e.request.startTime+e.request.duration/2),p.startScheduleTimer(0))}function Ee(e){n.info("OnFragmentLoadingCompleted for stream id "+R.id+" and media type "+D+" - Url:",e.request?e.request.url:"undefined",e.request.range?", Range:"+e.request.range:""),ae()&&p.startScheduleTimer(0),e.error&&e.request.serviceLocation&&function(e){n.info("Fragment loading completed with an error"),e&&e.request&&e.request.type&&(e.request.type===C.w.INIT_SEGMENT_TYPE?le({representationId:e.request.representationId,sender:{}},!1):e.request.type===C.w.MEDIA_SEGMENT_TYPE&&(Ne(e.request.startTime+e.request.duration/2),ue({},!1)))}(e)}function Te(){Ne(G.getTime()),xe().startScheduleTimer()}function Se(e){var t=e.currentTrackInfo;if(t){var n=c.find(function(e){return e.index===t.index&&e.lang===t.lang});n&&Ie(n).then(function(){h.setIsBufferingCompleted(!1),Ne(G.getTime()),p.setInitSegmentRequired(!0),p.startScheduleTimer()})}}function we(e){Ne(e.quotaExceededTime),p.clearScheduleTimer()}function Ae(){return h?h.getBuffer():null}function Ie(e){e===r||e&&r&&e.type!==r.type||(r=e);var t=P.getRealAdaptation(R,r),n=P.getVoRepresentations(r);if(g){var o,s=g.getData(),l=U.getMaxAllowedIndexFor(D,R.id),u=U.getMinAllowedIndexFor(D,R.id),c=null;return null!==s&&s.id===t.id||D===a.Z.TEXT?o=U.getQualityFor(D,R.id):(c=U.getThroughputHistory().getAverageThroughput(D,i)||U.getInitialBitrateFor(D,R.id),o=U.getQualityForBitrate(r,c,R.id)),void 0!==u&&o<u&&(o=u),o>l&&(o=l),g.updateData(t,n,D,r.isFragmented,o)}return Promise.resolve()}function xe(){return p}function Re(e){var t;return void 0!==e?((0,Y.SE)(e),t=g?g.getRepresentationForQuality(e):null):t=g?g.getCurrentRepresentation():null,P.convertRepresentationToRepresentationInfo(t)}function Ce(){return!!h&&h.getIsBufferingCompleted()}function De(e){if(Z.get().streaming.enableManifestTimescaleMismatchFix){var t=e.chunk,n=t.bytes,i=Re(t.quality),r=g&&i?g.getRepresentationForQuality(i.quality):null;i&&r&&(r.timescale=Q.getMediaTimescaleFromMoov(n))}}function ke(e){var t=e.chunk,n=t.bytes,i=t.quality,r=Re(i),a=g&&r?g.getRepresentationForQuality(r.quality):null;if(r&&a){var s;if(Z.get().streaming.parseInbandPrft&&e.request.type===C.w.MEDIA_SEGMENT_TYPE){var l=function(e,t){var n=e.getBoxes("prft"),i=[];return n.forEach(function(e){i.push(function(e,t){var n="unknown";switch(e.flags){case 0:n=o.Z.PRODUCER_REFERENCE_TIME_TYPE.ENCODER;break;case 16:n=o.Z.PRODUCER_REFERENCE_TIME_TYPE.APPLICATION;break;case 24:n=o.Z.PRODUCER_REFERENCE_TIME_TYPE.CAPTURED}var i=1e3*e.ntp_timestamp_sec+e.ntp_timestamp_frac/Math.pow(2,32)*1e3;return{type:n,ntpTimestamp:i=ie(A).getInstance().ntpToUTC(i),mediaTime:e.media_time/t}}(e,t))}),i}(s=s||Q.parse(n),a.timescale);l&&l.length&&I.trigger(f.Z.INBAND_PRFT,{data:l},{streamId:R.id,mediaType:D})}var c=P.getEventsFor(r.mediaInfo,null,R),d=P.getEventsFor(r,a,R);if(c&&c.length>0||d&&d.length>0){var h=F.getRequests({state:E.FRAGMENT_MODEL_EXECUTED,quality:i,index:t.index})[0],p=function(e,t,n,i){try{for(var r={},a=[],o=n.concat(i),s=0,l=o.length;s<l;s++)r[o[s].schemeIdUri+"/"+o[s].value]=o[s];var u=e.getBoxes("emsg");if(!u||0===u.length)return a;for(var c=e.getBox("sidx"),d=!c||isNaN(c.earliest_presentation_time)||isNaN(c.timescale)?t&&!isNaN(t.mediaStartTime)?t.mediaStartTime:0:c.earliest_presentation_time/c.timescale,f=Math.max(d,0),h=g.getCurrentRepresentation(),p=0,m=u.length;p<m;p++){var v=P.getEvent(u[p],r,f,h);v&&a.push(v)}return a}catch(e){return[]}}(s=s||Q.parse(n),h,c,d);I.trigger(u.Z.INBAND_EVENTS,{events:p},{streamId:R.id})}}}function Me(){var e=G.getTime();Z.get().streaming.buffer.flushBufferAtTrackSwitch&&G.seek(e+.001,!1,!0),Ne(e),h.setSeekTarget(e),p.startScheduleTimer()}function Le(){var e=G.getTime(),t=h.getContinuousBufferTimeForTargetTime(e);Ne(isNaN(t)?e:t),p.startScheduleTimer()}function Pe(e){e&&!isNaN(e.time)&&(Ne(e.time),h.setSeekTarget(e.time))}function Ne(e){S=e,m=!0}return t={initialize:function(n,r,s){b=(0,te.Z)(A).create({events:u.Z,eventBus:I,streamInfo:R,timelineConverter:L,dashConstants:o.Z,segmentBaseController:e.segmentBaseController,type:D}),_=(0,W.Z)(A).create({streamInfo:R,type:D,timelineConverter:L,dashMetrics:z,mediaPlayerModel:O,baseURLController:e.baseURLController,errHandler:k,segmentsController:b,settings:Z,boxParser:Q,events:u.Z,eventBus:I,errors:x,debug:(0,d.Z)(A).getInstance(),requestModifier:(0,$.Z)(A).getInstance(),dashConstants:o.Z,constants:a.Z,urlUtils:(0,X.Z)(A).getInstance()}),i=R.manifestInfo.isDynamic,_.initialize(i),U.registerStreamType(D,t),g=q(A).create({streamInfo:R,type:D,abrController:U,dashMetrics:z,playbackController:G,timelineConverter:L,dashConstants:o.Z,events:u.Z,eventBus:I,errors:x,isDynamic:i,adapter:P,segmentsController:b}),h=function(e,t){return e?e!==a.Z.TEXT||t?B(A).create({streamInfo:R,type:e,mediaPlayerModel:O,manifestModel:N,fragmentModel:F,errHandler:k,mediaController:j,representationController:g,adapter:P,textController:H,abrController:U,playbackController:G,settings:Z}):V(A).create({streamInfo:R,type:e,mimeType:M,fragmentModel:F,textController:H,errHandler:k,settings:Z}):(k.error(new T.Z(x.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,x.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+"not properly defined")),null)}(D,s),h&&h.initialize(n),(p=K(A).create({streamInfo:R,type:D,mimeType:M,adapter:P,dashMetrics:z,mediaPlayerModel:O,fragmentModel:F,abrController:U,playbackController:G,textController:H,mediaController:j,bufferController:h,representationController:g,settings:Z})).initialize(r),S=0,m=!1,v=!1},getStreamId:ne,getType:re,isUpdating:function(){return!!g&&g.isUpdating()},getBufferController:function(){return h},dischargePreBuffer:function(){h.dischargePreBuffer()},getFragmentModel:function(){return F},getScheduleController:xe,getRepresentationController:function(){return g},getRepresentationInfo:Re,getBufferLevel:function(){return h?h.getBufferLevel():0},isBufferingCompleted:Ce,createBufferSinks:function(e){var t=Ae();return t?Promise.resolve(t):h?h.createBufferSink(r,e):Promise.resolve(null)},updateStreamInfo:function(e){return R=e,Ce()?Promise.resolve():h.updateAppendWindow()},getStreamInfo:function(){return R},selectMediaInfo:Ie,clearMediaInfoArray:function(){c=[]},addMediaInfo:function(e){-1===c.indexOf(e)&&c.push(e)},prepareTrackSwitch:function(){return new Promise(function(e){n.debug("Preparing track switch for type ".concat(D));var t=D===a.Z.TEXT||Z.get().streaming.trackSwitchMode[D]===a.Z.TRACK_SWITCH_MODE_ALWAYS_REPLACE&&G.getTimeToStreamEnd(R)>Z.get().streaming.buffer.stallThreshold;if(h.getIsBufferingCompleted()&&!t)return h.prepareForNonReplacementTrackSwitch(r.codec).then(function(){I.trigger(u.Z.BUFFERING_COMPLETED,{},{streamId:R.id,mediaType:D})}).catch(function(){I.trigger(u.Z.BUFFERING_COMPLETED,{},{streamId:R.id,mediaType:D})}),void e();p.clearScheduleTimer(),p.setSwitchTrack(!0),t?(I.trigger(u.Z.BUFFER_REPLACEMENT_STARTED,{mediaType:D,streamId:R.id},{mediaType:D,streamId:R.id}),F.abortRequests(),h.prepareForReplacementTrackSwitch(r.codec).then(function(){var e=Re();return h.updateBufferTimestampOffset(e)}).then(function(){Me(),e()}).catch(function(){Me(),e()})):h.prepareForNonReplacementTrackSwitch(r.codec).then(function(){Le(),e()}).catch(function(){Le(),e()})})},prepareQualityChange:function(e){w&&n.warn("Canceling queued representation switch to ".concat(w.quality," for ").concat(D)),n.debug("Preparing quality switch for type ".concat(D));var t=e.newQuality;y=!0,p.clearScheduleTimer(),g.prepareQualityChange(t);var i=Re(t);e.reason&&e.reason.forceReplace?function(e){F.abortRequests(),I.trigger(u.Z.BUFFER_REPLACEMENT_STARTED,{mediaType:D,streamId:R.id},{mediaType:D,streamId:R.id}),p.setCheckPlaybackQuality(!1),h.prepareForForceReplacementQualitySwitch(e).then(function(){Me(),w=null,y=!1}).catch(function(){Me(),w=null,y=!1})}(i):e&&e.reason&&e.reason.forceAbandon?function(e){h.updateBufferTimestampOffset(e).then(function(){F.abortRequests(),v=!0,p.setCheckPlaybackQuality(!1),p.startScheduleTimer(),y=!1,w=null}).catch(function(){w=null,y=!1})}(i):Z.get().streaming.buffer.fastSwitchEnabled?function(e){var t=G.getTime(),n=1.5*(isNaN(e.fragmentDuration)?1:e.fragmentDuration),i=F.getRequests({state:E.FRAGMENT_MODEL_EXECUTED,time:t+n,threshold:0})[0];if(i&&!ae()){var r=h.getBufferLevel(),a=U.getAbandonmentStateFor(R.id,D);i.quality<e.quality&&r>=n&&a!==s.Z.ABANDON_LOAD?h.updateBufferTimestampOffset(e).then(function(){F.abortRequests(),Ne(t+n),p.setCheckPlaybackQuality(!1),p.startScheduleTimer(),y=!1}).catch(function(){y=!1}):_e(e)}else _e(e)}(i):_e(i),z.pushPlayListTraceMetrics(new Date,ee.REPRESENTATION_SWITCH_STOP_REASON),z.createPlaylistTraceMetrics(i.id,1e3*G.getTime(),G.getPlaybackRate())},getMediaInfo:function(){return r},getMediaSource:function(){return h.getMediaSource()},setMediaSource:function(e){return h.setMediaSource(e,r)},getBuffer:Ae,setExplicitBufferingTime:Ne,finalisePlayList:function(e,t){z.pushPlayListTraceMetrics(e,t)},probeNextRequest:function(){var e=Re(),t=g&&e?g.getRepresentationForQuality(e.quality):null;return _.getNextSegmentRequestIdempotent(r,t)},prepareInnerPeriodPlaybackSeeking:function(e){return new Promise(function(t){if(h.hasBufferAtTime(e.seekTime))return h.pruneBuffer(),se(h.getContinuousBufferTimeForTargetTime(e.seekTime))&&h.setIsBufferingCompleted(!0),void t();p.clearScheduleTimer(),F.abortRequests(),h.prepareForPlaybackSeek().then(function(){var t=h.getAllRangesWithSafetyFactor(e.seekTime);return h.clearBuffers(t)}).then(function(){var n=h.getContinuousBufferTimeForTargetTime(e.seekTime);if(se(n))h.setIsBufferingCompleted(!0),t();else{var i=isNaN(n)?e.seekTime:n;Ne(i),h.setSeekTarget(i);var r=[];r.push(h.updateAppendWindow());var a=Re();r.push(h.updateBufferTimestampOffset(a)),Promise.all(r).then(function(){p.setInitSegmentRequired(!0),p.setCheckPlaybackQuality(!1),p.startScheduleTimer(),t()})}}).catch(function(e){n.error(e)})})},prepareOuterPeriodPlaybackSeeking:function(){return new Promise(function(e,t){try{p.clearScheduleTimer(),F.abortRequests(),h.prepareForPlaybackSeek().then(function(){return h.pruneAllSafely()}).then(function(){e()})}catch(e){t(e)}})},reset:function(e,n){_&&_.reset(),h&&(h.reset(e,n),h=null),p&&(p.reset(),p=null),g&&(g.reset(),g=null),b&&(b=null),U&&U.unRegisterStreamType(ne(),D),I.off(u.Z.DATA_UPDATE_COMPLETED,pe,t),I.off(u.Z.INIT_FRAGMENT_NEEDED,le,t),I.off(u.Z.MEDIA_FRAGMENT_NEEDED,ue,t),I.off(u.Z.INIT_FRAGMENT_LOADED,De,t),I.off(u.Z.MEDIA_FRAGMENT_LOADED,ke,t),I.off(u.Z.BUFFER_LEVEL_STATE_CHANGED,ge,t),I.off(u.Z.BUFFER_CLEARED,me,t),I.off(u.Z.SEEK_TARGET,Pe,t),I.off(u.Z.FRAGMENT_LOADING_ABANDONED,be,t),I.off(u.Z.FRAGMENT_LOADING_COMPLETED,Ee,t),I.off(u.Z.SET_FRAGMENTED_TEXT_AFTER_DISABLED,Te,t),I.off(u.Z.SET_NON_FRAGMENTED_TEXT,Se,t),I.off(u.Z.QUOTA_EXCEEDED,we,t),I.off(u.Z.SOURCE_BUFFER_ERROR,ve,t),I.off(u.Z.BYTES_APPENDED_END_FRAGMENT,ye,t),oe(),D=null,R=null}},n=(0,d.Z)(A).getInstance().getLogger(t),oe(),I.on(u.Z.DATA_UPDATE_COMPLETED,pe,t,{priority:l.Z.EVENT_PRIORITY_HIGH}),I.on(u.Z.INIT_FRAGMENT_NEEDED,le,t),I.on(u.Z.MEDIA_FRAGMENT_NEEDED,ue,t),I.on(u.Z.INIT_FRAGMENT_LOADED,De,t),I.on(u.Z.MEDIA_FRAGMENT_LOADED,ke,t),I.on(u.Z.BUFFER_LEVEL_STATE_CHANGED,ge,t),I.on(u.Z.BUFFER_CLEARED,me,t),I.on(u.Z.SEEK_TARGET,Pe,t),I.on(u.Z.FRAGMENT_LOADING_ABANDONED,be,t),I.on(u.Z.FRAGMENT_LOADING_COMPLETED,Ee,t),I.on(u.Z.QUOTA_EXCEEDED,we,t),I.on(u.Z.SET_FRAGMENTED_TEXT_AFTER_DISABLED,Te,t),I.on(u.Z.SET_NON_FRAGMENTED_TEXT,Se,t),I.on(u.Z.SOURCE_BUFFER_ERROR,ve,t),I.on(u.Z.BYTES_APPENDED_END_FRAGMENT,ye,t),t}re.__dashjs_factory_name="StreamProcessor";var ae=c.Z.getClassFactory(re),oe=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN,this.representationId=null,this.endFragment=null},se=n(9032);function le(e,t){if(e){if("string"==typeof e)return ue(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ue(e,t):void 0}}function ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function ce(e){e=e||{};var t,n,i=this.context,r=e.requestModifier,o=e.lowLatencyThroughputModel,s=e.boxParser,l=(0,R.Z)(i).getInstance();function u(e){var t,i=new Date,u=e.request,f=new Headers;if(u.range&&f.append("Range","bytes="+u.range),e.headers)for(var h in e.headers){var p=e.headers[h];p&&f.append(h,p)}u.requestStartDate||(u.requestStartDate=i),r&&r.modifyRequestHeader&&r.modifyRequestHeader({setRequestHeader:function(e,t){f.append(e,t)}},{url:e.url}),"function"==typeof window.AbortController&&(t=new AbortController,e.abortController=t,t.signal.onabort=e.onabort);var g={method:e.method,headers:f,credentials:e.withCredentials?"include":void 0,signal:t?t.signal:void 0},m=l.get().streaming.abr.fetchThroughputCalculationMode,v=Date.now(),y=0;new Promise(function(e){if(m===a.Z.ABR_FETCH_THROUGHPUT_CALCULATION_AAST&&o&&(y=o.getThroughputCapacityDelayMS(u,1e3*n.getCurrentBufferLevel(u.mediaType))))return setTimeout(e,y);e()}).then(function(){var t=Date.now();fetch(e.url,g).then(function(i){e.response||(e.response={}),e.response.status=i.status,e.response.statusText=i.statusText,e.response.responseURL=i.url,i.ok||e.onerror();var r,l="",f=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=le(e))){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(i.headers.keys());try{for(f.s();!(r=f.n()).done;){var h=r.value;l+=h+": "+i.headers.get(h)+"\r\n"}}catch(e){f.e(e)}finally{f.f()}if(e.response.responseHeaders=l,!i.body)return i.arrayBuffer().then(function(t){e.response.response=t;var n={loaded:t.byteLength,total:t.byteLength,stream:!1};e.progress(n),e.onload(),e.onend()});var p,g,_,b,E=parseInt(i.headers.get("Content-Length"),10),T=0,S=!1,w=new Uint8Array,A=0;if(m===a.Z.ABR_FETCH_THROUGHPUT_CALCULATION_AAST&&o){var I=t,x=0,R=(_=i.body.tee(),b=2,function(e){if(Array.isArray(e))return e}(_)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){r=!0,a=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw a}}return n}}(_,b)||le(_,b)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),C=R[0],D=R[1];p=C.getReader(),g=[],p.read().then(function i(r){var a=r.value,s=r.done;if(x=Date.now(),a&&a.length){var c=x-I,d=a.length;g.push({chunkDownloadTimeRelativeMS:x-t,chunkDownloadDurationMS:c,chunkBytes:d,kbps:Math.round(8*d/(c/1e3)),bufferLevel:n.getCurrentBufferLevel(u.mediaType)})}if(s){var f=x-t,h=g.reduce(function(e,t){return e+t.chunkBytes},0);return o.addMeasurement(u,f,g,v,y,l),void e.progress({loaded:h,total:h,lengthComputable:!0,time:o.getEstimatedDownloadDurationMS(u),stream:!0})}return I=Date.now(),p.read().then(i)}),e.reader=D.getReader()}else e.reader=i.body.getReader();var k=[],M=[],L=[],P=!0;c(e,function t(n){var i=n.value;if(n.done){if(w){if(m!==a.Z.ABR_FETCH_THROUGHPUT_CALCULATION_AAST){var r=null,o=null;m===a.Z.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING?(r=function(e,t){try{var n,i;n=e.filter(function(t,n){return n<e.length-1}),i=t.filter(function(e,n){return n<t.length-1});var r=[];if(n.length>1){for(var a=0,o=0,s=0;s<n.length;s++)if(n[s]&&i[s]){var l=i[s].ts-n[s].ts;if(l>1)r.push(8*i[s].bytes/l),o=0;else{0===o&&(o=n[s].ts,a=0);var u=i[s].ts-o;u>1?(a+=i[s].bytes,r.push(8*a/u),o=0):a+=i[s].bytes}}if(r.length>0)return r.reduce(function(e,t){return e+t},0)/r.length}return null}catch(e){return null}}(M,L),r&&(o=8*T/r)):m===a.Z.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA&&(o=d(k,T)),e.progress({loaded:T,total:isNaN(E)?T:E,lengthComputable:!0,time:o,stream:!0})}e.response.response=w.buffer}return e.onload(),void e.onend()}if(i&&i.length>0){w=function(e,t){if(0===e.length)return t;var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}(w,i),T+=i.length,k.push({ts:Date.now(),bytes:i.length}),m===a.Z.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING&&P&&s.findLastTopIsoBoxCompleted(["moof"],w,A).found&&(P=!1,M.push({ts:performance.now(),bytes:i.length}));var l=s.findLastTopIsoBoxCompleted(["moov","mdat"],w,A);if(l.found){var u,f=l.lastCompletedOffset+l.size;m!==a.Z.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING||P||(P=!0,L.push({ts:performance.now(),bytes:w.length})),f===w.length?(u=w,w=new Uint8Array):(u=new Uint8Array(w.subarray(0,f)),w=w.subarray(f)),e.progress({data:u.buffer,lengthComputable:!1,noTrace:!0}),A=0}else A=l.lastCompletedOffset,S||(e.progress({lengthComputable:!1,noTrace:!0}),S=!0)}c(e,t)})}).catch(function(t){e.onerror&&e.onerror(t)})})}function c(e,t){e.reader.read().then(t).catch(function(t){e.onerror&&200===e.response.status&&e.onerror(t)})}function d(e,t){try{if((e=e.filter(function(n){return n.bytes>t/4/e.length})).length>1){var n=0,i=(e[e.length-1].ts-e[0].ts)/e.length;return e.forEach(function(t,r){var a=e[r+1];if(a){var o=a.ts-t.ts;n+=o<i?o:0}}),n}return null}catch(e){return null}}return t={load:function(e){r&&r.modifyRequest?(0,$.k)(e,r).then(function(){return u(e)}):u(e)},abort:function(e){if(e.abortController)e.abortController.abort();else if(e.reader)try{e.reader.cancel(),e.onabort()}catch(e){}},calculateDownloadedTime:d,setup:function(e){n=e.dashMetrics}},t}ce.__dashjs_factory_name="FetchLoader";var de=c.Z.getClassFactory(ce),fe=n(1180);function he(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var pe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.codecs=null,this.mimeType=null,this.codecPrivateData=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.mediaFinishedInformation={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN},this.bandwidth=NaN,this.width=NaN,this.height=NaN,this.scanType=null,this.maxPlayoutRate=NaN,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0,this.frameRate=null}var t,n;return t=e,(n=[{key:"hasInitialization",value:function(){return null!==this.initialization||null!==this.range}},{key:"hasSegments",value:function(){return this.segmentInfoType!==o.Z.BASE_URL&&this.segmentInfoType!==o.Z.SEGMENT_BASE&&!this.indexRange}}])&&he(t.prototype,n),e}(),ge=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.period=null,this.index=-1,this.type=null},me=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null,this.nextPeriodId=null};me.DEFAULT_ID="defaultId";var ve=me,ye=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.publishTime=null,this.minimumUpdatePeriod=NaN,this.mediaPresentationDuration=NaN},_e=n(2610),be=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type="",this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN},Ee=function e(t,n,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t||"",this.serviceLocation=n||t||"",this.dvbPriority=i||1,this.dvbWeight=r||1,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0,this.queryParams={}};Ee.DEFAULT_DVB_PRIORITY=1,Ee.DEFAULT_DVB_WEIGHT=1;var Te=Ee,Se=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri="",this.presentationTimeOffset=0},we=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.inband=!1,this.type="encoder",this.applicationScheme=null,this.wallClockTime=null,this.presentationTime=NaN,this.UTCTiming=null},Ae=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.defaultServiceLocation=null,this.defaultServiceLocationArray=[],this.queryBeforeStart=!1,this.serverUrl=null,this.clientRequirement=!0};function Ie(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var xe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.schemeIdUri=null,this.value=null,this.id=null}var t,n;return t=e,(n=[{key:"init",value:function(e){return e&&(this.schemeIdUri=e.schemeIdUri?e.schemeIdUri:null,this.value=e.value?e.value:null,this.id=e.id?e.id:null,e[o.Z.DVB_URL]&&(this.dvbUrl=e[o.Z.DVB_URL]),e[o.Z.DVB_MIMETYPE]&&(this.dvbMimeType=e[o.Z.DVB_MIMETYPE]),e[o.Z.DVB_FONTFAMILY]&&(this.dvbFontFamily=e[o.Z.DVB_FONTFAMILY])),this}}])&&Ie(t.prototype,n),e}(),Re=n(3101),Ce=n.n(Re);function De(){return{areEqual:function(e,t){return Ce()(e,t)}}}De.__dashjs_factory_name="ObjectUtils";var ke=c.Z.getSingletonFactory(De),Me=n(7803),Le=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t||"",this.serviceLocation=n||null,this.queryParams={}},Pe=function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t||"",this.serviceLocation=n||null,this.ttl=i||NaN,this.queryParams={}};function Ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function Oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ne(Object(n),!0).forEach(function(t){Fe(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ne(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Fe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ue(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=Be(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Be(e,t){if(e){if("string"==typeof e)return Ge(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ge(e,t):void 0}}function Ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function je(){var e,t,n,i,r=this.context,s=(0,X.Z)(r).getInstance(),l=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};function u(e,t){if(!e)throw new Error("adaptation is not defined");if(!t)throw new Error("type is not defined");if(e.Representation_asArray&&e.Representation_asArray.length){var n=_(e.Representation_asArray[0]);if(n&&n.length>0&&Me.Y.indexOf(n[0].schemeIdUri)>=0)return t===a.Z.IMAGE}if(e.ContentComponent_asArray&&e.ContentComponent_asArray.length>0){if(e.ContentComponent_asArray.length>1)return t===a.Z.MUXED;if(e.ContentComponent_asArray[0].contentType===t)return!0}var i=t===a.Z.TEXT?new RegExp("(ttml|vtt|wvtt|stpp)"):new RegExp(t);if(e.Representation_asArray&&e.Representation_asArray.length){var r=e.Representation_asArray[0].codecs;if(i.test(r))return!0}if(e.hasOwnProperty(o.Z.MIME_TYPE))return i.test(e.mimeType);if(e.Representation_asArray)for(var s,l=0;l<e.Representation_asArray.length;l++)if((s=e.Representation_asArray[l]).hasOwnProperty(o.Z.MIME_TYPE))return i.test(s.mimeType);return!1}function c(e){if(!e)throw new Error("adaptation is not defined");if(e.hasOwnProperty(o.Z.SEGMENT_TEMPLATE)||e.hasOwnProperty(o.Z.SEGMENT_TIMELINE)||e.hasOwnProperty(o.Z.SEGMENT_LIST)||e.hasOwnProperty(o.Z.SEGMENT_BASE))return!0;if(e.Representation_asArray&&e.Representation_asArray.length>0){var t=e.Representation_asArray[0];if(t.hasOwnProperty(o.Z.SEGMENT_TEMPLATE)||t.hasOwnProperty(o.Z.SEGMENT_TIMELINE)||t.hasOwnProperty(o.Z.SEGMENT_LIST)||t.hasOwnProperty(o.Z.SEGMENT_BASE))return!0}return!1}function f(e){return u(e,a.Z.VIDEO)}function h(e){return u(e,a.Z.TEXT)}function p(e){return u(e,a.Z.IMAGE)}function g(e){return e&&Array.isArray(e.Representation_asArray)&&e.Representation_asArray.sort(function(e,t){return e.bandwidth-t.bandwidth}),e}function m(e,t){return e&&e.Period_asArray&&l(t)&&e.Period_asArray[t]?e.Period_asArray[t].AdaptationSet_asArray:[]}function v(e){return e&&e.Period_asArray?e.Period_asArray:[]}function y(e){var t=!1;return e&&e.hasOwnProperty("type")&&(t=e.type===o.Z.DYNAMIC),t}function _(e){return e&&e.EssentialProperty_asArray&&e.EssentialProperty_asArray.length?e.EssentialProperty_asArray.map(function(e){return{schemeIdUri:e.schemeIdUri,value:e.value}}):null}function b(e){if(!e||!e.S_asArray)return NaN;var t=e.S_asArray[0],n=e.S_asArray[1];return t.hasOwnProperty("d")?t.d:n.t-t.t}function E(e,t){if(!e)throw new Error("Period cannot be null or undefined");var n=ve.DEFAULT_ID+"_"+t;return e.hasOwnProperty(o.Z.ID)&&e.id.length>0&&"__proto__"!==e.id&&(n=e.id),n}function S(e,t,n){var i,r=[];if(!e)return r;for(i=0;i<e.length;i++){var s=new Se;if(s.timescale=1,s.representation=t,!e[i].hasOwnProperty(a.Z.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");s.schemeIdUri=e[i].schemeIdUri,e[i].hasOwnProperty(o.Z.TIMESCALE)&&(s.timescale=e[i].timescale),e[i].hasOwnProperty(o.Z.VALUE)&&(s.value=e[i].value),r.push(s),s.period=n}return r}function w(e){var t=[],n=e.BaseURL_asArray||[e.baseUri],i=!1;return n.some(function(n){if(n){var r=new Te,a=n.__text||n;return s.isRelative(a)&&(i=!0,e.baseUri&&(a=s.resolve(a,e.baseUri))),r.url=a,n.hasOwnProperty(o.Z.SERVICE_LOCATION)&&n.serviceLocation.length?r.serviceLocation=n.serviceLocation:r.serviceLocation=a,n.hasOwnProperty(o.Z.DVB_PRIORITY)&&(r.dvbPriority=n[o.Z.DVB_PRIORITY]),n.hasOwnProperty(o.Z.DVB_WEIGHT)&&(r.dvbWeight=n[o.Z.DVB_WEIGHT]),n.hasOwnProperty(o.Z.AVAILABILITY_TIME_OFFSET)&&(r.availabilityTimeOffset=n[o.Z.AVAILABILITY_TIME_OFFSET]),n.hasOwnProperty(o.Z.AVAILABILITY_TIME_COMPLETE)&&(r.availabilityTimeComplete="false"!==n[o.Z.AVAILABILITY_TIME_COMPLETE]),t.push(r),i}}),t}function A(e){var t=new Ae;return t.serverUrl=e.__text,e.hasOwnProperty(o.Z.DEFAULT_SERVICE_LOCATION)&&(t.defaultServiceLocation=e[o.Z.DEFAULT_SERVICE_LOCATION],t.defaultServiceLocationArray=t.defaultServiceLocation.split(" ")),e.hasOwnProperty(o.Z.QUERY_BEFORE_START)&&(t.queryBeforeStart="true"===e[o.Z.QUERY_BEFORE_START].toLowerCase()),e.hasOwnProperty(o.Z.CLIENT_REQUIREMENT)&&(t.clientRequirement="false"!==e[o.Z.CLIENT_REQUIREMENT].toLowerCase()),t}return e={getIsTypeOf:u,getIsText:h,getIsFragmented:c,getProducerReferenceTimesForAdaptation:function(e){var t=e&&e.hasOwnProperty(o.Z.PRODUCERREFERENCETIME_ASARRAY)?e[o.Z.PRODUCERREFERENCETIME_ASARRAY]:[];(e&&e.hasOwnProperty(o.Z.REPRESENTATION_ASARRAY)?e[o.Z.REPRESENTATION_ASARRAY]:[]).forEach(function(e){var n;e.hasOwnProperty(o.Z.PRODUCERREFERENCETIME_ASARRAY)&&t.push.apply(t,function(e){if(Array.isArray(e))return Ge(e)}(n=e[o.Z.PRODUCERREFERENCETIME_ASARRAY])||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(n)||Be(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())});var n=[];return t.forEach(function(e){var t=new we;e.hasOwnProperty(o.Z.ID)&&(t[o.Z.ID]=e[o.Z.ID],e.hasOwnProperty(o.Z.WALL_CLOCK_TIME)&&(t[o.Z.WALL_CLOCK_TIME]=e[o.Z.WALL_CLOCK_TIME],e.hasOwnProperty(o.Z.PRESENTATION_TIME)&&(t[o.Z.PRESENTATION_TIME]=e[o.Z.PRESENTATION_TIME],e.hasOwnProperty(o.Z.INBAND)&&(t[o.Z.INBAND]="false"!==e[o.Z.INBAND]),e.hasOwnProperty(o.Z.TYPE)&&(t[o.Z.TYPE]=e[o.Z.TYPE]),n.push(t))))}),n},getLanguageForAdaptation:function(e){var t="";return e&&e.hasOwnProperty(o.Z.LANG)&&(t=e.lang),t},getViewpointForAdaptation:function(e){return e&&e.hasOwnProperty(o.Z.VIEWPOINT_ASARRAY)&&e[o.Z.VIEWPOINT_ASARRAY].length?e[o.Z.VIEWPOINT_ASARRAY].map(function(e){return(new xe).init(e)}):[]},getRolesForAdaptation:function(e){return e&&e.hasOwnProperty(o.Z.ROLE_ASARRAY)&&e[o.Z.ROLE_ASARRAY].length?e[o.Z.ROLE_ASARRAY].map(function(e){return(new xe).init(e)}):[]},getAccessibilityForAdaptation:function(e){return e&&e.hasOwnProperty(o.Z.ACCESSIBILITY_ASARRAY)&&e[o.Z.ACCESSIBILITY_ASARRAY].length?e[o.Z.ACCESSIBILITY_ASARRAY].map(function(e){return(new xe).init(e)}):[]},getAudioChannelConfigurationForAdaptation:function(e){return e&&e.hasOwnProperty(o.Z.AUDIOCHANNELCONFIGURATION_ASARRAY)&&e[o.Z.AUDIOCHANNELCONFIGURATION_ASARRAY].length?e[o.Z.AUDIOCHANNELCONFIGURATION_ASARRAY].map(function(e){return(new xe).init(e)}):[]},getAudioChannelConfigurationForRepresentation:function(e){return e&&e.hasOwnProperty(o.Z.AUDIOCHANNELCONFIGURATION_ASARRAY)&&e[o.Z.AUDIOCHANNELCONFIGURATION_ASARRAY].length?e[o.Z.AUDIOCHANNELCONFIGURATION_ASARRAY].map(function(e){return(new xe).init(e)}):[]},getAdaptationForIndex:function(e,t,n){var i=m(t,n);return i.length>0&&l(e)?i[e]:null},getIndexForAdaptation:function(e,t,n){if(!e)return-1;for(var i=m(t,n),a=0;a<i.length;a++)if(ke(r).getInstance().areEqual(i[a],e))return a;return-1},getAdaptationForId:function(e,t,n){var i,r,a=m(t,n);for(i=0,r=a.length;i<r;i++)if(a[i].hasOwnProperty(o.Z.ID)&&a[i].id===e)return a[i];return null},getAdaptationsForType:function(e,t,n){var i,r,a=m(e,t),o=[];for(i=0,r=a.length;i<r;i++)u(a[i],n)&&o.push(g(a[i]));return o},getRealPeriods:v,getRealPeriodForIndex:function(e,t){var n=v(t);return n.length>0&&l(e)?n[e]:null},getCodec:function(e,t,n){var i=null;if(e&&e.Representation_asArray&&e.Representation_asArray.length>0){var r=l(t)&&t>=0&&t<e.Representation_asArray.length?e.Representation_asArray[t]:e.Representation_asArray[0];r&&(i=r.mimeType+';codecs="'+r.codecs+'"',n&&void 0!==r.width&&(i+=';width="'+r.width+'";height="'+r.height+'"'))}return i&&(i=i.replace(/\sprofiles=[^;]*/g,"")),i},getSelectionPriority:function(e){try{var t=e&&void 0!==e.selectionPriority?parseInt(e.selectionPriority):1;return isNaN(t)?1:t}catch(e){return 1}},getMimeType:function(e){return e&&e.Representation_asArray&&e.Representation_asArray.length>0?e.Representation_asArray[0].mimeType:null},getKID:function(e){return e&&e.hasOwnProperty(o.Z.CENC_DEFAULT_KID)?e[o.Z.CENC_DEFAULT_KID]:null},getLabelsForAdaptation:function(e){if(!e||!Array.isArray(e.Label_asArray))return[];for(var t=[],n=0;n<e.Label_asArray.length;n++)t.push({lang:e.Label_asArray[n].lang,text:e.Label_asArray[n].__text||e.Label_asArray[n]});return t},getContentProtectionData:function(e){return e&&e.hasOwnProperty(o.Z.CONTENTPROTECTION_ASARRAY)&&0!==e.ContentProtection_asArray.length?e.ContentProtection_asArray:null},getIsDynamic:y,getId:function(e){return e&&e[o.Z.ID]||null},hasProfile:function(e,t){var n=!1;return e&&e.profiles&&e.profiles.length>0&&(n=-1!==e.profiles.indexOf(t)),n},getDuration:function(e){return e&&e.hasOwnProperty(o.Z.MEDIA_PRESENTATION_DURATION)?e.mediaPresentationDuration:e&&"dynamic"==e.type?Number.POSITIVE_INFINITY:Number.MAX_SAFE_INTEGER||Number.MAX_VALUE},getBandwidth:function(e){return e&&e.bandwidth?e.bandwidth:NaN},getManifestUpdatePeriod:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=NaN;return e&&e.hasOwnProperty(o.Z.MINIMUM_UPDATE_PERIOD)&&(n=e.minimumUpdatePeriod),isNaN(n)?n:Math.max(n-t,1)},getPublishTime:function(e){return e&&e.hasOwnProperty(o.Z.PUBLISH_TIME)?new Date(e[o.Z.PUBLISH_TIME]):null},getRepresentationCount:function(e){return e&&Array.isArray(e.Representation_asArray)?e.Representation_asArray.length:0},getBitrateListForAdaptation:function(e){var t=g(e);return(t&&Array.isArray(t.Representation_asArray)?t.Representation_asArray:[]).map(function(e){return{bandwidth:e.bandwidth,width:e.width||0,height:e.height||0,scanType:e.scanType||null,id:e.id||null}})},getRepresentationFor:function(e,t){return t&&t.Representation_asArray&&t.Representation_asArray.length>0&&l(e)?t.Representation_asArray[e]:null},getRepresentationsForAdaptation:function(e){var t,n,i,r,a=[],s=function(e){if(e&&e.period&&l(e.period.index)){var t=e.period.mpd.manifest.Period_asArray[e.period.index];if(t&&t.AdaptationSet_asArray&&l(e.index))return g(t.AdaptationSet_asArray[e.index])}}(e);if(s&&s.Representation_asArray){if(e&&e.period&&l(e.period.index)){var u=w(e.period.mpd.manifest);u&&(n=u[0])}for(var d=0,f=s.Representation_asArray.length;d<f;++d){var p=s.Representation_asArray[d],m=new pe;if(m.index=d,m.adaptation=e,p.hasOwnProperty(o.Z.ID)&&(m.id=p.id),p.hasOwnProperty(o.Z.CODECS)&&(m.codecs=p.codecs),p.hasOwnProperty(o.Z.MIME_TYPE)&&(m.mimeType=p[o.Z.MIME_TYPE]),p.hasOwnProperty(o.Z.CODEC_PRIVATE_DATA)&&(m.codecPrivateData=p.codecPrivateData),p.hasOwnProperty(o.Z.BANDWITH)&&(m.bandwidth=p.bandwidth),p.hasOwnProperty(o.Z.WIDTH)&&(m.width=p.width),p.hasOwnProperty(o.Z.HEIGHT)&&(m.height=p.height),p.hasOwnProperty(o.Z.SCAN_TYPE)&&(m.scanType=p.scanType),p.hasOwnProperty(o.Z.MAX_PLAYOUT_RATE)&&(m.maxPlayoutRate=p.maxPlayoutRate),p.hasOwnProperty(o.Z.SEGMENT_BASE)?(t=p.SegmentBase,m.segmentInfoType=o.Z.SEGMENT_BASE):p.hasOwnProperty(o.Z.SEGMENT_LIST)?(t=p.SegmentList).hasOwnProperty(o.Z.SEGMENT_TIMELINE)?m.segmentInfoType=o.Z.SEGMENT_TIMELINE:m.segmentInfoType=o.Z.SEGMENT_LIST:p.hasOwnProperty(o.Z.SEGMENT_TEMPLATE)?((t=p.SegmentTemplate).hasOwnProperty(o.Z.SEGMENT_TIMELINE)?m.segmentInfoType=o.Z.SEGMENT_TIMELINE:m.segmentInfoType=o.Z.SEGMENT_TEMPLATE,t.hasOwnProperty(o.Z.INITIALIZATION_MINUS)&&(m.initialization=t.initialization.split("$Bandwidth$").join(p.bandwidth).split("$RepresentationID$").join(p.id))):m.segmentInfoType=o.Z.BASE_URL,m.essentialProperties=_(p),t){if(t.hasOwnProperty(o.Z.INITIALIZATION)){var v=t.Initialization;v.hasOwnProperty(o.Z.SOURCE_URL)&&(m.initialization=v.sourceURL),v.hasOwnProperty(o.Z.RANGE)&&(m.range=v.range)}else h(s)&&c(s)&&s.mimeType&&-1===s.mimeType.indexOf("application/mp4")&&(m.range=0);t.hasOwnProperty(o.Z.TIMESCALE)&&(m.timescale=t.timescale),t.hasOwnProperty(o.Z.DURATION)?m.segmentDuration=t.duration/m.timescale:p.hasOwnProperty(o.Z.SEGMENT_TEMPLATE)&&(t=p.SegmentTemplate).hasOwnProperty(o.Z.SEGMENT_TIMELINE)&&(m.segmentDuration=b(t.SegmentTimeline)/m.timescale),t.hasOwnProperty(o.Z.MEDIA)&&(m.media=t.media),t.hasOwnProperty(o.Z.START_NUMBER)&&(m.startNumber=t.startNumber),t.hasOwnProperty(o.Z.INDEX_RANGE)&&(m.indexRange=t.indexRange),t.hasOwnProperty(o.Z.PRESENTATION_TIME_OFFSET)&&(m.presentationTimeOffset=t.presentationTimeOffset/m.timescale),t.hasOwnProperty(o.Z.AVAILABILITY_TIME_OFFSET)?m.availabilityTimeOffset=t.availabilityTimeOffset:n&&void 0!==n.availabilityTimeOffset&&(m.availabilityTimeOffset=n.availabilityTimeOffset),t.hasOwnProperty(o.Z.AVAILABILITY_TIME_COMPLETE)?m.availabilityTimeComplete="false"!==t.availabilityTimeComplete:n&&void 0!==n.availabilityTimeComplete&&(m.availabilityTimeComplete=n.availabilityTimeComplete)}m.MSETimeOffset=(r=(i=m).presentationTimeOffset,i.adaptation.period.start-r),m.path=[e.period.index,e.index,d],a.push(m)}}return a},getAdaptationsForPeriod:function(e){var n,i,r,s=e&&l(e.index)?e.mpd.manifest.Period_asArray[e.index]:null,c=[];if(s&&s.AdaptationSet_asArray)for(r=0;r<s.AdaptationSet_asArray.length;r++)i=s.AdaptationSet_asArray[r],n=new ge,i.hasOwnProperty(o.Z.ID)&&(n.id=i.id),n.index=r,n.period=e,u(i,a.Z.MUXED)?n.type=a.Z.MUXED:u(i,a.Z.AUDIO)?n.type=a.Z.AUDIO:f(i)?n.type=a.Z.VIDEO:h(i)?n.type=a.Z.TEXT:p(i)?n.type=a.Z.IMAGE:t.warn("Unknown Adaptation stream type"),c.push(n);return c},getRegularPeriods:function(e){var i,r,s=!!e&&y(e.manifest),l=[],u=null,c=null,d=null,f=null;for(r=0,i=e&&e.manifest&&e.manifest.Period_asArray?e.manifest.Period_asArray.length:0;r<i;r++)(c=e.manifest.Period_asArray[r]).hasOwnProperty(o.Z.START)?(f=new ve).start=c.start:null!==u&&u.hasOwnProperty(o.Z.DURATION)&&null!==d?(f=new ve).start=parseFloat((d.start+d.duration).toFixed(5)):0!==r||s||((f=new ve).start=0),null!==d&&isNaN(d.duration)&&(null!==f?d.duration=parseFloat((f.start-d.start).toFixed(5)):t.warn("First period duration could not be calculated because lack of start and duration period properties. This will cause timing issues during playback")),null!==f&&(f.id=E(c,r),f.index=r,f.mpd=e,c.hasOwnProperty(o.Z.DURATION)&&(f.duration=c.duration),d&&(d.nextPeriodId=f.id),l.push(f),u=c,d=f),c=null,f=null;return 0===l.length||null!==d&&isNaN(d.duration)&&(d.duration=parseFloat((function(e){!function(){if(!n||!n.hasOwnProperty("error"))throw new Error(a.Z.MISSING_CONFIG_ERROR)}();var t,i=y(e.mpd.manifest);return e.mpd.manifest.mediaPresentationDuration?t=e.mpd.manifest.mediaPresentationDuration:e.duration?t=e.duration:i?t=Number.POSITIVE_INFINITY:n.error(new T.Z(x.MANIFEST_ERROR_ID_PARSE_CODE,"Must have @mediaPresentationDuration on MPD or an explicit @duration on the last period.",e)),t}(d)-d.start).toFixed(5))),l},getMpd:function(e){var t=new ye;return e&&(t.manifest=e,e.hasOwnProperty(o.Z.AVAILABILITY_START_TIME)?t.availabilityStartTime=new Date(e.availabilityStartTime.getTime()):e.loadedTime&&(t.availabilityStartTime=new Date(e.loadedTime.getTime())),e.hasOwnProperty(o.Z.AVAILABILITY_END_TIME)&&(t.availabilityEndTime=new Date(e.availabilityEndTime.getTime())),e.hasOwnProperty(o.Z.MINIMUM_UPDATE_PERIOD)&&(t.minimumUpdatePeriod=e.minimumUpdatePeriod),e.hasOwnProperty(o.Z.MEDIA_PRESENTATION_DURATION)&&(t.mediaPresentationDuration=e.mediaPresentationDuration),e.hasOwnProperty(o.Z.SUGGESTED_PRESENTATION_DELAY)&&(t.suggestedPresentationDelay=e.suggestedPresentationDelay),e.hasOwnProperty(o.Z.TIMESHIFT_BUFFER_DEPTH)&&(t.timeShiftBufferDepth=e.timeShiftBufferDepth),e.hasOwnProperty(o.Z.MAX_SEGMENT_DURATION)&&(t.maxSegmentDuration=e.maxSegmentDuration),e.hasOwnProperty(o.Z.PUBLISH_TIME)&&(t.publishTime=new Date(e.publishTime))),t},getEventsForPeriod:function(e){var t,n,r=e&&e.mpd&&e.mpd.manifest?e.mpd.manifest:null,s=r?r.Period_asArray:null,u=s&&e&&l(e.index)?s[e.index].EventStream_asArray:null,c=[];if(u)for(t=0;t<u.length;t++){var d=new Se;if(d.period=e,d.timescale=1,!u[t].hasOwnProperty(a.Z.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");for(d.schemeIdUri=u[t][a.Z.SCHEME_ID_URI],u[t].hasOwnProperty(o.Z.TIMESCALE)&&(d.timescale=u[t][o.Z.TIMESCALE]),u[t].hasOwnProperty(o.Z.VALUE)&&(d.value=u[t][o.Z.VALUE]),u[t].hasOwnProperty(o.Z.PRESENTATION_TIME_OFFSET)&&(d.presentationTimeOffset=u[t][o.Z.PRESENTATION_TIME_OFFSET]),n=0;u[t].Event_asArray&&n<u[t].Event_asArray.length;n++){var f=u[t].Event_asArray[n],h=new be;h.presentationTime=0,h.eventStream=d,f.hasOwnProperty(o.Z.PRESENTATION_TIME)&&(h.presentationTime=f.presentationTime);var p=d.presentationTimeOffset?d.presentationTimeOffset/d.timescale:0;h.calculatedPresentationTime=h.presentationTime/d.timescale+e.start-p,f.hasOwnProperty(o.Z.DURATION)&&(h.duration=f.duration/d.timescale),f.hasOwnProperty(o.Z.ID)?h.id=f.id:h.id=null,f.Signal&&f.Signal.Binary?h.messageData=i.decodeArray(f.Signal.Binary.toString()):h.messageData=f.messageData||f.__cdata||f.__text,c.push(h)}}return c},getEssentialPropertiesForAdaptation:function(e){var t={};if(e&&e.hasOwnProperty(o.Z.ESSENTIAL_PROPERTY_ASARRAY)){var n,i=Ue(e.EssentialProperty_asArray);try{for(i.s();!(n=i.n()).done;){var r=n.value;r.hasOwnProperty(a.Z.SCHEME_ID_URI)&&(t[r[a.Z.SCHEME_ID_URI]]=Oe({},r))}}catch(e){i.e(e)}finally{i.f()}}return t},getEssentialPropertiesAsArrayForAdaptation:function(e){return e&&e.hasOwnProperty(o.Z.ESSENTIAL_PROPERTY_ASARRAY)&&e.EssentialProperty_asArray.length?e.EssentialProperty_asArray.map(function(e){return(new xe).init(e)}):[]},getEssentialPropertiesForRepresentation:_,getEventStreamForAdaptationSet:function(e,t,n){var i,r,a;return e&&e.Period_asArray&&t&&t.period&&l(t.period.index)&&(r=e.Period_asArray[t.period.index])&&r.AdaptationSet_asArray&&l(t.index)&&(a=r.AdaptationSet_asArray[t.index])&&(i=a.InbandEventStream_asArray),S(i,null,n)},getEventStreamForRepresentation:function(e,t,n){var i,r,a,o;return e&&e.Period_asArray&&t&&t.adaptation&&t.adaptation.period&&l(t.adaptation.period.index)&&(r=e.Period_asArray[t.adaptation.period.index])&&r.AdaptationSet_asArray&&l(t.adaptation.index)&&(a=r.AdaptationSet_asArray[t.adaptation.index])&&a.Representation_asArray&&l(t.index)&&(o=a.Representation_asArray[t.index])&&(i=o.InbandEventStream_asArray),S(i,t,n)},getUTCTimingSources:function(e){var t=y(e),n=!!e&&e.hasOwnProperty(o.Z.AVAILABILITY_START_TIME),i=e?e.UTCTiming_asArray:null,r=[];return(t||n)&&i&&i.forEach(function(e){var t=new _e.Z;e.hasOwnProperty(a.Z.SCHEME_ID_URI)&&(t.schemeIdUri=e.schemeIdUri,e.hasOwnProperty(o.Z.VALUE)&&(t.value=e.value.toString(),r.push(t)))}),r},getBaseURLsFromElement:w,getRepresentationSortFunction:function(){return function(e,t){return e.bandwidth-t.bandwidth}},getContentSteering:function(e){if(e&&e.hasOwnProperty(o.Z.CONTENT_STEERING_AS_ARRAY))return A(e[o.Z.CONTENT_STEERING_AS_ARRAY][0])},getLocation:function(e){return e&&e.hasOwnProperty(o.Z.LOCATION_AS_ARRAY)?e[o.Z.LOCATION_AS_ARRAY].map(function(e){var t=e.__text||e,n=e.hasOwnProperty(o.Z.SERVICE_LOCATION)?e[o.Z.SERVICE_LOCATION]:null;return new Le(t,n)}):[]},getPatchLocation:function(e){return e&&e.hasOwnProperty(o.Z.PATCH_LOCATION_AS_ARRAY)?e[o.Z.PATCH_LOCATION_AS_ARRAY].map(function(e){var t=e.__text||e,n=e.hasOwnProperty(o.Z.SERVICE_LOCATION)?e[o.Z.SERVICE_LOCATION]:null,i=e.hasOwnProperty(o.Z.TTL)?1e3*parseFloat(e[o.Z.TTL]):NaN;return new Pe(t,n,i)}):[]},getSuggestedPresentationDelay:function(e){return e&&e.hasOwnProperty(o.Z.SUGGESTED_PRESENTATION_DELAY)?e.suggestedPresentationDelay:null},getAvailabilityStartTime:function(e){return e&&e.hasOwnProperty(o.Z.AVAILABILITY_START_TIME)&&null!==e.availabilityStartTime?e.availabilityStartTime.getTime():null},getServiceDescriptions:function(e){var t=[];if(e&&e.hasOwnProperty(o.Z.SERVICE_DESCRIPTION)){var n,i=Ue(e.ServiceDescription_asArray);try{for(i.s();!(n=i.n()).done;){var r=n.value,a=null,s=null,l=null,u=null,c=null,d=null,f=null;for(var h in r)r.hasOwnProperty(h)&&(h===o.Z.ID?a=r[h]:h===o.Z.SERVICE_DESCRIPTION_SCOPE?s=r[h].schemeIdUri:h===o.Z.SERVICE_DESCRIPTION_LATENCY?l={target:parseInt(r[h].target),max:parseInt(r[h].max),min:parseInt(r[h].min),referenceId:parseInt(r[h].referenceId)}:h===o.Z.SERVICE_DESCRIPTION_PLAYBACK_RATE?u={max:parseFloat(r[h].max),min:parseFloat(r[h].min)}:h===o.Z.SERVICE_DESCRIPTION_OPERATING_QUALITY?c={mediaType:r[h].mediaType,max:parseInt(r[h].max),min:parseInt(r[h].min),target:parseInt(r[h].target),type:r[h].type,maxQualityDifference:parseInt(r[h].maxQualityDifference)}:h===o.Z.SERVICE_DESCRIPTION_OPERATING_BANDWIDTH?d={mediaType:r[h].mediaType,max:parseInt(r[h].max),min:parseInt(r[h].min),target:parseInt(r[h].target)}:h===o.Z.CONTENT_STEERING&&(f=A(r[h])));t.push({id:a,schemeIdUri:s,latency:l,playbackRate:u,operatingQuality:c,operatingBandwidth:d,contentSteering:f})}}catch(e){i.e(e)}finally{i.f()}}return t},getSegmentAlignment:function(e){return!(!e||!e.hasOwnProperty(o.Z.SEGMENT_ALIGNMENT))&&"true"===e[o.Z.SEGMENT_ALIGNMENT]},getSubSegmentAlignment:function(e){return!(!e||!e.hasOwnProperty(o.Z.SUB_SEGMENT_ALIGNMENT))&&"true"===e[o.Z.SUB_SEGMENT_ALIGNMENT]},getSupplementalPropertiesForAdaptation:function(e){var t={};if(e&&e.hasOwnProperty(o.Z.SUPPLEMENTAL_PROPERTY_ASARRAY)){var n,i=Ue(e.SupplementalProperty_asArray);try{for(i.s();!(n=i.n()).done;){var r=n.value;r.hasOwnProperty(a.Z.SCHEME_ID_URI)&&(t[r[a.Z.SCHEME_ID_URI]]=Oe({},r))}}catch(e){i.e(e)}finally{i.f()}}return t},getSupplementalPropertiesAsArrayForAdaptation:function(e){return e&&e.hasOwnProperty(o.Z.SUPPLEMENTAL_PROPERTY_ASARRAY)&&e.SupplementalProperty_asArray.length?e.SupplementalProperty_asArray.map(function(e){return(new xe).init(e)}):[]},getSupplementalPropertiesForRepresentation:function(e){var t={};if(e&&e.hasOwnProperty(o.Z.SUPPLEMENTAL_PROPERTY_ASARRAY)){var n,i=Ue(e.SupplementalProperty_asArray);try{for(i.s();!(n=i.n()).done;){var r=n.value;r.hasOwnProperty(a.Z.SCHEME_ID_URI)&&(t[r[a.Z.SCHEME_ID_URI]]=Oe({},r))}}catch(e){i.e(e)}finally{i.f()}}return t},getSupplementalPropertiesAsArrayForRepresentation:function(e){return e&&e.hasOwnProperty(o.Z.SUPPLEMENTAL_PROPERTY_ASARRAY)&&e.SupplementalProperty_asArray.length?e.SupplementalProperty_asArray.map(function(e){return(new xe).init(e)}):[]},setConfig:function(e){e&&(e.errHandler&&(n=e.errHandler),e.BASE64&&(i=e.BASE64))}},t=(0,d.Z)(r).getInstance().getLogger(e),e}je.__dashjs_factory_name="DashManifestModel";var Ve=c.Z.getSingletonFactory(je),He=n(703);function Ke(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ze(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ze(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ze(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Ze(){var e,t,n,i,r,o,s,u,c,d,h=this.context,p=(0,l.Z)(h).getInstance(),g=(0,R.Z)(h).getInstance();function m(){n={pr:1,nor:null,st:null,sf:null,sid:"".concat(He.Z.generateUuid()),cid:null},c={},u={},d={},y()}function v(){y()}function y(){if(o){var e=o.getStreamController();if(e&&"function"==typeof e.getActiveStream){var t=e.getActiveStream();t&&(s=t.getProcessors())}}}function _(e,t){var n,i={},r=Ke(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;e[a]&&(i[a]=e[a])}}catch(e){r.e(e)}finally{r.f()}return i}function b(e){var t=g.get().streaming.cmcd.enabledKeys;return e.filter(function(e){return t.includes(e)})}function E(e){try{return e.type===C.w.MPD_TYPE?((l=T()).ot="m",l):e.type===C.w.MEDIA_SEGMENT_TYPE?(t=e.mediaType,d.hasOwnProperty(t)||(d[t]=!1),u.hasOwnProperty(t)||(u[t]=!1),c.hasOwnProperty(t)||(c[t]=!1),function(e){var t,l=T(),f=function(e){try{var t=e.quality,n=e.mediaInfo.bitrateList;return parseInt(n[t].bandwidth/1e3)}catch(e){return null}}(e),h=function(e){try{return isNaN(e.duration)?NaN:Math.round(1e3*e.duration)}catch(e){return null}}(e),p=function(e){try{return 100*parseInt(i.getThroughputHistory().getSafeAverageThroughput(e)/100)}catch(e){return null}}(e.mediaType),m=function(e){try{var t=n.pr,i=r.getCurrentBufferLevel(e);return isNaN(t)||isNaN(i)?null:100*parseInt(i/t*10)}catch(e){return null}}(e.mediaType),v=S(e.mediaType),y=function(e){try{var t=i.getTopBitrateInfoFor(e);return Math.round(t.bitrate/1e3)}catch(e){return null}}(e.mediaType),_=n.pr,b=function(e){if(s&&0!==s.length){var t,n=Ke(s);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.getType()===e)return i.probeNextRequest()}}catch(e){n.e(e)}finally{n.f()}}}(e.mediaType);e.mediaType===a.Z.VIDEO&&(t="v"),e.mediaType===a.Z.AUDIO&&(t="a"),e.mediaType===a.Z.TEXT&&(t="application/mp4"===e.mediaInfo.mimeType?"tt":"c");var E=g.get().streaming.cmcd.rtp;return E||(E=function(e){try{var t=o.getPlaybackRate();t||(t=1);var n=e.quality,i=e.mediaType,r=e.mediaInfo,a=e.duration;if(!r)return NaN;var s=S(i);0===s&&(s=500);var l=r.bitrateList[n].bandwidth*a/1e3/(s/t/1e3),u=g.get().streaming.cmcd.rtpSafetyFactor&&!isNaN(g.get().streaming.cmcd.rtpSafetyFactor)?g.get().streaming.cmcd.rtpSafetyFactor:5;return 100*(parseInt(l*u/100)+1)}catch(e){return NaN}}(e)),isNaN(E)||(l.rtp=E),b&&(e.url!==b.url?l.nor=encodeURIComponent(He.Z.getRelativeUrl(e.url,b.url)):b.range&&(l.nrr=b.range)),f&&(l.br=f),t&&(l.ot=t),isNaN(h)||(l.d=h),isNaN(p)||(l.mtp=p),isNaN(m)||(l.dl=m),isNaN(v)||(l.bl=v),isNaN(y)||(l.tb=y),isNaN(_)||1===_||(l.pr=_),c[e.mediaType]&&(l.bs=!0,c[e.mediaType]=!1),!u[e.mediaType]&&d[e.mediaType]||(l.su=!0,u[e.mediaType]=!1,d[e.mediaType]=!0),l}(e)):e.type===C.w.INIT_SEGMENT_TYPE?function(){var e=T();return e.ot="i",e.su=!0,e}():e.type===C.w.OTHER_TYPE||e.type===C.w.XLINK_EXPANSION_TYPE?function(){var e=T();return e.ot="o",e}():e.type===C.w.LICENSE?function(e){var t=T();return t.ot="k",t}():null}catch(e){return null}var t,l}function T(){var e={},t=g.get().streaming.cmcd.cid?g.get().streaming.cmcd.cid:n.cid;return e.v=1,e.sid=g.get().streaming.cmcd.sid?g.get().streaming.cmcd.sid:n.sid,e.sid="".concat(e.sid),t&&(e.cid="".concat(t)),isNaN(n.pr)||1===n.pr||null===n.pr||(e.pr=n.pr),n.st&&(e.st=n.st),n.sf&&(e.sf=n.sf),e}function S(e){try{var t=r.getCurrentBufferLevel(e);return isNaN(t)?null:100*parseInt(10*t)}catch(e){return null}}function w(e){try{n.pr=e.playbackRate}catch(e){}}function A(t){try{var i=e.getIsDynamic(t.data)?"l":"v",r=t.protocol&&"MSS"===t.protocol?"s":"d";n.st="".concat(i),n.sf="".concat(r)}catch(e){}}function I(e){try{e.state&&e.mediaType&&e.state===f.Z.BUFFER_EMPTY&&(c[e.mediaType]||(c[e.mediaType]=!0),u[e.mediaType]||(u[e.mediaType]=!0))}catch(e){}}function x(){for(var e in c)c.hasOwnProperty(e)&&(c[e]=!0);for(var t in u)u.hasOwnProperty(t)&&(u[t]=!0)}function D(e){try{if(!e)return null;var t=Object.keys(e).sort(function(e,t){return e.localeCompare(t)}),n=t.length,i=t.reduce(function(t,i,r){return"v"===i&&1===e[i]||("string"==typeof e[i]&&"ot"!==i&&"sf"!==i&&"st"!==i?t+="".concat(i,"=").concat(JSON.stringify(e[i])):t+="".concat(i,"=").concat(e[i]),r<n-1&&(t+=",")),t},"");return(i=i.replace(/=true/g,"")).replace(/,\s*$/,"")}catch(e){return null}}return t={getQueryParameter:function(e){try{if(g.get().streaming.cmcd&&g.get().streaming.cmcd.enabled){var t=E(e),n=function(e){try{var t=g.get().streaming.cmcd.enabledKeys;return Object.keys(e).filter(function(e){return t.includes(e)}).reduce(function(t,n){return t[n]=e[n],t},{})}catch(t){return e}}(t),i=D(n);return p.trigger(fe.Z.CMCD_DATA_GENERATED,{url:e.url,mediaType:e.mediaType,cmcdData:t,cmcdString:i}),{key:"CMCD",value:i}}return null}catch(e){return null}},getHeaderParameters:function(e){try{if(g.get().streaming.cmcd&&g.get().streaming.cmcd.enabled){var t=E(e),n=_(t,b(["br","d","ot","tb"])),i=_(t,b(["bl","dl","mtp","nor","nrr","su"])),r=_(t,b(["bs","rtp"])),a=_(t,b(["cid","pr","sf","sid","st","v"])),o={"CMCD-Object":D(n),"CMCD-Request":D(i),"CMCD-Status":D(r),"CMCD-Session":D(a)};return p.trigger(fe.Z.CMCD_DATA_GENERATED,{url:e.url,mediaType:e.mediaType,cmcdData:t,headers:o}),o}return null}catch(e){return null}},setConfig:function(e){e&&(e.abrController&&(i=e.abrController),e.dashMetrics&&(r=e.dashMetrics),e.playbackController&&(o=e.playbackController))},reset:function(){p.off(f.Z.PLAYBACK_RATE_CHANGED,w,this),p.off(f.Z.MANIFEST_LOADED,A,this),p.off(f.Z.BUFFER_LEVEL_STATE_CHANGED,I,t),p.off(f.Z.PLAYBACK_SEEKED,x,t),m()},initialize:function(){p.on(f.Z.PLAYBACK_RATE_CHANGED,w,t),p.on(f.Z.MANIFEST_LOADED,A,t),p.on(f.Z.BUFFER_LEVEL_STATE_CHANGED,I,t),p.on(f.Z.PLAYBACK_SEEKED,x,t),p.on(f.Z.PERIOD_SWITCH_COMPLETED,v,t)}},e=Ve(h).getInstance(),m(),t}Ze.__dashjs_factory_name="CmcdModel";var qe=c.Z.getSingletonFactory(Ze);function Ye(e){return Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ye(e)}function We(e,t){We=function(e,t){return new a(e,void 0,t)};var n=Xe(RegExp),i=RegExp.prototype,r=new WeakMap;function a(e,t,i){var a=n.call(this,e,t);return r.set(a,i||r.get(e)),a}function o(e,t){var n=r.get(t);return Object.keys(n).reduce(function(t,i){return t[i]=e[n[i]],t},Object.create(null))}return $e(a,n),a.prototype.exec=function(e){var t=i.exec.call(this,e);return t&&(t.groups=o(t,this)),t},a.prototype[Symbol.replace]=function(e,t){if("string"==typeof t){var n=r.get(this);return i[Symbol.replace].call(this,e,t.replace(/\$<([^>]+)>/g,function(e,t){return"$"+n[t]}))}if("function"==typeof t){var a=this;return i[Symbol.replace].call(this,e,function(){var e=[];return e.push.apply(e,arguments),"object"!==Ye(e[e.length-1])&&e.push(o(e,a)),t.apply(this,e)})}return i[Symbol.replace].call(this,e,t)},We.apply(this,arguments)}function $e(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&et(e,t)}function Xe(e){var t="function"==typeof Map?new Map:void 0;return Xe=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return Qe(e,arguments,tt(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),et(i,e)},Xe(e)}function Qe(e,t,n){return Qe=Je()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var r=new(Function.bind.apply(e,i));return n&&et(r,n.prototype),r},Qe.apply(null,arguments)}function Je(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function et(e,t){return et=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},et(e,t)}function tt(e){return tt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},tt(e)}var nt="static",it="dynamic",rt="cmsd-",at=rt+nt,ot=rt+it,st="stream",lt=["mb","st","sf","v"],ut={video:"v",audio:"a",text:"tt",stream:st},ct=/^[-0-9]/;function dt(){var e,t,n,i,r=this.context,a=(0,l.Z)(r).getInstance();function o(){n={},i={}}function s(e){e&&Object.keys(e).forEach(function(t){lt.includes(t)||delete e[t]})}function c(e){return!e||"false"!==e.toLowerCase()&&(ct.test(e)?parseInt(e,10):e.replace(/["]+/g,""))}function f(e){try{for(var n={},i=e.split(","),r=0;r<i.length;r++){var a=i[r].split("="),o=a[0],s=c(a[1]);n[o]=s}return n}catch(e){t.error("Failed to parse CMSD-Static response header value:",e)}}function h(e){try{for(var n={},i=e.split(","),r=i[i.length-1].split(";"),a=1;a<r.length;a++){var o=r[a].split("="),s=o[0],l=c(o[1]);n[s]=l}return n}catch(e){return t.error("Failed to parse CMSD-Dynamic response header value:",e),[]}}function p(e){return ut[e]||"o"}function g(e,t,r){var a=e===nt?n:i,o=a[t]||{},s=a[st]||{};return o[r]||s[r]}return e={setConfig:function(){},initialize:function(){},reset:function(){o()},parseResponseHeaders:function(e,t){for(var r=null,o=null,l=e.split("\r\n"),c=l.length-1;c>=0;c--){var d=l[c].match(We(/^((?:(?!:)[\s\S])*):[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(.*)$/,{key:1,value:2}));if(d&&d.groups){var g=d.groups.key.toLowerCase(),m=d.groups.value;switch(g){case at:r=f(m),a.trigger(u.Z.CMSD_STATIC_HEADER,r);break;case ot:o||(o=h(m))}}}var v=st;return r&&r.ot?v=r.ot:t&&(v=p(t)),s(n[v]),s(i[v]),r&&(n[v]=Object.assign(n[v]||{},r)),o&&(i[v]=Object.assign(i[v]||{},o)),{static:r,dynamic:o}},getMaxBitrate:function(e){var t=p(e);return g(it,t,"mb")||-1},getEstimatedThroughput:function(e){var t=p(e);return g(it,t,"etp")||null},getResponseDelay:function(e){var t=p(e);return g(it,t,"rd")||null},getRoundTripTime:function(e){var t=p(e);return g(it,t,"rtt")||null}},t=(0,d.Z)(r).getInstance().getLogger(e),o(),e}dt.__dashjs_factory_name="CmsdModel";var ft=c.Z.getSingletonFactory(dt);function ht(){var e,t,n=this.context,i={};function r(){t=(0,d.Z)(n).getInstance().getLogger(e)}function a(e){for(var t={},n=0,i=0,r=0,a=0,o=e.length,s=0;s<o;++s)n+=e[s].chunkDownloadTimeRelativeMS,i+=e[s].bufferLevel,r+=e[s].chunkDownloadTimeRelativeMS*e[s].bufferLevel,a+=e[s].chunkDownloadTimeRelativeMS*e[s].chunkDownloadTimeRelativeMS;return t.m=(r-n*i/o)/(a-n*n/o),t.b=i/o-t.m*n/o,function(e){return t.m*e+t.b}}function o(e){var t,n=!0,i=e.reduce(function(e,t){return e+t.bufferLevelAtSegmentEnd},0)/e.length;return e.forEach(function(e){Math.abs(e.bufferLevelAtSegmentEnd/e.bufferLevelAtSegmentStart)<.95&&(n=!1),e.bufferLevelAtSegmentEnd/i<.8&&(n=!1),t?t>e.bitrate&&(n=!1):t=e.bitrate}),n}return e={setup:r,addMeasurement:function(e,t,n,r,o){e&&e.mediaType&&!i[e.mediaType]&&(i[e.mediaType]=[]);var s=e.mediaInfo.bitrateList.find(function(t){return t.id===e.representationId});i[e.mediaType].push({index:e.index,repId:e.representationId,mediaType:e.mediaType,requestTimeMS:r,adjustedAvailabilityStartTimeMS:e.availabilityStartTime.getTime(),segDurationMS:1e3*e.duration,chunksDurationMS:n.reduce(function(e,t){return e+t.chunkDownloadDurationMS},0),segmentBytes:n.reduce(function(e,t){return e+t.chunkBytes},0),bitrate:s&&s.bandwidth,bitrateList:e.mediaInfo.bitrateList,chunkMeasurements:n,fetchDownloadDurationMS:t,throughputCapacityDelayMS:o,getEstimatedBufferLevel:a(n.slice(1))}),i[e.mediaType].length>10&&i[e.mediaType].shift()},getThroughputCapacityDelayMS:function(e,t){var n=i[e.mediaType]&&i[e.mediaType].slice(-3);return!n||n.length<3?0:o(n)?t/4>250?250:t/4:0},getEstimatedDownloadDurationMS:function(e){var n=i[e.mediaType].slice(-1).pop(),r=i[e.mediaType].slice(-3),a=n.chunkMeasurements.slice(-1).pop().chunkDownloadTimeRelativeMS;n.bufferLevelAtSegmentStart=n.getEstimatedBufferLevel(a/2),n.bufferLevelAtSegmentEnd=n.getEstimatedBufferLevel(a);var s=o(r),l=s?.6:.8;if(n.isBufferStable&&1.05*n.segDurationMS<n.fetchDownloadDurationMS)return n.fetchDownloadDurationMS;if(!s||n.segDurationMS<n.fetchDownloadDurationMS)return.8*n.fetchDownloadDurationMS;if(n.adjustedAvailabilityStartTimeMS<=n.requestTimeMS+n.throughputCapacityDelayMS-n.segDurationMS)return.8*n.fetchDownloadDurationMS;for(var u=n.requestTimeMS+n.throughputCapacityDelayMS-n.adjustedAvailabilityStartTimeMS,c=0,d=0,f=0,h=0;h<n.chunkMeasurements.length;h++){var p=n.chunkMeasurements[h];if(u<d+p.chunkDownloadDurationMS)break;d+=p.chunkDownloadDurationMS,c+=p.chunkBytes,f++}if(u<0&&t.warn("request time was before adjusted availibitly start time"),c&&d&&f>.2*n.chunkMeasurements.length){var g=c/d,m=n.segmentBytes/g;return n.fetchDownloadDurationMS<m?n.fetchDownloadDurationMS*l:m*l}var v=n.bitrate;return n.bitrateList.some(function(e){if(e.bandwidth>n.bitrate)return v=e.bandwidth,!0}),v===n.bitrate?n.fetchDownloadDurationMS*l:l*n.segmentBytes*8*1e3/v}},r(),e}ht.__dashjs_factory_name="LowLatencyThroughputModel";var pt=c.Z.getSingletonFactory(ht),gt=n(5717);function mt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vt(e){e=e||{};var t,n,i,r,o,s,c,f,h,p,g,m=this.context,v=e.errHandler,y=e.dashMetrics,_=e.mediaPlayerModel,b=e.requestModifier,E=e.boxParser,S=e.errors,w=e.requestTimeout||0,A=(0,l.Z)(m).getInstance(),I=(0,R.Z)(m).getInstance();function x(e,t){var l,d=e.request,g=[],S=!0,R=!0,D=new Date,k=D,M=0,L=null,P=null;if(!b||!y||!v)throw new Error("config object is not correct or missing");var N,O=function(e){d.requestStartDate=D,d.requestEndDate=new Date,d.firstByteDate=d.firstByteDate||D,d.fileLoaderType=P;var t=l.response?l.response.responseURL:null,n=l.response?l.response.status:null,i=l.response&&l.response.getAllResponseHeaders?l.response.getAllResponseHeaders():l.response?l.response.responseHeaders:null,r=i&&I.get().streaming.cmsd&&I.get().streaming.cmsd.enabled?c.parseResponseHeaders(i,d.mediaType):null;y.addHttpRequest(d,t,n,i,e?g:null,r)},F=function(e){R=!1,O(e),d.type===C.w.MPD_TYPE&&(y.addManifestUpdate(d),A.trigger(u.Z.MANIFEST_LOADING_FINISHED,{request:d}))},U=function(){if(L&&(clearTimeout(L),L=null),-1!==n.indexOf(l)&&(n.splice(n.indexOf(l),1),R))if(F(!1),t>0){try{I.get().streaming.utcSynchronization.enableBackgroundSyncAfterSegmentDownloadError&&d.type===C.w.MEDIA_SEGMENT_TYPE&&_.getRetryAttemptsForType(C.w.MEDIA_SEGMENT_TYPE)===t&&A.trigger(u.Z.ATTEMPT_BACKGROUND_SYNC)}catch(e){}t--;var i={config:e};r.push(i),i.timeout=setTimeout(function(){-1!==r.indexOf(i)&&(r.splice(r.indexOf(i),1),x(e,t))},_.getRetryIntervalsForType(d.type))}else{if(d.type===C.w.MSS_FRAGMENT_INFO_SEGMENT_TYPE)return;v.error(new T.Z(o[d.type],d.url+" is not available",{request:d,response:l.response})),e.error&&e.error(d,"error",l.response.statusText,l.response),e.complete&&e.complete(d,l.response.statusText)}};d.hasOwnProperty("availabilityTimeComplete")&&!1===d.availabilityTimeComplete&&window.fetch&&"arraybuffer"===d.responseType&&d.type===C.w.MEDIA_SEGMENT_TYPE?((N=de(m).create({requestModifier:b,lowLatencyThroughputModel:h,boxParser:E})).setup({dashMetrics:y}),P=a.Z.FILE_LOADER_TYPES.FETCH):(N=(0,se.Z)(m).create({requestModifier:b}),P=a.Z.FILE_LOADER_TYPES.XHR);var B=null,G=b.modifyRequestURL?b.modifyRequestURL(d.url):d.url;if(I.get().streaming.cmcd&&I.get().streaming.cmcd.enabled){var j=I.get().streaming.cmcd.mode;if(j===a.Z.CMCD_MODE_QUERY){var V=function(e){try{var t=[],n=s.getQueryParameter(e);return n&&t.push(n),t}catch(e){return[]}}(d);G=He.Z.addAditionalQueryParameterToUrl(G,V)}else j===a.Z.CMCD_MODE_HEADER&&(B=s.getHeaderParameters(d))}var H=f.getXHRWithCredentialsForType(d.type);if(d.queryParams){var K=Object.keys(d.queryParams).map(function(e){return{key:e,value:d.queryParams[e]}});G=He.Z.addAditionalQueryParameterToUrl(G,K)}d.url=G,l={url:G,method:C.w.GET,withCredentials:H,request:d,onload:function(){l.response.status>=200&&l.response.status<=299&&(F(!0),e.success&&e.success(l.response.response,l.response.statusText,l.response.responseURL),e.complete&&e.complete(d,l.response.statusText))},onend:U,onerror:U,progress:function(t){var n=new Date;S&&(S=!1,(!t.lengthComputable||t.lengthComputable&&t.total!==t.loaded)&&(d.firstByteDate=n)),t.lengthComputable&&(d.bytesLoaded=t.loaded,d.bytesTotal=t.total),t.noTrace||(g.push({s:k,d:t.time?t.time:n.getTime()-k.getTime(),b:[t.loaded?t.loaded-M:0]}),k=n,M=t.loaded),L&&(clearTimeout(L),L=null),I.get().streaming.fragmentRequestProgressTimeout>0&&(L=setTimeout(function(){p.warn("Abort request "+l.url+" due to progress timeout"),l.response.onabort=null,l.loader.abort(l),U()},I.get().streaming.fragmentRequestProgressTimeout)),e.progress&&t&&e.progress(t)},onabort:function(){O(!0),L&&(clearTimeout(L),L=null),e.abort&&e.abort(d)},ontimeout:function(e){var t;if(e.lengthComputable){var n=e.loaded/e.total*100;t="Request timeout: loaded: "+e.loaded+", out of: "+e.total+" : "+n.toFixed(3)+"% Completed"}else t="Request timeout: non-computable download size";p.warn(t)},loader:N,timeout:w,headers:B};var z=(new Date).getTime();if(isNaN(d.delayLoadingTime)||z>=d.delayLoadingTime)n.push(l),N.load(l);else{var Z={httpRequest:l};i.push(Z),Z.delayTimeout=setTimeout(function(){if(-1!==i.indexOf(Z)){i.splice(i.indexOf(Z),1);try{D=new Date,k=D,n.push(Z.httpRequest),N.load(Z.httpRequest)}catch(e){Z.httpRequest.onerror()}}},d.delayLoadingTime-z)}}return t={load:function(e){e.request?x(e,_.getRetryAttemptsForType(e.request.type)):e.error&&e.error(e.request,"error")},abort:function(){r.forEach(function(e){clearTimeout(e.timeout),e.config.request&&e.config.abort&&e.config.abort(e.config.request)}),r=[],i.forEach(function(e){return clearTimeout(e.delayTimeout)}),i=[],n.forEach(function(e){e.request.type!==C.w.MSS_FRAGMENT_INFO_SEGMENT_TYPE&&(e.onloadend=e.onerror=e.onprogress=void 0,e.loader.abort(e))}),n=[]}},p=(0,d.Z)(m).getInstance().getLogger(t),n=[],i=[],r=[],s=qe(m).getInstance(),c=ft(m).getInstance(),h=pt(m).getInstance(),f=(0,gt.Z)(m).getInstance(),mt(g={},C.w.MPD_TYPE,S.DOWNLOAD_ERROR_ID_MANIFEST_CODE),mt(g,C.w.XLINK_EXPANSION_TYPE,S.DOWNLOAD_ERROR_ID_XLINK_CODE),mt(g,C.w.INIT_SEGMENT_TYPE,S.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE),mt(g,C.w.MEDIA_SEGMENT_TYPE,S.DOWNLOAD_ERROR_ID_CONTENT_CODE),mt(g,C.w.INDEX_SEGMENT_TYPE,S.DOWNLOAD_ERROR_ID_CONTENT_CODE),mt(g,C.w.BITSTREAM_SWITCHING_SEGMENT_TYPE,S.DOWNLOAD_ERROR_ID_CONTENT_CODE),mt(g,C.w.OTHER_TYPE,S.DOWNLOAD_ERROR_ID_CONTENT_CODE),o=g,t}vt.__dashjs_factory_name="HTTPLoader";var yt=c.Z.getClassFactory(vt);function _t(){var e;function t(){e={}}function n(){t()}return n(),{getLoader:function(t){for(var n in e)if(e.hasOwnProperty(n)&&t.startsWith(n))return e[n];return yt},registerLoader:function(t,n){e[t]=n},unregisterLoader:function(t){e[t]&&delete e[t]},unregisterAllLoader:t,reset:n}}_t.__dashjs_factory_name="SchemeLoaderFactory";var bt=c.Z.getSingletonFactory(_t);function Et(e){e=e||{};var t,n,i=this.context;return t=bt(i).getInstance(),{load:function(r){if(!n){var a=t.getLoader(r&&r.request?r.request.url:null);n=a(i).create({errHandler:e.errHandler,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,dashMetrics:e.dashMetrics,boxParser:e.boxParser?e.boxParser:null,constants:e.constants?e.constants:null,dashConstants:e.dashConstants?e.dashConstants:null,urlUtils:e.urlUtils?e.urlUtils:null,requestTimeout:isNaN(e.requestTimeout)?0:e.requestTimeout,errors:e.errors})}n.load(r)},abort:function(){n&&n.abort()}}}Et.__dashjs_factory_name="URLLoader";var Tt=c.Z.getClassFactory(Et);function St(e){return St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},St(e)}function wt(e,t){return wt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},wt(e,t)}function At(e,t){return!t||"object"!==St(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function It(e){return It=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},It(e)}var xt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wt(e,t)}(r,e);var t,n,i=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=It(t);if(n){var r=It(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return At(this,e)});function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=i.call(this,e)).checkForExistenceOnly=!0,t}return r}(g.Z);function Rt(e){e=e||{};var t,n,i=this.context,r=e.eventBus,o=e.events,s=e.urlUtils,l=e.errors,u=e.streamId;return t={checkForExistence:function(e){var t=function(t){r.trigger(o.CHECK_FOR_EXISTENCE_COMPLETED,{request:e,exists:t})};if(e){var i=new xt(e.url);n.load({request:i,success:function(){t(!0)},error:function(){t(!1)}})}else t(!1)},load:function(e){var i=function(n,i){r.trigger(o.LOADING_COMPLETED,{request:e,response:n||null,error:i||null,sender:t})};e?n.load({request:e,progress:function(n){r.trigger(o.LOADING_PROGRESS,{request:e,stream:n.stream,streamId:u}),n.data&&r.trigger(o.LOADING_DATA_PROGRESS,{request:e,response:n.data||null,error:null,sender:t})},success:function(e){i(e)},error:function(e,t,n){i(void 0,new T.Z(l.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE,n,t))},abort:function(e){e&&r.trigger(o.LOADING_ABANDONED,{mediaType:e.mediaType,request:e,sender:t})}}):i(void 0,new T.Z(l.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE,l.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE))},abort:function(){n&&n.abort()},reset:function(){n&&(n.abort(),n=null)}},n=Tt(i).create({errHandler:e.errHandler,errors:l,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,urlUtils:s,constants:a.Z,boxParser:e.boxParser,dashConstants:e.dashConstants,requestTimeout:e.settings.get().streaming.fragmentRequestTimeout}),t}Rt.__dashjs_factory_name="FragmentLoader";var Ct=c.Z.getClassFactory(Rt);function Dt(){return{modifyResponseAsync:function(e){return Promise.resolve(e)}}}Dt.__dashjs_factory_name="SegmentResponseModifier";var kt=c.Z.getSingletonFactory(Dt);function Mt(e){e=e||{};var t,n,i,r=this.context,o=(0,l.Z)(r).getInstance(),s=e.errHandler,c=e.mediaPlayerModel,h=e.dashMetrics,p=(0,d.Z)(r).getInstance(),g=kt(r).getInstance(),m=e.streamInfo;function v(){return m.id}function y(){for(var e in i)i[e].reset();i={}}function _(e){if(e.sender){var t=e.request,i=e.response,r=t.isInitializationRequest(),s=t.mediaInfo.streamInfo;if(e.error&&(t.mediaType===a.Z.AUDIO||t.mediaType===a.Z.VIDEO||t.mediaType===a.Z.TEXT&&t.mediaInfo.isFragmented)&&o.trigger(u.Z.SERVICE_LOCATION_BASE_URL_BLACKLIST_ADD,{entry:e.request.serviceLocation}),i&&s){var l=function(e,t,n,i){var r=new oe;return r.streamId=n,r.mediaInfo=t.mediaInfo,r.segmentType=t.type,r.start=t.startTime,r.duration=t.duration,r.end=r.start+r.duration,r.bytes=e,r.index=t.index,r.quality=t.quality,r.representationId=t.representationId,r.endFragment=i,r}(i,t,m.id,e.type!==u.Z.FRAGMENT_LOADING_PROGRESS);g.modifyResponseAsync(l).then(function(e){o.trigger(r?u.Z.INIT_FRAGMENT_LOADED:u.Z.MEDIA_FRAGMENT_LOADED,{chunk:e,request:t},{streamId:s.id,mediaType:t.mediaType})}).catch(function(e){n.error(e),o.trigger(r?u.Z.INIT_FRAGMENT_LOADED:u.Z.MEDIA_FRAGMENT_LOADED,{chunk:l,request:t},{streamId:s.id,mediaType:t.mediaType})})}else n.warn("No "+t.mediaType+" bytes to push or stream is inactive.")}}return t={getStreamId:v,getModel:function(t){var n=i[t];return n||(n=E(r).create({streamInfo:m,type:t,dashMetrics:h,fragmentLoader:Ct(r).create({dashMetrics:h,mediaPlayerModel:c,errHandler:s,requestModifier:(0,$.Z)(r).getInstance(),settings:e.settings,boxParser:e.boxParser,eventBus:o,events:u.Z,errors:x,dashConstants:e.dashConstants,urlUtils:e.urlUtils,streamId:v()}),debug:p,eventBus:o,events:u.Z}),i[t]=n),n},reset:function(){o.off(f.Z.FRAGMENT_LOADING_COMPLETED,_,this),o.off(f.Z.FRAGMENT_LOADING_PROGRESS,_,this),y()}},n=p.getLogger(t),y(),o.on(f.Z.FRAGMENT_LOADING_COMPLETED,_,t),o.on(f.Z.FRAGMENT_LOADING_PROGRESS,_,t),t}Mt.__dashjs_factory_name="FragmentController";var Lt=c.Z.getClassFactory(Mt),Pt=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=null,this.width=null,this.height=null,this.x=null,this.y=null},Nt=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mediaType=null,this.bitrate=null,this.width=null,this.height=null,this.scanType=null,this.qualityIndex=NaN};function Ot(e){var t,n,i=this.context,r=e.streamInfo;function o(e){n.setTrackByIndex(e)}function s(){n&&n.reset()}return t={getStreamId:function(){return r.id},initialize:function(){n.addTracks();var e=n.getTracks();e&&e.length>0&&o(0)},provide:function(e,t){if("function"==typeof t){var i,r,a=n.getCurrentTrack();if(!a||a.segmentDuration<=0||null==e)t(null);else{(r=n.getThumbnailRequestForTime(e))&&(a.segmentDuration=r.duration),i=e%a.segmentDuration;var o=Math.floor(i*a.tilesHor*a.tilesVert/a.segmentDuration),s=new Pt;if(s.width=Math.floor(a.widthPerTile),s.height=Math.floor(a.heightPerTile),s.x=Math.floor(o%a.tilesHor)*a.widthPerTile,s.y=Math.floor(o/a.tilesHor)*a.heightPerTile,"readThumbnail"in a)return a.readThumbnail(e,function(e){s.url=e,t(s)});if(r)s.url=r.url,a.segmentDuration=NaN;else{var l=Math.floor(e/a.segmentDuration);s.url=function(e,t){var n=t+e.startNumber,i=(0,z.vi)(e.templateUrl,"Number",n);return i=(0,z.vi)(i,"Time",(n-1)*e.segmentDuration*e.timescale),i=(0,z.vi)(i,"Bandwidth",e.bandwidth),(0,z.eR)(i)}(a,l)}t(s)}}},setTrackByIndex:o,getCurrentTrackIndex:function(){return n.getCurrentTrackIndex()},getBitrateList:function(){var e=n.getTracks(),t=0;return e.map(function(e){var n=new Nt;return n.mediaType=a.Z.IMAGE,n.qualityIndex=t++,n.bitrate=e.bitrate,n.width=e.width,n.height=e.height,n})},reset:s},s(),n=(0,Me.Z)(i).create({streamInfo:r,adapter:e.adapter,baseURLController:e.baseURLController,timelineConverter:e.timelineConverter,debug:e.debug,eventBus:e.eventBus,events:e.events,dashConstants:e.dashConstants,dashMetrics:e.dashMetrics,segmentBaseController:e.segmentBaseController}),t}Ot.__dashjs_factory_name="ThumbnailController";var Ft=c.Z.getClassFactory(Ot),Ut=n(7417);function Bt(e){var t;e=e||{};var n=[],i=(0,l.Z)(this.context).getInstance(),r=e.updateEventName,a=e.addBlacklistEventName;function o(e){-1===n.indexOf(e)&&(n.push(e),i.trigger(r,{entry:e}))}return t={add:o,contains:function(e){return!!(n.length&&e&&e.length)&&-1!==n.indexOf(e)},reset:function(){n=[]}},a&&i.on(a,function(e){o(e.entry)},t),t}Bt.__dashjs_factory_name="BlackListController";var Gt=c.Z.getClassFactory(Bt),jt=[a.Z.VIDEO,a.Z.AUDIO,a.Z.TEXT,a.Z.MUXED,a.Z.IMAGE];function Vt(e){e=e||{};var t,n,i,r,s,c,f,h,p,g,m,v,y,_,b,E,S,w,A=this.context,I=(0,l.Z)(A).getInstance(),R=(0,X.Z)(A).getInstance(),C=e.manifestModel,D=e.mediaPlayerModel,k=e.dashMetrics,M=e.manifestUpdater,L=e.adapter,P=e.timelineConverter,N=e.capabilities,O=e.errHandler,F=e.abrController,U=e.playbackController,B=e.eventController,G=e.mediaController,j=e.protectionController,V=e.textController,H=e.videoModel,K=e.streamInfo,z=e.settings;function Z(e,t){return new Promise(function(r,o){ne(),g=!0,re();var s=H.getElement(),l=[];jt.forEach(function(t){(t!==a.Z.TEXT||e)&&(t!==a.Z.VIDEO||!s||s&&/^VIDEO$/i.test(s.nodeName))&&l.push(q(t,e))}),Promise.all(l).then(function(){return e=t,new Promise(function(t){var n={},r=i.map(function(t){return t.createBufferSinks(e)});Promise.all(r).then(function(e){e.forEach(function(e){e&&(n[e.getType()]=e)}),t(n)}).catch(function(){t(n)})});var e}).then(function(t){if(g=!1,0===i.length){var a="No streams to play.";O.error(new T.Z(x.MANIFEST_ERROR_ID_NOSTREAMS_CODE,a,C.getValue())),n.fatal(a)}else oe();e&&V.createTracks(K),r(t)}).catch(function(e){o(e)})})}function q(t,r){var s,l=L.getAllMediaInfoForType(K,t),c=[],d=null;if(!l||0===l.length)return n.info("No "+t+" data."),Promise.resolve();t===a.Z.VIDEO&&(f=!0),t===a.Z.AUDIO&&(h=!0);for(var p=0,g=l.length;p<g;p++)d=l[p],t===a.Z.TEXT&&d.isEmbedded&&(V.addEmbeddedTrack(K,d),c.push(d)),Y(d)&&G.addTrack(d);if(c.length>0&&(G.setInitialMediaSettingsForType(t,K),V.addMediaInfosToBuffer(K,t,c)),l=l.filter(function(e){return!e.isEmbedded}),0===l.length)return Promise.resolve();if(t===a.Z.IMAGE)return(v=Ft(A).create({streamInfo:K,adapter:L,baseURLController:e.baseURLController,timelineConverter:e.timelineConverter,debug:E,eventBus:I,events:u.Z,dashConstants:o.Z,dashMetrics:e.dashMetrics,segmentBaseController:e.segmentBaseController})).initialize(),Promise.resolve();I.trigger(u.Z.STREAM_INITIALIZING,{streamInfo:K,mediaInfo:d}),G.setInitialMediaSettingsForType(t,K);var _=function(t,n){var r=t&&t.length>0?t[0]:null,o=m.getModel(r?r.type:null),s=r?r.type:null,l=r?r.mimeType:null,u=r?r.isFragmented:null,c=ae(A).create({streamInfo:K,type:s,mimeType:l,timelineConverter:P,adapter:L,manifestModel:C,mediaPlayerModel:D,fragmentModel:o,dashMetrics:e.dashMetrics,baseURLController:e.baseURLController,segmentBaseController:e.segmentBaseController,abrController:F,playbackController:U,mediaController:G,textController:V,errHandler:O,settings:z,boxParser:b,segmentBlacklistController:y});c.initialize(n,f,u),i.push(c);for(var d=0;d<t.length;d++)c.addMediaInfo(t[d]);return s===a.Z.TEXT&&V.addMediaInfosToBuffer(K,s,t,o),c}(l,r);return(s=G.getCurrentTrackFor(t,K.id))?(F.updateTopQualityIndex(s),_.selectMediaInfo(t===a.Z.TEXT&&s.isEmbedded?l[0]:s)):Promise.resolve()}function Y(e){var t,i=e?e.type:null;return i===a.Z.MUXED?(t="Multiplexed representations are intentionally not supported, as they are not compliant with the DASH-AVC/264 guidelines",n.fatal(t),O.error(new T.Z(x.MANIFEST_ERROR_ID_MULTIPLEXED_CODE,t,C.getValue())),!1):!(i!==a.Z.TEXT&&i!==a.Z.IMAGE&&e.contentProtection&&!N.supportsEncryptedMedia()&&(O.error(new T.Z(x.CAPABILITY_MEDIAKEYS_ERROR_CODE,x.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE)),1))}function W(e){for(var t=i?i.length:0,n=0;n<t;n++){var r=i[n].getFragmentModel();r.abortRequests(),r.resetInitialSettings(),i[n].reset(!1,e)}V&&V.deactivateStream(K),i=[],s=!1,c=!1,me(!1),Q(!1),I.trigger(u.Z.STREAM_DEACTIVATED,{streamInfo:K})}function $(e){W(e),r=!1,f=!1,h=!1,p={},g=!1,S=!1,w=[]}function Q(e){S=e}function J(){return K?K.start:NaN}function ee(){return K?K.id:null}function te(){return K}function ne(){if(!H||!F)throw new Error(a.Z.MISSING_CONFIG_ERROR)}function ie(e){e.error&&(O.error(e.error),n.fatal(e.error.message))}function re(){if(B){var e=L.getEventsFor(K);e&&e.length>0&&B.addInlineEvents(e,K.id)}}function oe(){for(var e=i.length,t=p.audio||p.video?new T.Z(x.DATA_UPDATE_FAILED_ERROR_CODE,x.DATA_UPDATE_FAILED_ERROR_MESSAGE):null,n=0;n<e;n++)if(i[n].isUpdating()||g)return;if(j){j.clearMediaInfoArray();for(var o=0;o<e&&i[o];o++){var s=i[o].getType(),l=i[o].getMediaInfo();if(s===a.Z.AUDIO||s===a.Z.VIDEO||s===a.Z.TEXT&&l.isFragmented){var c=i[o].getMediaInfo();c&&j.initializeForMedia(c)}}j.handleKeySystemFromManifest()}t?O.error(t):r||(r=!0,H.waitForReadyState(a.Z.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,function(){I.trigger(u.Z.STREAM_INITIALIZED,{streamInfo:K})}))}function se(){var e=fe(),t=e.length;if(0!==t){for(var i=0;i<t;i++)if(!e[i].isBufferingCompleted()&&(e[i].getType()===a.Z.AUDIO||e[i].getType()===a.Z.VIDEO))return void n.debug("onBufferingCompleted - One streamProcessor has finished but",e[i].getType(),"one is not buffering completed");n.debug("onBufferingCompleted - trigger STREAM_BUFFERING_COMPLETED"),c=!0,I.trigger(u.Z.STREAM_BUFFERING_COMPLETED,{streamInfo:K},{streamInfo:K})}else n.warn("onBufferingCompleted - can't trigger STREAM_BUFFERING_COMPLETED because no streamProcessor is defined")}function le(e){p[e.mediaType]=e.error,oe()}function ue(e){B&&B.addInbandEvents(e.events,K.id)}function ce(e){return e&&e.type?de(e.type):null}function de(e){return e?fe().filter(function(t){return t.getType()===e})[0]:null}function fe(){for(var e,t,n=[],r=0;r<i.length;r++)(e=(t=i[r]).getType())!==a.Z.AUDIO&&e!==a.Z.VIDEO&&e!==a.Z.TEXT||n.push(t);return n}function he(e,t){var n=te(),i=t.getStreamInfo();if(!i||!n)return!0;var r=L.getAdaptationForType(i.index,e,i),a=L.getAdaptationForType(n.index,e,n);return r&&a?!(!pe(a)&&pe(r)):!r&&!a}function pe(e){return!!e&&!!(e.ContentProtection||e.Representation_asArray&&e.Representation_asArray.length>0&&e.Representation_asArray[0].ContentProtection)}function ge(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e||!e.hasOwnProperty("getStreamInfo"))return!1;var i=e.getStreamInfo(),r=n?n.getStreamInfo():te();if(!i||!r)return!1;var a=L.getAdaptationForType(i.index,t,i),o=L.getAdaptationForType(r.index,t,r);if(!a||!o)return!a&&!o;var s=a&&o&&a.mimeType===o.mimeType,l=o.Representation_asArray.map(function(e){return e.codecs}),u=a.Representation_asArray.map(function(e){return e.codecs}),c=u.some(function(e){return l.indexOf(e)>-1}),d=u.some(function(e){return l.some(function(t){return N.codecRootCompatibleWithCodec(t,e)})});return c||d&&s}function me(e){_=e}function ve(){return _}return t={initialize:function(){I.on(u.Z.BUFFERING_COMPLETED,se,t),I.on(u.Z.DATA_UPDATE_COMPLETED,le,t),I.on(u.Z.INBAND_EVENTS,ue,t),j&&(I.on(u.Z.KEY_ERROR,ie,t),I.on(u.Z.SERVER_CERTIFICATE_UPDATED,ie,t),I.on(u.Z.LICENSE_REQUEST_COMPLETE,ie,t),I.on(u.Z.KEY_SYSTEM_SELECTED,ie,t),I.on(u.Z.KEY_SESSION_CREATED,ie,t),I.on(u.Z.KEY_STATUSES_CHANGED,ie,t)),V.initializeForStream(K),I.trigger(u.Z.STREAM_UPDATED,{streamInfo:K})},getStreamId:function(){return K?K.id:null},activate:function(e,t){return new Promise(function(n,i){if(!s)return ve()?(s=!0,I.trigger(u.Z.STREAM_ACTIVATED,{streamInfo:K}),void n(t)):void function(e,t){return Z(e,t)}(e,t).then(function(e){s=!0,I.trigger(u.Z.STREAM_ACTIVATED,{streamInfo:K}),n(e)}).catch(function(e){i(e)});n(t)})},deactivate:W,getIsActive:function(){return s},getDuration:function(){return K?K.duration:NaN},getStartTime:J,getId:ee,getStreamInfo:te,getHasAudioTrack:function(){return h},getHasVideoTrack:function(){return f},startPreloading:function(e,t){return new Promise(function(r,a){ve()?a():(n.info("[startPreloading] Preloading next stream with id ".concat(ee())),me(!0),Z(e,t).then(function(){for(var e=0;e<i.length&&i[e];e++)i[e].setExplicitBufferingTime(J()),i[e].getScheduleController().startScheduleTimer();r()}).catch(function(){me(!1),a()}))})},initializeForTextWithMediaSource:function(e){return new Promise(function(t,n){q(a.Z.TEXT,e).then(function(){return(e=de(a.Z.TEXT))?e.createBufferSinks():Promise.resolve();var e}).then(function(){V.createTracks(K),t()}).catch(function(e){n(e)})})},getThumbnailController:function(){return v},getBitrateListFor:function(e){if(ne(),e===a.Z.IMAGE)return v?v.getBitrateList():[];var t=function(e){for(var t=null,n=0;n<i.length;n++)if((t=i[n]).getType()===e)return t.getMediaInfo();return null}(e);return F.getBitrateList(t)},updateData:function(e){return new Promise(function(t){g=!0,K=e,B&&re();for(var n=[],r=0,a=i.length;r<a;r++){var o=i[r],s=o.getMediaInfo();n.push(o.updateStreamInfo(K));var l=L.getAllMediaInfoForType(K,o.getType());if(l=l.filter(function(e){return!e.isEmbedded})){o.clearMediaInfoArray();for(var c=0;c<l.length;c++){var d=l[c];o.addMediaInfo(l[c]),L.areMediaInfosEqual(s,d)&&(F.updateTopQualityIndex(d),n.push(o.selectMediaInfo(d)))}}}Promise.all(n).then(function(){for(n=[];w.length>0;){var e=w.pop(),t=e.newMediaInfo,i=ce(e.oldMediaInfo);if(!i)return;n.push(i.prepareTrackSwitch()),n.push(i.selectMediaInfo(t))}return Promise.all(n)}).then(function(){g=!1,oe(),I.trigger(u.Z.STREAM_UPDATED,{streamInfo:K}),t()})})},reset:function(e){m&&(m.reset(),m=null),F&&K&&F.clearDataForStream(K.id),y&&(y.reset(),y=null),$(e),K=null,I.off(u.Z.DATA_UPDATE_COMPLETED,le,t),I.off(u.Z.BUFFERING_COMPLETED,se,t),I.off(u.Z.INBAND_EVENTS,ue,t),j&&(I.off(u.Z.KEY_ERROR,ie,t),I.off(u.Z.SERVER_CERTIFICATE_UPDATED,ie,t),I.off(u.Z.LICENSE_REQUEST_COMPLETE,ie,t),I.off(u.Z.KEY_SYSTEM_SELECTED,ie,t),I.off(u.Z.KEY_SESSION_CREATED,ie,t),I.off(u.Z.KEY_STATUSES_CHANGED,ie,t))},getProcessors:fe,setMediaSource:function(e){return new Promise(function(t,r){for(var a=[],o=0;o<i.length;)Y(i[o].getMediaInfo())?(a.push(i[o].setMediaSource(e)),o++):(i[o].reset(),i.splice(o,1));Promise.all(a).then(function(){for(var e=0;e<i.length;e++)i[e].dischargePreBuffer();if(0===i.length){var r="No streams to play.";O.error(new T.Z(x.MANIFEST_ERROR_ID_NOSTREAMS_CODE,r+"nostreams",C.getValue())),n.fatal(r)}t()}).catch(function(e){n.error(e),r(e)})})},isMediaCodecCompatible:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return ge(e,a.Z.VIDEO,t)&&ge(e,a.Z.AUDIO,t)},isProtectionCompatible:function(e){return!e||he(a.Z.VIDEO,e)&&he(a.Z.AUDIO,e)},getPreloaded:ve,getIsEndedEventSignaled:function(){return S},setIsEndedEventSignaled:Q,getAdapter:function(){return L},getHasFinishedBuffering:function(){return c},setPreloaded:me,startScheduleControllers:function(){for(var e=i.length,t=0;t<e&&i[t];t++)i[t].getScheduleController().startScheduleTimer()},prepareTrackChange:function(e){if(s&&K){c=!1;var t=e.newMediaInfo,i=C.getValue();L.setCurrentMediaInfo(K.id,t.type,t);var r=ce(t);if(r){var o=U.getTime();n.info("Stream -  Process track changed at current time "+o),i.refreshManifestOnSwitchTrack?(w.push(e),M.getIsUpdating()||(n.debug("Stream -  Refreshing manifest for switch track"),M.refreshManifest())):r.selectMediaInfo(t).then(function(){t.type!==a.Z.VIDEO&&t.type!==a.Z.AUDIO||F.updateTopQualityIndex(t),r.prepareTrackSwitch()})}}},prepareQualityChange:function(e){var t=de(e.mediaType);t&&t.prepareQualityChange(e)}},function(){try{E=(0,d.Z)(A).getInstance(),n=E.getLogger(t),$(),b=(0,Ut.Z)(A).getInstance(),y=Gt(A).create({updateEventName:u.Z.SEGMENT_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:u.Z.SEGMENT_LOCATION_BLACKLIST_ADD}),m=Lt(A).create({streamInfo:K,mediaPlayerModel:D,dashMetrics:k,errHandler:O,settings:z,boxParser:b,dashConstants:o.Z,urlUtils:R})}catch(e){throw e}}(),t}Vt.__dashjs_factory_name="Stream";var Ht=c.Z.getClassFactory(Vt),Kt=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t||null,this.type=C.w.CONTENT_STEERING_TYPE,this.responseType="json"},zt=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.version=null,this.ttl=300,this.reloadUri=null,this.pathwayPriority=[],this.pathwayClones=[]};function Zt(){var e,t,n,i,r,a,s,l,u,c,h,p,g,m,v,y=this.context,_=(0,X.Z)(y).getInstance();function b(e){A(e,"baseUrl")}function E(e){A(e,"location")}function T(e){if(e&&e.request&&e.request.serviceLocation&&e.request.requestStartDate&&e.request.requestEndDate&&!isNaN(e.request.bytesTotal)){var t=e.request.serviceLocation,n=e.request.requestEndDate.getTime()-e.request.requestStartDate.getTime();w(t,parseInt(8*e.request.bytesTotal/n*1e3))}}function S(e){e&&e.httpRequest&&e.httpRequest._serviceLocation&&!isNaN(e.throughput)&&w(e.httpRequest._serviceLocation,1e3*e.throughput)}function w(e,t){r[e]||(r[e]=[]),r[e].push(t),r[e].length>4&&r[e].shift()}function A(e,t){if(e&&e.request&&e.request.serviceLocation){var n=e.request.serviceLocation;-1===i[t].all.indexOf(n)&&i[t].all.push(n),i[t].current=n}}function I(){var e=h.getValue(),t=v.getContentSteering(e);return t||(t=g.getServiceDescriptionSettings().contentSteering),t}function R(){return new Promise(function(e){try{var a=I();if(!a||!a.serverUrl)return void e();var l=function(e){var t=e.serverUrl;n&&n.reloadUri&&(t=_.isRelative(n.reloadUri)?_.resolve(n.reloadUri,e.serverUrl):n.reloadUri);var a=[],o=i.baseUrl.all.concat(i.location.all);if(o.length>0){var s=o.map(function(e){var t=function(e){if(!e||!r[e]||0===r[e].length)return-1;var t=r[e].reduce(function(e,t){return e+t})/r[e].length;return parseInt(t)}(e);return{serviceLocation:e,throughput:t}});s.sort(function(e,t){return t.throughput-e.throughput});var l="",u="";s.forEach(function(e,t){0!==t&&(l="".concat(l,","),e.throughput>-1&&(u="".concat(u,","))),l="".concat(l).concat(e.serviceLocation),e.throughput>-1&&(u="".concat(u).concat(e.throughput))}),a.push({key:"_DASH_pathway",value:'"'.concat(l,'"')}),a.push({key:"_DASH_throughput",value:u})}return He.Z.addAditionalQueryParameterToUrl(t,a)}(a),u=new Kt(l);s.load({request:u,success:function(t){!function(e){e&&e[o.Z.CONTENT_STEERING_RESPONSE.VERSION]&&1===parseInt(e[o.Z.CONTENT_STEERING_RESPONSE.VERSION])&&((n=new zt).version=e[o.Z.CONTENT_STEERING_RESPONSE.VERSION],e[o.Z.CONTENT_STEERING_RESPONSE.TTL]&&!isNaN(e[o.Z.CONTENT_STEERING_RESPONSE.TTL])&&(n.ttl=e[o.Z.CONTENT_STEERING_RESPONSE.TTL]),e[o.Z.CONTENT_STEERING_RESPONSE.RELOAD_URI]&&(n.reloadUri=e[o.Z.CONTENT_STEERING_RESPONSE.RELOAD_URI]),e[o.Z.CONTENT_STEERING_RESPONSE.PATHWAY_PRIORITY]&&(n.pathwayPriority=e[o.Z.CONTENT_STEERING_RESPONSE.PATHWAY_PRIORITY]),e[o.Z.CONTENT_STEERING_RESPONSE.PATHWAY_CLONES]&&(n.pathwayClones=e[o.Z.CONTENT_STEERING_RESPONSE.PATHWAY_CLONES],n.pathwayClones=n.pathwayClones.filter(function(e){return function(e){return e[o.Z.CONTENT_STEERING_RESPONSE.BASE_ID]&&e[o.Z.CONTENT_STEERING_RESPONSE.ID]&&e[o.Z.CONTENT_STEERING_RESPONSE.URI_REPLACEMENT]&&e[o.Z.CONTENT_STEERING_RESPONSE.URI_REPLACEMENT][o.Z.CONTENT_STEERING_RESPONSE.HOST]}(e)})),k())}(t),m.trigger(f.Z.CONTENT_STEERING_REQUEST_COMPLETED,{currentSteeringResponseData:n,url:l}),e()},error:function(i,r,a,o){!function(e,i){try{switch(t.warn("Error fetching data from content steering server",e),i.status){case 410:break;case 429:var r=i&&i.getResponseHeader?i.getResponseHeader("retry-after"):null;null!==r&&(n||(n={}),n.ttl=parseInt(r)),k();break;default:k()}}catch(e){t.error(e)}}(i,o),e(i)},complete:function(){i.baseUrl.all=C(i.baseUrl),i.location.all=C(i.location)}})}catch(t){e(t)}})}function C(e){return e.all&&0!==e.all.length&&e.current?e.all.filter(function(t){return t===e.current}):[]}function D(e){try{var i=[];return e&&0!==e.length&&n&&n.pathwayClones&&0!==n.pathwayClones.length?(n.pathwayClones.forEach(function(t){var n=e.filter(function(e){return t[o.Z.CONTENT_STEERING_RESPONSE.BASE_ID]===e.serviceLocation}),r=null;if(n&&n.length>0&&(r=n[0]),r){var a=new URL(r.url),s=t[o.Z.CONTENT_STEERING_RESPONSE.URI_REPLACEMENT][o.Z.CONTENT_STEERING_RESPONSE.HOST];s=He.Z.stringHasProtocol(s)?s:"".concat(a.protocol,"//").concat(s);var l={synthesizedUrl:"".concat(s).concat(a.pathname),serviceLocation:t[o.Z.CONTENT_STEERING_RESPONSE.ID],queryParams:t[o.Z.CONTENT_STEERING_RESPONSE.URI_REPLACEMENT][o.Z.CONTENT_STEERING_RESPONSE.PARAMS],reference:r};i.push(l)}}),i):i}catch(e){return t.error(e),[]}}function k(){n&&n.ttl&&!isNaN(n.ttl)&&(a&&clearTimeout(a),a=setTimeout(function(){R()},1e3*n.ttl))}function M(){a&&clearTimeout(a),a=null}function L(){n=null,r={},i={baseUrl:{current:null,all:[]},location:{current:null,all:[]}},M()}return e={reset:function(){L(),m.off(f.Z.FRAGMENT_LOADING_STARTED,b,e),m.off(f.Z.MANIFEST_LOADING_STARTED,E,e),m.off(f.Z.MANIFEST_LOADING_FINISHED,T,e),m.off(f.Z.THROUGHPUT_MEASUREMENT_STORED,S,e)},setConfig:function(e){e&&(e.adapter&&(v=e.adapter),e.errHandler&&(l=e.errHandler),e.dashMetrics&&(u=e.dashMetrics),e.mediaPlayerModel&&(c=e.mediaPlayerModel),e.requestModifier&&(p=e.requestModifier),e.manifestModel&&(h=e.manifestModel),e.serviceDescriptionController&&(g=e.serviceDescriptionController),e.eventBus&&(m=e.eventBus))},loadSteeringData:R,getCurrentSteeringResponseData:function(){return n},shouldQueryBeforeStart:function(){var e=I();return!!e&&e.queryBeforeStart},getSteeringDataFromManifest:I,stopSteeringRequestTimer:M,getSynthesizedBaseUrlElements:function(e){try{return D(e).map(function(e){var t=new Te(e.synthesizedUrl,e.serviceLocation);return t.queryParams=e.queryParams,t.dvbPriority=e.reference.dvbPriority,t.dvbWeight=e.reference.dvbWeight,t.availabilityTimeOffset=e.reference.availabilityTimeOffset,t.availabilityTimeComplete=e.reference.availabilityTimeComplete,t})}catch(e){return t.error(e),[]}},getSynthesizedLocationElements:function(e){try{return D(e).map(function(e){var t=new Le(e.synthesizedUrl,e.serviceLocation);return t.queryParams=e.queryParams,t})}catch(e){return t.error(e),[]}},initialize:function(){s=Tt(y).create({errHandler:l,dashMetrics:u,mediaPlayerModel:c,requestModifier:p,errors:x}),m.on(f.Z.FRAGMENT_LOADING_STARTED,b,e),m.on(f.Z.MANIFEST_LOADING_STARTED,E,e),m.on(f.Z.MANIFEST_LOADING_FINISHED,T,e),m.on(f.Z.THROUGHPUT_MEASUREMENT_STORED,S,e)}},t=(0,d.Z)(y).getInstance().getLogger(e),L(),e}Zt.__dashjs_factory_name="ContentSteeringController";var qt=c.Z.getSingletonFactory(Zt);function Yt(){var e,t,n,i=this.context,r=(0,R.Z)(i).getInstance();return e={select:function(e){if(!e||0===e.length)return null;var i=null;return r.get().streaming.applyContentSteering&&(i=function(e){var i=n.getCurrentSteeringResponseData();return i&&i.pathwayPriority&&i.pathwayPriority.length>0?function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=0,r=null,a=function(){var a=e[i],o=n.findIndex(function(e){return e.serviceLocation&&e.serviceLocation===a});if(-1!==o&&!t.contains(n[o].serviceLocation))return r=n[o],"break";i+=1};i<e.length&&"break"!==a(););return r}(i.pathwayPriority,e):null}(e)),i||(i=function(e){return e[0]}(e)),i},setConfig:function(e){e.blacklistController&&(t=e.blacklistController),e.contentSteeringController&&(n=e.contentSteeringController)},reset:function(){t.reset()}},t=Gt(i).create({updateEventName:u.Z.SERVICE_LOCATION_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:u.Z.SERVICE_LOCATION_LOCATION_BLACKLIST_ADD}),n=qt(i).getInstance(),e}Yt.__dashjs_factory_name="LocationSelector";var Wt=c.Z.getClassFactory(Yt);function $t(){var e,t,n,i,r,a,s,c,h,p,g,m,v,y,_=this.context,b=(0,l.Z)(_).getInstance(),E=(0,X.Z)(_).getInstance();function T(){n=NaN,s=!1,r=!0,a=!1,S()}function S(){null!==i&&(clearTimeout(i),i=null)}function w(e){S(),a||(isNaN(e)&&!isNaN(n)&&(e=1e3*n),isNaN(e)||(t.debug("Refresh manifest in "+e+" milliseconds."),i=setTimeout(C,e)))}function A(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];s=!0;var t=h.getValue(),n=t.url,i=null,r=g.getPatchLocation(t),a=p.select(r),o=null;if(a&&!e)n=a.url,i=a.serviceLocation,o=a.queryParams;else{var l=I(t),u=p.select(l);u&&(n=u.url,i=u.serviceLocation,o=u.queryParams)}E.isRelative(n)&&(n=E.resolve(n,t.url)),c.load(n,i,o)}function I(e){var t=g.getLocation(e),n=v.getSynthesizedLocationElements(t);return t.concat(n)}function R(e){if(e){if(g.getIsPatch(e)){var i=e;e=h.getValue();var l=g.isPatchValid(e,i),c=l;if(l){var d=g.getPublishTime(e);c=g.applyPatchToManifest(e,i);var f=g.getPublishTime(e);c=d.getTime()!=f.getTime()}if(!c)return t.debug("Patch provided is invalid, performing full manifest refresh"),void A(!0);e.loadedTime=new Date}}else(e=h.getValue()).loadedTime=new Date;if(h.getValue()&&h.getValue().type===o.Z.DYNAMIC&&e.type===o.Z.STATIC)return b.trigger(u.Z.DYNAMIC_TO_STATIC),s=!1,void(a=!0);h.setValue(e);var p=new Date,m=(p.getTime()-e.loadedTime.getTime())/1e3;1e3*(n=g.getManifestUpdatePeriod(e,m))>2147483647&&(n=2147483.647),b.trigger(u.Z.MANIFEST_UPDATED,{manifest:e}),t.info("Manifest has been refreshed at "+p+"["+p.getTime()/1e3+"] "),r||w()}function C(){r||(s?w(y.get().streaming.manifestUpdateRetryInterval):A())}function D(e){e.error?e.error.code===x.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE&&m.error(e.error):R(e.manifest)}function k(){r=!1,w()}function M(){(r=!y.get().streaming.scheduling.scheduleWhilePaused)&&S()}function L(){s=!1}return e={initialize:function(){T(),b.on(u.Z.STREAMS_COMPOSED,L,this),b.on(f.Z.PLAYBACK_STARTED,k,this),b.on(f.Z.PLAYBACK_PAUSED,M,this),b.on(u.Z.INTERNAL_MANIFEST_LOADED,D,this)},setManifest:function(e){R(e)},refreshManifest:A,getIsUpdating:function(){return s},setConfig:function(e){e&&(e.manifestModel&&(h=e.manifestModel),e.adapter&&(g=e.adapter),e.manifestLoader&&(c=e.manifestLoader),e.errHandler&&(m=e.errHandler),e.locationSelector&&(p=e.locationSelector),e.settings&&(y=e.settings),e.contentSteeringController&&(v=e.contentSteeringController))},reset:function(){b.off(f.Z.PLAYBACK_STARTED,k,this),b.off(f.Z.PLAYBACK_PAUSED,M,this),b.off(u.Z.STREAMS_COMPOSED,L,this),b.off(u.Z.INTERNAL_MANIFEST_LOADED,D,this),T()}},t=(0,d.Z)(_).getInstance().getLogger(e),p=Wt(_).create(),e}$t.__dashjs_factory_name="ManifestUpdater";var Xt=c.Z.getClassFactory($t);function Qt(){var e,t,n,i,r,a,o,s,c,f,h,p,g,m,v,y,_=this.context,b=(0,l.Z)(_).getInstance(),E=(0,X.Z)(_).getInstance();function S(){s=[],c=[],f=null,h=null,g=null,p=NaN,n=!1,i=!1,m=r.get().streaming.utcSynchronization.timeBetweenSyncAttempts}function w(){r.get().streaming.utcSynchronization.enabled&&!n&&!i&&g&&g.value&&g.schemeIdUri&&!isNaN(p)&&!isNaN(r.get().streaming.utcSynchronization.backgroundAttempts)&&(h&&(Date.now()-h)/1e3<30||(s=[],i=!0,A(isNaN(r.get().streaming.utcSynchronization.backgroundAttempts)?2:r.get().streaming.utcSynchronization.backgroundAttempts)))}function A(e){try{if(e<=0)return void G();var t=Date.now();a[g.schemeIdUri](g.value,function(n){var i=Date.now(),r=R(t,i,n);s.push(r),A(e-1)},function(){G()})}catch(e){G()}}function I(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=e||0;if(!c||0===c.length||t>=c.length)D();else{var n=c[t];if(n)if(a.hasOwnProperty(n.schemeIdUri)){var i=(new Date).getTime();a[n.schemeIdUri](n.value,function(e){var t=(new Date).getTime(),r=R(i,t,e);g=n,D(r)},function(){I(t+1)})}else I(t+1);else D()}}function R(e,t,n){return n-(t-(t-e)/2)}function D(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:NaN,t=isNaN(e);t&&r.get().streaming.utcSynchronization.useManifestDateHeaderTimeSource?U():B(t,e)}function k(e){var t=Date.parse(e);return isNaN(t)&&(t=function(e){var t,n,i=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/.exec(e);return t=Date.UTC(parseInt(i[1],10),parseInt(i[2],10)-1,parseInt(i[3],10),parseInt(i[4],10),parseInt(i[5],10),i[6]&&(parseInt(i[6],10)||0),i[7]&&1e3*parseFloat(i[7])||0),i[9]&&i[10]&&(n=60*parseInt(i[9],10)+parseInt(i[10],10),t+=("+"===i[8]?-1:1)*n*60*1e3),new Date(t).getTime()}(e)),t}function M(e){return Date.parse(e)}function L(e){return Date.parse(e)}function P(e,t,n){n()}function N(e,t,n){var i=k(e);isNaN(i)?n():t(i)}function O(e,t,n,i,r){var a,o,s=!1,l=new XMLHttpRequest,u=r?C.w.HEAD:C.w.GET,c=t.match(/\S+/g);if(t=c.shift(),a=function(){s||(s=!0,c.length?O(e,c.join(" "),n,i,r):i())},o=function(){var t,i;200===l.status&&(t=r?l.getResponseHeader("Date"):l.response,i=e(t),isNaN(i)||(n(i),s=!0))},E.isRelative(t)){var d=y.resolve();d&&(t=E.resolve(t,d.url))}l.open(u,t),l.timeout=5e3,l.onload=o,l.onloadend=a,l.send()}function F(e,t,n){O(L,e,t,n,!0)}function U(){var e=o.getLatestMPDRequestHeaderValueByID("Date"),t=null!==e?new Date(e).getTime():Number.NaN;isNaN(t)?B(!0):B(!1,t-Date.now())}function B(e,i){if(isNaN(p)||isNaN(i)||e||function(e){try{var n,i=j(e),a=isNaN(m)?30:m,o=isNaN(r.get().streaming.utcSynchronization.timeBetweenSyncAttemptsAdjustmentFactor)?2:r.get().streaming.utcSynchronization.timeBetweenSyncAttemptsAdjustmentFactor,s=isNaN(r.get().streaming.utcSynchronization.maximumTimeBetweenSyncAttempts)?600:r.get().streaming.utcSynchronization.maximumTimeBetweenSyncAttempts,l=isNaN(r.get().streaming.utcSynchronization.minimumTimeBetweenSyncAttempts)?2:r.get().streaming.utcSynchronization.minimumTimeBetweenSyncAttempts;i?(n=Math.min(a*o,s),t.debug("Increasing timeBetweenSyncAttempts to ".concat(n))):(n=Math.max(a/o,l),t.debug("Decreasing timeBetweenSyncAttempts to ".concat(n))),m=n}catch(e){}}(i),!e&&!isNaN(i)){f=Date.now(),n=!1;var a=isNaN(p);p=i,a&&w(),t.debug("Completed UTC sync. Setting client - server offset to ".concat(i))}e&&(g=null,n=!1,v.error(new T.Z(x.TIME_SYNC_FAILED_ERROR_CODE,x.TIME_SYNC_FAILED_ERROR_MESSAGE))),b.trigger(u.Z.UPDATE_TIME_SYNC_OFFSET,{offset:i}),b.trigger(u.Z.TIME_SYNCHRONIZATION_COMPLETED)}function G(){if(s&&0!==s.length){var e=s.reduce(function(e,t){return e+t},0)/s.length;j(e)?t.debug("Completed background UTC sync. Offset is within allowed threshold and is not adjusted."):(t.debug("Completed background UTC sync. Setting client - server offset to ".concat(e)),p=e,b.trigger(u.Z.UPDATE_TIME_SYNC_OFFSET,{offset:p})),i=!1,h=Date.now()}}function j(e){try{if(isNaN(p))return!0;var t=r.get().streaming.utcSynchronization.maximumAllowedDrift&&!isNaN(r.get().streaming.utcSynchronization.maximumAllowedDrift)?r.get().streaming.utcSynchronization.maximumAllowedDrift:100;return e>=p-t&&e<=p+t}catch(e){return!0}}return e={initialize:function(){S(),a={"urn:mpeg:dash:utc:http-head:2014":F,"urn:mpeg:dash:utc:http-xsdate:2014":O.bind(null,k),"urn:mpeg:dash:utc:http-iso:2014":O.bind(null,M),"urn:mpeg:dash:utc:direct:2014":N,"urn:mpeg:dash:utc:http-head:2012":F,"urn:mpeg:dash:utc:http-xsdate:2012":O.bind(null,k),"urn:mpeg:dash:utc:http-iso:2012":O.bind(null,M),"urn:mpeg:dash:utc:direct:2012":N,"urn:mpeg:dash:utc:http-ntp:2014":P,"urn:mpeg:dash:utc:ntp:2014":P,"urn:mpeg:dash:utc:sntp:2014":P}},attemptSync:function(e,t){c=e,n||(function(e){try{if(!e||!r.get().streaming.utcSynchronization.enabled)return!1;var t=isNaN(m)?30:m;return!(f&&t&&!isNaN(t))||(Date.now()-f)/1e3>=t}catch(e){return!0}}(t)?(n=!0,I()):b.trigger(u.Z.TIME_SYNCHRONIZATION_COMPLETED))},setConfig:function(e){e&&(e.dashMetrics&&(o=e.dashMetrics),e.baseURLController&&(y=e.baseURLController),e.errHandler&&(v=e.errHandler),e.settings&&(r=e.settings))},reset:function(){S(),b.off(u.Z.ATTEMPT_BACKGROUND_SYNC,w,e)}},t=(0,d.Z)(_).getInstance().getLogger(e),b.on(u.Z.ATTEMPT_BACKGROUND_SYNC,w,e),e}Qt.__dashjs_factory_name="TimeSyncController";var Jt=c.Z.getSingletonFactory(Qt);Jt.HTTP_TIMEOUT_MS=5e3,c.Z.updateSingletonFactory(Qt.__dashjs_factory_name,Jt);var en=Jt;function tn(){var e,t,n,i,r,a=this.context,o=(0,l.Z)(a).getInstance();return e={attachMediaSource:function(e){var n=window.URL.createObjectURL(t);return e.setSource(n),"managedMediaSource"===i&&(e.setDisableRemotePlayback(!0),t.addEventListener("startstreaming",function(){o.trigger(f.Z.MANAGED_MEDIA_SOURCE_START_STREAMING)}),t.addEventListener("endstreaming",function(){o.trigger(f.Z.MANAGED_MEDIA_SOURCE_END_STREAMING)})),n},createMediaSource:function(){var e="WebKitMediaSource"in window,n="MediaSource"in window;return"ManagedMediaSource"in window?(t=new ManagedMediaSource,i="managedMediaSource",r.info("Created ManagedMediaSource")):n?(t=new MediaSource,i="mediaSource",r.info("Created MediaSource")):e&&(t=new WebKitMediaSource,r.info("Created WebkitMediaSource")),t},detachMediaSource:function(e){e.setSource(null)},setConfig:function(e){e&&e.settings&&(n=e.settings)},setDuration:function e(i){t&&"open"===t.readyState&&(null===i&&isNaN(i)||t.duration!==i&&(i!==1/0||n.get().streaming.buffer.mediaSourceDurationInfinity||(i=Math.pow(2,32)),function(e){for(var t=e.sourceBuffers,n=0;n<t.length;n++)if(t[n].updating)return!0;return!1}(t)?setTimeout(e.bind(null,i),50):(r.info("Set MediaSource duration:"+i),t.duration=i)))},setSeekable:function(e,n){t&&"function"==typeof t.setLiveSeekableRange&&"function"==typeof t.clearLiveSeekableRange&&"open"===t.readyState&&e>=0&&e<n&&(t.clearLiveSeekableRange(),t.setLiveSeekableRange(e,n))},signalEndOfStream:function(e){if(e&&"open"===e.readyState){for(var t=e.sourceBuffers,n=0;n<t.length;n++){if(t[n].updating)return;if(0===t[n].buffered.length)return}r.info("call to mediaSource endOfStream"),e.endOfStream()}}},r=(0,d.Z)(a).getInstance().getLogger(e),e}tn.__dashjs_factory_name="MediaSourceController";var nn=c.Z.getSingletonFactory(tn);function rn(){var e,t,n,i,r,a,o,s,u,c,h,p="urn:mpeg:dash:event:2012",g="discarded",m="updated",v="added",y=this.context,_=(0,l.Z)(y).getInstance();function b(){if(!o||!s)throw new Error("setConfig function has to be called previously")}function E(){h=!1,n={},i={},r=null,c=!1,a=Date.now()/1e3}function T(){try{if(!c){c=!0;var e=s.getTime(),r=e-a;r=a>0?Math.max(0,r):0,S(i,r,e),S(n,r,e),w(i),w(n),a=e,c=!1}}catch(e){c=!1,t.error(e)}}function S(e,n,i){try{R(e,function(r){if(void 0!==r){var a=isNaN(r.duration)?0:r.duration;r.calculatedPresentationTime<=i&&r.calculatedPresentationTime+n+a>=i?D(r,f.Z.EVENT_MODE_ON_START):(C(i,a+n,r.calculatedPresentationTime)||function(e){try{var n=e.eventStream.period.start+e.eventStream.period.duration;return e.calculatedPresentationTime>n}catch(e){return t.error(e),!1}}(r))&&(t.debug("Removing event ".concat(r.id," from period ").concat(r.eventStream.period.id," as it is expired or invalid")),function(e,n){try{var i=n.eventStream.schemeIdUri,r=n.eventStream.period.id,a=n.eventStream.value,o=n.id;e[r][i]=e[r][i].filter(function(e){return a&&e.eventStream.value&&e.eventStream.value!==a||e.id!==o}),0===e[r][i].length&&delete e[r][i]}catch(e){t.error(e)}}(e,r))}})}catch(e){t.error(e)}}function w(e){try{for(var n in e)e.hasOwnProperty(n)&&0===Object.keys(e[n]).length&&delete e[n]}catch(e){t.error(e)}}function A(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.eventStream.schemeIdUri,r=e.eventStream.value,a=e.id,o=g;t[i]||(t[i]=[]);var s=t[i].findIndex(function(e){return(!r||e.eventStream.value&&e.eventStream.value===r)&&e.id===a});if(-1===s)t[i].push(e),e.triggeredReceivedEvent=!1,e.triggeredStartEvent=!1,o=v;else if(n){var l=t[i][s];e.triggeredReceivedEvent=l.triggeredReceivedEvent,e.triggeredStartEvent=l.triggeredStartEvent,t[i][s]=e,o=m}return o}function I(e){try{if(1==e.eventStream.value){var n,i=e.calculatedPresentationTime;n=4294967295==e.calculatedPresentationTime?NaN:e.calculatedPresentationTime+e.duration,_.trigger(f.Z.MANIFEST_VALIDITY_CHANGED,{id:e.id,validUntil:i,newDuration:n,newManifestValidAfter:NaN},{mode:f.Z.EVENT_MODE_ON_START})}}catch(e){t.error(e)}}function x(e){try{var n=s.getTime();R(e,function(e){var t=e.eventStream&&e.eventStream.period&&!isNaN(e.eventStream.period.duration)?e.eventStream.period.duration:NaN,i=e.eventStream&&e.eventStream.period&&!isNaN(e.eventStream.period.start)?e.eventStream.period.start:NaN;if(!isNaN(t)&&!isNaN(i)){var r=e.calculatedPresentationTime;Math.abs(r-n)<300&&D(e,f.Z.EVENT_MODE_ON_START)}})}catch(e){t.error(e)}}function R(e,n){try{if(e)for(var i=Object.keys(e),r=0;r<i.length;r++)for(var a=e[i[r]],o=Object.keys(a),s=0;s<o.length;s++)a[o[s]].forEach(function(e){void 0!==e&&n(e)})}catch(e){t.error(e)}}function C(e,n,i){try{return e-n>i}catch(e){return t.error(e),!1}}function D(e,n){try{var i=s.getTime(),r=e.id;if(n===f.Z.EVENT_MODE_ON_RECEIVE&&!e.triggeredReceivedEvent)return t.debug("Received event ".concat(r)),e.triggeredReceivedEvent=!0,void _.trigger(e.eventStream.schemeIdUri,{event:e},{mode:n});e.triggeredStartEvent||(e.eventStream.schemeIdUri===p&&1==e.eventStream.value?0===e.duration&&0===e.presentationTimeDelta||(t.debug("Starting manifest refresh event ".concat(r," at ").concat(i)),function(){try{b(),o.refreshManifest()}catch(e){t.error(e)}}()):"urn:mpeg:dash:event:callback:2015"===e.eventStream.schemeIdUri&&1==e.eventStream.value?(t.debug("Starting callback event ".concat(r," at ").concat(i)),function(e){try{(0,se.Z)(y).create({}).load({method:"get",url:e,request:{responseType:"arraybuffer"}})}catch(e){t.error(e)}}(e.messageData)):(t.debug("Starting event ".concat(r," from period ").concat(e.eventStream.period.id," at ").concat(i)),_.trigger(e.eventStream.schemeIdUri,{event:e},{mode:n})),e.triggeredStartEvent=!0)}catch(e){t.error(e)}}return e={addInlineEvents:function(e,i){try{if(b(),n[i]||(n[i]={}),e)for(var r=0;r<e.length;r++){var a=e[r];if(!C(s.getTime(),isNaN(a.duration)?0:a.duration,a.calculatedPresentationTime)){var o=A(a,n[i],!0);o===v?(t.debug("Added inline event with id ".concat(a.id," from period ").concat(i)),D(a,f.Z.EVENT_MODE_ON_RECEIVE)):o===m&&t.debug("Updated inline event with id ".concat(a.id," from period ").concat(i))}}}catch(e){throw e}},addInbandEvents:function(e,n){try{b(),i[n]||(i[n]={});for(var r=0;r<e.length;r++){var a=e[r];C(s.getTime(),isNaN(a.duration)?0:a.duration,a.calculatedPresentationTime)||(A(a,i[n],!1)===v?(a.eventStream.schemeIdUri===p&&I(a),t.debug("Added inband event with id ".concat(a.id," from period ").concat(n)),D(a,f.Z.EVENT_MODE_ON_RECEIVE)):t.debug("Inband event with scheme_id_uri ".concat(a.eventStream.schemeIdUri,", value ").concat(a.eventStream.value,", period id ").concat(n," and event id ").concat(a.id," was ignored because it has been added before.")))}T()}catch(e){throw e}},getInbandEvents:function(){return i},getInlineEvents:function(){return n},start:function(){try{b(),t.debug("Start Event Controller");var e=u.get().streaming.eventControllerRefreshDelay;h||isNaN(e)||(h=!0,r=setInterval(T,e))}catch(e){throw e}},setConfig:function(e){try{if(!e)return;e.manifestUpdater&&(o=e.manifestUpdater),e.playbackController&&(s=e.playbackController),e.settings&&(u=e.settings)}catch(e){throw e}},reset:function(){(function(){try{null!==r&&h&&(clearInterval(r),r=null,h=!1,function(){try{x(i),x(n)}catch(e){t.error(e)}}())}catch(e){throw e}})(),E()}},t=(0,d.Z)(y).getInstance().getLogger(e),E(),e}rn.__dashjs_factory_name="EventController";var an=c.Z.getSingletonFactory(rn),on={LEVELS:{SUGGESTION:"Suggestion",WARNING:"Warning",ERROR:"Error"},EVENTS:{NO_UTC_TIMING_ELEMENT:{key:"NO_UTC_TIMING_ELEMENT",message:"No UTCTiming element is present in the manifest. You may experience playback failures. For a detailed validation use https://conformance.dashif.org/"},NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE:{key:"NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE",message:'SMPTE 2052-1:2013 defines the attribute name as "imageType" and does not define "imagetype"'},INVALID_DVR_WINDOW:{key:"INVALID_DVR_WINDOW",message:"No valid segment found when applying a specification compliant DVR window calculation. Using SegmentTimeline entries as a fallback."}}};function sn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function ln(){var e,t,n,i,r,o,c,h,p,g,m,v,y,_,b,E,S,w,A,I,R,C,D,k,M,L,P,O,F,U,B,G,j,V,H,K,z,Z,q,Y,W,$,X,Q,te,ne,ie,re,ae=this.context,oe=(0,l.Z)(ae).getInstance();function se(){if(!(o&&o.hasOwnProperty("load")&&R&&R.hasOwnProperty("initialize")&&R.hasOwnProperty("reset")&&R.hasOwnProperty("getClientTimeOffset")&&c&&I&&p&&j))throw new Error(a.Z.MISSING_CONFIG_ERROR)}function le(){if(!r||!r.hasOwnProperty("setManifest"))throw new Error("initialize function has to be called previously")}function ue(){!function(){try{var e=h.getStreamsInfo();if(!D&&0===e.length)throw new Error("There are no periods in the MPD");D&&e.length>0&&p.updateManifestUpdateInfo({currentTime:j.getTime(),buffered:G.getBufferRange(),presentationStartTime:e[0].start,clientTimeOffset:R.getClientTimeOffset()}),C.length>0&&function(e){0!==e.length?C=C.filter(function(n){var i=e.filter(function(e){return e.id===n.getId()}).length>0||n.getId()===D.getId();return i||(t.debug("Removing stream ".concat(n.getId())),n.reset(!0)),i}):t.warn("No periods included in the current manifest. Skipping the filtering of outdated stream objects.")}(e);for(var n=[],i=0,r=e.length;i<r;i++){var a=e[i];n.push(de(a)),p.addManifestUpdateStreamInfo(a)}Promise.all(n).then(function(){return new Promise(function(t,n){D?t():fe(e,t,n)})}).then(function(){oe.trigger(u.Z.STREAMS_COMPOSED),Me()}).catch(function(e){throw e})}catch(e){I.error(new T.Z(x.MANIFEST_ERROR_ID_NOSTREAMS_CODE,e.message+" nostreamscomposed",c.getValue())),U=!0,Xe()}}()}function ce(){te=!0}function de(e){var t=Ye(e.id);return t?t.updateData(e):(t=Ht(ae).create({manifestModel:c,mediaPlayerModel:H,dashMetrics:p,manifestUpdater:r,adapter:h,timelineConverter:R,capabilities:n,capabilitiesFilter:i,errHandler:I,baseURLController:y,segmentBaseController:_,textController:M,abrController:E,playbackController:j,eventController:w,mediaController:S,protectionController:k,videoModel:G,streamInfo:e,settings:Q}),C.push(t),t.initialize(),Promise.resolve())}function fe(e,n,i){try{we();var r=p.getCurrentDVRInfo().range;if(r.end<r.start){ne&&clearTimeout(ne);var a=Math.min(1e3*(-1*(r.end-r.start)+2),2147483647);return t.debug("Waiting for ".concat(a," ms before playback can start")),oe.trigger(u.Z.AST_IN_FUTURE,{delay:a}),void(ne=setTimeout(function(){fe(e,n,i)},a))}Q.get().streaming.applyProducerReferenceTime&&V.calculateProducerReferenceTimeOffsets(e);var o=e[0].manifestInfo;if(Q.get().streaming.applyServiceDescription&&V.applyServiceDescription(o),h.getIsDynamic()){var s=Ge(e,o);j.computeAndSetLiveDelay(s,o)}(Q.get().streaming.applyContentSteering&&v.shouldQueryBeforeStart()?v.loadSteeringData():Promise.resolve()).then(function(){var e=c.getValue();e&&y.update(e),he(),n()}).catch(function(e){t.error(e),he(),n()})}catch(e){i(e)}}function he(){var e=function(){var e;if(h.getIsDynamic()){var n=p.getCurrentDVRInfo();e=(n&&n.range?n.range.end:0)-j.getOriginalLiveDelay();var i=n?n.range:null;if(i){if(isNaN(ie)&&-1===ie.toString().indexOf("posix:")){var r=Fe(!0);isNaN(r)||(t.info("Start time from URI parameters: ".concat(r)),e=Math.min(e,r))}else{t.info("Start time provided by the app: ".concat(ie));var a=Ue(!0,ie);isNaN(a)||(e=Math.min(e,a))}var o=Q.get().streaming.timeShiftBuffer.calcFromSegmentTimeline?.1:0;e=Math.max(e,i.start+o)}}else if(e=Je()[0].getStreamInfo().start,isNaN(ie)){var s=Fe(!1);isNaN(s)||(t.info("Start time from URI parameters: ".concat(s)),e=Math.max(e,s))}else{t.info("Start time provided by the app: ".concat(ie));var l=Ue(!1,ie);isNaN(l)||(e=Math.max(e,l))}return e}(),n=Se(e),i=null!==n?n:C[0];oe.trigger(u.Z.INITIAL_STREAM_SWITCH,{startTime:e}),pe(i,null,e),Y||(Y=setInterval(function(){!O&&j.getTimeToStreamEnd()<=0&&!j.isSeeking()&&oe.trigger(u.Z.PLAYBACK_ENDED,{isLast:qe().isLast})},200))}function pe(e,n,i){try{if(O||!e||n===e&&e.getIsActive())return;O=!0,oe.trigger(u.Z.PERIOD_SWITCH_STARTED,{fromStreamInfo:n?n.getStreamInfo():null,toStreamInfo:e.getStreamInfo()});var r=!1;D=e,n&&(r=Ee(e,n),n.deactivate(r)),i=isNaN(i)?!r&&n?e.getStreamInfo().start:NaN:i,t.info("Switch to stream ".concat(e.getId(),". Seektime is ").concat(i,", current playback time is ").concat(j.getTime(),". Seamless period switch is set to ").concat(r)),$=$.filter(function(e){return e.getId()!==D.getId()}),j.initialize(qe(),!!n),G.getElement()?ge(i,r,!1):me(i,r)}catch(e){O=!1}}function ge(e,n){var i,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];function a(){if(B&&"open"===B.readyState){t.debug("MediaSource is open!"),window.URL.revokeObjectURL(i),B.removeEventListener("sourceopen",a),B.removeEventListener("webkitsourceopen",a),Oe();var o=p.getCurrentDVRInfo();g.setSeekable(o.range.start,o.range.end),r?(isNaN(e)||j.seek(e,!0,!0),D.setMediaSource(B).then(function(){D.initializeForTextWithMediaSource(B)})):me(e,n)}}function o(){B.addEventListener("sourceopen",a,!1),B.addEventListener("webkitsourceopen",a,!1),i=g.attachMediaSource(G),t.debug("MediaSource attached to element.  Waiting on open...")}B?n?me(e,n):(g.detachMediaSource(G),o()):(B=g.createMediaSource(),o())}function me(e,t){D.activate(B,t?W:void 0,e).then(function(t){if(t){var n=Object.keys(t);n.length>0&&t[n[0]].getBuffer().changeType&&(X=!0),W=t}isNaN(e)||(oe.trigger(u.Z.SEEK_TARGET,{time:e},{streamId:D.getId()}),j.seek(e,!1,!0),D.startScheduleControllers()),O=!1,oe.trigger(u.Z.PERIOD_SWITCH_COMPLETED,{toStreamInfo:qe()})})}function ve(e){var t=Se(e.seekTime);t&&t!==D?t&&t!==D&&(ye(),function(e,t){var n=e&&!isNaN(e.seekTime)?e.seekTime:NaN,i=D.getProcessors().map(function(t){return t.prepareOuterPeriodPlaybackSeeking(e)});Promise.all(i).then(function(){pe(t,D,n)}).catch(function(e){I.error(e)})}(e,t)):(ye(),function(e){D.getProcessors().forEach(function(t){return t.prepareInnerPeriodPlaybackSeeking(e)}),Ke(ee.USER_REQUEST_STOP_REASON)}(e)),ze(J.SEEK_START_REASON)}function ye(){_e()}function _e(){$&&$.length>0&&($.forEach(function(e){e.deactivate(!0)}),$=[])}function be(e){if(e.newMediaInfo.streamInfo.id===D.getId()){if(_e(),Q.get().streaming.buffer.resetSourceBuffersForTrackSwitch&&e.oldMediaInfo&&e.oldMediaInfo.codec!==e.newMediaInfo.codec){var t=j.getTime();return D.deactivate(!1),void ge(t,!1,!1)}D.prepareTrackChange(e)}}function Ee(e,t){try{return Q.get().streaming.buffer.reuseExistingSourceBuffers&&(t.isProtectionCompatible(e)||te)&&(X&&Q.get().streaming.buffer.useChangeTypeForTrackSwitch||t.isMediaCodecCompatible(e,t))}catch(e){return!1}}function Te(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(B&&!e.getPreloaded()){var n=Ee(e,t);n&&e.startPreloading(B,W).then(function(){$.push(e)})}}function Se(e){if(isNaN(e))return null;for(var t=C.length,n=0;n<t;n++){var i=C[n];if(e<parseFloat((i.getStartTime()+i.getDuration()).toFixed(5)))return i}return null}function we(){try{var e=h.getIsDynamic(),t=h.getStreamsInfo()[0].manifestInfo,n=j.getTime(),i=R.calcTimeShiftBufferWindow(C,e),r=Pe();if(void 0===i.start||void 0===i.end)return;r&&0!==r.length?r.forEach(function(e){p.addDVRInfo(e.getType(),n,t,i)}):p.addDVRInfo(a.Z.VIDEO,n,t,i)}catch(e){}}function Ae(e){if(Z&&P){var t=H.getInitialBufferLevel(),n=[a.Z.TEXT];(isNaN(t)||t<=j.getBufferLevel(n)||h.getIsDynamic()&&t>j.getLiveDelay())&&(Z=!1,ze(J.INITIAL_PLAYOUT_START_REASON),j.play())}e&&e.mediaType&&p.addBufferLevel(e.mediaType,new Date,1e3*e.bufferLevel)}function Ie(e){e.streamInfo.id===D.getId()&&e.reason&&e.reason.forceReplace&&_e(),Ye(e.streamInfo.id).prepareQualityChange(e)}function xe(){if(h.getIsDynamic()&&0!==j.getOriginalLiveDelay()&&D){var e=h.getStreamsInfo();if(e.length>0){var t=e[0].manifestInfo,n=Ge(e,t);j.computeAndSetLiveDelay(n,t)}}}function Re(){if(Ve()){var e=G.getPlaybackQuality();e&&p.addDroppedFrames(e)}}function Ce(){t.debug("[onPlaybackStarted]"),!Z&&z&&ze(J.RESUME_FROM_PAUSE_START_REASON),Z&&(Z=!1),q&&(q=!1,Q.get().streaming.applyContentSteering&&!v.shouldQueryBeforeStart()&&v.loadSteeringData()),z=!1}function De(e){t.debug("[onPlaybackPaused]"),e.ended||(z=!0,Ke(ee.USER_REQUEST_STOP_REASON))}function ke(e){t.debug("Stream with id ".concat(e.streamInfo.id," finished buffering"));var n=e.streamInfo.isLast;B&&n?(t.info("[onStreamBufferingCompleted] calls signalEndOfStream of mediaSourceController."),g.signalEndOfStream(B)):Me()}function Me(){if(D&&D.getHasFinishedBuffering())for(var e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{var t=e||D||null;if(t){var n=t.getStreamInfo();return C.filter(function(e){var t=e.getStreamInfo();return t.start>n.start&&n.id!==t.id})}}catch(e){return[]}}(D),t=0;t<e.length;){var n=e[t],i=0===t?D:e[t-1];!n.getPreloaded()&&i.getHasFinishedBuffering()&&B&&Te(n,i),t+=1}}function Le(){Y&&(clearInterval(Y),Y=null)}function Pe(){return D?D.getProcessors():[]}function Ne(e){if(D&&!D.getIsEndedEventSignaled()){D.setIsEndedEventSignaled(!0);var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=e||D||null;if(!t)return null;for(var n=t.getStreamInfo(),i=n.start,r=0,a=-1,o=NaN;r<C.length;){var s=C[r].getStreamInfo(),l=s.start-i;l>0&&(isNaN(o)||l<o)&&n.id!==s.id&&(o=l,a=r),r+=1}return a>=0?C[a]:null}();n?(t.debug("StreamController onEnded, found next stream with id ".concat(n.getStreamInfo().id,". Switching from ").concat(D.getStreamInfo().id," to ").concat(n.getStreamInfo().id)),pe(n,D,NaN)):(t.debug("StreamController no next stream found"),D.setIsEndedEventSignaled(!1)),Ke(n?ee.END_OF_PERIOD_STOP_REASON:ee.END_OF_CONTENT_STOP_REASON)}e&&e.isLast&&(Le(),v.stopSteeringRequestTimer())}function Oe(e){var t=e||qe().manifestInfo.duration;g.setDuration(t)}function Fe(e){var t=b.getURIFragmentData();if(!t||!t.t)return NaN;var n=Je()[0].getStreamInfo().start;return t.t=t.t.split(",")[0],Be(e,t.t,n)}function Ue(e,t){var n=0;return e||(n=Je()[0].getStreamInfo().start),Be(e,t,n)}function Be(e,t,n){var i=h.getRegularPeriods()[0],r=t.toString(),a=-1!==r.indexOf("posix:")?"now"===r.substring(6)?Date.now()/1e3:parseFloat(r.substring(6)):NaN;return e&&!isNaN(a)?R.calcPresentationTimeFromWallTime(new Date(1e3*a),i):parseFloat(r)+n}function Ge(e,t){try{var n=NaN;if(t&&!isNaN(t.maxFragmentDuration)&&isFinite(t.maxFragmentDuration))return t.maxFragmentDuration;if(e&&1===e.length){var i=e[0],r=[a.Z.VIDEO,a.Z.AUDIO,a.Z.TEXT].reduce(function(e,t){var n=h.getMediaInfoForType(i,t);return n&&!1!==n.isFragmented&&e.push(n),e},[]).reduce(function(e,t){var n=h.getVoRepresentations(t);return n&&n.length>0&&n.forEach(function(t){t&&e.push(t)}),e},[]).reduce(function(e,t){var n=h.convertRepresentationToRepresentationInfo(t);return n&&n.fragmentDuration&&!isNaN(n.fragmentDuration)&&e.push(n.fragmentDuration),e},[]);n=Math.max.apply(Math,function(e){if(Array.isArray(e))return sn(e)}(o=r)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(o)||function(e,t){if(e){if("string"==typeof e)return sn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sn(e,t):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}return isFinite(n)?n:NaN}catch(e){return NaN}var o}function je(e){if(e.error)U=!0,Xe();else{t.info("Manifest updated... updating data system wide.");var n=e.manifest;h.updatePeriods(n);var r=h.getUTCTimingSources();!h.getIsDynamic()||r&&0!==r.length||oe.trigger(f.Z.CONFORMANCE_VIOLATION,{level:on.LEVELS.WARNING,event:on.EVENTS.NO_UTC_TIMING_ELEMENT});var a=h.getIsDynamic()?r.concat(K.getUTCTimingSources()):r;i.filterUnsupportedFeatures(n).then(function(){y.initialize(n),m.attemptSync(a,h.getIsDynamic())})}}function Ve(){return!!D&&D.getHasVideoTrack()}function He(){return!!D&&D.getHasAudioTrack()}function Ke(e,t){t=t||new Date,Pe().forEach(function(n){n.finalisePlayList(t,e)}),p.addPlayList()}function ze(e){p.createPlaylistMetrics(1e3*j.getTime(),e)}function Ze(e){if(e.error){var n="";switch(e.error.code){case 1:n="MEDIA_ERR_ABORTED";break;case 2:n="MEDIA_ERR_NETWORK";break;case 3:n="MEDIA_ERR_DECODE",re.counts.mediaErrorDecode+=1;break;case 4:n="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:n="MEDIA_ERR_ENCRYPTED";break;default:n="UNKNOWN"}"MEDIA_ERR_DECODE"===n&&Q.get().errors.recoverAttempts.mediaErrorDecode>=re.counts.mediaErrorDecode?function(){t.warn("A MEDIA_ERR_DECODE occured: Resetting the MediaSource");var e=j.getTime();D.deactivate(!1),t.warn("MediaSource has been resetted. Resuming playback from time ".concat(e)),ge(e,!1,!1)}():(F=!0,e.error.message&&(n+=" ("+e.error.message+")"),e.error.msExtendedCode&&(n+=" (0x"+(e.error.msExtendedCode>>>0).toString(16).toUpperCase()+")"),t.fatal("Video Element Error: "+n),e.error&&t.fatal(e.error),I.error(new T.Z(e.error.code,n)),Xe())}}function qe(){return D?D.getStreamInfo():null}function Ye(e){for(var t=0,n=C.length;t<n;t++)if(C[t].getId()===e)return C[t];return null}function We(e){isNaN(e.newDuration)||Oe(e.newDuration)}function $e(){C=[],ie=NaN,k=null,O=!1,D=null,F=!1,U=!1,Z=!0,q=!0,z=!1,P=!0,Y=null,te=!1,X=!1,$=[],ne=null,re={counts:{mediaErrorDecode:0}}}function Xe(){se(),m.reset(),Ke(F||U?ee.FAILURE_STOP_REASON:ee.USER_REQUEST_STOP_REASON);for(var t=0,n=C?C.length:0;t<n;t++)C[t].reset(F);oe.off(f.Z.PLAYBACK_TIME_UPDATED,Re,e),oe.off(f.Z.PLAYBACK_SEEKING,ve,e),oe.off(f.Z.PLAYBACK_ERROR,Ze,e),oe.off(f.Z.PLAYBACK_STARTED,Ce,e),oe.off(f.Z.PLAYBACK_PAUSED,De,e),oe.off(f.Z.PLAYBACK_ENDED,Ne,e),oe.off(f.Z.METRIC_ADDED,Qe,e),oe.off(f.Z.MANIFEST_VALIDITY_CHANGED,We,e),oe.off(f.Z.BUFFER_LEVEL_UPDATED,Ae,e),oe.off(f.Z.QUALITY_CHANGE_REQUESTED,Ie,e),u.Z.KEY_SESSION_UPDATED&&oe.off(u.Z.KEY_SESSION_UPDATED,ce,e),oe.off(u.Z.MANIFEST_UPDATED,je,e),oe.off(u.Z.STREAM_BUFFERING_COMPLETED,ke,e),oe.off(u.Z.TIME_SYNCHRONIZATION_COMPLETED,ue,e),oe.off(u.Z.CURRENT_TRACK_CHANGED,be,e),oe.off(u.Z.SETTING_UPDATED_LIVE_DELAY,xe,e),oe.off(u.Z.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,xe,e),y.reset(),r.reset(),w.reset(),p.clearAllCurrentMetrics(),c.setValue(null),o.reset(),R.reset(),A.reset(),B&&(g.detachMediaSource(G),B=null),G=null,k&&(k=null,L=null,c.getValue()&&oe.trigger(u.Z.PROTECTION_DESTROYED,{data:c.getValue().url})),Le(),oe.trigger(u.Z.STREAM_TEARDOWN_COMPLETE),$e()}function Qe(e){if(e.metric===s.Z.DVR_INFO){var t=He()?a.Z.AUDIO:a.Z.VIDEO;e.mediaType===t&&g.setSeekable(e.value.range.start,e.value.range.end)}}function Je(){return C}return e={initialize:function(t,n){se(),P=t,L=n,R.initialize(),(r=Xt(ae).create()).setConfig({manifestModel:c,adapter:h,manifestLoader:o,errHandler:I,settings:Q,contentSteeringController:v}),r.initialize(),(w=an(ae).getInstance()).setConfig({manifestUpdater:r,playbackController:j,settings:Q}),w.start(),m.setConfig({dashMetrics:p,baseURLController:y,errHandler:I,settings:Q}),m.initialize(),g.setConfig({settings:Q}),k&&(oe.trigger(u.Z.PROTECTION_CREATED,{controller:k}),k.setMediaElement(G.getElement()),L&&k.setProtectionData(L)),oe.on(f.Z.PLAYBACK_TIME_UPDATED,Re,e),oe.on(f.Z.PLAYBACK_SEEKING,ve,e),oe.on(f.Z.PLAYBACK_ERROR,Ze,e),oe.on(f.Z.PLAYBACK_STARTED,Ce,e),oe.on(f.Z.PLAYBACK_PAUSED,De,e),oe.on(f.Z.PLAYBACK_ENDED,Ne,e),oe.on(f.Z.METRIC_ADDED,Qe,e),oe.on(f.Z.MANIFEST_VALIDITY_CHANGED,We,e),oe.on(f.Z.BUFFER_LEVEL_UPDATED,Ae,e),oe.on(f.Z.QUALITY_CHANGE_REQUESTED,Ie,e),u.Z.KEY_SESSION_UPDATED&&oe.on(u.Z.KEY_SESSION_UPDATED,ce,e),oe.on(u.Z.MANIFEST_UPDATED,je,e),oe.on(u.Z.STREAM_BUFFERING_COMPLETED,ke,e),oe.on(u.Z.TIME_SYNCHRONIZATION_COMPLETED,ue,e),oe.on(u.Z.CURRENT_TRACK_CHANGED,be,e),oe.on(u.Z.SETTING_UPDATED_LIVE_DELAY,xe,e),oe.on(u.Z.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,xe,e)},getActiveStreamInfo:qe,addDVRMetric:we,hasVideoTrack:Ve,hasAudioTrack:He,getStreamById:Ye,getStreamForTime:Se,getTimeRelativeToStreamId:function(e,t){for(var n=null,i=0,r=0,a=null,o=0;o<C.length;o++){if(r=(n=C[o]).getStartTime(),a=n.getDuration(),Number.isFinite(r)&&(i=r),n.getId()===t)return e-i;Number.isFinite(a)&&(i+=a)}return null},load:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:NaN;se(),ie=t,o.load(e)},loadWithManifest:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:NaN;le(),ie=t,r.setManifest(e)},getActiveStreamProcessors:Pe,setConfig:function(e){e&&(e.capabilities&&(n=e.capabilities),e.capabilitiesFilter&&(i=e.capabilitiesFilter),e.manifestLoader&&(o=e.manifestLoader),e.manifestModel&&(c=e.manifestModel),e.mediaPlayerModel&&(H=e.mediaPlayerModel),e.customParametersModel&&(K=e.customParametersModel),e.protectionController&&(k=e.protectionController),e.adapter&&(h=e.adapter),e.dashMetrics&&(p=e.dashMetrics),e.errHandler&&(I=e.errHandler),e.timelineConverter&&(R=e.timelineConverter),e.videoModel&&(G=e.videoModel),e.playbackController&&(j=e.playbackController),e.serviceDescriptionController&&(V=e.serviceDescriptionController),e.contentSteeringController&&(v=e.contentSteeringController),e.textController&&(M=e.textController),e.abrController&&(E=e.abrController),e.mediaController&&(S=e.mediaController),e.settings&&(Q=e.settings),e.baseURLController&&(y=e.baseURLController),e.uriFragmentModel&&(b=e.uriFragmentModel),e.segmentBaseController&&(_=e.segmentBaseController),e.manifestUpdater&&(r=e.manifestUpdater))},setProtectionData:function(e){L=e,k&&k.setProtectionData(L)},getIsStreamSwitchInProgress:function(){return O},switchToVideoElement:function(e){D&&(j.initialize(qe()),ge(e,!1,!0))},getHasMediaOrInitialisationError:function(){return F||U},getStreams:Je,getActiveStream:function(){return D},getInitialPlayback:function(){return Z},getAutoPlay:function(){return P},refreshManifest:function(){r.getIsUpdating()||r.refreshManifest()},reset:Xe},t=(0,d.Z)(ae).getInstance().getLogger(e),m=en(ae).getInstance(),g=nn(ae).getInstance(),A=N(ae).getInstance(),$e(),e}ln.__dashjs_factory_name="StreamController";var un=c.Z.getSingletonFactory(ln);function cn(){var e,t,n,i,r,o,s,c,f,h,p,g,m=this.context,v=(0,l.Z)(m).getInstance();function y(){g.debug("Stopping the gap controller"),r&&(clearInterval(r),r=null),function(){v.off(u.Z.WALLCLOCK_TIME_UPDATED,S,this),v.off(u.Z.INITIAL_STREAM_SWITCH,T,this),v.off(u.Z.PLAYBACK_SEEKING,_,this),v.off(u.Z.BUFFER_REPLACEMENT_STARTED,b,e),v.off(u.Z.TRACK_CHANGE_RENDERED,E,e)}(),r=null,o=NaN,i=0,h=null,p={}}function _(){h&&(clearTimeout(h),h=null)}function b(e){try{if(e.streamId!==c.getActiveStreamInfo().id||e.mediaType!==a.Z.VIDEO&&e.mediaType!==a.Z.AUDIO)return;e.streamId===c.getActiveStreamInfo().id&&(p[e.mediaType]=!0)}catch(e){g.error(e)}}function E(e){e&&e.mediaType&&(p[e.mediaType]=!1)}function T(){r||function(){try{r||(g.debug("Starting the gap controller"),r=setInterval(function(){w()&&R(s.getTime())},100))}catch(e){}}()}function S(){if(w(n.get().streaming.gaps.enableSeekFix)&&++i>=10){var e=s.getTime();t===e?R(e,!0):(t=e,o=NaN),i=0}}function w(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!c.getActiveStream())return!1;var t=Object.keys(p).some(function(e){return p[e]}),i=!!e&&A();return!t&&n.get().streaming.gaps.jumpGaps&&c.getActiveStreamProcessors().length>0&&(!s.isSeeking()||i)&&!s.isPaused()&&!c.getIsStreamSwitchInProgress()&&!c.getHasMediaOrInitialisationError()}function A(){var e=c.getActiveStream(),t=parseFloat((e.getStartTime()+e.getDuration()).toFixed(5));return s.getTime()+n.get().streaming.gaps.threshold>=t}function I(e,t){try{if(!e||e.length<=1&&t>0)return NaN;for(var i=NaN,r=0;isNaN(i)&&r<e.length;){var a=r>0?e.end(r-1):0;t<e.start(r)&&a-t<n.get().streaming.gaps.threshold&&(i=r),r+=1}return i}catch(e){return null}}function x(e,t){for(var n=0,i=e.length;n<i;n++)if(t>=e.start(n)&&t<=e.end(n))return!0;return!1}function R(e){var t,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=n.get().streaming.gaps.enableStallFix,a=n.get().streaming.gaps.stallSeek,l=n.get().streaming.gaps.smallGapLimit,u=n.get().streaming.gaps.jumpLargeGaps,d=f.getBufferRange(),p=NaN,m=!1;if(t=I(d,e),!isNaN(t)){var v=d.start(t),y=v-e;y>0&&(y<=l||u)&&(p=v)}var _=s.getTimeToStreamEnd();if(isNaN(p)&&i&&isFinite(_)&&!isNaN(_)&&_<l&&(p=parseFloat(s.getStreamEndTime().toFixed(5)),m=!0),r&&isNaN(p)&&i&&isNaN(t)&&x(d,e)&&(0===a?(g.warn("Toggle play pause to break stall"),f.pause(),f.play()):(g.warn("Jumping ".concat(a,"s to break stall")),p=e+a)),p>0&&o!==p&&p>e&&!h){var b=p-e;if(m){var E=c.getStreamForTime(p),T=E&&!!E.getPreloaded();g.warn("Jumping to end of stream because of gap from ".concat(e," to ").concat(p,". Gap duration: ").concat(b)),s.seek(p,!0,T)}else{var S=s.getIsDynamic(),w=t>0?d.end(t-1):e,A=S?1e3*Math.max(0,b-.1):0;h=window.setTimeout(function(){s.seek(p,!0,!0),g.warn("Jumping gap occuring in period ".concat(c.getActiveStream().getStreamId()," starting at ").concat(w," and ending at ").concat(p,". Jumping by: ").concat(p-w)),h=null},A)}o=p}}return e={reset:y,setConfig:function(e){e&&(e.settings&&(n=e.settings),e.playbackController&&(s=e.playbackController),e.streamController&&(c=e.streamController),e.videoModel&&(f=e.videoModel))},initialize:function(){!function(){v.on(u.Z.WALLCLOCK_TIME_UPDATED,S,this),v.on(u.Z.INITIAL_STREAM_SWITCH,T,this),v.on(u.Z.PLAYBACK_SEEKING,_,this),v.on(u.Z.BUFFER_REPLACEMENT_STARTED,b,e),v.on(u.Z.TRACK_CHANGE_RENDERED,E,e)}()}},g=(0,d.Z)(m).getInstance().getLogger(e),y(),e}cn.__dashjs_factory_name="GapController";var dn=c.Z.getSingletonFactory(cn);function fn(){var e,t,n,i,r,o,c,h,p,g,m=this.context,v=(0,l.Z)(m).getInstance();function y(){t=!1;var e=He.Z.parseUserAgent();n=e&&e.browser&&e.browser.name&&"safari"===e.browser.name.toLowerCase()}function _(){t=!1}function b(e){if(e.streamId===o.getActiveStreamInfo().id&&p){var t=c.getLiveDelay();c.getBufferLevel()>t/2&&(p=!1)}}function E(e){e.streamId===o.getActiveStreamInfo().id&&(p=e.state===s.Z.BUFFER_EMPTY)}function T(){h.getCatchupModeEnabled()||i.setPlaybackRate(1)}function S(){c.getIsDynamic()&&h.getCatchupModeEnabled()&&(h.getCatchupPlaybackRates().max>0||h.getCatchupPlaybackRates().min<0)&&!c.isPaused()&&!c.isSeeking()&&function(){try{return!(!c.getTime()>0||t)&&(A()===a.Z.LIVE_CATCHUP_MODE_LOLP?function(e,t){try{return Math.abs(w())>0||e<t}catch(e){return!1}}(c.getBufferLevel(),r.get().streaming.liveCatchup.playbackBufferMin):function(){try{return Math.abs(w())>0}catch(e){return!1}}())}catch(e){return!1}}()&&function(){if(!t&&i){var e,o=i.getPlaybackRate(),s=h.getCatchupPlaybackRates(),l=c.getBufferLevel(),u=w(),d=h.getCatchupMaxDrift();if(!isNaN(d)&&d>0&&u>d)g.info("[CatchupController]: Low Latency catchup mechanism. Latency too high, doing a seek to live point"),t=!0,c.seekToCurrentLive(!0,!1);else{var f=c.getCurrentLiveLatency(),m=c.getLiveDelay();e=A()===a.Z.LIVE_CATCHUP_MODE_LOLP?function(e,t,n,i,r){var a;if(r<i){var o=Math.abs(e.min),s=5*(r-i);a=1-o+2*o/(1+Math.pow(Math.E,-s)),g.debug("[LoL+ playback control_buffer-based] bufferLevel: "+r+", newRate: "+a)}else{if(Math.abs(t-n)<=.02*n)a=1;else{var l=t-n,u=l<0?Math.abs(e.min):e.max,c=5*l;a=1-u+2*u/(1+Math.pow(Math.E,-c))}g.debug("[LoL+ playback control_latency-based] latency: "+t+", newRate: "+a)}return a}(s,f,m,r.get().streaming.liveCatchup.playbackBufferMin,l):function(e,t,n,i){if(p)return 1;var r=t-n,a=r<0?Math.abs(e.min):e.max,o=5*r,s=1-a+2*a/(1+Math.pow(Math.E,-o));return c.getPlaybackStalled()&&i<=n/2&&r>0&&(s=1),s}(s,f,m,l);var v=n?.25:.02/(.5/s.max);e&&Math.abs(o-e)>=v&&(g.debug("[CatchupController]: Setting playback rate to ".concat(e)),i.setPlaybackRate(e))}}}()}function w(){return c.getCurrentLiveLatency()-c.getLiveDelay()}function A(){var e=r.get().streaming.liveCatchup.playbackBufferMin;return r.get().streaming.liveCatchup.mode!==a.Z.LIVE_CATCHUP_MODE_LOLP||null===e||isNaN(e)?a.Z.LIVE_CATCHUP_MODE_DEFAULT:a.Z.LIVE_CATCHUP_MODE_LOLP}function I(){h.getCatchupPlaybackRates(!0)}return e={reset:function(){v.off(f.Z.BUFFER_LEVEL_UPDATED,b,e),v.off(f.Z.BUFFER_LEVEL_STATE_CHANGED,E,e),v.off(f.Z.PLAYBACK_PROGRESS,S,e),v.off(f.Z.PLAYBACK_TIME_UPDATED,S,e),v.off(f.Z.PLAYBACK_SEEKED,_,e),v.off(u.Z.SETTING_UPDATED_CATCHUP_ENABLED,T,e),v.off(u.Z.SETTING_UPDATED_PLAYBACK_RATE_MIN,I,e),v.off(u.Z.SETTING_UPDATED_PLAYBACK_RATE_MAX,I,e),v.off(f.Z.STREAM_INITIALIZED,I,e),y(),i.setPlaybackRate(1,!0)},setConfig:function(e){e&&(e.settings&&(r=e.settings),e.videoModel&&(i=e.videoModel),e.streamController&&(o=e.streamController),e.playbackController&&(c=e.playbackController),e.mediaPlayerModel&&(h=e.mediaPlayerModel))},initialize:function(){v.on(f.Z.BUFFER_LEVEL_UPDATED,b,e),v.on(f.Z.BUFFER_LEVEL_STATE_CHANGED,E,e),v.on(f.Z.PLAYBACK_PROGRESS,S,e),v.on(f.Z.PLAYBACK_TIME_UPDATED,S,e),v.on(f.Z.PLAYBACK_SEEKED,_,e),v.on(u.Z.SETTING_UPDATED_CATCHUP_ENABLED,T,e),v.on(u.Z.SETTING_UPDATED_PLAYBACK_RATE_MIN,I,e),v.on(u.Z.SETTING_UPDATED_PLAYBACK_RATE_MAX,I,e),v.on(f.Z.STREAM_INITIALIZED,I,e),I()}},g=(0,d.Z)(m).getInstance().getLogger(e),y(),e}fn.__dashjs_factory_name="CatchupController";var hn=c.Z.getSingletonFactory(fn),pn=[a.Z.SERVICE_DESCRIPTION_DVB_LL_SCHEME],gn="video",mn="audio";function vn(){var e,t,n,i,r,s=this.context;function l(){t={liveDelay:NaN,liveCatchup:{maxDrift:NaN,playbackRate:{min:NaN,max:NaN}},minBitrate:{},maxBitrate:{},initialBitrate:{},contentSteering:null},n=[]}function u(e,n,r){try{t[e][n]=r/1e3}catch(e){i.error(e)}}return e={getServiceDescriptionSettings:function(){return t},getProducerReferenceTimeOffsets:function(){return n},calculateProducerReferenceTimeOffsets:function(e){try{var t=[];if(e&&e.length>0){var s=[a.Z.VIDEO,a.Z.AUDIO,a.Z.TEXT],l=r.getAvailabilityStartTime()/1e3;e.forEach(function(e){var n=s.reduce(function(t,n){return t.concat(r.getAllMediaInfoForType(e,n))},[]).reduce(function(t,n){return r.getProducerReferenceTimes(e,n).forEach(function(i){var a=r.getVoRepresentations(n);if(a&&a.length>0&&a[0].adaptation&&a[0].segmentInfoType===o.Z.SEGMENT_TEMPLATE){var s=a[0],u=new Date(i[o.Z.WALL_CLOCK_TIME]).getTime()/1e3-(i[o.Z.PRESENTATION_TIME]/s[o.Z.TIMESCALE]-s[o.Z.PRESENTATION_TIME_OFFSET]+e.start),c=l-u;t.push({id:i[o.Z.ID],to:c})}}),t},[]);t=t.concat(n)})}n=t}catch(e){i.error(e),n=[]}},applyServiceDescription:function(e){if(e&&e.serviceDescriptions){var r=e.serviceDescriptions.filter(function(e){return pn.includes(e.schemeIdUri)}),o=e.serviceDescriptions.filter(function(e){return null==e.schemeIdUri}),s=r.length>0?r[r.length-1]:o[o.length-1];s&&(s.latency&&s.latency.target>0&&function(e){var r;if(e.schemeIdUri,a.Z.SERVICE_DESCRIPTION_DVB_LL_SCHEME,r=function(e){return{liveDelay:e.latency.target/1e3,maxDrift:!isNaN(e.latency.max)&&e.latency.max>e.latency.target?(e.latency.max-e.latency.target+500)/1e3:NaN,referenceId:e.latency.referenceId||NaN}}(e),n.length>0){var o=function(e){var t,i=0,r=n.filter(function(t){return t.id===e.referenceId});return 0===r.length?(i=n.length>0?n[0].to:0,t=n[0].id||NaN):(i=r[0].to||0,t=r[0].id||NaN),{to:i,id:t}}(r),s=o.to,l=o.id;t.liveDelay=r.liveDelay-s,t.liveCatchup.maxDrift=r.maxDrift,i.debug("\n                Found latency properties coming from service description. Applied time offset of ".concat(s," from ProducerReferenceTime element with id ").concat(l,".\n                Live Delay: ").concat(r.liveDelay-s,", Live catchup max drift: ").concat(r.maxDrift,"\n            "))}else t.liveDelay=r.liveDelay,t.liveCatchup.maxDrift=r.maxDrift,i.debug("Found latency properties coming from service description: Live Delay: ".concat(r.liveDelay,", Live catchup max drift: ").concat(r.maxDrift))}(s),s.playbackRate&&function(e){var n=e.playbackRate.min?Math.round(1e3*(e.playbackRate.min-1))/1e3:NaN,r=e.playbackRate.max?Math.round(1e3*(e.playbackRate.max-1))/1e3:NaN;t.liveCatchup.playbackRate.min=n,t.liveCatchup.playbackRate.max=r,i.debug("Found latency properties coming from service description: Live catchup min playback rate: ".concat(n)),i.debug("Found latency properties coming from service description: Live catchup max playback rate: ".concat(r))}(s),s.operatingQuality,s.operatingBandwidth&&function(e){if(e&&e.operatingBandwidth&&e.operatingBandwidth.mediaType&&"all"!==e.operatingBandwidth.mediaType){var t={};t.minBandwidth=e.operatingBandwidth.min,t.maxBandwidth=e.operatingBandwidth.max,t.targetBandwidth=e.operatingBandwidth.target;var n=[];e.operatingBandwidth.mediaType===gn||e.operatingBandwidth.mediaType===mn?n.push(e.operatingBandwidth.mediaType):"any"===e.operatingBandwidth.mediaType&&(n.push(mn),n.push(gn)),n.forEach(function(e){isNaN(t.minBandwidth)||u("minBitrate",e,t.minBandwidth),isNaN(t.maxBandwidth)||u("maxBitrate",e,t.maxBandwidth),isNaN(t.targetBandwidth)||u("initialBitrate",e,t.targetBandwidth)})}}(s),s.contentSteering&&function(e){t.contentSteering=e.contentSteering}(s))}},reset:function(){l()},setConfig:function(e){e&&e.adapter&&(r=e.adapter)}},i=(0,d.Z)(s).getInstance().getLogger(e),l(),e}vn.__dashjs_factory_name="ServiceDescriptionController";var yn=c.Z.getSingletonFactory(vn),_n=n(3973),bn=n.n(_n),En=n(3039);function Tn(){var e,t,n,i,r,o,s,c,f=this.context,h=(0,l.Z)(f).getInstance();function p(e,t){return e&&n[t]&&n[t][e]?n[t][e].list:[]}function g(e,t){return e&&n[t]&&n[t][e]?n[t][e].current:null}function m(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e&&e.streamInfo){var r=e.type,s=e.streamInfo,l=s.id,d=g(r,l);if(n[l]&&n[l][r]&&(n[l][r].current=e,n[l][r].current&&(r!==a.Z.TEXT&&!_(e,d)||r===a.Z.TEXT&&e.isFragmented)&&h.trigger(u.Z.CURRENT_TRACK_CHANGED,{oldMediaInfo:d,newMediaInfo:e,switchMode:i.get().streaming.trackSwitchMode[r]},{streamId:l}),!t)){var f=E(e);if(!f||!n[l][r].storeLastSettings)return;f.roles&&(f.role=f.roles[0],delete f.roles),f.accessibility&&(f.accessibility=f.accessibility[0]),f.audioChannelConfiguration&&(f.audioChannelConfiguration=f.audioChannelConfiguration[0]),o[r]=f,c.setSavedMediaSettings(r,f)}}}function v(e,t){e&&t&&(r[e]=t)}function y(e){return e?r[e]:null}function _(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;var n=e.id===t.id,i=e.viewpoint===t.viewpoint,r=JSON.stringify(e.viewpointsWithSchemeIdUri)===JSON.stringify(t.viewpointsWithSchemeIdUri),a=e.lang===t.lang,o=e.codec===t.codec,s=e.roles.toString()===t.roles.toString(),l=JSON.stringify(e.rolesWithSchemeIdUri)===JSON.stringify(t.rolesWithSchemeIdUri),u=e.accessibility.toString()===t.accessibility.toString(),c=JSON.stringify(e.accessibilitiesWithSchemeIdUri)===JSON.stringify(t.accessibilitiesWithSchemeIdUri),d=e.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString(),f=JSON.stringify(e.audioChannelConfigurationsWithSchemeIdUri)===JSON.stringify(t.audioChannelConfigurationsWithSchemeIdUri);return n&&o&&i&&r&&a&&s&&l&&u&&c&&d&&f}function b(){n={},o={},r={audio:null,video:null,text:null}}function E(e){var t={lang:e.lang,viewpoint:e.viewpoint,roles:e.roles,accessibility:e.accessibility,audioChannelConfiguration:e.audioChannelConfiguration,codec:e.codec};return t.lang||t.viewpoint||t.role&&t.role.length>0||t.accessibility&&t.accessibility.length>0||t.audioChannelConfiguration&&t.audioChannelConfiguration.length>0?t:null}function T(e,t,n){var i=[];return e.forEach(function(e){t(n,e)&&i.push(e)}),0!==i.length?i:e}function S(e,t){try{return!e.lang||e.lang instanceof RegExp?t.lang.match(e.lang):""!==t.lang&&(0,En.extendedFilter)(t.lang,bn()(e.lang)).length>0}catch(e){return!1}}function w(e,t){return void 0===e.index||null===e.index||t.index===e.index}function A(e,t){return!e.viewpoint||e.viewpoint===t.viewpoint}function I(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!e.role||!!t.roles.filter(function(t){return t===e.role})[0];return i||t.type===a.Z.AUDIO&&n}function x(e,t){return e.accessibility?!!t.accessibility.filter(function(t){return t===e.accessibility})[0]:!t.accessibility.length}function R(e,t){return!e.audioChannelConfiguration||!!t.audioChannelConfiguration.filter(function(t){return t===e.audioChannelConfiguration})[0]}function C(e,t){return!e.codec||e.codec===t.codec}function D(e){var t,n=0,i=[];return e.forEach(function(e){(t=Math.max.apply(Math,e.bitrateList.map(function(e){return e.bandwidth})))>n?(n=t,i=[e]):t===n&&i.push(e)}),i}function k(e){var t,n=1/0,i=[];return e.forEach(function(e){var r=e.bitrateList.reduce(function(e,t){var n=Math.max(1,t.width*t.height);return e+t.bandwidth/n},0);(t=r/e.bitrateList.length)<n?(n=t,i=[e]):t===n&&i.push(e)}),i}function M(e){var t,n=0,i=[];return e.forEach(function(e){(t=e.representationCount)>n?(n=t,i=[e]):t===n&&i.push(e)}),i}function L(e,n){if(e===a.Z.TEXT)return n[0];var r,o=i.get().streaming.selectionModeForInitialTrack,l=s.getCustomInitialTrackSelectionFunction();if(l&&"function"==typeof l)r=l(n);else switch(o){case a.Z.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY:r=function(e){var t,n,i=(t=0,n=[],e.forEach(function(e){isNaN(e.selectionPriority)||(e.selectionPriority>t?(t=e.selectionPriority,n=[e]):e.selectionPriority===t&&n.push(e))}),n);return i.length>1&&(i=D(i)),i.length>1&&(i=M(i)),i}(n);break;case a.Z.TRACK_SELECTION_MODE_HIGHEST_BITRATE:r=function(e){var t=D(e);return t.length>1&&(t=M(t)),t}(n);break;case a.Z.TRACK_SELECTION_MODE_FIRST_TRACK:r=P(n);break;case a.Z.TRACK_SELECTION_MODE_HIGHEST_EFFICIENCY:r=function(e){var t=k(e);return t.length>1&&(t=D(t)),t}(n);break;case a.Z.TRACK_SELECTION_MODE_WIDEST_RANGE:r=function(e){var t=M(e);return t.length>1&&(t=D(e)),t}(n);break;default:t.warn("Track selection mode ".concat(o," is not supported. Falling back to TRACK_SELECTION_MODE_FIRST_TRACK")),r=P(n)}return r.length>0?r[0]:n[0]}function P(e){return e[0]}return e={setInitialMediaSettingsForType:function(e,t){var n=o[e]||y(e),i=p(e,t.id),r=[];n||((n=c.getSavedMediaSettings(e))&&delete n.codec,v(e,n)),i&&0!==i.length&&(n&&(r=T(r=Array.from(i),S,n),r=T(r,w,n),r=T(r,A,n),e===a.Z.AUDIO&&o[e]||(r=T(r,I,n)),r=T(r,x,n),r=T(r,R,n),r=T(r,C,n)),0===r.length?m(L(e,i),!0):r.length>1?m(L(e,r)):m(r[0]))},addTrack:function(e){if(e){var t=e.type;if((r=t)===a.Z.AUDIO||r===a.Z.VIDEO||r===a.Z.TEXT||r===a.Z.IMAGE){var r,o,s=e.streamInfo.id;n[s]||(n[s]={audio:{list:[],storeLastSettings:o=i.get().streaming.saveLastMediaSettingsForCurrentStreamingSession,current:null},video:{list:[],storeLastSettings:o,current:null},text:{list:[],storeLastSettings:o,current:null},image:{list:[],storeLastSettings:o,current:null}});for(var l=n[s][t].list,u=0,c=l.length;u<c;++u)if(_(l[u],e))return;l.push(e)}}},getTracksFor:p,getCurrentTrackFor:g,isCurrentTrack:function(e){if(!e)return!1;var t=e.type,i=e.streamInfo.id;return n[i]&&n[i][t]&&_(n[i][t].current,e)},setTrack:m,selectInitialTrack:L,setInitialSettings:v,getInitialSettings:y,getTracksWithHighestBitrate:D,getTracksWithHighestEfficiency:k,getTracksWithWidestRange:M,isTracksEqual:_,matchSettings:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{var i=!1;if(e.lang){if(e.lang instanceof RegExp)i=t.lang.match(e.lang);else if(""!==t.lang){var r=bn()(e.lang);r&&(i=(0,En.extendedFilter)(t.lang,r).length>0)}}else i=!0;var o=void 0===e.index||null===e.index||t.index===e.index,s=!e.viewpoint||e.viewpoint===t.viewpoint,l=!e.role||!!t.roles.filter(function(t){return t===e.role})[0],u=!e.accessibility||!!t.accessibility.filter(function(t){return t===e.accessibility})[0],c=!e.audioChannelConfiguration||!!t.audioChannelConfiguration.filter(function(t){return t===e.audioChannelConfiguration})[0];return i&&o&&s&&(l||t.type===a.Z.AUDIO&&n)&&u&&c}catch(e){return!1}},matchSettingsLang:S,matchSettingsIndex:w,matchSettingsViewPoint:A,matchSettingsRole:I,matchSettingsAccessibility:x,matchSettingsAudioChannelConfig:R,saveTextSettingsDisabled:function(){c.setSavedMediaSettings(a.Z.TEXT,null)},setConfig:function(e){e&&(e.domStorage&&(c=e.domStorage),e.settings&&(i=e.settings),e.customParametersModel&&(s=e.customParametersModel))},reset:b},t=(0,d.Z)(f).getInstance().getLogger(e),b(),e}Tn.__dashjs_factory_name="MediaController";var Sn=c.Z.getSingletonFactory(Tn);c.Z.updateSingletonFactory(Tn.__dashjs_factory_name,Sn);var wn=Sn,An=NaN,In=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data={baseUrls:t||null,selectedIdx:n||An},this.children=[]};function xn(){var e,t,n,i,r=this.context,a=ke(r).getInstance();function o(e,t,n){var i=s(n);e[t]?a.areEqual(i,e[t].data.baseUrls)||(e[t].data.baseUrls=i,e[t].data.selectedIdx=An):e[t]=new In(i)}function s(e){var t=n.getBaseURLsFromElement(e),r=i.getSynthesizedBaseUrlElements(t);return r&&r.length>0&&(t=t.concat(r)),t}function l(e,n){var i=n||t;e(i.data),i.children&&i.children.forEach(function(t){return l(e,t)})}function u(){t=new In}return e={reset:u,update:function(e){!function(e){!function(){if(!n||!n.hasOwnProperty("getBaseURLsFromElement")||!n.hasOwnProperty("getRepresentationSortFunction"))throw new Error("setConfig function has to be called previously")}();var i=s(e);a.areEqual(i,t.data.baseUrls)||(t.data.baseUrls=i,t.data.selectedIdx=An),e&&e.Period_asArray&&e.Period_asArray.forEach(function(e,i){o(t.children,i,e),e.AdaptationSet_asArray&&e.AdaptationSet_asArray.forEach(function(e,r){o(t.children[i].children,r,e),e.Representation_asArray&&e.Representation_asArray.sort(n.getRepresentationSortFunction()).forEach(function(e,n){o(t.children[i].children[r].children,n,e)})})})}(e)},getForPath:function(e){var n=t,i=[n.data];return e&&e.forEach(function(e){(n=n.children[e])&&i.push(n.data)}),i.filter(function(e){return e.baseUrls.length})},invalidateSelectedIndexes:function(e){l(function(t){isNaN(t.selectedIdx)||e===t.baseUrls[t.selectedIdx].serviceLocation&&(t.selectedIdx=An)})},setConfig:function(e){e.adapter&&(n=e.adapter),e.contentSteeringController&&(i=e.contentSteeringController)},getBaseUrls:function(e){return s(e)}},u(),e}xn.__dashjs_factory_name="BaseURLTreeModel";var Rn=c.Z.getClassFactory(xn);function Cn(e){var t=(e=e||{}).blacklistController;return{select:function(e){return e&&function(e){var t,n,i=0,r=[],a=0;if((n=e.sort(function(e,t){var n=e.dvbPriority-t.dvbPriority;return isNaN(n)?0:n}).filter(function(e,t,n){return!t||n[0].dvbPriority&&e.dvbPriority&&n[0].dvbPriority===e.dvbPriority})).length)return n.length>1&&(n.forEach(function(e){i+=e.dvbWeight,r.push(i)}),t=Math.floor(Math.random()*(i-1)),r.every(function(e,n){return a=n,!(t<e)})),n[a]}((n=[],e.filter(function(e){return!t.contains(e.serviceLocation)||(e.dvbPriority&&n.push(e.dvbPriority),!1)}).filter(function(e){return!n.length||!e.dvbPriority||-1===n.indexOf(e.dvbPriority)})));var n}}}Cn.__dashjs_factory_name="DVBSelector";var Dn=c.Z.getClassFactory(Cn);function kn(e){var t=(e=e||{}).blacklistController;return{select:function(e){var n,i=0;return e&&e.some(function(e,n){return i=n,!t.contains(e.serviceLocation)})&&(n=e[i]),n}}}kn.__dashjs_factory_name="BasicSelector";var Mn=c.Z.getClassFactory(kn);function Ln(){var e,t,n,i=this.context;function r(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=0,r=NaN,a=function(){var a=e[i],o=t.findIndex(function(e){return e.serviceLocation&&e.serviceLocation===a});if(-1!==o&&!n.contains(t[o].serviceLocation))return r=o,"break";i+=1};i<e.length;){var o=a();if("break"===o)break}return r}return e={selectBaseUrlIndex:function(e){var n=NaN;if(isNaN(e.selectedIdx)){var i=t.getSteeringDataFromManifest();i&&i.defaultServiceLocationArray.length>0&&(n=r(i.defaultServiceLocationArray,e.baseUrls))}var a=t.getCurrentSteeringResponseData();return e.baseUrls&&e.baseUrls.length&&a&&a.pathwayPriority&&a.pathwayPriority.length&&(n=r(a.pathwayPriority,e.baseUrls)),n},setConfig:function(e){e.blacklistController&&(n=e.blacklistController),e.contentSteeringController&&(t=e.contentSteeringController)}},t=qt(i).getInstance(),e}Ln.__dashjs_factory_name="ContentSteeringSelector";var Pn=c.Z.getClassFactory(Ln);function Nn(){var e,t,n,i,r,a,o=this.context,s=(0,l.Z)(o).getInstance(),c=(0,R.Z)(o).getInstance();function d(){t.reset()}return e={chooseSelector:function(e){(0,Y.PS)(e,"boolean"),a=e?i:n},select:function(e){if(e){if(c.get().streaming.applyContentSteering){var t=r.selectBaseUrlIndex(e);isNaN(t)||-1===t||(e.selectedIdx=t)}if(!isNaN(e.selectedIdx))return e.baseUrls[e.selectedIdx];var i=a.select(e.baseUrls);return i?(e.selectedIdx=e.baseUrls.indexOf(i),i):(s.trigger(u.Z.URL_RESOLUTION_FAILED,{error:new T.Z(x.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE,x.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE)}),void(a===n&&d()))}},reset:d,setConfig:function(e){e.selector&&(a=e.selector),e.contentSteeringSelector&&(r=e.contentSteeringSelector)}},t=Gt(o).create({updateEventName:u.Z.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED,addBlacklistEventName:u.Z.SERVICE_LOCATION_BASE_URL_BLACKLIST_ADD}),n=Mn(o).create({blacklistController:t}),i=Dn(o).create({blacklistController:t}),(r=Pn(o).create()).setConfig({blacklistController:t}),a=n,e}Nn.__dashjs_factory_name="BaseURLSelector";var On=c.Z.getClassFactory(Nn);function Fn(){var e,t,n,i,r,a=this.context,o=(0,l.Z)(a).getInstance(),s=(0,X.Z)(a).getInstance();function c(e){n.update(e),i.chooseSelector(t.getIsDVB(e)),o.trigger(f.Z.BASE_URLS_UPDATED,{baseUrls:d(e)})}function d(e){return n.getBaseUrls(e)}return e={reset:function(){n.reset(),i.reset()},initialize:function(e){n.setConfig({adapter:t,contentSteeringController:r}),c(e)},resolve:function(e){var t=n.getForPath(e).reduce(function(e,t){var n=i.select(t);return n?(s.isRelative(n.url)?e.url=s.resolve(n.url,e.url):(e.url=n.url,e.serviceLocation=n.serviceLocation),e.availabilityTimeOffset=n.availabilityTimeOffset,e.availabilityTimeComplete=n.availabilityTimeComplete,e.queryParams=n.queryParams,e):new Te},new Te);if(!s.isRelative(t.url))return t},setConfig:function(e){e.baseURLTreeModel&&(n=e.baseURLTreeModel),e.baseURLSelector&&(i=e.baseURLSelector),e.adapter&&(t=e.adapter),e.contentSteeringController&&(r=e.contentSteeringController)},getBaseUrls:d,update:c},n=Rn(a).create(),i=On(a).create(),o.on(u.Z.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED,function(e){n.invalidateSelectedIndexes(e.entry)},e),e}Fn.__dashjs_factory_name="BaseURLController";var Un=c.Z.getClassFactory(Fn);function Bn(e){return Bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bn(e)}function Gn(e,t){return Gn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Gn(e,t)}function jn(e,t){return!t||"object"!==Bn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vn(e){return Vn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Vn(e)}var Hn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gn(e,t)}(r,e);var t,n,i=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=Vn(t);if(n){var r=Vn(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return jn(this,e)});function r(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(n=i.call(this)).url=e||null,n.type=t||null,n.mediaType=a.Z.STREAM,n.responseType="",n}return r}(g.Z);function Kn(e){e=e||{};var t=this.context,n=(0,l.Z)(t).getInstance(),i=Tt(t).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,errors:x});return{load:function(e,t,r){var a=function(i,a){t.resolved=!0,t.resolvedContent=i||null,n.trigger(u.Z.XLINK_ELEMENT_LOADED,{element:t,resolveObject:r,error:i||a?null:new T.Z(x.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE,x.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE+e)})};if("urn:mpeg:dash:resolve-to-zero:2013"===e)a(null,!0);else{var o=new Hn(e,C.w.XLINK_EXPANSION_TYPE);i.load({request:o,success:function(e){a(e)},error:function(){a(null)}})}},reset:function(){i&&(i.abort(),i=null)}}}Kn.__dashjs_factory_name="XlinkLoader";var zn=c.Z.getClassFactory(Kn),Zn=function(e){function t(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!=t||(t=e.nodeName),t}function n(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):e}function i(e,t,n,i){for(var r=0;r<e.length;r++){var a=e[r];if("string"==typeof a){if(a==i)break}else if(a instanceof RegExp){if(a.test(i))break}else if("function"==typeof a&&a(t,n,i))break}return r!=e.length}function r(t,n,r){"property"===e.arrayAccessForm&&(t[n]instanceof Array?t[n+"_asArray"]=t[n]:t[n+"_asArray"]=[t[n]]),!(t[n]instanceof Array)&&e.arrayAccessFormPaths.length>0&&i(e.arrayAccessFormPaths,t,n,r)&&(t[n]=[t[n]])}function a(e){var t=e.split(/[-T:+Z]/g),n=new Date(t[0],t[1]-1,t[2]),i=t[5].split(".");if(n.setHours(t[3],t[4],i[0]),i.length>1&&n.setMilliseconds(i[1]),t[6]&&t[7]){var r=60*t[6]+Number(t[7]);r=0+("-"==(/\d\d-\d\d:\d\d$/.test(e)?"-":"+")?-1*r:r),n.setMinutes(n.getMinutes()-r-n.getTimezoneOffset())}else-1!==e.indexOf("Z",e.length-1)&&(n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())));return n}function o(t,n,r,a){return!(1==n&&e.xmlElementsFilter.length>0)||i(e.xmlElementsFilter,t,r,a)}function s(n,l){if(9==n.nodeType){for(var u=new Object,c=n.childNodes,d=0;d<c.length;d++)1==(h=c[d]).nodeType&&(e.ignoreRoot?u=s(h):(u={})[p=t(h)]=s(h));return u}if(1==n.nodeType){(u=new Object).__cnt=0;var f=[];for(c=n.childNodes,d=0;d<c.length;d++){var h,p=t(h=c[d]);if(8!=h.nodeType){var g=l+"."+p;if(o(u,h.nodeType,p,g))if(u.__cnt++,null==u[p]){var m=s(h,g);("#text"!=p||/[^\s]/.test(m))&&((v={})[p]=m,f.push(v)),u[p]=m,r(u,p,g)}else{var v;null!=u[p]&&(u[p]instanceof Array||(u[p]=[u[p]],r(u,p,g))),m=s(h,g),("#text"!=p||/[^\s]/.test(m))&&((v={})[p]=m,f.push(v)),u[p][u[p].length]=m}}}u.__children=f;for(var y=t(n),_=0;_<n.attributes.length;_++){var b=n.attributes[_];u.__cnt++;for(var E=b.value,T=0,S=e.matchers.length;T<S;T++){var w=e.matchers[T];w.test(b,y)&&(E=w.converter(b.value))}u[e.attributePrefix+b.name]=E}var A=function(e){return e.prefix}(n);return null!=A&&""!=A&&(u.__cnt++,u.__prefix=A),null!=u["#text"]&&(u.__text=u["#text"],u.__text instanceof Array&&(u.__text=u.__text.join("\n")),e.stripWhitespaces&&(u.__text=u.__text.trim()),delete u["#text"],"property"==e.arrayAccessForm&&delete u["#text_asArray"],u.__text=function(t,n,r){if(e.datetimeAccessFormPaths.length>0){var o=r.split(".#")[0];return i(e.datetimeAccessFormPaths,t,n,o)?a(t):t}return t}(u.__text,p,l+"."+p)),null!=u["#cdata-section"]&&(u.__cdata=u["#cdata-section"],delete u["#cdata-section"],"property"==e.arrayAccessForm&&delete u["#cdata-section_asArray"]),0==u.__cnt&&"text"==e.emptyNodeForm?u="":1==u.__cnt&&null!=u.__text?u=u.__text:1!=u.__cnt||null==u.__cdata||e.keepCData?u.__cnt>1&&null!=u.__text&&e.skipEmptyTextNodesForObj&&(e.stripWhitespaces&&""==u.__text||""==u.__text.trim())&&delete u.__text:u=u.__cdata,delete u.__cnt,!e.enableToStringFunc||null==u.__text&&null==u.__cdata||(u.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),u}if(3==n.nodeType||4==n.nodeType)return n.nodeValue}function l(t,i,r,a){var o="<"+(null!=t&&null!=t.__prefix?t.__prefix+":":"")+i;if(null!=r)for(var s=0;s<r.length;s++){var l=r[s],u=t[l];e.escapeMode&&(u=n(u)),o+=" "+l.substr(e.attributePrefix.length)+"=",e.useDoubleQuotes?o+='"'+u+'"':o+="'"+u+"'"}return o+(a?"/>":">")}function u(e,t){return"</"+(null!=e.__prefix?e.__prefix+":":"")+t+">"}function c(t,n){return"property"==e.arrayAccessForm&&(r="_asArray",-1!==(i=n.toString()).indexOf(r,i.length-r.length))||0==n.toString().indexOf(e.attributePrefix)||0==n.toString().indexOf("__")||t[n]instanceof Function;var i,r}function d(e){var t=0;if(e instanceof Object)for(var n in e)c(e,n)||t++;return t}function f(t,n,r){return 0==e.jsonPropertiesFilter.length||""==r||i(e.jsonPropertiesFilter,t,n,r)}function h(t){var n=[];if(t instanceof Object)for(var i in t)-1==i.toString().indexOf("__")&&0==i.toString().indexOf(e.attributePrefix)&&n.push(i);return n}function p(t){var i="";return t instanceof Object?i+=function(t){var i="";return null!=t.__cdata&&(i+="<![CDATA["+t.__cdata+"]]>"),null!=t.__text&&(e.escapeMode?i+=n(t.__text):i+=t.__text),i}(t):null!=t&&(e.escapeMode?i+=n(t):i+=t),i}function g(e,t){return""===e?t:e+"."+t}function m(e,t,n,i){var r="";if(0==e.length)r+=l(e,t,n,!0);else for(var a=0;a<e.length;a++)r+=l(e[a],t,h(e[a]),!1),r+=v(e[a],g(i,t)),r+=u(e[a],t);return r}function v(e,t){var n="";if(d(e)>0)for(var i in e)if(!c(e,i)&&(""==t||f(e,i,g(t,i)))){var r=e[i],a=h(r);null==r||null==r?n+=l(r,i,a,!0):r instanceof Object?r instanceof Array?n+=m(r,i,a,t):r instanceof Date?(n+=l(r,i,a,!1),n+=r.toISOString(),n+=u(r,i)):d(r)>0||null!=r.__text||null!=r.__cdata?(n+=l(r,i,a,!1),n+=v(r,g(t,i)),n+=u(r,i)):n+=l(r,i,a,!0):(n+=l(r,i,a,!1),n+=p(r),n+=u(r,i))}return n+p(e)}void 0===(e=e||{}).escapeMode&&(e.escapeMode=!0),void 0===e.attributePrefix&&(e.attributePrefix="_"),e.arrayAccessForm=e.arrayAccessForm||"none",e.emptyNodeForm=e.emptyNodeForm||"text",void 0===e.enableToStringFunc&&(e.enableToStringFunc=!0),e.arrayAccessFormPaths=e.arrayAccessFormPaths||[],void 0===e.skipEmptyTextNodesForObj&&(e.skipEmptyTextNodesForObj=!0),void 0===e.stripWhitespaces&&(e.stripWhitespaces=!0),e.datetimeAccessFormPaths=e.datetimeAccessFormPaths||[],void 0===e.useDoubleQuotes&&(e.useDoubleQuotes=!1),e.xmlElementsFilter=e.xmlElementsFilter||[],e.jsonPropertiesFilter=e.jsonPropertiesFilter||[],void 0===e.keepCData&&(e.keepCData=!1),void 0===e.ignoreRoot&&(e.ignoreRoot=!1),this.parseXmlString=function(e){var t;if(window.ActiveXObject||window,void 0===e)return null;if(window.DOMParser){var n=new window.DOMParser;try{(t=n.parseFromString(e,"text/xml")).getElementsByTagNameNS("*","parsererror").length>0&&(t=null)}catch(e){t=null}}else 0==e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),(t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e);return t},this.asArray=function(e){return void 0===e||null==e?[]:e instanceof Array?e:[e]},this.toXmlDateTime=function(e){return e instanceof Date?e.toISOString():"number"==typeof e?new Date(e).toISOString():null},this.asDateTime=function(e){return"string"==typeof e?a(e):e},this.xml2json=function(e){return s(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);return null!=t?this.xml2json(t):null},this.json2xml_str=function(e){return v(e,"")},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t)},this.getVersion=function(){return"1.2.0"}},qn="onLoad";function Yn(e){e=e||{};var t,n,i,r,a,s,c=this.context,d=(0,l.Z)(c).getInstance(),f=(0,X.Z)(c).getInstance();function h(e,t,n){var i,r,a={};a.elements=e,a.type=t,a.resolveType=n,0===a.elements.length&&g(a);for(var o=0;o<a.elements.length;o++)i=a.elements[o],r=f.isHTTPURL(i.url)?i.url:i.originalContent.BaseURL+i.url,s.load(r,i,a)}function p(e){var t,n,i="";if(t=e.element,n=e.resolveObject,t.resolvedContent){var r=0;0===t.resolvedContent.indexOf("<?xml")&&(r=t.resolvedContent.indexOf("?>")+2),i=t.resolvedContent.substr(0,r)+"<response>"+t.resolvedContent.substr(r)+"</response>",t.resolvedContent=a.xml_str2json(i)}(function(e){var t;for(t=0;t<e.elements.length;t++)if(!1===e.elements[t].resolved)return!1;return!0})(n)&&g(n)}function g(e){var t,n,a=[];if(function(e){var t,n,a,o,s,l,u=[];for(o=e.elements.length-1;o>=0;o--){if(n=(t=e.elements[o]).type+"_asArray",t.resolvedContent){if(t.resolvedContent)for(s=0;s<t.resolvedContent[n].length;s++)a=t.resolvedContent[n][s],u.push(a)}else delete t.originalContent["xlink:actuate"],delete t.originalContent["xlink:href"],u.push(t.originalContent);for(t.parentElement[n].splice(t.index,1),l=0;l<u.length;l++)t.parentElement[n].splice(t.index+l,0,u[l]);u=[]}e.elements.length>0&&i.run(r)}(e),"onActuate"===e.resolveType&&d.trigger(u.Z.XLINK_READY,{manifest:r}),e.resolveType===qn)switch(e.type){case o.Z.PERIOD:for(t=0;t<r[o.Z.PERIOD+"_asArray"].length;t++)(n=r[o.Z.PERIOD+"_asArray"][t]).hasOwnProperty(o.Z.ADAPTATION_SET+"_asArray")&&(a=a.concat(m(n[o.Z.ADAPTATION_SET+"_asArray"],n,o.Z.ADAPTATION_SET,qn))),n.hasOwnProperty(o.Z.EVENT_STREAM+"_asArray")&&(a=a.concat(m(n[o.Z.EVENT_STREAM+"_asArray"],n,o.Z.EVENT_STREAM,qn)));h(a,o.Z.ADAPTATION_SET,qn);break;case o.Z.ADAPTATION_SET:d.trigger(u.Z.XLINK_READY,{manifest:r})}}function m(e,t,n,i){var r,a,o,s=[];for(a=e.length-1;a>=0;a--)(r=e[a]).hasOwnProperty("xlink:href")&&"urn:mpeg:dash:resolve-to-zero:2013"===r["xlink:href"]&&e.splice(a,1);for(a=0;a<e.length;a++)(r=e[a]).hasOwnProperty("xlink:href")&&r.hasOwnProperty("xlink:actuate")&&r["xlink:actuate"]===i&&(o=v(r["xlink:href"],t,n,a,i,r),s.push(o));return s}function v(e,t,n,i,r,a){return{url:e,parentElement:t,type:n,index:i,resolveType:r,originalContent:a,resolvedContent:null,resolved:!1}}return t={resolveManifestOnLoad:function(e){a=new Zn({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:n}),(r=e).Period_asArray?h(m(r.Period_asArray,r,o.Z.PERIOD,qn),o.Z.PERIOD,qn):d.trigger(u.Z.XLINK_READY,{manifest:r})},setMatchers:function(e){e&&(n=e)},setIron:function(e){e&&(i=e)},reset:function(){d.off(u.Z.XLINK_ELEMENT_LOADED,p,t),s&&(s.reset(),s=null)}},d.on(u.Z.XLINK_ELEMENT_LOADED,p,t),s=zn(c).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,settings:e.settings}),t}Yn.__dashjs_factory_name="XlinkController";var Wn=c.Z.getClassFactory(Yn);function $n(e){return $n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$n(e)}function Xn(e){function t(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function n(e,n,i){for(var r=0,a=e.length;r<a;++r){var o=e[r];if(n[o.name])if(i[o.name]){if(o.merge){var s=n[o.name],l=i[o.name];"object"===$n(s)&&"object"===$n(l)?t(s,l):i[o.name]=s+l}}else i[o.name]=n[o.name]}}function i(e,t){for(var r=0,a=e.children.length;r<a;++r){var o=e.children[r],s=t[o.name+"_asArray"];if(s)for(var l=0,u=s.length;l<u;++l){var c=s[l];n(e.properties,t,c),i(o,c)}}}return{run:function(t){if(null===t||"object"!==$n(t))return t;if(t.Period_asArray&&"period"in e)for(var n=e.period,r=t.Period_asArray,a=0,o=r.length;a<o;++a){var s=r[a];if(i(n,s),"adaptationset"in e){var l=s.AdaptationSet_asArray;if(l)for(var u=e.adaptationset,c=0,d=l.length;c<d;++c)i(u,l[c])}}return t}}}Xn.__dashjs_factory_name="ObjectIron";var Qn=c.Z.getClassFactory(Xn);function Jn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ei=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._test=t,this._converter=n}var t,n;return t=e,(n=[{key:"test",get:function(){return this._test}},{key:"converter",get:function(){return this._converter}}])&&Jn(t.prototype,n),e}();function ti(e){return ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ti(e)}function ni(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ii(e,t){return ii=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ii(e,t)}function ri(e,t){return!t||"object"!==ti(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ai(e){return ai=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ai(e)}var oi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ii(e,t)}(r,e);var t,n,i=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=ai(t);if(n){var r=ai(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return ri(this,e)});function r(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),i.call(this,function(e,t){var n,i=(ni(n={},o.Z.MPD,[o.Z.ID,o.Z.PROFILES]),ni(n,o.Z.PERIOD,[o.Z.ID]),ni(n,o.Z.BASE_URL,[o.Z.SERVICE_LOCATION,o.Z.BYTE_RANGE]),ni(n,o.Z.SEGMENT_BASE,[o.Z.INDEX_RANGE]),ni(n,o.Z.INITIALIZATION,[o.Z.RANGE]),ni(n,o.Z.REPRESENTATION_INDEX,[o.Z.RANGE]),ni(n,o.Z.SEGMENT_LIST,[o.Z.INDEX_RANGE]),ni(n,o.Z.BITSTREAM_SWITCHING,[o.Z.RANGE]),ni(n,o.Z.SEGMENT_URL,[o.Z.MEDIA_RANGE,o.Z.INDEX_RANGE]),ni(n,o.Z.SEGMENT_TEMPLATE,[o.Z.INDEX_RANGE,o.Z.MEDIA,o.Z.INDEX,o.Z.INITIALIZATION_MINUS,o.Z.BITSTREAM_SWITCHING_MINUS]),ni(n,o.Z.ASSET_IDENTIFIER,[o.Z.VALUE,o.Z.ID]),ni(n,o.Z.EVENT_STREAM,[o.Z.VALUE]),ni(n,o.Z.ADAPTATION_SET,[o.Z.PROFILES,o.Z.MIME_TYPE,o.Z.SEGMENT_PROFILES,o.Z.CODECS,o.Z.CONTENT_TYPE]),ni(n,o.Z.FRAME_PACKING,[o.Z.VALUE,o.Z.ID]),ni(n,o.Z.AUDIO_CHANNEL_CONFIGURATION,[o.Z.VALUE,o.Z.ID]),ni(n,o.Z.CONTENT_PROTECTION,[o.Z.VALUE,o.Z.ID]),ni(n,o.Z.ESSENTIAL_PROPERTY,[o.Z.VALUE,o.Z.ID]),ni(n,o.Z.SUPPLEMENTAL_PROPERTY,[o.Z.VALUE,o.Z.ID]),ni(n,o.Z.INBAND_EVENT_STREAM,[o.Z.VALUE,o.Z.ID]),ni(n,o.Z.ACCESSIBILITY,[o.Z.VALUE,o.Z.ID]),ni(n,o.Z.ROLE,[o.Z.VALUE,o.Z.ID]),ni(n,o.Z.RATING,[o.Z.VALUE,o.Z.ID]),ni(n,o.Z.VIEWPOINT,[o.Z.VALUE,o.Z.ID]),ni(n,o.Z.CONTENT_COMPONENT,[o.Z.CONTENT_TYPE]),ni(n,o.Z.REPRESENTATION,[o.Z.ID,o.Z.DEPENDENCY_ID,o.Z.MEDIA_STREAM_STRUCTURE_ID]),ni(n,o.Z.SUBSET,[o.Z.ID]),ni(n,o.Z.METRICS,[o.Z.METRICS_MINUS]),ni(n,o.Z.REPORTING,[o.Z.VALUE,o.Z.ID]),n);if(i.hasOwnProperty(t)){var r=i[t];return void 0!==r&&r.indexOf(e.name)>=0}return!1},function(e){return String(e)})}return r}(ei);function si(e){return si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},si(e)}function li(e,t){return li=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},li(e,t)}function ui(e,t){return!t||"object"!==si(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ci(e){return ci=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ci(e)}var di=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,fi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&li(e,t)}(r,e);var t,n,i=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=ci(t);if(n){var r=ci(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return ui(this,e)});function r(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),i.call(this,function(e){for(var t=[o.Z.MIN_BUFFER_TIME,o.Z.MEDIA_PRESENTATION_DURATION,o.Z.MINIMUM_UPDATE_PERIOD,o.Z.TIMESHIFT_BUFFER_DEPTH,o.Z.MAX_SEGMENT_DURATION,o.Z.MAX_SUBSEGMENT_DURATION,o.Z.SUGGESTED_PRESENTATION_DELAY,o.Z.START,a.Z.START_TIME,o.Z.DURATION],n=t.length,i=0;i<n;i++)if(e.nodeName===t[i])return di.test(e.value);return!1},function(e){var t=di.exec(e),n=31536e3*parseFloat(t[3]||0)+2592e3*parseFloat(t[5]||0)+86400*parseFloat(t[7]||0)+3600*parseFloat(t[9]||0)+60*parseFloat(t[11]||0)+parseFloat(t[13]||0);return void 0!==t[1]&&(n=-n),n})}return r}(ei);function hi(e){return hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hi(e)}function pi(e,t){return pi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},pi(e,t)}function gi(e,t){return!t||"object"!==hi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mi(e){return mi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},mi(e)}var vi=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/,yi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pi(e,t)}(r,e);var t,n,i=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=mi(t);if(n){var r=mi(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return gi(this,e)});function r(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),i.call(this,function(e){return vi.test(e.value)},function(e){var t,n=vi.exec(e);if(t=Date.UTC(parseInt(n[1],10),parseInt(n[2],10)-1,parseInt(n[3],10),parseInt(n[4],10),parseInt(n[5],10),n[6]&&parseInt(n[6],10)||0,n[7]&&1e3*parseFloat(n[7])||0),n[9]&&n[10]){var i=60*parseInt(n[9],10)+parseInt(n[10],10);t+=("+"===n[8]?-1:1)*i*60*1e3}return new Date(t)})}return r}(ei);function _i(e){return _i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_i(e)}function bi(e,t){return bi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},bi(e,t)}function Ei(e,t){return!t||"object"!==_i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ti(e){return Ti=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ti(e)}var Si=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,wi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bi(e,t)}(r,e);var t,n,i=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=Ti(t);if(n){var r=Ti(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return Ei(this,e)});function r(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),i.call(this,function(e){return Si.test(e.value)},function(e){return parseFloat(e)})}return r}(ei);function Ai(e){return Ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ai(e)}function Ii(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xi(e,t){return xi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},xi(e,t)}function Ri(e,t){return!t||"object"!==Ai(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ci(e){return Ci=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ci(e)}var Di=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xi(e,t)}(r,e);var t,n,i=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=Ci(t);if(n){var r=Ci(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return Ri(this,e)});function r(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),i.call(this,function(e,t){var n,i=(Ii(n={},o.Z.ADAPTATION_SET,[o.Z.LANG]),Ii(n,o.Z.REPRESENTATION,[o.Z.LANG]),Ii(n,o.Z.CONTENT_COMPONENT,[o.Z.LANG]),Ii(n,o.Z.LABEL,[o.Z.LANG]),Ii(n,o.Z.GROUP_LABEL,[o.Z.LANG]),n);if(i.hasOwnProperty(t)){var r=i[t];return void 0!==r&&r.indexOf(e.name)>=0}return!1},function(e){return bn()(e)||String(e)})}return r}(ei);function ki(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Mi=function(){function e(t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=t,this._merge=(n=t)&&n.length&&n.charAt(0)===n.charAt(0).toUpperCase()}var t,n;return t=e,(n=[{key:"name",get:function(){return this._name}},{key:"merge",get:function(){return this._merge}}])&&ki(t.prototype,n),e}();function Li(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Pi=function(){function e(t,n,i){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=t||"",this._properties=[],this._children=i||[],Array.isArray(n)&&n.forEach(function(e){r._properties.push(new Mi(e))})}var t,n;return t=e,(n=[{key:"name",get:function(){return this._name}},{key:"children",get:function(){return this._children}},{key:"properties",get:function(){return this._properties}}])&&Li(t.prototype,n),e}();function Ni(e){return Ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ni(e)}function Oi(e,t){return Oi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Oi(e,t)}function Fi(e,t){return!t||"object"!==Ni(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ui(e){return Ui=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ui(e)}var Bi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oi(e,t)}(r,e);var t,n,i=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=Ui(t);if(n){var r=Ui(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return Fi(this,e)});function r(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);var e=[o.Z.PROFILES,o.Z.WIDTH,o.Z.HEIGHT,o.Z.SAR,o.Z.FRAMERATE,o.Z.AUDIO_SAMPLING_RATE,o.Z.MIME_TYPE,o.Z.SEGMENT_PROFILES,o.Z.CODECS,o.Z.MAXIMUM_SAP_PERIOD,o.Z.START_WITH_SAP,o.Z.MAX_PLAYOUT_RATE,o.Z.CODING_DEPENDENCY,o.Z.SCAN_TYPE,o.Z.FRAME_PACKING,o.Z.AUDIO_CHANNEL_CONFIGURATION,o.Z.CONTENT_PROTECTION,o.Z.ESSENTIAL_PROPERTY,o.Z.ESSENTIAL_PROPERTY+"_asArray",o.Z.SUPPLEMENTAL_PROPERTY,o.Z.INBAND_EVENT_STREAM];return i.call(this,o.Z.ADAPTATION_SET,e,[new Pi(o.Z.REPRESENTATION,e,[new Pi(o.Z.SUB_REPRESENTATION,e)])])}return r}(Pi);function Gi(e){return Gi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gi(e)}function ji(e,t){return ji=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ji(e,t)}function Vi(e,t){return!t||"object"!==Gi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Hi(e){return Hi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Hi(e)}var Ki=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ji(e,t)}(r,e);var t,n,i=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=Hi(t);if(n){var r=Hi(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return Vi(this,e)});function r(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);var e=[o.Z.SEGMENT_BASE,o.Z.SEGMENT_TEMPLATE,o.Z.SEGMENT_LIST];return i.call(this,o.Z.PERIOD,e,[new Pi(o.Z.ADAPTATION_SET,e,[new Pi(o.Z.REPRESENTATION,e)])])}return r}(Pi);function zi(e){e=e||{};var t,n,i,r,a,o=this.context,s=e.debug;return t={parse:function(e){var t,i=window.performance.now();if(!(t=r.xml_str2json(e)))throw new Error("parsing the manifest failed");var o=window.performance.now();t.Patch?((t=t.Patch).add_asArray&&t.add_asArray.forEach(function(e){return a.run(e)}),t.replace_asArray&&t.replace_asArray.forEach(function(e){return a.run(e)})):(t=t.MPD,a.run(t));var s=window.performance.now();return n.info("Parsing complete: ( xml2json: "+(o-i).toPrecision(3)+"ms, objectiron: "+(s-o).toPrecision(3)+"ms, total: "+((s-i)/1e3).toPrecision(3)+"s)"),t.protocol="DASH",t},getMatchers:function(){return i},getIron:function(){return a}},n=s.getLogger(t),i=[new fi,new yi,new wi,new Di,new oi],r=new Zn({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!0,ignoreRoot:!1,matchers:i}),a=Qn(o).create({adaptationset:new Bi,period:new Ki}),t}zi.__dashjs_factory_name="DashParser";var Zi=c.Z.getClassFactory(zi);function qi(e){e=e||{};var t,n,i,r,s,c=this.context,d=e.debug,f=e.settings,h=(0,l.Z)(c).getInstance(),p=(0,X.Z)(c).getInstance(),g=e.mssHandler,m=e.errHandler;function v(e){h.trigger(u.Z.INTERNAL_MANIFEST_LOADED,{manifest:e.manifest})}function y(e){var t=null;return e.indexOf("SmoothStreamingMedia")>-1?(g&&(t=g.createMssParser(),g.createMssFragmentProcessor(),g.registerEvents()),t):e.indexOf("MPD")>-1||e.indexOf("Patch")>-1?Zi(c).create({debug:d}):t}return t={load:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=new Date,l=new Hn(e,C.w.MPD_TYPE);t&&(l.serviceLocation=t),a&&(l.queryParams=a),l.requestStartDate||(l.requestStartDate=o),h.trigger(u.Z.MANIFEST_LOADING_STARTED,{request:l}),i.load({request:l,success:function(t,i,a){var o,l,c;if(r)if(a&&a!==e?(l=p.parseBaseUrl(a),o=a):(p.isRelative(e)&&(e=p.resolve(e,window.location.href)),l=p.parseBaseUrl(e)),"No Content"!=i)if(null===s&&(s=y(t)),null!==s){r.setMatchers(s.getMatchers()),r.setIron(s.getIron());try{c=s.parse(t)}catch(t){return void h.trigger(u.Z.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new T.Z(x.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,x.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(e))})}if(c){if(c.url=o||e,c.originalUrl||(c.originalUrl=c.url),f&&f.get().streaming.enableManifestDurationMismatchFix&&c.mediaPresentationDuration&&c.Period_asArray.length>1){var d=c.Period_asArray.reduce(function(e,t){return e+t.duration},0);!isNaN(d)&&c.mediaPresentationDuration>d&&(n.warn("Media presentation duration greater than duration of all periods. Setting duration to total period duration"),c.mediaPresentationDuration=d)}c.baseUri=l,c.loadedTime=new Date,r.resolveManifestOnLoad(c),h.trigger(u.Z.ORIGINAL_MANIFEST_LOADED,{originalManifest:t})}else h.trigger(u.Z.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new T.Z(x.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,x.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(e))})}else h.trigger(u.Z.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new T.Z(x.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,x.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(e))});else h.trigger(u.Z.INTERNAL_MANIFEST_LOADED,{manifest:null})},error:function(t,n,i){h.trigger(u.Z.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new T.Z(x.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE,x.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE+"".concat(e,", ").concat(i))})}})},reset:function(){h.off(u.Z.XLINK_READY,v,t),g&&g.reset(),r&&(r.reset(),r=null),i&&(i.abort(),i=null)}},n=d.getLogger(t),h.on(u.Z.XLINK_READY,v,t),i=Tt(c).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,urlUtils:p,constants:a.Z,dashConstants:o.Z,errors:x,requestTimeout:e.settings.get().streaming.manifestRequestTimeout}),r=Wn(c).create({errHandler:m,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,settings:e.settings}),s=null,t}qi.__dashjs_factory_name="ManifestLoader";var Yi=c.Z.getClassFactory(qi);function Wi(){var e=this.context,t=(0,l.Z)(e).getInstance();return{error:function(e){t.trigger(u.Z.ERROR,{error:e})}}}Wi.__dashjs_factory_name="ErrorHandler";var $i=c.Z.getSingletonFactory(Wi),Xi=n(1715);function Qi(){var e,t,n,i,r,o,s=this.context,c=(0,l.Z)(s).getInstance();function f(e,i){if(!i||!i.Period_asArray||0===i.Period_asArray.length)return Promise.resolve();var r=[];return i.Period_asArray.forEach(function(i){r.push(function(e,i){return new Promise(function(r){if(e&&e.AdaptationSet_asArray&&0!==e.AdaptationSet_asArray.length){var s=[];e.AdaptationSet_asArray.forEach(function(e){t.getIsTypeOf(e,i)&&s.push(function(e,i){return new Promise(function(r){if(e.Representation_asArray&&0!==e.Representation_asArray.length){var s=[],l=[];e.Representation_asArray.forEach(function(r,o){var u=t.getCodec(e,o,!1),c=function(e,t,n){switch(e){case a.Z.VIDEO:return function(e,t){return{codec:t,width:e.width||null,height:e.height||null,framerate:e.frameRate||null,bitrate:e.bandwidth||null}}(t,n);case a.Z.AUDIO:return function(e,t){var n=e.audioSamplingRate||null;return{codec:t,bitrate:e.bandwidth||null,samplerate:n}}(t,n);default:return null}}(i,r,u);l.push(c),s.push(n.supportsCodec(c,i))}),Promise.all(s).then(function(t){e.Representation_asArray=e.Representation_asArray.filter(function(e,n){return t[n]||o.debug("[Stream] Codec ".concat(l[n].codec," not supported ")),t[n]}),r()}).catch(function(){r()})}else r()})}(e,i))}),Promise.all(s).then(function(){e.AdaptationSet_asArray=e.AdaptationSet_asArray.filter(function(e){var t=e.Representation_asArray&&e.Representation_asArray.length>0;return t||(c.trigger(u.Z.ADAPTATION_SET_REMOVED_NO_CAPABILITIES,{adaptationSet:e}),o.warn("AdaptationSet has been removed because of no supported Representation")),t}),r()}).catch(function(){r()})}else r()})}(i,e))}),Promise.all(r)}return e={setConfig:function(e){e&&(e.adapter&&(t=e.adapter),e.capabilities&&(n=e.capabilities),e.settings&&(i=e.settings),e.customParametersModel&&(r=e.customParametersModel))},filterUnsupportedFeatures:function(e){return new Promise(function(s){var l=[];l.push(f(a.Z.VIDEO,e)),l.push(f(a.Z.AUDIO,e)),Promise.all(l).then(function(){i.get().streaming.capabilities.filterUnsupportedEssentialProperties&&function(e){e&&e.Period_asArray&&0!==e.Period_asArray.length&&e.Period_asArray.forEach(function(e){e.AdaptationSet_asArray=e.AdaptationSet_asArray.filter(function(e){return!e.Representation_asArray||0===e.Representation_asArray.length||(e.Representation_asArray=e.Representation_asArray.filter(function(e){var i=t.getEssentialPropertiesForRepresentation(e);if(i&&i.length>0)for(var r=0;r<i.length;){if(!n.supportsEssentialProperty(i[r]))return o.debug("[Stream] EssentialProperty not supported: "+i[r].schemeIdUri),!1;r+=1}return!0}),e.Representation_asArray&&e.Representation_asArray.length>0)})})}(e),function(e){var t=r.getCustomCapabilitiesFilters();t&&0!==t.length&&e&&e.Period_asArray&&0!==e.Period_asArray.length&&e.Period_asArray.forEach(function(e){e.AdaptationSet_asArray=e.AdaptationSet_asArray.filter(function(e){return!e.Representation_asArray||0===e.Representation_asArray.length||(e.Representation_asArray=e.Representation_asArray.filter(function(e){return!t.some(function(t){return!t(e)})}),e.Representation_asArray&&e.Representation_asArray.length>0)})})}(e),s()}).catch(function(){s()})})}},o=(0,d.Z)(s).getInstance().getLogger(e),e}Qi.__dashjs_factory_name="CapabilitiesFilter";var Ji=c.Z.getSingletonFactory(Qi),er=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null,this.r=null};function tr(){var e;return{initialize:function(t){if(e=new er,!t)return null;var n=t.indexOf("#");if(-1!==n)for(var i=t.substr(n+1).split("&"),r=0,a=i.length;r<a;++r){var o=i[r],s=o.indexOf("=");if(-1!==s){var l=o.substring(0,s);e.hasOwnProperty(l)&&(e[l]=o.substr(s+1))}}},getURIFragmentData:function(){return e}}}tr.__dashjs_factory_name="URIFragmentModel";var nr=c.Z.getSingletonFactory(tr);function ir(){var e,t=this.context,n=(0,l.Z)(t).getInstance();return{getValue:function(){return e},setValue:function(t){e=t,t&&n.trigger(u.Z.MANIFEST_LOADED,{data:t})}}}ir.__dashjs_factory_name="ManifestModel";var rr=c.Z.getSingletonFactory(ir),ar=-.5;function or(){var e,t,n,i,r=this.context,a=(0,R.Z)(r).getInstance();function o(e,n){return isNaN(e)?0:e>0?(n&&t.warn("Supplied minimum playback rate is a positive value when it should be negative or 0. The supplied rate will not be applied and set to 0: 100% playback speed."),0):e<ar?(n&&t.warn("Supplied minimum playback rate is out of range and will be limited to ".concat(ar,": ").concat(-50,"% playback speed.")),ar):e}function s(e,n){return isNaN(e)?0:e<0?(n&&t.warn("Supplied maximum playback rate is a negative value when it should be negative or 0. The supplied rate will not be applied and set to 0: 100% playback speed."),0):e>1?(n&&t.warn("Supplied maximum playback rate is out of range and will be limited to ".concat(1,": ").concat(200,"% playback speed.")),1):e}function l(){var e=a.get().streaming.buffer.stableBufferTime>0?a.get().streaming.buffer.stableBufferTime:a.get().streaming.buffer.fastSwitchEnabled?20:12,t=n.getLiveDelay();return!isNaN(t)&&t>0?Math.min(e,t):e}return e={getCatchupMaxDrift:function(){if(!isNaN(a.get().streaming.liveCatchup.maxDrift)&&a.get().streaming.liveCatchup.maxDrift>0)return a.get().streaming.liveCatchup.maxDrift;var e=i.getServiceDescriptionSettings();return e&&e.liveCatchup&&!isNaN(e.liveCatchup.maxDrift)&&e.liveCatchup.maxDrift>0?e.liveCatchup.maxDrift:12},getCatchupModeEnabled:function(){return null!==a.get().streaming.liveCatchup.enabled?a.get().streaming.liveCatchup.enabled:n.getInitialCatchupModeActivated()},getStableBufferTime:l,getInitialBufferLevel:function(){var e=a.get().streaming.buffer.initialBufferLevel;return isNaN(e)||e<0?0:Math.min(l(),e)},getRetryAttemptsForType:function(e){var t=isNaN(a.get().streaming.retryAttempts.lowLatencyMultiplyFactor)?5:a.get().streaming.retryAttempts.lowLatencyMultiplyFactor;return n.getLowLatencyModeEnabled()?a.get().streaming.retryAttempts[e]*t:a.get().streaming.retryAttempts[e]},getRetryIntervalsForType:function(e){var t=isNaN(a.get().streaming.retryIntervals.lowLatencyReductionFactor)?10:a.get().streaming.retryIntervals.lowLatencyReductionFactor;return n.getLowLatencyModeEnabled()?a.get().streaming.retryIntervals[e]/t:a.get().streaming.retryIntervals[e]},getCatchupPlaybackRates:function(e){var t=a.get().streaming.liveCatchup.playbackRate;if(!isNaN(t.min)||!isNaN(t.max))return{min:o(t.min,e),max:s(t.max,e)};var n=i.getServiceDescriptionSettings();if(n&&n.liveCatchup&&(!isNaN(n.liveCatchup.playbackRate.min)||!isNaN(n.liveCatchup.playbackRate.max))){var r=n.liveCatchup.playbackRate;return{min:o(r.min,e),max:s(r.max,e)}}return{min:-.5,max:.5}},getAbrBitrateParameter:function(e,t){try{var n=a.get().streaming.abr[e][t];if(!isNaN(n)&&-1!==n)return n;var r=i.getServiceDescriptionSettings();return r&&r[e]&&!isNaN(r[e][t])?r[e][t]:-1}catch(e){return-1}},setConfig:function(e){e.playbackController&&(n=e.playbackController),e.serviceDescriptionController&&(i=e.serviceDescriptionController)},reset:function(){}},t=(0,d.Z)(r).getInstance().getLogger(e),e}or.__dashjs_factory_name="MediaPlayerModel";var sr=c.Z.getSingletonFactory(or),lr=n(1767);function ur(e){var t=(e=e||{}).abrController,n=e.switchHistory,i=e.droppedFramesHistory,r=e.currentRequest,a=e.useBufferOccupancyABR,o=e.useL2AABR,s=e.useLoLPABR,l=e.streamProcessor?e.streamProcessor.getScheduleController():null,u=e.streamProcessor?e.streamProcessor.getRepresentationInfo():null,c=e.videoModel?e.videoModel:null;function d(){return u?u.mediaInfo:null}return{getMediaType:function(){var e=d();return e?e.type:null},getMediaInfo:d,getDroppedFramesHistory:function(){return i},getCurrentRequest:function(){return r},getSwitchHistory:function(){return n},getStreamInfo:function(){var e=d();return e?e.streamInfo:null},getScheduleController:function(){return l},getAbrController:function(){return t},getRepresentationInfo:function(){return u},useBufferOccupancyABR:function(){return a},useL2AABR:function(){return o},useLoLPABR:function(){return s},getVideoModel:function(){return c}}}ur.__dashjs_factory_name="RulesContext";var cr=c.Z.getClassFactory(ur),dr=n(2068);function fr(){var e=[],t=[];return{push:function(n){n.newValue===dr.Z.NO_CHANGE&&(n.newValue=n.oldValue),e[n.oldValue]||(e[n.oldValue]={noDrops:0,drops:0,dropSize:0});var i=n.newValue-n.oldValue,r=i<0?1:0,a=r?-i:0,o=r?0:1;if(e[n.oldValue].drops+=r,e[n.oldValue].dropSize+=a,e[n.oldValue].noDrops+=o,t.push({idx:n.oldValue,noDrop:o,drop:r,dropSize:a}),t.length>8){var s=t.shift();e[s.idx].drops-=s.drop,e[s.idx].dropSize-=s.dropSize,e[s.idx].noDrops-=s.noDrop}},getSwitchRequests:function(){return e},reset:function(){e=[],t=[]}}}fr.__dashjs_factory_name="SwitchRequestHistory";var hr=c.Z.getClassFactory(fr);function pr(){var e={},t={},n={};return{push:function(i,r,a){if(r){e[i]||(e[i]=[],t[i]=0,n[i]=0);var o=a&&a.droppedVideoFrames?a.droppedVideoFrames:0,s=a&&a.totalVideoFrames?a.totalVideoFrames:0,l=o-t[i];t[i]=o;var u=s-n[i];n[i]=s;var c=e[i];isNaN(r)||(c[r]?(c[r].droppedVideoFrames+=l,c[r].totalVideoFrames+=u):c[r]={droppedVideoFrames:l,totalVideoFrames:u})}},getFrameHistory:function(t){return e[t]},clearForStream:function(i){try{delete e[i],delete t[i],delete n[i]}catch(e){}},reset:function(){e={},t={},n={}}}}pr.__dashjs_factory_name="DroppedFramesHistory";var gr=c.Z.getClassFactory(pr);function mr(e){var t,n,i,r,o,s=this.context,u=(e=e||{}).settings,c=(0,l.Z)(s).getInstance();function d(e,t,n,i){var r=Math.pow(.5,n/i.fast);e.fastEstimate=(1-r)*t+r*e.fastEstimate;var a=Math.pow(.5,n/i.slow);e.slowEstimate=(1-a)*t+a*e.slowEstimate,e.totalWeight+=n}function h(e,s,l){return u.get().streaming.abr.movingAverageMethod!==a.Z.MOVING_AVERAGE_SLIDING_WINDOW?function(e,t){var n=e?o.throughputHalfLife:o.latencyHalfLife,a=e?i[t]:r[t];if(!a||a.totalWeight<=0)return NaN;var s=a.fastEstimate/(1-Math.pow(.5,a.totalWeight/n.fast)),l=a.slowEstimate/(1-Math.pow(.5,a.totalWeight/n.slow));return e?Math.min(s,l):Math.max(s,l)}(e,s):function(e,i,r){var a=function(e,i,r){var a,o;if(e?(a=t[i],o=r?3:4):(a=n[i],o=4),a){if(o>=a.length)o=a.length;else if(e)for(var s=1;s<o;++s){var l=a[a.length-s]/a[a.length-s-1];if((l>=1.3||l<=1/1.3)&&(o+=1)===a.length)break}}else o=0;return o}(e,i,r),o=(e?t:n)[i];return 0!==a&&o&&0!==o.length?(o=o.slice(-a)).reduce(function(e,t){return e+t})/o.length:NaN}(e,s,l)}function p(e,t){return h(!0,e,t)}function g(e){t[e]=t[e]||[],n[e]=n[e]||[],i[e]=i[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0},r[e]=r[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0}}function m(){t={},n={},i={},r={}}var v={push:function(e,s,l){if(s.trace&&s.trace.length){var h,p=s.tresponse.getTime()-s.trequest.getTime()||1,m=s._tfinish.getTime()-s.tresponse.getTime()||1,v=s.trace.reduce(function(e,t){return e+t.b[0]},0),y=0;if(0!==(h=s._fileLoaderType&&s._fileLoaderType===a.Z.FILE_LOADER_TYPES.FETCH?s.trace.reduce(function(e,t){return e+t.d},0):l?m:p+m)&&(y=Math.round(8*v/h)),s.cmsd){var _=s.cmsd.dynamic&&s.cmsd.dynamic.etp?s.cmsd.dynamic.etp:null;if(_){var b=u.get().streaming.cmsd.abr.etpWeightRatio;b>0&&b<=1&&(y=y*(1-b)+_*b)}}if(g(e),function(e,t,n){return e===a.Z.VIDEO?n<u.get().streaming.cacheLoadThresholds[a.Z.VIDEO]:e===a.Z.AUDIO?n<u.get().streaming.cacheLoadThresholds[a.Z.AUDIO]:void 0}(e,0,m)){if(t[e].length>0&&!t[e].hasCachedEntries)return;t[e].hasCachedEntries=!0}else t[e]&&t[e].hasCachedEntries&&function(e){delete t[e],delete n[e],delete i[e],delete r[e],g(e)}(e);t[e].push(y),c.trigger(f.Z.THROUGHPUT_MEASUREMENT_STORED,{throughput:y,mediaType:e,httpRequest:s}),t[e].length>20&&t[e].shift(),n[e].push(p),n[e].length>20&&n[e].shift(),d(i[e],y,.001*m,o.throughputHalfLife),d(r[e],p,1,o.latencyHalfLife)}},getAverageThroughput:p,getSafeAverageThroughput:function(e,t){var n=p(e,t);return isNaN(n)||(n*=u.get().streaming.abr.bandwidthSafetyFactor),n},getAverageLatency:function(e){return h(!1,e)},reset:m};return o={throughputHalfLife:{fast:3,slow:8},latencyHalfLife:{fast:1,slow:2}},m(),v}mr.__dashjs_factory_name="ThroughputHistory";var vr=c.Z.getClassFactory(mr);function yr(){var e,t,n,i,r,o,c,h,p,g,m,v,y,_,b,T,S,w,A,I,x,R,D,k,M,L,P,N=this.context,O=(0,d.Z)(N).getInstance(),F=(0,l.Z)(N).getInstance();function U(){r={},o={},h={},c={},I={},D={},k={},M={},void 0===g&&(g=!1),x&&x.reset(),A=void 0,x=void 0,R=void 0,clearTimeout(p),p=null}function B(t){var r=t.request.mediaType,a=t.streamId;if(r&&a&&c[a]&&P.get().streaming.abr.autoSwitchBitrate[r]){var o=c[a][r];if(o){var l=cr(N).create({abrController:e,streamProcessor:o,currentRequest:t.request,useBufferOccupancyABR:D[r],useL2AABR:k[r],useLoLPABR:M[r],videoModel:_}),u=n.shouldAbandonFragment(l,a);u.quality>dr.Z.NO_CHANGE&&o.getFragmentModel().getRequests({state:E.FRAGMENT_MODEL_LOADING,index:t.request.index})[0]&&(h[a][r].state=s.Z.ABANDON_LOAD,I[a][r].reset(),I[a][r].push({oldValue:K(r,a),newValue:u.quality,confidence:1,reason:u.reason}),z(r,i.getActiveStreamInfo(),u.quality,u.reason),clearTimeout(p),p=setTimeout(function(){h[a][r].state=s.Z.ALLOW_LOAD,p=null},P.get().streaming.abandonLoadTimeout))}}}function G(e){e.mediaType===a.Z.VIDEO&&(void 0!==A&&x.push(e.streamId,A,_.getPlaybackQuality()),A=e.newQuality)}function j(e){var n,i;e.metric!==s.Z.HTTP_REQUEST||!e.value||e.value.type!==C.w.MEDIA_SEGMENT_TYPE||e.mediaType!==a.Z.AUDIO&&e.mediaType!==a.Z.VIDEO||R.push(e.mediaType,e.value,P.get().streaming.abr.useDeadTimeLatency),e.metric!==s.Z.BUFFER_LEVEL||e.mediaType!==a.Z.AUDIO&&e.mediaType!==a.Z.VIDEO||(n=e.mediaType,i=.001*e.value.level,P.get().streaming.abr.ABRStrategy===a.Z.ABR_STRATEGY_DYNAMIC&&function(e,n){try{var i=b.getStableBufferTime(),r=i,a=.5*i,o=D[e],s=n>(o?a:r);D[e]=s,s!==o&&(s?t.info("["+e+"] switching from throughput to buffer occupancy ABR rule (buffer: "+n.toFixed(3)+")."):t.info("["+e+"] switching from buffer occupancy to throughput ABR rule (buffer: "+n.toFixed(3)+")."))}catch(e){t.error(e)}}(n,i))}function V(e,n){try{var i;return r[n]=r[n]||{},r[n].hasOwnProperty(e)||(r[n][e]=0),i=function(e,t){var n=r[t][e],i=n;if(!c[t]||!c[t][e])return i;var a=H(e,t);void 0!==a&&(i=Math.max(n,a));var o=function(e,t){try{var n=b.getAbrBitrateParameter("maxBitrate",e);return n>-1?W(c[t][e].getMediaInfo(),n,t):void 0}catch(e){return}}(e,t);return void 0!==o&&(i=Math.min(i,o)),i}(e,n),i=function(e,t,n){var i=r[n][t],a=P.get().streaming.abr.maxRepresentationRatio[t];return isNaN(a)||a>=1||a<0?e:Math.min(e,Math.round(i*a))}(i,e,n),i=function(e,t,n){if(t!==a.Z.VIDEO||!P.get().streaming.abr.limitBitrateByPortal||!c[n]||!c[n][t])return e;g||X();var i=c[n][t].getStreamInfo(),r=y.getAdaptationForType(i.index,t,i).Representation_asArray,o=e;if(m>0&&v>0){for(;o>0&&r[o]&&m<r[o].width&&m-r[o-1].width<r[o].width-m;)o-=1;for(;o<r.length-1&&r[o].width===r[o+1].width;)o+=1}return o}(i,e,n),P.get().streaming.cmsd.enabled&&P.get().streaming.cmsd.abr.applyMb&&(i=function(e,n,i){if("video"!==n)return e;var r=S.getMaxBitrate(n);if(r<0)return e;var a=q(i,"audio",K("audio",i));r-=a?a.bitrate/1e3:0;var o=W(c[i][n].getMediaInfo(),r,i);return t.debug("Stream ID: "+i+" ["+n+"] Apply max bit rate from CMSD: "+r),Math.min(e,o)}(i,e,n)),i}catch(e){return}}function H(e,t){try{return function(e,t){try{var n=b.getAbrBitrateParameter("minBitrate",e);if(n>-1){var i=c[t][e].getMediaInfo(),r=$(i),a=W(i,n,t);return r[a]&&a<r.length-1&&r[a].bitrate<1e3*n&&a++,a}return}catch(e){return}}(e,t)}catch(e){return}}function K(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{return t||(t=i.getActiveStreamInfo().id),e&&c[t]&&c[t][e]&&t?(o[t]=o[t]||{},o[t].hasOwnProperty(e)||(o[t][e]=0),o[t][e]):0}catch(e){return 0}}function z(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(t&&t.id&&e){var r=t.id,a=K(e,r);(0,Y.SE)(n);var o=V(e,r);n!==a&&n>=0&&n<=o&&Z(e,a,n,o,i,r)}}function Z(e,n,i,r,a,s){if(e&&c[s]&&c[s][e]){var l=c[s][e].getStreamInfo(),d=l&&l.manifestInfo&&l.manifestInfo.isDynamic,f=L.getCurrentBufferLevel(e);t.info("Stream ID: "+s+" ["+e+"] switch from "+n+" to "+i+"/"+r+" (buffer: "+f+") "+(a?JSON.stringify(a):".")),o[s]=o[s]||{},o[s][e]=i;var h=q(s,e,i);F.trigger(u.Z.QUALITY_CHANGE_REQUESTED,{oldQuality:n,newQuality:i,reason:a,streamInfo:l,bitrateInfo:h,maxIdx:r,mediaType:e},{streamId:l.id,mediaType:e});var p=R.getAverageThroughput(e,d);isNaN(p)||w.setSavedBitrateSettings(e,p)}}function q(e,t,n){if(t&&c&&c[e]&&c[e][t]){var i=$(c[e][t].getMediaInfo());return i[n]?i[n]:null}return null}function W(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=e&&e.type?c[n][e.type].getRepresentationInfo():null;if(P.get().streaming.abr.useDeadTimeLatency&&i&&r&&r.fragmentDuration){i/=1e3;var a=r.fragmentDuration;if(i>a)return 0;var o=i/a;t*=1-o}for(var s=$(e),l=s.length-1;l>=0;l--){var u=s[l];if(1e3*t>=u.bitrate)return l}return 0}function $(e){var t=[];if(!e||!e.bitrateList)return t;for(var n,i=e.bitrateList,r=e.type,a=0,o=i.length;a<o;a++)(n=new Nt).mediaType=r,n.qualityIndex=a,n.bitrate=i[a].bandwidth,n.width=i[a].width,n.height=i[a].height,n.scanType=i[a].scanType,t.push(n);return t}function X(){if(_){var e=P.get().streaming.abr.usePixelRatioInLimitBitrateByPortal&&window.hasOwnProperty("devicePixelRatio")?window.devicePixelRatio:1;m=_.getClientWidth()*e,v=_.getClientHeight()*e}}return e={initialize:function(){x=gr(N).create(),R=vr(N).create({settings:P}),(n=(0,lr.Z)(N).create({dashMetrics:L,customParametersModel:T,mediaPlayerModel:b,settings:P})).initialize(),F.on(f.Z.QUALITY_CHANGE_RENDERED,G,e),F.on(f.Z.METRIC_ADDED,j,e),F.on(u.Z.LOADING_PROGRESS,B,e)},isPlayingAtTopQuality:function(e){var t=e?e.id:null,n=K(a.Z.AUDIO,t),i=K(a.Z.VIDEO,t);return n===V(a.Z.AUDIO,t)&&i===V(a.Z.VIDEO,t)},updateTopQualityIndex:function(e){var t=e.type,n=e.streamInfo.id,i=e.representationCount-1;return r[n]=r[n]||{},r[n][t]=i,i},clearDataForStream:function(e){x&&x.clearForStream(e),c[e]&&delete c[e],I[e]&&delete I[e],h[e]&&delete h[e]},getThroughputHistory:function(){return R},getBitrateList:$,getQualityForBitrate:W,getTopBitrateInfoFor:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t||(t=i.getActiveStreamInfo().id),e&&c&&c[t]&&c[t][e]){var n=V(e,t),r=$(c[t][e].getMediaInfo());return r[n]?r[n]:null}return null},getMinAllowedIndexFor:H,getMaxAllowedIndexFor:V,getInitialBitrateFor:function(e,t){if(function(){if(!w||!w.hasOwnProperty("getSavedBitrateSettings"))throw new Error(a.Z.MISSING_CONFIG_ERROR)}(),e===a.Z.TEXT)return NaN;var n=w.getSavedBitrateSettings(e),i=b.getAbrBitrateParameter("initialBitrate",e),r=P.get().streaming.abr.initialRepresentationRatio[e];if(-1===i)if(r>-1){var o=c[t][e].getStreamInfo(),s=y.getAdaptationForType(o.index,e,o).Representation_asArray;i=Array.isArray(s)?s[Math.max(Math.round(s.length*r)-1,0)].bandwidth/1e3:0}else i=isNaN(n)?e===a.Z.VIDEO?1e3:100:n;return i},getQualityFor:K,getAbandonmentStateFor:function(e,t){return h[e]&&h[e][t]?h[e][t].state:null},setPlaybackQuality:z,checkPlaybackQuality:function(t,i){try{if(!(t&&c&&c[i]&&c[i][t]))return!1;if(x){var r=_.getPlaybackQuality();r&&x.push(i,A,r)}if(!P.get().streaming.abr.autoSwitchBitrate[t])return!1;var a=K(t,i),o=cr(N).create({abrController:e,switchHistory:I[i][t],droppedFramesHistory:x,streamProcessor:c[i][t],currentValue:a,useBufferOccupancyABR:D[t],useL2AABR:k[t],useLoLPABR:M[t],videoModel:_}),l=H(t,i),u=V(t,i),d=n.getMaxQuality(o),f=d.quality;return void 0!==l&&(f>dr.Z.NO_CHANGE?f:a)<l&&(f=l),f>u&&(f=u),I[i][t].push({oldValue:a,newValue:f}),f>dr.Z.NO_CHANGE&&f!==a&&(h[i][t].state===s.Z.ALLOW_LOAD||f<a)&&(Z(t,a,f,u,d.reason,i),!0)}catch(e){return!1}},setElementSize:X,setWindowResizeEventCalled:function(e){g=e},registerStreamType:function(e,t){var n=t.getStreamInfo().id;c[n]||(c[n]={}),I[n]||(I[n]={}),h[n]||(h[n]={}),I[n][e]=hr(N).create(),c[n][e]=t,h[n][e]={},h[n][e].state=s.Z.ALLOW_LOAD,function(e){var t=P.get().streaming.abr.ABRStrategy;t===a.Z.ABR_STRATEGY_L2A?(D[e]=!1,M[e]=!1,k[e]=!0):t===a.Z.ABR_STRATEGY_LoLP?(D[e]=!1,M[e]=!0,k[e]=!1):t===a.Z.ABR_STRATEGY_BOLA?(D[e]=!0,M[e]=!1,k[e]=!1):t===a.Z.ABR_STRATEGY_THROUGHPUT?(D[e]=!1,M[e]=!1,k[e]=!1):t===a.Z.ABR_STRATEGY_DYNAMIC&&(D[e]=!(!D||!D[e])&&D[e],M[e]=!1,k[e]=!1)}(e),e===a.Z.VIDEO&&X()},unRegisterStreamType:function(e,t){try{c[e]&&c[e][t]&&delete c[e][t],I[e]&&I[e][t]&&delete I[e][t],h[e]&&h[e][t]&&delete h[e][t]}catch(e){}},setConfig:function(e){e&&(e.streamController&&(i=e.streamController),e.domStorage&&(w=e.domStorage),e.mediaPlayerModel&&(b=e.mediaPlayerModel),e.customParametersModel&&(T=e.customParametersModel),e.cmsdModel&&(S=e.cmsdModel),e.dashMetrics&&(L=e.dashMetrics),e.adapter&&(y=e.adapter),e.videoModel&&(_=e.videoModel),e.settings&&(P=e.settings))},reset:function(){U(),F.off(u.Z.LOADING_PROGRESS,B,e),F.off(f.Z.QUALITY_CHANGE_RENDERED,G,e),F.off(f.Z.METRIC_ADDED,j,e),n&&n.reset()}},t=O.getLogger(e),U(),e}yr.__dashjs_factory_name="AbrController";var _r=c.Z.getSingletonFactory(yr);_r.QUALITY_DEFAULT=0,c.Z.updateSingletonFactory(yr.__dashjs_factory_name,_r);var br=_r,Er=new Map([[a.Z.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,"loadedmetadata"],[a.Z.VIDEO_ELEMENT_READY_STATES.HAVE_CURRENT_DATA,"loadeddata"],[a.Z.VIDEO_ELEMENT_READY_STATES.HAVE_FUTURE_DATA,"canplay"],[a.Z.VIDEO_ELEMENT_READY_STATES.HAVE_ENOUGH_DATA,"canplaythrough"]]);function Tr(){var e,t,n,i,r,o,s,c,f=this.context,h=(0,l.Z)(f).getInstance(),p=[];function g(){n&&(n.playbackRate=1,n.removeEventListener("canplay",g))}function m(){return p.length>0}function v(){if(n&&m()&&0===n.playbackRate){var e=document.createEvent("Event");e.initEvent("waiting",!0,!1),n.dispatchEvent(e)}}function y(e,t){n&&n.addEventListener(e,t)}function _(e,t){n&&n.removeEventListener(e,t)}function b(){return n?n.readyState:NaN}function E(){return n?n.buffered:null}function T(e,t,i,r,a){if(n)for(var o=0;o<n.textTracks.length;o++)if(n.textTracks[o].kind===e&&(!t||n.textTracks[o].label==t)&&n.textTracks[o].language===i&&n.textTracks[o].isTTML===r&&n.textTracks[o].isEmbedded===a)return n.textTracks[o];return null}function S(e,t){return e===a.Z.VIDEO_ELEMENT_READY_STATES.HAVE_NOTHING||b()>=e?(t(),null):function(e,t){var n=function n(){_(e,n),t(e)};return y(e,n),{func:n,event:e}}(Er.get(e),t)}return e={addEventListener:y,addTextTrack:function(e,t,i,r,a){if(!n)return null;var o=T(e,t,i,r,a);return o||((o=n.addTextTrack(e,t,i)).isEmbedded=a,o.isTTML=r),o},appendChild:function(e){n&&(n.appendChild(e),void 0!==e.isTTML&&(n.textTracks[n.textTracks.length-1].isTTML=e.isTTML,n.textTracks[n.textTracks.length-1].isEmbedded=e.isEmbedded))},getBufferRange:E,getClientHeight:function(){return n?n.clientHeight:NaN},getClientWidth:function(){return n?n.clientWidth:NaN},getElement:function(){return n},getEnded:function(){return n?n.ended:null},getPlaybackQuality:function(){if(!n)return null;var e="webkitDroppedFrameCount"in n&&"webkitDecodedFrameCount"in n,t=null;return"getVideoPlaybackQuality"in n?t=n.getVideoPlaybackQuality():e&&(t={droppedVideoFrames:n.webkitDroppedFrameCount,totalVideoFrames:n.webkitDroppedFrameCount+n.webkitDecodedFrameCount,creationTime:new Date}),t},getPlaybackRate:function(){return n?n.playbackRate:null},getPlayedRanges:function(){return n?n.played:null},getReadyState:b,getSource:function(){return n?n.src:null},getTTMLRenderingDiv:function(){return o},getTextTrack:T,getTextTracks:function(){return n?n.textTracks:[]},getTime:function(){return n?isNaN(i)?n.currentTime:i:null},getVideoHeight:function(){return n?n.videoHeight:NaN},getVideoRelativeOffsetLeft:function(){if(n){var e=n.parentNode.host||n.parentNode;return e?n.getBoundingClientRect().left-e.getBoundingClientRect().left:NaN}return NaN},getVideoRelativeOffsetTop:function(){if(n){var e=n.parentNode.host||n.parentNode;return e?n.getBoundingClientRect().top-e.getBoundingClientRect().top:NaN}return NaN},getVideoWidth:function(){return n?n.videoWidth:NaN},getVttRenderingDiv:function(){return s},initialize:function(){h.on(u.Z.PLAYBACK_PLAYING,v,this)},isPaused:function(){return n?n.paused:null},isSeeking:function(){return n?n.seeking||!isNaN(i):null},isStalled:m,pause:function(){n&&(n.pause(),n.autoplay=!1)},play:function(){if(n){n.autoplay=!0;var e=n.play();e&&e.catch&&"undefined"!=typeof Promise&&e.catch(function(e){"NotAllowedError"===e.name&&h.trigger(u.Z.PLAYBACK_NOT_ALLOWED),t.warn("Caught pending play exception - continuing (".concat(e,")"))})}},removeChild:function(e){n&&n.removeChild(e)},removeEventListener:_,reset:function(){clearTimeout(c),h.off(u.Z.PLAYBACK_PLAYING,v,this)},setCurrentTime:function(e,t){n&&(r&&r.func&&r.event&&_(r.event,r.func),i=e,r=S(a.Z.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,function(){if(n)if(n.currentTime!==i)try{i=t?function(e){var t=E(),n=e,i=9999999999;if(t)for(var r=0;r<t.length;r++){var a=t.start(r),o=t.end(r),s=Math.abs(a-e),l=Math.abs(o-e);if(e>=a&&e<=o)return e;s<i&&(i=s,n=a),l<i&&(i=l,n=o)}return n}(i):i,isNaN(i)||(n.currentTime=i),i=NaN}catch(e){0===n.readyState&&e.code===e.INVALID_STATE_ERR&&(c=setTimeout(function(){n.currentTime=i,i=NaN},400))}else i=NaN}))},setElement:function(e){if(!(null==e||e&&/^(VIDEO|AUDIO)$/i.test(e.nodeName)))throw"element is not video or audio DOM type!";(n=e)&&(n.preload="auto")},setPlaybackRate:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n&&(!t&&n.readyState<=2&&e>0?n.addEventListener("canplay",g):n.playbackRate=e)},setSource:function(e){n&&(e?n.src=e:(n.removeAttribute("src"),n.load()))},setStallState:function(e,t){!function(e,t){t?function(e){null!==e&&n&&!n.seeking&&-1===p.indexOf(e)&&p.push(e)}(e):function(e){var t=p.indexOf(e);null!==e&&-1!==t&&p.splice(t,1)}(e)}(e,t)},setTTMLRenderingDiv:function(e){(o=e).style.position="absolute",o.style.display="flex",o.style.overflow="hidden",o.style.pointerEvents="none",o.style.top=0,o.style.left=0},setVttRenderingDiv:function(e){s=e},waitForReadyState:S,setDisableRemotePlayback:function(e){n&&(n.disableRemotePlayback=e)}},t=(0,d.Z)(f).getInstance().getLogger(e),i=NaN,e}Tr.__dashjs_factory_name="VideoModel";var Sr=c.Z.getSingletonFactory(Tr),wr=[{oldKey:"dashjs_vbitrate",newKey:"dashjs_video_bitrate"},{oldKey:"dashjs_abitrate",newKey:"dashjs_audio_bitrate"},{oldKey:"dashjs_vsettings",newKey:"dashjs_video_settings"},{oldKey:"dashjs_asettings",newKey:"dashjs_audio_settings"}],Ar="dashjs_?_bitrate",Ir="dashjs_?_settings",xr="localStorage",Rr="lastBitrate",Cr="lastMediaSettings";function Dr(e){e=e||{};var t,n,i,r=this.context,o=e.settings;function s(e){if(void 0!==i)return i;var t;i=!1;try{"undefined"!=typeof window&&(t=window[e])}catch(e){return n.warn("DOMStorage access denied: "+e.message),i}if(!t||e!==xr&&"sessionStorage"!==e)return i;try{t.setItem("1","1"),t.removeItem("1"),i=!0}catch(e){n.warn("DOMStorage is supported, but cannot be used: "+e.message)}return i}function l(){var e=6e5;return Math.round((new Date).getTime()/e)*e}function u(e,t){return s(e)&&o.get().streaming[t+"CachingInfo"].enabled}function c(){if(!o)throw new Error(a.Z.MISSING_CONFIG_ERROR)}return t={getSavedBitrateSettings:function(e){if(c(),!o.get().streaming.lastBitrateCachingInfo.enabled)return NaN;var t=NaN;if(u(xr,Rr)){var i=Ar.replace(/\?/,e);try{var r=JSON.parse(localStorage.getItem(i))||{},a=(new Date).getTime()-parseInt(r.timestamp,10)>=o.get().streaming.lastBitrateCachingInfo.ttl||!1,s=parseFloat(r.bitrate);isNaN(s)||a?a&&localStorage.removeItem(i):(t=s,n.debug("Last saved bitrate for "+e+" was "+s))}catch(e){return null}}return t},setSavedBitrateSettings:function(e,t){if(u(xr,Rr)&&t){var i=Ar.replace(/\?/,e);try{localStorage.setItem(i,JSON.stringify({bitrate:t.toFixed(3),timestamp:l()}))}catch(e){n.error(e.message)}}},getSavedMediaSettings:function(e){if(c(),!o.get().streaming.lastMediaSettingsCachingInfo.enabled)return null;var t=null;if(u(xr,Cr)){var n=Ir.replace(/\?/,e);try{var i=JSON.parse(localStorage.getItem(n))||{},r=(new Date).getTime()-parseInt(i.timestamp,10)>=o.get().streaming.lastMediaSettingsCachingInfo.ttl||!1;t=i.settings,r&&(localStorage.removeItem(n),t=null)}catch(e){return null}}return t},setSavedMediaSettings:function(e,t){if(u(xr,Cr)){var i=Ir.replace(/\?/,e);try{localStorage.setItem(i,JSON.stringify({settings:t,timestamp:l()}))}catch(e){n.error(e.message)}}}},n=(0,d.Z)(r).getInstance().getLogger(t),s(xr)&&wr.forEach(function(e){var t=localStorage.getItem(e.oldKey);if(t){localStorage.removeItem(e.oldKey);try{localStorage.setItem(e.newKey,t)}catch(e){n.error(e.message)}}}),t}Dr.__dashjs_factory_name="DOMStorage";var kr=c.Z.getSingletonFactory(Dr),Mr=n(2032),Lr=n(2011);function Pr(){var e,t,n,i,r,a,o,s,l,u,c,d,f,h=this.context;function p(e,n,r,a){var o=null,l=e?f.resolve(e.path):null,u=a||{init:!0,url:l?l.url:void 0,range:{start:0,end:1500},searching:!1,bytesLoaded:0,bytesToLoad:1500,mediaType:n};t.debug("Start searching for initialization.");var c=y(u);s.load({request:c,success:function(t){if(u.bytesLoaded=u.range.end,!(o=i.findInitRange(t)))return u.range.end=u.bytesLoaded+u.bytesToLoad,p(e,n,r,u);e.range=o,r(e)},error:function(){r(e)}}),t.debug("Perform init search: "+u.url)}function m(e,n,r,a,o,l){if(r&&(void 0===r.start||void 0===r.end)){var u=r?r.toString().split("-"):null;r=u?{start:parseFloat(u[0]),end:parseFloat(u[1])}:null}o=o||v;var c=null,d=null,h=!!r,p=e?f.resolve(e.path):null,g={init:!1,url:p?p.url:void 0,range:h?r:{start:0,end:1500},searching:!h,bytesLoaded:l?l.bytesLoaded:0,bytesToLoad:1500,mediaType:n},_=y(g);s.load({request:_,success:function(r){var s=g.bytesToLoad,l=r.byteLength;if(g.bytesLoaded=g.range.end-g.range.start,c=i.parse(r),(d=c.getBox("sidx"))&&d.isComplete){var u,f,h=d.references;if(null!=h&&h.length>0&&(u=1===h[0].reference_type),u){var p,v,y,_;t.debug("Initiate multiple SIDX load."),g.range.end=g.range.start+d.size;var b=[],E=0,T=(d.offset||g.range.start)+d.size,S=function(t){t?(b=b.concat(t),++E>=v&&(b.sort(function(e,t){return e.startTime-t.startTime<0?-1:0}),o(b,e,a))):o(null,e,a)};for(p=0,v=h.length;p<v;p++)y=T,_=T+h[p].referenced_size-1,T+=h[p].referenced_size,m(e,n,{start:y,end:_},a,S,g)}else t.debug("Parsing segments from SIDX. representation "+n+" - id: "+e.id+" for range : "+g.range.start+" - "+g.range.end),f=function(e,t){for(var n,i,r,a,o=e.references,s=o.length,l=e.timescale,u=e.earliest_presentation_time,c=t.range.start+e.offset+e.first_offset+e.size,d=[],f=0;f<s;f++)r=o[f].subsegment_duration,a=o[f].referenced_size,(n=new Lr.Z).duration=r,n.startTime=u,n.timescale=l,i=c+a-1,n.mediaRange=c+"-"+i,d.push(n),u+=r,c+=a;return d}(d,g),o(f,e,a)}else{if(d)g.range.start=d.offset||g.range.start,g.range.end=g.range.start+(d.size||s);else{if(l<g.bytesLoaded)return void o(null,e,a);var w=c.getLastBox();w&&w.size?(g.range.start=w.offset+w.size,g.range.end=g.range.start+s):g.range.end+=s}m(e,n,g.range,a,null,g)}},error:function(){o(null,e,a)}}),t.debug("Perform SIDX load for type ".concat(n," : ").concat(g.url," with range ").concat(g.range.start," - ").concat(g.range.end))}function v(e,t,n){n({segments:e,representation:t,error:e?void 0:new T.Z(l.SEGMENT_BASE_LOADER_ERROR_CODE,l.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}function y(e){if(e.url){var t=new g.Z;return t.setInfo(e),t}}return e={setConfig:function(s){s.baseURLController&&(f=s.baseURLController),s.dashMetrics&&(a=s.dashMetrics),s.mediaPlayerModel&&(o=s.mediaPlayerModel),s.errHandler&&(n=s.errHandler),s.boxParser&&(i=s.boxParser),s.debug&&(t=s.debug.getLogger(e)),s.requestModifier&&(r=s.requestModifier),s.errors&&(l=s.errors),s.urlUtils&&(d=s.urlUtils),s.constants&&(u=s.constants),s.dashConstants&&(c=s.dashConstants)},initialize:function(){s=Tt(h).create({errHandler:n,dashMetrics:a,mediaPlayerModel:o,requestModifier:r,boxParser:i,errors:l,urlUtils:d,constants:u,dashConstants:c})},loadInitialization:function(e,t){return new Promise(function(n){p(e,t,n)})},loadSegments:function(e,t,n){return new Promise(function(i){m(e,t,n,i)})},reset:function(){s&&(s.abort(),s=null)}}}Pr.__dashjs_factory_name="SegmentBaseLoader";var Nr=c.Z.getSingletonFactory(Pr);function Or(e){var t;e=e||{};var n=new DataView(e.data),i=0;function r(e,t){var r=!0,a=0;if(void 0===t&&(t=!1),e.tag>16777215?(n.getUint32(i)!==e.tag&&(r=!1),a=4):e.tag>65535?(256*n.getUint16(i)+n.getUint8(i+2)!==e.tag&&(r=!1),a=3):e.tag>255?(n.getUint16(i)!==e.tag&&(r=!1),a=2):(n.getUint8(i)!==e.tag&&(r=!1),a=1),!r&&e.required&&!t)throw new Error("required tag not found");return r&&(i+=a),r}function a(e){var t=1,r=128,a=-1,o=0,s=n.getUint8(i),l=0;for(l=0;l<8;l+=1){if((s&r)===r){o=void 0===e?s&~r:s,a=l;break}r>>=1}for(l=0;l<a;l+=1,t+=1)o=o<<8|255&n.getUint8(i+t);return i+=t,o}return t={getPos:function(){return i},setPos:function(e){i=e},consumeTag:r,consumeTagAndSize:function(e,t){var n=r(e,t);return n&&a(),n},parseTag:function(e){var n;return r(e),n=a(),t[e.parse](n)},skipOverElement:function(e,t){var n,o=r(e,t);return o&&(n=a(),i+=n),o},getMatroskaCodedNum:a,getMatroskaFloat:function(e){var t;switch(e){case 4:t=n.getFloat32(i),i+=4;break;case 8:t=n.getFloat64(i),i+=8}return t},getMatroskaUint:function(e){if(e>4)return function(e){for(var t=Math.floor(Number.MAX_SAFE_INTEGER/256),r=0,a=0;a<e;a+=1){if(r>t)throw new Error("Value exceeds safe integer limit");r*=256;var o=n.getUint8(i+a);if(r>Number.MAX_SAFE_INTEGER-o)throw new Error("Value exceeds safe integer limit");r+=o}return i+=e,r}(e);for(var t=0,r=0;r<e;r+=1)t<<=8,t|=255&n.getUint8(i+r);return i+=e,t>>>0},moreData:function(){return i<n.byteLength}}}Or.__dashjs_factory_name="EBMLParser";var Fr=c.Z.getClassFactory(Or);function Ur(){var e,t,n,i,r,o,s,l,u,c,d=this.context;function f(e){var t=new g.Z;return t.setInfo(e),t}return e={setConfig:function(n){if(!(n.baseURLController&&n.dashMetrics&&n.mediaPlayerModel&&n.errHandler))throw new Error(a.Z.MISSING_CONFIG_ERROR);c=n.baseURLController,o=n.dashMetrics,s=n.mediaPlayerModel,i=n.errHandler,u=n.errors,t=n.debug.getLogger(e),r=n.requestModifier},initialize:function(){l=Tt(d).create({errHandler:i,dashMetrics:o,mediaPlayerModel:s,requestModifier:r,errors:u})},loadInitialization:function(e,n){return new Promise(function(i){var r=null,a=e?c.resolve(e.path):null,o=e?e.range.split("-"):null,s={range:{start:o?parseFloat(o[0]):null,end:o?parseFloat(o[1]):null},request:r,url:a?a.url:void 0,init:!0,mediaType:n};t.info("Start loading initialization."),r=f(s),l.load({request:r,success:function(){i(e)},error:function(){i(e)}}),t.debug("Perform init load: "+s.url)})},loadSegments:function(e,i,r){return new Promise(function(a){var o=null,s=e?c.resolve(e.path):null,h=s?s.url:void 0;o=f({bytesLoaded:0,bytesToLoad:8192,range:{start:0,end:8192},request:o,url:h,init:!1,mediaType:i}),t.debug("Parsing ebml header"),l.load({request:o,success:function(i){!function(e,i,r,a){if(e&&0!==e.byteLength){var o,s,u,c,h=Fr(d).create({data:e}),p=r?r.split("-"):null,g=null,m={url:i,range:{start:p?parseFloat(p[0]):null,end:p?parseFloat(p[1]):null},request:g};for(t.debug("Parse EBML header: "+m.url),h.skipOverElement(n.EBML),h.consumeTag(n.Segment),u=h.getMatroskaCodedNum(),u+=h.getPos(),c=h.getPos();h.moreData()&&!h.consumeTagAndSize(n.Segment.Info,!0);)if(!(h.skipOverElement(n.Segment.SeekHead,!0)||h.skipOverElement(n.Segment.Tracks,!0)||h.skipOverElement(n.Segment.Cues,!0)||h.skipOverElement(n.Void,!0)))throw new Error("no valid top level element found");for(;void 0===o;){var v=h.getMatroskaCodedNum(!0),y=h.getMatroskaCodedNum();v===n.Segment.Info.Duration.tag?o=h[n.Segment.Info.Duration.parse](y):h.setPos(h.getPos()+y)}g=f(m),l.load({request:g,success:function(e){s=function(e,i,r,a){var o,s,l,u,c,f,h,p;for(l=[],c=0,f=(s=function(e){var t,i,r=[],a=Fr(d).create({data:e});for(a.consumeTagAndSize(n.Segment.Cues);a.moreData()&&a.consumeTagAndSize(n.Segment.Cues.CuePoint,!0);){for((t={}).CueTime=a.parseTag(n.Segment.Cues.CuePoint.CueTime),t.CueTracks=[];a.moreData()&&a.consumeTag(n.Segment.Cues.CuePoint.CueTrackPositions,!0);){var o=a.getMatroskaCodedNum(),s=a.getPos();if((i={}).Track=a.parseTag(n.Segment.Cues.CuePoint.CueTrackPositions.CueTrack),0===i.Track)throw new Error("Cue track cannot be 0");i.ClusterPosition=a.parseTag(n.Segment.Cues.CuePoint.CueTrackPositions.CueClusterPosition),t.CueTracks.push(i),a.setPos(s+o)}if(0===t.CueTracks.length)throw new Error("Mandatory cuetrack not found");r.push(t)}if(0===r.length)throw new Error("mandatory cuepoint not found");return r}(e)).length;c<f;c+=1)u=new Lr.Z,o=c<s.length-1?s[c+1].CueTime-s[c].CueTime:a-s[c].CueTime,u.duration=o,u.startTime=s[c].CueTime,u.timescale=1e3,h=s[c].CueTracks[0].ClusterPosition+i,p=c<s.length-1?s[c+1].CueTracks[0].ClusterPosition+i-1:r-1,u.mediaRange=h+"-"+p,l.push(u);return t.debug("Parsed cues: "+l.length+" cues."),l}(e,c,u,o),a(s)},error:function(){t.error("Download Error: Cues "+m.url),a(null)}}),t.debug("Perform cues load: "+m.url+" bytes="+m.range.start+"-"+m.range.end)}else a(null)}(i,h,r,function(t){a({segments:t,representation:e,error:t?void 0:new T.Z(u.SEGMENT_BASE_LOADER_ERROR_CODE,u.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})})},error:function(){a({representation:e,error:new T.Z(u.SEGMENT_BASE_LOADER_ERROR_CODE,u.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}})})},reset:function(){l&&(l.abort(),l=null)}},n={EBML:{tag:440786851,required:!0},Segment:{tag:408125543,required:!0,SeekHead:{tag:290298740,required:!0},Info:{tag:357149030,required:!0,TimecodeScale:{tag:2807729,required:!0,parse:"getMatroskaUint"},Duration:{tag:17545,required:!0,parse:"getMatroskaFloat"}},Tracks:{tag:374648427,required:!0},Cues:{tag:475249515,required:!0,CuePoint:{tag:187,required:!0,CueTime:{tag:179,required:!0,parse:"getMatroskaUint"},CueTrackPositions:{tag:183,required:!0,CueTrack:{tag:247,required:!0,parse:"getMatroskaUint"},CueClusterPosition:{tag:241,required:!0,parse:"getMatroskaUint"}}}}},Void:{tag:236,required:!0}},e}Ur.__dashjs_factory_name="WebmSegmentBaseLoader";var Br=c.Z.getSingletonFactory(Ur);function Gr(e){e=e||{};var t,n,i,r=this.context,a=e.eventBus,o=e.events,s=e.dashMetrics,l=e.mediaPlayerModel,u=e.errHandler,c=e.baseURLController,d=e.debug,f=e.boxParser,h=e.requestModifier,p=e.errors;function g(e){return"webm"===(e?e.split("/")[1]:"").toLowerCase()}return t={initialize:function(){n.initialize(),i.initialize()},getSegmentBaseInitSegment:function(e){return g(e.representation.mimeType)?i.loadInitialization(e.representation,e.mediaType):n.loadInitialization(e.representation,e.mediaType)},getSegmentList:function(e){return g(e.mimeType)?i.loadSegments(e.representation,e.mediaType,e.representation?e.representation.indexRange:null):n.loadSegments(e.representation,e.mediaType,e.representation?e.representation.indexRange:null)},reset:function(){n.reset(),i.reset()}},n=Nr(r).getInstance(),i=Br(r).getInstance(),n.setConfig({baseURLController:c,dashMetrics:s,mediaPlayerModel:l,errHandler:u,eventBus:a,events:o,errors:p,debug:d,boxParser:f,requestModifier:h}),i.setConfig({baseURLController:c,dashMetrics:s,mediaPlayerModel:l,errHandler:u,eventBus:a,events:o,errors:p,debug:d,requestModifier:h}),t}Gr.__dashjs_factory_name="SegmentBaseController";var jr=c.Z.getSingletonFactory(Gr),Vr=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.quality=null,this.fragmentDuration=null,this.mediaInfo=null,this.MSETimeOffset=null},Hr=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=null,this.type=null,this.streamInfo=null,this.representationCount=0,this.labels=null,this.lang=null,this.viewpoint=null,this.viewpointsWithSchemeIdUri=null,this.accessibility=null,this.accessibilitiesWithSchemeIdUri=null,this.audioChannelConfiguration=null,this.audioChannelConfigurationsWithSchemeIdUri=null,this.roles=null,this.rolesWithSchemeIdUri=null,this.codec=null,this.mimeType=null,this.contentProtection=null,this.isText=!1,this.KID=null,this.bitrateList=null,this.isFragmented=null,this.isEmbedded=null,this.selectionPriority=1,this.supplementalProperties={},this.supplementalPropertiesAsArray=[],this.essentialProperties={},this.essentialPropertiesAsArray=[],this.segmentAlignment=!1,this.subSegmentAlignment=!1},Kr=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=null,this.start=NaN,this.duration=NaN,this.manifestInfo=null,this.isLast=!0},zr=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dvrWindowSize=NaN,this.loadedTime=null,this.availableFrom=null,this.minBufferTime=NaN,this.duration=NaN,this.isDynamic=!1,this.maxFragmentDuration=null,this.serviceDescriptions=[],this.protocol=null};function Zr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var qr=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.valid="/"==t[0],this.path=t.split("/").filter(function(e){return 0!==e.length}).map(function(e){var t={name:e},i=e.indexOf("[");if(-1!=i){t.name=e.substring(0,i);var r=e.substring(i+1,e.length-1);n.valid=n.valid&&-1==r.indexOf("[");var a=r.indexOf("=");-1!=a?(t.attribute={name:r.substring(1,a),value:r.substring(a+1)},-1!=["'",'"'].indexOf(t.attribute.value[0])&&(t.attribute.value=t.attribute.value.substring(1,t.attribute.value.length-1))):t.position=parseInt(r,10)-1}return t})}var t,n;return t=e,(n=[{key:"isValid",value:function(){return this.valid}},{key:"findsElement",value:function(){return!this.findsAttribute()}},{key:"findsAttribute",value:function(){return this.path[this.path.length-1].name.startsWith("@")}},{key:"findsTextReplace",value:function(){return"text()"===this.path[this.path.length-1].name}},{key:"getMpdTarget",value:function(e,t){for(var n=null,i=e,r=1,a="MPD";r<this.path.length&&null!==i;){n=i;var o=this.path[r];if(a=o.name,r!==this.path.length-1||!a.startsWith("@")&&"text()"!==a){var s=n[a+"_asArray"]||[];0===s.length&&n[a]&&s.push(n[a]),o.position?i=s[o.position]||null:o.attribute?function(){var e=o.attribute;i=s.filter(function(t){return t[e.name]==e.value})[0]||null}():i=s[0]||null}r++}return null===i?null:a.startsWith("@")?{name:a.substring(1),leaf:i,target:i}:"text()"===a?{name:"__text",leaf:i,target:i}:{name:a,leaf:i,target:t?n:i}}}])&&Zr(t.prototype,n),e}();function Yr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Wr=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.action=t,this.xpath=n,this.value=i,this.position=null}var t,n;return t=e,(n=[{key:"getMpdTarget",value:function(e){var t="remove"===this.action||"replace"===this.action||"before"===this.position||"after"===this.position;return this.xpath.getMpdTarget(e,t)}}])&&Yr(t.prototype,n),e}();function $r(){var e,t,n=this.context;return e={getIsPatch:function(e){return e&&e.hasOwnProperty(o.Z.ORIGINAL_MPD_ID)||!1},getPublishTime:function(e){return e&&e.hasOwnProperty(o.Z.PUBLISH_TIME)?new Date(e[o.Z.PUBLISH_TIME]):null},getOriginalPublishTime:function(e){return e&&e.hasOwnProperty(o.Z.ORIGINAL_PUBLISH_TIME)?new Date(e[o.Z.ORIGINAL_PUBLISH_TIME]):null},getMpdId:function(e){return e&&e[o.Z.ORIGINAL_MPD_ID]||null},getPatchOperations:function(e){return e?(e.__children||[]).map(function(e){var n=Object.keys(e)[0];if("add"!==n&&"remove"!==n&&"replace"!==n)return t.warn("Ignoring node of invalid action: ".concat(n)),null;var i=e[n],r=i.sel;if("add"===n&&i.type){if(!i.type.startsWith("@"))return t.warn("Ignoring add action for prefixed namespace declaration: ".concat(i.type,"=").concat(i.__text)),null;r="".concat(r,"/").concat(i.type)}var a=new qr(r);if(!a.isValid())return t.warn("Ignoring action with invalid selector: ".concat(n," - ").concat(r)),null;var o=null;a.findsAttribute()||a.findsTextReplace()?o=i.__text||"":"remove"!==n&&(o=i.__children.reduce(function(e,t){var n=Object.keys(t)[0];return"#text"!==n&&(e[n]=e[n]||[],e[n].push(t[n])),e},{}));var s=new Wr(n,a,o);return"add"===n&&(s.position=i.pos),s}).filter(function(e){return!!e}):[]}},t=(0,d.Z)(n).getInstance().getLogger(e),e}$r.__dashjs_factory_name="PatchManifestModel";var Xr=c.Z.getSingletonFactory($r);function Qr(){var e,t,n,i,r,a,s,l=this.context;function u(e,n,a){var s,l=t.getAdaptationsForType(i[0].mpd.manifest,e,n);if(!l||0===l.length)return null;if(l.length>1&&a){var u=f(a,n);if(r[a.id]&&r[a.id][n])for(var d=0,h=l.length;d<h;d++)if(c(r[a.id][n],u[d]))return l[d];for(var p=0,g=l.length;p<g;p++)if(s=l[p],t.getRolesForAdaptation(s).filter(function(e){return e.value===o.Z.MAIN})[0])return l[p]}return l[0]}function c(e,t){if(!e||!t)return!1;var n=e.id===t.id,i=e.codec===t.codec,r=e.viewpoint===t.viewpoint,a=JSON.stringify(e.viewpointsWithSchemeIdUri)===JSON.stringify(t.viewpointsWithSchemeIdUri),o=e.lang===t.lang,s=e.roles.toString()===t.roles.toString(),l=JSON.stringify(e.rolesWithSchemeIdUri)===JSON.stringify(t.rolesWithSchemeIdUri),u=e.accessibility.toString()===t.accessibility.toString(),c=JSON.stringify(e.accessibilitiesWithSchemeIdUri)===JSON.stringify(t.accessibilitiesWithSchemeIdUri),d=e.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString(),f=JSON.stringify(e.audioChannelConfigurationsWithSchemeIdUri)===JSON.stringify(t.audioChannelConfigurationsWithSchemeIdUri);return n&&i&&r&&a&&o&&s&&l&&u&&c&&d&&f}function d(e,n,i,r,o,s){var l,u,c,d,f,h,p=[];if(!r||0===r.length)return[];var g=t.getAdaptationsForPeriod(n);for(d=0,h=r.length;d<h;d++)if(l=r[d],u=_(g[c=t.getIndexForAdaptation(l,e,i.index)]),s){var m=u.accessibility.length;for(f=0;f<m;f++)if(u){var v=u.accessibility[f];if(0===v.indexOf("cea-608:")){var y=v.substring(8).split(";");if("CC"===y[0].substring(0,2))for(f=0;f<y.length;f++)u||(u=_.call(this,g[c])),b(u,y[f].substring(0,3),y[f].substring(4)),p.push(u),u=null;else for(f=0;f<y.length;f++)u||(u=_.call(this,g[c])),b(u,"CC"+(f+1),y[f]),p.push(u),u=null}else 0===v.indexOf("cea-608")&&(b(u,a.CC1,"eng"),p.push(u),u=null)}}else o===a.IMAGE?(u.type=a.IMAGE,p.push(u),u=null):u&&p.push(u);return p}function f(e,n,r){var o=i,s=r,l=[];if(s)T(),o=h(s);else{if(!(i.length>0))return l;s=i[0].mpd.manifest}var u=y(e,o),c=t.getAdaptationsForType(s,e?e.index:null,n);return l=d(s,u,e,c,n),n===a.TEXT&&(c=t.getAdaptationsForType(s,e?e.index:null,a.VIDEO),l=l.concat(d(s,u,e,c,n,!0))),l}function h(e){var n=p(e);return t.getRegularPeriods(n)}function p(e){var n=m(e);return t.getMpd(n)}function g(){i=[],r={}}function m(e){return e||(i.length>0?i[0].mpd.manifest:null)}function v(e){try{var n=y(e.streamInfo,i),r=t.getAdaptationsForPeriod(n);return e&&e.streamInfo&&void 0!==e.streamInfo.id&&r?r[e.index]:null}catch(e){return null}}function y(e,t){for(var n=t.length,i=0;i<n;i++){var r=t[i];if(e&&e.id===r.id)return r}return null}function _(e){if(!e)return null;var n,i,r,a,o,l=new Hr,u=e.period.mpd.manifest.Period_asArray[e.period.index].AdaptationSet_asArray[e.index];if(l.id=e.id,l.index=e.index,l.type=e.type,l.streamInfo=E(e.period),l.representationCount=t.getRepresentationCount(u),l.labels=t.getLabelsForAdaptation(u),l.lang=t.getLanguageForAdaptation(u),l.segmentAlignment=t.getSegmentAlignment(u),l.subSegmentAlignment=t.getSubSegmentAlignment(u),n=t.getViewpointForAdaptation(u),l.viewpoint=n.length?n[0].value:void 0,l.viewpointsWithSchemeIdUri=n,o=t.getAccessibilityForAdaptation(u),l.accessibility=o.map(function(e){var t=e.value,n=t;return e.schemeIdUri&&e.schemeIdUri.search("cea-608")>=0&&void 0!==s&&(n=t?"cea-608:"+t:"cea-608",l.embeddedCaptions=!0),n}),l.accessibilitiesWithSchemeIdUri=o,i=t.getAudioChannelConfigurationForAdaptation(u),l.audioChannelConfiguration=i.map(function(e){return e.value}),l.audioChannelConfigurationsWithSchemeIdUri=i,0===l.audioChannelConfiguration.length&&Array.isArray(u.Representation_asArray)&&u.Representation_asArray.length>0&&(r=t.getAudioChannelConfigurationForRepresentation(u.Representation_asArray[0]),l.audioChannelConfiguration=r.map(function(e){return e.value}),l.audioChannelConfigurationsWithSchemeIdUri=r),a=t.getRolesForAdaptation(u),l.roles=a.map(function(e){return e.value}),l.rolesWithSchemeIdUri=a,l.codec=t.getCodec(u),l.mimeType=t.getMimeType(u),l.contentProtection=t.getContentProtectionData(u),l.bitrateList=t.getBitrateListForAdaptation(u),l.selectionPriority=t.getSelectionPriority(u),l.contentProtection){var c=l.contentProtection.map(function(e){return t.getKID(e)}).filter(function(e){return null!==e});if(c.length){var d=c[0];l.contentProtection.forEach(function(e){e.keyId=d})}}if(l.isText=t.getIsText(u),l.supplementalProperties=t.getSupplementalPropertiesForAdaptation(u),(!l.supplementalProperties||0===Object.keys(l.supplementalProperties).length)&&Array.isArray(u.Representation_asArray)&&u.Representation_asArray.length>0){var f=u.Representation_asArray.map(function(e){return t.getSupplementalPropertiesForRepresentation(e)});f.every(function(e){return JSON.stringify(e)===JSON.stringify(f[0])})&&(l.supplementalProperties=f[0])}if(l.supplementalPropertiesAsArray=t.getSupplementalPropertiesAsArrayForAdaptation(u),(!l.supplementalPropertiesAsArray||0===l.supplementalPropertiesAsArray.length)&&Array.isArray(u.Representation_asArray)&&u.Representation_asArray.length>0){var h=u.Representation_asArray.map(function(e){return t.getSupplementalPropertiesAsArrayForRepresentation(e)});h.every(function(e){return JSON.stringify(e)===JSON.stringify(h[0])})&&(l.supplementalPropertiesAsArray=h[0])}return l.essentialProperties=t.getEssentialPropertiesForAdaptation(u),l.essentialPropertiesAsArray=t.getEssentialPropertiesAsArrayForAdaptation(u),l.isFragmented=t.getIsFragmented(u),l.isEmbedded=!1,l}function b(e,t,n){e.id=t,e.index=100+parseInt(t.substring(2,3)),e.type=a.TEXT,e.codec="cea-608-in-SEI",e.isEmbedded=!0,e.isFragmented=!1;var i=bn()(n);e.lang=i||n,e.roles=["caption"],e.rolesWithSchemeIdUri=[{schemeIdUri:"urn:mpeg:dash:role:2011",value:"caption"}]}function E(e){var n,i,r=new Kr;return r.id=e.id,r.index=e.index,r.start=e.start,r.duration=e.duration,r.manifestInfo=(n=e.mpd,(i=new zr).dvrWindowSize=n.timeShiftBufferDepth,i.loadedTime=n.manifest.loadedTime,i.availableFrom=n.availabilityStartTime,i.minBufferTime=n.manifest.minBufferTime,i.maxFragmentDuration=n.maxSegmentDuration,i.duration=t.getDuration(n.manifest),i.isDynamic=t.getIsDynamic(n.manifest),i.serviceDescriptions=t.getServiceDescriptions(n.manifest),i.protocol=n.manifest.protocol,i),r.isLast=1===e.mpd.manifest.Period_asArray.length||Math.abs(r.start+r.duration-r.manifestInfo.duration)<1,r}function T(){if(!a)throw new Error("setConfig function has to be called previously")}function S(e){return i.length>0?i[0].mpd.manifest.Period_asArray[e]:null}function w(e,t,n){var i,r,a,o,s;if(e)for(i=e.AdaptationSet_asArray,o=0;o<i.length;o+=1)for(a=i[o].Representation_asArray,s=0;s<a.length;s+=1)if(t===(r=a[s]).id)return n?s:r;return null}return e={getBandwidthForRepresentation:function(e,t){var n;return(n=w(S(t),e))?n.bandwidth:null},getIndexForRepresentation:function(e,t){return function(e,t){var n=w(e,t,!0);return null!==n?n:-1}(S(t),e)},getMaxIndexForBufferType:function(e,n){return function(e,n){var i,r,a,o;if(!e||!n)return-1;for(r=e.AdaptationSet_asArray,o=0;o<r.length;o+=1)if(a=(i=r[o]).Representation_asArray,t.getIsTypeOf(i,n))return a.length;return-1}(S(n),e)},convertRepresentationToRepresentationInfo:function(e){if(e){var n=new Vr,i=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index],r=t.getRepresentationFor(e.index,i);return n.id=e.id,n.quality=e.index,n.bandwidth=t.getBandwidth(r),n.fragmentDuration=e.segmentDuration||(e.segments&&e.segments.length>0?e.segments[0].duration:NaN),n.MSETimeOffset=e.MSETimeOffset,n.mediaInfo=_(e.adaptation),n}return null},getStreamsInfo:function(e,t){var n=[],r=i;if(e&&(T(),r=h(e)),r.length>0){(!t||t>r.length)&&(t=r.length);for(var a=0;a<t;a++)n.push(E(r[a]))}return n},getMediaInfoForType:function(e,n){if(0===i.length||!e)return null;var r=y(e,i);if(!r)return null;var a=t.getAdaptationsForPeriod(r),o=u(e.index,n,e);return o?_(a[t.getIndexForAdaptation(o,i[0].mpd.manifest,e.index)]):null},getAllMediaInfoForType:f,getAdaptationForType:u,getRealAdaptation:function(e,n){var r,a,o=y(e,i);return r=n?n.id:null,i.length>0&&o&&(a=r?t.getAdaptationForId(r,i[0].mpd.manifest,o.index):t.getAdaptationForIndex(n?n.index:null,i[0].mpd.manifest,o.index)),a},getProducerReferenceTimes:function(e,n){var r,a,o=y(e,i);return r=n?n.id:null,i.length>0&&o&&(a=r?t.getAdaptationForId(r,i[0].mpd.manifest,o.index):t.getAdaptationForIndex(n?n.index:null,i[0].mpd.manifest,o.index)),a?t.getProducerReferenceTimesForAdaptation(a):[]},getRealPeriodByIndex:function(e){return t.getRealPeriodForIndex(e,i[0].mpd.manifest)},getEssentialPropertiesForRepresentation:function(e){try{return t.getEssentialPropertiesForRepresentation(e)}catch(e){return[]}},getVoRepresentations:function(e){var n=v(e);return t.getRepresentationsForAdaptation(n)},getEventsFor:function(e,n,r){var a=[];if(i.length>0){var o=i[0].mpd.manifest;if(e instanceof Kr){var s=y(e,i);a=t.getEventsForPeriod(s)}else if(e instanceof Hr){var l=y(r,i);a=t.getEventStreamForAdaptationSet(o,v(e),l)}else if(e instanceof Vr){var u=y(r,i);a=t.getEventStreamForRepresentation(o,n,u)}}return a},getEvent:function(e,t,n,i){try{if(!e||!t||isNaN(n)||!i)return null;var r=e.scheme_id_uri,a=e.value;if(!t[r+"/"+a])return null;var o,s=new be,l=e.timescale||1,u=i.adaptation.period.start,c=t[r+"/"+a],d=isNaN(i.presentationTimeOffset)?isNaN(c.presentationTimeOffset)?0:c.presentationTimeOffset:i.presentationTimeOffset,f=e.presentation_time_delta/l;o=0===e.version?u+n-d+f:u-d+f;var h=e.event_duration/l,p=e.id,g=e.message_data;return s.eventStream=c,s.eventStream.value=a,s.eventStream.timescale=l,s.duration=h,s.id=p,s.calculatedPresentationTime=o,s.messageData=g,s.presentationTimeDelta=f,s}catch(e){return null}},getMpd:p,setConfig:function(e){e&&(e.constants&&(a=e.constants),e.cea608parser&&(s=e.cea608parser),e.errHandler&&t.setConfig({errHandler:e.errHandler}),e.BASE64&&t.setConfig({BASE64:e.BASE64}))},updatePeriods:function(e){if(!e)return null;T(),i=h(e)},getIsTextTrack:function(e){return t.getIsText(e)},getUTCTimingSources:function(){var e=m();return t.getUTCTimingSources(e)},getSuggestedPresentationDelay:function(){var e=i.length>0?i[0].mpd:null;return t.getSuggestedPresentationDelay(e)},getAvailabilityStartTime:function(e){var n=p(e);return t.getAvailabilityStartTime(n)},getIsTypeOf:function(e,n){return t.getIsTypeOf(e,n)},getIsDynamic:function(e){var n=m(e);return t.getIsDynamic(n)},getDuration:function(e){var n=m(e);return t.getDuration(n)},getRegularPeriods:h,getContentSteering:function(e){return t.getContentSteering(e)},getLocation:function(e){return t.getLocation(e)},getPatchLocation:function(e){var n=t.getPatchLocation(e),i=t.getPublishTime(e);return n&&0!==n.length&&i?n.filter(function(e){return isNaN(e.ttl)||i.getTime()+e.ttl>(new Date).getTime()}):[]},getManifestUpdatePeriod:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.getManifestUpdatePeriod(e,n)},getPublishTime:function(e){return t.getPublishTime(e)},getIsDVB:function(e){return t.hasProfile(e,"urn:dvb:dash:profile:dvb-dash:2014")},getIsPatch:function(e){return n.getIsPatch(e)},getBaseURLsFromElement:function(e){return t.getBaseURLsFromElement(e)},getRepresentationSortFunction:function(){return t.getRepresentationSortFunction()},getCodec:function(e,n,i){return t.getCodec(e,n,i)},getPeriodById:function(e){if(!e||0===i.length)return null;var t=i.filter(function(t){return t.id===e});return t&&t.length>0?t[0]:null},setCurrentMediaInfo:function(e,t,n){r[e]=r[e]||{},r[e][t]=r[e][t]||{},r[e][t]=n},isPatchValid:function(e,i){var r=t.getId(e),a=n.getMpdId(i),o=t.getPublishTime(e),s=n.getPublishTime(i),l=n.getOriginalPublishTime(i);return!!(r&&a&&r==a&&o&&l&&o.getTime()==l.getTime()&&s&&o.getTime()<s.getTime())},applyPatchToManifest:function(e,t){n.getPatchOperations(t).forEach(function(t){var n=t.getMpdTarget(e);if(null!==n){var i=n.name,r=n.target,a=n.leaf;if(t.xpath.findsAttribute()||"__text"===i)switch(t.action){case"add":case"replace":r[i]=t.value;break;case"remove":delete r[i]}else{var o=(r[i+"_asArray"]||[]).indexOf(a),s="prepend"===t.position||"before"===t.position;if(("remove"===t.action||"replace"===t.action)&&(delete r[i],-1!=o)){var l=r[i+"_asArray"];l.splice(o,1),l.length>1?r[i]=l:1==l.length?r[i]=l[0]:delete r[i+"_asArray"]}"add"!==t.action&&"replace"!==t.action||Object.keys(t.value).forEach(function(e){var n=t.value[e],a=r[e+"_asArray"]||[];if(0===a.length&&r[e]&&a.push(r[e]),0===a.length)a=n;else{var l=a.length;l=e==i&&-1!=o?o+(s?0:1)+("replace"==t.action?-1:0):s?0:a.length,a.splice.apply(a,[l,0].concat(n))}r[e+"_asArray"]=a,r[e]=1==a.length?a[0]:a})}}})},areMediaInfosEqual:c,reset:g},t=Ve(l).getInstance(),n=Xr(l).getInstance(),g(),e}Qr.__dashjs_factory_name="DashAdapter";var Jr=c.Z.getSingletonFactory(Qr);function ea(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ta=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"round10",value:function(e,t){return function(e,t,n){return void 0===n||0==+n?Math[e](t):(n=+n,null===(t=+t)||isNaN(t)||"number"!=typeof n||n%1!=0?NaN:(t=t.toString().split("e"),+((t=(t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-n:-n)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+n:n))))}("round",e,t)}}],n&&ea(t,n),e}(),na=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.TcpList=[],this.HttpList=[],this.RepSwitchList=[],this.BufferLevel=[],this.BufferState=[],this.PlayList=[],this.DroppedFrames=[],this.SchedulingInfo=[],this.DVRInfo=[],this.ManifestUpdate=[],this.RequestsQueue=null,this.DVBErrors=[]},ia=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.mt=null,this.to=null,this.lto=null},ra=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.level=null},aa=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.target=null,this.state=s.Z.BUFFER_EMPTY},oa=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=null,this.range=null,this.manifestInfo=null},sa=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=null,this.droppedFrames=null};function la(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var ua=function e(){la(this,e),this.mediaType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.streamInfo=[],this.representationInfo=[]},ca=function e(){la(this,e),this.id=null,this.index=null,this.start=null,this.duration=null},da=function e(){la(this,e),this.id=null,this.index=null,this.mediaType=null,this.streamIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.fragmentInfoType=null},fa=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mediaType=null,this.t=null,this.type=null,this.startTime=null,this.availabilityStartTime=null,this.duration=null,this.quality=null,this.range=null,this.state=null},ha=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loadingRequests=[],this.executedRequests=[]};function pa(e){var t,n,i=(e=e||{}).settings,r=this.context,o=(0,l.Z)(r).getInstance();function c(){o.trigger(u.Z.METRICS_CHANGED)}function d(e){o.trigger(u.Z.METRIC_CHANGED,{mediaType:e}),c()}function f(e,t,n){o.trigger(u.Z.METRIC_UPDATED,{mediaType:e,metric:t,value:n}),d(e)}function h(e,t,n){o.trigger(u.Z.METRIC_ADDED,{mediaType:e,metric:t,value:n}),d(e)}function p(e,t){var i=null;return e?(n.hasOwnProperty(e)?i=n[e]:t||(i=new na,n[e]=i),i):i}function g(e,t,n){var r=p(e);null!==r&&(r[t].push(n),r[t].length>i.get().streaming.metrics.maxListDepth&&r[t].shift())}function m(e,t,n){g(e,t,n),h(e,t,n)}return t={clearCurrentMetricsForType:function(e){delete n[e],d(e)},clearAllCurrentMetrics:function(){n={},c()},getMetricsFor:p,addHttpRequest:function e(t,n,i,r,a,o,l,u,c,d,f,h,p,g,v,y,_){var b=new C.w;null!=o&&o!==r&&(e(t,null,i,r,a,null,null,u,c,null,null,null,p,null,null,y,_),b.actualurl=o),b.tcpid=n,b.type=i,b.url=r,b.range=u,b.trequest=c,b.tresponse=d,b.responsecode=h,b.cmsd=_,b._tfinish=f,b._stream=t,b._mediaduration=p,b._quality=a,b._responseHeaders=g,b._serviceLocation=l,b._fileLoaderType=y,v?v.forEach(function(e){!function(e,t,n,i){var r=new C.O;r.s=t,r.d=n,r.b=i,e.trace.push(r),e.interval||(e.interval=0),e.interval+=n}(b,e.s,e.d,e.b)}):(delete b.interval,delete b.trace),m(t,s.Z.HTTP_REQUEST,b)},addRepresentationSwitch:function(e,t,n,i,r){var a=new ia;a.t=t,a.mt=n,a.to=i,r?a.lto=r:delete a.lto,m(e,s.Z.TRACK_SWITCH,a)},addBufferLevel:function(e,t,n){var i=new ra;i.t=t,i.level=n,m(e,s.Z.BUFFER_LEVEL,i)},addBufferState:function(e,t,n){var i=new aa;i.target=n,i.state=t,m(e,s.Z.BUFFER_STATE,i)},addDVRInfo:function(e,t,n,i){var r=new oa;r.time=t,r.range=i,r.manifestInfo=n,m(e,s.Z.DVR_INFO,r)},addDroppedFrames:function(e,t){var n=new sa,i=p(e).DroppedFrames;t&&(n.time=t.creationTime,n.droppedFrames=t.droppedVideoFrames,i.length>0&&i[i.length-1]==n||m(e,s.Z.DROPPED_FRAMES,n))},addSchedulingInfo:function(e,t,n,i,r,a,o,l,u){var c=new fa;c.mediaType=e,c.t=t,c.type=n,c.startTime=i,c.availabilityStartTime=r,c.duration=a,c.quality=o,c.range=l,c.state=u,m(e,s.Z.SCHEDULING_INFO,c)},addRequestsQueue:function(e,t,n){var i=new ha;i.loadingRequests=t,i.executedRequests=n,p(e).RequestsQueue=i,h(e,s.Z.REQUESTS_QUEUE,i)},addManifestUpdate:function(e,t,n,i,r,o,l,u,c,d){var f=new ua;f.mediaType=e,f.type=t,f.requestTime=n,f.fetchTime=i,f.availabilityStartTime=r,f.presentationStartTime=o,f.clientTimeOffset=l,f.currentTime=u,f.buffered=c,f.latency=d,g(a.Z.STREAM,s.Z.MANIFEST_UPDATE,f),h(e,s.Z.MANIFEST_UPDATE,f)},updateManifestUpdateInfo:function(e,t){if(e){for(var n in t)e[n]=t[n];f(e.mediaType,s.Z.MANIFEST_UPDATE,e)}},addManifestUpdateStreamInfo:function(e,t,n,i,r){if(e){var a=new ca;a.id=t,a.index=n,a.start=i,a.duration=r,e.streamInfo.push(a),f(e.mediaType,s.Z.MANIFEST_UPDATE_STREAM_INFO,e)}},addManifestUpdateRepresentationInfo:function(e,t,n,i,r,a,o,l){if(e&&e.representationInfo){var u=new da;u.id=t,u.index=n,u.streamIndex=i,u.mediaType=r,u.startNumber=o,u.fragmentInfoType=l,u.presentationTimeOffset=a,e.representationInfo.push(u),f(e.mediaType,s.Z.MANIFEST_UPDATE_TRACK_INFO,e)}},addPlayList:function(e){e.trace&&Array.isArray(e.trace)?e.trace.forEach(function(e){e.hasOwnProperty("subreplevel")&&!e.subreplevel&&delete e.subreplevel}):delete e.trace,m(a.Z.STREAM,s.Z.PLAY_LIST,e)},addDVBErrors:function(e){m(a.Z.STREAM,s.Z.DVB_ERRORS,e)}},n={},t}pa.__dashjs_factory_name="MetricsModel";var ga=c.Z.getSingletonFactory(pa);function ma(e){e=e||{};var t,n,i,r,o=this.context,l=e.metricsModel;function u(e){var t=l.getMetricsFor(e,!0);if(!t)return null;var n,i=t.HttpList,r=null;if(!i||i.length<=0)return null;for(n=i.length-1;n>=0;){if(i[n].responsecode){r=i[n];break}n--}return r}function c(e){var t=l.getMetricsFor(e,!0);return t&&t.HttpList?t.HttpList:[]}function d(e,t){if(!e)return null;var n=e[t];return n&&0!==n.length?n[n.length-1]:null}return t={getCurrentRepresentationSwitch:function(e){return d(l.getMetricsFor(e,!0),s.Z.TRACK_SWITCH)},getCurrentBufferState:function(e){return d(l.getMetricsFor(e,!0),s.Z.BUFFER_STATE)},getCurrentBufferLevel:function(e){var t=d(l.getMetricsFor(e,!0),s.Z.BUFFER_LEVEL);return t?ta.round10(t.level/1e3,-3):0},getCurrentHttpRequest:u,getHttpRequests:c,getCurrentDroppedFrames:function(){return d(l.getMetricsFor(a.Z.VIDEO,!0),s.Z.DROPPED_FRAMES)},getCurrentSchedulingInfo:function(e){return d(l.getMetricsFor(e,!0),s.Z.SCHEDULING_INFO)},getCurrentDVRInfo:function(e){return d(e?l.getMetricsFor(e,!0):l.getMetricsFor(a.Z.VIDEO,!0)||l.getMetricsFor(a.Z.AUDIO,!0),s.Z.DVR_INFO)},getCurrentManifestUpdate:function(){return d(l.getMetricsFor(a.Z.STREAM),s.Z.MANIFEST_UPDATE)},getLatestFragmentRequestHeaderValueByID:function(e,t){if(!t)return null;var n={},i=u(e);i&&(n=He.Z.parseHttpHeaders(i._responseHeaders));var r=n[t.toLowerCase()];return void 0===r?null:r},getLatestMPDRequestHeaderValueByID:function(e){if(!e)return null;var t,n,i,r={};for(i=(t=c(a.Z.STREAM)).length-1;i>=0;i--)if((n=t[i]).type===C.w.MPD_TYPE){r=He.Z.parseHttpHeaders(n._responseHeaders);break}var o=r[e.toLowerCase()];return void 0===o?null:o},addRepresentationSwitch:function(e,t,n,i,r){l.addRepresentationSwitch(e,t,n,i,r)},addDVRInfo:function(e,t,n,i){l.addDVRInfo(e,t,n,i)},updateManifestUpdateInfo:function(e){var t=this.getCurrentManifestUpdate();l.updateManifestUpdateInfo(t,e)},addManifestUpdateStreamInfo:function(e){if(e){var t=this.getCurrentManifestUpdate();l.addManifestUpdateStreamInfo(t,e.id,e.index,e.start,e.duration)}},addManifestUpdateRepresentationInfo:function(e,t){if(e){var n=this.getCurrentManifestUpdate();l.addManifestUpdateRepresentationInfo(n,e.id,e.index,e.streamIndex,t,e.presentationTimeOffset,e.startNumber,e.fragmentInfoType)}},addManifestUpdate:function(e){l.addManifestUpdate(a.Z.STREAM,e.type,e.requestStartDate,e.requestEndDate)},addHttpRequest:function(e,t,n,i,r,a){l.addHttpRequest(e.mediaType,null,e.type,e.url,e.quality,t,e.serviceLocation||null,e.range||null,e.requestStartDate,e.firstByteDate,e.requestEndDate,n,e.duration,i,r,e.fileLoaderType,a)},addSchedulingInfo:function(e,t){l.addSchedulingInfo(e.mediaType,new Date,e.type,e.startTime,e.availabilityStartTime,e.duration,e.quality,e.range,t)},addRequestsQueue:function(e,t,n){l.addRequestsQueue(e,t,n)},addBufferLevel:function(e,t,n){l.addBufferLevel(e,t,n)},addBufferState:function(e,t,n){l.addBufferState(e,t,n)},addDroppedFrames:function(e){l.addDroppedFrames(a.Z.VIDEO,e)},addPlayList:function(){r&&(l.addPlayList(r),r=null)},addDVBErrors:function(e){l.addDVBErrors(e)},createPlaylistMetrics:function(e,t){(r=new J).start=new Date,r.mstart=e,r.starttype=t},createPlaylistTraceMetrics:function(e,t,r){!0===n&&(n=!1,(i=new ee).representationid=e,i.start=new Date,i.mstart=t,i.playbackspeed=null!==r?r.toString():null)},updatePlayListTraceMetrics:function(e){if(i)for(var t in i)i[t]=e[t]},pushPlayListTraceMetrics:function(e,t){if(!1===n&&r&&i&&i.start){var a=i.start,o=e.getTime()-a.getTime();i.duration=o,i.stopreason=t,r.trace.push(i),n=!0}},clearAllCurrentMetrics:function(){l.clearAllCurrentMetrics()}},l=l||ga(o).getInstance({settings:e.settings}),n=!0,i=null,r=null,t}ma.__dashjs_factory_name="DashMetrics";var va=c.Z.getSingletonFactory(ma);function ya(){var e,t,n,i,r=this.context,s=(0,l.Z)(r).getInstance(),c=(0,R.Z)(r).getInstance();function d(e){i=e}function h(e,t,n,i){var r,a=t.adaptation.period.mpd,o=a.availabilityStartTime;if(i)r=n&&a.timeShiftBufferDepth!==Number.POSITIVE_INFINITY?new Date(o.getTime()+1e3*(e+a.timeShiftBufferDepth)):a.availabilityEndTime;else if(n){var s=t.availabilityTimeOffset;r=new Date(o.getTime()+1e3*(e-s))}else r=o;return r}function p(e,t){return(e.getTime()-t.mpd.availabilityStartTime.getTime()+1e3*i)/1e3}function g(e,t){return e+(t.adaptation.period.start-t.presentationTimeOffset)}function m(e){var n={start:NaN,end:NaN},i=e[0].getAdapter().getRegularPeriods()[0],r=p(new Date,i);if(!e||0===e.length)return{range:n,now:r};e.forEach(function(e){var i=e.getAdapter(),s=i.getMediaInfoForType(e.getStreamInfo(),a.Z.VIDEO)||i.getMediaInfoForType(e.getStreamInfo(),a.Z.AUDIO),l=i.getVoRepresentations(s)[0],u={start:NaN,end:NaN};if(l)if(l.segmentInfoType===o.Z.SEGMENT_TIMELINE)u=function(e){var n,i,r,a,o=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index],s=t.getRepresentationFor(e.index,o),l=s.SegmentTemplate||s.SegmentList,u=l.SegmentTimeline,c=l.timescale,d=u.S_asArray,f={start:0,end:0},h=d[0].t,p=!isNaN(h),m=p?h:0,v=0;for(p&&(f.start=g(m/c,e)),r=0,a=d.length;r<a;r++)i=0,(n=d[r]).hasOwnProperty("r")&&(i=n.r),v+=n.d*(1+i);return f.end=g((m+v)/c,e),f}(l);else{var c=l.adaptation.period;u.start=c.start,u.end=Math.max(r,c.start+c.duration)}!isNaN(u.start)&&(isNaN(n.start)||n.start>u.start)&&(n.start=u.start),!isNaN(u.end)&&(isNaN(n.end)||n.end<u.end)&&(n.end=u.end)}),n.end=Math.min(r,n.end);var s=y(e,n.end,!0);return n.end=isNaN(s)?n.end:s,n.start=i&&i.mpd&&i.mpd.timeShiftBufferDepth&&!isNaN(i.mpd.timeShiftBufferDepth)&&!isNaN(n.end)?Math.max(n.end-i.mpd.timeShiftBufferDepth,n.start):n.start,n.start=y(e,n.start),{range:n,now:r}}function v(e,t){n=e-t.end}function y(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{for(var i=0,r=!1,a=NaN;!r&&i<e.length;){var o=e[i].getStreamInfo();o.start<=t&&(!isFinite(o.duration)||o.start+o.duration>=t)?(a=t,r=!0):!n&&o.start>t&&(isNaN(a)||o.start<a)?a=o.start:n&&o.start+o.duration<t&&(isNaN(a)||o.start+o.duration>a)&&(a=o.start+o.duration),i+=1}return a}catch(e){return t}}function _(e){void 0===e.offset||isNaN(e.offset)||d(e.offset/1e3)}function b(){i=0,n=0}function E(){s.off(u.Z.UPDATE_TIME_SYNC_OFFSET,_,this),b()}return e={initialize:function(){b(),s.on(u.Z.UPDATE_TIME_SYNC_OFFSET,_,this)},getClientTimeOffset:function(){return i},setClientTimeOffset:d,getClientReferenceTime:function(){return Date.now()-1e3*n+1e3*i},calcAvailabilityStartTimeFromPresentationTime:function(e,t,n){return h(e,t,n)},calcAvailabilityEndTimeFromPresentationTime:function(e,t,n){return h(e,t,n,!0)},calcPresentationTimeFromWallTime:p,calcPresentationTimeFromMediaTime:g,calcPeriodRelativeTimeFromMpdRelativeTime:function(e,t){return t-e.adaptation.period.start},calcMediaTimeFromPresentationTime:function(e,t){return e-t.adaptation.period.start+t.presentationTimeOffset},calcWallTimeForSegment:function(e,t){var n,i,r;return t&&(n=e.representation.adaptation.period.mpd.suggestedPresentationDelay,i=e.presentationStartTime+n,r=new Date(e.availabilityStartTime.getTime()+1e3*i)),r},calcTimeShiftBufferWindow:function(e,t){if(!t)return function(e){var t={start:NaN,end:NaN},n=0,i=NaN;return e.forEach(function(e){var t=e.getStreamInfo();n+=t.duration,(isNaN(i)||t.start<i)&&(i=t.start)}),t.start=i,t.end=i+n,t}(e);if(c.get().streaming.timeShiftBuffer.calcFromSegmentTimeline){var n=m(e);return v(n.now,n.range),n.range}return function(e){var t={start:NaN,end:NaN};if(!e||0===e.length)return t;var n=e[0].getAdapter().getRegularPeriods()[0],i=p(new Date,n),r=n.mpd.timeShiftBufferDepth,a=isNaN(r)?0:i-r;if(t.start=y(e,a),t.end=!isNaN(t.start)&&i<t.start?i:y(e,i,!0),!isNaN(r)&&t.end<i-r&&(t.end=NaN),c.get().streaming.timeShiftBuffer.fallbackToSegmentTimeline){var o=m(e);if(o.range.end<t.start)return s.trigger(f.Z.CONFORMANCE_VIOLATION,{level:on.LEVELS.WARNING,event:on.EVENTS.INVALID_DVR_WINDOW}),v(o.now,o.range),o.range}return t}(e)},reset:E},t=Ve(r).getInstance(),E(),e}ya.__dashjs_factory_name="TimelineConverter";var _a=c.Z.getSingletonFactory(ya),ba=n(4593),Ea=n(6934);function Ta(e){return Ta="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ta(e)}function Sa(e,t){return Sa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Sa(e,t)}function wa(e,t){return!t||"object"!==Ta(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Aa(e){return Aa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Aa(e)}var Ia=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sa(e,t)}(r,e);var t,n,i=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=Aa(t);if(n){var r=Aa(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return wa(this,e)});function r(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(e=i.call(this)).captionData=null,e.label=null,e.defaultTrack=!1,e.kind=null,e.isFragmented=!1,e.isEmbedded=!1,e.isTTML=null,e}return r}(Hr),xa=n(2295);function Ra(){var e=0;function t(e){for(var t="",n=0;n<e.length;++n)t+=e[n].uchar;return t.length-t.replace(/^\s+/,"").length}function n(e){return"left: "+3.125*e.x+"%; top: "+6.66*e.y1+"%; width: "+(100-3.125*e.x)+"%; height: "+6.66*Math.max(e.y2-1-e.y1,1)+"%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;"}function i(e){return"red"===e?"rgb(255, 0, 0)":"green"===e?"rgb(0, 255, 0)":"blue"===e?"rgb(0, 0, 255)":"cyan"===e?"rgb(0, 255, 255)":"magenta"===e?"rgb(255, 0, 255)":"yellow"===e?"rgb(255, 255, 0)":"white"===e?"rgb(255, 255, 255)":"black"===e?"rgb(0, 0, 0)":e}function r(e,t){var n=e.videoHeight/15;return t?"font-size: "+n+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; color: "+(t.foreground?i(t.foreground):"rgb(255, 255, 255)")+"; font-style: "+(t.italics?"italic":"normal")+"; text-decoration: "+(t.underline?"underline":"none")+"; white-space: pre; background-color: "+(t.background?i(t.background):"transparent")+";":"font-size: "+n+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;"}function a(e){return e.replace(/^\s+/g,"")}function o(e){return e.replace(/\s+$/g,"")}return{createHTMLCaptionsFromScreen:function(i,s,l,u){var c,d,f=null,h=!1,p=-1,g={start:s,end:l,spans:[]},m="style_cea608_white_black",v={},y={},_=[];for(c=0;c<15;++c){var b=u.rows[c],E="",T=null;if(!1===b.isEmpty()){var S=t(b.chars);null===f&&(f={x:S,y1:c,y2:c+1,p:[]}),S!==p&&h&&(f.p.push(g),g={start:s,end:l,spans:[]},f.y2=c,f.name="region_"+f.x+"_"+f.y1+"_"+f.y2,!1===v.hasOwnProperty(f.name)?(_.push(f),v[f.name]=f):v[f.name].p.contat(f.p),f={x:S,y1:c,y2:c+1,p:[]});for(var w=0;w<b.chars.length;++w){var A=b.chars[w],I=A.penState;if(null===T||!I.equals(T)){E.trim().length>0&&(g.spans.push({name:m,line:E,row:c}),E="");var x="style_cea608_"+I.foreground+"_"+I.background;I.underline&&(x+="_underline"),I.italics&&(x+="_italics"),y.hasOwnProperty(x)||(y[x]=JSON.parse(JSON.stringify(I))),T=I,m=x}E+=A.uchar}E.trim().length>0&&g.spans.push({name:m,line:E,row:c}),h=!0,p=S}else h=!1,p=-1,f&&(f.p.push(g),g={start:s,end:l,spans:[]},f.y2=c,f.name="region_"+f.x+"_"+f.y1+"_"+f.y2,!1===v.hasOwnProperty(f.name)?(_.push(f),v[f.name]=f):v[f.name].p.contat(f.p),f=null)}f&&(f.p.push(g),f.y2=c+1,f.name="region_"+f.x+"_"+f.y1+"_"+f.y2,!1===v.hasOwnProperty(f.name)?(_.push(f),v[f.name]=f):v[f.name].p.contat(f.p),f=null);var R=[];for(c=0;c<_.length;++c){var C=_[c],D="sub_cea608_"+e++,k=document.createElement("div");k.id=D;var M=n(C);k.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+M;var L=document.createElement("div");L.className="paragraph bodyStyle",L.style.cssText=r(i);var P=document.createElement("div");P.className="cueUniWrapper",P.style.cssText="unicode-bidi: normal; direction: ltr;";for(var N=0;N<C.p.length;++N){var O=C.p[N],F=0;for(d=0;d<O.spans.length;++d){var U=O.spans[d];if(U.line.length>0){if(0!==d&&F!=U.row){var B=document.createElement("br");B.className="lineBreak",P.appendChild(B)}var G=!1;F===U.row&&(G=!0),F=U.row;var j=y[U.name],V=document.createElement("span");V.className="spanPadding "+U.name+" customSpanColor",V.style.cssText=r(i,j),0!==d&&G?d===O.spans.length-1?V.textContent=o(U.line):V.textContent=U.line:O.spans.length>1&&d<O.spans.length-1&&U.row===O.spans[d+1].row?V.textContent=a(U.line):V.textContent=U.line.trim(),P.appendChild(V)}}}L.appendChild(P),k.appendChild(L);var H={bodyStyle:["%",90]};for(var K in y)y.hasOwnProperty(K)&&(H[K]=["%",90]);R.push({type:"html",start:s,end:l,cueHTMLElement:k,cueID:D,cellResolution:[32,15],isFromCEA608:!0,fontSize:H,lineHeight:{},linePadding:{}})}return R}}}Ra.__dashjs_factory_name="EmbeddedTextHtmlRender";var Ca=c.Z.getSingletonFactory(Ra);function Da(e){var t,n,i,o,s,c,f,h,p,g,m,v,y,_,b,E,S,w=e.errHandler,A=e.manifestModel,I=e.mediaController,R=e.videoModel,D=e.textTracks,k=e.vttParser,M=e.vttCustomRenderingParser,L=e.ttmlParser,P=e.streamInfo,N=e.settings,O=this.context,F=(0,l.Z)(O).getInstance(),U=!1;function B(){c=null,h=NaN,p=[],g=null,f=!1,s=[],o=null}function G(e){var t=new Ia;for(var n in e)t[n]=e[n];t.labels=e.labels,t.defaultTrack=function(e){var t=!1;return v.length>1&&e.isEmbedded?t=e.id&&e.id===a.Z.CC1:1===v.length?e.id&&"string"==typeof e.id&&"CC"===e.id.substring(0,2)&&(t=!0):0===v.length&&(t=e.index===s[0].index),t}(e),t.isFragmented=e.isFragmented,t.isEmbedded=!!e.isEmbedded,t.isTTML=function(e){return e.codec&&e.codec.search(a.Z.STPP)>=0||e.mimeType&&e.mimeType.search(a.Z.TTML)>=0}(e),t.kind=function(e,t){var n=e.roles&&e.roles.length>0?t[e.roles[0]]:t.caption;return n===t.caption||n===t.subtitle?n:t.caption}(e,{subtitle:"subtitles",caption:"captions"}),D.addTextTrack(t)}function j(e){var t=e.chunk;t.mediaInfo.embeddedCaptions&&H(t.bytes,t)}function V(e){m=e}function H(e,s){var l=s.mediaInfo,u=l.type,d=l.mimeType,p=l.codec||d;p?-1!==l.codec.indexOf("application/mp4")?function(e,r,s){var l;if("InitializationSegment"===r.segmentType)f=!0,h=i.getMediaTimescaleFromMoov(e);else{if(!f)return;(l=i.getSamplesInfo(e).sampleList).length>0&&(g=l[0].cts-r.start*h),s.search(a.Z.STPP)>=0?function(e,i,r){var s,l;for(o=null!==o?o:Z(r),s=0;s<i.length;s++){var u=i[s],d=u.cts,f=z(),p=f+d/h,g=p+u.duration/h;t.buffered.add(p,g);var v=new DataView(e,u.offset,u.subSizes[0]),y=Ea.Utils.dataViewToString(v,a.Z.UTF8),_=[],b=u.offset+u.subSizes[0];for(l=1;l<u.subSizes.length;l++){var E=new Uint8Array(e,b,u.subSizes[l]),T=String.fromCharCode.apply(null,E);_.push(T),b+=u.subSizes[l]}try{var S=A.getValue().ttmlTimeIsRelative?d/h:0,w=o.parse(y,S,d/h,(d+u.duration)/h,_);D.addCaptions(m,f,w)}catch(e){c.removeExecutedRequestsBeforeTime(),this.remove(),n.error("TTML parser error: "+e.message)}}}(e,l,s):function(e,i){var r,a,o,s=[];for(r=0;r<i.length;r++){var l=i[r];l.cts-=g;var u=z()+l.cts/h,c=u+l.duration/h;t.buffered.add(u,c);var d=e.slice(l.offset,l.offset+l.size),f=Ea.parseBuffer(d);for(a=0;a<f.boxes.length;a++){var p=f.boxes[a];if(n.debug("VTT box1: "+p.type),"vtte"!==p.type&&"vttc"===p.type){n.debug("VTT vttc boxes.length = "+p.boxes.length);var v={styles:{}};for(o=0;o<p.boxes.length;o++){var y=p.boxes[o];if(n.debug("VTT box2: "+y.type),"payl"===y.type)v.start=l.cts/h,v.end=(l.cts+l.duration)/h,v.data=y.cue_text;else if("sttg"===y.type&&y.settings&&""!==y.settings)try{var _=y.settings.split(" ");v.styles=k.getCaptionStyles(_)}catch(e){}}v&&v.data&&(s.push(v),n.debug("VTT  ".concat(v.start," - ").concat(v.end," :  ").concat(v.data)))}}}s.length>0&&D.addCaptions(m,0,s)}(e,l)}}(e,s,p):u===a.Z.VIDEO?function(e,t){var a,o;if(t.segmentType===C.w.INIT_SEGMENT_TYPE)0===y&&(y=i.getMediaTimescaleFromMoov(e));else if(t.segmentType===C.w.MEDIA_SEGMENT_TYPE){if(0===y)return void n.warn("CEA-608: No timescale for embeddedTextTrack yet");var s=(o=i.getSamplesInfo(e)).lastSequenceNumber,l=Math.trunc(t.start),u=Math.trunc(t.end);if(E[0]||E[1]||function(){for(var e,t=0;t<v.length;t++){if(-1===(e=D.getTrackIdxForId(v[t].id)))return void n.warn("CEA-608: data before track is ready.");var i=K(e);E[t]=new(r().Cea608Parser)(t+1,{newCue:i},null)}}(),y){if(function(e,t,n,i,r){return null!==e&&null!==t&&null!==i&&null!==r&&(t===e?i!==r:t!==e+n)}(_,s,o.numSequences,b,l))for(a=0;a<E.length;a++)E[a]&&E[a].reset();for(var c=function(e,t){if(0===t.length)return null;for(var n={splits:[],fields:[[],[]]},i=new DataView(e),a=0;a<t.length;a++)for(var o=t[a],s=r().findCea608Nalus(i,o.offset,o.size),l=null,u=0,c=0;c<s.length;c++)for(var d=r().extractCea608DataFromRange(i,s[c]),f=0;f<2;f++)if(d[f].length>0){o.cts!==l?u=0:u+=1;var h=z();n.fields[f].push([o.cts+h*y,d[f],u]),l=o.cts}return n.fields.forEach(function(e){e.sort(function(e,t){return e[0]===t[0]?e[2]-t[2]:e[0]-t[0]})}),n}(e,o.sampleList),d=0;d<E.length;d++){var f=c.fields[d],h=E[d];if(h)for(a=0;a<f.length;a++)h.addData(f[a][0]/y,f[a][1])}_=s,b=u}}}(e,s):function(e,n,i){var r,o,s=new DataView(e,0,e.byteLength);o=Ea.Utils.dataViewToString(s,a.Z.UTF8);try{r=Z(i).parse(o,0),D.addCaptions(D.getCurrentTrackIdx(),0,r),t.buffered&&t.buffered.add(n.start,n.end)}catch(e){w.error(new T.Z(x.TIMED_TEXT_ERROR_ID_PARSE_CODE,x.TIMED_TEXT_ERROR_MESSAGE_PARSE+e.message,o))}}(e,s,p):n.error("No text type defined")}function K(e){return function(t,n,i){var r;(r=R.getTTMLRenderingDiv()?S.createHTMLCaptionsFromScreen(R.getElement(),t,n,i):[{start:t,end:n,data:i.getDisplayText(),styles:{}}])&&D.addCaptions(e,0,r)}}function z(){return isNaN(t.timestampOffset)?0:t.timestampOffset}function Z(e){var t;return e.search(a.Z.VTT)>=0?t=N.get().streaming.text.webvtt.customRenderingEnabled&&M?M:k:(e.search(a.Z.TTML)>=0||e.search(a.Z.STPP)>=0)&&(t=L),t}function q(e){v.forEach(function(t){var n=D.getTrackIdxForId(t.id);n>=0&&D.deleteCuesFromTrackIdx(n,e.from,e.to)})}return t={initialize:function(){U||(v=[],m=null,y=0,E=[],_=null,b=null,U=!0,S=Ca(O).getInstance(),F.on(u.Z.VIDEO_CHUNK_RECEIVED,j,t),F.on(u.Z.BUFFER_CLEARED,q,t))},addMediaInfos:function(e,n,i){if(s=s.concat(n),e===a.Z.TEXT&&n[0].isFragmented&&!n[0].isEmbedded){c=i,t.buffered=(0,xa.Z)(O).create(),p=I.getTracksFor(a.Z.TEXT,P.id).filter(function(e){return e.isFragmented});for(var r=I.getCurrentTrackFor(a.Z.TEXT,P.id),o=0;o<p.length;o++)if(p[o]===r){V(o);break}}for(var l=0;l<n.length;l++)G(n[l])},resetMediaInfos:function(){s=[]},getStreamId:function(){return P.id},append:H,abort:function(){},addEmbeddedTrack:function(e){if(U&&e)if(e.id===a.Z.CC1||e.id===a.Z.CC3){for(var t=0;t<v.length;t++)if(v[t].id===e.id)return;v.push(e)}else n.warn("Embedded track "+e.id+" not supported!")},resetEmbedded:function(){F.off(u.Z.VIDEO_CHUNK_RECEIVED,j,t),F.off(u.Z.BUFFER_CLEARED,q,t),D&&D.deleteAllTextTracks(),U=!1,v=[],E=[null,null],_=null,b=null},getConfig:function(){return{fragmentModel:c,fragmentedTracks:p,videoModel:R}},setCurrentFragmentedTrackIdx:V,remove:function(e,n){void 0===e&&e===n&&(e=t.buffered.start(0),n=t.buffered.end(t.buffered.length-1)),t.buffered.remove(e,n),D.deleteCuesFromTrackIdx(m,e,n)},reset:function(){B(),s=[],i=null}},n=(0,d.Z)(O).getInstance().getLogger(t),i=(0,Ut.Z)(O).getInstance(),B(),t}Da.__dashjs_factory_name="TextSourceBuffer";var ka=c.Z.getClassFactory(Da),Ma=n(4403);function La(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Pa=["text","align","fontSize","id","isd","line","lineAlign","lineHeight","linePadding","position","positionAlign","region","size","snapToLines","vertical"];function Na(e){var t,n,i,r,o,s,c,h,p,g,m,v,y,_,b,E,T,S,w,A,I=this.context,x=(0,l.Z)(I).getInstance(),R=e.videoModel,C=e.streamInfo,D=e.settings;function k(e,t,n,i,r,a){var o=0,s=0;e/t>n/i?o=(s=t)/i*n:s=(o=e)/n*i;var l,u,c=0,d=0;return o/s>r?(d=s,c=s*r):(c=o,d=o/r),l=(e-c)/2,u=(t-d)/2,a?{x:l+.1*c,y:u+.1*d,w:.8*c,h:.8*d}:{x:l,y:u,w:c,h:d}}function M(e,t){var n=R.getClientWidth(),i=R.getClientHeight(),r=R.getVideoWidth(),a=R.getVideoHeight(),o=R.getVideoRelativeOffsetTop(),s=R.getVideoRelativeOffsetLeft();if(0!==r&&0!==a){var l=r/a,u=!1;e.isFromCEA608&&(l=3.5/3,u=!0);var d=k.call(this,n,i,r,a,l,u),v=d.w,y=d.h,E=d.x,S=d.y;if(v!=p||y!=g||E!=c||S!=h||t){if(c=E+s,h=S+o,p=v,g=y,m){var w=m.style;w&&(w.left=c+"px",w.top=h+"px",w.width=p+"px",w.height=g+"px",w.zIndex=_&&document[_]||b?T:null,x.trigger(f.Z.CAPTION_CONTAINER_RESIZE))}var A=e.activeCues;if(A)for(var I=A.length,C=0;C<I;++C){var D=A[C];D.scaleCue(D)}}}}function L(e){var t,n,i,r,a,o=p,s=g;if(e.cellResolution){var l=[o/e.cellResolution[0],s/e.cellResolution[1]];if(e.linePadding)for(t in e.linePadding)if(e.linePadding.hasOwnProperty(t)){n=(e.linePadding[t]*l[0]).toString();for(var u=document.getElementsByClassName("spanPadding"),c=0;c<u.length;c++)u[c].style.cssText=u[c].style.cssText.replace(/(padding-left\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n),u[c].style.cssText=u[c].style.cssText.replace(/(padding-right\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n)}if(e.fontSize){for(t in e.fontSize)if(e.fontSize.hasOwnProperty(t)){"%"===e.fontSize[t][0]?i=e.fontSize[t][1]/100:"c"===e.fontSize[t][0]&&(i=e.fontSize[t][1]),n=(i*l[1]).toString(),a="defaultFontSize"!==t?document.getElementsByClassName(t):document.getElementsByClassName("paragraph");for(var d=0;d<a.length;d++)a[d].style.cssText=a[d].style.cssText.replace(/(font-size\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n)}if(e.lineHeight)for(t in e.lineHeight)if(e.lineHeight.hasOwnProperty(t)){"%"===e.lineHeight[t][0]?r=e.lineHeight[t][1]/100:"c"===e.fontSize[t][0]&&(r=e.lineHeight[t][1]),n=(r*l[1]).toString(),a=document.getElementsByClassName(t);for(var f=0;f<a.length;f++)a[f].style.cssText=a[f].style.cssText.replace(/(line-height\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n)}}}if(e.isd){var h=document.getElementById(e.cueID);h&&m.removeChild(h),N(e)}}function P(e,t){var n=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/,i=/^#(.*)$/;if(n.test(t)){var r=n.exec(t),a=parseInt(r[4],10)-1;return"data:image/png;base64,"+btoa(e.images[a])}if(i.test(t)){var o=i.exec(t)[1];return"data:image/png;base64,"+e.embeddedImages[o]}return t}function N(e){if(m){re.call(this);var t=document.createElement("div");m.appendChild(t),E=(0,Ma.renderHTML)(e.isd,t,function(t){return P(e,t)},m.clientHeight,m.clientWidth,D.get().streaming.text.imsc.displayForcedOnlyMode,function(e){n.info("renderCaption :",e)},E,D.get().streaming.text.imsc.enableRollUp),t.id=e.cueID,x.trigger(f.Z.CAPTION_RENDERED,{captionDiv:t,currentTrackIdx:s})}}function O(e,t){return!!t&&t.endTime>=e.startTime}function F(e,t){return!!D.get().streaming.text.extendSegmentedCues&&!!function(e,t,n){for(var i=0;i<n.length;i++){var r=n[i];if(JSON.stringify(e[r])!==JSON.stringify(t[r]))return!1}return!0}(t,e,Pa)&&(t.endTime=Math.max(t.endTime,e.endTime),!0)}function U(e,t){t&&t.forEach(function(t){t.kind&&"image"===t.kind&&(t.src=P(e,t.src)),U(e,t.contents)})}function B(e,t,i){var r=W(e),o=D.get().streaming.text.dispatchForManualRendering;if(r&&Array.isArray(i)&&0!==i.length)for(var s=0;s<i.length;s++){var l=null,u=i[s];r.cellResolution=u.cellResolution,r.isFromCEA608=u.isFromCEA608,isNaN(u.start)||isNaN(u.end)||(o?l=G(u,t):z(u)&&m?l=H(u,t,r):u.data&&(l=K(u,t,r)));try{if(l){if(!Q(r,l))if(D.get().streaming.text.webvtt.customRenderingEnabled)r.manualCueList||(r.manualCueList=[]),r.manualCueList.push(l);else{var c=void 0;r.cues&&0!==r.cues.length&&(c=r.cues[r.cues.length-1]),O(l,c)?F(l,c)||(c.isd&&(c.onexit=function(){}),r.mode!==a.Z.TEXT_DISABLED&&r.addCue(l)):r.mode!==a.Z.TEXT_DISABLED&&r.addCue(l)}var d=D.get().streaming.buffer.bufferToKeep;ee(r,0,R.getTime()-d)}else n.error("Impossible to display subtitles. You might have missed setting a TTML rendering div via player.attachTTMLRenderingDiv(TTMLRenderingDiv)")}catch(e){throw te(r),r.addCue(l),e}}}function G(e,t){var n=Z(e,t);return n.onenter=function(){z(e)&&A&&A.cueID!==n.cueID&&V(A),delete n.type,A=n,j(n)},n.onexit=function(){V(n),A=null},n}function j(e){x.trigger(f.Z.CUE_ENTER,e)}function V(e){x.trigger(f.Z.CUE_EXIT,{cueID:e.cueID})}function H(e,t,i){var r=this,o=Z(e,t);return m.style.left=c+"px",m.style.top=h+"px",m.style.width=p+"px",m.style.height=g+"px",o.onenter=function(){var e=this;i.mode===a.Z.TEXT_SHOWING&&(this.isd?(w?requestAnimationFrame(function(){return N(e)}):N(this),n.debug("Cue enter id:"+this.cueID)):(m.appendChild(this.cueHTMLElement),L.call(r,this),x.trigger(f.Z.CAPTION_RENDERED,{captionDiv:this.cueHTMLElement,currentTrackIdx:s})))},o.onexit=function(){if(m)for(var e=m.childNodes,t=0;t<e.length;++t)e[t].id===this.cueID&&(n.debug("Cue exit id:"+e[t].id),m.removeChild(e[t]),--t)},o}function K(e,t,i){var r=Z(e,t);if(r.isActive=!1,e.styles)try{void 0!==e.styles.align&&"align"in r&&(r.align=e.styles.align),void 0!==e.styles.line&&"line"in r&&(r.line=e.styles.line),void 0!==e.styles.snapToLines&&"snapToLines"in r&&(r.snapToLines=e.styles.snapToLines),void 0!==e.styles.position&&"position"in r&&(r.position=e.styles.position),void 0!==e.styles.size&&"size"in r&&(r.size=e.styles.size)}catch(e){n.error(e)}return r.onenter=function(){i.mode===a.Z.TEXT_SHOWING&&x.trigger(f.Z.CAPTION_RENDERED,{currentTrackIdx:s})},r}function z(e){return"html"===e.type}function Z(e,t){return z(e)?function(e,t){var n=new i(e.start+t,e.end+t,"");return n.cueHTMLElement=e.cueHTMLElement,n.isd=e.isd,n.images=e.images,n.embeddedImages=e.embeddedImages,n.cueID=e.cueID,n.scaleCue=L.bind(self),n.cellResolution=e.cellResolution,n.lineHeight=e.lineHeight,n.linePadding=e.linePadding,n.fontSize=e.fontSize,n.isd&&U(n,n.isd.contents),n}(e,t):function(e,t){var n=new i(e.start-t,e.end-t,e.data);return n.cueID="".concat(n.startTime,"_").concat(n.endTime),n}(e,t)}function q(e){if(v)for(var t=v.childNodes,n=0;n<t.length;++n)t[n].id===e.cueID&&(v.removeChild(t[n]),--n)}function Y(){var e,t=[],n=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return La(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?La(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(R.getTextTracks());try{for(n.s();!(e=n.n()).done;){var i=e.value;i.manualMode===a.Z.TEXT_SHOWING&&t.push(i)}}catch(e){n.e(e)}finally{n.f()}return t}function W(e){return e>=0&&r[e]?R.getTextTrack(r[e].kind,r[e].id,r[e].lang,r[e].isTTML,r[e].isEmbedded):null}function $(e){var t=this;if(e!==s){var n=W(s=e);X.call(this,n),y&&(clearInterval(y),y=null),n&&"html"===n.renderingType&&(M.call(this,n,!0),window.ResizeObserver?(S=new window.ResizeObserver(function(){M.call(t,n,!0)})).observe(R.getElement()):y=setInterval(M.bind(this,n),500))}}function X(e){re.call(this),e&&"html"===e.renderingType?ne.call(this):ie.call(this)}function Q(e,t){if(!e.cues)return!1;for(var n=0;n<e.cues.length;n++)if(e.cues[n].startTime===t.startTime&&e.cues[n].endTime===t.endTime)return!0;return!1}function J(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return!!e&&(isNaN(t)||(i?e.startTime:e.endTime)>=t)&&(isNaN(n)||(i?e.endTime:e.startTime)<=n)}function ee(e,t,n){var i,r;if(!(n<t)&&e&&(e.cues||e.manualCueList)){var a=e.cues&&e.cues.length>0?"native":"custom",o="native"===a?e.cues:e.manualCueList;if(!o||0===o.length)return;for(var s=o.length-1;s>=0;s--)!J(o[s],t,n,!0)||(i=o[s],r=R.getTime(),i.startTime>=r&&i.endTime<=r)||("native"===a?e.removeCue(o[s]):(q(o[s]),delete e.manualCueList[s]))}}function te(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(e&&(e.cues||e.manualCueList)){var r=e.cues&&e.cues.length>0?"native":"custom",a="native"===r?e.cues:e.manualCueList;if(!a||0===a.length)return;for(var o=a.length-1,s=o;s>=0;s--)J(a[s],t,n,i)&&("native"===r?(a[s].onexit&&a[s].onexit(),e.removeCue(a[s])):(q(a[s]),delete e.manualCueList[s]))}}function ne(){var e=document.getElementById("native-cue-style");if(!e){(e=document.createElement("style")).id="native-cue-style",document.head.appendChild(e);var t=e.sheet,i=R.getElement();try{i&&(i.id?t.insertRule("#"+i.id+"::cue {background: transparent}",0):0!==i.classList.length?t.insertRule("."+i.className+"::cue {background: transparent}",0):t.insertRule("video::cue {background: transparent}",0))}catch(e){n.info(""+e.message)}}}function ie(){var e=document.getElementById("native-cue-style");e&&document.head.removeChild(e)}function re(){if(m)for(;m.firstChild;)m.removeChild(m.firstChild)}return t={initialize:function(){"undefined"!=typeof window&&"undefined"!=typeof navigator&&(i=window.VTTCue||window.TextTrackCue,r=[],o=[],s=-1,c=0,h=0,p=0,g=0,m=null,v=null,y=null,b=!1,T=2147483647,E=null,w="requestAnimationFrame"in window,void 0!==document.fullscreenElement?_="fullscreenElement":void 0!==document.webkitIsFullScreen?_="webkitIsFullScreen":document.msFullscreenElement?_="msFullscreenElement":document.mozFullScreen&&(_="mozFullScreen"))},getStreamId:function(){return C.id},addTextTrack:function(e){r.push(e)},addCaptions:B,createTracks:function(){var e=D.get().streaming.text.dispatchForManualRendering;r.sort(function(e,t){return e.index-t.index}),m=R.getTTMLRenderingDiv(),v=R.getVttRenderingDiv();for(var t,n,i,l,c,d,h=-1,p=0;p<r.length;p++){var g=(n=(t=r[p]).kind,i=void 0!==t.id?t.id:t.lang,l=t.lang,c=t.isTTML,d=t.isEmbedded,R.addTextTrack(n,i,l,c,d));o.push(g),r[p].defaultTrack&&(g.default=!0,h=p);var y=W(p);y&&(y.mode=a.Z.TEXT_SHOWING,m&&(r[p].isTTML||r[p].isEmbedded)?y.renderingType="html":y.renderingType="default"),B(p,0,r[p].captionData),x.trigger(f.Z.TEXT_TRACK_ADDED)}if($.call(this,h),h>=0){x.on(f.Z.PLAYBACK_METADATA_LOADED,function e(){var t=W(h);t&&"html"===t.renderingType&&M.call(this,t,!0),x.off(f.Z.PLAYBACK_METADATA_LOADED,e,this)},this);for(var _=0;_<r.length;_++){var b=W(_);b&&(b.mode=_!==h||e?a.Z.TEXT_HIDDEN:a.Z.TEXT_SHOWING,b.manualMode=_===h?a.Z.TEXT_SHOWING:a.Z.TEXT_HIDDEN)}}x.trigger(u.Z.TEXT_TRACKS_QUEUE_INITIALIZED,{index:s,tracks:r,streamId:C.id})},getCurrentTrackIdx:function(){return s},setCurrentTrackIdx:$,getTrackIdxForId:function(e){for(var t=-1,n=0;n<r.length;n++)if(r[n].id===e){t=n;break}return t},getCurrentTrackInfo:function(){return r[s]},setModeForTrackIdx:function(e,t){var n=W(e);n&&n.mode!==t&&(n.mode=t),n&&n.manualMode!==t&&(n.manualMode=t)},deleteCuesFromTrackIdx:function(e,t,n){var i=W(e);i&&te(i,t,n)},deleteAllTextTracks:function(){for(var e=o?o.length:0,t=0;t<e;t++){var n=W(t);n&&te.call(this,n,C.start,C.start+C.duration,!1)}o=[],r=[],y&&(clearInterval(y),y=null),S&&R&&(S.unobserve(R.getElement()),S=null),s=-1,re.call(this)},manualCueProcessing:function(e){var t=Y();if(t&&t.length>0){var n=t[0].manualCueList;n&&n.length>0&&n.forEach(function(t){t.startTime<=e&&t.endTime>=e&&!t.isActive?(t.isActive=!0,D.get().streaming.text.dispatchForManualRendering?j(t):WebVTT.processCues(window,[t],v,t.cueID)):t.isActive&&(t.startTime>e||t.endTime<e)&&(t.isActive=!1,D.get().streaming.text.dispatchForManualRendering?V(t):q(t))})}},disableManualTracks:function(){var e=Y();if(e&&e.length>0){var t=e[0].manualCueList;t&&t.length>0&&t.forEach(function(e){if(e.isActive)if(e.isActive=!1,D.get().streaming.text.dispatchForManualRendering)V(e);else if(v)for(var t=v.childNodes,n=0;n<t.length;++n)t[n].id===e.cueID&&(v.removeChild(t[n]),--n)})}}},n=(0,d.Z)(I).getInstance().getLogger(t),t}Na.__dashjs_factory_name="TextTracks";var Oa=c.Z.getClassFactory(Na);function Fa(){var e,t,n,i,r,a,o=this.context;function s(e){var t=e.split(":"),n=t.length-1;return e=60*parseInt(t[n-1],10)+parseFloat(t[n]),2===n&&(e+=3600*parseInt(t[0],10)),e}function l(e){var t=e.split(i),n=t[1].split(a);return n.shift(),t[1]=n[0],n.shift(),{cuePoints:t,styles:u(n)}}function u(e){var t={};return e.forEach(function(e){if(e.split(/:/).length>1){var n=e.split(/:/)[1],i=!1;n&&-1!=n.search(/%/)&&(i=!0,n=parseInt(n.replace(/%/,""),10)),(e.match(/align/)||e.match(/A/))&&(t.align=n),(e.match(/line/)||e.match(/L/))&&(t.line="auto"===n?n:parseInt(n,10),i&&(t.snapToLines=!1)),(e.match(/position/)||e.match(/P/))&&(t.position=n),(e.match(/size/)||e.match(/S/))&&(t.size=n)}}),t}function c(e,t){for(var n,r=t,a="",o="";""!==e[r]&&r<e.length;)r++;if((n=r-t)>1)for(var s=0;s<n;s++){if((o=e[t+s]).match(i)){a="";break}a+=o,s!==n-1&&(a+="\n")}else(o=e[t]).match(i)||(a=o);return a}return e={parse:function(e){var a,o,u=[];if(!e)return u;a=(e=e.split(n)).length,o=-1;for(var d=0;d<a;d++){var f=e[d];if(f.length>0&&"WEBVTT"!==f&&f.match(i)){var h=l(f),p=h.cuePoints,g=h.styles,m=c(e,d+1),v=s(p[0].replace(r,"")),y=s(p[1].replace(r,""));!isNaN(v)&&!isNaN(y)&&v>=o&&y>v?""!==m?(o=v,u.push({start:v,end:y,data:m,styles:g})):t.error("Skipping cue due to empty/malformed cue text"):t.error("Skipping cue due to incorrect cue timing")}}return u},getCaptionStyles:u},t=(0,d.Z)(o).getInstance().getLogger(e),n=/(?:\r\n|\r|\n)/gm,i=/-->/,r=/(^[\s]+|[\s]+$)/g,a=/\s\b/g,e}Fa.__dashjs_factory_name="VTTParser";var Ua=c.Z.getSingletonFactory(Fa);function Ba(){var e,t;return e={parse:function(e){var n=[];return t.oncue=function(e){e.start=e.startTime,e.end=e.endTime,e.data=e.text,e.styles={align:e.align,line:e.line,position:e.position,size:e.size},n.push(e)},t.parse(e),n}},function(){try{window&&window.WebVTT&&window.WebVTT.Parser&&(t=new window.WebVTT.Parser(window,window.vttjs,window.WebVTT.StringDecoder()))}catch(e){}}(),e}Ba.__dashjs_factory_name="VttCustomRenderingParser";var Ga=c.Z.getSingletonFactory(Ba);function ja(){var e,t,n=this.context,i=(0,l.Z)(n).getInstance(),r=0;return e={parse:function(e,n,a,o,s){var l,c,d,h="",p=[],g={},m={},v="",y="",_={onOpenTag:function(e,n,r){if(r[" imagetype"]&&!r[" imageType"]&&(i.trigger(f.Z.CONFORMANCE_VIOLATION,{level:on.LEVELS.ERROR,event:on.EVENTS.NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE}),r[" imageType"]=r[" imagetype"]),"image"===n&&("http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt"===e||"http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"===e)){if(!r[" imageType"]||"PNG"!==r[" imageType"].value)return void t.warn("smpte-tt imageType != PNG. Discarded");v=r["http://www.w3.org/XML/1998/namespace id"].value}},onCloseTag:function(){v&&(m[v]=y.trim()),y="",v=""},onText:function(e){v&&(y+=e)}};if(!e)throw h="no ttml data to parse",new Error(h);g.data=e,i.trigger(u.Z.TTML_TO_PARSE,g);var b=(0,Ma.fromXML)(g.data,function(e){h=e},_);i.trigger(u.Z.TTML_PARSED,{ttmlString:g.data,ttmlDoc:b});var E,T=b.getMediaTimeEvents();for(d=0;d<T.length;d++){var S=(0,Ma.generateISD)(b,T[d],function(e){h=e});S.contents.some(function(e){return e.contents.length})&&(l=T[d]+n)<(c=T[d+1]+n)&&p.push({start:l,end:c,type:"html",cueID:(E="cue_TTML_"+r,r++,E),isd:S,images:s,embeddedImages:m})}if(""!==h)throw t.error(h),new Error(h);return p}},t=(0,d.Z)(n).getInstance().getLogger(e),e}ja.__dashjs_factory_name="TTMLParser";var Va=c.Z.getSingletonFactory(ja);function Ha(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function Ka(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ha(Object(n),!0).forEach(function(t){za(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ha(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function za(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Za(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function qa(e){var t,n,i,r=this.context,o=(0,l.Z)(r).getInstance(),s=(0,X.Z)(r).getInstance(),u=e.adapter,c=e.baseURLController;function h(e,t){var n,r,o=!1;if(c.resolve()){var l=u.getVoRepresentations(e);l&&l.length>0&&(n=c.resolve(l[0].path).url)}var d=e.essentialPropertiesAsArray.filter(function(e){return e.schemeIdUri&&e.schemeIdUri===a.Z.FONT_DOWNLOAD_DVB_SCHEME}),f=e.supplementalPropertiesAsArray.filter(function(e){return e.schemeIdUri&&e.schemeIdUri===a.Z.FONT_DOWNLOAD_DVB_SCHEME});d.length>0?(o=!0,r=d):r=f,r.forEach(function(r){if(function(e){return!(!(e.value&&"1"===e.value&&e.dvbUrl&&e.dvbUrl.length>0&&e.dvbFontFamily&&e.dvbFontFamily.length>0&&e.dvbMimeType)||e.dvbMimeType!==a.Z.OFF_MIMETYPE&&e.dvbMimeType!==a.Z.WOFF_MIMETYPE)}(r)){var l=(u=r.dvbUrl,c=n,s.isPathAbsolute(u)?u:s.isRelative(u)?c?s.resolve(u,c):s.resolve(u):u);i.push({fontFamily:r.dvbFontFamily,url:l,mimeType:r.dvbMimeType,trackId:e.id,streamId:t,isEssential:o,status:"unloaded",fontFace:new FontFace(r.dvbFontFamily,"url(".concat(l,")"),{display:"swap"})})}var u,c})}function p(e,t){var n=i[e];i[e]=Ka(Ka({},n),{},{status:t})}function g(){i=[]}return t={addFontsFromTracks:function(e,t){if(e&&Array.isArray(e)&&t)for(var n=0;n<e.length;n++)h(e[n],t)},downloadFonts:function(){for(var e=function(e){var t=i[e];document.fonts.add(t.fontFace),o.trigger(f.Z.DVB_FONT_DOWNLOAD_ADDED,t),t.fontFace.load().then(function(){p(e,"loaded"),o.trigger(f.Z.DVB_FONT_DOWNLOAD_COMPLETE,t)},function(i){p(e,"error"),n.debug("Font download error: ",i),o.trigger(f.Z.DVB_FONT_DOWNLOAD_FAILED,t)})},t=0;t<i.length;t++)e(t)},getFonts:function(){return i},getFontsForTrackId:function(e){return i.filter(function(t){return t.trackId&&t.trackId===e})},reset:function(){!function(){var e,t=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Za(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Za(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(i);try{for(t.s();!(e=t.n()).done;){var r=e.value,a=document.fonts.delete(r.fontFace);n.debug("Removal of fontFamily: ".concat(r.fontFamily," was ").concat(a?"successful":"unsuccessful"))}}catch(e){t.e(e)}finally{t.f()}}(),g()}},n=(0,d.Z)(r).getInstance().getLogger(t),g(),t}qa.__dashjs_factory_name="DVBFonts";var Ya=c.Z.getClassFactory(qa);function Wa(e){var t,n,i,r,o,s,c,h,p,g,m,v,y,_,b=this.context,E=e.adapter,T=e.errHandler,S=e.manifestModel,w=e.mediaController,A=e.baseURLController,I=e.videoModel,x=e.settings;function R(e){if(_.error("Could not download ".concat(e.isEssential?"an essential":"a"," font - fontFamily: ").concat(e.fontFamily,", url: ").concat(e.url)),e.isEssential){var t=r[e.streamId].getTrackIdxForId(e.trackId);r[e.streamId].setModeForTrackIdx(t,a.Z.TEXT_DISABLED)}}function C(e){if(_.debug("Successfully downloaded ".concat(e.isEssential?"an essential":"a"," font - fontFamily: ").concat(e.fontFamily,", url: ").concat(e.url)),e.isEssential){var t=r[e.streamId].getTrackIdxForId(e.trackId);t===r[e.streamId].getCurrentTrackIdx()?r[e.streamId].setModeForTrackIdx(t,a.Z.TEXT_SHOWING):r[e.streamId].setModeForTrackIdx(t,a.Z.TEXT_HIDDEN)}}function D(e){var t=e.tracks,i=e.index,o=e.streamId;if(!1===x.get().streaming.text.defaultEnabled&&!L()||v)P(o,-1);else{var s=w.getCurrentTrackFor(a.Z.TEXT,o);if(s){var l={lang:s.lang,role:s.roles[0],index:s.index,codec:s.codec,accessibility:s.accessibility[0]};t.some(function(e,t){if(w.matchSettings(l,e))return P(o,t),i=t,!0})}p=!1}n[o].lastEnabledIndex=i,h.trigger(f.Z.TEXT_TRACKS_ADDED,{enabled:L(),index:i,tracks:t,streamId:o}),m=!0,y.addFontsFromTracks(t,o),y.getFonts().forEach(function(e){if(e.isEssential){var t=r[e.streamId].getTrackIdxForId(e.trackId);r[e.streamId].setModeForTrackIdx(t,a.Z.TEXT_DISABLED)}}),y.downloadFonts()}function k(e){try{var t=e.streamId;if(!r[t]||isNaN(e.time))return;r[t].manualCueProcessing(e.time)}catch(e){}}function M(e){try{var t=e.streamId;if(!r[t])return;r[t].disableManualTracks()}catch(e){}}function L(){var e=!0;return p&&!g&&(e=!1),e}function P(e,t){(p=-1===t)&&w&&w.saveTextSettingsDisabled();var n=N(e);if(n!==t&&r[e]){r[e].disableManualTracks();var o=r[e].getCurrentTrackInfo(),s=o?I.getTextTrack(o.kind,o.id,o.lang,o.isTTML,o.isEmbedded):null;s&&s.mode!==a.Z.TEXT_DISABLED&&r[e].setModeForTrackIdx(n,a.Z.TEXT_HIDDEN),r[e].setCurrentTrackIdx(t),o=r[e].getCurrentTrackInfo();var l=x.get().streaming.text.dispatchForManualRendering;o&&!l&&o.mode!==a.Z.TEXT_DISABLED&&r[e].setModeForTrackIdx(t,a.Z.TEXT_SHOWING),o&&o.isFragmented&&!o.isEmbedded?function(e,t,n){if(i[e])for(var o=i[e].getConfig().fragmentedTracks,s=0;s<o.length;s++){var l=o[s];if(t.lang===l.lang&&(l.id?t.id===l.id:t.index===l.index)){var c=w.getCurrentTrackFor(a.Z.TEXT,e);(l.id?c.id!==l.id:c.index!==l.index)?(r[e].deleteCuesFromTrackIdx(n),i[e].setCurrentFragmentedTrackIdx(s)):-1===n&&h.trigger(u.Z.SET_FRAGMENTED_TEXT_AFTER_DISABLED,{},{streamId:e,mediaType:a.Z.TEXT})}}}(e,o,n):o&&!o.isFragmented&&function(e,t){h.trigger(u.Z.SET_NON_FRAGMENTED_TEXT,{currentTrackInfo:t},{streamId:e,mediaType:a.Z.TEXT})}(e,o),w.setTrack(o)}}function N(e){return r[e].getCurrentTrackIdx()}function O(){i={},r={},n={},p=!0,m=!1,v=!1}return t={deactivateStream:function(e){if(e){var t=e.id;i[t]&&i[t].resetMediaInfos(),r[t]&&r[t].deleteAllTextTracks()}},initialize:function(){y=Ya(b).create({adapter:E,baseURLController:A}),h.on(u.Z.TEXT_TRACKS_QUEUE_INITIALIZED,D,t),h.on(u.Z.DVB_FONT_DOWNLOAD_FAILED,R,t),h.on(u.Z.DVB_FONT_DOWNLOAD_COMPLETE,C,t),x.get().streaming.text.webvtt.customRenderingEnabled&&(h.on(u.Z.PLAYBACK_TIME_UPDATED,k,t),h.on(u.Z.PLAYBACK_SEEKING,M,t))},initializeForStream:function(e){var t=e.id,a=Oa(b).create({videoModel:I,settings:x,streamInfo:e});a.initialize(),r[t]=a;var l=ka(b).create({errHandler:T,adapter:E,dvbFonts:y,manifestModel:S,mediaController:w,videoModel:I,textTracks:a,vttParser:o,vttCustomRenderingParser:s,ttmlParser:c,streamInfo:e,settings:x});l.initialize(),i[t]=l,n[t]={},n[t].lastEnabledIndex=-1},createTracks:function(e){var t=e.id;r[t]&&r[t].createTracks()},getTextSourceBuffer:function(e){var t=e.id;if(i&&i[t])return i[t]},getAllTracksAreDisabled:function(){return p},addEmbeddedTrack:function(e,t){var n=e.id;i[n]&&i[n].addEmbeddedTrack(t)},enableText:function(e,t){return(0,Y.PS)(t,"boolean"),L()!==t&&(t&&P(e,n[e].lastEnabledIndex),t||(n[e].lastEnabledIndex=N(e),m?P(e,-1):v=!0)),!0},isTextEnabled:L,setTextTrack:P,getCurrentTrackIdx:N,enableForcedTextStreaming:function(e){return(0,Y.PS)(e,"boolean"),g=e,!0},addMediaInfosToBuffer:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=e.id;i[a]&&i[a].addMediaInfos(t,n,r)},reset:function(){y.reset(),O(),h.off(u.Z.TEXT_TRACKS_QUEUE_INITIALIZED,D,t),h.off(u.Z.DVB_FONT_DOWNLOAD_FAILED,R,t),h.off(u.Z.DVB_FONT_DOWNLOAD_COMPLETE,C,t),x.get().streaming.text.webvtt.customRenderingEnabled&&(h.off(u.Z.PLAYBACK_TIME_UPDATED,k,t),h.off(u.Z.PLAYBACK_SEEKING,M,t)),Object.keys(i).forEach(function(e){i[e].resetEmbedded(),i[e].reset()})}},g=!1,m=!1,v=!1,o=Ua(b).getInstance(),s=Ga(b).getInstance(),c=Va(b).getInstance(),h=(0,l.Z)(b).getInstance(),_=(0,d.Z)(b).getInstance().getLogger(t),O(),t}Wa.__dashjs_factory_name="TextController";var $a=c.Z.getClassFactory(Wa);function Xa(){var e,t,n,i,h,g,m,v,y,_,b,E,S,w,A,I,D,k,M,L,P,N,O,F,U,B,G,j,V,H,K,z,Z,q,W,Q,J,ee,te,ne="You must first call initialize() and set a source before calling this method",ie="You must first call initialize() and set a valid source and view before calling this method",re="You must first call attachView() to set the video element before calling this method",ae="You must first call attachSource() with a valid source before calling this method",oe="MediaPlayer not initialized!",se=this.context,le=(0,l.Z)(se).getInstance(),ue=(0,R.Z)(se).getInstance(),ce=(0,d.Z)(se).getInstance({settings:ue});function de(){Ae(null),Se(null),i=null,w&&(w.reset(),w=null),A&&(A.reset(),A=null),L&&L.reset(),ue.reset(),D&&(D.reset(),D=null)}function fe(){return!!n&&!!Q.getElement()}function he(){return(0,Mr.e)()}function pe(){if(!m)throw ie;return j.isPaused()}function ge(){if(!m)throw ie;return j.getIsDynamic()}function me(e){var t=U&&U.hasVideoTrack()?a.Z.VIDEO:a.Z.AUDIO,n=z.getCurrentDVRInfo(t);if(!n)return 0;var i=j.getOriginalLiveDelay(),r=n.range.start+e;return r>n.range.end-i&&(r=n.range.end-i),r}function ve(e){if(!m)throw ie;var t=Te().currentTime;if(void 0!==e)t=U.getTimeRelativeToStreamId(t,e);else if(j.getIsDynamic()){var n=U&&U.hasVideoTrack()?a.Z.VIDEO:a.Z.AUDIO,i=z.getCurrentDVRInfo(n);t=null===i||0===t?0:Math.max(0,t-i.range.start)}return t}function ye(){if(!m)throw ie;var e=Te().duration;if(j.getIsDynamic()){var t=U&&U.hasVideoTrack()?a.Z.VIDEO:a.Z.AUDIO,n=z.getCurrentDVRInfo(t);e=n?n.range.end-n.range.start:0}return e}function _e(e){(0,Y.PS)(e,"boolean"),v=e}function be(){L.restoreDefaultUTCTimingSources()}function Ee(){return z}function Te(){if(!Q.getElement())throw re;return Q.getElement()}function Se(e){if(!h)throw oe;Q.setElement(e),e&&(De(),function(){if(!A){var e=dashjs.MetricsReporting;if("function"==typeof e){var t=e(se).create();A=t.createMetricsReporting({debug:ce,eventBus:le,mediaElement:Te(),adapter:k,dashMetrics:z,mediaPlayerModel:M,events:u.Z,constants:a.Z,metricsConstants:s.Z})}}}(),function(){if(!I){var e=dashjs.MssHandler;"function"==typeof e&&(x.extend(e.errors),I=e(se).create({eventBus:le,mediaPlayerModel:M,dashMetrics:z,manifestModel:Z,playbackController:j,streamController:U,protectionController:w,baseURLController:N,errHandler:P,events:u.Z,constants:a.Z,debug:ce,initSegmentType:C.w.INIT_SEGMENT_TYPE,BASE64:ba,ISOBoxer:Ea,settings:ue}))}}(),U&&U.switchToVideoElement(y)),m&&xe(),Le(y)}function we(e){if(!g)throw ne;var t=U.getActiveStreamInfo();return t?S.getTracksFor(e,t.id):[]}function Ae(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:NaN;if(!h)throw oe;"string"==typeof e&&J.initialize(e),null==t&&(t=NaN),isNaN(t)||(t=Math.max(0,t)),y=t,n=e,(g||m)&&xe(),fe()&&Le(y)}function Ie(){if(!g)throw ne;var e=U.getActiveStreamInfo();return e?U.getStreamById(e.id):null}function xe(){m=!1,g=!1,k.reset(),U.reset(),G.reset(),K.reset(),j.reset(),V.reset(),H.reset(),_.reset(),S.reset(),te.reset(),w&&(ue.get().streaming.protection.keepProtectionMediaKeys?w.stop():(w.reset(),w=null,De())),B.reset(),q.reset(),W.reset()}function Re(){var e=Ce();U||(U=un(se).getInstance()),B||(B=$a(se).create({errHandler:P,manifestModel:Z,adapter:k,mediaController:S,baseURLController:N,videoModel:Q,settings:ue})),F.setConfig({capabilities:O,customParametersModel:L,adapter:k,settings:ue,manifestModel:Z,errHandler:P}),U.setConfig({capabilities:O,capabilitiesFilter:F,manifestLoader:e,manifestModel:Z,mediaPlayerModel:M,customParametersModel:L,protectionController:w,textController:B,adapter:k,dashMetrics:z,errHandler:P,timelineConverter:E,videoModel:Q,playbackController:j,serviceDescriptionController:V,contentSteeringController:H,abrController:_,mediaController:S,settings:ue,baseURLController:N,uriFragmentModel:J,segmentBaseController:te}),G.setConfig({settings:ue,playbackController:j,streamController:U,videoModel:Q,timelineConverter:E,adapter:k}),j.setConfig({streamController:U,serviceDescriptionController:V,dashMetrics:z,adapter:k,videoModel:Q,timelineConverter:E,settings:ue}),K.setConfig({streamController:U,playbackController:j,mediaPlayerModel:M,videoModel:Q,settings:ue}),_.setConfig({streamController:U,domStorage:ee,mediaPlayerModel:M,customParametersModel:L,cmsdModel:W,dashMetrics:z,adapter:k,videoModel:Q,settings:ue}),q.setConfig({abrController:_,dashMetrics:z,playbackController:j}),W.setConfig({}),_.initialize(),U.initialize(v,i),B.initialize(),G.initialize(),K.initialize(),q.initialize(),W.initialize(),H.initialize(),te.initialize()}function Ce(){return Yi(se).create({debug:ce,errHandler:P,dashMetrics:z,mediaPlayerModel:M,requestModifier:(0,$.Z)(se).getInstance(),mssHandler:I,settings:ue})}function De(){if(w)return w;var e=dashjs.Protection;if("function"==typeof e){var t=e(se).create();return u.Z.extend(e.events),f.Z.extend(e.events,{publicOnly:!0}),x.extend(e.errors),O||(O=(0,Xi.Z)(se).getInstance()),w=t.createProtectionSystem({debug:ce,errHandler:P,videoModel:Q,customParametersModel:L,capabilities:O,eventBus:le,events:u.Z,BASE64:ba,constants:a.Z,cmcdModel:q,settings:ue})}return null}function ke(){if(!h)throw oe;if(D)return D;var e=dashjs.OfflineController;if("function"==typeof e){u.Z.extend(e.events),f.Z.extend(e.events,{publicOnly:!0}),x.extend(e.errors);var t=Ce(),n=Xt(se).create();return n.setConfig({manifestModel:Z,adapter:k,manifestLoader:t,errHandler:P,contentSteeringController:H}),D=e(se).create({debug:ce,manifestUpdater:n,baseURLController:N,manifestLoader:t,manifestModel:Z,mediaPlayerModel:M,abrController:_,playbackController:j,adapter:k,errHandler:P,dashMetrics:z,timelineConverter:E,segmentBaseController:te,schemeLoaderFactory:b,eventBus:le,events:u.Z,errors:x,constants:a.Z,settings:ue,dashConstants:o.Z,urlUtils:(0,X.Z)(se).getInstance()})}return null}function Me(e){var t=U&&U.hasVideoTrack()?a.Z.VIDEO:a.Z.AUDIO,n=z.getCurrentDVRInfo(t);return n?e+(n.manifestInfo.availableFrom.getTime()/1e3+n.range.start):0}function Le(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:NaN;D&&D.resetRecords(),!g&&n&&(g=!0,t.info("Streaming Initialized"),Re(),"string"==typeof n?U.load(n,e):U.loadWithManifest(n,e)),!m&&fe()&&(m=!0,t.info("Playback Initialized"))}return e={initialize:function(e,n,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:NaN;O||(O=(0,Xi.Z)(se).getInstance()).setConfig({settings:ue}),P||(P=$i(se).getInstance()),O.supportsMediaSource()?(h||(h=!0,E=_a(se).getInstance(),_||(_=br(se).getInstance()).setConfig({settings:ue}),b||(b=bt(se).getInstance()),j||(j=p(se).getInstance()),S||(S=wn(se).getInstance()),U||(U=un(se).getInstance()),G||(G=dn(se).getInstance()),K||(K=hn(se).getInstance()),V||(V=yn(se).getInstance()),H||(H=qt(se).getInstance()),F||(F=Ji(se).getInstance()),k=Jr(se).getInstance(),Z=rr(se).getInstance(),q=qe(se).getInstance(),W=ft(se).getInstance(),z=va(se).getInstance({settings:ue}),ee=kr(se).getInstance({settings:ue}),k.setConfig({constants:a.Z,cea608parser:r(),errHandler:P,BASE64:ba}),N||(N=Un(se).create()),N.setConfig({adapter:k,contentSteeringController:H}),V.setConfig({adapter:k}),te||(te=jr(se).getInstance({dashMetrics:z,mediaPlayerModel:M,errHandler:P,baseURLController:N,events:u.Z,eventBus:le,debug:ce,boxParser:(0,Ut.Z)(se).getInstance(),requestModifier:(0,$.Z)(se).getInstance(),errors:x})),S.setConfig({domStorage:ee,settings:ue,customParametersModel:L}),M.setConfig({playbackController:j,serviceDescriptionController:V}),H.setConfig({adapter:k,errHandler:P,dashMetrics:z,mediaPlayerModel:M,manifestModel:Z,serviceDescriptionController:V,eventBus:le,requestModifier:(0,$.Z)(se).getInstance()}),be(),_e(void 0===i||i),ke()),e&&Se(e),n&&Ae(n,o),t.info("[dash.js "+he()+"] MediaPlayer has been initialized")):P.error(new T.Z(x.CAPABILITY_MEDIASOURCE_ERROR_CODE,x.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE))},setConfig:function(e){e&&(e.capabilities&&(O=e.capabilities),e.capabilitiesFilter&&(F=e.capabilitiesFilter),e.streamController&&(U=e.streamController),e.textController&&(B=e.textController),e.gapController&&(G=e.gapController),e.playbackController&&(j=e.playbackController),e.serviceDescriptionController&&(V=e.serviceDescriptionController),e.contentSteeringController&&(H=e.contentSteeringController),e.catchupController&&(K=e.catchupController),e.mediaPlayerModel&&(M=e.mediaPlayerModel),e.customParametersModel&&(L=e.customParametersModel),e.abrController&&(_=e.abrController),e.schemeLoaderFactory&&(b=e.schemeLoaderFactory),e.mediaController&&(S=e.mediaController),e.settings&&(ue=e.settings))},on:function(e,t,n,i){le.on(e,t,n,i)},off:function(e,t,n){le.off(e,t,n)},extend:function(e,t,n){c.Z.extend(e,t,n,se)},attachView:Se,attachSource:Ae,refreshManifest:function(e){if(!h)throw oe;if(!fe())return e(null,ae);var t=this;"function"==typeof e&&le.on(u.Z.INTERNAL_MANIFEST_LOADED,function n(i){le.off(u.Z.INTERNAL_MANIFEST_LOADED,n,t),i.error?e(null,i.error):e(i.manifest)},t),U.refreshManifest()},isReady:fe,preload:function(){if(!Q.getElement()&&!g){if(!n)throw ae;Le(y)}},play:function(){if(!m)throw ie;(!v||pe()&&m)&&j.play(!0)},isPaused:pe,pause:function(){if(!m)throw ie;j.pause()},isSeeking:function(){if(!m)throw ie;return j.isSeeking()},isDynamic:ge,getLowLatencyModeEnabled:function(){if(!m)throw ie;return j.getLowLatencyModeEnabled()},seek:function(e){if(!m)throw ie;if((0,Y.PS)(e,"number"),isNaN(e))throw a.Z.BAD_ARGUMENT_ERROR;e<0&&(e=0);var t=j.getIsDynamic()?me(e):e,n=Te();!j.getIsDynamic()&&n.duration&&(t=Math.min(n.duration,t)),j.seek(t,!1,!1,!0)},seekToOriginalLive:function(){m&&ge()&&j.seekToOriginalLive()},setPlaybackRate:function(e){Te().playbackRate=e},getPlaybackRate:function(){return Te().playbackRate},setMute:function(e){(0,Y.PS)(e,"boolean"),Te().muted=e},isMuted:function(){return Te().muted},setVolume:function(e){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw a.Z.BAD_ARGUMENT_ERROR;Te().volume=e},getVolume:function(){return Te().volume},time:ve,duration:ye,timeAsUTC:function(){if(!m)throw ie;return ve()<0?NaN:Me(ve())},durationAsUTC:function(){if(!m)throw ie;return Me(ye())},getActiveStream:Ie,getDVRWindowSize:function(){var e=U&&U.hasVideoTrack()?a.Z.VIDEO:a.Z.AUDIO,t=z.getCurrentDVRInfo(e);return t?t.manifestInfo.dvrWindowSize:0},getDVRSeekOffset:me,getAvailableBaseUrls:function(){var e=Z.getValue();return e?N.getBaseUrls(e):[]},getAvailableLocations:function(){var e=Z.getValue();if(!e)return[];var t=k.getLocation(e),n=H.getSynthesizedLocationElements(t);return t.concat(n)},getTargetLiveDelay:function(){if(!m)throw ie;return j.getOriginalLiveDelay()},convertToTimeCode:function(e){e=Math.max(e,0);var t=Math.floor(e/3600),n=Math.floor(e%3600/60),i=Math.floor(e%3600%60);return(0===t?"":t<10?"0"+t.toString()+":":t.toString()+":")+(n<10?"0"+n.toString():n.toString())+":"+(i<10?"0"+i.toString():i.toString())},formatUTC:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=new Date(1e3*e),a=r.toLocaleDateString(t),o=r.toLocaleTimeString(t,{hour12:n});return i?o+" "+a:o},getVersion:he,getDebug:function(){return ce},getBufferLength:function(e){var n=[a.Z.VIDEO,a.Z.AUDIO,a.Z.TEXT];if(e)return-1!==n.indexOf(e)?Ee().getCurrentBufferLevel(e)||NaN:(t.warn("getBufferLength requested for invalid type"),NaN);var i=n.map(function(e){return we(e).length>0?Ee().getCurrentBufferLevel(e):Number.MAX_VALUE}).reduce(function(e,t){return Math.min(e,t)});return i===Number.MAX_VALUE?NaN:i},getTTMLRenderingDiv:function(){return Q?Q.getTTMLRenderingDiv():null},getVideoElement:Te,getSource:function(){if(!n)throw ae;return n},updateSource:function(e){n=e,U.load(n)},getCurrentLiveLatency:function(){if(!h)throw oe;return m?j.getCurrentLiveLatency():NaN},getTopBitrateInfoFor:function(e){if(!g)throw ne;return _.getTopBitrateInfoFor(e)},setAutoPlay:_e,getAutoPlay:function(){return v},getDashMetrics:Ee,getQualityFor:function(e){if(!g)throw ne;if(e===a.Z.IMAGE){var t=Ie();if(!t)return-1;var n=t.getThumbnailController();return n?n.getCurrentTrackIndex():-1}return _.getQualityFor(e)},setQualityFor:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!g)throw ne;if(e===a.Z.IMAGE){var i=Ie();if(!i)return;var r=i.getThumbnailController();r&&r.setTrackByIndex(t)}_.setPlaybackQuality(e,U.getActiveStreamInfo(),t,{forceReplace:n})},updatePortalSize:function(){_.setElementSize(),_.setWindowResizeEventCalled(!0)},enableText:function(e){var t=U.getActiveStreamInfo();return!(!t||!B)&&B.enableText(t.id,e)},enableForcedTextStreaming:function(e){return!(!U.getActiveStreamInfo()||!B)&&B.enableForcedTextStreaming(e)},isTextEnabled:function(){var e=U.getActiveStreamInfo();return!(!e||!B)&&B.isTextEnabled(e)},setTextTrack:function(e){if(!m)throw ie;var t=U.getActiveStreamInfo();t&&B&&B.setTextTrack(t.id,e)},getBitrateInfoListFor:function(e){if(!g)throw ne;var t=Ie();return t?t.getBitrateListFor(e):[]},getStreamsFromManifest:function(e){if(!g)throw ne;return k.getStreamsInfo(e)},getTracksFor:we,getTracksForTypeFromManifest:function(e,t,n){if(!g)throw ne;return(n=n||k.getStreamsInfo(t,1)[0])?k.getAllMediaInfoForType(n,e,t):[]},getCurrentTrackFor:function(e){if(!g)throw ne;var t=U.getActiveStreamInfo();return S.getCurrentTrackFor(e,t.id)},setInitialMediaSettingsFor:function(e,t){if(!h)throw oe;S.setInitialSettings(e,t)},getInitialMediaSettingsFor:function(e){if(!h)throw oe;return S.getInitialSettings(e)},setCurrentTrack:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!g)throw ne;S.setTrack(e,t)},addABRCustomRule:function(e,t,n){L.addAbrCustomRule(e,t,n)},removeABRCustomRule:function(e){L.removeAbrCustomRule(e)},removeAllABRCustomRule:function(){L.removeAllAbrCustomRule()},getABRCustomRules:function(){return L.getAbrCustomRules()},getAverageThroughput:function(e){var t=_.getThroughputHistory(),n=j.getIsDynamic();return t?t.getAverageThroughput(e,n):0},retrieveManifest:function(e,t){var n=Ce(),i=this;le.on(u.Z.INTERNAL_MANIFEST_LOADED,function e(r){r.error?t(null,r.error):t(r.manifest),le.off(u.Z.INTERNAL_MANIFEST_LOADED,e,i),n.reset()},i),J.initialize(e),n.load(e)},addUTCTimingSource:function(e,t){L.addUTCTimingSource(e,t)},removeUTCTimingSource:function(e,t){L.removeUTCTimingSource(e,t)},clearDefaultUTCTimingSources:function(){L.clearDefaultUTCTimingSources()},restoreDefaultUTCTimingSources:be,setXHRWithCredentialsForType:function(e,t){L.setXHRWithCredentialsForType(e,t)},getXHRWithCredentialsForType:function(e){return L.getXHRWithCredentialsForType(e)},getProtectionController:function(){return De()},attachProtectionController:function(e){w=e},setProtectionData:function(e){i=e,U&&U.setProtectionData(i)},registerLicenseRequestFilter:function(e){L.registerLicenseRequestFilter(e)},registerLicenseResponseFilter:function(e){L.registerLicenseResponseFilter(e)},unregisterLicenseRequestFilter:function(e){L.unregisterLicenseRequestFilter(e)},unregisterLicenseResponseFilter:function(e){L.unregisterLicenseResponseFilter(e)},registerCustomCapabilitiesFilter:function(e){L.registerCustomCapabilitiesFilter(e)},unregisterCustomCapabilitiesFilter:function(e){L.unregisterCustomCapabilitiesFilter(e)},setCustomInitialTrackSelectionFunction:function(e){L.setCustomInitialTrackSelectionFunction(e)},resetCustomInitialTrackSelectionFunction:function(){L.resetCustomInitialTrackSelectionFunction(null)},attachTTMLRenderingDiv:function(e){if(!Q.getElement())throw re;Q.setTTMLRenderingDiv(e)},attachVttRenderingDiv:function(e){if(!Q.getElement())throw re;Q.setVttRenderingDiv(e)},getCurrentTextTrackIndex:function(){var e=U.getActiveStreamInfo();if(e&&B)return B.getCurrentTrackIdx(e.id)},provideThumbnail:function(e,t){if("function"==typeof t)if(e<0)t(null);else{var n=j.getIsDynamic()?me(e):e,i=U.getStreamForTime(n);if(null!==i){var r=i.getThumbnailController();if(r)return r.provide(n,t);t(null)}else t(null)}},getDashAdapter:function(){return k},getOfflineController:function(){return ke()},triggerSteeringRequest:function(){if(H)return H.loadSteeringData()},getCurrentSteeringResponseData:function(){if(H)return H.getCurrentSteeringResponseData()},getSettings:function(){return ue.get()},updateSettings:function(e){ue.update(e)},resetSettings:function(){ue.reset()},reset:de,destroy:function(){de(),c.Z.deleteSingletonInstances(se)}},t=ce.getLogger(e),h=!1,m=!1,g=!1,v=!0,y=NaN,w=null,D=null,i=null,k=null,te=null,u.Z.extend(f.Z),M=sr(se).getInstance(),L=(0,gt.Z)(se).getInstance(),Q=Sr(se).getInstance(),J=nr(se).getInstance(),e}Xa.__dashjs_factory_name="MediaPlayer";var Qa=c.Z.getClassFactory(Xa);Qa.events=f.Z,Qa.errors=x,c.Z.updateClassFactory(Xa.__dashjs_factory_name,Qa);var Ja=Qa},8825:function(e,t,n){"use strict";function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function r(e,t){return r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(e,t)}function a(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function o(e){return o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},o(e)}var s=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=o(t);if(n){var r=o(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return a(this,e)});function s(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(e=i.call(this)).AST_IN_FUTURE="astInFuture",e.BASE_URLS_UPDATED="baseUrlsUpdated",e.BUFFER_EMPTY="bufferStalled",e.BUFFER_LOADED="bufferLoaded",e.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",e.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",e.DVB_FONT_DOWNLOAD_ADDED="dvbFontDownloadAdded",e.DVB_FONT_DOWNLOAD_COMPLETE="dvbFontDownloadComplete",e.DVB_FONT_DOWNLOAD_FAILED="dvbFontDownloadFailed",e.DYNAMIC_TO_STATIC="dynamicToStatic",e.ERROR="error",e.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",e.FRAGMENT_LOADING_PROGRESS="fragmentLoadingProgress",e.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",e.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",e.LOG="log",e.MANIFEST_LOADING_STARTED="manifestLoadingStarted",e.MANIFEST_LOADING_FINISHED="manifestLoadingFinished",e.MANIFEST_LOADED="manifestLoaded",e.METRICS_CHANGED="metricsChanged",e.METRIC_CHANGED="metricChanged",e.METRIC_ADDED="metricAdded",e.METRIC_UPDATED="metricUpdated",e.PERIOD_SWITCH_STARTED="periodSwitchStarted",e.PERIOD_SWITCH_COMPLETED="periodSwitchCompleted",e.QUALITY_CHANGE_REQUESTED="qualityChangeRequested",e.QUALITY_CHANGE_RENDERED="qualityChangeRendered",e.TRACK_CHANGE_RENDERED="trackChangeRendered",e.STREAM_INITIALIZING="streamInitializing",e.STREAM_UPDATED="streamUpdated",e.STREAM_ACTIVATED="streamActivated",e.STREAM_DEACTIVATED="streamDeactivated",e.STREAM_INITIALIZED="streamInitialized",e.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",e.TEXT_TRACKS_ADDED="allTextTracksAdded",e.TEXT_TRACK_ADDED="textTrackAdded",e.CUE_ENTER="cueEnter",e.CUE_EXIT="cueExit",e.THROUGHPUT_MEASUREMENT_STORED="throughputMeasurementStored",e.TTML_PARSED="ttmlParsed",e.TTML_TO_PARSE="ttmlToParse",e.CAPTION_RENDERED="captionRendered",e.CAPTION_CONTAINER_RESIZE="captionContainerResize",e.CAN_PLAY="canPlay",e.CAN_PLAY_THROUGH="canPlayThrough",e.PLAYBACK_ENDED="playbackEnded",e.PLAYBACK_ERROR="playbackError",e.PLAYBACK_NOT_ALLOWED="playbackNotAllowed",e.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",e.PLAYBACK_LOADED_DATA="playbackLoadedData",e.PLAYBACK_PAUSED="playbackPaused",e.PLAYBACK_PLAYING="playbackPlaying",e.PLAYBACK_PROGRESS="playbackProgress",e.PLAYBACK_RATE_CHANGED="playbackRateChanged",e.PLAYBACK_SEEKED="playbackSeeked",e.PLAYBACK_SEEKING="playbackSeeking",e.PLAYBACK_STALLED="playbackStalled",e.PLAYBACK_STARTED="playbackStarted",e.PLAYBACK_TIME_UPDATED="playbackTimeUpdated",e.PLAYBACK_VOLUME_CHANGED="playbackVolumeChanged",e.PLAYBACK_WAITING="playbackWaiting",e.MANIFEST_VALIDITY_CHANGED="manifestValidityChanged",e.EVENT_MODE_ON_START="eventModeOnStart",e.EVENT_MODE_ON_RECEIVE="eventModeOnReceive",e.CONFORMANCE_VIOLATION="conformanceViolation",e.REPRESENTATION_SWITCH="representationSwitch",e.ADAPTATION_SET_REMOVED_NO_CAPABILITIES="adaptationSetRemovedNoCapabilities",e.CONTENT_STEERING_REQUEST_COMPLETED="contentSteeringRequestCompleted",e.INBAND_PRFT="inbandPrft",e.MANAGED_MEDIA_SOURCE_START_STREAMING="managedMediaSourceStartStreaming",e.MANAGED_MEDIA_SOURCE_END_STREAMING="managedMediaSourceEndStreaming",e}return s}(n(8342).Z));t.Z=s},3393:function(e,t){"use strict";function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}var t,i;return t=e,(i=[{key:"init",value:function(){this.STREAM="stream",this.VIDEO="video",this.AUDIO="audio",this.TEXT="text",this.MUXED="muxed",this.IMAGE="image",this.STPP="stpp",this.TTML="ttml",this.VTT="vtt",this.WVTT="wvtt",this.CONTENT_STEERING="contentSteering",this.ABR_STRATEGY_DYNAMIC="abrDynamic",this.ABR_STRATEGY_BOLA="abrBola",this.ABR_STRATEGY_L2A="abrL2A",this.ABR_STRATEGY_LoLP="abrLoLP",this.ABR_STRATEGY_THROUGHPUT="abrThroughput",this.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA="abrFetchThroughputCalculationDownloadedData",this.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING="abrFetchThroughputCalculationMoofParsing",this.ABR_FETCH_THROUGHPUT_CALCULATION_AAST="abrFetchThroughputCalculationAAST",this.LIVE_CATCHUP_MODE_DEFAULT="liveCatchupModeDefault",this.LIVE_CATCHUP_MODE_LOLP="liveCatchupModeLoLP",this.MOVING_AVERAGE_SLIDING_WINDOW="slidingWindow",this.MOVING_AVERAGE_EWMA="ewma",this.BAD_ARGUMENT_ERROR="Invalid Arguments",this.MISSING_CONFIG_ERROR="Missing config parameter(s)",this.TRACK_SWITCH_MODE_ALWAYS_REPLACE="alwaysReplace",this.TRACK_SWITCH_MODE_NEVER_REPLACE="neverReplace",this.TRACK_SELECTION_MODE_FIRST_TRACK="firstTrack",this.TRACK_SELECTION_MODE_HIGHEST_BITRATE="highestBitrate",this.TRACK_SELECTION_MODE_HIGHEST_EFFICIENCY="highestEfficiency",this.TRACK_SELECTION_MODE_WIDEST_RANGE="widestRange",this.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY="highestSelectionPriority",this.CMCD_MODE_QUERY="query",this.CMCD_MODE_HEADER="header",this.INITIALIZE="initialize",this.TEXT_SHOWING="showing",this.TEXT_HIDDEN="hidden",this.TEXT_DISABLED="disabled",this.CC1="CC1",this.CC3="CC3",this.UTF8="utf-8",this.SCHEME_ID_URI="schemeIdUri",this.START_TIME="starttime",this.SERVICE_DESCRIPTION_DVB_LL_SCHEME="urn:dvb:dash:lowlatency:scope:2019",this.SUPPLEMENTAL_PROPERTY_DVB_LL_SCHEME="urn:dvb:dash:lowlatency:critical:2019",this.FONT_DOWNLOAD_DVB_SCHEME="urn:dvb:dash:fontdownload:2014",this.XML="XML",this.ARRAY_BUFFER="ArrayBuffer",this.DVB_REPORTING_URL="dvb:reportingUrl",this.DVB_PROBABILITY="dvb:probability",this.OFF_MIMETYPE="application/font-sfnt",this.WOFF_MIMETYPE="application/font-woff",this.VIDEO_ELEMENT_READY_STATES={HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4},this.FILE_LOADER_TYPES={FETCH:"fetch_loader",XHR:"xhr_loader"}}}])&&n(t.prototype,i),e}());t.Z=i},3860:function(e,t){"use strict";function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}var t,i;return t=e,(i=[{key:"init",value:function(){this.TCP_CONNECTION="TcpList",this.HTTP_REQUEST="HttpList",this.TRACK_SWITCH="RepSwitchList",this.BUFFER_LEVEL="BufferLevel",this.BUFFER_LOADED="bufferLoaded",this.ABANDON_LOAD="abandonload",this.ALLOW_LOAD="allowload",this.BUFFER_EMPTY="bufferStalled",this.BUFFER_STATE="BufferState",this.DVR_INFO="DVRInfo",this.DROPPED_FRAMES="DroppedFrames",this.SCHEDULING_INFO="SchedulingInfo",this.REQUESTS_QUEUE="RequestsQueue",this.MANIFEST_UPDATE="ManifestUpdate",this.MANIFEST_UPDATE_STREAM_INFO="ManifestUpdatePeriodInfo",this.MANIFEST_UPDATE_TRACK_INFO="ManifestUpdateRepresentationInfo",this.PLAY_LIST="PlayList",this.DVB_ERRORS="DVBErrors",this.HTTP_REQUEST_DVB_REPORTING_TYPE="DVBReporting"}}])&&n(t.prototype,i),e}());t.Z=i},8080:function(e,t,n){"use strict";n.d(t,{default:function(){return Z}});var i=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mpdurl=null,this.errorcode=null,this.terror=null,this.url=null,this.ipaddress=null,this.servicelocation=null};i.SSL_CONNECTION_FAILED_PREFIX="SSL",i.DNS_RESOLUTION_FAILED="C00",i.HOST_UNREACHABLE="C01",i.CONNECTION_REFUSED="C02",i.CONNECTION_ERROR="C03",i.CORRUPT_MEDIA_ISOBMFF="M00",i.CORRUPT_MEDIA_OTHER="M01",i.BASE_URL_CHANGED="F00",i.BECAME_REPORTER="S00";var r=i,a=n(1180);function o(e){var t,n,i=(e=e||{}).eventBus,o=e.dashMetrics,s=e.metricsConstants,l=e.events;function u(e){var t=new r;if(n){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.mpdurl||(t.mpdurl=n.originalUrl||n.url),t.terror||(t.terror=new Date),o.addDVBErrors(t)}}function c(e){e.error||(n=e.manifest)}function d(e){u({errorcode:r.BASE_URL_CHANGED,servicelocation:e.entry})}function f(){u({errorcode:r.BECAME_REPORTER})}function h(e){var t;e.metric===s.HTTP_REQUEST&&(0===(t=e.value).responsecode||null==t.responsecode||t.responsecode>=400||t.responsecode<100||t.responsecode>=600)&&u({errorcode:t.responsecode||r.CONNECTION_ERROR,url:t.url,terror:t.tresponse,servicelocation:t._serviceLocation})}function p(e){var t;switch(e.error?e.error.code:0){case MediaError.MEDIA_ERR_NETWORK:t=r.CONNECTION_ERROR;break;case MediaError.MEDIA_ERR_DECODE:t=r.CORRUPT_MEDIA_OTHER;break;default:return}u({errorcode:t})}return t={initialize:function(){i.on(l.MANIFEST_UPDATED,c,t),i.on(l.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED,d,t),i.on(l.METRIC_ADDED,h,t),i.on(l.METRIC_UPDATED,h,t),i.on(l.PLAYBACK_ERROR,p,t),i.on(a.Z.BECAME_REPORTING_PLAYER,f,t)},reset:function(){i.off(l.MANIFEST_UPDATED,c,t),i.off(l.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED,d,t),i.off(l.METRIC_ADDED,h,t),i.off(l.METRIC_UPDATED,h,t),i.off(l.PLAYBACK_ERROR,p,t),i.off(a.Z.BECAME_REPORTING_PLAYER,f,t)}}}o.__dashjs_factory_name="DVBErrorsTranslator";var s=dashjs.FactoryMaker.getSingletonFactory(o),l=n(2295);function u(e){e=e||{};var t,n,i=!1,r=this.context,a=e.mediaElement;return t={initialize:function(e){e&&e.length&&(e.forEach(function(e){var t=e.starttime,i=t+e.duration;n.add(t,i)}),i=!!e[0]._useWallClockTime)},reset:function(){n.clear()},isEnabled:function(){var e,t=n.length;if(!t)return!0;e=i?(new Date).getTime()/1e3:a.currentTime;for(var r=0;r<t;r+=1){var o=n.start(r),s=n.end(r);if(o<=e&&e<s)return!0}return!1}},n=(0,l.Z)(r).create(),t}u.__dashjs_factory_name="RangeController";var c=dashjs.FactoryMaker.getClassFactory(u);function d(){return{serialise:function e(t){var n,i,r=[],a=[];for(n in t)if(t.hasOwnProperty(n)&&0!==n.indexOf("_")){if(null==(i=t[n])&&(i=""),Array.isArray(i)){if(!i.length)continue;a=[],i.forEach(function(t){var n="Object"!==Object.prototype.toString.call(t).slice(8,-1);a.push(n?t:e(t))}),i=a.map(encodeURIComponent).join(",")}else"string"==typeof i?i=encodeURIComponent(i):i instanceof Date?i=i.toISOString():"number"==typeof i&&(i=Math.round(i));r.push(n+"="+i)}return r.join("&")}}}d.__dashjs_factory_name="MetricSerialiser";var f=dashjs.FactoryMaker.getSingletonFactory(d);function h(){var e,t,n,i=window.crypto||window.msCrypto,r=Uint32Array,a=Math.pow(2,8*r.BYTES_PER_ELEMENT)-1;function o(){i&&(e||(e=new r(10)),i.getRandomValues(e),t=0)}return n={random:function(n,r){var s;return n||(n=0),r||(r=1),i?(t===e.length&&o(),s=e[t]/a,t+=1):s=Math.random(),s*(r-n)+n}},o(),n}h.__dashjs_factory_name="RNG";var p=dashjs.FactoryMaker.getSingletonFactory(h),g=n(5717);function m(e){var t;e=e||{};var n,i,r,a,o,s,l,u=this.context,c=[],d=e.metricsConstants;function h(){a=!1,o=!1,s=null,l=null}return t={report:function(e,t){Array.isArray(t)||(t=[t]),o&&l.isEnabled()&&t.forEach(function(t){var r=n.serialise(t);e!==d.DVB_ERRORS&&(r="metricname=".concat(e,"&").concat(r)),function(e,t,n){var r=new XMLHttpRequest;r.withCredentials=i.getXHRWithCredentialsForType(d.HTTP_REQUEST_DVB_REPORTING_TYPE);var a=function(){var e=c.indexOf(r);-1!==e&&(c.splice(e,1),!(r.status>=200&&r.status<300)&&n&&n())};c.push(r);try{r.open("GET",e),r.onloadend=a,r.onerror=a,r.send()}catch(e){r.onerror()}}(r="".concat(s,"?").concat(r),0,function(){o=!1})})},initialize:function(e,t){var n;if(l=t,!(s=e.dvbReportingUrl))throw new Error("required parameter missing (dvb:reportingUrl)");a||((n=e.dvbProbability)&&(1e3===n||n/1e3>=r.random())&&(o=!0),a=!0)},reset:function(){h()}},n=f(u).getInstance(),r=p(u).getInstance(),i=(0,g.Z)(u).getInstance(),h(),t}m.__dashjs_factory_name="DVBReporting";var v=dashjs.FactoryMaker.getClassFactory(m);function y(e){e=e||{};var t,n={"urn:dvb:dash:reporting:2014":v},i=this.context,r=e.debug?e.debug.getLogger(t):{},a=e.metricsConstants,o=e.mediaPlayerModel||{};return{create:function(e,t){var s;try{(s=n[e.schemeIdUri](i).create({metricsConstants:a,mediaPlayerModel:o})).initialize(e,t)}catch(t){s=null,r.error("ReportingFactory: could not create Reporting with schemeIdUri ".concat(e.schemeIdUri," (").concat(t.message,")"))}return s},register:function(e,t){n[e]=t},unregister:function(e){delete n[e]}}}y.__dashjs_factory_name="ReportingFactory";var _=dashjs.FactoryMaker.getSingletonFactory(y);function b(e){var t=[],n=_(this.context).getInstance(e);return{initialize:function(e,i){e.some(function(e){var r=n.create(e,i);if(r)return t.push(r),!0})},reset:function(){t.forEach(function(e){return e.reset()}),t=[]},report:function(e,n){t.forEach(function(t){return t.report(e,n)})}}}b.__dashjs_factory_name="ReportingController";var E=dashjs.FactoryMaker.getClassFactory(b);function T(){return{reconstructFullMetricName:function(e,t,n){var i=e;return t&&(i+="("+t,n&&n.length&&(i+=","+n),i+=")"),i},validateN:function(e){if(!e)throw new Error("missing n");if(isNaN(e))throw new Error("n is NaN");if(e<0)throw new Error("n must be positive");return e}}}T.__dashjs_factory_name="HandlerHelpers";var S=dashjs.FactoryMaker.getSingletonFactory(T);function w(e){var t,n,i,r,a;e=e||{};var o=this.context,s=S(o).getInstance(),l=[],u=e.metricsConstants;function c(){var e=function(){try{return Object.keys(l).map(function(e){return l[e]}).reduce(function(e,t){return e.level<t.level?e:t})}catch(e){return}}();e&&a!==e.t&&(a=e.t,t.report(i,e))}return{initialize:function(e,a,o){a&&(n=s.validateN(o),t=a,i=s.reconstructFullMetricName(e,o),r=setInterval(c,n))},reset:function(){clearInterval(r),r=null,n=0,t=null,a=null},handleNewMetric:function(e,t,n){e===u.BUFFER_LEVEL&&(l[n]=t)}}}w.__dashjs_factory_name="BufferLevelHandler";var A=dashjs.FactoryMaker.getClassFactory(w),I=dashjs.FactoryMaker.getClassFactory(function(e){var t,n=(e=e||{}).eventBus,i=e.metricsConstants;function r(){n.off(a.Z.METRICS_INITIALISATION_COMPLETE,r,this),n.trigger(a.Z.BECAME_REPORTING_PLAYER)}return{initialize:function(e,i){i&&(t=i,n.on(a.Z.METRICS_INITIALISATION_COMPLETE,r,this))},reset:function(){t=null},handleNewMetric:function(e,n){e===i.DVB_ERRORS&&t&&t.report(e,n)}}});function x(e){var t,n,i,r,a;e=e||{};var o=[],s=S(this.context).getInstance(),l=e.metricsConstants;function u(){var e=o;e.length&&t&&t.report(r,e),o=[]}return{initialize:function(e,o,l,c){o&&(n=s.validateN(l),t=o,c&&c.length&&(i=c),r=s.reconstructFullMetricName(e,l,c),a=setInterval(u,n))},reset:function(){clearInterval(a),a=null,n=null,i=null,o=[],t=null},handleNewMetric:function(e,t){e===l.HTTP_REQUEST&&(i&&i!==t.type||o.push(t))}}}x.__dashjs_factory_name="HttpListHandler";var R=dashjs.FactoryMaker.getClassFactory(x);function C(){var e,t;return{initialize:function(n,i){e=n,t=i},reset:function(){t=null,e=void 0},handleNewMetric:function(n,i){n===e&&t&&t.report(e,i)}}}C.__dashjs_factory_name="GenericMetricHandler";var D=dashjs.FactoryMaker.getClassFactory(C);function k(e){var t,n=(e=e||{}).debug?e.debug.getLogger(t):{},i=/([a-zA-Z]*)(\(([0-9]*)(\,\s*([a-zA-Z]*))?\))?/,r=this.context,a={BufferLevel:A,DVBErrors:I,HttpList:R,PlayList:D,RepSwitchList:D,TcpList:D};return{create:function(t,o){var s,l=t.match(i);if(l){try{(s=a[l[1]](r).create({eventBus:e.eventBus,metricsConstants:e.metricsConstants})).initialize(l[1],o,l[3],l[5])}catch(e){s=null,n.error("MetricsHandlerFactory: Could not create handler for type ".concat(l[1]," with args ").concat(l[3],", ").concat(l[5]," (").concat(e.message,")"))}return s}},register:function(e,t){a[e]=t},unregister:function(e){delete a[e]}}}k.__dashjs_factory_name="MetricsHandlerFactory";var M=dashjs.FactoryMaker.getSingletonFactory(k);function L(e){e=e||{};var t,n=[],i=this.context,r=e.eventBus,a=e.events,o=M(i).getInstance({debug:e.debug,eventBus:e.eventBus,metricsConstants:e.metricsConstants});function s(e){n.forEach(function(t){t.handleNewMetric(e.metric,e.value,e.mediaType)})}return t={initialize:function(e,i){e.split(",").forEach(function(e,t,r){var a;if(-1!==e.indexOf("(")&&-1===e.indexOf(")")){var s=r[t+1];s&&-1===s.indexOf("(")&&-1!==s.indexOf(")")&&(e+=","+s,delete r[t+1])}(a=o.create(e,i))&&n.push(a)}),r.on(a.METRIC_ADDED,s,t),r.on(a.METRIC_UPDATED,s,t)},reset:function(){r.off(a.METRIC_ADDED,s,t),r.off(a.METRIC_UPDATED,s,t),n.forEach(function(e){return e.reset()}),n=[]}}}L.__dashjs_factory_name="MetricsHandlersController";var P=dashjs.FactoryMaker.getClassFactory(L);function N(e){var t,n,i;e=e||{};var r=this.context;function a(){t&&t.reset(),n&&n.reset(),i&&i.reset()}return{initialize:function(o){try{(i=c(r).create({mediaElement:e.mediaElement})).initialize(o.Range),(n=E(r).create({debug:e.debug,metricsConstants:e.metricsConstants,mediaPlayerModel:e.mediaPlayerModel})).initialize(o.Reporting,i),(t=P(r).create({debug:e.debug,eventBus:e.eventBus,metricsConstants:e.metricsConstants,events:e.events})).initialize(o.metrics,n)}catch(e){throw a(),e}},reset:a}}N.__dashjs_factory_name="MetricsController";var O=dashjs.FactoryMaker.getClassFactory(N),F=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metrics="",this.Range=[],this.Reporting=[]},U=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.starttime=0,this.duration=1/0,this._useWallClockTime=!1},B=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.schemeIdUri="",this.value="",this.dvbReportingUrl="",this.dvbProbability=1e3};function G(e){var t=(e=e||{}).adapter,n=e.constants;return{getMetrics:function(e){var i=[];return e&&e.Metrics_asArray&&e.Metrics_asArray.forEach(function(r){var a=new F,o=t.getIsDynamic(e);r.hasOwnProperty("metrics")&&(a.metrics=r.metrics,r.Range_asArray&&r.Range_asArray.forEach(function(i){var r=new U;r.starttime=function(e,i,r){var a,o,s=0;return i?s=t.getAvailabilityStartTime(e)/1e3:(a=t.getRegularPeriods(e)).length&&(s=a[0].start),o=s,r&&r.hasOwnProperty(n.START_TIME)&&(o+=r.starttime),o}(e,o,i),i.hasOwnProperty("duration")?r.duration=i.duration:r.duration=t.getDuration(e),r._useWallClockTime=o,a.Range.push(r)}),r.Reporting_asArray&&(r.Reporting_asArray.forEach(function(e){var t=new B;e.hasOwnProperty(n.SCHEME_ID_URI)&&(t.schemeIdUri=e.schemeIdUri,e.hasOwnProperty("value")&&(t.value=e.value),e.hasOwnProperty(n.DVB_REPORTING_URL)&&(t.dvbReportingUrl=e[n.DVB_REPORTING_URL]),e.hasOwnProperty(n.DVB_PROBABILITY)&&(t.dvbProbability=e[n.DVB_PROBABILITY]),a.Reporting.push(t))}),i.push(a)))}),i}}}G.__dashjs_factory_name="ManifestParsing";var j=dashjs.FactoryMaker.getSingletonFactory(G);function V(e){var t;e=e||{};var n={},i=this.context,r=e.eventBus,o=e.events;function s(t){if(!t.error){var o=Object.keys(n);j(i).getInstance({adapter:e.adapter,constants:e.constants}).getMetrics(t.manifest).forEach(function(t){var r=JSON.stringify(t);if(n.hasOwnProperty(r))o.splice(r,1);else try{var a=O(i).create(e);a.initialize(t),n[r]=a}catch(e){}}),o.forEach(function(e){n[e].reset(),delete n[e]}),r.trigger(a.Z.METRICS_INITIALISATION_COMPLETE)}}function l(){Object.keys(n).forEach(function(e){n[e].reset()}),n={}}return t={reset:function(){r.off(o.MANIFEST_UPDATED,s,t),r.off(o.STREAM_TEARDOWN_COMPLETE,l,t)}},r.on(o.MANIFEST_UPDATED,s,t),r.on(o.STREAM_TEARDOWN_COMPLETE,l,t),t}V.__dashjs_factory_name="MetricsCollectionController";var H=dashjs.FactoryMaker.getClassFactory(V);function K(){var e=this.context;return{createMetricsReporting:function(t){return s(e).getInstance({eventBus:t.eventBus,dashMetrics:t.dashMetrics,metricsConstants:t.metricsConstants,events:t.events}).initialize(),H(e).create(t)},getReportingFactory:function(){return _(e).getInstance()},getMetricsHandlerFactory:function(){return M(e).getInstance()}}}K.__dashjs_factory_name="MetricsReporting";var z=dashjs.FactoryMaker.getClassFactory(K);z.events=a.Z,dashjs.FactoryMaker.updateClassFactory(K.__dashjs_factory_name,z);var Z=z},1180:function(e,t,n){"use strict";function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function r(e,t){return r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(e,t)}function a(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function o(e){return o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},o(e)}var s=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=o(t);if(n){var r=o(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return a(this,e)});function s(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(e=i.call(this)).METRICS_INITIALISATION_COMPLETE="internal_metricsReportingInitialized",e.BECAME_REPORTING_PLAYER="internal_becameReportingPlayer",e.CMCD_DATA_GENERATED="cmcdDataGenerated",e}return s}(n(8342).Z));t.Z=s},5717:function(e,t,n){"use strict";var i=n(2610),r=n(5448),a=n(1264),o=n(3106),s=n(1767),l=n(3393);function u(){var e,t,n,r,u,c,d,f,h=this.context,p=(0,a.Z)(h).getInstance();function g(){r=[],u=[],c=[],f=[],d=null,t=[]}function m(e,t){var n=-1;e.some(function(e,i){if(e===t)return n=i,!0}),n<0||e.splice(n,1)}function v(e){var t;for(t=0;t<f.length;t++)if(f[t].rulename===e)return t;return-1}function y(e,n){_(e,n);var r=new i.Z;r.schemeIdUri=e,r.value=n,t.push(r)}function _(e,n){(0,o.PS)(e,"string"),(0,o.PS)(n,"string"),t.forEach(function(i,r){i.schemeIdUri===e&&i.value===n&&t.splice(r,1)})}return e={getCustomInitialTrackSelectionFunction:function(){return d},setCustomInitialTrackSelectionFunction:function(e){d=e},resetCustomInitialTrackSelectionFunction:function(){d=null},getLicenseResponseFilters:function(){return u},getLicenseRequestFilters:function(){return r},getCustomCapabilitiesFilters:function(){return c},registerCustomCapabilitiesFilter:function(e){c.push(e)},registerLicenseResponseFilter:function(e){u.push(e)},registerLicenseRequestFilter:function(e){r.push(e)},unregisterCustomCapabilitiesFilter:function(e){m(c,e)},unregisterLicenseResponseFilter:function(e){m(u,e)},unregisterLicenseRequestFilter:function(e){m(r,e)},addAbrCustomRule:function(e,t,n){if("string"!=typeof e||e!==s.Z.ABANDON_FRAGMENT_RULES&&e!==s.Z.QUALITY_SWITCH_RULES||"string"!=typeof t)throw l.Z.BAD_ARGUMENT_ERROR;var i=v(t);-1===i?f.push({type:e,rulename:t,rule:n}):(f[i].type=e,f[i].rule=n)},removeAllAbrCustomRule:function(){f=[]},removeAbrCustomRule:function(e){if(e){var t=v(e);-1!==t&&f.splice(t,1)}else f=[]},getAbrCustomRules:function(){return f},addUTCTimingSource:y,removeUTCTimingSource:_,getUTCTimingSources:function(){return t},clearDefaultUTCTimingSources:function(){t=[]},restoreDefaultUTCTimingSources:function(){var e=p.get().streaming.utcSynchronization.defaultTimingSource;y(e.scheme,e.value)},setXHRWithCredentialsForType:function e(t,i){t?n[t]=!!i:Object.keys(n).forEach(function(t){e(t,i)})},getXHRWithCredentialsForType:function(e){var t=n[e];return void 0===t?n.default:t},setConfig:function(){},reset:function(){g()}},n={default:!1},g(),e}u.__dashjs_factory_name="CustomParametersModel",t.Z=r.Z.getSingletonFactory(u)},9032:function(e,t,n){"use strict";var i=n(5448),r=n(7473);function a(e){var t=(e=e||{}).requestModifier;function n(e){var n=new Date,i=e.request,r=new XMLHttpRequest;if(r.open(e.method,e.url,!0),i.responseType&&(r.responseType=i.responseType),i.range&&r.setRequestHeader("Range","bytes="+i.range),i.requestStartDate||(i.requestStartDate=n),t&&t.modifyRequestHeader&&(r=t.modifyRequestHeader(r,{url:e.url})),e.headers)for(var a in e.headers){var o=e.headers[a];o&&r.setRequestHeader(a,o)}r.withCredentials=e.withCredentials,r.onload=e.onload,r.onloadend=e.onend,r.onerror=e.onerror,r.onprogress=e.progress,r.onabort=e.onabort,r.ontimeout=e.ontimeout,r.timeout=e.timeout,r.send(),e.response=r}return{load:function(e){t&&t.modifyRequest?(0,r.k)(e,t).then(function(){return n(e)}):n(e)},abort:function(e){var t=e.response;t.onloadend=t.onerror=t.onprogress=void 0,t.abort()}}}a.__dashjs_factory_name="XHRLoader";var o=i.Z.getClassFactory(a);t.Z=o},1737:function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,{default:function(){return Se}});var r={attributes:["Laurl","laurl"],prefixes:["clearkey","dashif"]},a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"findCencContentProtection",value:function(e){for(var t=null,n=0;n<e.length;++n){var i=e[n];"urn:mpeg:dash:mp4protection:2011"!==i.schemeIdUri.toLowerCase()||"cenc"!==i.value.toLowerCase()&&"cbcs"!==i.value.toLowerCase()||(t=i)}return t}},{key:"getPSSHData",value:function(e){var t=8,n=new DataView(e),i=n.getUint8(t);return t+=20,i>0&&(t+=4+16*n.getUint32(t)),t+=4,e.slice(t)}},{key:"getPSSHForKeySystem",value:function(t,n){var i=e.parsePSSHList(n);return t&&i.hasOwnProperty(t.uuid.toLowerCase())?i[t.uuid.toLowerCase()]:null}},{key:"parseInitDataFromContentProtection",value:function(e,t){return"pssh"in e?(e.pssh.__text=e.pssh.__text.replace(/\r?\n|\r/g,"").replace(/\s+/g,""),t.decodeArray(e.pssh.__text).buffer):null}},{key:"parsePSSHList",value:function(e){if(null==e)return[];for(var t=new DataView(e.buffer||e),n={},i=0;;){var r,a,o=void 0,s=i;if(i>=t.buffer.byteLength)break;if(r=i+t.getUint32(i),i+=4,1886614376===t.getUint32(i))if(i+=4,0===(a=t.getUint8(i))||1===a){i++,i+=3,o="";var l=void 0,u=void 0;for(l=0;l<4;l++)o+=1===(u=t.getUint8(i+l).toString(16)).length?"0"+u:u;for(i+=4,o+="-",l=0;l<2;l++)o+=1===(u=t.getUint8(i+l).toString(16)).length?"0"+u:u;for(i+=2,o+="-",l=0;l<2;l++)o+=1===(u=t.getUint8(i+l).toString(16)).length?"0"+u:u;for(i+=2,o+="-",l=0;l<2;l++)o+=1===(u=t.getUint8(i+l).toString(16)).length?"0"+u:u;for(i+=2,o+="-",l=0;l<6;l++)o+=1===(u=t.getUint8(i+l).toString(16)).length?"0"+u:u;i+=6,i+=4,n[o=o.toLowerCase()]=t.buffer.slice(s,r),i=r}else i=r;else i=r}return n}},{key:"getLicenseServerUrlFromMediaInfo",value:function(e,t){try{if(!e||0===e.length)return null;for(var n=0,i=null;n<e.length&&!i;){var a=e[n];if(a&&a.contentProtection&&a.contentProtection.length>0){var o=a.contentProtection.filter(function(e){return e.schemeIdUri&&e.schemeIdUri===t});if(o&&o.length>0)for(var s=0;s<o.length&&!i;){for(var l=o[s],u=0;u<r.attributes.length&&!i;){for(var c=0,d=r.attributes[u];c<r.prefixes.length&&!i;){var f=r.prefixes[c];l[d]&&l[d].__prefix&&l[d].__prefix===f&&l[d].__text&&(i=l[d].__text),c+=1}u+=1}s+=1}}n+=1}return i}catch(e){return null}}}],n&&i(t,n),e}(),o=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.contentType=t,this.robustness=n},s=function e(t,n,i,r,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initDataTypes=["cenc"],t&&t.length&&(this.audioCapabilities=t),n&&n.length&&(this.videoCapabilities=n),this.distinctiveIdentifier=i,this.persistentState=r,this.sessionTypes=a};function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var f=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(r,e);var t,n,i=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=d(t);if(n){var r=d(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return c(this,e)});function r(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(e=i.call(this)).MEDIA_KEYERR_CODE=100,e.MEDIA_KEYERR_UNKNOWN_CODE=101,e.MEDIA_KEYERR_CLIENT_CODE=102,e.MEDIA_KEYERR_SERVICE_CODE=103,e.MEDIA_KEYERR_OUTPUT_CODE=104,e.MEDIA_KEYERR_HARDWARECHANGE_CODE=105,e.MEDIA_KEYERR_DOMAIN_CODE=106,e.MEDIA_KEY_MESSAGE_ERROR_CODE=107,e.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE=108,e.SERVER_CERTIFICATE_UPDATED_ERROR_CODE=109,e.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE=110,e.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE=111,e.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE=112,e.KEY_SESSION_CREATED_ERROR_CODE=113,e.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE=114,e.MEDIA_KEYERR_UNKNOWN_MESSAGE="An unspecified error occurred. This value is used for errors that don't match any of the other codes.",e.MEDIA_KEYERR_CLIENT_MESSAGE="The Key System could not be installed or updated.",e.MEDIA_KEYERR_SERVICE_MESSAGE="The message passed into update indicated an error from the license service.",e.MEDIA_KEYERR_OUTPUT_MESSAGE="There is no available output device with the required characteristics for the content protection system.",e.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE="A hardware configuration change caused a content protection error.",e.MEDIA_KEYERR_DOMAIN_MESSAGE="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain.",e.MEDIA_KEY_MESSAGE_ERROR_MESSAGE="Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!",e.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE="DRM: Empty key message from CDM",e.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE="Error updating server certificate -- ",e.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE="DRM: KeyStatusChange error! -- License has expired",e.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE="DRM: No license server URL specified!",e.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE="DRM: KeySystem Access Denied! -- ",e.KEY_SESSION_CREATED_ERROR_MESSAGE="DRM: unable to create session! --",e.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE="DRM: licenser error! --",e}return r}(n(2230).Z)),h=n(5459),p=function e(t,n,i,r,a,o,s,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t,this.method=n,this.responseType=i,this.headers=r,this.withCredentials=a,this.messageType=o,this.sessionId=s,this.data=l},g=function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t,this.headers=n,this.data=i},m=n(7855),v=n(703),y=n(3393),_=n(5448);function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function E(e){var t,n,i,r,l,u,c,d,_,E,T,S=(e=e||{}).protectionKeyController,w=e.protectionModel,A=e.eventBus,I=e.events,x=e.debug,R=e.BASE64,C=e.constants,D=[],k=e.cmcdModel,M=e.settings,L=e.customParametersModel;function P(){if(!(A&&A.hasOwnProperty("on")&&S&&S.hasOwnProperty("getSupportedKeySystemsFromContentProtection")))throw new Error("Missing config parameter(s)")}function N(e,t){d||_?d&&O():function(e,t){if(!_){_=!0;var i,r=[];e=e.sort(function(t,n){return(l&&l[t.ks.systemString]&&l[t.ks.systemString].priority>=0?l[t.ks.systemString].priority:e.length)-(l&&l[n.ks.systemString]&&l[n.ks.systemString].priority>=0?l[n.ks.systemString].priority:e.length)});for(var a=0;a<e.length;a++){var o=H(e[a]);r.push({ks:e[a].ks,configs:[o],protData:e[a].protData})}w.requestKeySystemAccess(r).then(function(e){var t=(i=e.data).mksa&&i.mksa.selectedSystemString?i.mksa.selectedSystemString:i.keySystem.systemString;return n.info("DRM: KeySystem Access Granted for system string ("+t+")!  Selecting key system..."),w.selectKeySystem(i)}).then(function(e){if(d=e,_=!1,w){A.trigger(I.KEY_SYSTEM_SELECTED,{data:i});var t=G(d);t&&t.serverCertificate&&t.serverCertificate.length>0&&w.setServerCertificate(R.decodeArray(t.serverCertificate).buffer),O()}}).catch(function(e){d=null,_=!1,t||A.trigger(I.KEY_SYSTEM_SELECTED,{data:null,error:new h.Z(f.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,f.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+"Error selecting key system! -- "+e.error)})})}}(e,t)}function O(){for(var e,t=0;t<i.length;t++)for(e=0;e<i[t].length;e++)if(d===i[t][e].ks){F(i[t][e]);break}i=[]}function F(e){if(S.isClearKey(d)&&e.protData&&e.protData.hasOwnProperty("clearkeys")&&0!==Object.keys(e.protData.clearkeys).length){var t={kids:Object.keys(e.protData.clearkeys)};e.initData=(new TextEncoder).encode(JSON.stringify(t))}e.sessionId?U(e):null!==e.initData&&B(e)}function U(e){P(),w.loadKeySession(e)}function B(e){var t=a.getPSSHForKeySystem(d,e?e.initData:null);if(t){if(function(e){if(!e)return!1;try{for(var t=w.getSessions(),n=0;n<t.length;n++)if(t[n].getKeyId()===e)return!0;return!1}catch(e){return!1}}(e.keyId))return;if(j(t))return;try{e.initData=t,w.createKeySession(e)}catch(e){A.trigger(I.KEY_SESSION_CREATED,{data:null,error:new h.Z(f.KEY_SESSION_CREATED_ERROR_CODE,f.KEY_SESSION_CREATED_ERROR_MESSAGE+e.message)})}}else e&&e.initData?w.createKeySession(e):A.trigger(I.KEY_SESSION_CREATED,{data:null,error:new h.Z(f.KEY_SESSION_CREATED_ERROR_CODE,f.KEY_SESSION_CREATED_ERROR_MESSAGE+"Selected key system is "+(d?d.systemString:null)+".  needkey/encrypted event contains no initData corresponding to that key system!")})}function G(e){if(e){var t=e.systemString;if(l)return t in l?l[t]:null}return null}function j(e){if(!e)return!1;try{for(var t=w.getAllInitData(),i=0;i<t.length;i++)if(S.initDataEquals(e,t[i]))return n.debug("DRM: Ignoring initData because we have already seen it!"),!0;return!1}catch(e){return!1}}function V(e){P(),e?(w.setMediaElement(e),A.on(I.NEED_KEY,Q,t)):null===e&&(w.setMediaElement(e),A.off(I.NEED_KEY,Q,t))}function H(e){var t=e.protData,n=[],i=[],a=t&&t.audioRobustness&&t.audioRobustness.length>0?t.audioRobustness:c,l=t&&t.videoRobustness&&t.videoRobustness.length>0?t.videoRobustness:c,u=e.sessionType,d=t&&t.distinctiveIdentifier?t.distinctiveIdentifier:"optional",f=t&&t.persistentState?t.persistentState:"temporary"===u?"optional":"required";return r.forEach(function(e){e.type===C.AUDIO?n.push(new o(e.codec,a)):e.type===C.VIDEO&&i.push(new o(e.codec,l))}),new s(n,i,d,f,[u])}function K(e){e.error?A.trigger(I.KEY_STATUSES_CHANGED,{data:null,error:e.error}):n.debug("DRM: key status = "+e.status)}function z(e){n.debug("DRM: onKeyMessage");var t=e.data;A.trigger(I.KEY_MESSAGE,{data:t});var i=t.messageType?t.messageType:"license-request",o=t.message,s=t.sessionToken,l=G(d),u=S.getLicenseServerModelInstance(d,l,i),c={sessionToken:s,messageType:i};if(o&&0!==o.byteLength){if(!u)return n.debug("DRM: License server request not required for this message (type = "+e.data.messageType+").  Session ID = "+s.getSessionId()),void Z(c);if(S.isClearKey(d)){var y=S.processClearKeyLicenseRequest(d,l,o);if(y&&y.keyPairs&&y.keyPairs.length>0)return n.debug("DRM: ClearKey license request handled by application!"),Z(c),void w.updateKeySession(s,y)}!function(e,t,n){var i=e.sessionToken,o=e.messageType?e.messageType:"license-request",s={sessionToken:i,messageType:o},l=d?d.systemString:null,u=function(e,t,n,i,o){var s=null,l=i.message;if(e&&e.serverURL){var u=e.serverURL;"string"==typeof u&&""!==u?s=u:"object"===b(u)&&u.hasOwnProperty(t)&&(s=u[t])}else if(e&&e.laURL&&""!==e.laURL)s=e.laURL;else if(!(s=a.getLicenseServerUrlFromMediaInfo(r,d.schemeIdURI))&&!S.isClearKey(d)){var c=a.getPSSHData(n.initData);(s=d.getLicenseServerURLFromInitData(c))||(s=i.laURL)}return o.getServerURLFromMessage(s,l,t)}(n,o,i,e,t);if(u){var c={},y=!1;n&&W(c,n.httpRequestHeaders);var _=e.message;W(c,d.getRequestHeadersFromMessage(_)),Object.keys(c).forEach(function(e){"authorization"===e.toLowerCase()&&(y=!0)}),n&&"boolean"==typeof n.withCredentials&&(y=n.withCredentials);var E=function(e){if(w)if(e.status>=200&&e.status<=299){var n=v.Z.parseHttpHeaders(e.getAllResponseHeaders?e.getAllResponseHeaders():null),r=new g(e.responseURL,n,e.response);X(L.getLicenseResponseFilters(),r).then(function(){var n=t.getLicenseMessage(r.data,l,o);null!==n?(Z(s),w.updateKeySession(i,n)):$(e,s,l,o,t)})}else $(e,s,l,o,t)},T=function(e){Z(s,new h.Z(f.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,f.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+l+' update, XHR aborted. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState))},A=function(e){Z(s,new h.Z(f.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,f.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+l+' update, XHR error. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState))},I=d.getLicenseRequestFromMessage(_),x=t.getHTTPMethod(o),R=t.getResponseType(l,o),C=n&&!isNaN(n.httpTimeout)?n.httpTimeout:8e3,D=i.getSessionId()||null,k=new p(u,x,R,c,y,o,D,I),P=isNaN(M.get().streaming.retryAttempts[m.w.LICENSE])?3:M.get().streaming.retryAttempts[m.w.LICENSE];X(L.getLicenseRequestFilters(),k).then(function(){q(k,P,C,E,T,A)})}else Z(s,new h.Z(f.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE,f.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE))}(t,u,l)}else Z(c,new h.Z(f.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE,f.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE))}function Z(e,t){A.trigger(I.LICENSE_REQUEST_COMPLETE,{data:e,error:t})}function q(e,t,i,r,a,o){var s=new XMLHttpRequest;if(M.get().streaming.cmcd&&M.get().streaming.cmcd.enabled&&M.get().streaming.cmcd.mode===y.Z.CMCD_MODE_QUERY){var l=k.getQueryParameter({url:e.url,type:m.w.LICENSE});l&&(e.url=v.Z.addAditionalQueryParameterToUrl(e.url,[l]))}for(var u in s.open(e.method,e.url,!0),s.responseType=e.responseType,s.withCredentials=e.withCredentials,i>0&&(s.timeout=i),e.headers)s.setRequestHeader(u,e.headers[u]);if(M.get().streaming.cmcd&&M.get().streaming.cmcd.enabled&&M.get().streaming.cmcd.mode===y.Z.CMCD_MODE_HEADER){var c=k.getHeaderParameters({url:e.url,type:m.w.LICENSE});if(c)for(var d in c){var f=c[d];f&&s.setRequestHeader(d,f)}}var h=function(){t--;var n=isNaN(M.get().streaming.retryIntervals[m.w.LICENSE])?1e3:M.get().streaming.retryIntervals[m.w.LICENSE];T=setTimeout(function(){q(e,t,i,r,a,o)},n)};s.onload=function(){E=null,this.status>=200&&this.status<=299||t<=0?r(this):(n.warn("License request failed ("+this.status+"). Retrying it... Pending retries: "+t),h())},s.ontimeout=s.onerror=function(){E=null,t<=0?o(this):(n.warn("License request network request failed . Retrying it... Pending retries: "+t),h())},s.onabort=function(){a(this)},A.trigger(I.LICENSE_REQUEST_SENDING,{url:e.url,headers:e.headers,payload:e.data,sessionId:e.sessionId}),E=s,s.send(e.data)}function Y(){E&&(E.onloadend=E.onerror=E.onprogress=void 0,E.abort(),E=null),T&&(clearTimeout(T),T=null)}function W(e,t){if(t)for(var n in t)e[n]=t[n]}function $(e,t,n,i,r){var a="NONE",o=null;e.response&&(a=r.getErrorResponse(e.response,n,i),o={serverResponse:e.response||null,responseCode:e.status||null,responseText:e.statusText||null}),Z(t,new h.Z(f.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,f.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+n+' update, XHR complete. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState+".  Response is "+a,o))}function X(e,t){return e?e.reduce(function(e,n){return e.then(function(){return n(t)})},Promise.resolve()):Promise.resolve()}function Q(e,t){if(!M.get().streaming.protection.ignoreEmeEncryptedEvent){if(n.debug("DRM: onNeedKey"),"cenc"!==e.key.initDataType)return void n.warn("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+e.key.initDataType);if(0===r.length&&(n.warn("DRM: onNeedKey called before initializeForMedia, wait until initialized"),(t=void 0===t?1:t+1)<5))return void D.push(setTimeout(function(){Q(e,t)},500));var o=e.key.initData;if(ArrayBuffer.isView(o)&&(o=o.buffer),d){var s=a.getPSSHForKeySystem(d,o);if(s&&j(s))return}n.debug("DRM: initData:",String.fromCharCode.apply(null,new Uint8Array(o)));var c=S.getSupportedKeySystemsFromSegmentPssh(o,l,u);if(0===c.length)return void n.debug("DRM: Received needkey event with initData, but we don't support any of the key systems!");!function(e){i.push(e),N(e,!1)}(c)}}return t={initializeForMedia:function(e){if(!e)throw new Error("mediaInfo can not be null or undefined");P(),r.push(e)},clearMediaInfoArray:function(){r=[]},handleKeySystemFromManifest:function(){if(r&&0!==r.length){var e=[];r.forEach(function(t){var n=S.getSupportedKeySystemsFromContentProtection(t.contentProtection,l,u);n.length>0&&(0===e.length&&(e=n),i.push(n))}),e&&e.length>0&&N(e,!0)}},createKeySession:B,loadKeySession:U,removeKeySession:function(e){P(),w.removeKeySession(e)},closeKeySession:function(e){P(),w.closeKeySession(e)},setServerCertificate:function(e){P(),w.setServerCertificate(e)},setMediaElement:V,setSessionType:function(e){u=e},setRobustnessLevel:function(e){c=e},setProtectionData:function(e){l=e,S.setProtectionData(e)},getSupportedKeySystemsFromContentProtection:function(e){return P(),S.getSupportedKeySystemsFromContentProtection(e,l,u)},getKeySystems:function(){return S?S.getKeySystems():[]},setKeySystems:function(e){S&&S.setKeySystems(e)},stop:function(){Y(),w&&w.stop()},reset:function(){A.off(I.INTERNAL_KEY_MESSAGE,z,t),A.off(I.INTERNAL_KEY_STATUS_CHANGED,K,t),P(),Y(),V(null),d=null,_=!1,w&&(w.reset(),w=null),D.forEach(function(e){return clearTimeout(e)}),D=[],r=[],i=[]}},n=x.getLogger(t),i=[],r=[],u="temporary",c="",E=null,T=null,A.on(I.INTERNAL_KEY_MESSAGE,z,t),A.on(I.INTERNAL_KEY_STATUS_CHANGED,K,t),t}E.__dashjs_factory_name="ProtectionController";var T=_.Z.getClassFactory(E),S=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keyID=t,this.key=n};function w(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var A=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n&&"persistent"!==n&&"temporary"!==n)throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=t,this.type=n}var t,n;return t=e,(n=[{key:"toJWK",value:function(){var e,t=this.keyPairs.length,n={keys:[]};for(e=0;e<t;e++){var i={kty:"oct",alg:"A128KW",kid:this.keyPairs[e].keyID,k:this.keyPairs[e].key};n.keys.push(i)}this.type&&(n.type=this.type);var r=JSON.stringify(n),a=r.length,o=new ArrayBuffer(a),s=new Uint8Array(o);for(e=0;e<a;e++)s[e]=r.charCodeAt(e);return o}}])&&w(t.prototype,n),e}();function I(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var x=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}var t,n;return t=e,(n=[{key:"init",value:function(){this.CLEARKEY_KEYSTEM_STRING="org.w3.clearkey",this.WIDEVINE_KEYSTEM_STRING="com.widevine.alpha",this.PLAYREADY_KEYSTEM_STRING="com.microsoft.playready",this.PLAYREADY_RECOMMENDATION_KEYSTEM_STRING="com.microsoft.playready.recommendation",this.INITIALIZATION_DATA_TYPE_CENC="cenc",this.INITIALIZATION_DATA_TYPE_KEYIDS="keyids",this.INITIALIZATION_DATA_TYPE_WEBM="webm"}}])&&I(t.prototype,n),e}()),R="e2719d58-a985-b3c9-781a-b030af78d30e",C=x.CLEARKEY_KEYSTEM_STRING,D="urn:uuid:"+R;function k(e){var t=(e=e||{}).BASE64;return{uuid:R,schemeIdURI:D,systemString:C,getInitData:function(e,n){try{var i=a.parseInitDataFromContentProtection(e,t);if(!i&&n){var r={kids:[function(e){try{var t=e.replace(/-/g,"");return(t=btoa(t.match(/\w{2}/g).map(function(e){return String.fromCharCode(parseInt(e,16))}).join(""))).replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-")}catch(e){return null}}(n["cenc:default_KID"])]};i=(new TextEncoder).encode(JSON.stringify(r))}return i}catch(e){return null}},getRequestHeadersFromMessage:function(){return{"Content-Type":"application/json"}},getLicenseRequestFromMessage:function(e){return JSON.stringify(JSON.parse(String.fromCharCode.apply(null,new Uint8Array(e))))},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getClearKeysFromProtectionData:function(e,t){var n=null;if(e){for(var i=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),r=[],a=0;a<i.kids.length;a++){var o=i.kids[a],s=e.clearkeys&&e.clearkeys.hasOwnProperty(o)?e.clearkeys[o]:null;if(!s)throw new Error("DRM: ClearKey keyID ("+o+") is not known!");r.push(new S(o,s))}n=new A(r)}return n}}}k.__dashjs_factory_name="KeySystemClearKey";var M=dashjs.FactoryMaker.getSingletonFactory(k),L="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",P=x.CLEARKEY_KEYSTEM_STRING,N="urn:uuid:"+L;function O(e){var t,n=e.BASE64,i=e.debug.getLogger(t);return{uuid:L,schemeIdURI:N,systemString:P,getInitData:function(e){return a.parseInitDataFromContentProtection(e,n)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getClearKeysFromProtectionData:function(e,t){var n=null;if(e){for(var r=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),a=[],o=0;o<r.kids.length;o++){var s=r.kids[o],l=e.clearkeys&&e.clearkeys.hasOwnProperty(s)?e.clearkeys[s]:null;if(!l)throw new Error("DRM: ClearKey keyID ("+s+") is not known!");a.push(new S(s,l))}n=new A(a),i.warn("ClearKey schemeIdURI is using W3C Common PSSH systemID (1077efec-c0b2-4d02-ace3-3c1e52e2fb4b) in Content Protection. See DASH-IF IOP v4.1 section 7.6.2.4")}return n}}}O.__dashjs_factory_name="KeySystemW3CClearKey";var F=dashjs.FactoryMaker.getSingletonFactory(O),U="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",B=x.WIDEVINE_KEYSTEM_STRING,G="urn:uuid:"+U;function j(e){var t=(e=e||{}).BASE64;return{uuid:U,schemeIdURI:G,systemString:B,getInitData:function(e){return a.parseInitDataFromContentProtection(e,t)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null}}}j.__dashjs_factory_name="KeySystemWidevine";var V=dashjs.FactoryMaker.getSingletonFactory(j),H="9a04f079-9840-4286-ab92-e65be0885f95",K=x.PLAYREADY_KEYSTEM_STRING,z="urn:uuid:"+H;function Z(e){var t="utf-16",n=(e=e||{}).BASE64,i=e.settings;function r(){if(!n||!n.hasOwnProperty("decodeArray")||!n.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}return{uuid:H,schemeIdURI:z,systemString:K,getInitData:function(e){var t,i,o,s,l,u=new Uint8Array([112,115,115,104,0,0,0,0]),c=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),d=0,f=null;if(r(),!e)return null;if("pssh"in e)return a.parseInitDataFromContentProtection(e,n);if("pro"in e)f=n.decodeArray(e.pro.__text);else{if(!("prheader"in e))return null;f=n.decodeArray(e.prheader.__text)}return t=f.length,i=4+u.length+c.length+4+t,o=new ArrayBuffer(i),s=new Uint8Array(o),(l=new DataView(o)).setUint32(d,i),d+=4,s.set(u,d),d+=u.length,s.set(c,d),d+=c.length,l.setUint32(d,t),d+=4,s.set(f,d),d+=t,s.buffer},getRequestHeadersFromMessage:function(e){var n,r,a={},o=new DOMParser;if(i&&i.get().streaming.protection.detectPlayreadyMessageFormat&&"utf-16"===t&&e&&e.byteLength%2==1)return a["Content-Type"]="text/xml; charset=utf-8",a;var s="utf-16"===t?new Uint16Array(e):new Uint8Array(e);n=String.fromCharCode.apply(null,s);for(var l=(r=o.parseFromString(n,"application/xml")).getElementsByTagName("name"),u=r.getElementsByTagName("value"),c=0;c<l.length;c++)a[l[c].childNodes[0].nodeValue]=u[c].childNodes[0].nodeValue;return a.hasOwnProperty("Content")&&(a["Content-Type"]=a.Content,delete a.Content),a.hasOwnProperty("Content-Type")||(a["Content-Type"]="text/xml; charset=utf-8"),a},getLicenseRequestFromMessage:function(e){var a=null,o=new DOMParser;if(i&&i.get().streaming.protection.detectPlayreadyMessageFormat&&"utf-16"===t&&e&&e.byteLength%2==1)return e;var s="utf-16"===t?new Uint16Array(e):new Uint8Array(e);r();var l=String.fromCharCode.apply(null,s),u=o.parseFromString(l,"application/xml");if(!u.getElementsByTagName("PlayReadyKeyMessage")[0])return e;var c=u.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;return c&&(a=n.decode(c)),a},getLicenseServerURLFromInitData:function(e){if(e)for(var t=new DataView(e),n=t.getUint16(4,!0),i=6,r=new DOMParser,a=0;a<n;a++){var o=t.getUint16(i,!0);i+=2;var s=t.getUint16(i,!0);if(i+=2,1===o){var l=e.slice(i,i+s),u=String.fromCharCode.apply(null,new Uint16Array(l)),c=r.parseFromString(u,"application/xml");if(c.getElementsByTagName("LA_URL")[0]){var d=c.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue;if(d)return d}if(c.getElementsByTagName("LUI_URL")[0]){var f=c.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue;if(f)return f}}else i+=s}return null},getCDMData:function(e){var t,i,a,o;if(r(),!e)return null;for(t=[],o=0;o<e.length;++o)t.push(e.charCodeAt(o)),t.push(0);for(t=String.fromCharCode.apply(null,t),t=n.encode(t),i='<PlayReadyCDMData type="LicenseAcquisition"><LicenseAcquisition version="1.0" Proactive="false"><CustomData encoding="base64encoded">%CUSTOMDATA%</CustomData></LicenseAcquisition></PlayReadyCDMData>'.replace("%CUSTOMDATA%",t),a=[],o=0;o<i.length;++o)a.push(i.charCodeAt(o)),a.push(0);return new Uint8Array(a).buffer},setPlayReadyMessageFormat:function(e){if("utf-8"!==e&&"utf-16"!==e)throw new Error('Specified message format is not one of "utf-8" or "utf-16"');t=e}}}Z.__dashjs_factory_name="KeySystemPlayReady";var q=dashjs.FactoryMaker.getSingletonFactory(Z);function Y(e){var t=(e=e||{}).BASE64,n={};return n[x.WIDEVINE_KEYSTEM_STRING]={responseType:"json",getLicenseMessage:function(e){return t.decodeArray(e.license)},getErrorResponse:function(e){return e}},n[x.PLAYREADY_KEYSTEM_STRING]={responseType:"arraybuffer",getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}},{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(e){return n[e].responseType},getLicenseMessage:function(e,i){return function(){if(!t||!t.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}(),n[i].getLicenseMessage(e)},getErrorResponse:function(e,t){return n[t].getErrorResponse(e)}}}Y.__dashjs_factory_name="DRMToday";var W=dashjs.FactoryMaker.getSingletonFactory(Y);function $(){var e="http://schemas.xmlsoap.org/soap/envelope/";function t(e){var t=String.fromCharCode.apply(null,new Uint8Array(e));return decodeURIComponent(escape(t))}function n(n){if(window.DOMParser){var i=t(n),r=(new window.DOMParser).parseFromString(i,"text/xml"),a=r?r.getElementsByTagNameNS(e,"Envelope")[0]:null,o=a?a.getElementsByTagNameNS(e,"Body")[0]:null;if(o&&o.getElementsByTagNameNS(e,"Fault")[0])return null}return n}function i(n){var i="",r="",a="",o=-1,s=-1;if(window.DOMParser){var l=t(n),u=(new window.DOMParser).parseFromString(l,"text/xml"),c=u?u.getElementsByTagNameNS(e,"Envelope")[0]:null,d=c?c.getElementsByTagNameNS(e,"Body")[0]:null,f=d?d.getElementsByTagNameNS(e,"Fault")[0]:null,h=f?f.getElementsByTagName("detail")[0]:null,p=h?h.getElementsByTagName("Exception")[0]:null,g=null;if(null===f)return l;i=(g=f.getElementsByTagName("faultstring")[0].firstChild)?g.nodeValue:null,null!==p&&(r=(g=p.getElementsByTagName("StatusCode")[0])?g.firstChild.nodeValue:null,o=(a=(g=p.getElementsByTagName("Message")[0])?g.firstChild.nodeValue:null)?a.lastIndexOf("[")+1:-1,s=a?a.indexOf("]"):-1,a=a?a.substring(o,s):"")}var m="code: ".concat(r,", name: ").concat(i);return a&&(m+=", message: ".concat(a)),m}return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(e){return n.call(this,e)},getErrorResponse:function(e){return i.call(this,e)}}}$.__dashjs_factory_name="PlayReady";var X=_.Z.getSingletonFactory($);function Q(){return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}}Q.__dashjs_factory_name="Widevine";var J=dashjs.FactoryMaker.getSingletonFactory(Q);function ee(){return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"json"},getLicenseMessage:function(e){if(!e.hasOwnProperty("keys"))return null;for(var t=[],n=0;n<e.keys.length;n++){var i=e.keys[n],r=i.kid.replace(/=/g,""),a=i.k.replace(/=/g,"");t.push(new S(r,a))}return new A(t)},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}}ee.__dashjs_factory_name="ClearKey";var te=dashjs.FactoryMaker.getSingletonFactory(ee);function ne(){var e,t,n,i,r,o,s,l,u=this.context;function c(e,t){return t&&e in t?t[e]:null}function d(e,t){return e&&e.sessionId?e.sessionId:t&&t.sessionId?t.sessionId:null}function f(e,t){return e&&e.sessionType?e.sessionType:t}return e={initialize:function(){var e;i=[],e=q(u).getInstance({BASE64:r,settings:o}),i.push(e),e=V(u).getInstance({BASE64:r}),i.push(e),e=M(u).getInstance({BASE64:r}),i.push(e),s=e,e=F(u).getInstance({BASE64:r,debug:t}),i.push(e),l=e},setProtectionData:function(e){for(var t,n,r=0;r<i.length;r++){var a=i[r];a.hasOwnProperty("init")&&a.init((t=a.systemString,n=void 0,n=null,e&&(n=t in e?e[t]:null),n))}},isClearKey:function(e){return e===s||e===l},initDataEquals:function(e,t){if(e.byteLength===t.byteLength){for(var n=new Uint8Array(e),i=new Uint8Array(t),r=0;r<n.length;r++)if(n[r]!==i[r])return!1;return!0}return!1},getKeySystems:function(){return i},setKeySystems:function(e){i=e},getKeySystemBySystemString:function(e){for(var t=0;t<i.length;t++)if(i[t].systemString===e)return i[t];return null},getSupportedKeySystemsFromContentProtection:function(e,t,n){var r,o,s,l,u=[];if(e){var h=a.findCencContentProtection(e);for(s=0;s<i.length;++s){var p=c((o=i[s]).systemString,t);for(l=0;l<e.length;++l)if((r=e[l]).schemeIdUri.toLowerCase()===o.schemeIdURI){var g=o.getInitData(r,h);u.push({ks:i[s],keyId:r.keyId,initData:g,protData:p,cdmData:o.getCDMData(p?p.cdmData:null),sessionId:d(p,r),sessionType:f(p,n)})}}}return u},getSupportedKeySystemsFromSegmentPssh:function(e,t,n){for(var r,o=[],s=a.parsePSSHList(e),l=0;l<i.length;++l){var u=c((r=i[l]).systemString,t);r.uuid in s&&o.push({ks:r,initData:s[r.uuid],protData:u,cdmData:r.getCDMData(u?u.cdmData:null),sessionId:d(u),sessionType:f(u,n)})}return o},getLicenseServerModelInstance:function(e,t,n){if("license-release"===n||"individualization-request"===n)return null;var i=null;return t&&t.hasOwnProperty("drmtoday")?i=W(u).getInstance({BASE64:r}):e.systemString===x.WIDEVINE_KEYSTEM_STRING?i=J(u).getInstance():e.systemString===x.PLAYREADY_KEYSTEM_STRING?i=X(u).getInstance():e.systemString===x.CLEARKEY_KEYSTEM_STRING&&(i=te(u).getInstance()),i},processClearKeyLicenseRequest:function(e,t,i){try{return e.getClearKeysFromProtectionData(t,i)}catch(e){return n.error("Failed to retrieve clearkeys from ProtectionData"),null}},setConfig:function(i){i&&(i.debug&&(t=i.debug,n=t.getLogger(e)),i.BASE64&&(r=i.BASE64),i.settings&&(o=i.settings))}},e}ne.__dashjs_factory_name="ProtectionKeyController";var ie=dashjs.FactoryMaker.getSingletonFactory(ne);function re(e){return re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},re(e)}function ae(e,t){return ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ae(e,t)}function oe(e,t){return!t||"object"!==re(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function se(e){return se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},se(e)}var le=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ae(e,t)}(r,e);var t,n,i=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=se(t);if(n){var r=se(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return oe(this,e)});function r(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(e=i.call(this)).INTERNAL_KEY_MESSAGE="internalKeyMessage",e.INTERNAL_KEY_STATUS_CHANGED="internalkeyStatusChanged",e.KEY_ADDED="public_keyAdded",e.KEY_ERROR="public_keyError",e.KEY_MESSAGE="public_keyMessage",e.KEY_SESSION_CLOSED="public_keySessionClosed",e.KEY_SESSION_CREATED="public_keySessionCreated",e.KEY_SESSION_REMOVED="public_keySessionRemoved",e.KEY_STATUSES_CHANGED="public_keyStatusesChanged",e.KEY_SYSTEM_ACCESS_COMPLETE="public_keySystemAccessComplete",e.KEY_SYSTEM_SELECTED="public_keySystemSelected",e.LICENSE_REQUEST_COMPLETE="public_licenseRequestComplete",e.LICENSE_REQUEST_SENDING="public_licenseRequestSending",e.NEED_KEY="needkey",e.PROTECTION_CREATED="public_protectioncreated",e.PROTECTION_DESTROYED="public_protectiondestroyed",e.SERVER_CERTIFICATE_UPDATED="serverCertificateUpdated",e.TEARDOWN_COMPLETE="protectionTeardownComplete",e.VIDEO_ELEMENT_SELECTED="videoElementSelected",e.KEY_SESSION_UPDATED="public_keySessionUpdated",e}return r}(n(8342).Z)),ue=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initData=t,this.initDataType=n},ce=function e(t,n,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sessionToken=t,this.message=n,this.defaultURL=i,this.messageType=r||"license-request"},de=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keySystem=t,this.ksConfiguration=n},fe={};function he(e){e=e||{};var t,n,i,r,a,o,s,l,u=this.context,c=e.eventBus,d=e.events,p=e.debug;function g(e,t,n,i){if(void 0===navigator.requestMediaKeySystemAccess||"function"!=typeof navigator.requestMediaKeySystemAccess){var r="Insecure origins are not allowed";return c.trigger(d.KEY_SYSTEM_ACCESS_COMPLETE,{error:r}),void i({error:r})}var a=e[t].protData&&e[t].protData.systemStringPriority?e[t].protData.systemStringPriority:null,o=e[t].configs,s=e[t].ks,l=s.systemString;(function(e,t){return new Promise(function(n,i){m(e,t,0,n,i)})})(a||(fe[l]?fe[l]:[l]),o).then(function(e){var t="function"==typeof e.getConfiguration?e.getConfiguration():null,i=new de(s,t);i.mksa=e,c.trigger(d.KEY_SYSTEM_ACCESS_COMPLETE,{data:i}),n({data:i})}).catch(function(r){if(t+1<e.length)g(e,t+1,n,i);else{var a="Key system access denied! ";c.trigger(d.KEY_SYSTEM_ACCESS_COMPLETE,{error:a+r.message}),i({error:a+r.message})}})}function m(e,t,i,r,a){var o=e[i];n.debug("Requesting key system access for system string ".concat(o)),navigator.requestMediaKeySystemAccess(o,t).then(function(e){e.selectedSystemString=o,r(e)}).catch(function(n){i+1<e.length?m(e,t,i+1,r,a):a(n)})}function v(e){if(!e||!e.session)return Promise.resolve;var t=e.session;return t.removeEventListener("keystatuseschange",e),t.removeEventListener("message",e),t.close()}function y(e){for(var t=0;t<o.length;t++)if(o[t]===e){o.splice(t,1);break}}function _(e){var t,n;return e&&e.length>0&&(e[0]&&("string"==typeof e[0]?t=e[0]:n=e[0]),e[1]&&("string"==typeof e[1]?t=e[1]:n=e[1])),{status:t,keyId:n}}function b(e,t){var i={session:e,keyId:t.keyId,initData:t.initData,sessionId:t.sessionId,sessionType:t.sessionType,handleEvent:function(e){switch(e.type){case"keystatuseschange":c.trigger(d.KEY_STATUSES_CHANGED,{data:this}),e.target.keyStatuses.forEach(function(){var e=_(arguments);"expired"===e.status?c.trigger(d.INTERNAL_KEY_STATUS_CHANGED,{error:new h.Z(f.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE,f.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE)}):c.trigger(d.INTERNAL_KEY_STATUS_CHANGED,e)});break;case"message":var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;c.trigger(d.INTERNAL_KEY_MESSAGE,{data:new ce(this,t,void 0,e.messageType)})}},getKeyId:function(){return this.keyId},getSessionId:function(){return e.sessionId},getSessionType:function(){return this.sessionType},getExpirationTime:function(){return e.expiration},getKeyStatuses:function(){return e.keyStatuses},getUsable:function(){var t=!1;return e.keyStatuses.forEach(function(){var e=_(arguments);"usable"===e.status&&(t=!0)}),t}};return e.addEventListener("keystatuseschange",i),e.addEventListener("message",i),e.closed.then(function(){y(i),n.debug("DRM: Session closed.  SessionID = "+i.getSessionId()),c.trigger(d.KEY_SESSION_CLOSED,{data:i.getSessionId()})}),o.push(i),i}return t={getAllInitData:function(){for(var e=[],t=0;t<o.length;t++)o[t].initData&&e.push(o[t].initData);return e},getSessions:function(){return o},requestKeySystemAccess:function(e){return new Promise(function(t,n){g(e,0,t,n)})},selectKeySystem:function(e){return new Promise(function(t,n){e.mksa.createMediaKeys().then(function(t){return i=e.keySystem,a=t,r?r.setMediaKeys(a):Promise.resolve()}).then(function(){t(i)}).catch(function(){n({error:"Error selecting keys system ("+e.keySystem.systemString+")! Could not create MediaKeys -- TODO"})})})},setMediaElement:function(e){r!==e&&(r&&(r.removeEventListener("encrypted",s),r.setMediaKeys&&r.setMediaKeys(null)),(r=e)&&(r.addEventListener("encrypted",s),r.setMediaKeys&&a&&r.setMediaKeys(a)))},setServerCertificate:function(e){if(!i||!a)throw new Error("Can not set server certificate until you have selected a key system");a.setServerCertificate(e).then(function(){n.info("DRM: License server certificate successfully updated."),c.trigger(d.SERVER_CERTIFICATE_UPDATED)}).catch(function(e){c.trigger(d.SERVER_CERTIFICATE_UPDATED,{error:new h.Z(f.SERVER_CERTIFICATE_UPDATED_ERROR_CODE,f.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE+e.name)})})},createKeySession:function(e){if(!i||!a)throw new Error("Can not create sessions until you have selected a key system");var t=a.createSession(e.sessionType),r=b(t,e),o=i.systemString===x.CLEARKEY_KEYSTEM_STRING&&(e.initData||e.protData&&e.protData.clearkeys)?x.INITIALIZATION_DATA_TYPE_KEYIDS:x.INITIALIZATION_DATA_TYPE_CENC;t.generateRequest(o,e.initData).then(function(){n.debug("DRM: Session created.  SessionID = "+r.getSessionId()),c.trigger(d.KEY_SESSION_CREATED,{data:r})}).catch(function(e){y(r),c.trigger(d.KEY_SESSION_CREATED,{data:null,error:new h.Z(f.KEY_SESSION_CREATED_ERROR_CODE,f.KEY_SESSION_CREATED_ERROR_MESSAGE+"Error generating key request -- "+e.name)})})},updateKeySession:function(e,t){var n=e.session;l.isClearKey(i)&&(t=t.toJWK()),n.update(t).then(function(){c.trigger(d.KEY_SESSION_UPDATED)}).catch(function(t){c.trigger(d.KEY_ERROR,{error:new h.Z(f.MEDIA_KEYERR_CODE,"Error sending update() message! "+t.name,e)})})},loadKeySession:function(e){if(!i||!a)throw new Error("Can not load sessions until you have selected a key system");for(var t=e.sessionId,r=0;r<o.length;r++)if(t===o[r].sessionId)return void n.warn("DRM: Ignoring session ID because we have already seen it!");var s=a.createSession(e.sessionType),l=b(s,e);s.load(t).then(function(e){e?(n.debug("DRM: Session loaded.  SessionID = "+l.getSessionId()),c.trigger(d.KEY_SESSION_CREATED,{data:l})):(y(l),c.trigger(d.KEY_SESSION_CREATED,{data:null,error:new h.Z(f.KEY_SESSION_CREATED_ERROR_CODE,f.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session! Invalid Session ID ("+t+")")}))}).catch(function(e){y(l),c.trigger(d.KEY_SESSION_CREATED,{data:null,error:new h.Z(f.KEY_SESSION_CREATED_ERROR_CODE,f.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session ("+t+")! "+e.name)})})},removeKeySession:function(e){e.session.remove().then(function(){n.debug("DRM: Session removed.  SessionID = "+e.getSessionId()),c.trigger(d.KEY_SESSION_REMOVED,{data:e.getSessionId()})},function(t){c.trigger(d.KEY_SESSION_REMOVED,{data:null,error:"Error removing session ("+e.getSessionId()+"). "+t.name})})},closeKeySession:function(e){v(e).catch(function(t){y(e),c.trigger(d.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+e.getSessionId()+") "+t.name})})},stop:function(){for(var e,t=0;t<o.length;t++)(e=o[t]).getUsable()||(v(e),y(e))},reset:function(){var e,t=o.length;0!==t?function(){for(var n=function(e){y(e),0===o.length&&(r?(r.removeEventListener("encrypted",s),r.setMediaKeys(null).then(function(){c.trigger(d.TEARDOWN_COMPLETE)})):c.trigger(d.TEARDOWN_COMPLETE))},i=0;i<t;i++)!function(t){v(e),n(t)}(e=o[i])}():c.trigger(d.TEARDOWN_COMPLETE)}},n=p.getLogger(t),i=null,r=null,a=null,o=[],l=ie(u).getInstance(),s={handleEvent:function(e){if("encrypted"===e.type&&e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;c.trigger(d.NEED_KEY,{key:new ue(t,e.initDataType)})}}},t}fe[x.PLAYREADY_KEYSTEM_STRING]=[x.PLAYREADY_KEYSTEM_STRING,x.PLAYREADY_RECOMMENDATION_KEYSTEM_STRING],fe[x.WIDEVINE_KEYSTEM_STRING]=[x.WIDEVINE_KEYSTEM_STRING],fe[x.CLEARKEY_KEYSTEM_STRING]=[x.CLEARKEY_KEYSTEM_STRING],he.__dashjs_factory_name="ProtectionModel_21Jan2015";var pe=dashjs.FactoryMaker.getClassFactory(he);function ge(e){e=e||{};var t,n,i,r,a,o,l,u,c,d=this.context,p=e.eventBus,g=e.events,m=e.debug,v=e.api;function y(){try{for(var e=0;e<l.length;e++)_(l[e]);i&&i.removeEventListener(v.needkey,u),p.trigger(g.TEARDOWN_COMPLETE)}catch(e){p.trigger(g.TEARDOWN_COMPLETE,{error:"Error tearing down key sessions and MediaKeys! -- "+e.message})}}function _(e){var t=e.session;t.removeEventListener(v.error,e),t.removeEventListener(v.message,e),t.removeEventListener(v.ready,e),t.removeEventListener(v.close,e);for(var n=0;n<l.length;n++)if(l[n]===e){l.splice(n,1);break}t[v.release]()}function b(){var e=null,t=function(){i.removeEventListener("loadedmetadata",e),i[v.setMediaKeys](a),p.trigger(g.VIDEO_ELEMENT_SELECTED)};i.readyState>=1?t():(e=t.bind(this),i.addEventListener("loadedmetadata",e))}return t={getAllInitData:function(){for(var e=[],t=0;t<l.length;t++)e.push(l[t].initData);return e},getSessions:function(){return l},requestKeySystemAccess:function(e){return new Promise(function(t,n){for(var i=!1,r=0;r<e.length;r++)for(var a=e[r].ks.systemString,o=e[r].configs,l=null,u=null,d=0;d<o.length;d++){var f=o[d].audioCapabilities,h=o[d].videoCapabilities;if(f&&0!==f.length){l=[];for(var m=0;m<f.length;m++)window[v.MediaKeys].isTypeSupported(a,f[m].contentType)&&l.push(f[m])}if(h&&0!==h.length){u=[];for(var y=0;y<h.length;y++)window[v.MediaKeys].isTypeSupported(a,h[y].contentType)&&u.push(h[y])}if(!(!l&&!u||l&&0===l.length||u&&0===u.length)){i=!0;var _=new s(l,u),b=c.getKeySystemBySystemString(a),E=new de(b,_);p.trigger(g.KEY_SYSTEM_ACCESS_COMPLETE,{data:E}),t({data:E});break}}if(!i){var T="Key system access denied! -- No valid audio/video content configurations detected!";p.trigger(g.KEY_SYSTEM_ACCESS_COMPLETE,{error:T}),n({error:T})}})},selectKeySystem:function(e){return new Promise(function(t,n){try{a=e.mediaKeys=new window[v.MediaKeys](e.keySystem.systemString),r=e.keySystem,o=e,i&&b(),t(r)}catch(e){n({error:"Error selecting keys system ("+r.systemString+")! Could not create MediaKeys -- TODO"})}})},setMediaElement:function(e){i!==e&&(i&&i.removeEventListener(v.needkey,u),(i=e)&&(i.addEventListener(v.needkey,u),a&&b()))},createKeySession:function(e){if(!r||!a||!o)throw new Error("Can not create sessions until you have selected a key system");var t=null;if(o.ksConfiguration.videoCapabilities&&o.ksConfiguration.videoCapabilities.length>0&&(t=o.ksConfiguration.videoCapabilities[0]),null===t&&o.ksConfiguration.audioCapabilities&&o.ksConfiguration.audioCapabilities.length>0&&(t=o.ksConfiguration.audioCapabilities[0]),null===t)throw new Error("Can not create sessions for unknown content types.");var i=t.contentType,s=a.createSession(i,new Uint8Array(e.initData),e.cdmData?new Uint8Array(e.cdmData):null),u=function(e,t){return{session:e,keyId:t.keyId,initData:t.initData,getKeyId:function(){return this.keyId},getSessionId:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"},handleEvent:function(e){switch(e.type){case v.error:p.trigger(g.KEY_ERROR,{error:new h.Z(f.MEDIA_KEYERR_CODE,"KeyError",this)});break;case v.message:var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;p.trigger(g.INTERNAL_KEY_MESSAGE,{data:new ce(this,t,e.destinationURL)});break;case v.ready:n.debug("DRM: Key added."),p.trigger(g.KEY_ADDED);break;case v.close:n.debug("DRM: Session closed.  SessionID = "+this.getSessionId()),p.trigger(g.KEY_SESSION_CLOSED,{data:this.getSessionId()})}}}}(s,e);s.addEventListener(v.error,u),s.addEventListener(v.message,u),s.addEventListener(v.ready,u),s.addEventListener(v.close,u),l.push(u),n.debug("DRM: Session created.  SessionID = "+u.getSessionId()),p.trigger(g.KEY_SESSION_CREATED,{data:u})},updateKeySession:function(e,t){var n=e.session;c.isClearKey(r)?n.update(new Uint8Array(t.toJWK())):n.update(new Uint8Array(t)),p.trigger(g.KEY_SESSION_UPDATED)},closeKeySession:_,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:y,reset:y},n=m.getLogger(t),i=null,r=null,a=null,o=null,l=[],c=ie(d).getInstance(),u={handleEvent:function(e){if(e.type===v.needkey&&e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;p.trigger(g.NEED_KEY,{key:new ue(t,"cenc")})}}},t}ge.__dashjs_factory_name="ProtectionModel_3Feb2014";var me=dashjs.FactoryMaker.getClassFactory(ge);function ve(e){e=e||{};var t,n,i,r,a,o,l,u,c,d=this.context,p=e.eventBus,g=e.events,m=e.debug,v=e.api,y=e.errHandler;function _(){i&&T();for(var e=0;e<l.length;e++)b(l[e]);p.trigger(g.TEARDOWN_COMPLETE)}function b(e){try{i[v.cancelKeyRequest](r.systemString,e.sessionId)}catch(t){p.trigger(g.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+e.sessionId+") "+t.message})}}function E(e,t){if(t&&e){for(var n=e.length,i=0;i<n;i++)if(e[i].sessionId==t)return e[i];return null}return null}function T(){i.removeEventListener(v.keyerror,c),i.removeEventListener(v.needkey,c),i.removeEventListener(v.keymessage,c),i.removeEventListener(v.keyadded,c)}return t={getAllInitData:function(){for(var e=[],t=0;t<o.length;t++)e.push(o[t].initData);for(var n=0;n<l.length;n++)e.push(l[n].initData);return e},getSessions:function(){return l.concat(o)},requestKeySystemAccess:function(e){return new Promise(function(t,n){var r=i;r||(r=document.createElement("video"));for(var o=!1,l=0;l<e.length;l++)for(var u=e[l].ks.systemString,c=e[l].configs,d=null,f=0;f<c.length;f++){var h=c[f].videoCapabilities;if(h&&0!==h.length){d=[];for(var m=0;m<h.length;m++)""!==r.canPlayType(h[m].contentType,u)&&d.push(h[m])}if(d&&(!d||0!==d.length)){o=!0;var v=new s(null,d),y=a.getKeySystemBySystemString(u),_=new de(y,v);p.trigger(g.KEY_SYSTEM_ACCESS_COMPLETE,{data:_}),t({data:_});break}}if(!o){var b="Key system access denied! -- No valid audio/video content configurations detected!";p.trigger(g.KEY_SYSTEM_ACCESS_COMPLETE,{error:b}),n({error:b})}})},selectKeySystem:function(e){return r=e.keySystem,Promise.resolve(r)},setMediaElement:function(e){if(i!==e){if(i){T();for(var t=0;t<l.length;t++)b(l[t]);l=[]}(i=e)&&(i.addEventListener(v.keyerror,c),i.addEventListener(v.needkey,c),i.addEventListener(v.keymessage,c),i.addEventListener(v.keyadded,c),p.trigger(g.VIDEO_ELEMENT_SELECTED))}},createKeySession:function(e){if(!r)throw new Error("Can not create sessions until you have selected a key system");if(u||0===l.length){var t={sessionId:null,keyId:e.keyId,initData:e.initData,getKeyId:function(){return this.keyId},getSessionId:function(){return this.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}};return o.push(t),i[v.generateKeyRequest](r.systemString,new Uint8Array(e.initData)),t}throw new Error("Multiple sessions not allowed!")},updateKeySession:function(e,t){var n=e.sessionId;if(a.isClearKey(r))for(var o=0;o<t.keyPairs.length;o++)i[v.addKey](r.systemString,t.keyPairs[o].key,t.keyPairs[o].keyID,n);else i[v.addKey](r.systemString,new Uint8Array(t),new Uint8Array(e.initData),n);p.trigger(g.KEY_SESSION_UPDATED)},closeKeySession:b,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:_,reset:_},n=m.getLogger(t),i=null,r=null,o=[],l=[],a=ie(d).getInstance(),c={handleEvent:function(e){var t=null;switch(e.type){case v.needkey:var i=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;p.trigger(g.NEED_KEY,{key:new ue(i,"cenc")});break;case v.keyerror:if((t=E(l,e.sessionId))||(t=E(o,e.sessionId)),t){var r=f.MEDIA_KEYERR_CODE,a="";switch(e.errorCode.code){case 1:r=f.MEDIA_KEYERR_UNKNOWN_CODE,a+="MEDIA_KEYERR_UNKNOWN - "+f.MEDIA_KEYERR_UNKNOWN_MESSAGE;break;case 2:r=f.MEDIA_KEYERR_CLIENT_CODE,a+="MEDIA_KEYERR_CLIENT - "+f.MEDIA_KEYERR_CLIENT_MESSAGE;break;case 3:r=f.MEDIA_KEYERR_SERVICE_CODE,a+="MEDIA_KEYERR_SERVICE - "+f.MEDIA_KEYERR_SERVICE_MESSAGE;break;case 4:r=f.MEDIA_KEYERR_OUTPUT_CODE,a+="MEDIA_KEYERR_OUTPUT - "+f.MEDIA_KEYERR_OUTPUT_MESSAGE;break;case 5:r=f.MEDIA_KEYERR_HARDWARECHANGE_CODE,a+="MEDIA_KEYERR_HARDWARECHANGE - "+f.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE;break;case 6:r=f.MEDIA_KEYERR_DOMAIN_CODE,a+="MEDIA_KEYERR_DOMAIN - "+f.MEDIA_KEYERR_DOMAIN_MESSAGE}a+="  System Code = "+e.systemCode,p.trigger(g.KEY_ERROR,{error:new h.Z(r,a,t)})}else n.error("No session token found for key error");break;case v.keyadded:(t=E(l,e.sessionId))||(t=E(o,e.sessionId)),t?(n.debug("DRM: Key added."),p.trigger(g.KEY_ADDED,{data:t})):n.debug("No session token found for key added");break;case v.keymessage:if((u=null!==e.sessionId&&void 0!==e.sessionId)?!(t=E(l,e.sessionId))&&o.length>0&&(t=o.shift(),l.push(t),t.sessionId=e.sessionId,p.trigger(g.KEY_SESSION_CREATED,{data:t})):o.length>0&&(t=o.shift(),l.push(t),0!==o.length&&y.error(new h.Z(f.MEDIA_KEY_MESSAGE_ERROR_CODE,f.MEDIA_KEY_MESSAGE_ERROR_MESSAGE))),t){var s=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;t.keyMessage=s,p.trigger(g.INTERNAL_KEY_MESSAGE,{data:new ce(t,s,e.defaultURL)})}else n.warn("No session token found for key message")}}},t}ve.__dashjs_factory_name="ProtectionModel_01b";var ye=dashjs.FactoryMaker.getClassFactory(ve),_e=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],be=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}];function Ee(){var e,t=this.context;function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];if("function"==typeof e[i[Object.keys(i)[0]]])return i}return null}return e={createProtectionSystem:function(i){var r=null,a=ie(t).getInstance();a.setConfig({debug:i.debug,BASE64:i.BASE64,settings:i.settings}),a.initialize();var o=function(i){var r=i.debug,a=r.getLogger(e),o=i.eventBus,s=i.errHandler,l=i.videoModel?i.videoModel.getElement():null;return l&&void 0===l.onencrypted||l&&void 0===l.mediaKeys?n(l,be)?(a.info("EME detected on this user agent! (ProtectionModel_3Feb2014)"),me(t).create({debug:r,eventBus:o,events:i.events,api:n(l,be)})):n(l,_e)?(a.info("EME detected on this user agent! (ProtectionModel_01b)"),ye(t).create({debug:r,eventBus:o,errHandler:s,events:i.events,api:n(l,_e)})):(a.warn("No supported version of EME detected on this user agent! - Attempts to play encrypted content will fail!"),null):(a.info("EME detected on this user agent! (ProtectionModel_21Jan2015)"),pe(t).create({debug:r,eventBus:o,events:i.events}))}(i);return!r&&o&&(r=T(t).create({protectionModel:o,protectionKeyController:a,eventBus:i.eventBus,debug:i.debug,events:i.events,BASE64:i.BASE64,constants:i.constants,cmcdModel:i.cmcdModel,customParametersModel:i.customParametersModel,settings:i.settings}),i.capabilities.setEncryptedMediaSupported(!0)),r}}}Ee.__dashjs_factory_name="Protection";var Te=dashjs.FactoryMaker.getClassFactory(Ee);Te.events=le,Te.errors=f,dashjs.FactoryMaker.updateClassFactory(Ee.__dashjs_factory_name,Te);var Se=Te},2068:function(e,t,n){"use strict";var i=n(5448),r={DEFAULT:.5,STRONG:1,WEAK:0};function a(e,t,n){var i,a;return i=void 0===e?-1:e,a=function(e){var t=r.DEFAULT;return e!==r.DEFAULT&&e!==r.STRONG&&e!==r.WEAK||(t=e),t}(n),{quality:i,reason:void 0===t?null:t,priority:a}}a.__dashjs_factory_name="SwitchRequest";var o=i.Z.getClassFactory(a);o.NO_CHANGE=-1,o.PRIORITY=r,i.Z.updateClassFactory(a.__dashjs_factory_name,o),t.Z=o},1767:function(e,t,n){"use strict";var i=n(5628),r=n(6535),a=n(7423),o=n(895),s=n(6070),l=n(3112),u=n(1914),c=n(5435),d=n(5448),f=n(2068),h=n(3393),p="qualitySwitchRules",g="abandonFragmentRules";function m(e){e=e||{};var t,n,d=this.context,m=e.mediaPlayerModel,v=e.customParametersModel,y=e.dashMetrics,_=e.settings;function b(e){return e.filter(function(e){return e.quality>f.Z.NO_CHANGE})}function E(e){var t,n,i,r,a,o={},s=null;if(0!==e.length){for(o[f.Z.PRIORITY.STRONG]={quality:f.Z.NO_CHANGE,reason:null},o[f.Z.PRIORITY.WEAK]={quality:f.Z.NO_CHANGE,reason:null},o[f.Z.PRIORITY.DEFAULT]={quality:f.Z.NO_CHANGE,reason:null},t=0,n=e.length;t<n;t+=1)(i=e[t]).quality!==f.Z.NO_CHANGE&&(o[i.priority].quality===f.Z.NO_CHANGE||o[i.priority].quality>i.quality)&&(o[i.priority].quality=i.quality,o[i.priority].reason=i.reason||null);return o[f.Z.PRIORITY.WEAK].quality!==f.Z.NO_CHANGE&&(s=o[f.Z.PRIORITY.WEAK]),o[f.Z.PRIORITY.DEFAULT].quality!==f.Z.NO_CHANGE&&(s=o[f.Z.PRIORITY.DEFAULT]),o[f.Z.PRIORITY.STRONG].quality!==f.Z.NO_CHANGE&&(s=o[f.Z.PRIORITY.STRONG]),s&&(r=s.quality,a=s.reason),(0,f.Z)(d).create(r,a)}}return{initialize:function(){t=[],n=[],_.get().streaming.abr.useDefaultABRRules&&(_.get().streaming.abr.ABRStrategy===h.Z.ABR_STRATEGY_L2A?t.push((0,u.Z)(d).create({dashMetrics:y,settings:_})):_.get().streaming.abr.ABRStrategy===h.Z.ABR_STRATEGY_LoLP?t.push((0,c.Z)(d).create({dashMetrics:y})):(t.push((0,l.Z)(d).create({dashMetrics:y,mediaPlayerModel:m,settings:_})),t.push((0,i.Z)(d).create({dashMetrics:y})),_.get().streaming.abr.additionalAbrRules.insufficientBufferRule&&t.push((0,r.Z)(d).create({dashMetrics:y,settings:_})),_.get().streaming.abr.additionalAbrRules.switchHistoryRule&&t.push((0,s.Z)(d).create()),_.get().streaming.abr.additionalAbrRules.droppedFramesRule&&t.push((0,o.Z)(d).create()),_.get().streaming.abr.additionalAbrRules.abandonRequestsRule&&n.push((0,a.Z)(d).create({dashMetrics:y,mediaPlayerModel:m,settings:_})))),v.getAbrCustomRules().forEach(function(e){e.type===p&&t.push(e.rule(d).create()),e.type===g&&n.push(e.rule(d).create())})},reset:function(){[t,n].forEach(function(e){e&&e.length&&e.forEach(function(e){return e.reset&&e.reset()})}),t=[],n=[]},getMaxQuality:function(e){return E(b(t.map(function(t){return t.getMaxIndex(e)})))||(0,f.Z)(d).create()},getMinSwitchRequest:E,shouldAbandonFragment:function(e,t){var i=E(b(n.map(function(n){return n.shouldAbandon(e,t)})));return i&&(i.reason.forceAbandon=!0),i||(0,f.Z)(d).create()},getQualitySwitchRules:function(){return t}}}m.__dashjs_factory_name="ABRRulesCollection";var v=d.Z.getClassFactory(m);v.QUALITY_SWITCH_RULES=p,v.ABANDON_FRAGMENT_RULES=g,d.Z.updateSingletonFactory(m.__dashjs_factory_name,v),t.Z=v},7423:function(e,t,n){"use strict";var i=n(2068),r=n(5448),a=n(6398);function o(e){e=e||{};var t,n,r,s,l,u=this.context,c=e.mediaPlayerModel,d=e.dashMetrics,f=e.settings;function h(){r={},s={},l=[]}return t={shouldAbandon:function(e){var t=(0,i.Z)(u).create(i.Z.NO_CHANGE,{name:o.__dashjs_factory_name});if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getCurrentRequest")&&e.hasOwnProperty("getRepresentationInfo")&&e.hasOwnProperty("getAbrController")))return t;var a,h,p=e.getMediaInfo(),g=e.getMediaType(),m=e.getStreamInfo(),v=m?m.id:null,y=e.getCurrentRequest();if(!isNaN(y.index)){a=g,h=y.index,r[a]=r[a]||{},r[a][h]=r[a][h]||{};var _=c.getStableBufferTime();if(d.getCurrentBufferLevel(g)>_)return t;var b=r[g][y.index];if(null===b||null===y.firstByteDate||s.hasOwnProperty(b.id))return t;if(void 0===b.firstByteTime&&(l[g]=[],b.firstByteTime=y.firstByteDate.getTime(),b.segmentDuration=y.duration,b.bytesTotal=y.bytesTotal,b.id=y.index),b.bytesLoaded=y.bytesLoaded,b.elapsedTime=(new Date).getTime()-b.firstByteTime,b.bytesLoaded>0&&b.elapsedTime>0&&function(e,t){l[e]=l[e]||[],l[e].push(t)}(g,Math.round(8*b.bytesLoaded/b.elapsedTime)),l[g].length>=f.get().streaming.abr.abrRulesParameters.abandonRequestsRule.minLengthToAverage&&b.elapsedTime>f.get().streaming.abr.abrRulesParameters.abandonRequestsRule.graceTimeThreshold&&b.bytesLoaded<b.bytesTotal){var E=l[g].reduce(function(e,t){return e+t},0);if(b.measuredBandwidthInKbps=Math.round(E/l[g].length),b.estimatedTimeOfDownload=+(8*b.bytesTotal/b.measuredBandwidthInKbps/1e3).toFixed(2),b.estimatedTimeOfDownload<b.segmentDuration*f.get().streaming.abr.abrRulesParameters.abandonRequestsRule.abandonMultiplier||0===e.getRepresentationInfo().quality)return t;if(!s.hasOwnProperty(b.id)){var T=e.getAbrController(),S=b.bytesTotal-b.bytesLoaded,w=T.getBitrateList(p),A=T.getQualityForBitrate(p,b.measuredBandwidthInKbps*f.get().streaming.abr.bandwidthSafetyFactor,v),I=T.getMinAllowedIndexFor(g,v),x=void 0!==I?Math.max(I,A):A;S>b.bytesTotal*w[x].bitrate/w[T.getQualityFor(g,v)].bitrate&&(t.quality=x,t.reason.throughput=b.measuredBandwidthInKbps,t.reason.fragmentID=b.id,t.reason.rule=this.getClassName(),s[b.id]=b,n.debug("["+g+"] frag id",b.id," is asking to abandon and switch to quality to ",x," measured bandwidth was",b.measuredBandwidthInKbps),delete r[g][b.id])}}else b.bytesLoaded===b.bytesTotal&&delete r[g][b.id]}return t},reset:h},n=(0,a.Z)(u).getInstance().getLogger(t),h(),t}o.__dashjs_factory_name="AbandonRequestsRule",t.Z=r.Z.getClassFactory(o)},3112:function(e,t,n){"use strict";var i=n(3860),r=n(2068),a=n(5448),o=n(7855),s=n(5595),l=n(8512),u=n(6398),c=n(8825),d=n(3393),f=10;function h(e){e=e||{};var t,n,a,h=this.context,p=e.dashMetrics,g=e.mediaPlayerModel,m=(0,s.Z)(h).getInstance();function v(e,t,n){var i=n.reduce(function(e,t,i){return t>n[e]?i:e},0);if(0===i)return null;var r=Math.max(e,f+2*t.length),a=(n[i]-1)/(r/f-1);return{gp:a,Vp:f/a}}function y(e){e.placeholderBuffer=0,e.mostAdvancedSegmentStart=NaN,e.lastSegmentWasReplacement=!1,e.lastSegmentStart=NaN,e.lastSegmentDurationS=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN}function _(e,t){var n=g.getStableBufferTime();if(e.stableBufferTime!==n){var i=v(n,e.bitrates,e.utilities);if(i.Vp!==e.Vp||i.gp!==e.gp){var r=p.getCurrentBufferLevel(t),a=r+e.placeholderBuffer;a-=f,a*=i.Vp/e.Vp,a+=f,e.stableBufferTime=n,e.Vp=i.Vp,e.gp=i.gp,e.placeholderBuffer=Math.max(0,a-r)}}}function b(e,t){return e.Vp*(e.utilities[t]+e.gp)}function E(e,t){for(var n=e.bitrates[t],i=e.utilities[t],r=0,a=t-1;a>=0;--a)if(e.utilities[a]<e.utilities[t]){var o=e.bitrates[a],s=e.utilities[a],l=e.Vp*(e.gp+(n*s-o*i)/(n-o));r=Math.max(r,l)}return r}function T(e){var t=e.mediaType===d.Z.AUDIO?[d.Z.AUDIO]:a;for(var n in t)a.hasOwnProperty(n)&&2===a[n].state&&(a[n].placeholderBuffer=0)}function S(){for(var e in a)if(a.hasOwnProperty(e)){var t=a[e];0!==t.state&&(t.state=1,y(t))}}function w(e){if(e&&e.chunk&&e.chunk.mediaInfo){var t=a[e.chunk.mediaInfo.type];if(t&&0!==t.state){var n=e.chunk.start;isNaN(t.mostAdvancedSegmentStart)||n>t.mostAdvancedSegmentStart?(t.mostAdvancedSegmentStart=n,t.lastSegmentWasReplacement=!1):t.lastSegmentWasReplacement=!0,t.lastSegmentStart=n,t.lastSegmentDurationS=e.chunk.duration,t.lastQuality=e.chunk.quality,I(t,e.chunk.mediaInfo.type)}}}function A(e){if(e&&e.metric===i.Z.HTTP_REQUEST&&e.value&&e.value.type===o.w.MEDIA_SEGMENT_TYPE&&e.value.trace&&e.value.trace.length){var t=a[e.mediaType];t&&0!==t.state&&(t.lastSegmentRequestTimeMs=e.value.trequest.getTime(),t.lastSegmentFinishTimeMs=e.value._tfinish.getTime(),I(t,e.mediaType))}}function I(e,t){if(!isNaN(e.lastSegmentStart)&&!isNaN(e.lastSegmentRequestTimeMs)&&!isNaN(e.placeholderBuffer)){if(e.placeholderBuffer*=.99,!isNaN(e.lastSegmentFinishTimeMs)){var n=p.getCurrentBufferLevel(t)+.001*(e.lastSegmentFinishTimeMs-e.lastSegmentRequestTimeMs),i=b(e,e.lastQuality),r=Math.max(0,i-n);e.placeholderBuffer=Math.min(r,e.placeholderBuffer)}e.lastSegmentWasReplacement&&!isNaN(e.lastSegmentDurationS)&&(e.placeholderBuffer+=e.lastSegmentDurationS),e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN}}function x(e){if(e){var t=a[e.mediaType];t&&0!==t.state&&(t.abrQuality=e.newQuality)}}function R(e){if(e){var t=a[e.mediaType];if(t&&0!==t.state){var n,i=p.getCurrentBufferLevel(e.mediaType);n=t.abrQuality>0?E(t,t.abrQuality):f;var r=Math.max(0,n-i);t.placeholderBuffer=Math.min(t.placeholderBuffer,r)}}}function C(){a={}}return t={getMaxIndex:function(e){var t=(0,r.Z)(h).create();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getScheduleController")&&e.hasOwnProperty("getStreamInfo")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("useBufferOccupancyABR")))return t;var i=e.getMediaInfo(),o=e.getMediaType(),s=e.getScheduleController(),l=e.getStreamInfo(),u=e.getAbrController(),c=u.getThroughputHistory(),d=l?l.id:null,f=l&&l.manifestInfo&&l.manifestInfo.isDynamic,m=e.useBufferOccupancyABR();if(t.reason=t.reason||{},!m)return t;s.setTimeToLoadDelay(0);var T=function(e){var t=e.getMediaType(),n=a[t];return n?0!==n.state&&_(n,t):(n=function(e){var t={},n=e.getMediaInfo().bitrateList.map(function(e){return e.bandwidth}),i=function(e){return e.map(function(e){return Math.log(e)})}(n);i=i.map(function(e){return e-i[0]+1});var r=g.getStableBufferTime(),a=v(r,n,i);return a?(t.state=1,t.bitrates=n,t.utilities=i,t.stableBufferTime=r,t.Vp=a.Vp,t.gp=a.gp,t.lastQuality=0,y(t)):t.state=0,t}(e),a[t]=n),n}(e);if(0===T.state)return t;var S,w=p.getCurrentBufferLevel(o),A=c.getAverageThroughput(o,f),I=c.getSafeAverageThroughput(o,f),x=c.getAverageLatency(o);if(t.reason.state=T.state,t.reason.throughput=A,t.reason.latency=x,isNaN(A))return t;switch(T.state){case 1:S=u.getQualityForBitrate(i,I,d,x),t.quality=S,t.reason.throughput=I,T.placeholderBuffer=Math.max(0,E(T,S)-w),T.lastQuality=S,!isNaN(T.lastSegmentDurationS)&&w>=T.lastSegmentDurationS&&(T.state=2);break;case 2:!function(e,t){var n=Date.now();if(isNaN(e.lastSegmentFinishTimeMs)){if(!isNaN(e.lastCallTimeMs)){var i=.001*(n-e.lastCallTimeMs);e.placeholderBuffer+=Math.max(0,i)}}else{var r=.001*(n-e.lastSegmentFinishTimeMs);e.placeholderBuffer+=Math.max(0,r)}e.lastCallTimeMs=n,e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN,_(e,t)}(T,o),S=function(e,t){for(var n=e.bitrates.length,i=NaN,r=NaN,a=0;a<n;++a){var o=(e.Vp*(e.utilities[a]+e.gp)-t)/e.bitrates[a];(isNaN(r)||o>=r)&&(r=o,i=a)}return i}(T,w+T.placeholderBuffer);var R=u.getQualityForBitrate(i,I,d,x);S>T.lastQuality&&S>R&&(S=Math.max(R,T.lastQuality));var C=Math.max(0,w+T.placeholderBuffer-b(T,S));C<=T.placeholderBuffer?(T.placeholderBuffer-=C,C=0):(C-=T.placeholderBuffer,T.placeholderBuffer=0,S<u.getMaxAllowedIndexFor(o,d)?s.setTimeToLoadDelay(1e3*C):C=0),t.quality=S,t.reason.throughput=A,t.reason.latency=x,t.reason.bufferLevel=w,t.reason.placeholderBuffer=T.placeholderBuffer,t.reason.delay=C,T.lastQuality=S;break;default:n.debug("BOLA ABR rule invoked in bad state."),t.quality=u.getQualityForBitrate(i,I,d,x),t.reason.state=T.state,t.reason.throughput=I,t.reason.latency=x,T.state=1,y(T)}return t},reset:function(){C(),m.off(c.Z.BUFFER_EMPTY,T,t),m.off(c.Z.PLAYBACK_SEEKING,S,t),m.off(c.Z.METRIC_ADDED,A,t),m.off(c.Z.QUALITY_CHANGE_REQUESTED,x,t),m.off(c.Z.FRAGMENT_LOADING_ABANDONED,R,t),m.off(l.Z.MEDIA_FRAGMENT_LOADED,w,t)}},n=(0,u.Z)(h).getInstance().getLogger(t),C(),m.on(c.Z.BUFFER_EMPTY,T,t),m.on(c.Z.PLAYBACK_SEEKING,S,t),m.on(c.Z.METRIC_ADDED,A,t),m.on(c.Z.QUALITY_CHANGE_REQUESTED,x,t),m.on(c.Z.FRAGMENT_LOADING_ABANDONED,R,t),m.on(l.Z.MEDIA_FRAGMENT_LOADED,w,t),t}h.__dashjs_factory_name="BolaRule",t.Z=a.Z.getClassFactory(h)},895:function(e,t,n){"use strict";var i=n(5448),r=n(2068),a=n(6398);function o(){var e,t,n=this.context;return e={getMaxIndex:function(e){var i=(0,r.Z)(n).create();if(!e||!e.hasOwnProperty("getDroppedFramesHistory"))return i;var a=e.getDroppedFramesHistory(),o=e.getStreamInfo().id;if(a){var s=a.getFrameHistory(o);if(!s||0===s.length)return i;for(var l=0,u=0,c=r.Z.NO_CHANGE,d=1;d<s.length;d++)if(s[d]&&(l=s[d].droppedVideoFrames,(u=s[d].totalVideoFrames)>375&&l/u>.15)){c=d-1,t.debug("index: "+c+" Dropped Frames: "+l+" Total Frames: "+u);break}return(0,r.Z)(n).create(c,{droppedFrames:l})}return i}},t=(0,a.Z)(n).getInstance().getLogger(e),e}o.__dashjs_factory_name="DroppedFramesRule",t.Z=i.Z.getClassFactory(o)},6535:function(e,t,n){"use strict";var i=n(5595),r=n(8512),a=n(5448),o=n(6398),s=n(2068),l=n(3393),u=n(3860),c=n(8825);function d(e){e=e||{};var t,n,a,d=this.context,f=(0,i.Z)(d).getInstance(),h=e.dashMetrics;function p(){(a={})[l.Z.VIDEO]={ignoreCount:2},a[l.Z.AUDIO]={ignoreCount:2}}function g(){p()}function m(e){isNaN(e.startTime)||e.mediaType!==l.Z.AUDIO&&e.mediaType!==l.Z.VIDEO||a[e.mediaType].ignoreCount>0&&a[e.mediaType].ignoreCount--}return t={getMaxIndex:function(e){var t=(0,s.Z)(d).create();if(!e||!e.hasOwnProperty("getMediaType"))return t;!function(){if(!h||!h.hasOwnProperty("getCurrentBufferLevel")||!h.hasOwnProperty("getCurrentBufferState"))throw new Error(l.Z.MISSING_CONFIG_ERROR)}();var i=e.getMediaType(),r=h.getCurrentBufferState(i),o=e.getRepresentationInfo().fragmentDuration,c=e.getStreamInfo(),f=c?c.id:null,p=e.getScheduleController(),g=c&&c.manifestInfo&&c.manifestInfo.isDynamic;if(function(e,t){return!e&&a[t].ignoreCount>0}(p.getPlaybackController().getLowLatencyModeEnabled(),i)||!o)return t;if(r&&r.state===u.Z.BUFFER_EMPTY)n.debug("["+i+"] Switch to index 0; buffer is empty."),t.quality=0,t.reason="InsufficientBufferRule: Buffer is empty";else{var m=e.getMediaInfo(),v=e.getAbrController(),y=v.getThroughputHistory(),_=h.getCurrentBufferLevel(i),b=y.getAverageThroughput(i,g),E=y.getAverageLatency(i),T=b*(_/o)*.5;t.quality=v.getQualityForBitrate(m,T,f,E),t.reason="InsufficientBufferRule: being conservative to avoid immediate rebuffering"}return t},reset:function(){p(),f.off(c.Z.PLAYBACK_SEEKING,g,t),f.off(r.Z.BYTES_APPENDED_END_FRAGMENT,m,t)}},n=(0,o.Z)(d).getInstance().getLogger(t),p(),f.on(c.Z.PLAYBACK_SEEKING,g,t),f.on(r.Z.BYTES_APPENDED_END_FRAGMENT,m,t),t}d.__dashjs_factory_name="InsufficientBufferRule",t.Z=a.Z.getClassFactory(d)},1914:function(e,t,n){"use strict";var i=n(3860),r=n(2068),a=n(5448),o=n(7855),s=n(5595),l=n(8512),u=n(6398),c=n(3393);function d(e){e=e||{};var t,n,a,d,f=this.context,h=e.dashMetrics,p=(0,s.Z)(f).getInstance();function g(e){e.placeholderBuffer=0,e.mostAdvancedSegmentStart=NaN,e.lastSegmentWasReplacement=!1,e.lastSegmentStart=NaN,e.lastSegmentDurationS=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN,e.lastSegmentUrl=""}function m(){for(var e in n)if(n.hasOwnProperty(e)){var t=n[e];0!==t.state&&(t.state=1,g(t))}}function v(e){if(e&&e.chunk&&e.chunk.mediaInfo){var t=n[e.chunk.mediaInfo.type],i=a[e.chunk.mediaInfo.type];if(t&&0!==t.state){var r=e.chunk.start;isNaN(t.mostAdvancedSegmentStart)||r>t.mostAdvancedSegmentStart?(t.mostAdvancedSegmentStart=r,t.lastSegmentWasReplacement=!1):t.lastSegmentWasReplacement=!0,t.lastSegmentStart=r,t.lastSegmentDurationS=e.chunk.duration,t.lastQuality=e.chunk.quality,_(t,i)}}}function y(e){if(e&&e.metric===i.Z.HTTP_REQUEST&&e.value&&e.value.type===o.w.MEDIA_SEGMENT_TYPE&&e.value.trace&&e.value.trace.length){var t=n[e.mediaType],r=a[e.mediaType];t&&0!==t.state&&(t.lastSegmentRequestTimeMs=e.value.trequest.getTime(),t.lastSegmentFinishTimeMs=e.value._tfinish.getTime(),_(t,r))}}function _(e,t){isNaN(e.lastSegmentStart)||isNaN(e.lastSegmentRequestTimeMs)||(t.segment_request_start_s=.001*e.lastSegmentRequestTimeMs,t.segment_download_finish_s=.001*e.lastSegmentFinishTimeMs,e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN)}function b(e){if(e&&e.mediaType){var t=n[e.mediaType];t&&0!==t.state&&(t.abrQuality=e.newQuality)}}function E(e,t){if(e.length!==t.length)return-1;for(var n=0,i=0;i<e.length;i++)n+=e[i]*t[i];return n}function T(){n={},a={}}return t={getMaxIndex:function(e){var t,i=(0,r.Z)(f).create(),s=Math.pow(4,.99),l=Math.max(Math.pow(4,1),s*Math.sqrt(4)),u=e.getMediaInfo(),p=e.getMediaType(),m=u.bitrateList.map(function(e){return e.bandwidth}),v=m.length,y=e.getScheduleController(),_=e.getStreamInfo(),b=e.getAbrController(),T=b.getThroughputHistory(),S=_&&_.manifestInfo&&_.manifestInfo.isDynamic,w=e.useL2AABR(),A=h.getCurrentBufferLevel(p,!0),I=T.getSafeAverageThroughput(p,S),x=T.getAverageThroughput(p,S),R=T.getAverageLatency(p),C=e.getVideoModel().getPlaybackRate();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getScheduleController")&&e.hasOwnProperty("getStreamInfo")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("useL2AABR")))return i;if(i.reason=i.reason||{},!w||p===c.Z.AUDIO)return i;y.setTimeToLoadDelay(0);var D=function(e){var t=e.getMediaType(),i=n[t];return i||(i=function(e){var t={},n=e.getMediaInfo(),i=n.bitrateList.map(function(e){return e.bandwidth/1e3});return t.state=1,t.bitrates=i,t.lastQuality=0,function(e){e&&e.type&&(a[e.type]={},a[e.type].w=[],a[e.type].prev_w=[],a[e.type].Q=0,a[e.type].segment_request_start_s=0,a[e.type].segment_download_finish_s=0,a[e.type].B_target=1.5)}(n),g(t),t}(e),n[t]=i),i}(e);if(0===D.state)return i;var k=a[p];if(!k)return i;if(i.reason.state=D.state,i.reason.throughput=x,i.reason.latency=R,isNaN(x))return i;switch(D.state){case 1:if(t=b.getQualityForBitrate(u,I,_.id,R),i.quality=t,i.reason.throughput=I,D.lastQuality=t,!isNaN(D.lastSegmentDurationS)&&A>=k.B_target){D.state=2,k.Q=s;for(var M=0;M<v;++M)M===D.lastQuality?k.prev_w[M]=1:k.prev_w[M]=0}break;case 2:var L=[],P=h.getCurrentHttpRequest(p).trace.reduce(function(e,t){return e+t.d},0),N=h.getCurrentHttpRequest(p).trace.reduce(function(e,t){return e+t.b[0]},0),O=Math.round(8*N/P),F=h.getCurrentHttpRequest(p);if(O<1&&(O=1),F.url===D.lastSegmentUrl||F.type===o.w.INIT_SEGMENT_TYPE)t=D.lastQuality;else{for(var U=D.lastSegmentDurationS,B=1,G=0;G<v;++G)m[G]=m[G]/1e3,C*m[G]>O&&(B=-1),k.w[G]=k.prev_w[G]+B*(U/(2*l))*((k.Q+s)*(C*m[G]/O));k.w=function(e){for(var t=e.length,n=!1,i=[],r=0;r<t;++r)i[r]=e[r];for(var a=e.sort(function(e,t){return t-e}),o=0,s=0,l=[],u=0;u<t-1;++u)if((s=((o+=a[u])-1)/(u+1))>=a[u+1]){n=!0;break}n||(s=(o+a[t-1]-1)/t);for(var c=0;c<t;++c)l[c]=Math.max(i[c]-s,0);return l}(k.w);for(var j=0;j<v;++j)L[j]=k.w[j]-k.prev_w[j],k.prev_w[j]=k.w[j];k.Q=Math.max(0,k.Q-U+U*C*((E(m,k.prev_w)+E(m,L))/O));for(var V=[],H=0;H<v;++H)V[H]=Math.abs(m[H]-E(k.w,m));(t=V.indexOf(Math.min.apply(Math,V)))>D.lastQuality&&m[D.lastQuality+1]<=O&&(t=D.lastQuality+1),m[t]>=O&&(k.Q=2*Math.max(s,k.Q)),D.lastSegmentUrl=F.url}i.quality=t,i.reason.throughput=x,i.reason.latency=R,i.reason.bufferLevel=A,D.lastQuality=i.quality;break;default:d.debug("L2A ABR rule invoked in bad state."),i.quality=b.getQualityForBitrate(u,I,_.id,R),i.reason.state=D.state,i.reason.throughput=I,i.reason.latency=R,D.state=1,g(D)}return i},reset:function(){T(),p.off(l.Z.PLAYBACK_SEEKING,m,t),p.off(l.Z.MEDIA_FRAGMENT_LOADED,v,t),p.off(l.Z.METRIC_ADDED,y,t),p.off(l.Z.QUALITY_CHANGE_REQUESTED,b,t)}},d=(0,u.Z)(f).getInstance().getLogger(t),T(),p.on(l.Z.PLAYBACK_SEEKING,m,t),p.on(l.Z.MEDIA_FRAGMENT_LOADED,v,t),p.on(l.Z.METRIC_ADDED,y,t),p.on(l.Z.QUALITY_CHANGE_REQUESTED,b,t),t}d.__dashjs_factory_name="L2ARule",t.Z=a.Z.getClassFactory(d)},6070:function(e,t,n){"use strict";var i=n(5448),r=n(6398),a=n(2068);function o(){var e,t,n=this.context;return e={getMaxIndex:function(e){for(var i=e?e.getSwitchHistory():null,r=i?i.getSwitchRequests():[],o=0,s=0,l=0,u=(0,a.Z)(n).create(),c=0;c<r.length;c++)if(void 0!==r[c]&&(o+=r[c].drops,s+=r[c].noDrops,l+=r[c].dropSize,o+s>=6&&o/s>.075)){u.quality=c>0&&r[c].drops>0?c-1:c,u.reason={index:u.quality,drops:o,noDrops:s,dropSize:l},t.debug("Switch history rule index: "+u.quality+" samples: "+(o+s)+" drops: "+o);break}return u}},t=(0,r.Z)(n).getInstance().getLogger(e),e}o.__dashjs_factory_name="SwitchHistoryRule",t.Z=i.Z.getClassFactory(o)},5628:function(e,t,n){"use strict";var i=n(5448),r=n(2068),a=n(3393),o=n(3860);function s(e){e=e||{};var t=this.context,n=e.dashMetrics;return{getMaxIndex:function(e){var i=(0,r.Z)(t).create();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("useBufferOccupancyABR")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("getScheduleController")))return i;!function(){if(!n||!n.hasOwnProperty("getCurrentBufferState"))throw new Error(a.Z.MISSING_CONFIG_ERROR)}();var s=e.getMediaInfo(),l=e.getMediaType(),u=n.getCurrentBufferState(l),c=e.getScheduleController(),d=e.getAbrController(),f=e.getStreamInfo(),h=f?f.id:null,p=f&&f.manifestInfo?f.manifestInfo.isDynamic:null,g=d.getThroughputHistory(),m=g.getSafeAverageThroughput(l,p),v=g.getAverageLatency(l),y=e.useBufferOccupancyABR();return isNaN(m)||!u||y||d.getAbandonmentStateFor(h,l)!==o.Z.ABANDON_LOAD&&(u.state===o.Z.BUFFER_LOADED||p)&&(i.quality=d.getQualityForBitrate(s,m,h,v),c.setTimeToLoadDelay(0),i.reason={throughput:m,latency:v}),i},reset:function(){}}}s.__dashjs_factory_name="ThroughputRule",t.Z=i.Z.getClassFactory(s)},4722:function(e,t,n){"use strict";var i=n(5448),r=n(6398);function a(){var e,t,n,i,a,o,s,l,u,c=this.context;function d(){n=null,i=1,a=100,o=0,s=null,l=null,u="dynamic_weight_selection"}function f(){var e=0;if(n)for(var t=0;t<n.length;t++){var i=n[t];i.state.throughput>e&&(e=i.state.throughput)}return e}function h(e,t,n){var i=e.map(function(e,i){return n[i]*Math.pow(e-t[i],2)}).reduce(function(e,t){return e+t});return(i<0?-1:1)*Math.sqrt(Math.abs(i))}function p(e,t){return h([e.state.throughput,e.state.latency,e.state.rebuffer,e.state.switch],[t.state.throughput,t.state.latency,t.state.rebuffer,t.state.switch],[1,1,1,1])}function g(e,t,n){for(var i=0;i<t.length;i++){var r=t[i],a=p(r,e);m(r,n,Math.exp(-1*Math.pow(a,2)/(2*Math.pow(.1,2))))}}function m(e,t,n){var i=e.state,r=[.01,.01,.01,.01];i.throughput=i.throughput+(t[0]-i.throughput)*r[0]*n,i.latency=i.latency+(t[1]-i.latency)*r[1]*n,i.rebuffer=i.rebuffer+(t[2]-i.rebuffer)*r[2]*n,i.switch=i.switch+(t[3]-i.switch)*r[3]*n}return e={getNextQuality:function(e,r,c,d,p,m,v){var y=c,_=d,b=r,E=function(e){if(!n){n=[];var t=e.bitrateList,r=[];o=t[0].bandwidth,t.forEach(function(e){r.push(e.bandwidth),e.bandwidth<o&&(o=e.bandwidth)}),u=r.map(function(e){return Math.pow(e,2)}).reduce(function(e,t){return e+t}),i=Math.sqrt(u);for(var a=0;a<t.length;a++){var s={qualityIndex:a,bitrate:t[a].bandwidth,state:{throughput:t[a].bandwidth/i,latency:0,rebuffer:0,switch:0}};n.push(s)}l=function(e){var t=[],n=function(e){for(var t=[],n=0;n<e;n++){var i=[Math.random()*f(),Math.random(),Math.random(),Math.random()];t.push(i)}return t}(Math.pow(e.length,2));t.push(n[0]);for(var i=[1,1,1,1],r=1;r<e.length;r++){for(var a=null,o=null,s=0;s<n.length;s++){for(var l=n[s],u=null,c=0;c<t.length;c++){var d=h(l,t[c],i);(null===u||d<u)&&(u=d)}(null===o||u>o)&&(a=l,o=u)}t.push(a)}for(var p=null,g=null,m=0;m<t.length;m++){for(var v=0,y=0;y<t.length;y++)m!==y&&(v+=h(t[m],t[y],i));(null===p||v>p)&&(p=v,g=m)}var _=[];for(_.push(t[g]),t.splice(g,1);t.length>0;){for(var b=null,E=null,T=0;T<t.length;T++){var S=h(_[0],t[T],i);(null===b||S<b)&&(b=S,E=T)}_.push(t[E]),t.splice(E,1)}return _}(n)}var u;return n}(e),T=r/i;T>1&&(T=f()),c/=a,t.debug("getNextQuality called throughput:".concat(T," latency:").concat(c," bufferSize:").concat(d," currentQualityIndex:").concat(m," playbackRate:").concat(p));var S=E[m],w=S.bitrate*v.getSegmentDuration()/b,A=Math.max(0,w-_);if(_-w<v.getMinBuffer())return t.debug("Buffer is low for bitrate= ".concat(S.bitrate," downloadTime=").concat(w," currentBuffer=").concat(_," rebuffer=").concat(A)),function(e,t){var i=0,r=e;if(n)for(var a=0;a<n.length;a++){var o=n[a];o.bitrate<e.bitrate&&o.bitrate>i&&t>o.bitrate&&(i=o.bitrate,r=o)}return r}(S,b).qualityIndex;switch(u){case"manual_weight_selection":s=[.4,.4,.4,.4];break;case"random_weight_selection":!function(e){s=function(e,t){for(var n=[],i=Math.sqrt(2/e),r=0;r<4;r++)n.push(Math.random()*i);return s=n}(e.length)}(E);break;default:!function(e,t,n,i,r,a,o){s||(s=l[l.length-1]);var u=e.findWeightVector(t,n,i,r,a,o);null!==u&&-1!==u&&(s=u)}(v,E,y,_,A,b,p)}for(var I=null,x=null,R=null,C=0;C<E.length;C++){var D=E[C],k=D.state,M=[k.throughput,k.latency,k.rebuffer,k.switch],L=s.slice(),P=v.getNextBufferWithBitrate(D.bitrate,_,b),N=P<v.getMinBuffer();N&&t.debug("Buffer is low for bitrate=".concat(D.bitrate," downloadTime=").concat(w," currentBuffer=").concat(_," nextBuffer=").concat(P)),(D.bitrate>r-1e4||N)&&D.bitrate!==o&&(L[0]=100);var O=h(M,[T,0,0,0],L);(null===I||O<I)&&(I=O,x=D.qualityIndex,R=D)}var F=Math.abs(S.bitrate-R.bitrate)/i;return g(S,E,[T,c,A,F]),g(R,E,[T,0,0,F]),x},reset:function(){d()}},t=(0,r.Z)(c).getInstance().getLogger(e),d(),e}a.__dashjs_factory_name="LearningAbrController",t.Z=i.Z.getClassFactory(a)},5317:function(e,t,n){"use strict";var i=n(5448),r=n(2298);function a(){var e,t,n,i,a;function o(){t=null,n=null,i=null,a=null}function s(e,t,n,i){var a=new r.Z;return a.type=e,a.weights.bitrateReward=t||1,a.weights.bitrateSwitchPenalty=1,a.weights.rebufferPenalty=n||1e3,a.weights.latencyPenalty=[],a.weights.latencyPenalty.push({threshold:1.1,penalty:.05*i}),a.weights.latencyPenalty.push({threshold:1e8,penalty:.1*n}),a.weights.playbackSpeedPenalty=i||200,a}function l(e,t,n,i,r){r.bitrateWSum+=r.weights.bitrateReward*e,r.lastBitrate&&(r.bitrateSwitchWSum+=r.weights.bitrateSwitchPenalty*Math.abs(e-r.lastBitrate)),r.lastBitrate=e,r.rebufferWSum+=r.weights.rebufferPenalty*t;for(var a=0;a<r.weights.latencyPenalty.length;a++){var o=r.weights.latencyPenalty[a];if(n<=o.threshold){r.latencyWSum+=o.penalty*n;break}}r.playbackSpeedWSum+=r.weights.playbackSpeedPenalty*Math.abs(1-i),r.totalQoe=r.bitrateWSum-r.bitrateSwitchWSum-r.rebufferWSum-r.latencyWSum-r.playbackSpeedWSum}return e={setupPerSegmentQoe:function(e,r,o){t=s("segment",e,r,o),n=e,i=r,a=o},logSegmentMetrics:function(e,n,i,r){t&&l(e,n,i,r,t)},getPerSegmentQoe:function(){return t},calculateSingleUseQoe:function(e,t,r,o){var u=null;return n&&i&&a&&(u=s("segment",n,i,a)),u?(l(e,t,r,o,u),u.totalQoe):0},reset:function(){o()}},o(),e}a.__dashjs_factory_name="LoLpQoeEvaluator",t.Z=i.Z.getClassFactory(a)},5435:function(e,t,n){"use strict";var i=n(6398),r=n(5448),a=n(4722),o=n(5317),s=n(2068),l=n(3860),u=n(6523),c=n(3393);function d(e){var t,n,r,d,f=(e=e||{}).dashMetrics,h=this.context;return n={getMaxIndex:function(e){try{var n=(0,s.Z)(h).create(),i=e.getMediaInfo().type,a=e.getAbrController(),o=e.getStreamInfo(),p=a.getQualityFor(i,o.id),g=e.getMediaInfo(),m=f.getCurrentBufferState(i),v=e.getScheduleController(),y=f.getCurrentBufferLevel(i,!0),_=o&&o.manifestInfo?o.manifestInfo.isDynamic:null,b=v.getPlaybackController(),E=b.getCurrentLiveLatency();if(!e.useLoLPABR()||i===c.Z.AUDIO)return n;E||(E=0);var T=b.getPlaybackRate(),S=a.getThroughputHistory().getSafeAverageThroughput(i,_);if(t.debug("Throughput ".concat(Math.round(S)," kbps")),isNaN(S)||!m)return n;if(a.getAbandonmentStateFor(o.id,i)===l.Z.ABANDON_LOAD)return n;for(var w=g.bitrateList,A=e.getRepresentationInfo().fragmentDuration,I=w[0].bandwidth/1e3,x=w[w.length-1].bandwidth/1e3,R=0;R<w.length;R++){var C=w[R].bandwidth/1e3;C>x?x=C:C<I&&(I=C)}var D=w[p].bandwidth/1e3,k=f.getCurrentHttpRequest(i,!0),M=(k.tresponse.getTime()-k.trequest.getTime())/1e3,L=M>A?M-A:0;d.setupPerSegmentQoe(A,x,I),d.logSegmentMetrics(D,L,E,T);var P=(0,u.Z)(h).create({targetLatency:1.5,bufferMin:.3,segmentDuration:A,qoeEvaluator:d});return n.quality=r.getNextQuality(g,1e3*S,E,y,T,p,P),n.reason={throughput:S,latency:E},n.priority=s.Z.PRIORITY.STRONG,v.setTimeToLoadDelay(0),n.quality!==p&&t.debug("[TgcLearningRule]["+i+"] requesting switch to index: ",n.quality,"Average throughput",Math.round(S),"kbps"),n}catch(e){throw e}},reset:function(){r.reset(),d.reset()}},t=(0,i.Z)(h).getInstance().getLogger(n),r=(0,a.Z)(h).create(),d=(0,o.Z)(h).create(),n}d.__dashjs_factory_name="LoLPRule",t.Z=r.Z.getClassFactory(d)},6523:function(e,t,n){"use strict";var i=n(5448);function r(e){var t,n,i,r,a=e.targetLatency,o=e.bufferMin,s=e.segmentDuration,l=e.qoeEvaluator;function u(){return s}function c(e,t){var n=u();return t>n?e-n:e+n-t}return t={getMinBuffer:function(){return o},getSegmentDuration:u,getNextBufferWithBitrate:function(e,t,n){return c(t,e*s/n)},getNextBuffer:c,findWeightVector:function(e,t,r,u,d,f){var h=null,p=null,g=null,m=Math.abs(t-i);return e.forEach(function(e){n.forEach(function(n){n[0];var i=n[1],u=n[2],v=(n[3],e.bitrate*s/d),y=c(r,v),_=(0===u?10:1/u)*Math.max(1e-5,v-y),b=(0===i?10:1/i)*e.state.latency,E=l.calculateSingleUseQoe(e.bitrate,_,b,f);(null===h||E>h)&&function(e,t,n){return!(e>a+n)&&t>=o}(t,y,m)&&(h=E,p=n,g=e.bitrate)})}),null===p&&null===g&&(p=-1),i=t,p}},n=function e(t,n,i){if(i===n)return t;for(var a=t.length,o=0;o<a;o++)for(var s=t.shift(),l=0;l<r.length;l++)t.push(s.concat(r[l]));return e(t,n,i+1)}((r=[.2,.4,.6,.8,1]).map(function(e){return[e]}),4,1),i=0,t}r.__dashjs_factory_name="LoLpWeightSelector",t.Z=i.Z.getClassFactory(r)},2298:function(e,t){"use strict";t.Z=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=null,this.lastBitrate=null,this.weights={},this.weights.bitrateReward=null,this.weights.bitrateSwitchPenalty=null,this.weights.rebufferPenalty=null,this.weights.latencyPenalty=null,this.weights.playbackSpeedPenalty=null,this.bitrateWSum=0,this.bitrateSwitchWSum=0,this.rebufferWSum=0,this.latencyWSum=0,this.playbackSpeedWSum=0,this.totalQoe=0}},7803:function(e,t,n){"use strict";n.d(t,{Y:function(){return h}});var i=n(3393),r=n(1553),a=n(5448),o=n(2128),s=n(2594),l=n(7387),u=n(7417),c=n(9032),d=n(9326),f=n(7802),h=["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"];function p(e){var t,n,a,p,g,m,v,y,_=this.context,b=e.adapter,E=e.baseURLController,T=e.streamInfo,S=e.timelineConverter,w=e.debug,A=e.eventBus,I=e.events,x=e.dashConstants,R=(0,s.Z)(_).getInstance();function C(e,t){var i=new o.Z;i.id=e.id,i.bitrate=e.bandwidth,i.width=e.width,i.height=e.height,i.tilesHor=1,i.tilesVert=1,e.essentialProperties&&e.essentialProperties.forEach(function(e){if(h.indexOf(e.schemeIdUri)>=0&&e.value){var t=e.value.split("x");2!==t.length||isNaN(t[0])||isNaN(t[1])||(i.tilesHor=parseInt(t[0],10),i.tilesVert=parseInt(t[1],10))}}),t?m.updateSegmentData(e).then(function(t){!function(e,t,n){var i=[],r=function(e,t){var n,i,r,a,o=[],s=0;for(n=0,i=e.segments.length;n<i;n++)r=e.segments[n],(a=(0,l.TJ)(S,b.getIsDynamic(),t,r.startTime,r.duration,r.timescale,r.media,r.mediaRange,s))&&(o.push(a),a=null,s++);return o}(n,t);t.segments=r,e.segmentDuration=t.segments[0].duration,e.readThumbnail=function(e,n){var r=null;i.some(function(t){if(t.start<=e&&t.end>e)return r=t.url,!0}),r?n(r):t.segments.some(function(r){if(r.mediaStartTime<=e&&r.mediaStartTime+r.duration>e){var a=E.resolve(t.path);return v.load({method:"get",url:a.url,request:{range:r.mediaRange,responseType:"arraybuffer"},onload:function(e){var t=y.getSamplesInfo(e.target.response),a=new Blob([e.target.response.slice(t.sampleList[0].offset,t.sampleList[0].offset+t.sampleList[0].size)],{type:"image/jpeg"}),o=window.URL.createObjectURL(a);i.push({start:r.mediaStartTime,end:r.mediaStartTime+r.duration,url:o}),n&&n(o)}}),!0}})}}(i,e,t)}):(i.startNumber=e.startNumber,i.segmentDuration=e.segmentDuration,i.timescale=e.timescale,i.templateUrl=function(e){var t=R.isRelative(e.media)?R.resolve(e.media,E.resolve(e.path).url):e.media;return t?(0,l.Aj)(t,e.id):""}(e)),i.tilesHor>0&&i.tilesVert>0&&(i.widthPerTile=i.width/i.tilesHor,i.heightPerTile=i.height/i.tilesVert,n.push(i))}function D(){n=[],p=-1,g=null}return t={getTracks:function(){return n},addTracks:function(){if(T&&b&&(g=b.getMediaInfoForType(T,i.Z.IMAGE))){var e=b.getVoRepresentations(g);e&&e.length>0&&e.forEach(function(e){(e.segmentInfoType===r.Z.SEGMENT_TEMPLATE&&e.segmentDuration>0&&e.media||e.segmentInfoType===r.Z.SEGMENT_TIMELINE)&&C(e),e.segmentInfoType===r.Z.SEGMENT_BASE&&C(e,!0)}),n.length>0&&n.sort(function(e,t){return e.bitrate-t.bitrate})}},reset:D,setTrackByIndex:function(e){n&&0!==n.length&&(e>=n.length&&(e=n.length-1),p=e)},getCurrentTrack:function(){return p<0?null:n[p]},getCurrentTrackIndex:function(){return p},getThumbnailRequestForTime:function(e){for(var t,i=b.getVoRepresentations(g),r=0;r<i.length;r++)if(n[p].id===i[r].id){t=i[r];break}return a.getSegmentRequestForTime(g,t,e)}},D(),v=(0,c.Z)(_).create({}),y=(0,u.Z)(_).getInstance(),m=(0,f.Z)(_).create({events:I,eventBus:A,streamInfo:T,timelineConverter:S,dashConstants:x,dashMetrics:e.dashMetrics,segmentBaseController:e.segmentBaseController,type:i.Z.IMAGE}),(a=(0,d.Z)(_).create({streamInfo:T,type:i.Z.IMAGE,timelineConverter:S,segmentsController:m,baseURLController:E,debug:w,eventBus:A,events:I,dashConstants:x,urlUtils:R})).initialize(!!b&&b.getIsDynamic()),t}p.__dashjs_factory_name="ThumbnailTracks",t.Z=a.Z.getClassFactory(p)},7417:function(e,t,n){"use strict";var i=n(6398),r=n(8260),a=n(5448),o=n(6934),s=n(9597);function l(){var e,t,n=this.context;function a(e){if(!e)return null;void 0===e.fileStart&&(e.fileStart=0);var t=o.parseBuffer(e),i=(0,r.Z)(n).create();return i.setData(t),i}function l(e,t){return e[t+3]>>>0|e[t+2]<<8>>>0|e[t+1]<<16>>>0|e[t]<<24>>>0}function u(e,t){return String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t])}return t={parse:a,findLastTopIsoBoxCompleted:function(e,t,n){if(void 0===n&&(n=0),!t||n+8>=t.byteLength)return new s.Z(0,!1);for(var i,r=t instanceof ArrayBuffer?new Uint8Array(t):t,a=0;n<r.byteLength;){var o=l(r,n),c=u(r,n+4);if(0===o)break;n+o<=r.byteLength&&(e.indexOf(c)>=0?i=new s.Z(n,!0,o):a=n+o),n+=o}return i||new s.Z(a,!1)},getMediaTimescaleFromMoov:function(e){var t=a(e),n=t?t.getBox("mdhd"):void 0;return n?n.timescale:NaN},getSamplesInfo:function(e){if(!e||0===e.byteLength)return{sampleList:[],lastSequenceNumber:NaN,totalDuration:NaN,numSequences:NaN};var t,n,i,r,o,s,l,u,c,d,f,h,p,g,m,v,y=a(e),_=y.getBoxes("moof"),b=y.getBoxes("mfhd");m=y.getBoxes("moof").length,g=b[b.length-1].sequence_number,n=0,o=[];var E=-1,T=-1;for(d=0;d<_.length;d++){var S=_[d],w=S.getChildBoxes("traf");for(u=0;u<w.length;u++){var A=w[u],I=A.getChildBox("tfhd"),x=A.getChildBox("tfdt");r=x.baseMediaDecodeTime;var R=A.getChildBoxes("trun"),C=A.getChildBoxes("subs");for(c=0;c<R.length;c++){var D=R[c];for(n=D.sample_count,p=(I.base_data_offset||0)+(D.data_offset||0),l=0;l<n;l++){t=void 0!==(s=D.samples[l]).sample_duration?s.sample_duration:I.default_sample_duration,i=void 0!==s.sample_size?s.sample_size:I.default_sample_size;var k={dts:r,cts:r+(void 0!==s.sample_composition_time_offset?s.sample_composition_time_offset:0),duration:t,offset:S.offset+p,size:i,subSizes:[i]};if(C)for(f=0;f<C.length;f++){var M=C[f];if(E<M.entry_count-1&&l>T&&(E++,T+=M.entries[E].sample_delta),l==T){k.subSizes=[];var L=M.entries[E];for(h=0;h<L.subsample_count;h++)k.subSizes.push(L.subsamples[h].subsample_size)}}o.push(k),p+=i,r+=t}}v=r-x.baseMediaDecodeTime}}return{sampleList:o,lastSequenceNumber:g,totalDuration:v,numSequences:m}},findInitRange:function(t){var n=null,i=a(t);if(!i)return n;var r=i.getBox("ftyp"),o=i.getBox("moov");return e.debug("Searching for initialization."),o&&o.isComplete&&(n=(r?r.offset:o.offset)+"-"+(o.offset+o.size-1),e.debug("Found the initialization.  Range: "+n)),n},parsePayload:function(e,t,n){if(void 0===n&&(n=0),!t||n+8>=t.byteLength)return new s.Z(0,!1);for(var i,r=t instanceof ArrayBuffer?new Uint8Array(t):t,a=0;n<r.byteLength;){var o=l(r,n),c=u(r,n+4);if(0===o)break;n+o<=r.byteLength&&(e.indexOf(c)>=0?i=new s.Z(n,!0,o,c):a=n+o),n+=o}return i||new s.Z(a,!1)}},e=(0,i.Z)(n).getInstance().getLogger(t),t}l.__dashjs_factory_name="BoxParser",t.Z=a.Z.getSingletonFactory(l)},1715:function(e,t,n){"use strict";n.d(t,{B:function(){return s}});var i=n(5448),r=n(7803),a=n(3393),o=[{codec:"avc1",compatibleCodecs:["avc3"]},{codec:"avc3",compatibleCodecs:["avc1"]}];function s(){var e="ManagedMediaSource"in window,t="WebKitMediaSource"in window,n="MediaSource"in window;return e||t||n}function l(){var e,t,n;return e={setConfig:function(e){e&&e.settings&&(t=e.settings)},supportsMediaSource:s,supportsEncryptedMedia:function(){return n},supportsCodec:function(e,n){return n!==a.Z.AUDIO&&n!==a.Z.VIDEO?Promise.resolve(!0):function(e,n){return t.get().streaming.capabilities.useMediaCapabilitiesApi&&navigator.mediaCapabilities&&navigator.mediaCapabilities.decodingInfo&&(e.codec&&n===a.Z.AUDIO||n===a.Z.VIDEO&&e.codec&&e.width&&e.height&&e.bitrate&&e.framerate)}(e,n)?function(e,t){return new Promise(function(n){if(e&&e.codec){var i={type:"media-source"};i[t]={},i[t].contentType=e.codec,i[t].width=e.width,i[t].height=e.height,i[t].bitrate=parseInt(e.bitrate),i[t].framerate=parseFloat(e.framerate),navigator.mediaCapabilities.decodingInfo(i).then(function(e){n(e.supported)}).catch(function(){n(!1)})}else n(!1)})}(e,n):function(e){return new Promise(function(t){if(e&&e.codec){var n=e.codec;e.width&&e.height&&(n+=';width="'+e.width+'";height="'+e.height+'"'),"ManagedMediaSource"in window&&ManagedMediaSource.isTypeSupported(n)||"MediaSource"in window&&MediaSource.isTypeSupported(n)||"WebKitMediaSource"in window&&WebKitMediaSource.isTypeSupported(n)?t(!0):t(!1)}else t(!1)})}(e)},setEncryptedMediaSupported:function(e){n=e},supportsEssentialProperty:function(e){try{return-1!==r.Y.indexOf(e.schemeIdUri)||a.Z.FONT_DOWNLOAD_DVB_SCHEME===e.schemeIdUri}catch(e){return!0}},codecRootCompatibleWithCodec:function(e,t){for(var n,i=e.split(".")[0],r=0===t.indexOf(i),a=0;a<o.length;a++)if(o[a].codec===i){n=o[a];break}return n?r||n.compatibleCodecs.some(function(e){return 0===t.indexOf(e)}):r}},n=!1,e}l.__dashjs_factory_name="Capabilities",t.Z=i.Z.getSingletonFactory(l)},2295:function(e,t,n){"use strict";var i=n(5448),r=n(3106);function a(){return{customTimeRangeArray:[],length:0,add:function(e,t){var n;for(n=0;n<this.customTimeRangeArray.length&&e>this.customTimeRangeArray[n].start;n++);for(this.customTimeRangeArray.splice(n,0,{start:e,end:t}),n=0;n<this.customTimeRangeArray.length-1;n++)this.mergeRanges(n,n+1)&&n--;this.length=this.customTimeRangeArray.length},clear:function(){this.customTimeRangeArray=[],this.length=0},remove:function(e,t){for(var n=0;n<this.customTimeRangeArray.length;n++)if(e<=this.customTimeRangeArray[n].start&&t>=this.customTimeRangeArray[n].end)this.customTimeRangeArray.splice(n,1),n--;else{if(e>this.customTimeRangeArray[n].start&&t<this.customTimeRangeArray[n].end){this.customTimeRangeArray.splice(n+1,0,{start:t,end:this.customTimeRangeArray[n].end}),this.customTimeRangeArray[n].end=e;break}e>this.customTimeRangeArray[n].start&&e<this.customTimeRangeArray[n].end?this.customTimeRangeArray[n].end=e:t>this.customTimeRangeArray[n].start&&t<this.customTimeRangeArray[n].end&&(this.customTimeRangeArray[n].start=t)}this.length=this.customTimeRangeArray.length},mergeRanges:function(e,t){var n=this.customTimeRangeArray[e],i=this.customTimeRangeArray[t];return n.start<=i.start&&i.start<=n.end&&n.end<=i.end?(n.end=i.end,this.customTimeRangeArray.splice(t,1),!0):i.start<=n.start&&n.start<=i.end&&i.end<=n.end?(n.start=i.start,this.customTimeRangeArray.splice(t,1),!0):i.start<=n.start&&n.start<=i.end&&n.end<=i.end?(this.customTimeRangeArray.splice(e,1),!0):n.start<=i.start&&i.start<=n.end&&i.end<=n.end&&(this.customTimeRangeArray.splice(t,1),!0)},start:function(e){return(0,r.SE)(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].start},end:function(e){return(0,r.SE)(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].end}}}a.__dashjs_factory_name="CustomTimeRanges",t.Z=i.Z.getClassFactory(a)},5:function(e,t,n){"use strict";var i=n(5448);function r(){var e,t=/^[a-z][a-z0-9+\-_.]*:/i,n=/^https?:\/\//i,i=/^https:\/\//i,r=/^([a-z][a-z0-9+\-_.]*:\/\/[^\/]+)\/?/i,a=function(e,t){try{return new window.URL(e,t).toString()}catch(t){return e}},o=function(e,t){var n=s;if(!t)return e;if(!c(e))return e;d(e)&&(n=l),f(e)&&(n=u);var i=n(t),r="/"!==i.charAt(i.length-1)&&"/"!==e.charAt(0)?"/":"";return[i,e].join(r)};function s(e){var t=e.indexOf("/"),n=e.lastIndexOf("/");return-1!==t?n===t+1?e:(-1!==e.indexOf("?")&&(e=e.substring(0,e.indexOf("?"))),e.substring(0,n+1)):""}function l(e){var t=e.match(r);return t?t[1]:""}function u(e){var n=e.match(t);return n?n[0]:""}function c(e){return!t.test(e)}function d(e){return c(e)&&"/"===e.charAt(0)}function f(e){return 0===e.indexOf("//")}return function(){try{new window.URL("x","http://y"),e=a}catch(e){}finally{e=e||o}}(),{parseBaseUrl:s,parseOrigin:l,parseScheme:u,isRelative:c,isPathAbsolute:d,isSchemeRelative:f,isHTTPURL:function(e){return n.test(e)},isHTTPS:function(e){return i.test(e)},removeHostname:function(e){return/^(?:\w+\:\/\/)?([^\/]+)(.*)$/.exec(e)[2].substring(1)},resolve:function(t,n){return e(t,n)}}}r.__dashjs_factory_name="DefaultURLUtils",t.Z=i.Z.getSingletonFactory(r)},8260:function(e,t,n){"use strict";var i=n(2839),r=n(5448);function a(){var e;function t(t){var i=[];if(!t||!e||"function"!=typeof e.fetchAll)return i;for(var r,a=e.fetchAll(t),o=0,s=a.length;o<s;o++)(r=n(a[o]))&&i.push(r);return i}function n(e){if(!e)return null;var t=new i.Z(e);return e.hasOwnProperty("_incomplete")&&(t.isComplete=!e._incomplete),t}return{getBox:function(t){return t&&e&&e.boxes&&0!==e.boxes.length&&"function"==typeof e.fetch?n(e.fetch(t)):null},getBoxes:t,setData:function(t){e=t},getLastBox:function(){if(!e||!e.boxes||!e.boxes.length)return null;var n=t(e.boxes[e.boxes.length-1].type);return n.length>0?n[n.length-1]:null}}}a.__dashjs_factory_name="IsoFile",t.Z=r.Z.getClassFactory(a)},7473:function(e,t,n){"use strict";n.d(t,{k:function(){return r}});var i=n(5448);function r(e,t){var n={url:e.url,method:e.method,headers:Object.assign({},e.headers),credentials:e.withCredentials?"include":void 0,range:e.request.range};return Promise.resolve(t.modifyRequest(n)).then(function(){return Object.assign(e,n,{withCredentials:"include"===n.credentials})})}function a(){return{modifyRequest:null,modifyRequestURL:function(e){return e},modifyRequestHeader:function(e,t){return t.url,e}}}a.__dashjs_factory_name="RequestModifier",t.Z=i.Z.getSingletonFactory(a)},3106:function(e,t,n){"use strict";n.d(t,{PS:function(){return a},SE:function(){return o}});var i=n(3393);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e,t){if(r(e)!==t)throw i.Z.BAD_ARGUMENT_ERROR}function o(e){if(null===e||isNaN(e)||e%1!=0)throw i.Z.BAD_ARGUMENT_ERROR+" : argument is not an integer"}},2594:function(e,t,n){"use strict";var i=n(5448),r=n(5);function a(){var e,t=[],n=this.context;function i(n,i,r){var a=function(n){var i;for(i=0;i<t.length;i++)if(t[i].regex.test(n))return t[i].utils;return e}(r||i);return a&&"function"==typeof a[n]?a[n](i,r):e[n](i,r)}return e=(0,r.Z)(n).getInstance(),{registerUrlRegex:function(e,n){t.push({regex:e,utils:n})},parseBaseUrl:function(e){return i("parseBaseUrl",e)},parseOrigin:function(e){return i("parseOrigin",e)},parseScheme:function(e){return i("parseScheme",e)},isRelative:function(e){return i("isRelative",e)},isPathAbsolute:function(e){return i("isPathAbsolute",e)},isSchemeRelative:function(e){return i("isSchemeRelative",e)},isHTTPURL:function(e){return i("isHTTPURL",e)},isHTTPS:function(e){return i("isHTTPS",e)},removeHostname:function(e){return i("removeHostname",e)},resolve:function(e,t){return i("resolve",e,t)}}}a.__dashjs_factory_name="URLUtils";var o=i.Z.getSingletonFactory(a);t.Z=o},5459:function(e,t){"use strict";t.Z=function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.code=t||null,this.message=n||null,this.data=i||null}},3186:function(e,t,n){"use strict";var i=n(7855);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.action=e.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaStartTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=t||null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer",this.representationId=null}var t,n;return t=e,(n=[{key:"isInitializationRequest",value:function(){return this.type&&this.type===i.w.INIT_SEGMENT_TYPE}},{key:"setInfo",value:function(e){this.type=e&&e.init?i.w.INIT_SEGMENT_TYPE:i.w.MEDIA_SEGMENT_TYPE,this.url=e&&e.url?e.url:null,this.range=e&&e.range?e.range.start+"-"+e.range.end:null,this.mediaType=e&&e.mediaType?e.mediaType:null}}])&&r(t.prototype,n),e}();a.ACTION_DOWNLOAD="download",a.ACTION_COMPLETE="complete",t.Z=a},2839:function(e,t){"use strict";function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var i=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.offset=t._offset,this.type=t.type,this.size=t.size,this.boxes=[],t.boxes)for(var n=0;n<t.boxes.length;n++)this.boxes.push(new e(t.boxes[n]));switch(this.isComplete=!0,t.type){case"sidx":if(this.timescale=t.timescale,this.earliest_presentation_time=t.earliest_presentation_time,this.first_offset=t.first_offset,this.references=t.references,t.references){this.references=[];for(var i=0;i<t.references.length;i++){var r={reference_type:t.references[i].reference_type,referenced_size:t.references[i].referenced_size,subsegment_duration:t.references[i].subsegment_duration};this.references.push(r)}}break;case"emsg":this.id=t.id,this.version=1===t.version?1:0,this.value=t.value,this.timescale=t.timescale,this.scheme_id_uri=t.scheme_id_uri,this.presentation_time_delta=1===t.version?t.presentation_time:t.presentation_time_delta,this.event_duration=t.event_duration,this.message_data=t.message_data;break;case"mdhd":this.timescale=t.timescale;break;case"mfhd":this.sequence_number=t.sequence_number;break;case"subs":this.entry_count=t.entry_count,this.entries=t.entries;break;case"tfhd":this.base_data_offset=t.base_data_offset,this.sample_description_index=t.sample_description_index,this.default_sample_duration=t.default_sample_duration,this.default_sample_size=t.default_sample_size,this.default_sample_flags=t.default_sample_flags,this.flags=t.flags;break;case"tfdt":this.version=t.version,this.baseMediaDecodeTime=t.baseMediaDecodeTime,this.flags=t.flags;break;case"trun":if(this.sample_count=t.sample_count,this.first_sample_flags=t.first_sample_flags,this.data_offset=t.data_offset,this.flags=t.flags,this.samples=t.samples,t.samples){this.samples=[];for(var a=0,o=t.samples.length;a<o;a++){var s={sample_size:t.samples[a].sample_size,sample_duration:t.samples[a].sample_duration,sample_composition_time_offset:t.samples[a].sample_composition_time_offset};this.samples.push(s)}}break;case"prft":this.version=t.version,this.reference_track_ID=t.reference_track_ID,this.ntp_timestamp_sec=t.ntp_timestamp_sec,this.ntp_timestamp_frac=t.ntp_timestamp_frac,this.media_time=t.media_time,this.flags=t.flags}}var t,i;return t=e,(i=[{key:"getChildBox",value:function(e){for(var t=0;t<this.boxes.length;t++)if(this.boxes[t].type===e)return this.boxes[t]}},{key:"getChildBoxes",value:function(e){for(var t=[],n=0;n<this.boxes.length;n++)this.boxes[n].type===e&&t.push(this.boxes[n]);return t}}])&&n(t.prototype,i),e}();t.Z=i},9597:function(e,t){"use strict";t.Z=function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.lastCompletedOffset=t,this.found=n,this.size=i}},2128:function(e,t){"use strict";t.Z=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.bitrate=0,this.width=0,this.height=0,this.tilesHor=0,this.tilesVert=0,this.widthPerTile=0,this.heightPerTile=0,this.startNumber=0,this.segmentDuration=0,this.timescale=0,this.templateUrl="",this.id=""}},7855:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,{O:function(){return a},w:function(){return r}});var r=function e(){i(this,e),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this.cmsd=null,this._stream=null,this._tfinish=null,this._mediaduration=null,this._quality=null,this._responseHeaders=null,this._serviceLocation=null,this._fileLoaderType=null},a=function e(){i(this,e),this.s=null,this.d=null,this.b=[]};r.GET="GET",r.HEAD="HEAD",r.MPD_TYPE="MPD",r.XLINK_EXPANSION_TYPE="XLinkExpansion",r.INIT_SEGMENT_TYPE="InitializationSegment",r.INDEX_SEGMENT_TYPE="IndexSegment",r.MEDIA_SEGMENT_TYPE="MediaSegment",r.BITSTREAM_SWITCHING_SEGMENT_TYPE="BitstreamSwitchingSegment",r.MSS_FRAGMENT_INFO_SEGMENT_TYPE="FragmentInfoSegment",r.DVB_REPORTING_TYPE="DVBReporting",r.LICENSE="license",r.CONTENT_STEERING_TYPE="ContentSteering",r.OTHER_TYPE="other"},3039:function(e,t){"use strict";function n(e,t){return function(n,r){for(var a,o,s,l=i(n,"tag"),u=i(null==r?"*":r,"range"),c=[],d=-1;++d<u.length;)if(a=u[d].toLowerCase(),t||"*"!==a){for(o=-1,s=[];++o<l.length;)if(e(l[o].toLowerCase(),a)){if(!t)return l[o];c.push(l[o])}else s.push(l[o]);l=s}return t?c:void 0}}function i(e,t){var n=e&&"string"==typeof e?[e]:e;if(!n||"object"!=typeof n||!("length"in n))throw new Error("Invalid "+t+" `"+n+"`, expected non-empty string");return n}t.basicFilter=n(function(e,t){return"*"===t||e===t||e.indexOf(t+"-")>-1},!0),t.extendedFilter=n(function(e,t){var n=e.split("-"),i=t.split("-"),r=0,a=0;if("*"!==i[a]&&n[r]!==i[a])return!1;for(r++,a++;a<i.length;)if("*"!==i[a]){if(!n[r])return!1;if(n[r]!==i[a]){if(1===n[r].length)return!1;r++}else r++,a++}else a++;return!0},!0),t.lookup=n(function(e,t){for(var n,i=t;;){if("*"===i||e===i)return!0;if((n=i.lastIndexOf("-"))<0)return!1;"-"===i.charAt(n-2)&&(n-=2),i=i.slice(0,n)}})},3973:function(e,t,n){"use strict";e.exports=n(3854)},3854:function(e,t,n){"use strict";var i=n(2415),r=n(3039),a=n(7778),o=n(5813),s=n(3165),l=n(9460);e.exports=function(e,t){var n,c=t||{},m=i.parse(String(e||"").toLowerCase(),c),v=i.stringify(m),y=-1;if(!v)return v;for(;++y<a.length;)r.extendedFilter(v,a[y].from).length&&(f(m,a[y].from,a[y].to),v=i.stringify(m));for(y=-1;++y<o.length;)h(m,o[y].from.field,o[y].from.value)&&p(m,o[y].to.field,o[y].to.value);for(v=i.stringify(Object.assign({},m,d)),y=-1;++y<s.length;)v===s[y]&&(f(m,s[y],s[y].split("-").slice(0,-1).join("-")),v=i.stringify(Object.assign({},m,d)));if(m.extensions.sort(g),c.warning)for(n in l)u.call(l[n],m[n])&&c.warning("Deprecated "+n+" `"+m[n]+"`, expected one of `"+l[n][m[n]].join("`, `")+"`",null,7);return m.script&&(m.script=m.script.charAt(0).toUpperCase()+m.script.slice(1)),m.region&&(m.region=m.region.toUpperCase()),i.stringify(m)};var u={}.hasOwnProperty,c=new Intl.Collator,d={variants:[],extensions:[],privateuse:[],irregular:null,regular:null};function f(e,t,n){var r,a=i.parse(t),o=i.parse(n),s=[];for(r in a)a[r]&&a[r].length&&h(e,r,a[r])&&s.push(r);for(r in o)o[r]&&o[r].length&&(s.indexOf(r)>-1||!e[r]||!e[r].length)&&p(e,r,o[r])}function h(e,t,n){var i,r,a,o,s=!1;if(n){if(r=i=e[t],i&&"object"==typeof i)for(r=[],a=-1;++a<i.length;)o=i[a],n.indexOf(o)<0?r.push(o):s=!0;else i===n&&(r=null,s=!0);e[t]=r}return s}function p(e,t,n){var i,r,a,o=e[t];if(o&&"object"==typeof o)for(i=[].concat(n),r=-1;++r<i.length;)a=i[r],o.indexOf(a)<0&&o.push(a);else e[t]=n}function g(e,t){return c.compare(e.singleton,t.singleton)}},2415:function(e,t,n){"use strict";t.parse=n(6903),t.stringify=n(6713)},6903:function(e,t,n){"use strict";var i=n(2219),r=n(3516),a=n(395),o=n(858),s=n(8589);e.exports=function e(t,n){var u,c,d,f=n||{},h={language:null,extendedLanguageSubtags:[],script:null,region:null,variants:[],extensions:[],privateuse:[],irregular:null,regular:null},p=String(t),g=p.toLowerCase(),m=0;if(null==t)throw new Error("Expected string, got `"+t+"`");if(l.call(s,g))return(null==f.normalize||f.normalize)&&s[g]?e(s[g]):(h[-1===o.indexOf(g)?"irregular":"regular"]=p,h);for(;r(g.charCodeAt(m))&&m<9;)m++;if(m>1&&m<9){if(h.language=p.slice(0,m),m<4)for(c=0;45===g.charCodeAt(m)&&r(g.charCodeAt(m+1))&&r(g.charCodeAt(m+2))&&r(g.charCodeAt(m+3))&&!r(g.charCodeAt(m+4));){if(c>2)return v(m,3,"Too many extended language subtags, expected at most 3 subtags");h.extendedLanguageSubtags.push(p.slice(m+1,m+4)),m+=4,c++}for(45===g.charCodeAt(m)&&r(g.charCodeAt(m+1))&&r(g.charCodeAt(m+2))&&r(g.charCodeAt(m+3))&&r(g.charCodeAt(m+4))&&!r(g.charCodeAt(m+5))&&(h.script=p.slice(m+1,m+5),m+=5),45===g.charCodeAt(m)&&(r(g.charCodeAt(m+1))&&r(g.charCodeAt(m+2))&&!r(g.charCodeAt(m+3))?(h.region=p.slice(m+1,m+3),m+=3):a(g.charCodeAt(m+1))&&a(g.charCodeAt(m+2))&&a(g.charCodeAt(m+3))&&!a(g.charCodeAt(m+4))&&(h.region=p.slice(m+1,m+4),m+=4));45===g.charCodeAt(m);){for(d=u=m+1;i(g.charCodeAt(d));){if(d-u>7)return v(d,1,"Too long variant, expected at most 8 characters");d++}if(!(d-u>4||d-u>3&&a(g.charCodeAt(u))))break;h.variants.push(p.slice(u,d)),m=d}for(;45===g.charCodeAt(m)&&120!==g.charCodeAt(m+1)&&i(g.charCodeAt(m+1))&&45===g.charCodeAt(m+2)&&i(g.charCodeAt(m+3));){for(d=m+2,c=0;45===g.charCodeAt(d)&&i(g.charCodeAt(d+1))&&i(g.charCodeAt(d+2));)for(d=(u=d+1)+2,c++;i(g.charCodeAt(d));){if(d-u>7)return v(d,2,"Too long extension, expected at most 8 characters");d++}if(!c)return v(d,4,"Empty extension, extensions must have at least 2 characters of content");h.extensions.push({singleton:p.charAt(m+1),extensions:p.slice(m+3,d).split("-")}),m=d}}else m=0;if(0===m&&120===g.charCodeAt(m)||45===g.charCodeAt(m)&&120===g.charCodeAt(m+1))for(d=m=m?m+2:1;45===g.charCodeAt(d)&&i(g.charCodeAt(d+1));){for(d=u=m+1;i(g.charCodeAt(d));){if(d-u>7)return v(d,5,"Too long private-use area, expected at most 8 characters");d++}h.privateuse.push(p.slice(m+1,d)),m=d}return m!==p.length?v(m,6,"Found superfluous content after tag"):h;function v(e,t,n){return f.warning&&f.warning(n,t,e),f.forgiving?h:{language:null,extendedLanguageSubtags:[],script:null,region:null,variants:[],extensions:[],privateuse:[],irregular:null,regular:null}}};var l={}.hasOwnProperty},6713:function(e){"use strict";e.exports=function(e){var t,n,i,r=e||{},a=[];if(r.irregular||r.regular)return r.irregular||r.regular;if(r.language)for(a=a.concat(r.language,r.extendedLanguageSubtags||[],r.script||[],r.region||[],r.variants||[]),t=r.extensions||[],n=-1;++n<t.length;)(i=t[n]).singleton&&i.extensions&&i.extensions.length&&(a=a.concat(i.singleton,i.extensions));return r.privateuse&&r.privateuse.length&&(a=a.concat("x",r.privateuse)),a.join("-")}},1549:function(e,t,n){"use strict";var i=n(6693),r=n(2165),a="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=l,t.SlowBuffer=function(e){return+e!=e&&(e=0),l.alloc(+e)},t.INSPECT_MAX_BYTES=50;var o=2147483647;function s(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return d(e)}return u(e,t,n)}function u(e,t,n){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var n=0|g(e,t),i=s(n),r=i.write(e,t);return r!==n&&(i=i.slice(0,r)),i}(e,t);if(ArrayBuffer.isView(e))return function(e){if(j(e,Uint8Array)){var t=new Uint8Array(e);return h(t.buffer,t.byteOffset,t.byteLength)}return f(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(j(e,ArrayBuffer)||e&&j(e.buffer,ArrayBuffer))return h(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(j(e,SharedArrayBuffer)||e&&j(e.buffer,SharedArrayBuffer)))return h(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var i=e.valueOf&&e.valueOf();if(null!=i&&i!==e)return l.from(i,t,n);var r=function(e){if(l.isBuffer(e)){var t=0|p(e.length),n=s(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||V(e.length)?s(0):f(e):"Buffer"===e.type&&Array.isArray(e.data)?f(e.data):void 0}(e);if(r)return r;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function d(e){return c(e),s(e<0?0:0|p(e))}function f(e){for(var t=e.length<0?0:0|p(e.length),n=s(t),i=0;i<t;i+=1)n[i]=255&e[i];return n}function h(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');var i;return i=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(i,l.prototype),i}function p(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function g(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||j(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return B(e).length;default:if(r)return i?-1:U(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return D(this,t,n);case"utf8":case"utf-8":return I(this,t,n);case"ascii":return R(this,t,n);case"latin1":case"binary":return C(this,t,n);case"base64":return A(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function v(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function y(e,t,n,i,r){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),V(n=+n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof t&&(t=l.from(t,i)),l.isBuffer(t))return 0===t.length?-1:_(e,t,n,i,r);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):_(e,[t],n,i,r);throw new TypeError("val must be string, number or Buffer")}function _(e,t,n,i,r){var a,o=1,s=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;o=2,s/=2,l/=2,n/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(r){var c=-1;for(a=n;a<s;a++)if(u(e,a)===u(t,-1===c?0:a-c)){if(-1===c&&(c=a),a-c+1===l)return c*o}else-1!==c&&(a-=a-c),c=-1}else for(n+l>s&&(n=s-l),a=n;a>=0;a--){for(var d=!0,f=0;f<l;f++)if(u(e,a+f)!==u(t,f)){d=!1;break}if(d)return a}return-1}function b(e,t,n,i){n=Number(n)||0;var r=e.length-n;i?(i=Number(i))>r&&(i=r):i=r;var a=t.length;i>a/2&&(i=a/2);for(var o=0;o<i;++o){var s=parseInt(t.substr(2*o,2),16);if(V(s))return o;e[n+o]=s}return o}function E(e,t,n,i){return G(U(t,e.length-n),e,n,i)}function T(e,t,n,i){return G(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,i)}function S(e,t,n,i){return G(B(t),e,n,i)}function w(e,t,n,i){return G(function(e,t){for(var n,i,r,a=[],o=0;o<e.length&&!((t-=2)<0);++o)i=(n=e.charCodeAt(o))>>8,r=n%256,a.push(r),a.push(i);return a}(t,e.length-n),e,n,i)}function A(e,t,n){return 0===t&&n===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,n))}function I(e,t,n){n=Math.min(e.length,n);for(var i=[],r=t;r<n;){var a,o,s,l,u=e[r],c=null,d=u>239?4:u>223?3:u>191?2:1;if(r+d<=n)switch(d){case 1:u<128&&(c=u);break;case 2:128==(192&(a=e[r+1]))&&(l=(31&u)<<6|63&a)>127&&(c=l);break;case 3:a=e[r+1],o=e[r+2],128==(192&a)&&128==(192&o)&&(l=(15&u)<<12|(63&a)<<6|63&o)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:a=e[r+1],o=e[r+2],s=e[r+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&(l=(15&u)<<18|(63&a)<<12|(63&o)<<6|63&s)>65535&&l<1114112&&(c=l)}null===c?(c=65533,d=1):c>65535&&(c-=65536,i.push(c>>>10&1023|55296),c=56320|1023&c),i.push(c),r+=d}return function(e){var t=e.length;if(t<=x)return String.fromCharCode.apply(String,e);for(var n="",i=0;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=x));return n}(i)}t.kMaxLength=o,l.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,n){return u(e,t,n)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,n){return function(e,t,n){return c(e),e<=0?s(e):void 0!==t?"string"==typeof n?s(e).fill(t,n):s(e).fill(t):s(e)}(e,t,n)},l.allocUnsafe=function(e){return d(e)},l.allocUnsafeSlow=function(e){return d(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(j(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),j(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,i=t.length,r=0,a=Math.min(n,i);r<a;++r)if(e[r]!==t[r]){n=e[r],i=t[r];break}return n<i?-1:i<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var i=l.allocUnsafe(t),r=0;for(n=0;n<e.length;++n){var a=e[n];if(j(a,Uint8Array))r+a.length>i.length?l.from(a).copy(i,r):Uint8Array.prototype.set.call(i,a,r);else{if(!l.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,r)}r+=a.length}return i},l.byteLength=g,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},l.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?I(this,0,e):m.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},a&&(l.prototype[a]=l.prototype.inspect),l.prototype.compare=function(e,t,n,i,r){if(j(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),t<0||n>e.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&t>=n)return 0;if(i>=r)return-1;if(t>=n)return 1;if(this===e)return 0;for(var a=(r>>>=0)-(i>>>=0),o=(n>>>=0)-(t>>>=0),s=Math.min(a,o),u=this.slice(i,r),c=e.slice(t,n),d=0;d<s;++d)if(u[d]!==c[d]){a=u[d],o=c[d];break}return a<o?-1:o<a?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return y(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return y(this,e,t,n,!1)},l.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-t;if((void 0===n||n>r)&&(n=r),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var a=!1;;)switch(i){case"hex":return b(this,e,t,n);case"utf8":case"utf-8":return E(this,e,t,n);case"ascii":case"latin1":case"binary":return T(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),a=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var x=4096;function R(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(127&e[r]);return i}function C(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(e[r]);return i}function D(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var r="",a=t;a<n;++a)r+=H[e[a]];return r}function k(e,t,n){for(var i=e.slice(t,n),r="",a=0;a<i.length-1;a+=2)r+=String.fromCharCode(i[a]+256*i[a+1]);return r}function M(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function L(e,t,n,i,r,a){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<a)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function P(e,t,n,i,r,a){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function N(e,t,n,i,a){return t=+t,n>>>=0,a||P(e,0,n,4),r.write(e,t,n,i,23,4),n+4}function O(e,t,n,i,a){return t=+t,n>>>=0,a||P(e,0,n,8),r.write(e,t,n,i,52,8),n+8}l.prototype.slice=function(e,t){var n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var i=this.subarray(e,t);return Object.setPrototypeOf(i,l.prototype),i},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||M(e,t,this.length);for(var i=this[e],r=1,a=0;++a<t&&(r*=256);)i+=this[e+a]*r;return i},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||M(e,t,this.length);for(var i=this[e+--t],r=1;t>0&&(r*=256);)i+=this[e+--t]*r;return i},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||M(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||M(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||M(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||M(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||M(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||M(e,t,this.length);for(var i=this[e],r=1,a=0;++a<t&&(r*=256);)i+=this[e+a]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*t)),i},l.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||M(e,t,this.length);for(var i=t,r=1,a=this[e+--i];i>0&&(r*=256);)a+=this[e+--i]*r;return a>=(r*=128)&&(a-=Math.pow(2,8*t)),a},l.prototype.readInt8=function(e,t){return e>>>=0,t||M(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||M(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){e>>>=0,t||M(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||M(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||M(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return e>>>=0,t||M(e,4,this.length),r.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||M(e,4,this.length),r.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||M(e,8,this.length),r.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||M(e,8,this.length),r.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,n,i){e=+e,t>>>=0,n>>>=0,i||L(this,e,t,n,Math.pow(2,8*n)-1,0);var r=1,a=0;for(this[t]=255&e;++a<n&&(r*=256);)this[t+a]=e/r&255;return t+n},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,n,i){e=+e,t>>>=0,n>>>=0,i||L(this,e,t,n,Math.pow(2,8*n)-1,0);var r=n-1,a=1;for(this[t+r]=255&e;--r>=0&&(a*=256);)this[t+r]=e/a&255;return t+n},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t>>>=0,!i){var r=Math.pow(2,8*n-1);L(this,e,t,n,r-1,-r)}var a=0,o=1,s=0;for(this[t]=255&e;++a<n&&(o*=256);)e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},l.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t>>>=0,!i){var r=Math.pow(2,8*n-1);L(this,e,t,n,r-1,-r)}var a=n-1,o=1,s=0;for(this[t+a]=255&e;--a>=0&&(o*=256);)e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeFloatLE=function(e,t,n){return N(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return N(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return O(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return O(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,i){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var r=i-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,i):Uint8Array.prototype.set.call(e,this.subarray(n,i),t),r},l.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!l.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(1===e.length){var r=e.charCodeAt(0);("utf8"===i&&r<128||"latin1"===i)&&(e=r)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var a;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(a=t;a<n;++a)this[a]=e;else{var o=l.isBuffer(e)?e:l.from(e,i),s=o.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(a=0;a<n-t;++a)this[a+t]=o[a%s]}return this};var F=/[^+/0-9A-Za-z-_]/g;function U(e,t){var n;t=t||1/0;for(var i=e.length,r=null,a=[],o=0;o<i;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(o+1===i){(t-=3)>-1&&a.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(t-=3)>-1&&a.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function B(e){return i.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(F,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function G(e,t,n,i){for(var r=0;r<i&&!(r+n>=t.length||r>=e.length);++r)t[r+n]=e[r];return r}function j(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function V(e){return e!=e}var H=function(){for(var e="0123456789abcdef",t=new Array(256),n=0;n<16;++n)for(var i=16*n,r=0;r<16;++r)t[i+r]=e[n]+e[r];return t}()},6693:function(e,t){"use strict";t.byteLength=function(e){var t=l(e),n=t[0],i=t[1];return 3*(n+i)/4-i},t.toByteArray=function(e){var t,n,a=l(e),o=a[0],s=a[1],u=new r(function(e,t,n){return 3*(t+n)/4-n}(0,o,s)),c=0,d=s>0?o-4:o;for(n=0;n<d;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],u[c++]=t>>16&255,u[c++]=t>>8&255,u[c++]=255&t;return 2===s&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,u[c++]=255&t),1===s&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,u[c++]=t>>8&255,u[c++]=255&t),u},t.fromByteArray=function(e){for(var t,i=e.length,r=i%3,a=[],o=16383,s=0,l=i-r;s<l;s+=o)a.push(u(e,s,s+o>l?l:s+o));return 1===r?(t=e[i-1],a.push(n[t>>2]+n[t<<4&63]+"==")):2===r&&(t=(e[i-2]<<8)+e[i-1],a.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),a.join("")};for(var n=[],i=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,s=a.length;o<s;++o)n[o]=a[o],i[a.charCodeAt(o)]=o;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function u(e,t,i){for(var r,a,o=[],s=t;s<i;s+=3)r=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(n[(a=r)>>18&63]+n[a>>12&63]+n[a>>6&63]+n[63&a]);return o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},2165:function(e,t){t.read=function(e,t,n,i,r){var a,o,s=8*r-i-1,l=(1<<s)-1,u=l>>1,c=-7,d=n?r-1:0,f=n?-1:1,h=e[t+d];for(d+=f,a=h&(1<<-c)-1,h>>=-c,c+=s;c>0;a=256*a+e[t+d],d+=f,c-=8);for(o=a&(1<<-c)-1,a>>=-c,c+=i;c>0;o=256*o+e[t+d],d+=f,c-=8);if(0===a)a=1-u;else{if(a===l)return o?NaN:1/0*(h?-1:1);o+=Math.pow(2,i),a-=u}return(h?-1:1)*o*Math.pow(2,a-i)},t.write=function(e,t,n,i,r,a){var o,s,l,u=8*a-r-1,c=(1<<u)-1,d=c>>1,f=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,h=i?0:a-1,p=i?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+d>=1?f/l:f*Math.pow(2,1-d))*l>=2&&(o++,l/=2),o+d>=c?(s=0,o=c):o+d>=1?(s=(t*l-1)*Math.pow(2,r),o+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,r),o=0));r>=8;e[n+h]=255&s,h+=p,s/=256,r-=8);for(o=o<<r|s,u+=r;u>0;e[n+h]=255&o,h+=p,o/=256,u-=8);e[n+h-p]|=128*g}},6934:function(e,t){var n={parseBuffer:function(e){return new i(e).parse()},addBoxProcessor:function(e,t){"string"==typeof e&&"function"==typeof t&&(r.prototype._boxProcessors[e]=t)},createFile:function(){return new i},createBox:function(e,t,n){var i=r.create(e);return t&&t.append(i,n),i},createFullBox:function(e,t,i){var r=n.createBox(e,t,i);return r.version=0,r.flags=0,r},Utils:{}};n.Utils.dataViewToString=function(e,t){var n=t||"utf-8";if("undefined"!=typeof TextDecoder)return new TextDecoder(n).decode(e);var i=[],r=0;if("utf-8"===n)for(;r<e.byteLength;){var a=e.getUint8(r++);a<128||(a<224?(a=(31&a)<<6,a|=63&e.getUint8(r++)):a<240?(a=(15&a)<<12,a|=(63&e.getUint8(r++))<<6,a|=63&e.getUint8(r++)):(a=(7&a)<<18,a|=(63&e.getUint8(r++))<<12,a|=(63&e.getUint8(r++))<<6,a|=63&e.getUint8(r++))),i.push(String.fromCharCode(a))}else for(;r<e.byteLength;)i.push(String.fromCharCode(e.getUint8(r++)));return i.join("")},n.Utils.utf8ToByteArray=function(e){var t,n;if("undefined"!=typeof TextEncoder)t=(new TextEncoder).encode(e);else for(t=[],n=0;n<e.length;++n){var i=e.charCodeAt(n);i<128?t.push(i):i<2048?(t.push(192|i>>6),t.push(128|63&i)):i<65536?(t.push(224|i>>12),t.push(128|63&i>>6),t.push(128|63&i)):(t.push(240|i>>18),t.push(128|63&i>>12),t.push(128|63&i>>6),t.push(128|63&i))}return t},n.Utils.appendBox=function(e,t,n){if(t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,-1!==n)if(null!=n){var i,r=-1;if("number"==typeof n)r=n;else{if("string"==typeof n)i=n;else{if("object"!=typeof n||!n.type)return void e.boxes.push(t);i=n.type}for(var a=0;a<e.boxes.length;a++)if(i===e.boxes[a].type){r=a+1;break}}e.boxes.splice(r,0,t)}else e.boxes.push(t)},t.parseBuffer=n.parseBuffer,t.addBoxProcessor=n.addBoxProcessor,t.createFile=n.createFile,t.createBox=n.createBox,t.createFullBox=n.createFullBox,t.Utils=n.Utils,n.Cursor=function(e){this.offset=void 0===e?0:e};var i=function(e){this._cursor=new n.Cursor,this.boxes=[],e&&(this._raw=new DataView(e))};i.prototype.fetch=function(e){var t=this.fetchAll(e,!0);return t.length?t[0]:null},i.prototype.fetchAll=function(e,t){var n=[];return i._sweep.call(this,e,n,t),n},i.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var e=r.parse(this);if(void 0===e.type)break;this.boxes.push(e)}return this},i._sweep=function(e,t,n){for(var r in this.type&&this.type==e&&t.push(this),this.boxes){if(t.length&&n)return;i._sweep.call(this.boxes[r],e,t,n)}},i.prototype.write=function(){var e,t=0;for(e=0;e<this.boxes.length;e++)t+=this.boxes[e].getLength(!1);var n=new Uint8Array(t);for(this._rawo=new DataView(n.buffer),this.bytes=n,this._cursor.offset=0,e=0;e<this.boxes.length;e++)this.boxes[e].write();return n.buffer},i.prototype.append=function(e,t){n.Utils.appendBox(this,e,t)};var r=function(){this._cursor=new n.Cursor};r.parse=function(e){var t=new r;return t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,t._parseBox(),e._cursor.offset=t._raw.byteOffset+t._raw.byteLength,t},r.create=function(e){var t=new r;return t.type=e,t.boxes=[],t},r.prototype._boxContainers=["dinf","edts","mdia","meco","mfra","minf","moof","moov","mvex","stbl","strk","traf","trak","tref","udta","vttc","sinf","schi","encv","enca"],r.prototype._boxProcessors={},r.prototype._procField=function(e,t,n){this._parsing?this[e]=this._readField(t,n):this._writeField(t,n,this[e])},r.prototype._procFieldArray=function(e,t,n,i){var r;if(this._parsing)for(this[e]=[],r=0;r<t;r++)this[e][r]=this._readField(n,i);else for(r=0;r<this[e].length;r++)this._writeField(n,i,this[e][r])},r.prototype._procFullBox=function(){this._procField("version","uint",8),this._procField("flags","uint",24)},r.prototype._procEntries=function(e,t,n){var i;if(this._parsing)for(this[e]=[],i=0;i<t;i++)this[e].push({}),n.call(this,this[e][i]);else for(i=0;i<t;i++)n.call(this,this[e][i])},r.prototype._procSubEntries=function(e,t,n,i){var r;if(this._parsing)for(e[t]=[],r=0;r<n;r++)e[t].push({}),i.call(this,e[t][r]);else for(r=0;r<n;r++)i.call(this,e[t][r])},r.prototype._procEntryField=function(e,t,n,i){this._parsing?e[t]=this._readField(n,i):this._writeField(n,i,e[t])},r.prototype._procSubBoxes=function(e,t){var n;if(this._parsing)for(this[e]=[],n=0;n<t;n++)this[e].push(r.parse(this));else for(n=0;n<t;n++)this._rawo?this[e][n].write():this.size+=this[e][n].getLength()},r.prototype._readField=function(e,t){switch(e){case"uint":return this._readUint(t);case"int":return this._readInt(t);case"template":return this._readTemplate(t);case"string":return-1===t?this._readTerminatedString():this._readString(t);case"data":return this._readData(t);case"utf8":return this._readUTF8String();default:return-1}},r.prototype._readInt=function(e){var t=null,n=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:t=this._raw.getInt8(n);break;case 16:t=this._raw.getInt16(n);break;case 32:t=this._raw.getInt32(n);break;case 64:var i=this._raw.getInt32(n),r=this._raw.getInt32(n+4);t=i*Math.pow(2,32)+r}return this._cursor.offset+=e>>3,t},r.prototype._readUint=function(e){var t,n,i=null,r=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:i=this._raw.getUint8(r);break;case 16:i=this._raw.getUint16(r);break;case 24:i=((t=this._raw.getUint16(r))<<8)+(n=this._raw.getUint8(r+2));break;case 32:i=this._raw.getUint32(r);break;case 64:t=this._raw.getUint32(r),n=this._raw.getUint32(r+4),i=t*Math.pow(2,32)+n}return this._cursor.offset+=e>>3,i},r.prototype._readString=function(e){for(var t="",n=0;n<e;n++){var i=this._readUint(8);t+=String.fromCharCode(i)}return t},r.prototype._readTemplate=function(e){return this._readUint(e/2)+this._readUint(e/2)/Math.pow(2,e/2)},r.prototype._readTerminatedString=function(){for(var e="";this._cursor.offset-this._offset<this._raw.byteLength;){var t=this._readUint(8);if(0===t)break;e+=String.fromCharCode(t)}return e},r.prototype._readData=function(e){var t=e>0?e:this._raw.byteLength-(this._cursor.offset-this._offset);if(t>0){var n=new Uint8Array(this._raw.buffer,this._cursor.offset,t);return this._cursor.offset+=t,n}return null},r.prototype._readUTF8String=function(){var e=this._raw.byteLength-(this._cursor.offset-this._offset),t=null;return e>0&&(t=new DataView(this._raw.buffer,this._cursor.offset,e),this._cursor.offset+=e),t?n.Utils.dataViewToString(t):t},r.prototype._parseBox=function(){if(this._parsing=!0,this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength)this._root._incomplete=!0;else{switch(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}this._incomplete||(this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type)?this._parseContainerBox():this._data=this._readData())}},r.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},r.prototype._parseContainerBox=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(r.parse(this))},r.prototype.append=function(e,t){n.Utils.appendBox(this,e,t)},r.prototype.getLength=function(){if(this._parsing=!1,this._rawo=null,this.size=0,this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.size+=this.boxes[e].getLength();return this._data&&this._writeData(this._data),this.size},r.prototype.write=function(){switch(this._parsing=!1,this._cursor.offset=this._parent._cursor.offset,this.size){case 0:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset);break;case 1:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.largesize);break;default:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size)}if(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.boxes[e].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size},r.prototype._writeInt=function(e,t){if(this._rawo){var n=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setInt8(n,t);break;case 16:this._rawo.setInt16(n,t);break;case 32:this._rawo.setInt32(n,t);break;case 64:var i=Math.floor(t/Math.pow(2,32)),r=t-i*Math.pow(2,32);this._rawo.setUint32(n,i),this._rawo.setUint32(n+4,r)}this._cursor.offset+=e>>3}else this.size+=e>>3},r.prototype._writeUint=function(e,t){if(this._rawo){var n,i,r=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setUint8(r,t);break;case 16:this._rawo.setUint16(r,t);break;case 24:n=(16776960&t)>>8,i=255&t,this._rawo.setUint16(r,n),this._rawo.setUint8(r+2,i);break;case 32:this._rawo.setUint32(r,t);break;case 64:i=t-(n=Math.floor(t/Math.pow(2,32)))*Math.pow(2,32),this._rawo.setUint32(r,n),this._rawo.setUint32(r+4,i)}this._cursor.offset+=e>>3}else this.size+=e>>3},r.prototype._writeString=function(e,t){for(var n=0;n<e;n++)this._writeUint(8,t.charCodeAt(n))},r.prototype._writeTerminatedString=function(e){if(0!==e.length){for(var t=0;t<e.length;t++)this._writeUint(8,e.charCodeAt(t));this._writeUint(8,0)}},r.prototype._writeTemplate=function(e,t){var n=Math.floor(t),i=(t-n)*Math.pow(2,e/2);this._writeUint(e/2,n),this._writeUint(e/2,i)},r.prototype._writeData=function(e){if(e)if(this._rawo){if(e instanceof Array){for(var t=this._cursor.offset-this._rawo.byteOffset,n=0;n<e.length;n++)this._rawo.setInt8(t+n,e[n]);this._cursor.offset+=e.length}e instanceof Uint8Array&&(this._root.bytes.set(e,this._cursor.offset),this._cursor.offset+=e.length)}else this.size+=e.length},r.prototype._writeUTF8String=function(e){var t=n.Utils.utf8ToByteArray(e);if(this._rawo)for(var i=new DataView(this._rawo.buffer,this._cursor.offset,t.length),r=0;r<t.length;r++)i.setUint8(r,t[r]);else this.size+=t.length},r.prototype._writeField=function(e,t,n){switch(e){case"uint":this._writeUint(t,n);break;case"int":this._writeInt(t,n);break;case"template":this._writeTemplate(t,n);break;case"string":-1==t?this._writeTerminatedString(n):this._writeString(t,n);break;case"data":this._writeData(n);break;case"utf8":this._writeUTF8String(n)}},r.prototype._boxProcessors.avc1=r.prototype._boxProcessors.avc2=r.prototype._boxProcessors.avc3=r.prototype._boxProcessors.avc4=r.prototype._boxProcessors.hvc1=r.prototype._boxProcessors.hev1=r.prototype._boxProcessors.encv=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procField("pre_defined1","uint",16),this._procField("reserved2","uint",16),this._procFieldArray("pre_defined2",3,"uint",32),this._procField("width","uint",16),this._procField("height","uint",16),this._procField("horizresolution","template",32),this._procField("vertresolution","template",32),this._procField("reserved3","uint",32),this._procField("frame_count","uint",16),this._procFieldArray("compressorname",32,"uint",8),this._procField("depth","uint",16),this._procField("pre_defined3","int",16),this._procField("config","data",-1)},r.prototype._boxProcessors.ctts=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"sample_count","uint",32),this._procEntryField(e,"sample_offset",1===this.version?"int":"uint",32)})},r.prototype._boxProcessors.dref=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},r.prototype._boxProcessors.elst=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"segment_duration","uint",1===this.version?64:32),this._procEntryField(e,"media_time","int",1===this.version?64:32),this._procEntryField(e,"media_rate_integer","int",16),this._procEntryField(e,"media_rate_fraction","int",16)})},r.prototype._boxProcessors.emsg=function(){this._procFullBox(),1==this.version?(this._procField("timescale","uint",32),this._procField("presentation_time","uint",64),this._procField("event_duration","uint",32),this._procField("id","uint",32),this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1)):(this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1),this._procField("timescale","uint",32),this._procField("presentation_time_delta","uint",32),this._procField("event_duration","uint",32),this._procField("id","uint",32)),this._procField("message_data","data",-1)},r.prototype._boxProcessors.free=r.prototype._boxProcessors.skip=function(){this._procField("data","data",-1)},r.prototype._boxProcessors.frma=function(){this._procField("data_format","uint",32)},r.prototype._boxProcessors.ftyp=r.prototype._boxProcessors.styp=function(){this._procField("major_brand","string",4),this._procField("minor_version","uint",32);var e=-1;this._parsing&&(e=(this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset))/4),this._procFieldArray("compatible_brands",e,"string",4)},r.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1)},r.prototype._boxProcessors.mdat=function(){this._procField("data","data",-1)},r.prototype._boxProcessors.mdhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._parsing||"string"!=typeof this.language||(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._procField("language","uint",16),this._parsing&&(this.language=String.fromCharCode(96+(this.language>>10&31),96+(this.language>>5&31),96+(31&this.language))),this._procField("pre_defined","uint",16)},r.prototype._boxProcessors.mehd=function(){this._procFullBox(),this._procField("fragment_duration","uint",1==this.version?64:32)},r.prototype._boxProcessors.mfhd=function(){this._procFullBox(),this._procField("sequence_number","uint",32)},r.prototype._boxProcessors.mfro=function(){this._procFullBox(),this._procField("mfra_size","uint",32)},r.prototype._boxProcessors.mp4a=r.prototype._boxProcessors.enca=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channelcount","uint",16),this._procField("samplesize","uint",16),this._procField("pre_defined","uint",16),this._procField("reserved3","uint",16),this._procField("samplerate","template",32),this._procField("esds","data",-1)},r.prototype._boxProcessors.mvhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procField("rate","template",32),this._procField("volume","template",16),this._procField("reserved1","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procFieldArray("matrix",9,"template",32),this._procFieldArray("pre_defined",6,"uint",32),this._procField("next_track_ID","uint",32)},r.prototype._boxProcessors.payl=function(){this._procField("cue_text","utf8")},r.prototype._boxProcessors.prft=function(){this._procFullBox(),this._procField("reference_track_ID","uint",32),this._procField("ntp_timestamp_sec","uint",32),this._procField("ntp_timestamp_frac","uint",32),this._procField("media_time","uint",1==this.version?64:32)},r.prototype._boxProcessors.pssh=function(){this._procFullBox(),this._procFieldArray("SystemID",16,"uint",8),this._procField("DataSize","uint",32),this._procFieldArray("Data",this.DataSize,"uint",8)},r.prototype._boxProcessors.schm=function(){this._procFullBox(),this._procField("scheme_type","uint",32),this._procField("scheme_version","uint",32),1&this.flags&&this._procField("scheme_uri","string",-1)},r.prototype._boxProcessors.sdtp=function(){this._procFullBox();var e=-1;this._parsing&&(e=this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset)),this._procFieldArray("sample_dependency_table",e,"uint",8)},r.prototype._boxProcessors.sidx=function(){this._procFullBox(),this._procField("reference_ID","uint",32),this._procField("timescale","uint",32),this._procField("earliest_presentation_time","uint",1==this.version?64:32),this._procField("first_offset","uint",1==this.version?64:32),this._procField("reserved","uint",16),this._procField("reference_count","uint",16),this._procEntries("references",this.reference_count,function(e){this._parsing||(e.reference=(1&e.reference_type)<<31,e.reference|=2147483647&e.referenced_size,e.sap=(1&e.starts_with_SAP)<<31,e.sap|=(3&e.SAP_type)<<28,e.sap|=268435455&e.SAP_delta_time),this._procEntryField(e,"reference","uint",32),this._procEntryField(e,"subsegment_duration","uint",32),this._procEntryField(e,"sap","uint",32),this._parsing&&(e.reference_type=e.reference>>31&1,e.referenced_size=2147483647&e.reference,e.starts_with_SAP=e.sap>>31&1,e.SAP_type=e.sap>>28&7,e.SAP_delta_time=268435455&e.sap)})},r.prototype._boxProcessors.smhd=function(){this._procFullBox(),this._procField("balance","uint",16),this._procField("reserved","uint",16)},r.prototype._boxProcessors.ssix=function(){this._procFullBox(),this._procField("subsegment_count","uint",32),this._procEntries("subsegments",this.subsegment_count,function(e){this._procEntryField(e,"ranges_count","uint",32),this._procSubEntries(e,"ranges",e.ranges_count,function(e){this._procEntryField(e,"level","uint",8),this._procEntryField(e,"range_size","uint",24)})})},r.prototype._boxProcessors.stsd=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},r.prototype._boxProcessors.sttg=function(){this._procField("settings","utf8")},r.prototype._boxProcessors.stts=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"sample_count","uint",32),this._procEntryField(e,"sample_delta","uint",32)})},r.prototype._boxProcessors.subs=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"sample_delta","uint",32),this._procEntryField(e,"subsample_count","uint",16),this._procSubEntries(e,"subsamples",e.subsample_count,function(e){this._procEntryField(e,"subsample_size","uint",1===this.version?32:16),this._procEntryField(e,"subsample_priority","uint",8),this._procEntryField(e,"discardable","uint",8),this._procEntryField(e,"codec_specific_parameters","uint",32)})})},r.prototype._boxProcessors.tenc=function(){this._procFullBox(),this._procField("default_IsEncrypted","uint",24),this._procField("default_IV_size","uint",8),this._procFieldArray("default_KID",16,"uint",8)},r.prototype._boxProcessors.tfdt=function(){this._procFullBox(),this._procField("baseMediaDecodeTime","uint",1==this.version?64:32)},r.prototype._boxProcessors.tfhd=function(){this._procFullBox(),this._procField("track_ID","uint",32),1&this.flags&&this._procField("base_data_offset","uint",64),2&this.flags&&this._procField("sample_description_offset","uint",32),8&this.flags&&this._procField("default_sample_duration","uint",32),16&this.flags&&this._procField("default_sample_size","uint",32),32&this.flags&&this._procField("default_sample_flags","uint",32)},r.prototype._boxProcessors.tfra=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._parsing||(this.reserved=0,this.reserved|=(48&this.length_size_of_traf_num)<<4,this.reserved|=(12&this.length_size_of_trun_num)<<2,this.reserved|=3&this.length_size_of_sample_num),this._procField("reserved","uint",32),this._parsing&&(this.length_size_of_traf_num=(48&this.reserved)>>4,this.length_size_of_trun_num=(12&this.reserved)>>2,this.length_size_of_sample_num=3&this.reserved),this._procField("number_of_entry","uint",32),this._procEntries("entries",this.number_of_entry,function(e){this._procEntryField(e,"time","uint",1===this.version?64:32),this._procEntryField(e,"moof_offset","uint",1===this.version?64:32),this._procEntryField(e,"traf_number","uint",8*(this.length_size_of_traf_num+1)),this._procEntryField(e,"trun_number","uint",8*(this.length_size_of_trun_num+1)),this._procEntryField(e,"sample_number","uint",8*(this.length_size_of_sample_num+1))})},r.prototype._boxProcessors.tkhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("track_ID","uint",32),this._procField("reserved1","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procFieldArray("reserved2",2,"uint",32),this._procField("layer","uint",16),this._procField("alternate_group","uint",16),this._procField("volume","template",16),this._procField("reserved3","uint",16),this._procFieldArray("matrix",9,"template",32),this._procField("width","template",32),this._procField("height","template",32)},r.prototype._boxProcessors.trex=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._procField("default_sample_description_index","uint",32),this._procField("default_sample_duration","uint",32),this._procField("default_sample_size","uint",32),this._procField("default_sample_flags","uint",32)},r.prototype._boxProcessors.trun=function(){this._procFullBox(),this._procField("sample_count","uint",32),1&this.flags&&this._procField("data_offset","int",32),4&this.flags&&this._procField("first_sample_flags","uint",32),this._procEntries("samples",this.sample_count,function(e){256&this.flags&&this._procEntryField(e,"sample_duration","uint",32),512&this.flags&&this._procEntryField(e,"sample_size","uint",32),1024&this.flags&&this._procEntryField(e,"sample_flags","uint",32),2048&this.flags&&this._procEntryField(e,"sample_composition_time_offset",1===this.version?"int":"uint",32)})},r.prototype._boxProcessors["url "]=r.prototype._boxProcessors["urn "]=function(){this._procFullBox(),"urn "===this.type&&this._procField("name","string",-1),this._procField("location","string",-1)},r.prototype._boxProcessors.vlab=function(){this._procField("source_label","utf8")},r.prototype._boxProcessors.vmhd=function(){this._procFullBox(),this._procField("graphicsmode","uint",16),this._procFieldArray("opcolor",3,"uint",16)},r.prototype._boxProcessors.vttC=function(){this._procField("config","utf8")},r.prototype._boxProcessors.vtte=function(){}},5530:function(e,t,n){"use strict";e.exports=n(6146).polyfill()},6146:function(e,n,i){e.exports=function(){"use strict";function e(e){return"function"==typeof e}var n=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=0,a=void 0,o=void 0,s=function(e,t){p[r]=e,p[r+1]=t,2===(r+=2)&&(o?o(g):b())},l="undefined"!=typeof window?window:void 0,u=l||{},c=u.MutationObserver||u.WebKitMutationObserver,d="undefined"==typeof self&&"undefined"!=typeof t&&"[object process]"==={}.toString.call(t),f="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function h(){var e=setTimeout;return function(){return e(g,1)}}var p=new Array(1e3);function g(){for(var e=0;e<r;e+=2)(0,p[e])(p[e+1]),p[e]=void 0,p[e+1]=void 0;r=0}var m,v,y,_,b=void 0;function E(e,t){var n=this,i=new this.constructor(w);void 0===i[S]&&N(i);var r=n._state;if(r){var a=arguments[r-1];s(function(){return L(r,i,a,n._result)})}else k(n,i,e,t);return i}function T(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(w);return x(t,e),t}b=d?function(){return t.nextTick(g)}:c?(v=0,y=new c(g),_=document.createTextNode(""),y.observe(_,{characterData:!0}),function(){_.data=v=++v%2}):f?((m=new MessageChannel).port1.onmessage=g,function(){return m.port2.postMessage(0)}):void 0===l?function(){try{var e=Function("return this")().require("vertx");return void 0!==(a=e.runOnLoop||e.runOnContext)?function(){a(g)}:h()}catch(e){return h()}}():h();var S=Math.random().toString(36).substring(2);function w(){}var A=void 0;function I(t,n,i){n.constructor===t.constructor&&i===E&&n.constructor.resolve===T?function(e,t){1===t._state?C(e,t._result):2===t._state?D(e,t._result):k(t,void 0,function(t){return x(e,t)},function(t){return D(e,t)})}(t,n):void 0===i?C(t,n):e(i)?function(e,t,n){s(function(e){var i=!1,r=function(e,t,n,i){try{e.call(t,n,i)}catch(e){return e}}(n,t,function(n){i||(i=!0,t!==n?x(e,n):C(e,n))},function(t){i||(i=!0,D(e,t))},e._label);!i&&r&&(i=!0,D(e,r))},e)}(t,n,i):C(t,n)}function x(e,t){if(e===t)D(e,new TypeError("You cannot resolve a promise with itself"));else if(r=typeof(i=t),null===i||"object"!==r&&"function"!==r)C(e,t);else{var n=void 0;try{n=t.then}catch(t){return void D(e,t)}I(e,t,n)}var i,r}function R(e){e._onerror&&e._onerror(e._result),M(e)}function C(e,t){e._state===A&&(e._result=t,e._state=1,0!==e._subscribers.length&&s(M,e))}function D(e,t){e._state===A&&(e._state=2,e._result=t,s(R,e))}function k(e,t,n,i){var r=e._subscribers,a=r.length;e._onerror=null,r[a]=t,r[a+1]=n,r[a+2]=i,0===a&&e._state&&s(M,e)}function M(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var i=void 0,r=void 0,a=e._result,o=0;o<t.length;o+=3)i=t[o],r=t[o+n],i?L(n,i,r,a):r(a);e._subscribers.length=0}}function L(t,n,i,r){var a=e(i),o=void 0,s=void 0,l=!0;if(a){try{o=i(r)}catch(e){l=!1,s=e}if(n===o)return void D(n,new TypeError("A promises callback cannot return that same promise."))}else o=r;n._state!==A||(a&&l?x(n,o):!1===l?D(n,s):1===t?C(n,o):2===t&&D(n,o))}var P=0;function N(e){e[S]=P++,e._state=void 0,e._result=void 0,e._subscribers=[]}var O=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(w),this.promise[S]||N(this.promise),n(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?C(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&C(this.promise,this._result))):D(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===A&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,i=n.resolve;if(i===T){var r=void 0,a=void 0,o=!1;try{r=e.then}catch(e){o=!0,a=e}if(r===E&&e._state!==A)this._settledAt(e._state,t,e._result);else if("function"!=typeof r)this._remaining--,this._result[t]=e;else if(n===F){var s=new n(w);o?D(s,a):I(s,e,r),this._willSettleAt(s,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(i(e),t)},e.prototype._settledAt=function(e,t,n){var i=this.promise;i._state===A&&(this._remaining--,2===e?D(i,n):this._result[t]=n),0===this._remaining&&C(i,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;k(e,void 0,function(e){return n._settledAt(1,t,e)},function(e){return n._settledAt(2,t,e)})},e}(),F=function(){function t(e){this[S]=P++,this._result=this._state=void 0,this._subscribers=[],w!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t(function(t){x(e,t)},function(t){D(e,t)})}catch(t){D(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var n=this,i=n.constructor;return e(t)?n.then(function(e){return i.resolve(t()).then(function(){return e})},function(e){return i.resolve(t()).then(function(){throw e})}):n.then(t,t)},t}();return F.prototype.then=E,F.all=function(e){return new O(this,e).promise},F.race=function(e){var t=this;return n(e)?new t(function(n,i){for(var r=e.length,a=0;a<r;a++)t.resolve(e[a]).then(n,i)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})},F.resolve=T,F.reject=function(e){var t=new this(w);return D(t,e),t},F._setScheduler=function(e){o=e},F._setAsap=function(e){s=e},F._asap=s,F.polyfill=function(){var e=void 0;if(void 0!==i.g)e=i.g;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=F},F.Promise=F,F}()},1159:function(e){"use strict";var t,n="object"==typeof Reflect?Reflect:null,i=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var r=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise(function(n,i){function r(n){e.removeListener(t,a),i(n)}function a(){"function"==typeof e.removeListener&&e.removeListener("error",r),n([].slice.call(arguments))}g(e,t,a,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&g(e,"error",t,{once:!0})}(e,r)})},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var o=10;function s(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function u(e,t,n,i){var r,a,o,u;if(s(n),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),o=a[t]),void 0===o)o=a[t]=n,++e._eventsCount;else if("function"==typeof o?o=a[t]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),(r=l(e))>0&&o.length>r&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=o.length,u=c,console&&console.warn&&console.warn(u)}return e}function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=c.bind(i);return r.listener=n,i.wrapFn=r,r}function f(e,t,n){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):p(r,r.length)}function h(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function p(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function g(e,t,n,i){if("function"==typeof e.on)i.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function r(a){i.once&&e.removeEventListener(t,r),n(a)})}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,a=this._events;if(void 0!==a)r=r&&void 0===a.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var l=a[e];if(void 0===l)return!1;if("function"==typeof l)i(l,this,t);else{var u=l.length,c=p(l,u);for(n=0;n<u;++n)i(c[n],this,t)}return!0},a.prototype.addListener=function(e,t){return u(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return u(this,e,t,!0)},a.prototype.once=function(e,t){return s(t),this.on(e,d(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return s(t),this.prependListener(e,d(this,e,t)),this},a.prototype.removeListener=function(e,t){var n,i,r,a,o;if(s(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){o=n[a].listener,r=a;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,o||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,a=Object.keys(n);for(i=0;i<a.length;++i)"removeListener"!==(r=a[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},a.prototype.listeners=function(e){return f(this,e,!0)},a.prototype.rawListeners=function(e){return f(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},a.prototype.listenerCount=h,a.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},3101:function(e){"use strict";var t=Array.isArray,n=Object.keys,i=Object.prototype.hasOwnProperty;e.exports=function e(r,a){if(r===a)return!0;if(r&&a&&"object"==typeof r&&"object"==typeof a){var o,s,l,u=t(r),c=t(a);if(u&&c){if((s=r.length)!=a.length)return!1;for(o=s;0!=o--;)if(!e(r[o],a[o]))return!1;return!0}if(u!=c)return!1;var d=r instanceof Date,f=a instanceof Date;if(d!=f)return!1;if(d&&f)return r.getTime()==a.getTime();var h=r instanceof RegExp,p=a instanceof RegExp;if(h!=p)return!1;if(h&&p)return r.toString()==a.toString();var g=n(r);if((s=g.length)!==n(a).length)return!1;for(o=s;0!=o--;)if(!i.call(a,g[o]))return!1;for(o=s;0!=o--;)if(!e(r[l=g[o]],a[l]))return!1;return!0}return r!=r&&a!=a}},3362:function(e,t,n){!function(e,t,n,i,r){function a(e){if("contents"in e)for(var t=("styleAttrs"in e?e.styleAttrs[i.byName.ruby.qname]:null),n="span"===e.kind&&("container"===t||"textContainer"===t||"baseContainer"===t),r=e.contents.length-1;r>=0;r--)!n||"styleAttrs"in e.contents[r]&&i.byName.ruby.qname in e.contents[r].styleAttrs?a(e.contents[r]):delete e.contents[r]}function o(e,t,n,i){var r=i&&"seq"===i.timeContainer,a=0;i&&(a=r&&n?n.end:i.begin),t.begin=t.explicit_begin?t.explicit_begin+a:a;var s=t.begin,l=null;if("sets"in t)for(var u=0;u<t.sets.length;u++)o(e,t.sets[u],l,t),s="seq"===t.timeContainer?t.sets[u].end:Math.max(s,t.sets[u].end),l=t.sets[u];if("contents"in t){if("contents"in t)for(var c=0;c<t.contents.length;c++)o(e,t.contents[c],l,t),s="seq"===t.timeContainer?t.contents[c].end:Math.max(s,t.contents[c].end),l=t.contents[c]}else s=r?t.begin:Number.POSITIVE_INFINITY;null!==t.explicit_end&&null!==t.explicit_dur?t.end=Math.min(t.begin+t.explicit_dur,a+t.explicit_end):null===t.explicit_end&&null!==t.explicit_dur?t.end=t.begin+t.explicit_dur:null!==t.explicit_end&&null===t.explicit_dur?t.end=a+t.explicit_end:t.end=s,delete t.explicit_begin,delete t.explicit_dur,delete t.explicit_end,e._registerEvent(t)}function s(e){this.node=e}function l(){this.events=[],this.head=new u,this.body=null}function u(){this.styling=new c,this.layout=new h}function c(){this.styles={},this.initials={}}function d(){this.id=null,this.styleAttrs=null,this.styleRefs=null}function f(){this.styleAttrs=null}function h(){this.regions={}}function p(e,t){g.call(this,"image"),this.src=e,this.type=t}function g(e){this.kind=e}function m(e){this.id=e}function v(e){this.regionID=e}function y(e){this.styleAttrs=e}function _(e){this.sets=e}function b(e){this.contents=e}function E(e,t,n){this.explicit_begin=e,this.explicit_end=t,this.explicit_dur=n}function T(){g.call(this,"body")}function S(){g.call(this,"div")}function w(){g.call(this,"p")}function A(){g.call(this,"span")}function I(){g.call(this,"span")}function x(){g.call(this,"br")}function R(){}function C(){}function D(e){return e&&"xml:id"in e.attributes&&e.attributes["xml:id"].value||null}function k(e){return e&&"style"in e.attributes?e.attributes.style.value.split(" "):[]}function M(e,t){var n={};if(null!==e)for(var r in e.attributes){var a=e.attributes[r].uri+" "+e.attributes[r].local,o=i.byQName[a];if(void 0!==o){var s=o.parse(e.attributes[r].value);null!==s?(n[a]=s,o===i.byName.zIndex&&U(t,"zIndex attribute present but not used by IMSC1 since regions do not overlap")):B(t,"Cannot parse styling attribute "+a+" --\x3e "+e.attributes[r].value)}}return n}function L(e,t,n){for(var i in e.attributes)if(e.attributes[i].uri===t&&e.attributes[i].local===n)return e.attributes[i].value;return null}function P(e,t,n){var i,r=null;return null!==(i=/^(\d+(?:\.\d+)?)f$/.exec(n))?null!==t&&(r=parseFloat(i[1])/t):null!==(i=/^(\d+(?:\.\d+)?)t$/.exec(n))?null!==e&&(r=parseFloat(i[1])/e):null!==(i=/^(\d+(?:\.\d+)?)ms$/.exec(n))?r=parseFloat(i[1])/1e3:null!==(i=/^(\d+(?:\.\d+)?)s$/.exec(n))?r=parseFloat(i[1]):null!==(i=/^(\d+(?:\.\d+)?)h$/.exec(n))?r=3600*parseFloat(i[1]):null!==(i=/^(\d+(?:\.\d+)?)m$/.exec(n))?r=60*parseFloat(i[1]):null!==(i=/^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/.exec(n))?r=3600*parseInt(i[1])+60*parseInt(i[2])+parseFloat(i[3]):null!==(i=/^(\d{2,}):(\d\d):(\d\d)\:(\d{2,})$/.exec(n))&&null!==t&&(r=3600*parseInt(i[1])+60*parseInt(i[2])+parseInt(i[3])+(null===i[4]?0:parseInt(i[4])/t)),r}function N(e,t,n){for(;t.styleRefs.length>0;){var i=t.styleRefs.pop();i in e.styles?(N(e,e.styles[i],n),F(e.styles[i].styleAttrs,t.styleAttrs)):B(n,"Non-existant style id referenced")}}function O(e,t,n,i){for(var r=t.length-1;r>=0;r--){var a=t[r];a in e.styles?F(e.styles[a].styleAttrs,n):B(i,"Non-existant style id referenced")}}function F(e,t){for(var n in e)e.hasOwnProperty(n)&&(n in t||(t[n]=e[n]))}function U(e,t){if(e&&e.warn&&e.warn(t))throw t}function B(e,t){if(e&&e.error&&e.error(t))throw t}function G(e,t){throw e&&e.fatal&&e.fatal(t),t}function j(e,t){for(var n,i=0,r=e.length-1;i<=r;){var a=e[n=Math.floor((i+r)/2)];if(a<t)i=n+1;else{if(!(a>t))return{found:!0,index:n};r=n-1}}return{found:!1,index:i}}e.fromXML=function(e,r,g){var m=t.parser(!0,{xmlns:!0}),v=[],y=[],_=[],b=0,E=null;m.onclosetag=function(e){if(v[0]instanceof R)null!==E.head&&null!==E.head.styling&&O(E.head.styling,v[0].styleRefs,v[0].styleAttrs,r),delete v[0].styleRefs;else if(v[0]instanceof c)for(var t in v[0].styles)v[0].styles.hasOwnProperty(t)&&N(v[0],v[0].styles[t],r);else if(v[0]instanceof w||v[0]instanceof A){if(v[0].contents.length>1){var i,a=[v[0].contents[0]];for(i=1;i<v[0].contents.length;i++)v[0].contents[i]instanceof I&&a[a.length-1]instanceof I?a[a.length-1].text+=v[0].contents[i].text:a.push(v[0].contents[i]);v[0].contents=a}v[0]instanceof A&&1===v[0].contents.length&&v[0].contents[0]instanceof I&&(v[0].text=v[0].contents[0].text,delete v[0].contents)}else v[0]instanceof s&&(v[0].node.uri===n.ns_tt&&"metadata"===v[0].node.local?b--:b>0&&g&&"onCloseTag"in g&&g.onCloseTag());_.shift(),y.shift(),v.shift()},m.ontext=function(e){if(void 0===v[0]);else if(v[0]instanceof A||v[0]instanceof w){if(v[0]instanceof A){var t=v[0].styleAttrs[i.byName.ruby.qname];if("container"===t||"textContainer"===t||"baseContainer"===t)return}var n=new I;n.initFromText(E,v[0],e,y[0],_[0],r),v[0].contents.push(n)}else v[0]instanceof s&&b>0&&g&&"onText"in g&&g.onText(e)},m.onopentag=function(e){var t=e.attributes["xml:space"];t?_.unshift(t.value):0===_.length?_.unshift("default"):_.unshift(_[0]);var a=e.attributes["xml:lang"];if(a?y.unshift(a.value):0===y.length?y.unshift(""):y.unshift(y[0]),e.uri===n.ns_tt)if("tt"===e.local)null!==E&&G(r,"Two <tt> elements at ("+this.line+","+this.column+")"),(E=new l).initFromNode(e,y[0],r),v.unshift(E);else if("head"===e.local)v[0]instanceof l||G(r,"Parent of <head> element is not <tt> at ("+this.line+","+this.column+")"),v.unshift(E.head);else if("styling"===e.local)v[0]instanceof u||G(r,"Parent of <styling> element is not <head> at ("+this.line+","+this.column+")"),v.unshift(E.head.styling);else if("style"===e.local){var o;v[0]instanceof c?((o=new d).initFromNode(e,r),o.id?E.head.styling.styles[o.id]=o:B(r,"<style> element missing @id attribute"),v.unshift(o)):v[0]instanceof R?((o=new d).initFromNode(e,r),F(o.styleAttrs,v[0].styleAttrs),v.unshift(o)):G(r,"Parent of <style> element is not <styling> or <region> at ("+this.line+","+this.column+")")}else if("initial"===e.local){var m;if(v[0]instanceof c){for(var I in(m=new f).initFromNode(e,r),m.styleAttrs)m.styleAttrs.hasOwnProperty(I)&&(E.head.styling.initials[I]=m.styleAttrs[I]);v.unshift(m)}else G(r,"Parent of <initial> element is not <styling> at ("+this.line+","+this.column+")")}else if("layout"===e.local)v[0]instanceof u||G(r,"Parent of <layout> element is not <head> at "+this.line+","+this.column+")"),v.unshift(E.head.layout);else if("region"===e.local){v[0]instanceof h||G(r,"Parent of <region> element is not <layout> at "+this.line+","+this.column+")");var D=new R;D.initFromNode(E,e,y[0],r),!D.id||D.id in E.head.layout.regions?B(r,"Ignoring <region> with duplicate or missing @id at "+this.line+","+this.column+")"):E.head.layout.regions[D.id]=D,v.unshift(D)}else if("body"===e.local){v[0]instanceof l||G(r,"Parent of <body> element is not <tt> at "+this.line+","+this.column+")"),null!==E.body&&G(r,"Second <body> element at "+this.line+","+this.column+")");var k=new T;k.initFromNode(E,e,y[0],r),E.body=k,v.unshift(k)}else if("div"===e.local){v[0]instanceof S||v[0]instanceof T||G(r,"Parent of <div> element is not <body> or <div> at "+this.line+","+this.column+")");var M=new S;M.initFromNode(E,v[0],e,y[0],r);var L=M.styleAttrs[i.byName.backgroundImage.qname];L&&(M.contents.push(new p(L)),delete M.styleAttrs[i.byName.backgroundImage.qname]),v[0].contents.push(M),v.unshift(M)}else if("image"===e.local){v[0]instanceof S||G(r,"Parent of <image> element is not <div> at "+this.line+","+this.column+")");var P=new p;P.initFromNode(E,v[0],e,y[0],r),v[0].contents.push(P),v.unshift(P)}else if("p"===e.local){v[0]instanceof S||G(r,"Parent of <p> element is not <div> at "+this.line+","+this.column+")");var N=new w;N.initFromNode(E,v[0],e,y[0],r),v[0].contents.push(N),v.unshift(N)}else if("span"===e.local){v[0]instanceof A||v[0]instanceof w||G(r,"Parent of <span> element is not <span> or <p> at "+this.line+","+this.column+")");var O=new A;O.initFromNode(E,v[0],e,y[0],_[0],r),v[0].contents.push(O),v.unshift(O)}else if("br"===e.local){v[0]instanceof A||v[0]instanceof w||G(r,"Parent of <br> element is not <span> or <p> at "+this.line+","+this.column+")");var U=new x;U.initFromNode(E,v[0],e,y[0],r),v[0].contents.push(U),v.unshift(U)}else if("set"===e.local){v[0]instanceof A||v[0]instanceof w||v[0]instanceof S||v[0]instanceof T||v[0]instanceof R||v[0]instanceof x||G(r,"Parent of <set> element is not a content element or a region at "+this.line+","+this.column+")");var j=new C;j.initFromNode(E,v[0],e,r),v[0].sets.push(j),v.unshift(j)}else v.unshift(new s(e));else v.unshift(new s(e));if(v[0]instanceof s)if(e.uri===n.ns_tt&&"metadata"===e.local)b++;else if(b>0&&g&&"onOpenTag"in g){var V=[];for(var H in e.attributes)V[e.attributes[H].uri+" "+e.attributes[H].local]={uri:e.attributes[H].uri,local:e.attributes[H].local,value:e.attributes[H].value};g.onOpenTag(e.uri,e.local,V)}},m.write(e).close(),delete E.head.styling.styles;var D=!1;for(var k in E.head.layout.regions)if(E.head.layout.regions.hasOwnProperty(k)){D=!0;break}if(!D){var M=R.prototype.createDefaultRegion(E.lang);E.head.layout.regions[M.id]=M}for(var L in E.head.layout.regions)E.head.layout.regions.hasOwnProperty(L)&&o(E,E.head.layout.regions[L],null,null);return E.body&&o(E,E.body,null,null),E.body&&a(E.body),E},l.prototype.initFromNode=function(e,t,i){var a=function(e,t){var i=L(e,n.ns_ttp,"cellResolution"),r=15,a=32;if(null!==i){var o=/(\d+) (\d+)/.exec(i);null!==o?(a=parseInt(o[1]),r=parseInt(o[2])):U(t,"Malformed cellResolution value (using initial value instead)")}return{w:a,h:r}}(e,i);this.cellLength={h:new r.ComputedLength(0,1/a.h),w:new r.ComputedLength(1/a.w,0)};var o=function(e,t){var i,r=L(e,n.ns_ttp,"frameRate"),a=30;null!==r&&(null!==(i=/(\d+)/.exec(r))?a=parseInt(i[1]):U(t,"Malformed frame rate attribute (using initial value instead)"));var o=L(e,n.ns_ttp,"frameRateMultiplier"),s=1;null!==o&&(null!==(i=/(\d+) (\d+)/.exec(o))?s=parseInt(i[1])/parseInt(i[2]):U(t,"Malformed frame rate multiplier attribute (using initial value instead)"));var l=s*a,u=1,c=L(e,n.ns_ttp,"tickRate");return null===c?null!==r&&(u=l):null!==(i=/(\d+)/.exec(c))?u=parseInt(i[1]):U(t,"Malformed tick rate attribute (using initial value instead)"),{effectiveFrameRate:l,tickRate:u}}(e,i);this.effectiveFrameRate=o.effectiveFrameRate,this.tickRate=o.tickRate,this.aspectRatio=function(e,t){var i=L(e,n.ns_ittp,"aspectRatio");null===i&&(i=L(e,n.ns_ttp,"displayAspectRatio"));var r=null;if(null!==i){var a=/(\d+)\s+(\d+)/.exec(i);if(null!==a){var o=parseInt(a[1]),s=parseInt(a[2]);0!==o&&0!==s?r=o/s:B(t,"Illegal aspectRatio values (ignoring)")}else B(t,"Malformed aspectRatio attribute (ignoring)")}return r}(e,i);var s=L(e,n.ns_ttp,"timeBase");null!==s&&"media"!==s&&G(i,"Unsupported time base");var l=function(e,t){var i=L(e,n.ns_tts,"extent");if(null===i)return null;var a=i.split(" ");if(2!==a.length)return U(t,"Malformed extent (ignoring)"),null;var o=r.parseLength(a[0]),s=r.parseLength(a[1]);return s&&o?{h:s,w:o}:(U(t,"Malformed extent values (ignoring)"),null)}(e,i);null===l?this.pxLength={h:null,w:null}:("px"===l.h.unit&&"px"===l.w.unit||G(i,"Extent on TT must be in px or absent"),this.pxLength={h:new r.ComputedLength(0,1/l.h.value),w:new r.ComputedLength(1/l.w.value,0)}),this.dimensions={h:new r.ComputedLength(0,1),w:new r.ComputedLength(1,0)},this.lang=t},l.prototype._registerEvent=function(e){if(!(e.end<=e.begin)){var t=j(this.events,e.begin);if(t.found||this.events.splice(t.index,0,e.begin),e.end!==Number.POSITIVE_INFINITY){var n=j(this.events,e.end);n.found||this.events.splice(n.index,0,e.end)}}},l.prototype.getMediaTimeRange=function(){return[this.events[0],this.events[this.events.length-1]]},l.prototype.getMediaTimeEvents=function(){return this.events},d.prototype.initFromNode=function(e,t){this.id=D(e),this.styleAttrs=M(e,t),this.styleRefs=k(e)},f.prototype.initFromNode=function(e,t){for(var i in this.styleAttrs={},e.attributes)if(e.attributes[i].uri===n.ns_itts||e.attributes[i].uri===n.ns_ebutts||e.attributes[i].uri===n.ns_tts){var r=e.attributes[i].uri+" "+e.attributes[i].local;this.styleAttrs[r]=e.attributes[i].value}},p.prototype.initFromNode=function(e,t,n,i,r){this.src="src"in n.attributes?n.attributes.src.value:null,this.src||B(r,"Invalid image@src attribute"),this.type="type"in n.attributes?n.attributes.type.value:null,this.type||B(r,"Invalid image@type attribute"),y.prototype.initFromNode.call(this,e,t,n,r),E.prototype.initFromNode.call(this,e,t,n,r),_.prototype.initFromNode.call(this,e,t,n,r),v.prototype.initFromNode.call(this,e,t,n,r),this.lang=i},m.prototype.initFromNode=function(e,t,n,i){this.id=D(n)},v.prototype.initFromNode=function(e,t,n,i){this.regionID=function(e){return e&&"region"in e.attributes?e.attributes.region.value:""}(n)},y.prototype.initFromNode=function(e,t,n,i){this.styleAttrs=M(n,i),null!==e.head&&null!==e.head.styling&&O(e.head.styling,k(n),this.styleAttrs,i)},_.prototype.initFromNode=function(e,t,n,i){this.sets=[]},b.prototype.initFromNode=function(e,t,n,i){this.contents=[]},E.prototype.initFromNode=function(e,t,n,i){var r=function(e,t,n,i){var r=null;n&&"begin"in n.attributes&&null===(r=P(e.tickRate,e.effectiveFrameRate,n.attributes.begin.value))&&U(i,"Malformed begin value "+n.attributes.begin.value+" (using 0)");var a=null;n&&"dur"in n.attributes&&null===(a=P(e.tickRate,e.effectiveFrameRate,n.attributes.dur.value))&&U(i,"Malformed dur value "+n.attributes.dur.value+" (ignoring)");var o=null;return n&&"end"in n.attributes&&null===(o=P(e.tickRate,e.effectiveFrameRate,n.attributes.end.value))&&U(i,"Malformed end value (ignoring)"),{explicit_begin:r,explicit_end:o,explicit_dur:a}}(e,0,n,i);this.explicit_begin=r.explicit_begin,this.explicit_end=r.explicit_end,this.explicit_dur=r.explicit_dur,this.timeContainer=function(e,t){var n=e&&"timeContainer"in e.attributes?e.attributes.timeContainer.value:null;return n&&"par"!==n?"seq"===n?"seq":(B(t,"Illegal value of timeContainer (assuming 'par')"),"par"):"par"}(n,i)},T.prototype.initFromNode=function(e,t,n,i){y.prototype.initFromNode.call(this,e,null,t,i),E.prototype.initFromNode.call(this,e,null,t,i),_.prototype.initFromNode.call(this,e,null,t,i),v.prototype.initFromNode.call(this,e,null,t,i),b.prototype.initFromNode.call(this,e,null,t,i),this.lang=n},S.prototype.initFromNode=function(e,t,n,i,r){y.prototype.initFromNode.call(this,e,t,n,r),E.prototype.initFromNode.call(this,e,t,n,r),_.prototype.initFromNode.call(this,e,t,n,r),v.prototype.initFromNode.call(this,e,t,n,r),b.prototype.initFromNode.call(this,e,t,n,r),this.lang=i},w.prototype.initFromNode=function(e,t,n,i,r){y.prototype.initFromNode.call(this,e,t,n,r),E.prototype.initFromNode.call(this,e,t,n,r),_.prototype.initFromNode.call(this,e,t,n,r),v.prototype.initFromNode.call(this,e,t,n,r),b.prototype.initFromNode.call(this,e,t,n,r),this.lang=i},A.prototype.initFromNode=function(e,t,n,i,r,a){y.prototype.initFromNode.call(this,e,t,n,a),E.prototype.initFromNode.call(this,e,t,n,a),_.prototype.initFromNode.call(this,e,t,n,a),v.prototype.initFromNode.call(this,e,t,n,a),b.prototype.initFromNode.call(this,e,t,n,a),this.space=r,this.lang=i},I.prototype.initFromText=function(e,t,n,i,r,a){E.prototype.initFromNode.call(this,e,t,null,a),this.text=n,this.space=r,this.lang=i},x.prototype.initFromNode=function(e,t,n,i,r){v.prototype.initFromNode.call(this,e,t,n,r),E.prototype.initFromNode.call(this,e,t,n,r),this.lang=i},R.prototype.createDefaultRegion=function(e){var t=new R;return m.call(t,""),y.call(t,{}),_.call(t,[]),E.call(t,0,Number.POSITIVE_INFINITY,null),this.lang=e,t},R.prototype.initFromNode=function(e,t,n,i){m.prototype.initFromNode.call(this,e,null,t,i),E.prototype.initFromNode.call(this,e,null,t,i),_.prototype.initFromNode.call(this,e,null,t,i),this.styleAttrs=M(t,i),this.styleRefs=k(t),this.lang=n},C.prototype.initFromNode=function(e,t,n,i){E.prototype.initFromNode.call(this,e,t,n,i);var r=M(n,i);for(var a in this.qname=null,this.value=null,r)if(r.hasOwnProperty(a)){if(this.qname){B(i,"More than one style specified on set");break}this.qname=a,this.value=r[a]}}}(t,"undefined"==typeof sax?n(5378):sax,"undefined"==typeof imscNames?n(210):imscNames,"undefined"==typeof imscStyles?n(6811):imscStyles,"undefined"==typeof imscUtils?n(5926):imscUtils)},506:function(e,t,n){var i=/firefox/i.test(navigator.userAgent);!function(e,t,n){function r(e,t,d,h){var p;if("region"===d.kind)(p=document.createElement("div")).style.position="absolute";else if("body"===d.kind)p=document.createElement("div");else if("div"===d.kind)p=document.createElement("div");else if("image"===d.kind){if(p=document.createElement("img"),null!==e.imgResolver&&null!==d.src){var v=e.imgResolver(d.src,p);v&&(p.src=v),p.height=e.regionH,p.width=e.regionW}}else if("p"===d.kind)p=document.createElement("p");else if("span"===d.kind)if("container"===d.styleAttrs[n.byName.ruby.qname])p=document.createElement("ruby"),e.ruby=!0;else if("base"===d.styleAttrs[n.byName.ruby.qname])p=document.createElement("span");else if("text"===d.styleAttrs[n.byName.ruby.qname])p=document.createElement("rt");else if("baseContainer"===d.styleAttrs[n.byName.ruby.qname])p=document.createElement("rbc");else if("textContainer"===d.styleAttrs[n.byName.ruby.qname])p=document.createElement("rtc");else{if("delimiter"===d.styleAttrs[n.byName.ruby.qname])return;p=document.createElement("span")}else"br"===d.kind&&(p=document.createElement("br"));if(p){if(d.lang&&("region"!==d.kind&&d.lang===h.lang||(p.lang=d.lang)),t.appendChild(p),p.style.margin="0","region"===d.kind){var b=d.styleAttrs[n.byName.writingMode.qname];"lrtb"===b||"lr"===b?(e.ipd="lr",e.bpd="tb"):"rltb"===b||"rl"===b?(e.ipd="rl",e.bpd="tb"):"tblr"===b?(e.ipd="tb",e.bpd="lr"):"tbrl"!==b&&"tb"!==b||(e.ipd="tb",e.bpd="rl")}else if("p"===d.kind&&"tb"===e.bpd){var E=d.styleAttrs[n.byName.direction.qname];e.ipd="ltr"===E?"lr":"rl"}for(var T=0;T<f.length;T++){var S=f[T],w=d.styleAttrs[S.qname];void 0!==w&&null!==S.map&&S.map(e,p,d,w)}var A=p,I=d.styleAttrs[n.byName.linePadding.qname];if(I&&!I.isZero()){var x=I.toUsedLength(e.w,e.h);if(x>0){var R=Math.ceil(x)+"px";"tb"===e.bpd?(A.style.paddingLeft=R,A.style.paddingRight=R):(A.style.paddingTop=R,A.style.paddingBottom=R),e.lp=I}}var C=d.styleAttrs[n.byName.multiRowAlign.qname];if(C&&"auto"!==C){var D=document.createElement("span");D.style.display="inline-block",D.style.textAlign=C,p.appendChild(D),A=D,e.mra=C}var k=d.styleAttrs[n.byName.rubyReserve.qname];if(k&&"none"!==k[0]&&(e.rubyReserve=k),d.styleAttrs[n.byName.fillLineGap.qname]&&(e.flg=!0),"span"===d.kind&&d.text){var M=d.styleAttrs[n.byName.textEmphasis.qname];if(M&&"none"!==M.style&&(e.textEmphasis=!0),n.byName.textCombine.qname in d.styleAttrs&&"all"===d.styleAttrs[n.byName.textCombine.qname])p.textContent=d.text,p._isd_element=d,M&&c(e,p,0,M);else for(var L="",P=0;P<d.text.length;P++){L+=d.text.charAt(P);var N=d.text.charCodeAt(P);if(N<55296||N>56319||P===d.text.length-1){var O=document.createElement("span");O.textContent=L,M&&c(e,O,0,M),p.appendChild(O),L="",O._isd_element=d}}}if("contents"in d)for(var F=0;F<d.contents.length;F++)r(e,A,d.contents[F],d);var U=[];if("p"===d.kind&&(u(e,A,U,null),e.rubyReserve&&(function(e,t){for(var n=0;n<e.length;n++){var i,r,a=document.createElement("ruby"),o=document.createElement("span");o.textContent="",a.appendChild(o);var s,l=t.rubyReserve[1].toUsedLength(t.w,t.h)+"px";"both"===t.rubyReserve[0]||"outside"===t.rubyReserve[0]&&1==e.length?((i=document.createElement("rtc")).style[m]=g?"after":"under",i.textContent="",i.style.fontSize=l,(r=document.createElement("rtc")).style[m]=g?"before":"over",r.textContent="",r.style.fontSize=l,a.appendChild(i),a.appendChild(r)):((i=document.createElement("rtc")).textContent="",i.style.fontSize=l,s="after"===t.rubyReserve[0]||"outside"===t.rubyReserve[0]&&n>0?g?"after":"tb"===t.bpd||"rl"===t.bpd?"under":"over":g?"before":"tb"===t.bpd||"rl"===t.bpd?"over":"under",i.style[m]=s,a.appendChild(i));for(var u=null,c=0;c<e[n].rbc.length;c++)if("ruby"===e[n].rbc[c].localName){u=e[n].rbc[c];for(var d=0;d<u.style.length;d++)a.style.setProperty(u.style.item(d),u.style.getPropertyValue(u.style.item(d)));break}(u=u||e[n].elements[0].node).parentElement.insertBefore(a,u)}}(U,e),e.rubyReserve=null),(e.ruby||e.rubyReserve)&&(function(e,t){for(var n=0;n<e.length;n++)for(var i=0;i<e[n].rbc.length;i++){var r;e[n].rbc[i].style[m]||(r=g?0===n?"before":"after":"tb"===t.bpd||"rl"===t.bpd?0===n?"over":"under":0===n?"under":"over",e[n].rbc[i].style[m]=r)}}(U,e),e.ruby=null),e.textEmphasis&&(function(e,t){for(var n=0;n<e.length;n++)for(var i=0;i<e[n].te.length;i++){var r;e[n].te[i].style[y]&&"none"!==e[n].te[i].style[y]||(r="tb"===t.bpd?0===n?"left over":"left under":"rl"===t.bpd?0===n?"right under":"left under":0===n?"left under":"right under",e[n].te[i].style[y]=r)}}(U,e),e.textEmphasis=null),e.mra&&(function(e){for(var t=0;t<e.length-1;t++){var n=e[t].elements.length;if(0!==n&&!1===e[t].br){var i=document.createElement("br"),r=e[t].elements[n-1].node;r.parentElement.insertBefore(i,r.nextSibling)}}}(U),e.mra=null),e.lp&&(function(e,t,n){if(null!==e)for(var r=0;r<e.length;r++){var a=e[r].elements.length,o=Math.ceil(t)+"px",s="-"+Math.ceil(t)+"px";if(0!==a){var l=e[r].elements[e[r].start_elem],u=e[r].elements[e[r].end_elem];if(l===u){var c=l.node.getBoundingClientRect();if(0==c.width||0==c.height)continue}"lr"===n.ipd?(l.node.style.marginLeft=s,l.node.style.paddingLeft=o):"rl"===n.ipd?(l.node.style.paddingRight=o,l.node.style.marginRight=s):"tb"===n.ipd&&(l.node.style.paddingTop=o,l.node.style.marginTop=s),"lr"===n.ipd?(i||(u.node.style.marginRight=s),u.node.style.paddingRight=o):"rl"===n.ipd?(u.node.style.paddingLeft=o,i||(u.node.style.marginLeft=s)):"tb"===n.ipd&&(u.node.style.paddingBottom=o,u.node.style.marginBottom=s)}}}(U,e.lp.toUsedLength(e.w,e.h),e),e.lp=null),function(e,t){for(var n=0;n<e.length;n++)for(var i=e[n],r=1;r<i.elements.length;){var s=i.elements[r-1],l=i.elements[r];o(s.node,l.node,t)?i.elements.splice(r,1):r++}for(var u,c,d=[],f=0;f<e.length;f++)for(var h=0;h<e[f].elements.length;h++)(c=a(u=e[f].elements[h].node,d,!1))&&(u.style.backgroundColor=c);for(var p=0;p<d.length;p++)d[p].style.backgroundColor=""}(U,e),e.flg)){var B=l(A.getBoundingClientRect(),e);!function(e,t,n,i,r){for(var a=Math.sign(n-t),o=0;o<=e.length;o++){var s,l,u,c;if(s=0===o?Math.round(t):o===e.length?Math.round(n):Math.round((e[o-1].after+e[o].before)/2),o>0&&e[o-1])for(u=0;u<e[o-1].elements.length;u++)l=a*(s-(c=e[o-1].elements[u]).after)+"px","lr"===i.bpd?c.node.style.paddingRight=l:"rl"===i.bpd?c.node.style.paddingLeft=l:"tb"===i.bpd&&(c.node.style.paddingBottom=l);if(o<e.length)for(u=0;u<e[o].elements.length;u++)l=a*((c=e[o].elements[u]).before-s)+"px","lr"===i.bpd?c.node.style.paddingLeft=l:"rl"===i.bpd?c.node.style.paddingRight=l:"tb"===i.bpd&&(c.node.style.paddingTop=l)}}(U,B.before,B.after,e),e.flg=null}if("region"===d.kind&&"tb"===e.bpd&&e.enableRollUp&&d.contents.length>0&&"after"===d.styleAttrs[n.byName.displayAlign.qname]){u(e,A,U,null);var G=new s(""===d.id?"_":d.id,U);if(e.currentISDState[G.id]=G,e.previousISDState&&G.id in e.previousISDState&&e.previousISDState[G.id].plist.length>0&&G.plist.length>1&&G.plist[G.plist.length-2].text===e.previousISDState[G.id].plist[e.previousISDState[G.id].plist.length-1].text){var j=p.firstElementChild,V=G.plist[G.plist.length-1].after-G.plist[G.plist.length-1].before;j.style.bottom="-"+V+"px",j.style.transition="transform 0.4s",j.style.position="relative",j.style.transform="translateY(-"+V+"px)"}}}else _(e.errorHandler,"Error processing ISD element kind: "+d.kind)}function a(e,t,n){return e.style.backgroundColor?(n&&!t.includes(e)&&t.push(e),e.style.backgroundColor):"SPAN"===e.parentElement.nodeName||"RUBY"===e.parentElement.nodeName||"RBC"===e.parentElement.nodeName||"RTC"===e.parentElement.nodeName||"RT"===e.parentElement.nodeName?a(e.parentElement,t,!0):void 0}function o(e,t,n){if("SPAN"===e.tagName&&"SPAN"===t.tagName&&e._isd_element===t._isd_element){if(!e._isd_element)return _(n.errorHandler,"Internal error: HTML span is not linked to a source element; cannot merge spans."),!1;e.textContent+=t.textContent;for(var i=0;i<t.style.length;i++){var r=t.style[i];(r.indexOf("border")>=0||r.indexOf("padding")>=0||r.indexOf("margin")>=0)&&(e.style[r]=t.style[r])}return t.parentElement.removeChild(t),!0}return!1}function s(e,t){this.id=e,this.plist=t}function l(e,t){var n={before:null,after:null,start:null,end:null};return"tb"===t.bpd?(n.before=e.top,n.after=e.bottom,"lr"===t.ipd?(n.start=e.left,n.end=e.right):(n.start=e.right,n.end=e.left)):"lr"===t.bpd?(n.before=e.left,n.after=e.right,n.start=e.top,n.end=e.bottom):"rl"===t.bpd&&(n.before=e.right,n.after=e.left,n.start=e.top,n.end=e.bottom),n}function u(e,t,n,i){if("rt"!==t.localName&&"rtc"!==t.localName){var r,a,o,s,c=t.style.backgroundColor||i;if(0===t.childElementCount)if("span"===t.localName||"rb"===t.localName){var d=l(t.getBoundingClientRect(),e);if(0!==n.length&&(r=d.before,a=d.after,o=n[n.length-1].before,a<(s=n[n.length-1].after)&&r>o||s<=a&&o>=r)){var f=Math.sign(d.after-d.before),h=Math.sign(d.end-d.start);f*(d.before-n[n.length-1].before)<0&&(n[n.length-1].before=d.before),f*(d.after-n[n.length-1].after)>0&&(n[n.length-1].after=d.after),h*(d.start-n[n.length-1].start)<0&&(n[n.length-1].start=d.start,n[n.length-1].start_elem=n[n.length-1].elements.length),h*(d.end-n[n.length-1].end)>0&&(n[n.length-1].end=d.end,n[n.length-1].end_elem=n[n.length-1].elements.length)}else n.push({before:d.before,after:d.after,start:d.start,end:d.end,start_elem:0,end_elem:0,elements:[],rbc:[],te:[],text:"",br:!1});n[n.length-1].text+=t.textContent,n[n.length-1].elements.push({node:t,bgcolor:c,before:d.before,after:d.after})}else"br"===t.localName&&0!==n.length&&(n[n.length-1].br=!0);else for(var p=t.firstChild;p;)p.nodeType===Node.ELEMENT_NODE&&(u(e,p,n,c),"ruby"===p.localName||"rtc"===p.localName?n.length>0&&n[n.length-1].rbc.push(p):"span"===p.localName&&p.style[v]&&"none"!==p.style[v]&&n.length>0&&n[n.length-1].te.push(p)),p=p.nextSibling}}function c(e,t,n,i){var r;"none"!==i.style&&("auto"===i.style?t.style[v]="filled":t.style[v]=i.style+" "+i.symbol,("before"===i.position||"after"===i.position)&&(r="tb"===e.bpd?"before"===i.position?"left over":"left under":"rl"===e.bpd?"before"===i.position?"right under":"left under":"before"===i.position?"left under":"right under",t.style[y]=r))}function d(e,t){this.qname=e,this.map=t}e.render=function(e,t,n,i,a,o,s,l,u){var c=i||t.clientHeight,d=a||t.clientWidth;if(null!==e.aspectRatio){var f=c*e.aspectRatio;f>d?c=Math.round(d/e.aspectRatio):d=f}var h=document.createElement("div");h.style.position="relative",h.style.width=d+"px",h.style.height=c+"px",h.style.margin="auto",h.style.top=0,h.style.bottom=0,h.style.left=0,h.style.right=0,h.style.zIndex=0;var p={h:c,w:d,regionH:null,regionW:null,imgResolver:n,displayForcedOnlyMode:o||!1,isd:e,errorHandler:s,previousISDState:l,enableRollUp:u||!1,currentISDState:{},flg:null,lp:null,mra:null,ipd:null,bpd:null,ruby:null,textEmphasis:null,rubyReserve:null};if(t.appendChild(h),"contents"in e)for(var g=0;g<e.contents.length;g++)r(p,h,e.contents[g],e);return p.currentISDState};for(var f=[new d("http://www.w3.org/ns/ttml#styling backgroundColor",function(e,t,n,i){0!==i[3]&&(t.style.backgroundColor="rgba("+i[0].toString()+","+i[1].toString()+","+i[2].toString()+","+(i[3]/255).toString()+")")}),new d("http://www.w3.org/ns/ttml#styling color",function(e,t,n,i){t.style.color="rgba("+i[0].toString()+","+i[1].toString()+","+i[2].toString()+","+(i[3]/255).toString()+")"}),new d("http://www.w3.org/ns/ttml#styling direction",function(e,t,n,i){t.style.direction=i}),new d("http://www.w3.org/ns/ttml#styling display",function(e,t,n,i){}),new d("http://www.w3.org/ns/ttml#styling displayAlign",function(e,t,n,i){t.style.display="flex",t.style.flexDirection="column","before"===i?t.style.justifyContent="flex-start":"center"===i?t.style.justifyContent="center":"after"===i&&(t.style.justifyContent="flex-end")}),new d("http://www.w3.org/ns/ttml#styling extent",function(e,t,n,i){e.regionH=i.h.toUsedLength(e.w,e.h),e.regionW=i.w.toUsedLength(e.w,e.h);var r=0,a=0,o=n.styleAttrs["http://www.w3.org/ns/ttml#styling padding"];o&&(r=o[0].toUsedLength(e.w,e.h)+o[2].toUsedLength(e.w,e.h),a=o[1].toUsedLength(e.w,e.h)+o[3].toUsedLength(e.w,e.h)),t.style.height=e.regionH-r+"px",t.style.width=e.regionW-a+"px"}),new d("http://www.w3.org/ns/ttml#styling fontFamily",function(e,t,n,i){for(var r=[],a=0;a<i.length;a++)i[a]=i[a].trim(),"monospaceSerif"===i[a]?(r.push("Courier New"),r.push('"Liberation Mono"'),r.push("Courier"),r.push("monospace")):"proportionalSansSerif"===i[a]?(r.push("Arial"),r.push("Helvetica"),r.push('"Liberation Sans"'),r.push("sans-serif")):"monospace"===i[a]?r.push("monospace"):"sansSerif"===i[a]?r.push("sans-serif"):"serif"===i[a]?r.push("serif"):"monospaceSansSerif"===i[a]?(r.push("Consolas"),r.push("monospace")):"proportionalSerif"===i[a]?r.push("serif"):r.push(i[a]);if(r.length>0){for(var o=[r[0]],s=1;s<r.length;s++)-1==o.indexOf(r[s])&&o.push(r[s]);r=o}t.style.fontFamily=r.join(",")}),new d("http://www.w3.org/ns/ttml#styling shear",function(e,t,n,i){if(0!==i){var r=-.9*i;"tb"===e.bpd?t.style.transform="skewX("+r+"deg)":t.style.transform="skewY("+r+"deg)"}}),new d("http://www.w3.org/ns/ttml#styling fontSize",function(e,t,n,i){t.style.fontSize=i.toUsedLength(e.w,e.h)+"px"}),new d("http://www.w3.org/ns/ttml#styling fontStyle",function(e,t,n,i){t.style.fontStyle=i}),new d("http://www.w3.org/ns/ttml#styling fontWeight",function(e,t,n,i){t.style.fontWeight=i}),new d("http://www.w3.org/ns/ttml#styling lineHeight",function(e,t,n,i){t.style.lineHeight="normal"===i?"normal":i.toUsedLength(e.w,e.h)+"px"}),new d("http://www.w3.org/ns/ttml#styling opacity",function(e,t,n,i){t.style.opacity=i}),new d("http://www.w3.org/ns/ttml#styling origin",function(e,t,n,i){t.style.top=i.h.toUsedLength(e.w,e.h)+"px",t.style.left=i.w.toUsedLength(e.w,e.h)+"px"}),new d("http://www.w3.org/ns/ttml#styling overflow",function(e,t,n,i){t.style.overflow=i}),new d("http://www.w3.org/ns/ttml#styling padding",function(e,t,n,i){var r=[];r[0]=i[0].toUsedLength(e.w,e.h)+"px",r[1]=i[3].toUsedLength(e.w,e.h)+"px",r[2]=i[2].toUsedLength(e.w,e.h)+"px",r[3]=i[1].toUsedLength(e.w,e.h)+"px",t.style.padding=r.join(" ")}),new d("http://www.w3.org/ns/ttml#styling position",function(e,t,n,i){t.style.top=i.h.toUsedLength(e.w,e.h)+"px",t.style.left=i.w.toUsedLength(e.w,e.h)+"px"}),new d("http://www.w3.org/ns/ttml#styling rubyAlign",function(e,t,n,i){t.style.rubyAlign="spaceAround"===i?"space-around":"center"}),new d("http://www.w3.org/ns/ttml#styling rubyPosition",function(e,t,n,i){var r;"before"!==i&&"after"!==i||(r=g?i:"tb"===e.bpd||"rl"===e.bpd?"before"===i?"over":"under":"before"===i?"under":"over",t.parentElement.style[m]=r)}),new d("http://www.w3.org/ns/ttml#styling showBackground",null),new d("http://www.w3.org/ns/ttml#styling textAlign",function(e,t,n,i){var r;r="start"===i?"rl"===e.ipd?"right":"left":"end"===i?"rl"===e.ipd?"left":"right":i,t.style.textAlign=r}),new d("http://www.w3.org/ns/ttml#styling textDecoration",function(e,t,n,i){t.style.textDecoration=i.join(" ").replace("lineThrough","line-through")}),new d("http://www.w3.org/ns/ttml#styling textOutline",function(e,t,n,i){}),new d("http://www.w3.org/ns/ttml#styling textShadow",function(e,t,i,r){var a=i.styleAttrs[n.byName.textOutline.qname];if("none"===r&&"none"===a)t.style.textShadow="";else{var o=[];if("none"!==a){var s="rgba("+a.color[0].toString()+","+a.color[1].toString()+","+a.color[2].toString()+","+(a.color[3]/255).toString()+")";o.push("1px 1px 1px "+s),o.push("-1px 1px 1px "+s),o.push("1px -1px 1px "+s),o.push("-1px -1px 1px "+s)}if("none"!==r)for(var l=0;l<r.length;l++)o.push(r[l].x_off.toUsedLength(e.w,e.h)+"px "+r[l].y_off.toUsedLength(e.w,e.h)+"px "+r[l].b_radius.toUsedLength(e.w,e.h)+"px rgba("+r[l].color[0].toString()+","+r[l].color[1].toString()+","+r[l].color[2].toString()+","+(r[l].color[3]/255).toString()+")");t.style.textShadow=o.join(",")}}),new d("http://www.w3.org/ns/ttml#styling textCombine",function(e,t,n,i){t.style.textCombineUpright=i}),new d("http://www.w3.org/ns/ttml#styling textEmphasis",function(e,t,n,i){}),new d("http://www.w3.org/ns/ttml#styling unicodeBidi",function(e,t,n,i){var r;r="bidiOverride"===i?"bidi-override":i,t.style.unicodeBidi=r}),new d("http://www.w3.org/ns/ttml#styling visibility",function(e,t,n,i){t.style.visibility=i}),new d("http://www.w3.org/ns/ttml#styling wrapOption",function(e,t,n,i){"wrap"===i?"preserve"===n.space?t.style.whiteSpace="pre-wrap":t.style.whiteSpace="normal":"preserve"===n.space?t.style.whiteSpace="pre":t.style.whiteSpace="noWrap"}),new d("http://www.w3.org/ns/ttml#styling writingMode",function(e,t,n,i){"lrtb"===i||"lr"===i||"rltb"===i||"rl"===i?t.style.writingMode="horizontal-tb":"tblr"===i?t.style.writingMode="vertical-lr":"tbrl"!==i&&"tb"!==i||(t.style.writingMode="vertical-rl")}),new d("http://www.w3.org/ns/ttml#styling zIndex",function(e,t,n,i){t.style.zIndex=i}),new d("http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay",function(e,t,n,i){e.displayForcedOnlyMode&&!1===i&&(t.style.visibility="hidden")})],h={},p=0;p<f.length;p++)h[f[p].qname]=f[p];var g="webkitRubyPosition"in window.getComputedStyle(document.documentElement),m=g?"webkitRubyPosition":"rubyPosition",v="webkitTextEmphasisStyle"in window.getComputedStyle(document.documentElement)?"webkitTextEmphasisStyle":"textEmphasisStyle",y="webkitTextEmphasisPosition"in window.getComputedStyle(document.documentElement)?"webkitTextEmphasisPosition":"textEmphasisPosition";function _(e,t){if(e&&e.error&&e.error(t))throw t}}(t,"undefined"==typeof imscNames?n(210):imscNames,"undefined"==typeof imscStyles?n(6811):imscStyles,"undefined"==typeof imscUtils?n(5926):imscUtils)},4080:function(e,t,n){!function(e,t,n,i){e.generateISD=function(e,t,i){var r,o=new l(e),s={},u={},c=e.head.styling.initials[n.byName.showBackground.qname],d=e.head.styling.initials[n.byName.backgroundColor.qname];for(var f in e.head.layout.regions)if(e.head.layout.regions.hasOwnProperty(f)){var h=e.head.layout.regions[f],p=h.styleAttrs[n.byName.showBackground.qname]||c,g=h.styleAttrs[n.byName.backgroundColor.qname]||d;u[h.id]=("always"===p||void 0===p)&&void 0!==g&&!(t<h.begin||t>=h.end)}for(var m in e.body&&e.body.regionID&&(u[e.body.regionID]=!0),r=null!==e.body?function e(t,n){if(n.contents){var i={};for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r]);return i.contents=[],n.contents.filter(function(e){return!(t<e.begin||t>=e.end)}).forEach(function(n){var r=e(t,n);r.regionID&&(u[r.regionID]=!0),null!==r&&i.contents.push(r)}),i}return n}(t,e.body):null,void 0!==u[""]&&(u[""]=!0),u)if(u[m]){var v=a(e,t,e.head.layout.regions[m],r,null,"",e.head.layout.regions[m],i,s);null!==v&&o.contents.push(v.element)}return o};var r=[n.byName.color.qname,n.byName.textCombine.qname,n.byName.textDecoration.qname,n.byName.textEmphasis.qname,n.byName.textOutline.qname,n.byName.textShadow.qname];function a(e,t,l,d,f,h,p,g,m){if(t<p.begin||t>=p.end)return null;var v="regionID"in p&&""!==p.regionID?p.regionID:h;if(null!==f&&v!==l.id&&(!("contents"in p)||"contents"in p&&0===p.contents.length||""!==v))return null;var y=new u(p);if("sets"in p)for(var _=0;_<p.sets.length;_++)t<p.sets[_].begin||t>=p.sets[_].end||(y.styleAttrs[p.sets[_].qname]=p.sets[_].value);var b={};for(var E in y.styleAttrs)if(y.styleAttrs.hasOwnProperty(E)&&(b[E]=!0,"region"===y.kind&&E===n.byName.writingMode.qname&&!(n.byName.direction.qname in y.styleAttrs))){var T=y.styleAttrs[E];"lrtb"===T||"lr"===T?y.styleAttrs[n.byName.direction.qname]="ltr":"rltb"!==T&&"rl"!==T||(y.styleAttrs[n.byName.direction.qname]="rtl")}if(null!==f)for(var S=0;S<n.all.length;S++){var w=n.all[S];if(w.qname===n.byName.textDecoration.qname){var A=f.styleAttrs[w.qname],I=y.styleAttrs[w.qname],x=[];void 0===I?x=A:-1===I.indexOf("none")?((-1===I.indexOf("noUnderline")&&-1!==A.indexOf("underline")||-1!==I.indexOf("underline"))&&x.push("underline"),(-1===I.indexOf("noLineThrough")&&-1!==A.indexOf("lineThrough")||-1!==I.indexOf("lineThrough"))&&x.push("lineThrough"),(-1===I.indexOf("noOverline")&&-1!==A.indexOf("overline")||-1!==I.indexOf("overline"))&&x.push("overline")):x.push("none"),y.styleAttrs[w.qname]=x}else if(w.qname!==n.byName.fontSize.qname||w.qname in y.styleAttrs||"span"!==y.kind||"textContainer"!==y.styleAttrs[n.byName.ruby.qname])if(w.qname!==n.byName.fontSize.qname||w.qname in y.styleAttrs||"span"!==y.kind||"text"!==y.styleAttrs[n.byName.ruby.qname])w.inherit&&w.qname in f.styleAttrs&&!(w.qname in y.styleAttrs)&&(y.styleAttrs[w.qname]=f.styleAttrs[w.qname]);else{var R=f.styleAttrs[n.byName.fontSize.qname];"textContainer"===f.styleAttrs[n.byName.ruby.qname]?y.styleAttrs[w.qname]=R:y.styleAttrs[w.qname]=new i.ComputedLength(.5*R.rw,.5*R.rh)}else{var C=f.styleAttrs[n.byName.fontSize.qname];y.styleAttrs[w.qname]=new i.ComputedLength(.5*C.rw,.5*C.rh)}}for(var D=0;D<n.all.length;D++){var k=n.all[D];if(!(k.qname in y.styleAttrs)&&!(k.qname===n.byName.position.qname&&n.byName.origin.qname in y.styleAttrs||k.qname===n.byName.origin.qname&&n.byName.position.qname in y.styleAttrs)){var M=e.head.styling.initials[k.qname]||k.initial;if(null!==M&&("region"===y.kind||!1===k.inherit&&null!==M)){var L=k.parse(M);null!==L?(y.styleAttrs[k.qname]=L,b[k.qname]=!0):c(g,"Invalid initial value for '"+k.qname+"' on element '"+y.kind)}}}for(var P=0;P<n.all.length;P++){var N=n.all[P];if(N.qname in b&&null!==N.compute){var O=N.compute(e,f,y,y.styleAttrs[N.qname],m);null!==O?y.styleAttrs[N.qname]=O:(y.styleAttrs[N.qname]=N.compute(e,f,y,N.parse(N.initial),m),c(g,"Style '"+N.qname+"' on element '"+y.kind+"' cannot be computed"))}}if("none"===y.styleAttrs[n.byName.display.qname])return null;var F=null;null===f?F=null===d?[]:[d]:"contents"in p&&(F=p.contents);for(var U=0;null!==F&&U<F.length;U++){var B=a(e,t,l,d,y,v,F[U],g,m);null!==B&&y.contents.push(B.element)}for(var G in y.styleAttrs)if(y.styleAttrs.hasOwnProperty(G)){var j=!1;if("span"===y.kind){var V=y.styleAttrs[n.byName.ruby.qname];(j=("container"===V||"textContainer"===V||"baseContainer"===V)&&-1!==r.indexOf(G))||(j="container"!==V&&G===n.byName.rubyAlign.qname),j||(j=!("textContainer"===V||"text"===V)&&G===n.byName.rubyPosition.qname)}if(!j){var H=n.byQName[G];"applies"in H&&(j=-1===H.applies.indexOf(y.kind))}j&&delete y.styleAttrs[G]}var K=y.styleAttrs[n.byName.ruby.qname];if("p"===y.kind||"span"===y.kind&&("textContainer"===K||"text"===K)){var z=[];o(y,z),function(e){for(var t,n=0;n<e.length;)if("br"!==(t=e[n]).kind&&"preserve"!==t.space){var i=t.text.replace(/[\t\r\n ]+/g," ");/^[ ]/.test(i)&&(0===n||"br"===(r=e[n-1]).kind||/[\r\n\t ]$/.test(r.text))&&(i=i.substring(1)),t.text=i,0===i.length?e.splice(n,1):n++}else n++;var r,a;for(n=0;n<e.length;n++)"br"!==(t=e[n]).kind&&"preserve"!==t.space?/[ ]$/.test(t.text)&&(n===e.length-1||"br"===(a=e[n+1]).kind||"preserve"===a.space&&/^[\r\n]/.test(a.text))&&(t.text=t.text.slice(0,-1)):n++}(z),s(y)}return"div"===y.kind&&n.byName.backgroundImage.qname in y.styleAttrs||"br"===y.kind||"image"===y.kind||"contents"in y&&y.contents.length>0||"span"===y.kind&&null!==y.text||"region"===y.kind&&"always"===y.styleAttrs[n.byName.showBackground.qname]?{region_id:v,element:y}:null}function o(e,t){if("contents"in e)for(var i=0;i<e.contents.length;i++){var r=e.contents[i],a=r.styleAttrs[n.byName.ruby.qname];("span"!==r.kind||"textContainer"!==a&&"text"!==a)&&("contents"in r?o(r,t):("span"===r.kind&&0!==r.text.length||"br"===r.kind)&&t.push(r))}}function s(e){if("br"===e.kind)return!1;if("text"in e)return 0===e.text.length;if("contents"in e){for(var t=e.contents.length;t--;)s(e.contents[t])&&e.contents.splice(t,1);return 0===e.contents.length}}function l(e){this.contents=[],this.aspectRatio=e.aspectRatio,this.lang=e.lang}function u(e){for(var t in this.kind=e.kind||"region",this.lang=e.lang,e.id&&(this.id=e.id),this.styleAttrs={},e.styleAttrs)e.styleAttrs.hasOwnProperty(t)&&(this.styleAttrs[t]=e.styleAttrs[t]);"src"in e&&(this.src=e.src),"type"in e&&(this.type=e.type),"text"in e?this.text=e.text:("region"===this.kind||"contents"in e)&&(this.contents=[]),"space"in e&&(this.space=e.space)}function c(e,t){if(e&&e.error&&e.error(t))throw t}}(t,"undefined"==typeof imscNames?n(210):imscNames,"undefined"==typeof imscStyles?n(6811):imscStyles,"undefined"==typeof imscUtils?n(5926):imscUtils)},4403:function(e,t,n){t.generateISD=n(4080).generateISD,t.fromXML=n(3362).fromXML,t.renderHTML=n(506).render},210:function(e,t){!function(e){e.ns_tt="http://www.w3.org/ns/ttml",e.ns_tts="http://www.w3.org/ns/ttml#styling",e.ns_ttp="http://www.w3.org/ns/ttml#parameter",e.ns_xml="http://www.w3.org/XML/1998/namespace",e.ns_itts="http://www.w3.org/ns/ttml/profile/imsc1#styling",e.ns_ittp="http://www.w3.org/ns/ttml/profile/imsc1#parameter",e.ns_smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt",e.ns_ebutts="urn:ebu:tt:style"}(t)},6811:function(e,t,n){!function(e,t,n){function i(e,t,n,i,r,a,o,s){this.name=t,this.ns=e,this.qname=e+" "+t,this.inherit=r,this.animatable=a,this.initial=n,this.applies=i,this.parse=o,this.compute=s}for(var r in e.all=[new i(t.ns_tts,"backgroundColor","transparent",["body","div","p","region","span"],!1,!0,n.parseColor,null),new i(t.ns_tts,"color","white",["span"],!0,!0,n.parseColor,null),new i(t.ns_tts,"direction","ltr",["p","span"],!0,!0,function(e){return e},null),new i(t.ns_tts,"display","auto",["body","div","p","region","span"],!1,!0,function(e){return e},null),new i(t.ns_tts,"displayAlign","before",["region"],!1,!0,function(e){return e},null),new i(t.ns_tts,"extent","auto",["tt","region"],!1,!0,function(e){if("auto"===e)return e;var t=e.split(" ");if(2!==t.length)return null;var i=n.parseLength(t[0]),r=n.parseLength(t[1]);return r&&i?{h:r,w:i}:null},function(e,t,i,r,a){var o,s;if("auto"===r)o=new n.ComputedLength(0,1);else if(null===(o=n.toComputedLength(r.h.value,r.h.unit,null,e.dimensions.h,null,e.pxLength.h)))return null;if("auto"===r)s=new n.ComputedLength(1,0);else if(null===(s=n.toComputedLength(r.w.value,r.w.unit,null,e.dimensions.w,null,e.pxLength.w)))return null;return{h:o,w:s}}),new i(t.ns_tts,"fontFamily","default",["span","p"],!0,!0,function(e){for(var t=e.split(","),n=[],i=0;i<t.length;i++)t[i]=t[i].trim(),"'"!==t[i].charAt(0)&&'"'!==t[i].charAt(0)&&"default"===t[i]?n.push("monospaceSerif"):n.push(t[i]);return n},null),new i(t.ns_tts,"shear","0%",["p"],!0,!0,n.parseLength,function(e,t,n,i){return"%"!==i.unit?null:Math.abs(i.value)>100?100*Math.sign(i.value):i.value}),new i(t.ns_tts,"fontSize","1c",["span","p"],!0,!0,n.parseLength,function(t,i,r,a,o){return n.toComputedLength(a.value,a.unit,null!==i?i.styleAttrs[e.byName.fontSize.qname]:t.cellLength.h,null!==i?i.styleAttrs[e.byName.fontSize.qname]:t.cellLength.h,t.cellLength.h,t.pxLength.h)}),new i(t.ns_tts,"fontStyle","normal",["span","p"],!0,!0,function(e){return e},null),new i(t.ns_tts,"fontWeight","normal",["span","p"],!0,!0,function(e){return e},null),new i(t.ns_tts,"lineHeight","normal",["p"],!0,!0,function(e){return"normal"===e?e:n.parseLength(e)},function(t,i,r,a,o){var s;if("normal"===a)s=a;else if(null===(s=n.toComputedLength(a.value,a.unit,r.styleAttrs[e.byName.fontSize.qname],r.styleAttrs[e.byName.fontSize.qname],t.cellLength.h,t.pxLength.h)))return null;return s}),new i(t.ns_tts,"opacity",1,["region"],!1,!0,parseFloat,null),new i(t.ns_tts,"origin","auto",["region"],!1,!0,function(e){if("auto"===e)return e;var t=e.split(" ");if(2!==t.length)return null;var i=n.parseLength(t[0]),r=n.parseLength(t[1]);return r&&i?{h:r,w:i}:null},function(e,t,i,r,a){var o,s;if("auto"===r)o=new n.ComputedLength(0,0);else if(null===(o=n.toComputedLength(r.h.value,r.h.unit,null,e.dimensions.h,null,e.pxLength.h)))return null;if("auto"===r)s=new n.ComputedLength(0,0);else if(null===(s=n.toComputedLength(r.w.value,r.w.unit,null,e.dimensions.w,null,e.pxLength.w)))return null;return{h:o,w:s}}),new i(t.ns_tts,"overflow","hidden",["region"],!1,!0,function(e){return e},null),new i(t.ns_tts,"padding","0px",["region"],!1,!0,function(e){var t=e.split(" ");if(t.length>4)return null;for(var i=[],r=0;r<t.length;r++){var a=n.parseLength(t[r]);if(!a)return null;i.push(a)}return i},function(t,i,r,a,o){var s;if(1===a.length)s=[a[0],a[0],a[0],a[0]];else if(2===a.length)s=[a[0],a[1],a[0],a[1]];else if(3===a.length)s=[a[0],a[1],a[2],a[1]];else{if(4!==a.length)return null;s=[a[0],a[1],a[2],a[3]]}var l=r.styleAttrs[e.byName.writingMode.qname];if("lrtb"===l||"lr"===l)s=[s[0],s[3],s[2],s[1]];else if("rltb"===l||"rl"===l)s=[s[0],s[1],s[2],s[3]];else if("tblr"===l)s=[s[3],s[0],s[1],s[2]];else{if("tbrl"!==l&&"tb"!==l)return null;s=[s[3],s[2],s[1],s[0]]}for(var u=[],c=0;c<s.length;c++)if(0===s[c].value)u[c]=new n.ComputedLength(0,0);else if(u[c]=n.toComputedLength(s[c].value,s[c].unit,r.styleAttrs[e.byName.fontSize.qname],0===c||2===c?r.styleAttrs[e.byName.extent.qname].h:r.styleAttrs[e.byName.extent.qname].w,0===c||2===c?t.cellLength.h:t.cellLength.w,0===c||2===c?t.pxLength.h:t.pxLength.w),null===u[c])return null;return u}),new i(t.ns_tts,"position","top left",["region"],!1,!0,function(e){return n.parsePosition(e)},function(t,i,r,a){var o,s;return null===(o=n.toComputedLength(a.v.offset.value,a.v.offset.unit,null,new n.ComputedLength(-r.styleAttrs[e.byName.extent.qname].h.rw,t.dimensions.h.rh-r.styleAttrs[e.byName.extent.qname].h.rh),null,t.pxLength.h))?null:("bottom"===a.v.edge&&(o=new n.ComputedLength(-o.rw-r.styleAttrs[e.byName.extent.qname].h.rw,t.dimensions.h.rh-o.rh-r.styleAttrs[e.byName.extent.qname].h.rh)),s=n.toComputedLength(a.h.offset.value,a.h.offset.unit,null,new n.ComputedLength(t.dimensions.w.rw-r.styleAttrs[e.byName.extent.qname].w.rw,-r.styleAttrs[e.byName.extent.qname].w.rh),null,t.pxLength.w),null===o?null:("right"===a.h.edge&&(s=new n.ComputedLength(t.dimensions.w.rw-s.rw-r.styleAttrs[e.byName.extent.qname].w.rw,-s.rh-r.styleAttrs[e.byName.extent.qname].w.rh)),{h:o,w:s}))}),new i(t.ns_tts,"ruby","none",["span"],!1,!0,function(e){return e},null),new i(t.ns_tts,"rubyAlign","center",["span"],!0,!0,function(e){return"center"!==e&&"spaceAround"!==e?null:e},null),new i(t.ns_tts,"rubyPosition","outside",["span"],!0,!0,function(e){return e},null),new i(t.ns_tts,"rubyReserve","none",["p"],!0,!0,function(e){var t=e.split(" "),i=[null,null];if(0===t.length||t.length>2)return null;if("none"!==t[0]&&"both"!==t[0]&&"after"!==t[0]&&"before"!==t[0]&&"outside"!==t[0])return null;if(i[0]=t[0],2===t.length&&"none"!==t[0]){var r=n.parseLength(t[1]);if(!r)return null;i[1]=r}return i},function(t,i,r,a,o){return"none"===a[0]?a:null===(s=null===a[1]?new n.ComputedLength(.5*r.styleAttrs[e.byName.fontSize.qname].rw,.5*r.styleAttrs[e.byName.fontSize.qname].rh):n.toComputedLength(a[1].value,a[1].unit,r.styleAttrs[e.byName.fontSize.qname],r.styleAttrs[e.byName.fontSize.qname],t.cellLength.h,t.pxLength.h))?null:[a[0],s];var s}),new i(t.ns_tts,"showBackground","always",["region"],!1,!0,function(e){return e},null),new i(t.ns_tts,"textAlign","start",["p"],!0,!0,function(e){return e},function(e,t,n,i,r){return"left"===i?"start":"right"===i?"end":i}),new i(t.ns_tts,"textCombine","none",["span"],!0,!0,function(e){return"none"===e||"all"===e?e:null},null),new i(t.ns_tts,"textDecoration","none",["span"],!0,!0,function(e){return e.split(" ")},null),new i(t.ns_tts,"textEmphasis","none",["span"],!0,!0,function(e){for(var t=e.split(" "),i={style:null,symbol:null,color:null,position:null},r=0;r<t.length;r++)if("none"===t[r]||"auto"===t[r])i.style=t[r];else if("filled"===t[r]||"open"===t[r])i.style=t[r];else if("circle"===t[r]||"dot"===t[r]||"sesame"===t[r])i.symbol=t[r];else if("current"===t[r])i.color=t[r];else if("outside"===t[r]||"before"===t[r]||"after"===t[r])i.position=t[r];else if(i.color=n.parseColor(t[r]),null===i.color)return null;return null==i.style&&null==i.symbol?i.style="auto":(i.symbol=i.symbol||"circle",i.style=i.style||"filled"),i.position=i.position||"outside",i.color=i.color||"current",i},null),new i(t.ns_tts,"textOutline","none",["span"],!0,!0,function(e){if("none"===e)return e;var t={},i=e.split(" ");if(0===i.length||i.length>2)return null;var r=n.parseColor(i[0]);if(t.color=r,null!==r&&i.shift(),1!==i.length)return null;var a=n.parseLength(i[0]);return a?(t.thickness=a,t):null},function(t,i,r,a,o){if("none"===a)return a;var s={};return null===a.color?s.color=r.styleAttrs[e.byName.color.qname]:s.color=a.color,s.thickness=n.toComputedLength(a.thickness.value,a.thickness.unit,r.styleAttrs[e.byName.fontSize.qname],r.styleAttrs[e.byName.fontSize.qname],t.cellLength.h,t.pxLength.h),null===s.thickness?null:s}),new i(t.ns_tts,"textShadow","none",["span"],!0,!0,n.parseTextShadow,function(t,i,r,a){if("none"===a)return a;for(var o=[],s=0;s<a.length;s++){var l={};if(l.x_off=n.toComputedLength(a[s][0].value,a[s][0].unit,null,r.styleAttrs[e.byName.fontSize.qname],null,t.pxLength.w),null===l.x_off)return null;if(l.y_off=n.toComputedLength(a[s][1].value,a[s][1].unit,null,r.styleAttrs[e.byName.fontSize.qname],null,t.pxLength.h),null===l.y_off)return null;if(null===a[s][2])l.b_radius=0;else if(l.b_radius=n.toComputedLength(a[s][2].value,a[s][2].unit,null,r.styleAttrs[e.byName.fontSize.qname],null,t.pxLength.h),null===l.b_radius)return null;null===a[s][3]?l.color=r.styleAttrs[e.byName.color.qname]:l.color=a[s][3],o.push(l)}return o}),new i(t.ns_tts,"unicodeBidi","normal",["span","p"],!1,!0,function(e){return e},null),new i(t.ns_tts,"visibility","visible",["body","div","p","region","span"],!0,!0,function(e){return e},null),new i(t.ns_tts,"wrapOption","wrap",["span"],!0,!0,function(e){return e},null),new i(t.ns_tts,"writingMode","lrtb",["region"],!1,!0,function(e){return e},null),new i(t.ns_tts,"zIndex","auto",["region"],!1,!0,function(e){var t;return"auto"===e?t=e:(t=parseInt(e),isNaN(t)&&(t=null)),t},null),new i(t.ns_ebutts,"linePadding","0c",["p"],!0,!1,n.parseLength,function(e,t,i,r,a){return n.toComputedLength(r.value,r.unit,null,null,e.cellLength.w,null)}),new i(t.ns_ebutts,"multiRowAlign","auto",["p"],!0,!1,function(e){return e},null),new i(t.ns_smpte,"backgroundImage",null,["div"],!1,!1,function(e){return e},null),new i(t.ns_itts,"forcedDisplay","false",["body","div","p","region","span"],!0,!0,function(e){return"true"===e},null),new i(t.ns_itts,"fillLineGap","false",["p"],!0,!0,function(e){return"true"===e},null)],e.byQName={},e.all)e.byQName[e.all[r].qname]=e.all[r];for(var a in e.byName={},e.all)e.byName[e.all[a].name]=e.all[a]}(t,"undefined"==typeof imscNames?n(210):imscNames,"undefined"==typeof imscUtils?n(5926):imscUtils)},5926:function(e,t){!function(e){var t=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/,n=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,i=/rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,r={transparent:[0,0,0,0],black:[0,0,0,255],silver:[192,192,192,255],gray:[128,128,128,255],white:[255,255,255,255],maroon:[128,0,0,255],red:[255,0,0,255],purple:[128,0,128,255],fuchsia:[255,0,255,255],magenta:[255,0,255,255],green:[0,128,0,255],lime:[0,255,0,255],olive:[128,128,0,255],yellow:[255,255,0,255],navy:[0,0,128,255],blue:[0,0,255,255],teal:[0,128,128,255],aqua:[0,255,255,255],cyan:[0,255,255,255]};e.parseColor=function(e){var a,o=null,s=r[e.toLowerCase()];return void 0!==s?o=s:null!==(a=t.exec(e))?o=[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16),void 0!==a[4]?parseInt(a[4],16):255]:null!==(a=n.exec(e))?o=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3]),255]:null!==(a=i.exec(e))&&(o=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3]),parseInt(a[4])]),o};var a=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%|rh|rw)$/;e.parseLength=function(e){var t,n=null;return null!==(t=a.exec(e))&&(n={value:parseFloat(t[1]),unit:t[2]}),n},e.parseTextShadow=function(t){for(var n=t.match(/([^\(,\)]|\([^\)]+\))+/g),i=[],r=0;r<n.length;r++){var a=n[r].split(" ");if(1===a.length&&"none"===a[0])return"none";if(a.length>1&&a.length<5){var o=[null,null,null,null],s=e.parseLength(a.shift());if(null===s)return null;if(o[0]=s,null===(s=e.parseLength(a.shift())))return null;if(o[1]=s,0===a.length){i.push(o);continue}if(null!==(s=e.parseLength(a[0]))&&(o[2]=s,a.shift()),0===a.length){i.push(o);continue}var l=e.parseColor(a[0]);if(null===l)return null;o[3]=l,i.push(o)}}return i},e.parsePosition=function(t){var n=t.split(" "),i=function(e){return"center"===e||"left"===e||"top"===e||"bottom"===e||"right"===e};if(n.length>4)return null;for(var r=0;r<n.length;r++)if(!i(n[r])){var a=e.parseLength(n[r]);if(null===a)return null;n[r]=a}for(var o={h:{edge:"left",offset:{value:50,unit:"%"}},v:{edge:"top",offset:{value:50,unit:"%"}}},s=0;s<n.length;){var l=n[s++];if(i(l)){var u={value:0,unit:"%"};2!==n.length&&s<n.length&&!i(n[s])&&(u=n[s++]),"right"===l?(o.h.edge=l,o.h.offset=u):"bottom"===l?(o.v.edge=l,o.v.offset=u):"left"===l?o.h.offset=u:"top"===l&&(o.v.offset=u)}else{if(1!==n.length&&2!==n.length)return null;1===s?o.h.offset=l:o.v.offset=l}}return o},e.ComputedLength=function(e,t){this.rw=e,this.rh=t},e.ComputedLength.prototype.toUsedLength=function(e,t){return e*this.rw+t*this.rh},e.ComputedLength.prototype.isZero=function(){return 0===this.rw&&0===this.rh},e.toComputedLength=function(t,n,i,r,a,o){return"%"===n&&r?new e.ComputedLength(r.rw*t/100,r.rh*t/100):"em"===n&&i?new e.ComputedLength(i.rw*t,i.rh*t):"c"===n&&a?new e.ComputedLength(t*a.rw,t*a.rh):"px"===n&&o?new e.ComputedLength(t*o.rw,t*o.rh):"rh"===n?new e.ComputedLength(0,t/100):"rw"===n?new e.ComputedLength(t/100,0):null}}(t)},3516:function(e){"use strict";e.exports=function(e){var t="string"==typeof e?e.charCodeAt(0):e;return t>=97&&t<=122||t>=65&&t<=90}},2219:function(e,t,n){"use strict";var i=n(3516),r=n(395);e.exports=function(e){return i(e)||r(e)}},395:function(e){"use strict";e.exports=function(e){var t="string"==typeof e?e.charCodeAt(0):e;return t>=48&&t<=57}},3875:function(e){"use strict";function n(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function i(e,t){for(var n,i="",r=0,a=-1,o=0,s=0;s<=e.length;++s){if(s<e.length)n=e.charCodeAt(s);else{if(47===n)break;n=47}if(47===n){if(a===s-1||1===o);else if(a!==s-1&&2===o){if(i.length<2||2!==r||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2))if(i.length>2){var l=i.lastIndexOf("/");if(l!==i.length-1){-1===l?(i="",r=0):r=(i=i.slice(0,l)).length-1-i.lastIndexOf("/"),a=s,o=0;continue}}else if(2===i.length||1===i.length){i="",r=0,a=s,o=0;continue}t&&(i.length>0?i+="/..":i="..",r=2)}else i.length>0?i+="/"+e.slice(a+1,s):i=e.slice(a+1,s),r=s-a-1;a=s,o=0}else 46===n&&-1!==o?++o:o=-1}return i}var r={resolve:function(){for(var e,r="",a=!1,o=arguments.length-1;o>=-1&&!a;o--){var s;o>=0?s=arguments[o]:(void 0===e&&(e=t.cwd()),s=e),n(s),0!==s.length&&(r=s+"/"+r,a=47===s.charCodeAt(0))}return r=i(r,!a),a?r.length>0?"/"+r:"/":r.length>0?r:"."},normalize:function(e){if(n(e),0===e.length)return".";var t=47===e.charCodeAt(0),r=47===e.charCodeAt(e.length-1);return 0!==(e=i(e,!t)).length||t||(e="."),e.length>0&&r&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return n(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,t=0;t<arguments.length;++t){var i=arguments[t];n(i),i.length>0&&(void 0===e?e=i:e+="/"+i)}return void 0===e?".":r.normalize(e)},relative:function(e,t){if(n(e),n(t),e===t)return"";if((e=r.resolve(e))===(t=r.resolve(t)))return"";for(var i=1;i<e.length&&47===e.charCodeAt(i);++i);for(var a=e.length,o=a-i,s=1;s<t.length&&47===t.charCodeAt(s);++s);for(var l=t.length-s,u=o<l?o:l,c=-1,d=0;d<=u;++d){if(d===u){if(l>u){if(47===t.charCodeAt(s+d))return t.slice(s+d+1);if(0===d)return t.slice(s+d)}else o>u&&(47===e.charCodeAt(i+d)?c=d:0===d&&(c=0));break}var f=e.charCodeAt(i+d);if(f!==t.charCodeAt(s+d))break;47===f&&(c=d)}var h="";for(d=i+c+1;d<=a;++d)d!==a&&47!==e.charCodeAt(d)||(0===h.length?h+="..":h+="/..");return h.length>0?h+t.slice(s+c):(s+=c,47===t.charCodeAt(s)&&++s,t.slice(s))},_makeLong:function(e){return e},dirname:function(e){if(n(e),0===e.length)return".";for(var t=e.charCodeAt(0),i=47===t,r=-1,a=!0,o=e.length-1;o>=1;--o)if(47===(t=e.charCodeAt(o))){if(!a){r=o;break}}else a=!1;return-1===r?i?"/":".":i&&1===r?"//":e.slice(0,r)},basename:function(e,t){if(void 0!==t&&"string"!=typeof t)throw new TypeError('"ext" argument must be a string');n(e);var i,r=0,a=-1,o=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var s=t.length-1,l=-1;for(i=e.length-1;i>=0;--i){var u=e.charCodeAt(i);if(47===u){if(!o){r=i+1;break}}else-1===l&&(o=!1,l=i+1),s>=0&&(u===t.charCodeAt(s)?-1==--s&&(a=i):(s=-1,a=l))}return r===a?a=l:-1===a&&(a=e.length),e.slice(r,a)}for(i=e.length-1;i>=0;--i)if(47===e.charCodeAt(i)){if(!o){r=i+1;break}}else-1===a&&(o=!1,a=i+1);return-1===a?"":e.slice(r,a)},extname:function(e){n(e);for(var t=-1,i=0,r=-1,a=!0,o=0,s=e.length-1;s>=0;--s){var l=e.charCodeAt(s);if(47!==l)-1===r&&(a=!1,r=s+1),46===l?-1===t?t=s:1!==o&&(o=1):-1!==t&&(o=-1);else if(!a){i=s+1;break}}return-1===t||-1===r||0===o||1===o&&t===r-1&&t===i+1?"":e.slice(t,r)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var n=t.dir||t.root,i=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+i:n+"/"+i:i}(0,e)},parse:function(e){n(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;var i,r=e.charCodeAt(0),a=47===r;a?(t.root="/",i=1):i=0;for(var o=-1,s=0,l=-1,u=!0,c=e.length-1,d=0;c>=i;--c)if(47!==(r=e.charCodeAt(c)))-1===l&&(u=!1,l=c+1),46===r?-1===o?o=c:1!==d&&(d=1):-1!==o&&(d=-1);else if(!u){s=c+1;break}return-1===o||-1===l||0===d||1===d&&o===l-1&&o===s+1?-1!==l&&(t.base=t.name=0===s&&a?e.slice(1,l):e.slice(s,l)):(0===s&&a?(t.name=e.slice(1,o),t.base=e.slice(1,l)):(t.name=e.slice(s,o),t.base=e.slice(s,l)),t.ext=e.slice(o,l)),s>0?t.dir=e.slice(0,s-1):a&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};r.posix=r,e.exports=r},8387:function(e,t,n){var i=n(1549),r=i.Buffer;function a(e,t){for(var n in e)t[n]=e[n]}function o(e,t,n){return r(e,t,n)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=i:(a(i,t),t.Buffer=o),a(r,o),o.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return r(e,t,n)},o.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=r(e);return void 0!==t?"string"==typeof n?i.fill(t,n):i.fill(t):i.fill(0),i},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i.SlowBuffer(e)}},5378:function(e,t,i){!function(e){e.parser=function(e,t){return new a(e,t)},e.SAXParser=a,e.SAXStream=s,e.createStream=function(e,t){return new s(e,t)},e.MAX_BUFFER_LENGTH=65536;var t,r=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function a(t,n){if(!(this instanceof a))return new a(t,n);var i=this;!function(e){for(var t=0,n=r.length;t<n;t++)e[r[t]]=""}(i),i.q=i.c="",i.bufferCheckPosition=e.MAX_BUFFER_LENGTH,i.opt=n||{},i.opt.lowercase=i.opt.lowercase||i.opt.lowercasetags,i.looseCase=i.opt.lowercase?"toLowerCase":"toUpperCase",i.tags=[],i.closed=i.closedRoot=i.sawRoot=!1,i.tag=i.error=null,i.strict=!!t,i.noscript=!(!t&&!i.opt.noscript),i.state=I.BEGIN,i.strictEntities=i.opt.strictEntities,i.ENTITIES=i.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),i.attribList=[],i.opt.xmlns&&(i.ns=Object.create(g)),i.trackPosition=!1!==i.opt.position,i.trackPosition&&(i.position=i.line=i.column=0),R(i,"onready")}e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}),a.prototype={end:function(){L(this)},write:function(t){var n=this;if(this.error)throw this.error;if(n.closed)return M(n,"Cannot write after close. Assign an onready handler.");if(null===t)return L(n);"object"==typeof t&&(t=t.toString());for(var i=0,a="";a=V(t,i++),n.c=a,a;)switch(n.trackPosition&&(n.position++,"\n"===a?(n.line++,n.column=0):n.column++),n.state){case I.BEGIN:if(n.state=I.BEGIN_WHITESPACE,"\ufeff"===a)continue;j(n,a);continue;case I.BEGIN_WHITESPACE:j(n,a);continue;case I.TEXT:if(n.sawRoot&&!n.closedRoot){for(var o=i-1;a&&"<"!==a&&"&"!==a;)(a=V(t,i++))&&n.trackPosition&&(n.position++,"\n"===a?(n.line++,n.column=0):n.column++);n.textNode+=t.substring(o,i-1)}"<"!==a||n.sawRoot&&n.closedRoot&&!n.strict?(!T(l,a)||n.sawRoot&&!n.closedRoot||P(n,"Text data outside of root node."),"&"===a?n.state=I.TEXT_ENTITY:n.textNode+=a):(n.state=I.OPEN_WAKA,n.startTagPosition=n.position);continue;case I.SCRIPT:"<"===a?n.state=I.SCRIPT_ENDING:n.script+=a;continue;case I.SCRIPT_ENDING:"/"===a?n.state=I.CLOSE_TAG:(n.script+="<"+a,n.state=I.SCRIPT);continue;case I.OPEN_WAKA:if("!"===a)n.state=I.SGML_DECL,n.sgmlDecl="";else if(E(l,a));else if(E(m,a))n.state=I.OPEN_TAG,n.tagName=a;else if("/"===a)n.state=I.CLOSE_TAG,n.tagName="";else if("?"===a)n.state=I.PROC_INST,n.procInstName=n.procInstBody="";else{if(P(n,"Unencoded <"),n.startTagPosition+1<n.position){var s=n.position-n.startTagPosition;a=new Array(s).join(" ")+a}n.textNode+="<"+a,n.state=I.TEXT}continue;case I.SGML_DECL:"[CDATA["===(n.sgmlDecl+a).toUpperCase()?(C(n,"onopencdata"),n.state=I.CDATA,n.sgmlDecl="",n.cdata=""):n.sgmlDecl+a==="--"?(n.state=I.COMMENT,n.comment="",n.sgmlDecl=""):"DOCTYPE"===(n.sgmlDecl+a).toUpperCase()?(n.state=I.DOCTYPE,(n.doctype||n.sawRoot)&&P(n,"Inappropriately located doctype declaration"),n.doctype="",n.sgmlDecl=""):">"===a?(C(n,"onsgmldeclaration",n.sgmlDecl),n.sgmlDecl="",n.state=I.TEXT):E(d,a)?(n.state=I.SGML_DECL_QUOTED,n.sgmlDecl+=a):n.sgmlDecl+=a;continue;case I.SGML_DECL_QUOTED:a===n.q&&(n.state=I.SGML_DECL,n.q=""),n.sgmlDecl+=a;continue;case I.DOCTYPE:">"===a?(n.state=I.TEXT,C(n,"ondoctype",n.doctype),n.doctype=!0):(n.doctype+=a,"["===a?n.state=I.DOCTYPE_DTD:E(d,a)&&(n.state=I.DOCTYPE_QUOTED,n.q=a));continue;case I.DOCTYPE_QUOTED:n.doctype+=a,a===n.q&&(n.q="",n.state=I.DOCTYPE);continue;case I.DOCTYPE_DTD:n.doctype+=a,"]"===a?n.state=I.DOCTYPE:E(d,a)&&(n.state=I.DOCTYPE_DTD_QUOTED,n.q=a);continue;case I.DOCTYPE_DTD_QUOTED:n.doctype+=a,a===n.q&&(n.state=I.DOCTYPE_DTD,n.q="");continue;case I.COMMENT:"-"===a?n.state=I.COMMENT_ENDING:n.comment+=a;continue;case I.COMMENT_ENDING:"-"===a?(n.state=I.COMMENT_ENDED,n.comment=k(n.opt,n.comment),n.comment&&C(n,"oncomment",n.comment),n.comment=""):(n.comment+="-"+a,n.state=I.COMMENT);continue;case I.COMMENT_ENDED:">"!==a?(P(n,"Malformed comment"),n.comment+="--"+a,n.state=I.COMMENT):n.state=I.TEXT;continue;case I.CDATA:"]"===a?n.state=I.CDATA_ENDING:n.cdata+=a;continue;case I.CDATA_ENDING:"]"===a?n.state=I.CDATA_ENDING_2:(n.cdata+="]"+a,n.state=I.CDATA);continue;case I.CDATA_ENDING_2:">"===a?(n.cdata&&C(n,"oncdata",n.cdata),C(n,"onclosecdata"),n.cdata="",n.state=I.TEXT):"]"===a?n.cdata+="]":(n.cdata+="]]"+a,n.state=I.CDATA);continue;case I.PROC_INST:"?"===a?n.state=I.PROC_INST_ENDING:E(l,a)?n.state=I.PROC_INST_BODY:n.procInstName+=a;continue;case I.PROC_INST_BODY:if(!n.procInstBody&&E(l,a))continue;"?"===a?n.state=I.PROC_INST_ENDING:n.procInstBody+=a;continue;case I.PROC_INST_ENDING:">"===a?(C(n,"onprocessinginstruction",{name:n.procInstName,body:n.procInstBody}),n.procInstName=n.procInstBody="",n.state=I.TEXT):(n.procInstBody+="?"+a,n.state=I.PROC_INST_BODY);continue;case I.OPEN_TAG:E(v,a)?n.tagName+=a:(N(n),">"===a?U(n):"/"===a?n.state=I.OPEN_TAG_SLASH:(T(l,a)&&P(n,"Invalid character in tag name"),n.state=I.ATTRIB));continue;case I.OPEN_TAG_SLASH:">"===a?(U(n,!0),B(n)):(P(n,"Forward-slash in opening tag not followed by >"),n.state=I.ATTRIB);continue;case I.ATTRIB:if(E(l,a))continue;">"===a?U(n):"/"===a?n.state=I.OPEN_TAG_SLASH:E(m,a)?(n.attribName=a,n.attribValue="",n.state=I.ATTRIB_NAME):P(n,"Invalid attribute name");continue;case I.ATTRIB_NAME:"="===a?n.state=I.ATTRIB_VALUE:">"===a?(P(n,"Attribute without value"),n.attribValue=n.attribName,F(n),U(n)):E(l,a)?n.state=I.ATTRIB_NAME_SAW_WHITE:E(v,a)?n.attribName+=a:P(n,"Invalid attribute name");continue;case I.ATTRIB_NAME_SAW_WHITE:if("="===a)n.state=I.ATTRIB_VALUE;else{if(E(l,a))continue;P(n,"Attribute without value"),n.tag.attributes[n.attribName]="",n.attribValue="",C(n,"onattribute",{name:n.attribName,value:""}),n.attribName="",">"===a?U(n):E(m,a)?(n.attribName=a,n.state=I.ATTRIB_NAME):(P(n,"Invalid attribute name"),n.state=I.ATTRIB)}continue;case I.ATTRIB_VALUE:if(E(l,a))continue;E(d,a)?(n.q=a,n.state=I.ATTRIB_VALUE_QUOTED):(P(n,"Unquoted attribute value"),n.state=I.ATTRIB_VALUE_UNQUOTED,n.attribValue=a);continue;case I.ATTRIB_VALUE_QUOTED:if(a!==n.q){"&"===a?n.state=I.ATTRIB_VALUE_ENTITY_Q:n.attribValue+=a;continue}F(n),n.q="",n.state=I.ATTRIB_VALUE_CLOSED;continue;case I.ATTRIB_VALUE_CLOSED:E(l,a)?n.state=I.ATTRIB:">"===a?U(n):"/"===a?n.state=I.OPEN_TAG_SLASH:E(m,a)?(P(n,"No whitespace between attributes"),n.attribName=a,n.attribValue="",n.state=I.ATTRIB_NAME):P(n,"Invalid attribute name");continue;case I.ATTRIB_VALUE_UNQUOTED:if(T(f,a)){"&"===a?n.state=I.ATTRIB_VALUE_ENTITY_U:n.attribValue+=a;continue}F(n),">"===a?U(n):n.state=I.ATTRIB;continue;case I.CLOSE_TAG:if(n.tagName)">"===a?B(n):E(v,a)?n.tagName+=a:n.script?(n.script+="</"+n.tagName,n.tagName="",n.state=I.SCRIPT):(T(l,a)&&P(n,"Invalid tagname in closing tag"),n.state=I.CLOSE_TAG_SAW_WHITE);else{if(E(l,a))continue;T(m,a)?n.script?(n.script+="</"+a,n.state=I.SCRIPT):P(n,"Invalid tagname in closing tag."):n.tagName=a}continue;case I.CLOSE_TAG_SAW_WHITE:if(E(l,a))continue;">"===a?B(n):P(n,"Invalid characters in closing tag");continue;case I.TEXT_ENTITY:case I.ATTRIB_VALUE_ENTITY_Q:case I.ATTRIB_VALUE_ENTITY_U:var u,c;switch(n.state){case I.TEXT_ENTITY:u=I.TEXT,c="textNode";break;case I.ATTRIB_VALUE_ENTITY_Q:u=I.ATTRIB_VALUE_QUOTED,c="attribValue";break;case I.ATTRIB_VALUE_ENTITY_U:u=I.ATTRIB_VALUE_UNQUOTED,c="attribValue"}";"===a?(n[c]+=G(n),n.entity="",n.state=u):E(n.entity.length?_:y,a)?n.entity+=a:(P(n,"Invalid character in entity name"),n[c]+="&"+n.entity+a,n.entity="",n.state=u);continue;default:throw new Error(n,"Unknown state: "+n.state)}return n.position>=n.bufferCheckPosition&&function(t){for(var n=Math.max(e.MAX_BUFFER_LENGTH,10),i=0,a=0,o=r.length;a<o;a++){var s=t[r[a]].length;if(s>n)switch(r[a]){case"textNode":D(t);break;case"cdata":C(t,"oncdata",t.cdata),t.cdata="";break;case"script":C(t,"onscript",t.script),t.script="";break;default:M(t,"Max buffer length exceeded: "+r[a])}i=Math.max(i,s)}var l=e.MAX_BUFFER_LENGTH-i;t.bufferCheckPosition=l+t.position}(n),n},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var e;D(e=this),""!==e.cdata&&(C(e,"oncdata",e.cdata),e.cdata=""),""!==e.script&&(C(e,"onscript",e.script),e.script="")}};try{t=i(182).Stream}catch(e){t=function(){}}var o=e.EVENTS.filter(function(e){return"error"!==e&&"end"!==e});function s(e,n){if(!(this instanceof s))return new s(e,n);t.apply(this),this._parser=new a(e,n),this.writable=!0,this.readable=!0;var i=this;this._parser.onend=function(){i.emit("end")},this._parser.onerror=function(e){i.emit("error",e),i._parser.error=null},this._decoder=null,o.forEach(function(e){Object.defineProperty(i,"on"+e,{get:function(){return i._parser["on"+e]},set:function(t){if(!t)return i.removeAllListeners(e),i._parser["on"+e]=t,t;i.on(e,t)},enumerable:!0,configurable:!1})})}s.prototype=Object.create(t.prototype,{constructor:{value:s}}),s.prototype.write=function(e){if("function"==typeof n&&"function"==typeof n.isBuffer&&n.isBuffer(e)){if(!this._decoder){var t=i(7503).s;this._decoder=new t("utf8")}e=this._decoder.write(e)}return this._parser.write(e.toString()),this.emit("data",e),!0},s.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},s.prototype.on=function(e,n){var i=this;return i._parser["on"+e]||-1===o.indexOf(e)||(i._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),i.emit.apply(i,t)}),t.prototype.on.call(i,e,n)};var l="\r\n\t ",u="0124356789",c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",d="'\"",f=l+">",h="http://www.w3.org/XML/1998/namespace",p="http://www.w3.org/2000/xmlns/",g={xml:h,xmlns:p};l=b(l),u=b(u),c=b(c);var m=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,v=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/,y=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,_=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;function b(e){return e.split("").reduce(function(e,t){return e[t]=!0,e},{})}function E(e,t){return function(e){return"[object RegExp]"===Object.prototype.toString.call(e)}(e)?!!t.match(e):e[t]}function T(e,t){return!E(e,t)}d=b(d),f=b(f);var S,w,A,I=0;for(var x in e.STATE={BEGIN:I++,BEGIN_WHITESPACE:I++,TEXT:I++,TEXT_ENTITY:I++,OPEN_WAKA:I++,SGML_DECL:I++,SGML_DECL_QUOTED:I++,DOCTYPE:I++,DOCTYPE_QUOTED:I++,DOCTYPE_DTD:I++,DOCTYPE_DTD_QUOTED:I++,COMMENT_STARTING:I++,COMMENT:I++,COMMENT_ENDING:I++,COMMENT_ENDED:I++,CDATA:I++,CDATA_ENDING:I++,CDATA_ENDING_2:I++,PROC_INST:I++,PROC_INST_BODY:I++,PROC_INST_ENDING:I++,OPEN_TAG:I++,OPEN_TAG_SLASH:I++,ATTRIB:I++,ATTRIB_NAME:I++,ATTRIB_NAME_SAW_WHITE:I++,ATTRIB_VALUE:I++,ATTRIB_VALUE_QUOTED:I++,ATTRIB_VALUE_CLOSED:I++,ATTRIB_VALUE_UNQUOTED:I++,ATTRIB_VALUE_ENTITY_Q:I++,ATTRIB_VALUE_ENTITY_U:I++,CLOSE_TAG:I++,CLOSE_TAG_SAW_WHITE:I++,SCRIPT:I++,SCRIPT_ENDING:I++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(t){var n=e.ENTITIES[t],i="number"==typeof n?String.fromCharCode(n):n;e.ENTITIES[t]=i}),e.STATE)e.STATE[e.STATE[x]]=x;function R(e,t,n){e[t]&&e[t](n)}function C(e,t,n){e.textNode&&D(e),R(e,t,n)}function D(e){e.textNode=k(e.opt,e.textNode),e.textNode&&R(e,"ontext",e.textNode),e.textNode=""}function k(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function M(e,t){return D(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=new Error(t),e.error=t,R(e,"onerror",t),e}function L(e){return e.sawRoot&&!e.closedRoot&&P(e,"Unclosed root tag"),e.state!==I.BEGIN&&e.state!==I.BEGIN_WHITESPACE&&e.state!==I.TEXT&&M(e,"Unexpected end"),D(e),e.c="",e.closed=!0,R(e,"onend"),a.call(e,e.strict,e.opt),e}function P(e,t){if("object"!=typeof e||!(e instanceof a))throw new Error("bad call to strictFail");e.strict&&M(e,t)}function N(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,n=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(n.ns=t.ns),e.attribList.length=0,C(e,"onopentagstart",n)}function O(e,t){var n=e.indexOf(":")<0?["",e]:e.split(":"),i=n[0],r=n[1];return t&&"xmlns"===e&&(i="xmlns",r=""),{prefix:i,local:r}}function F(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName))e.attribName=e.attribValue="";else{if(e.opt.xmlns){var t=O(e.attribName,!0),n=t.prefix,i=t.local;if("xmlns"===n)if("xml"===i&&e.attribValue!==h)P(e,"xml: prefix must be bound to "+h+"\nActual: "+e.attribValue);else if("xmlns"===i&&e.attribValue!==p)P(e,"xmlns: prefix must be bound to "+p+"\nActual: "+e.attribValue);else{var r=e.tag,a=e.tags[e.tags.length-1]||e;r.ns===a.ns&&(r.ns=Object.create(a.ns)),r.ns[i]=e.attribValue}e.attribList.push([e.attribName,e.attribValue])}else e.tag.attributes[e.attribName]=e.attribValue,C(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue=""}}function U(e,t){if(e.opt.xmlns){var n=e.tag,i=O(e.tagName);n.prefix=i.prefix,n.local=i.local,n.uri=n.ns[i.prefix]||"",n.prefix&&!n.uri&&(P(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),n.uri=i.prefix);var r=e.tags[e.tags.length-1]||e;n.ns&&r.ns!==n.ns&&Object.keys(n.ns).forEach(function(t){C(e,"onopennamespace",{prefix:t,uri:n.ns[t]})});for(var a=0,o=e.attribList.length;a<o;a++){var s=e.attribList[a],l=s[0],u=s[1],c=O(l,!0),d=c.prefix,f=c.local,h=""===d?"":n.ns[d]||"",p={name:l,value:u,prefix:d,local:f,uri:h};d&&"xmlns"!==d&&!h&&(P(e,"Unbound namespace prefix: "+JSON.stringify(d)),p.uri=d),e.tag.attributes[l]=p,C(e,"onattribute",p)}e.attribList.length=0}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),C(e,"onopentag",e.tag),t||(e.noscript||"script"!==e.tagName.toLowerCase()?e.state=I.TEXT:e.state=I.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0}function B(e){if(!e.tagName)return P(e,"Weird empty close tag."),e.textNode+="</>",void(e.state=I.TEXT);if(e.script){if("script"!==e.tagName)return e.script+="</"+e.tagName+">",e.tagName="",void(e.state=I.SCRIPT);C(e,"onscript",e.script),e.script=""}var t=e.tags.length,n=e.tagName;e.strict||(n=n[e.looseCase]());for(var i=n;t--&&e.tags[t].name!==i;)P(e,"Unexpected close tag");if(t<0)return P(e,"Unmatched closing tag: "+e.tagName),e.textNode+="</"+e.tagName+">",void(e.state=I.TEXT);e.tagName=n;for(var r=e.tags.length;r-- >t;){var a=e.tag=e.tags.pop();e.tagName=e.tag.name,C(e,"onclosetag",e.tagName);var o={};for(var s in a.ns)o[s]=a.ns[s];var l=e.tags[e.tags.length-1]||e;e.opt.xmlns&&a.ns!==l.ns&&Object.keys(a.ns).forEach(function(t){var n=a.ns[t];C(e,"onclosenamespace",{prefix:t,uri:n})})}0===t&&(e.closedRoot=!0),e.tagName=e.attribValue=e.attribName="",e.attribList.length=0,e.state=I.TEXT}function G(e){var t,n=e.entity,i=n.toLowerCase(),r="";return e.ENTITIES[n]?e.ENTITIES[n]:e.ENTITIES[i]?e.ENTITIES[i]:("#"===(n=i).charAt(0)&&("x"===n.charAt(1)?(n=n.slice(2),r=(t=parseInt(n,16)).toString(16)):(n=n.slice(1),r=(t=parseInt(n,10)).toString(10))),n=n.replace(/^0+/,""),r.toLowerCase()!==n?(P(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t))}function j(e,t){"<"===t?(e.state=I.OPEN_WAKA,e.startTagPosition=e.position):T(l,t)&&(P(e,"Non-whitespace before first tag."),e.textNode=t,e.state=I.TEXT)}function V(e,t){var n="";return t<e.length&&(n=e.charAt(t)),n}I=e.STATE,String.fromCodePoint||(S=String.fromCharCode,w=Math.floor,A=function(){var e,t,n=16384,i=[],r=-1,a=arguments.length;if(!a)return"";for(var o="";++r<a;){var s=Number(arguments[r]);if(!isFinite(s)||s<0||s>1114111||w(s)!==s)throw RangeError("Invalid code point: "+s);s<=65535?i.push(s):(e=55296+((s-=65536)>>10),t=s%1024+56320,i.push(e,t)),(r+1===a||i.length>n)&&(o+=S.apply(null,i),i.length=0)}return o},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:A,configurable:!0,writable:!0}):String.fromCodePoint=A)}(t)},182:function(e,t,n){e.exports=r;var i=n(1159).EventEmitter;function r(){i.call(this)}n(1765)(r,i),r.Readable=n(2846),r.Writable=n(8318),r.Duplex=n(6138),r.Transform=n(9798),r.PassThrough=n(5472),r.finished=n(8800),r.pipeline=n(7295),r.Stream=r,r.prototype.pipe=function(e,t){var n=this;function r(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function a(){n.readable&&n.resume&&n.resume()}n.on("data",r),e.on("drain",a),e._isStdio||t&&!1===t.end||(n.on("end",s),n.on("close",l));var o=!1;function s(){o||(o=!0,e.end())}function l(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){if(c(),0===i.listenerCount(this,"error"))throw e}function c(){n.removeListener("data",r),e.removeListener("drain",a),n.removeListener("end",s),n.removeListener("close",l),n.removeListener("error",u),e.removeListener("error",u),n.removeListener("end",c),n.removeListener("close",c),e.removeListener("close",c)}return n.on("error",u),e.on("error",u),n.on("end",c),n.on("close",c),e.on("close",c),e.emit("pipe",n),e}},1765:function(e){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},3690:function(e){"use strict";var t={};function n(e,n,i){i||(i=Error);var r=function(e){var t,i;function r(t,i,r){return e.call(this,function(e,t,i){return"string"==typeof n?n:n(e,t,i)}(t,i,r))||this}return i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i,r}(i);r.prototype.name=i.name,r.prototype.code=e,t[e]=r}function i(e,t){if(Array.isArray(e)){var n=e.length;return e=e.map(function(e){return String(e)}),n>2?"one of ".concat(t," ").concat(e.slice(0,n-1).join(", "),", or ")+e[n-1]:2===n?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}n("ERR_INVALID_OPT_VALUE",function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'},TypeError),n("ERR_INVALID_ARG_TYPE",function(e,t,n){var r,a,o,s,l;if("string"==typeof t&&(a="not ",t.substr(0,a.length)===a)?(r="must not be",t=t.replace(/^not /,"")):r="must be",function(e,t,n){return(void 0===n||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t}(e," argument"))o="The ".concat(e," ").concat(r," ").concat(i(t,"type"));else{var u=("number"!=typeof l&&(l=0),l+".".length>(s=e).length||-1===s.indexOf(".",l)?"argument":"property");o='The "'.concat(e,'" ').concat(u," ").concat(r," ").concat(i(t,"type"))}return o+". Received type ".concat(typeof n)},TypeError),n("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),n("ERR_METHOD_NOT_IMPLEMENTED",function(e){return"The "+e+" method is not implemented"}),n("ERR_STREAM_PREMATURE_CLOSE","Premature close"),n("ERR_STREAM_DESTROYED",function(e){return"Cannot call "+e+" after a stream was destroyed"}),n("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),n("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),n("ERR_STREAM_WRITE_AFTER_END","write after end"),n("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),n("ERR_UNKNOWN_ENCODING",function(e){return"Unknown encoding: "+e},TypeError),n("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.q=t},6138:function(e,n,i){"use strict";var r=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=c;var a=i(2846),o=i(8318);i(1765)(c,a);for(var s=r(o.prototype),l=0;l<s.length;l++){var u=s[l];c.prototype[u]||(c.prototype[u]=o.prototype[u])}function c(e){if(!(this instanceof c))return new c(e);a.call(this,e),o.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",d)))}function d(){this._writableState.ended||t.nextTick(f,this)}function f(e){e.end()}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})},5472:function(e,t,n){"use strict";e.exports=r;var i=n(9798);function r(e){if(!(this instanceof r))return new r(e);i.call(this,e)}n(1765)(r,i),r.prototype._transform=function(e,t,n){n(null,e)}},2846:function(e,n,i){"use strict";var r;e.exports=A,A.ReadableState=w,i(1159).EventEmitter;var a,o=function(e,t){return e.listeners(t).length},s=i(9299),l=i(1549).Buffer,u=i.g.Uint8Array||function(){},c=i(964);a=c&&c.debuglog?c.debuglog("stream"):function(){};var d,f,h,p=i(8393),g=i(6163),m=i(7269).getHighWaterMark,v=i(3690).q,y=v.ERR_INVALID_ARG_TYPE,_=v.ERR_STREAM_PUSH_AFTER_EOF,b=v.ERR_METHOD_NOT_IMPLEMENTED,E=v.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;i(1765)(A,s);var T=g.errorOrDestroy,S=["error","close","destroy","pause","resume"];function w(e,t,n){r=r||i(6138),e=e||{},"boolean"!=typeof n&&(n=t instanceof r),this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=m(this,e,"readableHighWaterMark",n),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(d||(d=i(7503).s),this.decoder=new d(e.encoding),this.encoding=e.encoding)}function A(e){if(r=r||i(6138),!(this instanceof A))return new A(e);var t=this instanceof r;this._readableState=new w(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),s.call(this)}function I(e,t,n,i,r){a("readableAddChunk",t);var o,s=e._readableState;if(null===t)s.reading=!1,function(e,t){if(a("onEofChunk"),!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.sync?D(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,k(e)))}}(e,s);else if(r||(o=function(e,t){var n,i;return i=t,l.isBuffer(i)||i instanceof u||"string"==typeof t||void 0===t||e.objectMode||(n=new y("chunk",["string","Buffer","Uint8Array"],t)),n}(s,t)),o)T(e,o);else if(s.objectMode||t&&t.length>0)if("string"==typeof t||s.objectMode||Object.getPrototypeOf(t)===l.prototype||(t=function(e){return l.from(e)}(t)),i)s.endEmitted?T(e,new E):x(e,s,t,!0);else if(s.ended)T(e,new _);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!n?(t=s.decoder.write(t),s.objectMode||0!==t.length?x(e,s,t,!1):M(e,s)):x(e,s,t,!1)}else i||(s.reading=!1,M(e,s));return!s.ended&&(s.length<s.highWaterMark||0===s.length)}function x(e,t,n,i){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&D(e)),M(e,t)}Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),A.prototype.destroy=g.destroy,A.prototype._undestroy=g.undestroy,A.prototype._destroy=function(e,t){t(e)},A.prototype.push=function(e,t){var n,i=this._readableState;return i.objectMode?n=!0:"string"==typeof e&&((t=t||i.defaultEncoding)!==i.encoding&&(e=l.from(e,t),t=""),n=!0),I(this,e,t,!1,n)},A.prototype.unshift=function(e){return I(this,e,null,!0,!1)},A.prototype.isPaused=function(){return!1===this._readableState.flowing},A.prototype.setEncoding=function(e){d||(d=i(7503).s);var t=new d(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,r="";null!==n;)r+=t.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==r&&this._readableState.buffer.push(r),this._readableState.length=r.length,this};var R=1073741824;function C(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=R?e=R:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function D(e){var n=e._readableState;a("emitReadable",n.needReadable,n.emittedReadable),n.needReadable=!1,n.emittedReadable||(a("emitReadable",n.flowing),n.emittedReadable=!0,t.nextTick(k,e))}function k(e){var t=e._readableState;a("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,F(e)}function M(e,n){n.readingMore||(n.readingMore=!0,t.nextTick(L,e,n))}function L(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var n=t.length;if(a("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function P(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function N(e){a("readable nexttick read 0"),e.read(0)}function O(e,t){a("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),F(e),t.flowing&&!t.reading&&e.read(0)}function F(e){var t=e._readableState;for(a("flow",t.flowing);t.flowing&&null!==e.read(););}function U(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n);var n}function B(e){var n=e._readableState;a("endReadable",n.endEmitted),n.endEmitted||(n.ended=!0,t.nextTick(G,n,e))}function G(e,t){if(a("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var n=t._writableState;(!n||n.autoDestroy&&n.finished)&&t.destroy()}}function j(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1}A.prototype.read=function(e){a("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return a("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?B(this):D(this),null;if(0===(e=C(e,t))&&t.ended)return 0===t.length&&B(this),null;var i,r=t.needReadable;return a("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&a("length less than watermark",r=!0),t.ended||t.reading?a("reading or ended",r=!1):r&&(a("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=C(n,t))),null===(i=e>0?U(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&B(this)),null!==i&&this.emit("data",i),i},A.prototype._read=function(e){T(this,new b("_read()"))},A.prototype.pipe=function(e,n){var i=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e)}r.pipesCount+=1,a("pipe count=%d opts=%j",r.pipesCount,n);var s=n&&!1===n.end||e===t.stdout||e===t.stderr?g:l;function l(){a("onend"),e.end()}r.endEmitted?t.nextTick(s):i.once("end",s),e.on("unpipe",function t(n,o){a("onunpipe"),n===i&&o&&!1===o.hasUnpiped&&(o.hasUnpiped=!0,a("cleanup"),e.removeListener("close",h),e.removeListener("finish",p),e.removeListener("drain",u),e.removeListener("error",f),e.removeListener("unpipe",t),i.removeListener("end",l),i.removeListener("end",g),i.removeListener("data",d),c=!0,!r.awaitDrain||e._writableState&&!e._writableState.needDrain||u())});var u=function(e){return function(){var t=e._readableState;a("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&o(e,"data")&&(t.flowing=!0,F(e))}}(i);e.on("drain",u);var c=!1;function d(t){a("ondata");var n=e.write(t);a("dest.write",n),!1===n&&((1===r.pipesCount&&r.pipes===e||r.pipesCount>1&&-1!==j(r.pipes,e))&&!c&&(a("false write response, pause",r.awaitDrain),r.awaitDrain++),i.pause())}function f(t){a("onerror",t),g(),e.removeListener("error",f),0===o(e,"error")&&T(e,t)}function h(){e.removeListener("finish",p),g()}function p(){a("onfinish"),e.removeListener("close",h),g()}function g(){a("unpipe"),i.unpipe(e)}return i.on("data",d),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",f),e.once("close",h),e.once("finish",p),e.emit("pipe",i),r.flowing||(a("pipe resume"),i.resume()),e},A.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var i=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<r;a++)i[a].emit("unpipe",this,{hasUnpiped:!1});return this}var o=j(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},A.prototype.on=function(e,n){var i=s.prototype.on.call(this,e,n),r=this._readableState;return"data"===e?(r.readableListening=this.listenerCount("readable")>0,!1!==r.flowing&&this.resume()):"readable"===e&&(r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,a("on readable",r.length,r.reading),r.length?D(this):r.reading||t.nextTick(N,this))),i},A.prototype.addListener=A.prototype.on,A.prototype.removeListener=function(e,n){var i=s.prototype.removeListener.call(this,e,n);return"readable"===e&&t.nextTick(P,this),i},A.prototype.removeAllListeners=function(e){var n=s.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||t.nextTick(P,this),n},A.prototype.resume=function(){var e=this._readableState;return e.flowing||(a("resume"),e.flowing=!e.readableListening,function(e,n){n.resumeScheduled||(n.resumeScheduled=!0,t.nextTick(O,e,n))}(this,e)),e.paused=!1,this},A.prototype.pause=function(){return a("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(a("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},A.prototype.wrap=function(e){var t=this,n=this._readableState,i=!1;for(var r in e.on("end",function(){if(a("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(r){a("wrapped data"),n.decoder&&(r=n.decoder.write(r)),n.objectMode&&null==r||(n.objectMode||r&&r.length)&&(t.push(r)||(i=!0,e.pause()))}),e)void 0===this[r]&&"function"==typeof e[r]&&(this[r]=function(t){return function(){return e[t].apply(e,arguments)}}(r));for(var o=0;o<S.length;o++)e.on(S[o],this.emit.bind(this,S[o]));return this._read=function(t){a("wrapped _read",t),i&&(i=!1,e.resume())},this},"function"==typeof Symbol&&(A.prototype[Symbol.asyncIterator]=function(){return void 0===f&&(f=i(7299)),f(this)}),Object.defineProperty(A.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(A.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(A.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),A._fromList=U,Object.defineProperty(A.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(A.from=function(e,t){return void 0===h&&(h=i(6233)),h(A,e,t)})},9798:function(e,t,n){"use strict";e.exports=c;var i=n(3690).q,r=i.ERR_METHOD_NOT_IMPLEMENTED,a=i.ERR_MULTIPLE_CALLBACK,o=i.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=i.ERR_TRANSFORM_WITH_LENGTH_0,l=n(6138);function u(e,t){var n=this._transformState;n.transforming=!1;var i=n.writecb;if(null===i)return this.emit("error",new a);n.writechunk=null,n.writecb=null,null!=t&&this.push(t),i(e);var r=this._readableState;r.reading=!1,(r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}function c(e){if(!(this instanceof c))return new c(e);l.call(this,e),this._transformState={afterTransform:u.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",d)}function d(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?f(this,null,null):this._flush(function(t,n){f(e,t,n)})}function f(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new s;if(e._transformState.transforming)throw new o;return e.push(null)}n(1765)(c,l),c.prototype.push=function(e,t){return this._transformState.needTransform=!1,l.prototype.push.call(this,e,t)},c.prototype._transform=function(e,t,n){n(new r("_transform()"))},c.prototype._write=function(e,t,n){var i=this._transformState;if(i.writecb=n,i.writechunk=e,i.writeencoding=t,!i.transforming){var r=this._readableState;(i.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},c.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},c.prototype._destroy=function(e,t){l.prototype._destroy.call(this,e,function(e){t(e)})}},8318:function(e,n,i){"use strict";function r(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var i=e.entry;for(e.entry=null;i;){var r=i.callback;t.pendingcb--,r(void 0),i=i.next}t.corkedRequestsFree.next=e}(t,e)}}var a;e.exports=A,A.WritableState=w;var o,s={deprecate:i(7839)},l=i(9299),u=i(1549).Buffer,c=i.g.Uint8Array||function(){},d=i(6163),f=i(7269).getHighWaterMark,h=i(3690).q,p=h.ERR_INVALID_ARG_TYPE,g=h.ERR_METHOD_NOT_IMPLEMENTED,m=h.ERR_MULTIPLE_CALLBACK,v=h.ERR_STREAM_CANNOT_PIPE,y=h.ERR_STREAM_DESTROYED,_=h.ERR_STREAM_NULL_VALUES,b=h.ERR_STREAM_WRITE_AFTER_END,E=h.ERR_UNKNOWN_ENCODING,T=d.errorOrDestroy;function S(){}function w(e,n,o){a=a||i(6138),e=e||{},"boolean"!=typeof o&&(o=n instanceof a),this.objectMode=!!e.objectMode,o&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=f(this,e,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=!1===e.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,n){var i=e._writableState,r=i.sync,a=i.writecb;if("function"!=typeof a)throw new m;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(i),n)!function(e,n,i,r,a){--n.pendingcb,i?(t.nextTick(a,r),t.nextTick(k,e,n),e._writableState.errorEmitted=!0,T(e,r)):(a(r),e._writableState.errorEmitted=!0,T(e,r),k(e,n))}(e,i,r,n,a);else{var o=C(i)||e.destroyed;o||i.corked||i.bufferProcessing||!i.bufferedRequest||R(e,i),r?t.nextTick(x,e,i,o,a):x(e,i,o,a)}}(n,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new r(this)}function A(e){var t=this instanceof(a=a||i(6138));if(!t&&!o.call(A,this))return new A(e);this._writableState=new w(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),l.call(this)}function I(e,t,n,i,r,a,o){t.writelen=i,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new y("write")):n?e._writev(r,t.onwrite):e._write(r,a,t.onwrite),t.sync=!1}function x(e,t,n,i){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,i(),k(e,t)}function R(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var i=t.bufferedRequestCount,a=new Array(i),o=t.corkedRequestsFree;o.entry=n;for(var s=0,l=!0;n;)a[s]=n,n.isBuf||(l=!1),n=n.next,s+=1;a.allBuffers=l,I(e,t,!0,t.length,a,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new r(t),t.bufferedRequestCount=0}else{for(;n;){var u=n.chunk,c=n.encoding,d=n.callback;if(I(e,t,!1,t.objectMode?1:u.length,u,c,d),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function C(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function D(e,t){e._final(function(n){t.pendingcb--,n&&T(e,n),t.prefinished=!0,e.emit("prefinish"),k(e,t)})}function k(e,n){var i=C(n);if(i&&(function(e,n){n.prefinished||n.finalCalled||("function"!=typeof e._final||n.destroyed?(n.prefinished=!0,e.emit("prefinish")):(n.pendingcb++,n.finalCalled=!0,t.nextTick(D,e,n)))}(e,n),0===n.pendingcb&&(n.finished=!0,e.emit("finish"),n.autoDestroy))){var r=e._readableState;(!r||r.autoDestroy&&r.endEmitted)&&e.destroy()}return i}i(1765)(A,l),w.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(w.prototype,"buffer",{get:s.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(o=Function.prototype[Symbol.hasInstance],Object.defineProperty(A,Symbol.hasInstance,{value:function(e){return!!o.call(this,e)||this===A&&e&&e._writableState instanceof w}})):o=function(e){return e instanceof this},A.prototype.pipe=function(){T(this,new v)},A.prototype.write=function(e,n,i){var r,a=this._writableState,o=!1,s=!a.objectMode&&(r=e,u.isBuffer(r)||r instanceof c);return s&&!u.isBuffer(e)&&(e=function(e){return u.from(e)}(e)),"function"==typeof n&&(i=n,n=null),s?n="buffer":n||(n=a.defaultEncoding),"function"!=typeof i&&(i=S),a.ending?function(e,n){var i=new b;T(e,i),t.nextTick(n,i)}(this,i):(s||function(e,n,i,r){var a;return null===i?a=new _:"string"==typeof i||n.objectMode||(a=new p("chunk",["string","Buffer"],i)),!a||(T(e,a),t.nextTick(r,a),!1)}(this,a,e,i))&&(a.pendingcb++,o=function(e,t,n,i,r,a){if(!n){var o=function(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=u.from(t,n)),t}(t,i,r);i!==o&&(n=!0,r="buffer",i=o)}var s=t.objectMode?1:i.length;t.length+=s;var l=t.length<t.highWaterMark;if(l||(t.needDrain=!0),t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:r,isBuf:n,callback:a,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else I(e,t,!1,s,i,r,a);return l}(this,a,s,e,n,i)),o},A.prototype.cork=function(){this._writableState.corked++},A.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||R(this,e))},A.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new E(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(A.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(A.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),A.prototype._write=function(e,t,n){n(new g("_write()"))},A.prototype._writev=null,A.prototype.end=function(e,n,i){var r=this._writableState;return"function"==typeof e?(i=e,e=null,n=null):"function"==typeof n&&(i=n,n=null),null!=e&&this.write(e,n),r.corked&&(r.corked=1,this.uncork()),r.ending||function(e,n,i){n.ending=!0,k(e,n),i&&(n.finished?t.nextTick(i):e.once("finish",i)),n.ended=!0,e.writable=!1}(this,r,i),this},Object.defineProperty(A.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),A.prototype.destroy=d.destroy,A.prototype._undestroy=d.undestroy,A.prototype._destroy=function(e,t){t(e)}},7299:function(e,n,i){"use strict";var r;function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=i(8800),s=Symbol("lastResolve"),l=Symbol("lastReject"),u=Symbol("error"),c=Symbol("ended"),d=Symbol("lastPromise"),f=Symbol("handlePromise"),h=Symbol("stream");function p(e,t){return{value:e,done:t}}function g(e){var t=e[s];if(null!==t){var n=e[h].read();null!==n&&(e[d]=null,e[s]=null,e[l]=null,t(p(n,!1)))}}function m(e){t.nextTick(g,e)}var v=Object.getPrototypeOf(function(){}),y=Object.setPrototypeOf((a(r={get stream(){return this[h]},next:function(){var e=this,n=this[u];if(null!==n)return Promise.reject(n);if(this[c])return Promise.resolve(p(void 0,!0));if(this[h].destroyed)return new Promise(function(n,i){t.nextTick(function(){e[u]?i(e[u]):n(p(void 0,!0))})});var i,r=this[d];if(r)i=new Promise(function(e,t){return function(n,i){e.then(function(){t[c]?n(p(void 0,!0)):t[f](n,i)},i)}}(r,this));else{var a=this[h].read();if(null!==a)return Promise.resolve(p(a,!1));i=new Promise(this[f])}return this[d]=i,i}},Symbol.asyncIterator,function(){return this}),a(r,"return",function(){var e=this;return new Promise(function(t,n){e[h].destroy(null,function(e){e?n(e):t(p(void 0,!0))})})}),r),v);e.exports=function(e){var t,n=Object.create(y,(a(t={},h,{value:e,writable:!0}),a(t,s,{value:null,writable:!0}),a(t,l,{value:null,writable:!0}),a(t,u,{value:null,writable:!0}),a(t,c,{value:e._readableState.endEmitted,writable:!0}),a(t,f,{value:function(e,t){var i=n[h].read();i?(n[d]=null,n[s]=null,n[l]=null,e(p(i,!1))):(n[s]=e,n[l]=t)},writable:!0}),t));return n[d]=null,o(e,function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=n[l];return null!==t&&(n[d]=null,n[s]=null,n[l]=null,t(e)),void(n[u]=e)}var i=n[s];null!==i&&(n[d]=null,n[s]=null,n[l]=null,i(p(void 0,!0))),n[c]=!0}),e.on("readable",m.bind(null,n)),n}},8393:function(e,t,n){"use strict";function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=n(1549).Buffer,s=n(9862).inspect,l=s&&s.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,n;return t=e,n=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n}},{key:"concat",value:function(e){if(0===this.length)return o.alloc(0);for(var t,n,i,r=o.allocUnsafe(e>>>0),a=this.head,s=0;a;)t=a.data,n=r,i=s,o.prototype.copy.call(t,n,i),s+=a.data.length,a=a.next;return r}},{key:"consume",value:function(e,t){var n;return e<this.head.data.length?(n=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):n=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,n=1,i=t.data;for(e-=i.length;t=t.next;){var r=t.data,a=e>r.length?r.length:e;if(a===r.length?i+=r:i+=r.slice(0,e),0==(e-=a)){a===r.length?(++n,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=r.slice(a));break}++n}return this.length-=n,i}},{key:"_getBuffer",value:function(e){var t=o.allocUnsafe(e),n=this.head,i=1;for(n.data.copy(t),e-=n.data.length;n=n.next;){var r=n.data,a=e>r.length?r.length:e;if(r.copy(t,t.length-e,0,a),0==(e-=a)){a===r.length?(++i,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=r.slice(a));break}++i}return this.length-=i,t}},{key:l,value:function(e,t){return s(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){r(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},t,{depth:0,customInspect:!1}))}}],n&&a(t.prototype,n),e}()},6163:function(e){"use strict";function n(e,t){r(e,t),i(e)}function i(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function r(e,t){e.emit("error",t)}e.exports={destroy:function(e,a){var o=this,s=this._readableState&&this._readableState.destroyed,l=this._writableState&&this._writableState.destroyed;return s||l?(a?a(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,t.nextTick(r,this,e)):t.nextTick(r,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!a&&e?o._writableState?o._writableState.errorEmitted?t.nextTick(i,o):(o._writableState.errorEmitted=!0,t.nextTick(n,o,e)):t.nextTick(n,o,e):a?(t.nextTick(i,o),a(e)):t.nextTick(i,o)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var n=e._readableState,i=e._writableState;n&&n.autoDestroy||i&&i.autoDestroy?e.destroy(t):e.emit("error",t)}}},8800:function(e,t,n){"use strict";var i=n(3690).q.ERR_STREAM_PREMATURE_CLOSE;function r(){}e.exports=function e(t,n,a){if("function"==typeof n)return e(t,null,n);n||(n={}),a=function(e){var t=!1;return function(){if(!t){t=!0;for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];e.apply(this,i)}}}(a||r);var o=n.readable||!1!==n.readable&&t.readable,s=n.writable||!1!==n.writable&&t.writable,l=function(){t.writable||c()},u=t._writableState&&t._writableState.finished,c=function(){s=!1,u=!0,o||a.call(t)},d=t._readableState&&t._readableState.endEmitted,f=function(){o=!1,d=!0,s||a.call(t)},h=function(e){a.call(t,e)},p=function(){var e;return o&&!d?(t._readableState&&t._readableState.ended||(e=new i),a.call(t,e)):s&&!u?(t._writableState&&t._writableState.ended||(e=new i),a.call(t,e)):void 0},g=function(){t.req.on("finish",c)};return function(e){return e.setHeader&&"function"==typeof e.abort}(t)?(t.on("complete",c),t.on("abort",p),t.req?g():t.on("request",g)):s&&!t._writableState&&(t.on("end",l),t.on("close",l)),t.on("end",f),t.on("finish",c),!1!==n.error&&t.on("error",h),t.on("close",p),function(){t.removeListener("complete",c),t.removeListener("abort",p),t.removeListener("request",g),t.req&&t.req.removeListener("finish",c),t.removeListener("end",l),t.removeListener("close",l),t.removeListener("finish",c),t.removeListener("end",f),t.removeListener("error",h),t.removeListener("close",p)}}},6233:function(e){e.exports=function(){throw new Error("Readable.from is not available in the browser")}},7295:function(e,t,n){"use strict";var i,r=n(3690).q,a=r.ERR_MISSING_ARGS,o=r.ERR_STREAM_DESTROYED;function s(e){if(e)throw e}function l(e,t,r,a){a=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(a);var s=!1;e.on("close",function(){s=!0}),void 0===i&&(i=n(8800)),i(e,{readable:t,writable:r},function(e){if(e)return a(e);s=!0,a()});var l=!1;return function(t){if(!s&&!l)return l=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void a(t||new o("pipe"))}}function u(e){e()}function c(e,t){return e.pipe(t)}function d(e){return e.length?"function"!=typeof e[e.length-1]?s:e.pop():s}e.exports=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i,r=d(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new a("streams");var o=t.map(function(e,n){var a=n<t.length-1;return l(e,a,n>0,function(e){i||(i=e),e&&o.forEach(u),a||(o.forEach(u),r(i))})});return t.reduce(c)}},7269:function(e,t,n){"use strict";var i=n(3690).q.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,n,r){var a=function(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}(t,r,n);if(null!=a){if(!isFinite(a)||Math.floor(a)!==a||a<0)throw new i(r?n:"highWaterMark",a);return Math.floor(a)}return e.objectMode?16:16384}}},9299:function(e,t,n){e.exports=n(1159).EventEmitter},7503:function(e,t,n){"use strict";var i=n(8387).Buffer,r=i.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(i.isEncoding===r||!r(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=u,t=4;break;case"utf8":this.fillLast=s,t=4;break;case"base64":this.text=c,this.end=d,t=3;break;default:return this.write=f,void(this.end=h)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(t)}function o(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function s(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var i=n.charCodeAt(n.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function u(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function c(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function d(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function f(e){return e.toString(this.encoding)}function h(e){return e&&e.length?this.write(e):""}t.s=a,a.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},a.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},a.prototype.text=function(e,t){var n=function(e,t,n){var i=t.length-1;if(i<n)return 0;var r=o(t[i]);return r>=0?(r>0&&(e.lastNeed=r-1),r):--i<n||-2===r?0:(r=o(t[i]))>=0?(r>0&&(e.lastNeed=r-2),r):--i<n||-2===r?0:(r=o(t[i]))>=0?(r>0&&(2===r?r=0:e.lastNeed=r-3),r):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var i=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)},a.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},1067:function(e,t,n){var i;!function(r,a){"use strict";var o="function",s="undefined",l="object",u="string",c="major",d="model",f="name",h="type",p="vendor",g="version",m="architecture",v="console",y="mobile",_="tablet",b="smarttv",E="wearable",T="embedded",S="Amazon",w="Apple",A="ASUS",I="BlackBerry",x="Browser",R="Chrome",C="Firefox",D="Google",k="Huawei",M="LG",L="Microsoft",P="Motorola",N="Opera",O="Samsung",F="Sharp",U="Sony",B="Xiaomi",G="Zebra",j="Facebook",V="Chromium OS",H="Mac OS",K=function(e){for(var t={},n=0;n<e.length;n++)t[e[n].toUpperCase()]=e[n];return t},z=function(e,t){return typeof e===u&&-1!==Z(t).indexOf(Z(e))},Z=function(e){return e.toLowerCase()},q=function(e,t){if(typeof e===u)return e=e.replace(/^\s\s*/,""),typeof t===s?e:e.substring(0,500)},Y=function(e,t){for(var n,i,r,s,u,c,d=0;d<t.length&&!u;){var f=t[d],h=t[d+1];for(n=i=0;n<f.length&&!u&&f[n];)if(u=f[n++].exec(e))for(r=0;r<h.length;r++)c=u[++i],typeof(s=h[r])===l&&s.length>0?2===s.length?typeof s[1]==o?this[s[0]]=s[1].call(this,c):this[s[0]]=s[1]:3===s.length?typeof s[1]!==o||s[1].exec&&s[1].test?this[s[0]]=c?c.replace(s[1],s[2]):a:this[s[0]]=c?s[1].call(this,c,s[2]):a:4===s.length&&(this[s[0]]=c?s[3].call(this,c.replace(s[1],s[2])):a):this[s]=c||a;d+=2}},W=function(e,t){for(var n in t)if(typeof t[n]===l&&t[n].length>0){for(var i=0;i<t[n].length;i++)if(z(t[n][i],e))return"?"===n?a:n}else if(z(t[n],e))return"?"===n?a:n;return e},$={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},X={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[g,[f,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[g,[f,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[f,g],[/opios[\/ ]+([\w\.]+)/i],[g,[f,N+" Mini"]],[/\bopr\/([\w\.]+)/i],[g,[f,N]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[g,[f,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[f,g],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[g,[f,"UC"+x]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[g,[f,"WeChat"]],[/konqueror\/([\w\.]+)/i],[g,[f,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[g,[f,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[g,[f,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[g,[f,"Smart Lenovo "+x]],[/(avast|avg)\/([\w\.]+)/i],[[f,/(.+)/,"$1 Secure "+x],g],[/\bfocus\/([\w\.]+)/i],[g,[f,C+" Focus"]],[/\bopt\/([\w\.]+)/i],[g,[f,N+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[g,[f,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[g,[f,"Dolphin"]],[/coast\/([\w\.]+)/i],[g,[f,N+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[g,[f,"MIUI "+x]],[/fxios\/([-\w\.]+)/i],[g,[f,C]],[/\bqihu|(qi?ho?o?|360)browser/i],[[f,"360 "+x]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[f,/(.+)/,"$1 "+x],g],[/samsungbrowser\/([\w\.]+)/i],[g,[f,O+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[f,/_/g," "],g],[/metasr[\/ ]?([\d\.]+)/i],[g,[f,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[f,"Sogou Mobile"],g],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[f,g],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[f],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[f,j],g],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[f,g],[/\bgsa\/([\w\.]+) .*safari\//i],[g,[f,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[g,[f,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[g,[f,R+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[f,R+" WebView"],g],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[g,[f,"Android "+x]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[f,g],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[g,[f,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[g,f],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[f,[g,W,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[f,g],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[f,"Netscape"],g],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[g,[f,C+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[f,g],[/(cobalt)\/([\w\.]+)/i],[f,[g,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[m,"amd64"]],[/(ia32(?=;))/i],[[m,Z]],[/((?:i[346]|x)86)[;\)]/i],[[m,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[m,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[m,"armhf"]],[/windows (ce|mobile); ppc;/i],[[m,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[m,/ower/,"",Z]],[/(sun4\w)[;\)]/i],[[m,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[m,Z]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[d,[p,O],[h,_]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[d,[p,O],[h,y]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[d,[p,w],[h,y]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[d,[p,w],[h,_]],[/(macintosh);/i],[d,[p,w]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[d,[p,F],[h,y]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[d,[p,k],[h,_]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[d,[p,k],[h,y]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[d,/_/g," "],[p,B],[h,y]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[d,/_/g," "],[p,B],[h,_]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[d,[p,"OPPO"],[h,y]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[d,[p,"Vivo"],[h,y]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[d,[p,"Realme"],[h,y]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[d,[p,P],[h,y]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[d,[p,P],[h,_]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[d,[p,M],[h,_]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[d,[p,M],[h,y]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[d,[p,"Lenovo"],[h,_]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[d,/_/g," "],[p,"Nokia"],[h,y]],[/(pixel c)\b/i],[d,[p,D],[h,_]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[d,[p,D],[h,y]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[d,[p,U],[h,y]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[d,"Xperia Tablet"],[p,U],[h,_]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[d,[p,"OnePlus"],[h,y]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[d,[p,S],[h,_]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[d,/(.+)/g,"Fire Phone $1"],[p,S],[h,y]],[/(playbook);[-\w\),; ]+(rim)/i],[d,p,[h,_]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[d,[p,I],[h,y]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[d,[p,A],[h,_]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[d,[p,A],[h,y]],[/(nexus 9)/i],[d,[p,"HTC"],[h,_]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[p,[d,/_/g," "],[h,y]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[d,[p,"Acer"],[h,_]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[d,[p,"Meizu"],[h,y]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[d,[p,"Ulefone"],[h,y]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[p,d,[h,y]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[p,d,[h,_]],[/(surface duo)/i],[d,[p,L],[h,_]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[d,[p,"Fairphone"],[h,y]],[/(u304aa)/i],[d,[p,"AT&T"],[h,y]],[/\bsie-(\w*)/i],[d,[p,"Siemens"],[h,y]],[/\b(rct\w+) b/i],[d,[p,"RCA"],[h,_]],[/\b(venue[\d ]{2,7}) b/i],[d,[p,"Dell"],[h,_]],[/\b(q(?:mv|ta)\w+) b/i],[d,[p,"Verizon"],[h,_]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[d,[p,"Barnes & Noble"],[h,_]],[/\b(tm\d{3}\w+) b/i],[d,[p,"NuVision"],[h,_]],[/\b(k88) b/i],[d,[p,"ZTE"],[h,_]],[/\b(nx\d{3}j) b/i],[d,[p,"ZTE"],[h,y]],[/\b(gen\d{3}) b.+49h/i],[d,[p,"Swiss"],[h,y]],[/\b(zur\d{3}) b/i],[d,[p,"Swiss"],[h,_]],[/\b((zeki)?tb.*\b) b/i],[d,[p,"Zeki"],[h,_]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[p,"Dragon Touch"],d,[h,_]],[/\b(ns-?\w{0,9}) b/i],[d,[p,"Insignia"],[h,_]],[/\b((nxa|next)-?\w{0,9}) b/i],[d,[p,"NextBook"],[h,_]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[p,"Voice"],d,[h,y]],[/\b(lvtel\-)?(v1[12]) b/i],[[p,"LvTel"],d,[h,y]],[/\b(ph-1) /i],[d,[p,"Essential"],[h,y]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[d,[p,"Envizen"],[h,_]],[/\b(trio[-\w\. ]+) b/i],[d,[p,"MachSpeed"],[h,_]],[/\btu_(1491) b/i],[d,[p,"Rotor"],[h,_]],[/(shield[\w ]+) b/i],[d,[p,"Nvidia"],[h,_]],[/(sprint) (\w+)/i],[p,d,[h,y]],[/(kin\.[onetw]{3})/i],[[d,/\./g," "],[p,L],[h,y]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[d,[p,G],[h,_]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[d,[p,G],[h,y]],[/smart-tv.+(samsung)/i],[p,[h,b]],[/hbbtv.+maple;(\d+)/i],[[d,/^/,"SmartTV"],[p,O],[h,b]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[p,M],[h,b]],[/(apple) ?tv/i],[p,[d,w+" TV"],[h,b]],[/crkey/i],[[d,R+"cast"],[p,D],[h,b]],[/droid.+aft(\w+)( bui|\))/i],[d,[p,S],[h,b]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[d,[p,F],[h,b]],[/(bravia[\w ]+)( bui|\))/i],[d,[p,U],[h,b]],[/(mitv-\w{5}) bui/i],[d,[p,B],[h,b]],[/Hbbtv.*(technisat) (.*);/i],[p,d,[h,b]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[p,q],[d,q],[h,b]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[h,b]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[p,d,[h,v]],[/droid.+; (shield) bui/i],[d,[p,"Nvidia"],[h,v]],[/(playstation [345portablevi]+)/i],[d,[p,U],[h,v]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[d,[p,L],[h,v]],[/((pebble))app/i],[p,d,[h,E]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[d,[p,w],[h,E]],[/droid.+; (glass) \d/i],[d,[p,D],[h,E]],[/droid.+; (wt63?0{2,3})\)/i],[d,[p,G],[h,E]],[/(quest( 2| pro)?)/i],[d,[p,j],[h,E]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[p,[h,T]],[/(aeobc)\b/i],[d,[p,S],[h,T]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[d,[h,y]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[d,[h,_]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[h,_]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[h,y]],[/(android[-\w\. ]{0,9});.+buil/i],[d,[p,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[g,[f,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[g,[f,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[f,g],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[g,f]],os:[[/microsoft (windows) (vista|xp)/i],[f,g],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[f,[g,W,$]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[g,W,$],[f,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[g,/_/g,"."],[f,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[f,H],[g,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[g,f],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[f,g],[/\(bb(10);/i],[g,[f,I]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[g,[f,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[g,[f,C+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[g,[f,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[g,[f,"watchOS"]],[/crkey\/([\d\.]+)/i],[g,[f,R+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[f,V],g],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[f,g],[/(sunos) ?([\w\.\d]*)/i],[[f,"Solaris"],g],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[f,g]]},Q=function(e,t){if(typeof e===l&&(t=e,e=a),!(this instanceof Q))return new Q(e,t).getResult();var n=typeof r!==s&&r.navigator?r.navigator:a,i=e||(n&&n.userAgent?n.userAgent:""),v=n&&n.userAgentData?n.userAgentData:a,b=t?function(e,t){var n={};for(var i in e)t[i]&&t[i].length%2==0?n[i]=t[i].concat(e[i]):n[i]=e[i];return n}(X,t):X,E=n&&n.userAgent==i;return this.getBrowser=function(){var e,t={};return t[f]=a,t[g]=a,Y.call(t,i,b.browser),t[c]=typeof(e=t[g])===u?e.replace(/[^\d\.]/g,"").split(".")[0]:a,E&&n&&n.brave&&typeof n.brave.isBrave==o&&(t[f]="Brave"),t},this.getCPU=function(){var e={};return e[m]=a,Y.call(e,i,b.cpu),e},this.getDevice=function(){var e={};return e[p]=a,e[d]=a,e[h]=a,Y.call(e,i,b.device),E&&!e[h]&&v&&v.mobile&&(e[h]=y),E&&"Macintosh"==e[d]&&n&&typeof n.standalone!==s&&n.maxTouchPoints&&n.maxTouchPoints>2&&(e[d]="iPad",e[h]=_),e},this.getEngine=function(){var e={};return e[f]=a,e[g]=a,Y.call(e,i,b.engine),e},this.getOS=function(){var e={};return e[f]=a,e[g]=a,Y.call(e,i,b.os),E&&!e[f]&&v&&"Unknown"!=v.platform&&(e[f]=v.platform.replace(/chrome os/i,V).replace(/macos/i,H)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i=typeof e===u&&e.length>500?q(e,500):e,this},this.setUA(i),this};Q.VERSION="1.0.37",Q.BROWSER=K([f,g,c]),Q.CPU=K([m]),Q.DEVICE=K([d,p,h,v,y,b,_,E,T]),Q.ENGINE=Q.OS=K([f,g]),typeof t!==s?(e.exports&&(t=e.exports=Q),t.UAParser=Q):n.amdO?(i=function(){return Q}.call(t,n,t,e))===a||(e.exports=i):typeof r!==s&&(r.UAParser=Q);var J=typeof r!==s&&(r.jQuery||r.Zepto);if(J&&!J.ua){var ee=new Q;J.ua=ee.getResult(),J.ua.get=function(){return ee.getUA()},J.ua.set=function(e){ee.setUA(e);var t=ee.getResult();for(var n in t)J.ua[n]=t[n]}}}("object"==typeof window?window:this)},7839:function(e,t,n){function i(e){try{if(!n.g.localStorage)return!1}catch(e){return!1}var t=n.g.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}e.exports=function(e,t){if(i("noDeprecation"))return e;var n=!1;return function(){if(!n){if(i("throwDeprecation"))throw new Error(t);i("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}}},9862:function(){},964:function(){},3165:function(e){"use strict";e.exports=JSON.parse('["mni-beng-in","mni-mtei-in","sat-deva-in","sat-olck-in","shi-latn-ma","shi-tfng-ma","vai-latn-lr","vai-vaii-lr","yue-hans-cn","yue-hant-hk","az-arab-ir","az-cyrl-az","az-latn-az","bm-nkoo-ml","bs-cyrl-ba","bs-latn-ba","en-dsrt-us","ff-adlm-gn","ff-latn-sn","ha-arab-ng","hi-latn-in","iu-latn-ca","ks-arab-in","ks-deva-in","mn-mong-cn","ms-arab-my","pa-arab-pk","pa-guru-in","sd-arab-pk","sd-deva-in","sr-cyrl-rs","sr-latn-rs","su-latn-id","uz-arab-af","uz-cyrl-uz","uz-latn-uz","zh-hans-cn","zh-hant-tw","mni-beng","sat-olck","shi-tfng","vai-vaii","yue-hant","az-latn","bs-latn","ff-latn","jbo-001","ks-arab","pa-guru","prg-001","sd-arab","sr-cyrl","su-latn","uz-latn","zh-hans","agq-cm","ar-001","arn-cl","asa-tz","ast-es","bas-cm","bem-zm","bez-tz","bgn-pk","blt-vn","brx-in","bss-cm","byn-er","cad-us","cch-ng","ccp-bd","ceb-ph","cgg-ug","chr-us","cic-us","ckb-iq","dav-ke","dje-ne","doi-in","dsb-de","dua-cm","dyo-sn","ebu-ke","eo-001","ewo-cm","fil-ph","fur-it","gaa-gh","gez-et","gsw-ch","guz-ke","haw-us","hsb-de","ia-001","ife-tg","io-001","jgo-cm","jmc-tz","kab-dz","kaj-ng","kam-ke","kcg-ng","kde-tz","kea-cv","ken-cm","khq-ml","kkj-cm","kln-ke","kok-in","kpe-lr","ksb-tz","ksf-cm","ksh-de","lag-tz","lkt-us","lrc-ir","luo-ke","luy-ke","mai-in","mas-ke","mer-ke","mfe-mu","mgh-mz","mgo-cm","moh-ca","mua-cm","mus-us","myv-ru","mzn-ir","naq-na","nds-de","nmg-cm","nnh-cm","nqo-gn","nso-za","nus-ss","nyn-ug","osa-us","pcm-ng","quc-gt","rof-tz","rwk-tz","sah-ru","saq-ke","sbp-tz","scn-it","sdh-ir","seh-mz","ses-ml","sid-et","sma-se","smj-se","smn-fi","sms-fi","ssy-er","syr-iq","szl-pl","teo-ug","tig-er","trv-tw","trw-pk","twq-ne","tzm-ma","vo-001","vun-tz","wae-ch","wal-et","wbp-au","xog-ug","yav-cm","yi-001","zgh-ma","aa-et","af-za","ak-gh","am-et","an-es","as-in","ba-ru","be-by","bg-bg","bm-ml","bn-bd","bo-cn","br-fr","ca-es","ce-ru","co-fr","cs-cz","cu-ru","cv-ru","cy-gb","da-dk","de-de","dv-mv","dz-bt","ee-gh","el-gr","en-us","es-es","et-ee","eu-es","fa-ir","fi-fi","fo-fo","fr-fr","fy-nl","ga-ie","gd-gb","gl-es","gn-py","gu-in","gv-im","ha-ng","he-il","hi-in","hr-hr","hu-hu","hy-am","id-id","ig-ng","ii-cn","is-is","it-it","iu-ca","ja-jp","jv-id","ka-ge","ki-ke","kk-kz","kl-gl","km-kh","kn-in","ko-kr","ku-tr","kw-gb","ky-kg","lb-lu","lg-ug","ln-cd","lo-la","lt-lt","lu-cd","lv-lv","mg-mg","mi-nz","mk-mk","ml-in","mn-mn","mr-in","ms-my","mt-mt","my-mm","nb-no","nd-zw","ne-np","nl-nl","nn-no","nr-za","nv-us","ny-mw","oc-fr","om-et","or-in","os-ge","pl-pl","ps-af","pt-br","qu-pe","rm-ch","rn-bi","ro-ro","ru-ru","rw-rw","sa-in","sc-it","se-no","sg-cf","si-lk","sk-sk","sl-si","sn-zw","so-so","sq-al","ss-za","st-za","sv-se","sw-tz","ta-in","te-in","tg-tj","th-th","ti-et","tk-tm","tn-za","to-to","tr-tr","ts-za","tt-ru","ug-cn","uk-ua","ur-pk","ve-za","vi-vn","wa-be","wo-sn","xh-za","yo-ng","zu-za"]')},5813:function(e){"use strict";e.exports=JSON.parse('[{"from":{"field":"script","value":"qaai"},"to":{"field":"script","value":"zinh"}},{"from":{"field":"region","value":"bu"},"to":{"field":"region","value":"mm"}},{"from":{"field":"region","value":"ct"},"to":{"field":"region","value":"ki"}},{"from":{"field":"region","value":"dd"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"dy"},"to":{"field":"region","value":"bj"}},{"from":{"field":"region","value":"fx"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"hv"},"to":{"field":"region","value":"bf"}},{"from":{"field":"region","value":"jt"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"mi"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"nh"},"to":{"field":"region","value":"vu"}},{"from":{"field":"region","value":"nq"},"to":{"field":"region","value":"aq"}},{"from":{"field":"region","value":"pu"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"pz"},"to":{"field":"region","value":"pa"}},{"from":{"field":"region","value":"qu"},"to":{"field":"region","value":"eu"}},{"from":{"field":"region","value":"rh"},"to":{"field":"region","value":"zw"}},{"from":{"field":"region","value":"tp"},"to":{"field":"region","value":"tl"}},{"from":{"field":"region","value":"uk"},"to":{"field":"region","value":"gb"}},{"from":{"field":"region","value":"vd"},"to":{"field":"region","value":"vn"}},{"from":{"field":"region","value":"wk"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"yd"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"zr"},"to":{"field":"region","value":"cd"}},{"from":{"field":"region","value":"230"},"to":{"field":"region","value":"et"}},{"from":{"field":"region","value":"280"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"736"},"to":{"field":"region","value":"sd"}},{"from":{"field":"region","value":"886"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"958"},"to":{"field":"region","value":"aa"}},{"from":{"field":"region","value":"020"},"to":{"field":"region","value":"ad"}},{"from":{"field":"region","value":"784"},"to":{"field":"region","value":"ae"}},{"from":{"field":"region","value":"004"},"to":{"field":"region","value":"af"}},{"from":{"field":"region","value":"028"},"to":{"field":"region","value":"ag"}},{"from":{"field":"region","value":"660"},"to":{"field":"region","value":"ai"}},{"from":{"field":"region","value":"008"},"to":{"field":"region","value":"al"}},{"from":{"field":"region","value":"051"},"to":{"field":"region","value":"am"}},{"from":{"field":"region","value":"024"},"to":{"field":"region","value":"ao"}},{"from":{"field":"region","value":"010"},"to":{"field":"region","value":"aq"}},{"from":{"field":"region","value":"032"},"to":{"field":"region","value":"ar"}},{"from":{"field":"region","value":"016"},"to":{"field":"region","value":"as"}},{"from":{"field":"region","value":"040"},"to":{"field":"region","value":"at"}},{"from":{"field":"region","value":"036"},"to":{"field":"region","value":"au"}},{"from":{"field":"region","value":"533"},"to":{"field":"region","value":"aw"}},{"from":{"field":"region","value":"248"},"to":{"field":"region","value":"ax"}},{"from":{"field":"region","value":"031"},"to":{"field":"region","value":"az"}},{"from":{"field":"region","value":"070"},"to":{"field":"region","value":"ba"}},{"from":{"field":"region","value":"052"},"to":{"field":"region","value":"bb"}},{"from":{"field":"region","value":"050"},"to":{"field":"region","value":"bd"}},{"from":{"field":"region","value":"056"},"to":{"field":"region","value":"be"}},{"from":{"field":"region","value":"854"},"to":{"field":"region","value":"bf"}},{"from":{"field":"region","value":"100"},"to":{"field":"region","value":"bg"}},{"from":{"field":"region","value":"048"},"to":{"field":"region","value":"bh"}},{"from":{"field":"region","value":"108"},"to":{"field":"region","value":"bi"}},{"from":{"field":"region","value":"204"},"to":{"field":"region","value":"bj"}},{"from":{"field":"region","value":"652"},"to":{"field":"region","value":"bl"}},{"from":{"field":"region","value":"060"},"to":{"field":"region","value":"bm"}},{"from":{"field":"region","value":"096"},"to":{"field":"region","value":"bn"}},{"from":{"field":"region","value":"068"},"to":{"field":"region","value":"bo"}},{"from":{"field":"region","value":"535"},"to":{"field":"region","value":"bq"}},{"from":{"field":"region","value":"076"},"to":{"field":"region","value":"br"}},{"from":{"field":"region","value":"044"},"to":{"field":"region","value":"bs"}},{"from":{"field":"region","value":"064"},"to":{"field":"region","value":"bt"}},{"from":{"field":"region","value":"104"},"to":{"field":"region","value":"mm"}},{"from":{"field":"region","value":"074"},"to":{"field":"region","value":"bv"}},{"from":{"field":"region","value":"072"},"to":{"field":"region","value":"bw"}},{"from":{"field":"region","value":"112"},"to":{"field":"region","value":"by"}},{"from":{"field":"region","value":"084"},"to":{"field":"region","value":"bz"}},{"from":{"field":"region","value":"124"},"to":{"field":"region","value":"ca"}},{"from":{"field":"region","value":"166"},"to":{"field":"region","value":"cc"}},{"from":{"field":"region","value":"180"},"to":{"field":"region","value":"cd"}},{"from":{"field":"region","value":"140"},"to":{"field":"region","value":"cf"}},{"from":{"field":"region","value":"178"},"to":{"field":"region","value":"cg"}},{"from":{"field":"region","value":"756"},"to":{"field":"region","value":"ch"}},{"from":{"field":"region","value":"384"},"to":{"field":"region","value":"ci"}},{"from":{"field":"region","value":"184"},"to":{"field":"region","value":"ck"}},{"from":{"field":"region","value":"152"},"to":{"field":"region","value":"cl"}},{"from":{"field":"region","value":"120"},"to":{"field":"region","value":"cm"}},{"from":{"field":"region","value":"156"},"to":{"field":"region","value":"cn"}},{"from":{"field":"region","value":"170"},"to":{"field":"region","value":"co"}},{"from":{"field":"region","value":"188"},"to":{"field":"region","value":"cr"}},{"from":{"field":"region","value":"192"},"to":{"field":"region","value":"cu"}},{"from":{"field":"region","value":"132"},"to":{"field":"region","value":"cv"}},{"from":{"field":"region","value":"531"},"to":{"field":"region","value":"cw"}},{"from":{"field":"region","value":"162"},"to":{"field":"region","value":"cx"}},{"from":{"field":"region","value":"196"},"to":{"field":"region","value":"cy"}},{"from":{"field":"region","value":"203"},"to":{"field":"region","value":"cz"}},{"from":{"field":"region","value":"278"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"276"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"262"},"to":{"field":"region","value":"dj"}},{"from":{"field":"region","value":"208"},"to":{"field":"region","value":"dk"}},{"from":{"field":"region","value":"212"},"to":{"field":"region","value":"dm"}},{"from":{"field":"region","value":"214"},"to":{"field":"region","value":"do"}},{"from":{"field":"region","value":"012"},"to":{"field":"region","value":"dz"}},{"from":{"field":"region","value":"218"},"to":{"field":"region","value":"ec"}},{"from":{"field":"region","value":"233"},"to":{"field":"region","value":"ee"}},{"from":{"field":"region","value":"818"},"to":{"field":"region","value":"eg"}},{"from":{"field":"region","value":"732"},"to":{"field":"region","value":"eh"}},{"from":{"field":"region","value":"232"},"to":{"field":"region","value":"er"}},{"from":{"field":"region","value":"724"},"to":{"field":"region","value":"es"}},{"from":{"field":"region","value":"231"},"to":{"field":"region","value":"et"}},{"from":{"field":"region","value":"246"},"to":{"field":"region","value":"fi"}},{"from":{"field":"region","value":"242"},"to":{"field":"region","value":"fj"}},{"from":{"field":"region","value":"238"},"to":{"field":"region","value":"fk"}},{"from":{"field":"region","value":"583"},"to":{"field":"region","value":"fm"}},{"from":{"field":"region","value":"234"},"to":{"field":"region","value":"fo"}},{"from":{"field":"region","value":"250"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"249"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"266"},"to":{"field":"region","value":"ga"}},{"from":{"field":"region","value":"826"},"to":{"field":"region","value":"gb"}},{"from":{"field":"region","value":"308"},"to":{"field":"region","value":"gd"}},{"from":{"field":"region","value":"268"},"to":{"field":"region","value":"ge"}},{"from":{"field":"region","value":"254"},"to":{"field":"region","value":"gf"}},{"from":{"field":"region","value":"831"},"to":{"field":"region","value":"gg"}},{"from":{"field":"region","value":"288"},"to":{"field":"region","value":"gh"}},{"from":{"field":"region","value":"292"},"to":{"field":"region","value":"gi"}},{"from":{"field":"region","value":"304"},"to":{"field":"region","value":"gl"}},{"from":{"field":"region","value":"270"},"to":{"field":"region","value":"gm"}},{"from":{"field":"region","value":"324"},"to":{"field":"region","value":"gn"}},{"from":{"field":"region","value":"312"},"to":{"field":"region","value":"gp"}},{"from":{"field":"region","value":"226"},"to":{"field":"region","value":"gq"}},{"from":{"field":"region","value":"300"},"to":{"field":"region","value":"gr"}},{"from":{"field":"region","value":"239"},"to":{"field":"region","value":"gs"}},{"from":{"field":"region","value":"320"},"to":{"field":"region","value":"gt"}},{"from":{"field":"region","value":"316"},"to":{"field":"region","value":"gu"}},{"from":{"field":"region","value":"624"},"to":{"field":"region","value":"gw"}},{"from":{"field":"region","value":"328"},"to":{"field":"region","value":"gy"}},{"from":{"field":"region","value":"344"},"to":{"field":"region","value":"hk"}},{"from":{"field":"region","value":"334"},"to":{"field":"region","value":"hm"}},{"from":{"field":"region","value":"340"},"to":{"field":"region","value":"hn"}},{"from":{"field":"region","value":"191"},"to":{"field":"region","value":"hr"}},{"from":{"field":"region","value":"332"},"to":{"field":"region","value":"ht"}},{"from":{"field":"region","value":"348"},"to":{"field":"region","value":"hu"}},{"from":{"field":"region","value":"360"},"to":{"field":"region","value":"id"}},{"from":{"field":"region","value":"372"},"to":{"field":"region","value":"ie"}},{"from":{"field":"region","value":"376"},"to":{"field":"region","value":"il"}},{"from":{"field":"region","value":"833"},"to":{"field":"region","value":"im"}},{"from":{"field":"region","value":"356"},"to":{"field":"region","value":"in"}},{"from":{"field":"region","value":"086"},"to":{"field":"region","value":"io"}},{"from":{"field":"region","value":"368"},"to":{"field":"region","value":"iq"}},{"from":{"field":"region","value":"364"},"to":{"field":"region","value":"ir"}},{"from":{"field":"region","value":"352"},"to":{"field":"region","value":"is"}},{"from":{"field":"region","value":"380"},"to":{"field":"region","value":"it"}},{"from":{"field":"region","value":"832"},"to":{"field":"region","value":"je"}},{"from":{"field":"region","value":"388"},"to":{"field":"region","value":"jm"}},{"from":{"field":"region","value":"400"},"to":{"field":"region","value":"jo"}},{"from":{"field":"region","value":"392"},"to":{"field":"region","value":"jp"}},{"from":{"field":"region","value":"404"},"to":{"field":"region","value":"ke"}},{"from":{"field":"region","value":"417"},"to":{"field":"region","value":"kg"}},{"from":{"field":"region","value":"116"},"to":{"field":"region","value":"kh"}},{"from":{"field":"region","value":"296"},"to":{"field":"region","value":"ki"}},{"from":{"field":"region","value":"174"},"to":{"field":"region","value":"km"}},{"from":{"field":"region","value":"659"},"to":{"field":"region","value":"kn"}},{"from":{"field":"region","value":"408"},"to":{"field":"region","value":"kp"}},{"from":{"field":"region","value":"410"},"to":{"field":"region","value":"kr"}},{"from":{"field":"region","value":"414"},"to":{"field":"region","value":"kw"}},{"from":{"field":"region","value":"136"},"to":{"field":"region","value":"ky"}},{"from":{"field":"region","value":"398"},"to":{"field":"region","value":"kz"}},{"from":{"field":"region","value":"418"},"to":{"field":"region","value":"la"}},{"from":{"field":"region","value":"422"},"to":{"field":"region","value":"lb"}},{"from":{"field":"region","value":"662"},"to":{"field":"region","value":"lc"}},{"from":{"field":"region","value":"438"},"to":{"field":"region","value":"li"}},{"from":{"field":"region","value":"144"},"to":{"field":"region","value":"lk"}},{"from":{"field":"region","value":"430"},"to":{"field":"region","value":"lr"}},{"from":{"field":"region","value":"426"},"to":{"field":"region","value":"ls"}},{"from":{"field":"region","value":"440"},"to":{"field":"region","value":"lt"}},{"from":{"field":"region","value":"442"},"to":{"field":"region","value":"lu"}},{"from":{"field":"region","value":"428"},"to":{"field":"region","value":"lv"}},{"from":{"field":"region","value":"434"},"to":{"field":"region","value":"ly"}},{"from":{"field":"region","value":"504"},"to":{"field":"region","value":"ma"}},{"from":{"field":"region","value":"492"},"to":{"field":"region","value":"mc"}},{"from":{"field":"region","value":"498"},"to":{"field":"region","value":"md"}},{"from":{"field":"region","value":"499"},"to":{"field":"region","value":"me"}},{"from":{"field":"region","value":"663"},"to":{"field":"region","value":"mf"}},{"from":{"field":"region","value":"450"},"to":{"field":"region","value":"mg"}},{"from":{"field":"region","value":"584"},"to":{"field":"region","value":"mh"}},{"from":{"field":"region","value":"807"},"to":{"field":"region","value":"mk"}},{"from":{"field":"region","value":"466"},"to":{"field":"region","value":"ml"}},{"from":{"field":"region","value":"496"},"to":{"field":"region","value":"mn"}},{"from":{"field":"region","value":"446"},"to":{"field":"region","value":"mo"}},{"from":{"field":"region","value":"580"},"to":{"field":"region","value":"mp"}},{"from":{"field":"region","value":"474"},"to":{"field":"region","value":"mq"}},{"from":{"field":"region","value":"478"},"to":{"field":"region","value":"mr"}},{"from":{"field":"region","value":"500"},"to":{"field":"region","value":"ms"}},{"from":{"field":"region","value":"470"},"to":{"field":"region","value":"mt"}},{"from":{"field":"region","value":"480"},"to":{"field":"region","value":"mu"}},{"from":{"field":"region","value":"462"},"to":{"field":"region","value":"mv"}},{"from":{"field":"region","value":"454"},"to":{"field":"region","value":"mw"}},{"from":{"field":"region","value":"484"},"to":{"field":"region","value":"mx"}},{"from":{"field":"region","value":"458"},"to":{"field":"region","value":"my"}},{"from":{"field":"region","value":"508"},"to":{"field":"region","value":"mz"}},{"from":{"field":"region","value":"516"},"to":{"field":"region","value":"na"}},{"from":{"field":"region","value":"540"},"to":{"field":"region","value":"nc"}},{"from":{"field":"region","value":"562"},"to":{"field":"region","value":"ne"}},{"from":{"field":"region","value":"574"},"to":{"field":"region","value":"nf"}},{"from":{"field":"region","value":"566"},"to":{"field":"region","value":"ng"}},{"from":{"field":"region","value":"558"},"to":{"field":"region","value":"ni"}},{"from":{"field":"region","value":"528"},"to":{"field":"region","value":"nl"}},{"from":{"field":"region","value":"578"},"to":{"field":"region","value":"no"}},{"from":{"field":"region","value":"524"},"to":{"field":"region","value":"np"}},{"from":{"field":"region","value":"520"},"to":{"field":"region","value":"nr"}},{"from":{"field":"region","value":"570"},"to":{"field":"region","value":"nu"}},{"from":{"field":"region","value":"554"},"to":{"field":"region","value":"nz"}},{"from":{"field":"region","value":"512"},"to":{"field":"region","value":"om"}},{"from":{"field":"region","value":"591"},"to":{"field":"region","value":"pa"}},{"from":{"field":"region","value":"604"},"to":{"field":"region","value":"pe"}},{"from":{"field":"region","value":"258"},"to":{"field":"region","value":"pf"}},{"from":{"field":"region","value":"598"},"to":{"field":"region","value":"pg"}},{"from":{"field":"region","value":"608"},"to":{"field":"region","value":"ph"}},{"from":{"field":"region","value":"586"},"to":{"field":"region","value":"pk"}},{"from":{"field":"region","value":"616"},"to":{"field":"region","value":"pl"}},{"from":{"field":"region","value":"666"},"to":{"field":"region","value":"pm"}},{"from":{"field":"region","value":"612"},"to":{"field":"region","value":"pn"}},{"from":{"field":"region","value":"630"},"to":{"field":"region","value":"pr"}},{"from":{"field":"region","value":"275"},"to":{"field":"region","value":"ps"}},{"from":{"field":"region","value":"620"},"to":{"field":"region","value":"pt"}},{"from":{"field":"region","value":"585"},"to":{"field":"region","value":"pw"}},{"from":{"field":"region","value":"600"},"to":{"field":"region","value":"py"}},{"from":{"field":"region","value":"634"},"to":{"field":"region","value":"qa"}},{"from":{"field":"region","value":"959"},"to":{"field":"region","value":"qm"}},{"from":{"field":"region","value":"960"},"to":{"field":"region","value":"qn"}},{"from":{"field":"region","value":"962"},"to":{"field":"region","value":"qp"}},{"from":{"field":"region","value":"963"},"to":{"field":"region","value":"qq"}},{"from":{"field":"region","value":"964"},"to":{"field":"region","value":"qr"}},{"from":{"field":"region","value":"965"},"to":{"field":"region","value":"qs"}},{"from":{"field":"region","value":"966"},"to":{"field":"region","value":"qt"}},{"from":{"field":"region","value":"967"},"to":{"field":"region","value":"eu"}},{"from":{"field":"region","value":"968"},"to":{"field":"region","value":"qv"}},{"from":{"field":"region","value":"969"},"to":{"field":"region","value":"qw"}},{"from":{"field":"region","value":"970"},"to":{"field":"region","value":"qx"}},{"from":{"field":"region","value":"971"},"to":{"field":"region","value":"qy"}},{"from":{"field":"region","value":"972"},"to":{"field":"region","value":"qz"}},{"from":{"field":"region","value":"638"},"to":{"field":"region","value":"re"}},{"from":{"field":"region","value":"642"},"to":{"field":"region","value":"ro"}},{"from":{"field":"region","value":"688"},"to":{"field":"region","value":"rs"}},{"from":{"field":"region","value":"643"},"to":{"field":"region","value":"ru"}},{"from":{"field":"region","value":"646"},"to":{"field":"region","value":"rw"}},{"from":{"field":"region","value":"682"},"to":{"field":"region","value":"sa"}},{"from":{"field":"region","value":"090"},"to":{"field":"region","value":"sb"}},{"from":{"field":"region","value":"690"},"to":{"field":"region","value":"sc"}},{"from":{"field":"region","value":"729"},"to":{"field":"region","value":"sd"}},{"from":{"field":"region","value":"752"},"to":{"field":"region","value":"se"}},{"from":{"field":"region","value":"702"},"to":{"field":"region","value":"sg"}},{"from":{"field":"region","value":"654"},"to":{"field":"region","value":"sh"}},{"from":{"field":"region","value":"705"},"to":{"field":"region","value":"si"}},{"from":{"field":"region","value":"744"},"to":{"field":"region","value":"sj"}},{"from":{"field":"region","value":"703"},"to":{"field":"region","value":"sk"}},{"from":{"field":"region","value":"694"},"to":{"field":"region","value":"sl"}},{"from":{"field":"region","value":"674"},"to":{"field":"region","value":"sm"}},{"from":{"field":"region","value":"686"},"to":{"field":"region","value":"sn"}},{"from":{"field":"region","value":"706"},"to":{"field":"region","value":"so"}},{"from":{"field":"region","value":"740"},"to":{"field":"region","value":"sr"}},{"from":{"field":"region","value":"728"},"to":{"field":"region","value":"ss"}},{"from":{"field":"region","value":"678"},"to":{"field":"region","value":"st"}},{"from":{"field":"region","value":"222"},"to":{"field":"region","value":"sv"}},{"from":{"field":"region","value":"534"},"to":{"field":"region","value":"sx"}},{"from":{"field":"region","value":"760"},"to":{"field":"region","value":"sy"}},{"from":{"field":"region","value":"748"},"to":{"field":"region","value":"sz"}},{"from":{"field":"region","value":"796"},"to":{"field":"region","value":"tc"}},{"from":{"field":"region","value":"148"},"to":{"field":"region","value":"td"}},{"from":{"field":"region","value":"260"},"to":{"field":"region","value":"tf"}},{"from":{"field":"region","value":"768"},"to":{"field":"region","value":"tg"}},{"from":{"field":"region","value":"764"},"to":{"field":"region","value":"th"}},{"from":{"field":"region","value":"762"},"to":{"field":"region","value":"tj"}},{"from":{"field":"region","value":"772"},"to":{"field":"region","value":"tk"}},{"from":{"field":"region","value":"626"},"to":{"field":"region","value":"tl"}},{"from":{"field":"region","value":"795"},"to":{"field":"region","value":"tm"}},{"from":{"field":"region","value":"788"},"to":{"field":"region","value":"tn"}},{"from":{"field":"region","value":"776"},"to":{"field":"region","value":"to"}},{"from":{"field":"region","value":"792"},"to":{"field":"region","value":"tr"}},{"from":{"field":"region","value":"780"},"to":{"field":"region","value":"tt"}},{"from":{"field":"region","value":"798"},"to":{"field":"region","value":"tv"}},{"from":{"field":"region","value":"158"},"to":{"field":"region","value":"tw"}},{"from":{"field":"region","value":"834"},"to":{"field":"region","value":"tz"}},{"from":{"field":"region","value":"804"},"to":{"field":"region","value":"ua"}},{"from":{"field":"region","value":"800"},"to":{"field":"region","value":"ug"}},{"from":{"field":"region","value":"581"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"840"},"to":{"field":"region","value":"us"}},{"from":{"field":"region","value":"858"},"to":{"field":"region","value":"uy"}},{"from":{"field":"region","value":"860"},"to":{"field":"region","value":"uz"}},{"from":{"field":"region","value":"336"},"to":{"field":"region","value":"va"}},{"from":{"field":"region","value":"670"},"to":{"field":"region","value":"vc"}},{"from":{"field":"region","value":"862"},"to":{"field":"region","value":"ve"}},{"from":{"field":"region","value":"092"},"to":{"field":"region","value":"vg"}},{"from":{"field":"region","value":"850"},"to":{"field":"region","value":"vi"}},{"from":{"field":"region","value":"704"},"to":{"field":"region","value":"vn"}},{"from":{"field":"region","value":"548"},"to":{"field":"region","value":"vu"}},{"from":{"field":"region","value":"876"},"to":{"field":"region","value":"wf"}},{"from":{"field":"region","value":"882"},"to":{"field":"region","value":"ws"}},{"from":{"field":"region","value":"973"},"to":{"field":"region","value":"xa"}},{"from":{"field":"region","value":"974"},"to":{"field":"region","value":"xb"}},{"from":{"field":"region","value":"975"},"to":{"field":"region","value":"xc"}},{"from":{"field":"region","value":"976"},"to":{"field":"region","value":"xd"}},{"from":{"field":"region","value":"977"},"to":{"field":"region","value":"xe"}},{"from":{"field":"region","value":"978"},"to":{"field":"region","value":"xf"}},{"from":{"field":"region","value":"979"},"to":{"field":"region","value":"xg"}},{"from":{"field":"region","value":"980"},"to":{"field":"region","value":"xh"}},{"from":{"field":"region","value":"981"},"to":{"field":"region","value":"xi"}},{"from":{"field":"region","value":"982"},"to":{"field":"region","value":"xj"}},{"from":{"field":"region","value":"983"},"to":{"field":"region","value":"xk"}},{"from":{"field":"region","value":"984"},"to":{"field":"region","value":"xl"}},{"from":{"field":"region","value":"985"},"to":{"field":"region","value":"xm"}},{"from":{"field":"region","value":"986"},"to":{"field":"region","value":"xn"}},{"from":{"field":"region","value":"987"},"to":{"field":"region","value":"xo"}},{"from":{"field":"region","value":"988"},"to":{"field":"region","value":"xp"}},{"from":{"field":"region","value":"989"},"to":{"field":"region","value":"xq"}},{"from":{"field":"region","value":"990"},"to":{"field":"region","value":"xr"}},{"from":{"field":"region","value":"991"},"to":{"field":"region","value":"xs"}},{"from":{"field":"region","value":"992"},"to":{"field":"region","value":"xt"}},{"from":{"field":"region","value":"993"},"to":{"field":"region","value":"xu"}},{"from":{"field":"region","value":"994"},"to":{"field":"region","value":"xv"}},{"from":{"field":"region","value":"995"},"to":{"field":"region","value":"xw"}},{"from":{"field":"region","value":"996"},"to":{"field":"region","value":"xx"}},{"from":{"field":"region","value":"997"},"to":{"field":"region","value":"xy"}},{"from":{"field":"region","value":"998"},"to":{"field":"region","value":"xz"}},{"from":{"field":"region","value":"720"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"887"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"175"},"to":{"field":"region","value":"yt"}},{"from":{"field":"region","value":"710"},"to":{"field":"region","value":"za"}},{"from":{"field":"region","value":"894"},"to":{"field":"region","value":"zm"}},{"from":{"field":"region","value":"716"},"to":{"field":"region","value":"zw"}},{"from":{"field":"region","value":"999"},"to":{"field":"region","value":"zz"}},{"from":{"field":"variants","value":"aaland"},"to":{"field":"region","value":"ax"}},{"from":{"field":"variants","value":"polytoni"},"to":{"field":"variants","value":"polyton"}},{"from":{"field":"variants","value":"heploc"},"to":{"field":"variants","value":"alalc97"}},{"from":{"field":"variants","value":"arevela"},"to":{"field":"language","value":"hy"}},{"from":{"field":"variants","value":"arevmda"},"to":{"field":"language","value":"hyw"}}]')},9460:function(e){"use strict";e.exports=JSON.parse('{"region":{"172":["ru","am","az","by","ge","kg","kz","md","tj","tm","ua","uz"],"200":["cz","sk"],"530":["cw","sx","bq"],"532":["cw","sx","bq"],"536":["sa","iq"],"582":["fm","mh","mp","pw"],"810":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"830":["je","gg"],"890":["rs","me","si","hr","mk","ba"],"891":["rs","me"],"an":["cw","sx","bq"],"cs":["rs","me"],"fq":["aq","tf"],"nt":["sa","iq"],"pc":["fm","mh","mp","pw"],"su":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"yu":["rs","me"],"062":["034","143"],"ant":["cw","sx","bq"],"scg":["rs","me"],"ntz":["sa","iq"],"sun":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"yug":["rs","me"]}}')},7778:function(e){"use strict";e.exports=JSON.parse('[{"from":"in","to":"id"},{"from":"iw","to":"he"},{"from":"ji","to":"yi"},{"from":"jw","to":"jv"},{"from":"mo","to":"ro"},{"from":"scc","to":"sr"},{"from":"scr","to":"hr"},{"from":"aam","to":"aas"},{"from":"adp","to":"dz"},{"from":"aue","to":"ktz"},{"from":"ayx","to":"nun"},{"from":"bgm","to":"bcg"},{"from":"bjd","to":"drl"},{"from":"ccq","to":"rki"},{"from":"cjr","to":"mom"},{"from":"cka","to":"cmr"},{"from":"cmk","to":"xch"},{"from":"coy","to":"pij"},{"from":"cqu","to":"quh"},{"from":"drh","to":"mn"},{"from":"drw","to":"fa-af"},{"from":"gav","to":"dev"},{"from":"gfx","to":"vaj"},{"from":"ggn","to":"gvr"},{"from":"gti","to":"nyc"},{"from":"guv","to":"duz"},{"from":"hrr","to":"jal"},{"from":"ibi","to":"opa"},{"from":"ilw","to":"gal"},{"from":"jeg","to":"oyb"},{"from":"kgc","to":"tdf"},{"from":"kgh","to":"kml"},{"from":"koj","to":"kwv"},{"from":"krm","to":"bmf"},{"from":"ktr","to":"dtp"},{"from":"kvs","to":"gdj"},{"from":"kwq","to":"yam"},{"from":"kxe","to":"tvd"},{"from":"kzj","to":"dtp"},{"from":"kzt","to":"dtp"},{"from":"lii","to":"raq"},{"from":"lmm","to":"rmx"},{"from":"meg","to":"cir"},{"from":"mst","to":"mry"},{"from":"mwj","to":"vaj"},{"from":"myt","to":"mry"},{"from":"nad","to":"xny"},{"from":"ncp","to":"kdz"},{"from":"nnx","to":"ngv"},{"from":"nts","to":"pij"},{"from":"oun","to":"vaj"},{"from":"pcr","to":"adx"},{"from":"pmc","to":"huw"},{"from":"pmu","to":"phr"},{"from":"ppa","to":"bfy"},{"from":"ppr","to":"lcq"},{"from":"pry","to":"prt"},{"from":"puz","to":"pub"},{"from":"sca","to":"hle"},{"from":"skk","to":"oyb"},{"from":"tdu","to":"dtp"},{"from":"thc","to":"tpo"},{"from":"thx","to":"oyb"},{"from":"tie","to":"ras"},{"from":"tkk","to":"twm"},{"from":"tlw","to":"weo"},{"from":"tmp","to":"tyj"},{"from":"tne","to":"kak"},{"from":"tnf","to":"fa-af"},{"from":"tsf","to":"taj"},{"from":"uok","to":"ema"},{"from":"xba","to":"cax"},{"from":"xia","to":"acn"},{"from":"xkh","to":"waw"},{"from":"xsj","to":"suj"},{"from":"ybd","to":"rki"},{"from":"yma","to":"lrr"},{"from":"ymt","to":"mtm"},{"from":"yos","to":"zom"},{"from":"yuu","to":"yug"},{"from":"asd","to":"snz"},{"from":"dit","to":"dif"},{"from":"llo","to":"ngt"},{"from":"myd","to":"aog"},{"from":"nns","to":"nbr"},{"from":"sgn-br","to":"bzs"},{"from":"sgn-co","to":"csn"},{"from":"sgn-de","to":"gsg"},{"from":"sgn-dk","to":"dsl"},{"from":"sgn-fr","to":"fsl"},{"from":"sgn-gb","to":"bfi"},{"from":"sgn-gr","to":"gss"},{"from":"sgn-ie","to":"isg"},{"from":"sgn-it","to":"ise"},{"from":"sgn-jp","to":"jsl"},{"from":"sgn-mx","to":"mfs"},{"from":"sgn-ni","to":"ncs"},{"from":"sgn-nl","to":"dse"},{"from":"sgn-no","to":"nsi"},{"from":"sgn-pt","to":"psr"},{"from":"sgn-se","to":"swl"},{"from":"sgn-us","to":"ase"},{"from":"sgn-za","to":"sfs"},{"from":"no-bokmal","to":"nb"},{"from":"no-nynorsk","to":"nn"},{"from":"aa-saaho","to":"ssy"},{"from":"sh","to":"sr-latn"},{"from":"cnr","to":"sr-me"},{"from":"no","to":"nb"},{"from":"tl","to":"fil"},{"from":"az-az","to":"az-latn-az"},{"from":"bs-ba","to":"bs-latn-ba"},{"from":"ha-latn-gh","to":"ha-gh"},{"from":"ha-latn-ne","to":"ha-ne"},{"from":"ha-latn-ng","to":"ha-ng"},{"from":"kk-cyrl-kz","to":"kk-kz"},{"from":"ky-cyrl-kg","to":"ky-kg"},{"from":"ks-arab-in","to":"ks-in"},{"from":"mn-cyrl-mn","to":"mn-mn"},{"from":"ms-latn-bn","to":"ms-bn"},{"from":"ms-latn-my","to":"ms-my"},{"from":"ms-latn-sg","to":"ms-sg"},{"from":"pa-in","to":"pa-guru-in"},{"from":"pa-pk","to":"pa-arab-pk"},{"from":"shi-ma","to":"shi-tfng-ma"},{"from":"sr-ba","to":"sr-cyrl-ba"},{"from":"sr-me","to":"sr-latn-me"},{"from":"sr-rs","to":"sr-cyrl-rs"},{"from":"sr-xk","to":"sr-cyrl-xk"},{"from":"tzm-latn-ma","to":"tzm-ma"},{"from":"ug-arab-cn","to":"ug-cn"},{"from":"uz-af","to":"uz-arab-af"},{"from":"uz-uz","to":"uz-latn-uz"},{"from":"vai-lr","to":"vai-vaii-lr"},{"from":"yue-cn","to":"yue-hans-cn"},{"from":"yue-hk","to":"yue-hant-hk"},{"from":"zh-cn","to":"zh-hans-cn"},{"from":"zh-hk","to":"zh-hant-hk"},{"from":"zh-mo","to":"zh-hant-mo"},{"from":"zh-sg","to":"zh-hans-sg"},{"from":"zh-tw","to":"zh-hant-tw"},{"from":"aju","to":"jrb"},{"from":"als","to":"sq"},{"from":"arb","to":"ar"},{"from":"ayr","to":"ay"},{"from":"azj","to":"az"},{"from":"bcc","to":"bal"},{"from":"bcl","to":"bik"},{"from":"bxk","to":"luy"},{"from":"bxr","to":"bua"},{"from":"cld","to":"syr"},{"from":"cmn","to":"zh"},{"from":"cwd","to":"cr"},{"from":"dgo","to":"doi"},{"from":"dhd","to":"mwr"},{"from":"dik","to":"din"},{"from":"diq","to":"zza"},{"from":"lbk","to":"bnc"},{"from":"ekk","to":"et"},{"from":"emk","to":"man"},{"from":"esk","to":"ik"},{"from":"fat","to":"ak"},{"from":"fuc","to":"ff"},{"from":"gaz","to":"om"},{"from":"gbo","to":"grb"},{"from":"gno","to":"gon"},{"from":"gug","to":"gn"},{"from":"gya","to":"gba"},{"from":"hdn","to":"hai"},{"from":"hea","to":"hmn"},{"from":"ike","to":"iu"},{"from":"kmr","to":"ku"},{"from":"knc","to":"kr"},{"from":"kng","to":"kg"},{"from":"knn","to":"kok"},{"from":"kpv","to":"kv"},{"from":"lvs","to":"lv"},{"from":"mhr","to":"chm"},{"from":"mup","to":"raj"},{"from":"khk","to":"mn"},{"from":"npi","to":"ne"},{"from":"ojg","to":"oj"},{"from":"ory","to":"or"},{"from":"pbu","to":"ps"},{"from":"pes","to":"fa"},{"from":"plt","to":"mg"},{"from":"pnb","to":"lah"},{"from":"quz","to":"qu"},{"from":"rmy","to":"rom"},{"from":"spy","to":"kln"},{"from":"src","to":"sc"},{"from":"swh","to":"sw"},{"from":"ttq","to":"tmh"},{"from":"tw","to":"ak"},{"from":"umu","to":"del"},{"from":"uzn","to":"uz"},{"from":"xpe","to":"kpe"},{"from":"xsl","to":"den"},{"from":"ydd","to":"yi"},{"from":"zai","to":"zap"},{"from":"zsm","to":"ms"},{"from":"zyb","to":"za"},{"from":"him","to":"srx"},{"from":"mnk","to":"man"},{"from":"bh","to":"bho"},{"from":"prs","to":"fa-af"},{"from":"swc","to":"sw-cd"},{"from":"aar","to":"aa"},{"from":"abk","to":"ab"},{"from":"ave","to":"ae"},{"from":"afr","to":"af"},{"from":"aka","to":"ak"},{"from":"amh","to":"am"},{"from":"arg","to":"an"},{"from":"ara","to":"ar"},{"from":"asm","to":"as"},{"from":"ava","to":"av"},{"from":"aym","to":"ay"},{"from":"aze","to":"az"},{"from":"bak","to":"ba"},{"from":"bel","to":"be"},{"from":"bul","to":"bg"},{"from":"bih","to":"bho"},{"from":"bis","to":"bi"},{"from":"bam","to":"bm"},{"from":"ben","to":"bn"},{"from":"bod","to":"bo"},{"from":"bre","to":"br"},{"from":"bos","to":"bs"},{"from":"cat","to":"ca"},{"from":"che","to":"ce"},{"from":"cha","to":"ch"},{"from":"cos","to":"co"},{"from":"cre","to":"cr"},{"from":"ces","to":"cs"},{"from":"chu","to":"cu"},{"from":"chv","to":"cv"},{"from":"cym","to":"cy"},{"from":"dan","to":"da"},{"from":"deu","to":"de"},{"from":"div","to":"dv"},{"from":"dzo","to":"dz"},{"from":"ewe","to":"ee"},{"from":"ell","to":"el"},{"from":"eng","to":"en"},{"from":"epo","to":"eo"},{"from":"spa","to":"es"},{"from":"est","to":"et"},{"from":"eus","to":"eu"},{"from":"fas","to":"fa"},{"from":"ful","to":"ff"},{"from":"fin","to":"fi"},{"from":"fij","to":"fj"},{"from":"fao","to":"fo"},{"from":"fra","to":"fr"},{"from":"fry","to":"fy"},{"from":"gle","to":"ga"},{"from":"gla","to":"gd"},{"from":"glg","to":"gl"},{"from":"grn","to":"gn"},{"from":"guj","to":"gu"},{"from":"glv","to":"gv"},{"from":"hau","to":"ha"},{"from":"heb","to":"he"},{"from":"hin","to":"hi"},{"from":"hmo","to":"ho"},{"from":"hrv","to":"hr"},{"from":"hat","to":"ht"},{"from":"hun","to":"hu"},{"from":"hye","to":"hy"},{"from":"her","to":"hz"},{"from":"ina","to":"ia"},{"from":"ind","to":"id"},{"from":"ile","to":"ie"},{"from":"ibo","to":"ig"},{"from":"iii","to":"ii"},{"from":"ipk","to":"ik"},{"from":"ido","to":"io"},{"from":"isl","to":"is"},{"from":"ita","to":"it"},{"from":"iku","to":"iu"},{"from":"jpn","to":"ja"},{"from":"jav","to":"jv"},{"from":"kat","to":"ka"},{"from":"kon","to":"kg"},{"from":"kik","to":"ki"},{"from":"kua","to":"kj"},{"from":"kaz","to":"kk"},{"from":"kal","to":"kl"},{"from":"khm","to":"km"},{"from":"kan","to":"kn"},{"from":"kor","to":"ko"},{"from":"kau","to":"kr"},{"from":"kas","to":"ks"},{"from":"kur","to":"ku"},{"from":"kom","to":"kv"},{"from":"cor","to":"kw"},{"from":"kir","to":"ky"},{"from":"lat","to":"la"},{"from":"ltz","to":"lb"},{"from":"lug","to":"lg"},{"from":"lim","to":"li"},{"from":"lin","to":"ln"},{"from":"lao","to":"lo"},{"from":"lit","to":"lt"},{"from":"lub","to":"lu"},{"from":"lav","to":"lv"},{"from":"mlg","to":"mg"},{"from":"mah","to":"mh"},{"from":"mri","to":"mi"},{"from":"mkd","to":"mk"},{"from":"mal","to":"ml"},{"from":"mon","to":"mn"},{"from":"mol","to":"ro"},{"from":"mar","to":"mr"},{"from":"msa","to":"ms"},{"from":"mlt","to":"mt"},{"from":"mya","to":"my"},{"from":"nau","to":"na"},{"from":"nob","to":"nb"},{"from":"nde","to":"nd"},{"from":"nep","to":"ne"},{"from":"ndo","to":"ng"},{"from":"nld","to":"nl"},{"from":"nno","to":"nn"},{"from":"nor","to":"nb"},{"from":"nbl","to":"nr"},{"from":"nav","to":"nv"},{"from":"nya","to":"ny"},{"from":"oci","to":"oc"},{"from":"oji","to":"oj"},{"from":"orm","to":"om"},{"from":"ori","to":"or"},{"from":"oss","to":"os"},{"from":"pan","to":"pa"},{"from":"pli","to":"pi"},{"from":"pol","to":"pl"},{"from":"pus","to":"ps"},{"from":"por","to":"pt"},{"from":"que","to":"qu"},{"from":"roh","to":"rm"},{"from":"run","to":"rn"},{"from":"ron","to":"ro"},{"from":"rus","to":"ru"},{"from":"kin","to":"rw"},{"from":"san","to":"sa"},{"from":"srd","to":"sc"},{"from":"snd","to":"sd"},{"from":"sme","to":"se"},{"from":"sag","to":"sg"},{"from":"hbs","to":"sr-latn"},{"from":"sin","to":"si"},{"from":"slk","to":"sk"},{"from":"slv","to":"sl"},{"from":"smo","to":"sm"},{"from":"sna","to":"sn"},{"from":"som","to":"so"},{"from":"sqi","to":"sq"},{"from":"srp","to":"sr"},{"from":"ssw","to":"ss"},{"from":"sot","to":"st"},{"from":"sun","to":"su"},{"from":"swe","to":"sv"},{"from":"swa","to":"sw"},{"from":"tam","to":"ta"},{"from":"tel","to":"te"},{"from":"tgk","to":"tg"},{"from":"tha","to":"th"},{"from":"tir","to":"ti"},{"from":"tuk","to":"tk"},{"from":"tgl","to":"fil"},{"from":"tsn","to":"tn"},{"from":"ton","to":"to"},{"from":"tur","to":"tr"},{"from":"tso","to":"ts"},{"from":"tat","to":"tt"},{"from":"twi","to":"ak"},{"from":"tah","to":"ty"},{"from":"uig","to":"ug"},{"from":"ukr","to":"uk"},{"from":"urd","to":"ur"},{"from":"uzb","to":"uz"},{"from":"ven","to":"ve"},{"from":"vie","to":"vi"},{"from":"vol","to":"vo"},{"from":"wln","to":"wa"},{"from":"wol","to":"wo"},{"from":"xho","to":"xh"},{"from":"yid","to":"yi"},{"from":"yor","to":"yo"},{"from":"zha","to":"za"},{"from":"zho","to":"zh"},{"from":"zul","to":"zu"},{"from":"alb","to":"sq"},{"from":"arm","to":"hy"},{"from":"baq","to":"eu"},{"from":"bur","to":"my"},{"from":"chi","to":"zh"},{"from":"cze","to":"cs"},{"from":"dut","to":"nl"},{"from":"fre","to":"fr"},{"from":"geo","to":"ka"},{"from":"ger","to":"de"},{"from":"gre","to":"el"},{"from":"ice","to":"is"},{"from":"mac","to":"mk"},{"from":"mao","to":"mi"},{"from":"may","to":"ms"},{"from":"per","to":"fa"},{"from":"rum","to":"ro"},{"from":"slo","to":"sk"},{"from":"tib","to":"bo"},{"from":"wel","to":"cy"}]')},8589:function(e){"use strict";e.exports=JSON.parse('{"en-gb-oed":"en-GB-oxendict","i-ami":"ami","i-bnn":"bnn","i-default":null,"i-enochian":null,"i-hak":"hak","i-klingon":"tlh","i-lux":"lb","i-mingo":null,"i-navajo":"nv","i-pwn":"pwn","i-tao":"tao","i-tay":"tay","i-tsu":"tsu","sgn-be-fr":"sfb","sgn-be-nl":"vgt","sgn-ch-de":"sgg","art-lojban":"jbo","cel-gaulish":null,"no-bok":"nb","no-nyn":"nn","zh-guoyu":"cmn","zh-hakka":"hak","zh-min":null,"zh-min-nan":"nan","zh-xiang":"hsn"}')},858:function(e){"use strict";e.exports=JSON.parse('["art-lojban","cel-gaulish","no-bok","no-nyn","zh-guoyu","zh-hakka","zh-min","zh-min-nan","zh-xiang"]')}},i={};function r(t){var n=i[t];if(void 0!==n)return n.exports;var a=i[t]={exports:{}};return e[t].call(a.exports,a,a.exports,r),a.exports}r.amdO={},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var o={};return function(){"use strict";r.d(o,{default:function(){return c}}),r(8416);var e,t=r(1715),n=r(8080),i=r(1737),a=r(1139),s=function(){var e,t="application/dash+xml";function n(n,i,r){if(!n||!/^VIDEO$/i.test(n.nodeName))return null;if(n._dashjs_player)return n._dashjs_player;var o,s=n.id||n.name||"video element";if(!(i=i||[].slice.call(n.querySelectorAll("source")).filter(function(e){return e.type==t})[0])&&n.src)(i=document.createElement("source")).src=n.src;else if(!i&&!n.src)return null;return r=r||{},(o=(0,a.Z)(r).create()).initialize(n,i.src,n.autoplay),e||(e=o.getDebug().getLogger()),e.debug("Converted "+s+" to dash.js player and added content: "+i.src),n._dashjs_player=o,o}function i(e){return/^VIDEO$/i.test(e.nodeName)?e:i(e.parentNode)}return{create:n,createAll:function(e,r){var a=[];e=e||"[data-dashjs-player]";for(var o=(r=r||document).querySelectorAll(e),s=0;s<o.length;s++){var l=n(o[s],null);a.push(l)}for(var u=r.querySelectorAll('source[type="'+t+'"]'),c=0;c<u.length;c++){var d=n(i(u[c]),null);a.push(d)}return a}}}();!("undefined"!=typeof window&&window&&window.dashjs&&window.dashjs.skipAutoCreate)&&"undefined"!=typeof window&&window&&window.addEventListener&&("complete"===window.document.readyState?window.dashjs?s.createAll():e=window.setInterval(function(){window.dashjs&&(window.clearInterval(e),s.createAll())},500):window.addEventListener("load",function e(){window.removeEventListener("load",e),s.createAll()}));var l=s,u=r(6398);dashjs.Protection=i.default,dashjs.MetricsReporting=n.default,dashjs.MediaPlayerFactory=l,dashjs.Debug=u.Z,dashjs.supportsMediaSource=t.B;var c=dashjs}(),o.default}()})}).call(this,n("4362"),n("b639").Buffer)},e86a:function(e,t,n){var i=n("9850"),r=n("5e76"),a=n("6d8b"),o=a.getContext,s=a.extend,l=a.retrieve2,u=a.retrieve3,c=a.trim,d={},f=0,h=5e3,p=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g,g="12px sans-serif",m={};function v(e,t){m[e]=t}function y(e,t){t=t||g;var n=e+":"+t;if(d[n])return d[n];for(var i=(e+"").split("\n"),r=0,a=0,o=i.length;a<o;a++)r=Math.max(D(i[a],t).width,r);return f>h&&(f=0,d={}),f++,d[n]=r,r}function _(e,t,n,i,r,a,o){return a?E(e,t,n,i,r,a,o):b(e,t,n,i,r,o)}function b(e,t,n,r,a,o){var s=k(e,t,a,o),l=y(e,t);a&&(l+=a[1]+a[3]);var u=s.outerHeight,c=T(0,l,n),d=S(0,u,r),f=new i(c,d,l,u);return f.lineHeight=s.lineHeight,f}function E(e,t,n,r,a,o,s){var l=M(e,{rich:o,truncate:s,font:t,textAlign:n,textPadding:a}),u=l.outerWidth,c=l.outerHeight,d=T(0,u,n),f=S(0,c,r);return new i(d,f,u,c)}function T(e,t,n){return"right"===n?e-=t:"center"===n&&(e-=t/2),e}function S(e,t,n){return"middle"===n?e-=t/2:"bottom"===n&&(e-=t),e}function w(e,t,n){var i=t.x,r=t.y,a=t.height,o=t.width,s=a/2,l="left",u="top";switch(e){case"left":i-=n,r+=s,l="right",u="middle";break;case"right":i+=n+o,r+=s,u="middle";break;case"top":i+=o/2,r-=n,l="center",u="bottom";break;case"bottom":i+=o/2,r+=a+n,l="center";break;case"inside":i+=o/2,r+=s,l="center",u="middle";break;case"insideLeft":i+=n,r+=s,u="middle";break;case"insideRight":i+=o-n,r+=s,l="right",u="middle";break;case"insideTop":i+=o/2,r+=n,l="center";break;case"insideBottom":i+=o/2,r+=a-n,l="center",u="bottom";break;case"insideTopLeft":i+=n,r+=n;break;case"insideTopRight":i+=o-n,r+=n,l="right";break;case"insideBottomLeft":i+=n,r+=a-n,u="bottom";break;case"insideBottomRight":i+=o-n,r+=a-n,l="right",u="bottom";break}return{x:i,y:r,textAlign:l,textVerticalAlign:u}}function A(e,t,n,i,r){if(!t)return"";var a=(e+"").split("\n");r=I(t,n,i,r);for(var o=0,s=a.length;o<s;o++)a[o]=x(a[o],r);return a.join("\n")}function I(e,t,n,i){i=s({},i),i.font=t;n=l(n,"...");i.maxIterations=l(i.maxIterations,2);var r=i.minChar=l(i.minChar,0);i.cnCharWidth=y("",t);var a=i.ascCharWidth=y("a",t);i.placeholder=l(i.placeholder,"");for(var o=e=Math.max(0,e-1),u=0;u<r&&o>=a;u++)o-=a;var c=y(n);return c>o&&(n="",c=0),o=e-c,i.ellipsis=n,i.ellipsisWidth=c,i.contentWidth=o,i.containerWidth=e,i}function x(e,t){var n=t.containerWidth,i=t.font,r=t.contentWidth;if(!n)return"";var a=y(e,i);if(a<=n)return e;for(var o=0;;o++){if(a<=r||o>=t.maxIterations){e+=t.ellipsis;break}var s=0===o?R(e,r,t.ascCharWidth,t.cnCharWidth):a>0?Math.floor(e.length*r/a):0;e=e.substr(0,s),a=y(e,i)}return""===e&&(e=t.placeholder),e}function R(e,t,n,i){for(var r=0,a=0,o=e.length;a<o&&r<t;a++){var s=e.charCodeAt(a);r+=0<=s&&s<=127?n:i}return a}function C(e){return y("",e)}function D(e,t){return m.measureText(e,t)}function k(e,t,n,i){null!=e&&(e+="");var r=C(t),a=e?e.split("\n"):[],o=a.length*r,s=o;if(n&&(s+=n[0]+n[2]),e&&i){var l=i.outerHeight,u=i.outerWidth;if(null!=l&&s>l)e="",a=[];else if(null!=u)for(var c=I(u-(n?n[1]+n[3]:0),t,i.ellipsis,{minChar:i.minChar,placeholder:i.placeholder}),d=0,f=a.length;d<f;d++)a[d]=x(a[d],c)}return{lines:a,height:o,outerHeight:s,lineHeight:r}}function M(e,t){var n={lines:[],width:0,height:0};if(null!=e&&(e+=""),!e)return n;var i,a=p.lastIndex=0;while(null!=(i=p.exec(e))){var o=i.index;o>a&&L(n,e.substring(a,o)),L(n,i[2],i[1]),a=p.lastIndex}a<e.length&&L(n,e.substring(a,e.length));var s=n.lines,c=0,d=0,f=[],h=t.textPadding,g=t.truncate,m=g&&g.outerWidth,v=g&&g.outerHeight;h&&(null!=m&&(m-=h[1]+h[3]),null!=v&&(v-=h[0]+h[2]));for(var _=0;_<s.length;_++){for(var b=s[_],E=0,T=0,S=0;S<b.tokens.length;S++){var w=b.tokens[S],I=w.styleName&&t.rich[w.styleName]||{},x=w.textPadding=I.textPadding,R=w.font=I.font||t.font,D=w.textHeight=l(I.textHeight,C(R));if(x&&(D+=x[0]+x[2]),w.height=D,w.lineHeight=u(I.textLineHeight,t.textLineHeight,D),w.textAlign=I&&I.textAlign||t.textAlign,w.textVerticalAlign=I&&I.textVerticalAlign||"middle",null!=v&&c+w.lineHeight>v)return{lines:[],width:0,height:0};w.textWidth=y(w.text,R);var k=I.textWidth,M=null==k||"auto"===k;if("string"===typeof k&&"%"===k.charAt(k.length-1))w.percentWidth=k,f.push(w),k=0;else{if(M){k=w.textWidth;var P=I.textBackgroundColor,N=P&&P.image;N&&(N=r.findExistImage(N),r.isImageReady(N)&&(k=Math.max(k,N.width*D/N.height)))}var O=x?x[1]+x[3]:0;k+=O;var F=null!=m?m-T:null;null!=F&&F<k&&(!M||F<O?(w.text="",w.textWidth=k=0):(w.text=A(w.text,F-O,R,g.ellipsis,{minChar:g.minChar}),w.textWidth=y(w.text,R),k=w.textWidth+O))}T+=w.width=k,I&&(E=Math.max(E,w.lineHeight))}b.width=T,b.lineHeight=E,c+=E,d=Math.max(d,T)}n.outerWidth=n.width=l(t.textWidth,d),n.outerHeight=n.height=l(t.textHeight,c),h&&(n.outerWidth+=h[1]+h[3],n.outerHeight+=h[0]+h[2]);for(_=0;_<f.length;_++){w=f[_];var U=w.percentWidth;w.width=parseInt(U,10)/100*d}return n}function L(e,t,n){for(var i=""===t,r=t.split("\n"),a=e.lines,o=0;o<r.length;o++){var s=r[o],l={styleName:n,text:s,isLineHolder:!s&&!i};if(o)a.push({tokens:[l]});else{var u=(a[a.length-1]||(a[0]={tokens:[]})).tokens,c=u.length;1===c&&u[0].isLineHolder?u[0]=l:(s||!c||i)&&u.push(l)}}}function P(e){var t=(e.fontSize||e.fontFamily)&&[e.fontStyle,e.fontWeight,(e.fontSize||12)+"px",e.fontFamily||"sans-serif"].join(" ");return t&&c(t)||e.textFont||e.font}m.measureText=function(e,t){var n=o();return n.font=t||g,n.measureText(e)},t.DEFAULT_FONT=g,t.$override=v,t.getWidth=y,t.getBoundingRect=_,t.adjustTextX=T,t.adjustTextY=S,t.adjustTextPositionOnRect=w,t.truncateText=A,t.getLineHeight=C,t.measureText=D,t.parsePlainText=k,t.parseRichText=M,t.makeFont=P},e887:function(e,t,n){var i=n("6d8b"),r=i.each,a=n("e1fc"),o=n("8918"),s=n("625e"),l=n("e0d3"),u=n("f47d"),c=u.createTask,d=n("cccd"),f=l.makeInner(),h=d();function p(){this.group=new a,this.uid=o.getUID("viewChart"),this.renderTask=c({plan:y,reset:_}),this.renderTask.context={view:this}}p.prototype={type:"chart",init:function(e,t){},render:function(e,t,n,i){},highlight:function(e,t,n,i){v(e.getData(),i,"emphasis")},downplay:function(e,t,n,i){v(e.getData(),i,"normal")},remove:function(e,t){this.group.removeAll()},dispose:function(){},incrementalPrepareRender:null,incrementalRender:null,updateTransform:null};var g=p.prototype;function m(e,t){if(e&&(e.trigger(t),"group"===e.type))for(var n=0;n<e.childCount();n++)m(e.childAt(n),t)}function v(e,t,n){var i=l.queryDataIndex(e,t);null!=i?r(l.normalizeToArray(i),function(t){m(e.getItemGraphicEl(t),n)}):e.eachItemGraphicEl(function(e){m(e,n)})}function y(e){return h(e.model)}function _(e){var t=e.model,n=e.ecModel,i=e.api,r=e.payload,a=t.pipelineContext.progressiveRender,o=e.view,s=r&&f(r).updateMethod,l=a?"incrementalPrepareRender":s&&o[s]?s:"render";return"render"!==l&&o[l](t,n,i,r),b[l]}g.updateView=g.updateLayout=g.updateVisual=function(e,t,n,i){this.render(e,t,n,i)},s.enableClassExtend(p,["dispose"]),s.enableClassManagement(p,{registerWhenExtend:!0}),p.markUpdateMethod=function(e,t){f(e).updateMethod=t};var b={incrementalPrepareRender:{progress:function(e,t){t.view.incrementalRender(e,t.model,t.ecModel,t.api,t.payload)}},render:{forceFirstProgress:!0,progress:function(e,t){t.view.render(t.model,t.ecModel,t.api,t.payload)}}},E=p;e.exports=E},eb6b:function(e,t,n){var i=n("6d8b"),r=n("e0d3"),a=r.makeInner,o=n("cd33"),s=n("133d"),l=i.each,u=i.curry,c=a();function d(e,t,n){var r=e.currTrigger,a=[e.x,e.y],o=e,c=e.dispatchAction||i.bind(n.dispatchAction,n),d=t.getComponent("axisPointer").coordSysAxesInfo;if(d){E(a)&&(a=s({seriesIndex:o.seriesIndex,dataIndex:o.dataIndex},t).point);var h=E(a),T=o.axesInfo,S=d.axesInfo,w="leave"===r||E(a),A={},I={},x={list:[],map:{}},R={showPointer:u(p,I),showTooltip:u(g,x)};l(d.coordSysMap,function(e,t){var n=h||e.containPoint(a);l(d.coordSysAxesInfo[t],function(e,t){var i=e.axis,r=_(T,e);if(!w&&n&&(!T||r)){var o=r&&r.value;null!=o||h||(o=i.pointToData(a)),null!=o&&f(e,o,R,!1,A)}})});var C={};return l(S,function(e,t){var n=e.linkGroup;n&&!I[t]&&l(n.axesInfo,function(t,i){var r=I[i];if(t!==e&&r){var a=r.value;n.mapper&&(a=e.axis.scale.parse(n.mapper(a,b(t),b(e)))),C[e.key]=a}})}),l(C,function(e,t){f(S[t],e,R,!0,A)}),m(I,S,A),v(x,a,e,c),y(S,c,n),A}}function f(e,t,n,r,a){var o=e.axis;if(!o.scale.isBlank()&&o.containData(t))if(e.involveSeries){var s=h(t,e),l=s.payloadBatch,u=s.snapToValue;l[0]&&null==a.seriesIndex&&i.extend(a,l[0]),!r&&e.snap&&o.containData(u)&&null!=u&&(t=u),n.showPointer(e,t,l,a),n.showTooltip(e,s,u)}else n.showPointer(e,t)}function h(e,t){var n=t.axis,i=n.dim,r=e,a=[],o=Number.MAX_VALUE,s=-1;return l(t.seriesModels,function(t,u){var c,d,f=t.getData().mapDimension(i,!0);if(t.getAxisTooltipData){var h=t.getAxisTooltipData(f,e,n);d=h.dataIndices,c=h.nestestValue}else{if(d=t.getData().indicesOfNearest(f[0],e,"category"===n.type?.5:null),!d.length)return;c=t.getData().get(f[0],d[0])}if(null!=c&&isFinite(c)){var p=e-c,g=Math.abs(p);g<=o&&((g<o||p>=0&&s<0)&&(o=g,s=p,r=c,a.length=0),l(d,function(e){a.push({seriesIndex:t.seriesIndex,dataIndexInside:e,dataIndex:t.getData().getRawIndex(e)})}))}}),{payloadBatch:a,snapToValue:r}}function p(e,t,n,i){e[t.key]={value:n,payloadBatch:i}}function g(e,t,n,i){var r=n.payloadBatch,a=t.axis,s=a.model,l=t.axisPointerModel;if(t.triggerTooltip&&r.length){var u=t.coordSys.model,c=o.makeKey(u),d=e.map[c];d||(d=e.map[c]={coordSysId:u.id,coordSysIndex:u.componentIndex,coordSysType:u.type,coordSysMainType:u.mainType,dataByAxis:[]},e.list.push(d)),d.dataByAxis.push({axisDim:a.dim,axisIndex:s.componentIndex,axisType:s.type,axisId:s.id,value:i,valueLabelOpt:{precision:l.get("label.precision"),formatter:l.get("label.formatter")},seriesDataIndices:r.slice()})}}function m(e,t,n){var i=n.axesInfo=[];l(t,function(t,n){var r=t.axisPointerModel.option,a=e[n];a?(!t.useHandle&&(r.status="show"),r.value=a.value,r.seriesDataIndices=(a.payloadBatch||[]).slice()):!t.useHandle&&(r.status="hide"),"show"===r.status&&i.push({axisDim:t.axis.dim,axisIndex:t.axis.model.componentIndex,value:r.value})})}function v(e,t,n,i){if(!E(t)&&e.list.length){var r=((e.list[0].dataByAxis[0]||{}).seriesDataIndices||[])[0]||{};i({type:"showTip",escapeConnect:!0,x:t[0],y:t[1],tooltipOption:n.tooltipOption,position:n.position,dataIndexInside:r.dataIndexInside,dataIndex:r.dataIndex,seriesIndex:r.seriesIndex,dataByCoordSys:e.list})}else i({type:"hideTip"})}function y(e,t,n){var r=n.getZr(),a="axisPointerLastHighlights",o=c(r)[a]||{},s=c(r)[a]={};l(e,function(e,t){var n=e.axisPointerModel.option;"show"===n.status&&l(n.seriesDataIndices,function(e){var t=e.seriesIndex+" | "+e.dataIndex;s[t]=e})});var u=[],d=[];i.each(o,function(e,t){!s[t]&&d.push(e)}),i.each(s,function(e,t){!o[t]&&u.push(e)}),d.length&&n.dispatchAction({type:"downplay",escapeConnect:!0,batch:d}),u.length&&n.dispatchAction({type:"highlight",escapeConnect:!0,batch:u})}function _(e,t){for(var n=0;n<(e||[]).length;n++){var i=e[n];if(t.axis.dim===i.axisDim&&t.axis.model.componentIndex===i.axisIndex)return i}}function b(e){var t=e.axis.model,n={},i=n.axisDim=e.axis.dim;return n.axisIndex=n[i+"AxisIndex"]=t.componentIndex,n.axisName=n[i+"AxisName"]=t.name,n.axisId=n[i+"AxisId"]=t.id,n}function E(e){return!e||null==e[0]||isNaN(e[0])||null==e[1]||isNaN(e[1])}e.exports=d},ebd6:function(e,t,n){var i=n("cb7c"),r=n("d8e8"),a=n("2b4c")("species");e.exports=function(e,t){var n,o=i(e).constructor;return void 0===o||void 0==(n=i(o)[a])?t:r(n)}},ec02:function(e,t,n){var i=n("6d8b"),r=n("84ce"),a=function(e,t,n,i,a){r.call(this,e,t,n),this.type=i||"value",this.position=a||"bottom"};a.prototype={constructor:a,index:0,getAxesOnZeroOf:null,model:null,isHorizontal:function(){var e=this.position;return"top"===e||"bottom"===e},getGlobalExtent:function(e){var t=this.getExtent();return t[0]=this.toGlobalCoord(t[0]),t[1]=this.toGlobalCoord(t[1]),e&&t[0]>t[1]&&t.reverse(),t},getOtherAxis:function(){this.grid.getOtherAxis()},pointToData:function(e,t){return this.coordToData(this.toLocalCoord(e["x"===this.dim?0:1]),t)},toLocalCoord:null,toGlobalCoord:null},i.inherits(a,r);var o=a;e.exports=o},ec6f:function(e,t,n){var i=n("6d8b"),r=i.createHashMap,a=i.isTypedArray,o=n("625e"),s=o.enableClassCheck,l=n("93d0"),u=l.SOURCE_FORMAT_ORIGINAL,c=l.SERIES_LAYOUT_BY_COLUMN,d=l.SOURCE_FORMAT_UNKNOWN,f=l.SOURCE_FORMAT_TYPED_ARRAY,h=l.SOURCE_FORMAT_KEYED_COLUMNS;function p(e){this.fromDataset=e.fromDataset,this.data=e.data||(e.sourceFormat===h?{}:[]),this.sourceFormat=e.sourceFormat||d,this.seriesLayoutBy=e.seriesLayoutBy||c,this.dimensionsDefine=e.dimensionsDefine,this.encodeDefine=e.encodeDefine&&r(e.encodeDefine),this.startIndex=e.startIndex||0,this.dimensionsDetectCount=e.dimensionsDetectCount}p.seriesDataToSource=function(e){return new p({data:e,sourceFormat:a(e)?f:u,fromDataset:!1})},s(p);var g=p;e.exports=g},ed21:function(e,t,n){var i=n("2cf4"),r=i.devicePixelRatio,a=n("6d8b"),o=n("4942"),s=n("9850"),l=n("04f6"),u=n("5e68"),c=n("98b7"),d=n("0da8"),f=n("22d1"),h=1e5,p=314159,g=.01,m=.001;function v(e){return parseInt(e,10)}function y(e){return!!e&&(!!e.__builtin__||"function"===typeof e.resize&&"function"===typeof e.refresh)}var _=new s(0,0,0,0),b=new s(0,0,0,0);function E(e,t,n){return _.copy(e.getBoundingRect()),e.transform&&_.applyTransform(e.transform),b.width=t,b.height=n,!_.intersect(b)}function T(e,t){if(e==t)return!1;if(!e||!t||e.length!==t.length)return!0;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!0}function S(e,t){for(var n=0;n<e.length;n++){var i=e[n];i.setTransform(t),t.beginPath(),i.buildPath(t,i.shape),t.clip(),i.restoreTransform(t)}}function w(e,t){var n=document.createElement("div");return n.style.cssText=["position:relative","overflow:hidden","width:"+e+"px","height:"+t+"px","padding:0","margin:0","border-width:0"].join(";")+";",n}var A=function(e,t,n){this.type="canvas";var i=!e.nodeName||"CANVAS"===e.nodeName.toUpperCase();this._opts=n=a.extend({},n||{}),this.dpr=n.devicePixelRatio||r,this._singleCanvas=i,this.root=e;var o=e.style;o&&(o["-webkit-tap-highlight-color"]="transparent",o["-webkit-user-select"]=o["user-select"]=o["-webkit-touch-callout"]="none",e.innerHTML=""),this.storage=t;var s=this._zlevelList=[],l=this._layers={};if(this._layerConfig={},this._needsManuallyCompositing=!1,i){var c=e.width,d=e.height;null!=n.width&&(c=n.width),null!=n.height&&(d=n.height),this.dpr=n.devicePixelRatio||1,e.width=c*this.dpr,e.height=d*this.dpr,this._width=c,this._height=d;var f=new u(e,this,this.dpr);f.__builtin__=!0,f.initContext(),l[p]=f,f.zlevel=p,s.push(p),this._domRoot=e}else{this._width=this._getSize(0),this._height=this._getSize(1);var h=this._domRoot=w(this._width,this._height);e.appendChild(h)}this._hoverlayer=null,this._hoverElements=[]};A.prototype={constructor:A,getType:function(){return"canvas"},isSingleCanvas:function(){return this._singleCanvas},getViewportRoot:function(){return this._domRoot},getViewportRootOffset:function(){var e=this.getViewportRoot();if(e)return{offsetLeft:e.offsetLeft||0,offsetTop:e.offsetTop||0}},refresh:function(e){var t=this.storage.getDisplayList(!0),n=this._zlevelList;this._redrawId=Math.random(),this._paintList(t,e,this._redrawId);for(var i=0;i<n.length;i++){var r=n[i],a=this._layers[r];if(!a.__builtin__&&a.refresh){var o=0===i?this._backgroundColor:null;a.refresh(o)}}return this.refreshHover(),this},addHover:function(e,t){if(!e.__hoverMir){var n=new e.constructor({style:e.style,shape:e.shape});n.__from=e,e.__hoverMir=n,n.setStyle(t),this._hoverElements.push(n)}},removeHover:function(e){var t=e.__hoverMir,n=this._hoverElements,i=a.indexOf(n,t);i>=0&&n.splice(i,1),e.__hoverMir=null},clearHover:function(e){for(var t=this._hoverElements,n=0;n<t.length;n++){var i=t[n].__from;i&&(i.__hoverMir=null)}t.length=0},refreshHover:function(){var e=this._hoverElements,t=e.length,n=this._hoverlayer;if(n&&n.clear(),t){l(e,this.storage.displayableSortFunc),n||(n=this._hoverlayer=this.getLayer(h));var i={};n.ctx.save();for(var r=0;r<t;){var a=e[r],o=a.__from;o&&o.__zr?(r++,o.invisible||(a.transform=o.transform,a.invTransform=o.invTransform,a.__clipPaths=o.__clipPaths,this._doPaintEl(a,n,!0,i))):(e.splice(r,1),o.__hoverMir=null,t--)}n.ctx.restore()}},getHoverLayer:function(){return this.getLayer(h)},_paintList:function(e,t,n){if(this._redrawId===n){t=t||!1,this._updateLayerStatus(e);var i=this._doPaintList(e,t);if(this._needsManuallyCompositing&&this._compositeManually(),!i){var r=this;c(function(){r._paintList(e,t,n)})}}},_compositeManually:function(){var e=this.getLayer(p).ctx,t=this._domRoot.width,n=this._domRoot.height;e.clearRect(0,0,t,n),this.eachBuiltinLayer(function(i){i.virtual&&e.drawImage(i.dom,0,0,t,n)})},_doPaintList:function(e,t){for(var n=[],i=0;i<this._zlevelList.length;i++){var r=this._zlevelList[i],o=this._layers[r];o.__builtin__&&o!==this._hoverlayer&&(o.__dirty||t)&&n.push(o)}for(var s=!0,l=0;l<n.length;l++){o=n[l];var u=o.ctx,c={};u.save();var d=t?o.__startIndex:o.__drawIndex,h=!t&&o.incremental&&Date.now,p=h&&Date.now(),g=o.zlevel===this._zlevelList[0]?this._backgroundColor:null;if(o.__startIndex===o.__endIndex)o.clear(!1,g);else if(d===o.__startIndex){var m=e[d];m.incremental&&m.notClear&&!t||o.clear(!1,g)}-1===d&&(console.error("For some unknown reason. drawIndex is -1"),d=o.__startIndex);for(var v=d;v<o.__endIndex;v++){var y=e[v];if(this._doPaintEl(y,o,t,c),y.__dirty=!1,h){var _=Date.now()-p;if(_>15)break}}o.__drawIndex=v,o.__drawIndex<o.__endIndex&&(s=!1),c.prevElClipPaths&&u.restore(),u.restore()}return f.wxa&&a.each(this._layers,function(e){e&&e.ctx&&e.ctx.draw&&e.ctx.draw()}),s},_doPaintEl:function(e,t,n,i){var r=t.ctx,a=e.transform;if((t.__dirty||n)&&!e.invisible&&0!==e.style.opacity&&(!a||a[0]||a[3])&&(!e.culling||!E(e,this._width,this._height))){var o=e.__clipPaths;i.prevElClipPaths&&!T(o,i.prevElClipPaths)||(i.prevElClipPaths&&(t.ctx.restore(),i.prevElClipPaths=null,i.prevEl=null),o&&(r.save(),S(o,r),i.prevElClipPaths=o)),e.beforeBrush&&e.beforeBrush(r),e.brush(r,i.prevEl||null),i.prevEl=e,e.afterBrush&&e.afterBrush(r)}},getLayer:function(e,t){this._singleCanvas&&!this._needsManuallyCompositing&&(e=p);var n=this._layers[e];return n||(n=new u("zr_"+e,this,this.dpr),n.zlevel=e,n.__builtin__=!0,this._layerConfig[e]&&a.merge(n,this._layerConfig[e],!0),t&&(n.virtual=t),this.insertLayer(e,n),n.initContext()),n},insertLayer:function(e,t){var n=this._layers,i=this._zlevelList,r=i.length,a=null,s=-1,l=this._domRoot;if(n[e])o("ZLevel "+e+" has been used already");else if(y(t)){if(r>0&&e>i[0]){for(s=0;s<r-1;s++)if(i[s]<e&&i[s+1]>e)break;a=n[i[s]]}if(i.splice(s+1,0,e),n[e]=t,!t.virtual)if(a){var u=a.dom;u.nextSibling?l.insertBefore(t.dom,u.nextSibling):l.appendChild(t.dom)}else l.firstChild?l.insertBefore(t.dom,l.firstChild):l.appendChild(t.dom)}else o("Layer of zlevel "+e+" is not valid")},eachLayer:function(e,t){var n,i,r=this._zlevelList;for(i=0;i<r.length;i++)n=r[i],e.call(t,this._layers[n],n)},eachBuiltinLayer:function(e,t){var n,i,r,a=this._zlevelList;for(r=0;r<a.length;r++)i=a[r],n=this._layers[i],n.__builtin__&&e.call(t,n,i)},eachOtherLayer:function(e,t){var n,i,r,a=this._zlevelList;for(r=0;r<a.length;r++)i=a[r],n=this._layers[i],n.__builtin__||e.call(t,n,i)},getLayers:function(){return this._layers},_updateLayerStatus:function(e){function t(e){r&&(r.__endIndex!==e&&(r.__dirty=!0),r.__endIndex=e)}if(this.eachBuiltinLayer(function(e,t){e.__dirty=e.__used=!1}),this._singleCanvas)for(var n=1;n<e.length;n++){var i=e[n];if(i.zlevel!==e[n-1].zlevel||i.incremental){this._needsManuallyCompositing=!0;break}}var r=null,a=0;for(n=0;n<e.length;n++){i=e[n];var s,l=i.zlevel;i.incremental?(s=this.getLayer(l+m,this._needsManuallyCompositing),s.incremental=!0,a=1):s=this.getLayer(l+(a>0?g:0),this._needsManuallyCompositing),s.__builtin__||o("ZLevel "+l+" has been used by unkown layer "+s.id),s!==r&&(s.__used=!0,s.__startIndex!==n&&(s.__dirty=!0),s.__startIndex=n,s.incremental?s.__drawIndex=-1:s.__drawIndex=n,t(n),r=s),i.__dirty&&(s.__dirty=!0,s.incremental&&s.__drawIndex<0&&(s.__drawIndex=n))}t(n),this.eachBuiltinLayer(function(e,t){!e.__used&&e.getElementCount()>0&&(e.__dirty=!0,e.__startIndex=e.__endIndex=e.__drawIndex=0),e.__dirty&&e.__drawIndex<0&&(e.__drawIndex=e.__startIndex)})},clear:function(){return this.eachBuiltinLayer(this._clearLayer),this},_clearLayer:function(e){e.clear()},setBackgroundColor:function(e){this._backgroundColor=e},configLayer:function(e,t){if(t){var n=this._layerConfig;n[e]?a.merge(n[e],t,!0):n[e]=t;for(var i=0;i<this._zlevelList.length;i++){var r=this._zlevelList[i];if(r===e||r===e+g){var o=this._layers[r];a.merge(o,n[e],!0)}}}},delLayer:function(e){var t=this._layers,n=this._zlevelList,i=t[e];i&&(i.dom.parentNode.removeChild(i.dom),delete t[e],n.splice(a.indexOf(n,e),1))},resize:function(e,t){if(this._domRoot.style){var n=this._domRoot;n.style.display="none";var i=this._opts;if(null!=e&&(i.width=e),null!=t&&(i.height=t),e=this._getSize(0),t=this._getSize(1),n.style.display="",this._width!=e||t!=this._height){for(var r in n.style.width=e+"px",n.style.height=t+"px",this._layers)this._layers.hasOwnProperty(r)&&this._layers[r].resize(e,t);a.each(this._progressiveLayers,function(n){n.resize(e,t)}),this.refresh(!0)}this._width=e,this._height=t}else{if(null==e||null==t)return;this._width=e,this._height=t,this.getLayer(p).resize(e,t)}return this},clearLayer:function(e){var t=this._layers[e];t&&t.clear()},dispose:function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},getRenderedCanvas:function(e){if(e=e||{},this._singleCanvas&&!this._compositeManually)return this._layers[p].dom;var t=new u("image",this,e.pixelRatio||this.dpr);if(t.initContext(),t.clear(!1,e.backgroundColor||this._backgroundColor),e.pixelRatio<=this.dpr){this.refresh();var n=t.dom.width,i=t.dom.height,r=t.ctx;this.eachLayer(function(e){e.__builtin__?r.drawImage(e.dom,0,0,n,i):e.renderToCanvas&&(t.ctx.save(),e.renderToCanvas(t.ctx),t.ctx.restore())})}else for(var a={},o=this.storage.getDisplayList(!0),s=0;s<o.length;s++){var l=o[s];this._doPaintEl(l,t,!0,a)}return t.dom},getWidth:function(){return this._width},getHeight:function(){return this._height},_getSize:function(e){var t=this._opts,n=["width","height"][e],i=["clientWidth","clientHeight"][e],r=["paddingLeft","paddingTop"][e],a=["paddingRight","paddingBottom"][e];if(null!=t[n]&&"auto"!==t[n])return parseFloat(t[n]);var o=this.root,s=document.defaultView.getComputedStyle(o);return(o[i]||v(s[n])||v(o.style[n]))-(v(s[r])||0)-(v(s[a])||0)|0},pathToImage:function(e,t){t=t||this.dpr;var n=document.createElement("canvas"),i=n.getContext("2d"),r=e.getBoundingRect(),a=e.style,o=a.shadowBlur*t,s=a.shadowOffsetX*t,l=a.shadowOffsetY*t,u=a.hasStroke()?a.lineWidth:0,c=Math.max(u/2,-s+o),f=Math.max(u/2,s+o),h=Math.max(u/2,-l+o),p=Math.max(u/2,l+o),g=r.width+c+f,m=r.height+h+p;n.width=g*t,n.height=m*t,i.scale(t,t),i.clearRect(0,0,g,m),i.dpr=t;var v={position:e.position,rotation:e.rotation,scale:e.scale};e.position=[c-r.x,h-r.y],e.rotation=0,e.scale=[1,1],e.updateTransform(),e&&e.brush(i);var y=d,_=new y({style:{x:0,y:0,image:n}});return null!=v.position&&(_.position=e.position=v.position),null!=v.rotation&&(_.rotation=e.rotation=v.rotation),null!=v.scale&&(_.scale=e.scale=v.scale),_}};var I=A;e.exports=I},eda2:function(e,t,n){var i=n("6d8b"),r=n("e86a"),a=n("3842");function o(e){return isNaN(e)?"-":(e=(e+"").split("."),e[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(e.length>1?"."+e[1]:""))}function s(e,t){return e=(e||"").toLowerCase().replace(/-(.)/g,function(e,t){return t.toUpperCase()}),t&&e&&(e=e.charAt(0).toUpperCase()+e.slice(1)),e}var l=i.normalizeCssArray,u=/([&<>"'])/g,c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function d(e){return null==e?"":(e+"").replace(u,function(e,t){return c[t]})}var f=["a","b","c","d","e","f","g"],h=function(e,t){return"{"+e+(null==t?"":t)+"}"};function p(e,t,n){i.isArray(t)||(t=[t]);var r=t.length;if(!r)return"";for(var a=t[0].$vars||[],o=0;o<a.length;o++){var s=f[o];e=e.replace(h(s),h(s,0))}for(var l=0;l<r;l++)for(var u=0;u<a.length;u++){var c=t[l][a[u]];e=e.replace(h(f[u],l),n?d(c):c)}return e}function g(e,t,n){return i.each(t,function(t,i){e=e.replace("{"+i+"}",n?d(t):t)}),e}function m(e,t){e=i.isString(e)?{color:e,extraCssText:t}:e||{};var n=e.color,r=e.type;t=e.extraCssText;return n?"subItem"===r?'<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:'+d(n)+";"+(t||"")+'"></span>':'<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:'+d(n)+";"+(t||"")+'"></span>':""}function v(e,t){return e+="","0000".substr(0,t-e.length)+e}function y(e,t,n){"week"!==e&&"month"!==e&&"quarter"!==e&&"half-year"!==e&&"year"!==e||(e="MM-dd\nyyyy");var i=a.parseDate(t),r=n?"UTC":"",o=i["get"+r+"FullYear"](),s=i["get"+r+"Month"]()+1,l=i["get"+r+"Date"](),u=i["get"+r+"Hours"](),c=i["get"+r+"Minutes"](),d=i["get"+r+"Seconds"](),f=i["get"+r+"Milliseconds"]();return e=e.replace("MM",v(s,2)).replace("M",s).replace("yyyy",o).replace("yy",o%100).replace("dd",v(l,2)).replace("d",l).replace("hh",v(u,2)).replace("h",u).replace("mm",v(c,2)).replace("m",c).replace("ss",v(d,2)).replace("s",d).replace("SSS",v(f,3)),e}function _(e){return e?e.charAt(0).toUpperCase()+e.substr(1):e}var b=r.truncateText,E=r.getBoundingRect;t.addCommas=o,t.toCamelCase=s,t.normalizeCssArray=l,t.encodeHTML=d,t.formatTpl=p,t.formatTplSimple=g,t.getTooltipMarker=m,t.formatTime=y,t.capitalFirst=_,t.truncateText=b,t.getTextRect=E},ee1a:function(e,t,n){var i=n("6d8b"),r=i.each,a=i.isString;function o(e,t,n){n=n||{};var i,o,s,l,u=n.byIndex,c=n.stackedCoordDimension,d=!(!e||!e.get("stack"));if(r(t,function(e,n){a(e)&&(t[n]=e={name:e}),d&&!e.isExtraCoord&&(u||i||!e.ordinalMeta||(i=e),o||"ordinal"===e.type||"time"===e.type||c&&c!==e.coordDim||(o=e))}),!o||u||i||(u=!0),o){s="__\0ecstackresult",l="__\0ecstackedover",i&&(i.createInvertedIndices=!0);var f=o.coordDim,h=o.type,p=0;r(t,function(e){e.coordDim===f&&p++}),t.push({name:s,coordDim:f,coordDimIndex:p,type:h,isExtraCoord:!0,isCalculationCoord:!0}),p++,t.push({name:l,coordDim:l,coordDimIndex:p,type:h,isExtraCoord:!0,isCalculationCoord:!0})}return{stackedDimension:o&&o.name,stackedByDimension:i&&i.name,isStackedByIndex:u,stackedOverDimension:l,stackResultDimension:s}}function s(e,t){return!!t&&t===e.getCalculationInfo("stackedDimension")}function l(e,t){return s(e,t)?e.getCalculationInfo("stackResultDimension"):t}t.enableDataStack=o,t.isDimensionStacked=s,t.getStackedDimension=l},ee84:function(e,t,n){var i=n("20c8"),r=n("401b"),a=r.applyTransform,o=i.CMD,s=[[],[],[]],l=Math.sqrt,u=Math.atan2;function c(e,t){var n,i,r,c,d,f=e.data,h=o.M,p=o.C,g=o.L,m=o.R,v=o.A,y=o.Q;for(r=0,c=0;r<f.length;){switch(n=f[r++],c=r,i=0,n){case h:i=1;break;case g:i=1;break;case p:i=3;break;case y:i=2;break;case v:var _=t[4],b=t[5],E=l(t[0]*t[0]+t[1]*t[1]),T=l(t[2]*t[2]+t[3]*t[3]),S=u(-t[1]/T,t[0]/E);f[r]*=E,f[r++]+=_,f[r]*=T,f[r++]+=b,f[r++]*=E,f[r++]*=T,f[r++]+=S,f[r++]+=S,r+=2,c=r;break;case m:w[0]=f[r++],w[1]=f[r++],a(w,w,t),f[c++]=w[0],f[c++]=w[1],w[0]+=f[r++],w[1]+=f[r++],a(w,w,t),f[c++]=w[0],f[c++]=w[1]}for(d=0;d<i;d++){var w=s[d];w[0]=f[r++],w[1]=f[r++],a(w,w,t),f[c++]=w[0],f[c++]=w[1]}}}e.exports=c},ef6a:function(e,t){function n(e,t,n,a,o,s){t[0]=r(t[0],n),t[1]=r(t[1],n),e=e||0;var l=n[1]-n[0];null!=o&&(o=r(o,[0,l])),null!=s&&(s=Math.max(s,null!=o?o:0)),"all"===a&&(o=s=Math.abs(t[1]-t[0]),a=0);var u=i(t,a);t[a]+=e;var c=o||0,d=n.slice();u.sign<0?d[0]+=c:d[1]-=c,t[a]=r(t[a],d);var f=i(t,a);null!=o&&(f.sign!==u.sign||f.span<o)&&(t[1-a]=t[a]+u.sign*o);f=i(t,a);return null!=s&&f.span>s&&(t[1-a]=t[a]+f.sign*s),t}function i(e,t){var n=e[t]-e[1-t];return{span:Math.abs(n),sign:n>0?-1:n<0?1:t?-1:1}}function r(e,t){return Math.min(t[1],Math.max(t[0],e))}e.exports=n},ef97:function(e,t,n){var i=n("3eba");n("217b"),n("f17f");var r=n("7f96"),a=n("87c3"),o=n("fdde");n("01ed"),i.registerVisual(r("line","circle","line")),i.registerLayout(a("line")),i.registerProcessor(i.PRIORITY.PROCESSOR.STATISTIC,o("line"))},f123:function(e,t,n){var i=n("9f82"),r=i.prepareDataCoordInfo,a=i.getStackedOnPoint;function o(e,t){var n=[];return t.diff(e).add(function(e){n.push({cmd:"+",idx:e})}).update(function(e,t){n.push({cmd:"=",idx:t,idx1:e})}).remove(function(e){n.push({cmd:"-",idx:e})}).execute(),n}function s(e,t,n,i,s,l,u,c){for(var d=o(e,t),f=[],h=[],p=[],g=[],m=[],v=[],y=[],_=r(s,t,u),b=r(l,e,c),E=0;E<d.length;E++){var T=d[E],S=!0;switch(T.cmd){case"=":var w=e.getItemLayout(T.idx),A=t.getItemLayout(T.idx1);(isNaN(w[0])||isNaN(w[1]))&&(w=A.slice()),f.push(w),h.push(A),p.push(n[T.idx]),g.push(i[T.idx1]),y.push(t.getRawIndex(T.idx1));break;case"+":var I=T.idx;f.push(s.dataToPoint([t.get(_.dataDimsForPoint[0],I),t.get(_.dataDimsForPoint[1],I)])),h.push(t.getItemLayout(I).slice()),p.push(a(_,s,t,I)),g.push(i[I]),y.push(t.getRawIndex(I));break;case"-":I=T.idx;var x=e.getRawIndex(I);x!==I?(f.push(e.getItemLayout(I)),h.push(l.dataToPoint([e.get(b.dataDimsForPoint[0],I),e.get(b.dataDimsForPoint[1],I)])),p.push(n[I]),g.push(a(b,l,e,I)),y.push(x)):S=!1}S&&(m.push(T),v.push(v.length))}v.sort(function(e,t){return y[e]-y[t]});var R=[],C=[],D=[],k=[],M=[];for(E=0;E<v.length;E++){I=v[E];R[E]=f[I],C[E]=h[I],D[E]=p[I],k[E]=g[I],M[E]=m[I]}return{current:R,next:C,stackedOnCurrent:D,stackedOnNext:k,status:M}}e.exports=s},f17f:function(e,t,n){var i=n("4e08"),r=(i.__DEV__,n("6d8b")),a=n("f706"),o=n("1418"),s=n("f123"),l=n("2306"),u=n("e0d3"),c=n("d4d1"),d=c.Polyline,f=c.Polygon,h=n("e887"),p=n("3842"),g=p.round,m=n("9f82"),v=m.prepareDataCoordInfo,y=m.getStackedOnPoint;function _(e,t){if(e.length===t.length){for(var n=0;n<e.length;n++){var i=e[n],r=t[n];if(i[0]!==r[0]||i[1]!==r[1])return}return!0}}function b(e){return"number"===typeof e?e:e?.5:0}function E(e){var t=e.getGlobalExtent();if(e.onBand){var n=e.getBandWidth()/2-1,i=t[1]>t[0]?1:-1;t[0]+=i*n,t[1]-=i*n}return t}function T(e,t,n){if(!n.valueDim)return[];for(var i=[],r=0,a=t.count();r<a;r++)i.push(y(n,e,t,r));return i}function S(e,t,n,i){var r=E(e.getAxis("x")),a=E(e.getAxis("y")),o=e.getBaseAxis().isHorizontal(),s=Math.min(r[0],r[1]),u=Math.min(a[0],a[1]),c=Math.max(r[0],r[1])-s,d=Math.max(a[0],a[1])-u;if(n)s-=.5,c+=.5,u-=.5,d+=.5;else{var f=i.get("lineStyle.width")||2,h=i.get("clipOverflow")?f/2:Math.max(c,d);o?(u-=h,d+=2*h):(s-=h,c+=2*h)}var p=new l.Rect({shape:{x:s,y:u,width:c,height:d}});return t&&(p.shape[o?"width":"height"]=0,l.initProps(p,{shape:{width:c,height:d}},i)),p}function w(e,t,n,i){var r=e.getAngleAxis(),a=e.getRadiusAxis(),o=a.getExtent().slice();o[0]>o[1]&&o.reverse();var s=r.getExtent(),u=Math.PI/180;n&&(o[0]-=.5,o[1]+=.5);var c=new l.Sector({shape:{cx:g(e.cx,1),cy:g(e.cy,1),r0:g(o[0],1),r:g(o[1],1),startAngle:-s[0]*u,endAngle:-s[1]*u,clockwise:r.inverse}});return t&&(c.shape.endAngle=-s[0]*u,l.initProps(c,{shape:{endAngle:-s[1]*u}},i)),c}function A(e,t,n,i){return"polar"===e.type?w(e,t,n,i):S(e,t,n,i)}function I(e,t,n){for(var i=t.getBaseAxis(),r="x"===i.dim||"radius"===i.dim?0:1,a=[],o=0;o<e.length-1;o++){var s=e[o+1],l=e[o];a.push(l);var u=[];switch(n){case"end":u[r]=s[r],u[1-r]=l[1-r],a.push(u);break;case"middle":var c=(l[r]+s[r])/2,d=[];u[r]=d[r]=c,u[1-r]=l[1-r],d[1-r]=s[1-r],a.push(u),a.push(d);break;default:u[r]=l[r],u[1-r]=s[1-r],a.push(u)}}return e[o]&&a.push(e[o]),a}function x(e,t){var n=e.getVisual("visualMeta");if(n&&n.length&&e.count()&&"cartesian2d"===t.type){for(var i,a,o=n.length-1;o>=0;o--){var s=n[o].dimension,u=e.dimensions[s],c=e.getDimensionInfo(u);if(i=c&&c.coordDim,"x"===i||"y"===i){a=n[o];break}}if(a){var d=t.getAxis(i),f=r.map(a.stops,function(e){return{coord:d.toGlobalCoord(d.dataToCoord(e.value)),color:e.color}}),h=f.length,p=a.outerColors.slice();h&&f[0].coord>f[h-1].coord&&(f.reverse(),p.reverse());var g=10,m=f[0].coord-g,v=f[h-1].coord+g,y=v-m;if(y<.001)return"transparent";r.each(f,function(e){e.offset=(e.coord-m)/y}),f.push({offset:h?f[h-1].offset:.5,color:p[1]||"transparent"}),f.unshift({offset:h?f[0].offset:.5,color:p[0]||"transparent"});var _=new l.LinearGradient(0,0,0,0,f,!0);return _[i]=m,_[i+"2"]=v,_}}}function R(e,t,n){var i=e.get("showAllSymbol"),a="auto"===i;if(!i||a){var o=n.getAxesByScale("ordinal")[0];if(o&&(!a||!C(o,t))){var s=t.mapDimension(o.dim),l={};return r.each(o.getViewLabels(),function(e){l[e.tickValue]=1}),function(e){return!l.hasOwnProperty(t.get(s,e))}}}}function C(e,t){var n=e.getExtent(),i=Math.abs(n[1]-n[0])/e.scale.count();isNaN(i)&&(i=0);for(var r=t.count(),a=Math.max(1,Math.round(r/5)),s=0;s<r;s+=a)if(1.5*o.getSymbolSize(t,s)[e.isHorizontal()?1:0]>i)return!1;return!0}var D=h.extend({type:"line",init:function(){var e=new l.Group,t=new a;this.group.add(t.group),this._symbolDraw=t,this._lineGroup=e},render:function(e,t,n){var i=e.coordinateSystem,a=this.group,o=e.getData(),s=e.getModel("lineStyle"),l=e.getModel("areaStyle"),u=o.mapArray(o.getItemLayout),c="polar"===i.type,d=this._coordSys,f=this._symbolDraw,h=this._polyline,p=this._polygon,g=this._lineGroup,m=e.get("animation"),y=!l.isEmpty(),E=l.get("origin"),S=v(i,o,E),w=T(i,o,S),C=e.get("showSymbol"),D=C&&!c&&R(e,o,i),k=this._data;k&&k.eachItemGraphicEl(function(e,t){e.__temp&&(a.remove(e),k.setItemGraphicEl(t,null))}),C||f.remove(),a.add(g);var M=!c&&e.get("step");h&&d.type===i.type&&M===this._step?(y&&!p?p=this._newPolygon(u,w,i,m):p&&!y&&(g.remove(p),p=this._polygon=null),g.setClipPath(A(i,!1,!1,e)),C&&f.updateData(o,{isIgnore:D,clipShape:A(i,!1,!0,e)}),o.eachItemGraphicEl(function(e){e.stopAnimation(!0)}),_(this._stackedOnPoints,w)&&_(this._points,u)||(m?this._updateAnimation(o,w,i,n,M,E):(M&&(u=I(u,i,M),w=I(w,i,M)),h.setShape({points:u}),p&&p.setShape({points:u,stackedOnPoints:w})))):(C&&f.updateData(o,{isIgnore:D,clipShape:A(i,!1,!0,e)}),M&&(u=I(u,i,M),w=I(w,i,M)),h=this._newPolyline(u,i,m),y&&(p=this._newPolygon(u,w,i,m)),g.setClipPath(A(i,!0,!1,e)));var L=x(o,i)||o.getVisual("color");h.useStyle(r.defaults(s.getLineStyle(),{fill:"none",stroke:L,lineJoin:"bevel"}));var P=e.get("smooth");if(P=b(e.get("smooth")),h.setShape({smooth:P,smoothMonotone:e.get("smoothMonotone"),connectNulls:e.get("connectNulls")}),p){var N=o.getCalculationInfo("stackedOnSeries"),O=0;p.useStyle(r.defaults(l.getAreaStyle(),{fill:L,opacity:.7,lineJoin:"bevel"})),N&&(O=b(N.get("smooth"))),p.setShape({smooth:P,stackedOnSmooth:O,smoothMonotone:e.get("smoothMonotone"),connectNulls:e.get("connectNulls")})}this._data=o,this._coordSys=i,this._stackedOnPoints=w,this._points=u,this._step=M,this._valueOrigin=E},dispose:function(){},highlight:function(e,t,n,i){var r=e.getData(),a=u.queryDataIndex(r,i);if(!(a instanceof Array)&&null!=a&&a>=0){var s=r.getItemGraphicEl(a);if(!s){var l=r.getItemLayout(a);if(!l)return;s=new o(r,a),s.position=l,s.setZ(e.get("zlevel"),e.get("z")),s.ignore=isNaN(l[0])||isNaN(l[1]),s.__temp=!0,r.setItemGraphicEl(a,s),s.stopSymbolAnimation(!0),this.group.add(s)}s.highlight()}else h.prototype.highlight.call(this,e,t,n,i)},downplay:function(e,t,n,i){var r=e.getData(),a=u.queryDataIndex(r,i);if(null!=a&&a>=0){var o=r.getItemGraphicEl(a);o&&(o.__temp?(r.setItemGraphicEl(a,null),this.group.remove(o)):o.downplay())}else h.prototype.downplay.call(this,e,t,n,i)},_newPolyline:function(e){var t=this._polyline;return t&&this._lineGroup.remove(t),t=new d({shape:{points:e},silent:!0,z2:10}),this._lineGroup.add(t),this._polyline=t,t},_newPolygon:function(e,t){var n=this._polygon;return n&&this._lineGroup.remove(n),n=new f({shape:{points:e,stackedOnPoints:t},silent:!0}),this._lineGroup.add(n),this._polygon=n,n},_updateAnimation:function(e,t,n,i,r,a){var o=this._polyline,u=this._polygon,c=e.hostModel,d=s(this._data,e,this._stackedOnPoints,t,this._coordSys,n,this._valueOrigin,a),f=d.current,h=d.stackedOnCurrent,p=d.next,g=d.stackedOnNext;r&&(f=I(d.current,n,r),h=I(d.stackedOnCurrent,n,r),p=I(d.next,n,r),g=I(d.stackedOnNext,n,r)),o.shape.__points=d.current,o.shape.points=f,l.updateProps(o,{shape:{points:p}},c),u&&(u.setShape({points:f,stackedOnPoints:h}),l.updateProps(u,{shape:{points:p,stackedOnPoints:g}},c));for(var m=[],v=d.status,y=0;y<v.length;y++){var _=v[y].cmd;if("="===_){var b=e.getItemGraphicEl(v[y].idx1);b&&m.push({el:b,ptIdx:y})}}o.animators&&o.animators.length&&o.animators[0].during(function(){for(var e=0;e<m.length;e++){var t=m[e].el;t.attr("position",o.shape.__points[m[e].ptIdx])}})},remove:function(e){var t=this.group,n=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),n&&n.eachItemGraphicEl(function(e,i){e.__temp&&(t.remove(e),n.setItemGraphicEl(i,null))}),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._data=null}});e.exports=D},f219:function(e,t){var n="#eee",i=function(){return{axisLine:{lineStyle:{color:n}},axisTick:{lineStyle:{color:n}},axisLabel:{textStyle:{color:n}},splitLine:{lineStyle:{type:"dashed",color:"#aaa"}},splitArea:{areaStyle:{color:n}}}},r=["#dd6b66","#759aa0","#e69d87","#8dc1a9","#ea7e53","#eedd78","#73a373","#73b9bc","#7289ab","#91ca8c","#f49f42"],a={color:r,backgroundColor:"#333",tooltip:{axisPointer:{lineStyle:{color:n},crossStyle:{color:n}}},legend:{textStyle:{color:n}},textStyle:{color:n},title:{textStyle:{color:n}},toolbox:{iconStyle:{normal:{borderColor:n}}},dataZoom:{textStyle:{color:n}},visualMap:{textStyle:{color:n}},timeline:{lineStyle:{color:n},itemStyle:{normal:{color:r[1]}},label:{normal:{textStyle:{color:n}}},controlStyle:{normal:{color:n,borderColor:n}}},timeAxis:i(),logAxis:i(),valueAxis:i(),categoryAxis:i(),line:{symbol:"circle"},graph:{color:r},gauge:{title:{textStyle:{color:n}}},candlestick:{itemStyle:{normal:{color:"#FD1050",color0:"#0CF49B",borderColor:"#FD1050",borderColor0:"#0CF49B"}}}};a.categoryAxis.splitLine.show=!1;var o=a;e.exports=o},f273:function(e,t,n){var i=n("6d8b"),r=n("2306"),a=n("fab22"),o=n("6679"),s=n("0156"),l=["axisLine","axisTickLabel","axisName"],u=["splitArea","splitLine"],c=o.extend({type:"cartesianAxis",axisPointerClass:"CartesianAxisPointer",render:function(e,t,n,o){this.group.removeAll();var d=this._axisGroup;if(this._axisGroup=new r.Group,this.group.add(this._axisGroup),e.get("show")){var f=e.getCoordSysModel(),h=s.layout(f,e),p=new a(e,h);i.each(l,p.add,p),this._axisGroup.add(p.getGroup()),i.each(u,function(t){e.get(t+".show")&&this["_"+t](e,f)},this),r.groupTransition(d,this._axisGroup,e),c.superCall(this,"render",e,t,n,o)}},remove:function(){this._splitAreaColors=null},_splitLine:function(e,t){var n=e.axis;if(!n.scale.isBlank()){var a=e.getModel("splitLine"),o=a.getModel("lineStyle"),s=o.get("color");s=i.isArray(s)?s:[s];for(var l=t.coordinateSystem.getRect(),u=n.isHorizontal(),c=0,d=n.getTicksCoords({tickModel:a}),f=[],h=[],p=o.getLineStyle(),g=0;g<d.length;g++){var m=n.toGlobalCoord(d[g].coord);u?(f[0]=m,f[1]=l.y,h[0]=m,h[1]=l.y+l.height):(f[0]=l.x,f[1]=m,h[0]=l.x+l.width,h[1]=m);var v=c++%s.length,y=d[g].tickValue;this._axisGroup.add(new r.Line(r.subPixelOptimizeLine({anid:null!=y?"line_"+d[g].tickValue:null,shape:{x1:f[0],y1:f[1],x2:h[0],y2:h[1]},style:i.defaults({stroke:s[v]},p),silent:!0})))}}},_splitArea:function(e,t){var n=e.axis;if(!n.scale.isBlank()){var a=e.getModel("splitArea"),o=a.getModel("areaStyle"),s=o.get("color"),l=t.coordinateSystem.getRect(),u=n.getTicksCoords({tickModel:a,clamp:!0});if(u.length){var c=s.length,d=this._splitAreaColors,f=i.createHashMap(),h=0;if(d)for(var p=0;p<u.length;p++){var g=d.get(u[p].tickValue);if(null!=g){h=(g+(c-1)*p)%c;break}}var m=n.toGlobalCoord(u[0].coord),v=o.getAreaStyle();s=i.isArray(s)?s:[s];for(p=1;p<u.length;p++){var y,_,b,E,T=n.toGlobalCoord(u[p].coord);n.isHorizontal()?(y=m,_=l.y,b=T-y,E=l.height,m=y+b):(y=l.x,_=m,b=l.width,E=T-_,m=_+E);var S=u[p-1].tickValue;null!=S&&f.set(S,h),this._axisGroup.add(new r.Rect({anid:null!=S?"area_"+S:null,shape:{x:y,y:_,width:b,height:E},style:i.defaults({fill:s[h]},v),silent:!0})),h=(h+1)%c}this._splitAreaColors=f}}}});c.extend({type:"xAxis"}),c.extend({type:"yAxis"})},f279:function(e,t,n){var i=n("9850"),r=n("e263"),a=n("401b"),o=n("0655");function s(e,t,n){if(this.name=e,this.geometries=t,n)n=[n[0],n[1]];else{var i=this.getBoundingRect();n=[i.x+i.width/2,i.y+i.height/2]}this.center=n}s.prototype={constructor:s,properties:null,getBoundingRect:function(){var e=this._rect;if(e)return e;for(var t=Number.MAX_VALUE,n=[t,t],o=[-t,-t],s=[],l=[],u=this.geometries,c=0;c<u.length;c++)if("polygon"===u[c].type){var d=u[c].exterior;r.fromPoints(d,s,l),a.min(n,n,s),a.max(o,o,l)}return 0===c&&(n[0]=n[1]=o[0]=o[1]=0),this._rect=new i(n[0],n[1],o[0]-n[0],o[1]-n[1])},contain:function(e){var t=this.getBoundingRect(),n=this.geometries;if(!t.contain(e[0],e[1]))return!1;e:for(var i=0,r=n.length;i<r;i++)if("polygon"===n[i].type){var a=n[i].exterior,s=n[i].interiors;if(o.contain(a,e[0],e[1])){for(var l=0;l<(s?s.length:0);l++)if(o.contain(s[l]))continue e;return!0}}return!1},transformTo:function(e,t,n,r){var o=this.getBoundingRect(),s=o.width/o.height;n?r||(r=n/s):n=s*r;for(var l=new i(e,t,n,r),u=o.calculateTransform(l),c=this.geometries,d=0;d<c.length;d++)if("polygon"===c[d].type){for(var f=c[d].exterior,h=c[d].interiors,p=0;p<f.length;p++)a.applyTransform(f[p],f[p],u);for(var g=0;g<(h?h.length:0);g++)for(p=0;p<h[g].length;p++)a.applyTransform(h[g][p],h[g][p],u)}o=this._rect,o.copy(l),this.center=[o.x+o.width/2,o.y+o.height/2]}};var l=s;e.exports=l},f47d:function(e,t,n){var i=n("6d8b"),r=(i.assert,i.isArray),a=n("4e08");a.__DEV__;function o(e){return new s(e)}function s(e){e=e||{},this._reset=e.reset,this._plan=e.plan,this._count=e.count,this._onDirty=e.onDirty,this._dirty=!0,this.context}var l=s.prototype;l.perform=function(e){var t,n=this._upstream,i=e&&e.skip;if(this._dirty&&n){var a=this.context;a.data=a.outputData=n.context.outputData}this.__pipeline&&(this.__pipeline.currentTask=this),this._plan&&!i&&(t=this._plan(this.context));var o,s=h(this._modBy),l=this._modDataCount||0,u=h(e&&e.modBy),f=e&&e.modDataCount||0;function h(e){return!(e>=1)&&(e=1),e}s===u&&l===f||(t="reset"),(this._dirty||"reset"===t)&&(this._dirty=!1,o=d(this,i)),this._modBy=u,this._modDataCount=f;var p=e&&e.step;if(this._dueEnd=n?n._outputDueEnd:this._count?this._count(this.context):1/0,this._progress){var g=this._dueIndex,m=Math.min(null!=p?this._dueIndex+p:1/0,this._dueEnd);if(!i&&(o||g<m)){var v=this._progress;if(r(v))for(var y=0;y<v.length;y++)c(this,v[y],g,m,u,f);else c(this,v,g,m,u,f)}this._dueIndex=m;var _=null!=this._settedOutputEnd?this._settedOutputEnd:m;this._outputDueEnd=_}else this._dueIndex=this._outputDueEnd=null!=this._settedOutputEnd?this._settedOutputEnd:this._dueEnd;return this.unfinished()};var u=function(){var e,t,n,i,r,a={reset:function(l,u,c,d){t=l,e=u,n=c,i=d,r=Math.ceil(i/n),a.next=n>1&&i>0?s:o}};return a;function o(){return t<e?t++:null}function s(){var a=t%r*n+Math.ceil(t/r),o=t>=e?null:a<i?a:t;return t++,o}}();function c(e,t,n,i,r,a){u.reset(n,i,r,a),e._callingProgress=t,e._callingProgress({start:n,end:i,count:i-n,next:u.next},e.context)}function d(e,t){var n,i;e._dueIndex=e._outputDueEnd=e._dueEnd=0,e._settedOutputEnd=null,!t&&e._reset&&(n=e._reset(e.context),n&&n.progress&&(i=n.forceFirstProgress,n=n.progress),r(n)&&!n.length&&(n=null)),e._progress=n,e._modBy=e._modDataCount=null;var a=e._downstream;return a&&a.dirty(),i}l.dirty=function(){this._dirty=!0,this._onDirty&&this._onDirty(this.context)},l.unfinished=function(){return this._progress&&this._dueIndex<this._dueEnd},l.pipe=function(e){(this._downstream!==e||this._dirty)&&(this._downstream=e,e._upstream=this,e.dirty())},l.dispose=function(){this._disposed||(this._upstream&&(this._upstream._downstream=null),this._downstream&&(this._downstream._upstream=null),this._dirty=!1,this._disposed=!0)},l.getUpstream=function(){return this._upstream},l.getDownstream=function(){return this._downstream},l.setOutputEnd=function(e){this._outputDueEnd=this._settedOutputEnd=e},t.createTask=o},f4a2:function(e,t,n){var i=n("9850"),r=n("c526"),a=r.onIrrelevantElement,o=n("2306");function s(e){return e=c(e),function(t,n){return o.clipPointsByRect(t,e)}}function l(e,t){return e=c(e),function(n){var i=null!=t?t:n,r=i?e.width:e.height,a=i?e.x:e.y;return[a,a+(r||0)]}}function u(e,t,n){return e=c(e),function(i,r,o){return e.contain(r[0],r[1])&&!a(i,t,n)}}function c(e){return i.create(e)}t.makeRectPanelClipPath=s,t.makeLinearBrushOtherExtent=l,t.makeRectIsTargetByCursor=u},f605:function(e,t){e.exports=function(e,t,n,i){if(!(e instanceof t)||void 0!==i&&i in e)throw TypeError(n+": incorrect invocation!");return e}},f706:function(e,t,n){var i=n("2306"),r=n("1418"),a=n("6d8b"),o=a.isObject;function s(e){this.group=new i.Group,this._symbolCtor=e||r}var l=s.prototype;function u(e,t,n,i){return t&&!isNaN(t[0])&&!isNaN(t[1])&&!(i.isIgnore&&i.isIgnore(n))&&!(i.clipShape&&!i.clipShape.contain(t[0],t[1]))&&"none"!==e.getItemVisual(n,"symbol")}function c(e){return null==e||o(e)||(e={isIgnore:e}),e||{}}function d(e){var t=e.hostModel;return{itemStyle:t.getModel("itemStyle").getItemStyle(["color"]),hoverItemStyle:t.getModel("emphasis.itemStyle").getItemStyle(),symbolRotate:t.get("symbolRotate"),symbolOffset:t.get("symbolOffset"),hoverAnimation:t.get("hoverAnimation"),labelModel:t.getModel("label"),hoverLabelModel:t.getModel("emphasis.label"),cursorStyle:t.get("cursor")}}l.updateData=function(e,t){t=c(t);var n=this.group,r=e.hostModel,a=this._data,o=this._symbolCtor,s=d(e);a||n.removeAll(),e.diff(a).add(function(i){var r=e.getItemLayout(i);if(u(e,r,i,t)){var a=new o(e,i,s);a.attr("position",r),e.setItemGraphicEl(i,a),n.add(a)}}).update(function(l,c){var d=a.getItemGraphicEl(c),f=e.getItemLayout(l);u(e,f,l,t)?(d?(d.updateData(e,l,s),i.updateProps(d,{position:f},r)):(d=new o(e,l),d.attr("position",f)),n.add(d),e.setItemGraphicEl(l,d)):n.remove(d)}).remove(function(e){var t=a.getItemGraphicEl(e);t&&t.fadeOut(function(){n.remove(t)})}).execute(),this._data=e},l.isPersistent=function(){return!0},l.updateLayout=function(){var e=this._data;e&&e.eachItemGraphicEl(function(t,n){var i=e.getItemLayout(n);t.attr("position",i)})},l.incrementalPrepareUpdate=function(e){this._seriesScope=d(e),this._data=null,this.group.removeAll()},l.incrementalUpdate=function(e,t,n){function i(e){e.isGroup||(e.incremental=e.useHoverLayer=!0)}n=c(n);for(var r=e.start;r<e.end;r++){var a=t.getItemLayout(r);if(u(t,a,r,n)){var o=new this._symbolCtor(t,r,this._seriesScope);o.traverse(i),o.attr("position",a),this.group.add(o),t.setItemGraphicEl(r,o)}}},l.remove=function(e){var t=this.group,n=this._data;n&&e?n.eachItemGraphicEl(function(e){e.fadeOut(function(){t.remove(e)})}):t.removeAll()};var f=s;e.exports=f},f934:function(e,t,n){var i=n("6d8b"),r=n("9850"),a=n("3842"),o=a.parsePercent,s=n("eda2"),l=i.each,u=["left","right","top","bottom","width","height"],c=[["width","left","right"],["height","top","bottom"]];function d(e,t,n,i,r){var a=0,o=0;null==i&&(i=1/0),null==r&&(r=1/0);var s=0;t.eachChild(function(l,u){var c,d,f=l.position,h=l.getBoundingRect(),p=t.childAt(u+1),g=p&&p.getBoundingRect();if("horizontal"===e){var m=h.width+(g?-g.x+h.x:0);c=a+m,c>i||l.newline?(a=0,c=m,o+=s+n,s=h.height):s=Math.max(s,h.height)}else{var v=h.height+(g?-g.y+h.y:0);d=o+v,d>r||l.newline?(a+=s+n,o=0,d=v,s=h.width):s=Math.max(s,h.width)}l.newline||(f[0]=a,f[1]=o,"horizontal"===e?a=c+n:o=d+n)})}var f=d,h=i.curry(d,"vertical"),p=i.curry(d,"horizontal");function g(e,t,n){var i=t.width,r=t.height,a=o(e.x,i),l=o(e.y,r),u=o(e.x2,i),c=o(e.y2,r);return(isNaN(a)||isNaN(parseFloat(e.x)))&&(a=0),(isNaN(u)||isNaN(parseFloat(e.x2)))&&(u=i),(isNaN(l)||isNaN(parseFloat(e.y)))&&(l=0),(isNaN(c)||isNaN(parseFloat(e.y2)))&&(c=r),n=s.normalizeCssArray(n||0),{width:Math.max(u-a-n[1]-n[3],0),height:Math.max(c-l-n[0]-n[2],0)}}function m(e,t,n){n=s.normalizeCssArray(n||0);var i=t.width,a=t.height,l=o(e.left,i),u=o(e.top,a),c=o(e.right,i),d=o(e.bottom,a),f=o(e.width,i),h=o(e.height,a),p=n[2]+n[0],g=n[1]+n[3],m=e.aspect;switch(isNaN(f)&&(f=i-c-g-l),isNaN(h)&&(h=a-d-p-u),null!=m&&(isNaN(f)&&isNaN(h)&&(m>i/a?f=.8*i:h=.8*a),isNaN(f)&&(f=m*h),isNaN(h)&&(h=f/m)),isNaN(l)&&(l=i-c-f-g),isNaN(u)&&(u=a-d-h-p),e.left||e.right){case"center":l=i/2-f/2-n[3];break;case"right":l=i-f-g;break}switch(e.top||e.bottom){case"middle":case"center":u=a/2-h/2-n[0];break;case"bottom":u=a-h-p;break}l=l||0,u=u||0,isNaN(f)&&(f=i-g-l-(c||0)),isNaN(h)&&(h=a-p-u-(d||0));var v=new r(l+n[3],u+n[0],f,h);return v.margin=n,v}function v(e,t,n,a,o){var s=!o||!o.hv||o.hv[0],l=!o||!o.hv||o.hv[1],u=o&&o.boundingMode||"all";if(s||l){var c;if("raw"===u)c="group"===e.type?new r(0,0,+t.width||0,+t.height||0):e.getBoundingRect();else if(c=e.getBoundingRect(),e.needLocalTransform()){var d=e.getLocalTransform();c=c.clone(),c.applyTransform(d)}t=m(i.defaults({width:c.width,height:c.height},t),n,a);var f=e.position,h=s?t.x-c.x:0,p=l?t.y-c.y:0;e.attr("position","raw"===u?[h,p]:[f[0]+h,f[1]+p])}}function y(e,t){return null!=e[c[t][0]]||null!=e[c[t][1]]&&null!=e[c[t][2]]}function _(e,t,n){!i.isObject(n)&&(n={});var r=n.ignoreSize;!i.isArray(r)&&(r=[r,r]);var a=s(c[0],0),o=s(c[1],1);function s(n,i){var a={},o=0,s={},c=0,f=2;if(l(n,function(t){s[t]=e[t]}),l(n,function(e){u(t,e)&&(a[e]=s[e]=t[e]),d(a,e)&&o++,d(s,e)&&c++}),r[i])return d(t,n[1])?s[n[2]]=null:d(t,n[2])&&(s[n[1]]=null),s;if(c!==f&&o){if(o>=f)return a;for(var h=0;h<n.length;h++){var p=n[h];if(!u(a,p)&&u(e,p)){a[p]=e[p];break}}return a}return s}function u(e,t){return e.hasOwnProperty(t)}function d(e,t){return null!=e[t]&&"auto"!==e[t]}function f(e,t,n){l(e,function(e){t[e]=n[e]})}f(c[0],e,a),f(c[1],e,o)}function b(e){return E({},e)}function E(e,t){return t&&e&&l(u,function(n){t.hasOwnProperty(n)&&(e[n]=t[n])}),e}t.LOCATION_PARAMS=u,t.HV_NAMES=c,t.box=f,t.vbox=h,t.hbox=p,t.getAvailableSize=g,t.getLayoutRect=m,t.positionElement=v,t.sizeCalculable=y,t.mergeLayoutParam=_,t.getLayoutParams=b,t.copyLayoutParams=E},fab2:function(e,t,n){var i=n("7726").document;e.exports=i&&i.documentElement},fab22:function(e,t,n){var i=n("6d8b"),r=i.retrieve,a=i.defaults,o=i.extend,s=i.each,l=n("eda2"),u=n("2306"),c=n("4319"),d=n("3842"),f=d.isRadianAroundZero,h=d.remRadian,p=n("a15a"),g=p.createSymbol,m=n("1687"),v=n("401b"),y=v.applyTransform,_=Math.PI;function b(e){var t={componentType:e.mainType};return t[e.mainType+"Index"]=e.componentIndex,t}var E=function(e,t){this.opt=t,this.axisModel=e,a(t,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0}),this.group=new u.Group;var n=new u.Group({position:t.position.slice(),rotation:t.rotation});n.updateTransform(),this._transform=n.transform,this._dumbGroup=n};E.prototype={constructor:E,hasBuilder:function(e){return!!T[e]},add:function(e){T[e].call(this)},getGroup:function(){return this.group}};var T={axisLine:function(){var e=this.opt,t=this.axisModel;if(t.get("axisLine.show")){var n=this.axisModel.axis.getExtent(),i=this._transform,r=[n[0],0],a=[n[1],0];i&&(y(r,r,i),y(a,a,i));var l=o({lineCap:"round"},t.getModel("axisLine.lineStyle").getLineStyle());this.group.add(new u.Line(u.subPixelOptimizeLine({anid:"line",shape:{x1:r[0],y1:r[1],x2:a[0],y2:a[1]},style:l,strokeContainThreshold:e.strokeContainThreshold||5,silent:!0,z2:1})));var c=t.get("axisLine.symbol"),d=t.get("axisLine.symbolSize"),f=t.get("axisLine.symbolOffset")||0;if("number"===typeof f&&(f=[f,f]),null!=c){"string"===typeof c&&(c=[c,c]),"string"!==typeof d&&"number"!==typeof d||(d=[d,d]);var h=d[0],p=d[1];s([{rotate:e.rotation+Math.PI/2,offset:f[0],r:0},{rotate:e.rotation-Math.PI/2,offset:f[1],r:Math.sqrt((r[0]-a[0])*(r[0]-a[0])+(r[1]-a[1])*(r[1]-a[1]))}],function(t,n){if("none"!==c[n]&&null!=c[n]){var i=g(c[n],-h/2,-p/2,h,p,l.stroke,!0),a=t.r+t.offset,o=[r[0]+a*Math.cos(e.rotation),r[1]-a*Math.sin(e.rotation)];i.attr({rotation:t.rotate,position:o,silent:!0}),this.group.add(i)}},this)}}},axisTickLabel:function(){var e=this.axisModel,t=this.opt,n=D(this,e,t),i=k(this,e,t);I(e,i,n)},axisName:function(){var e=this.opt,t=this.axisModel,n=r(e.axisName,t.get("name"));if(n){var i,a,s=t.get("nameLocation"),c=e.nameDirection,d=t.getModel("nameTextStyle"),f=t.get("nameGap")||0,h=this.axisModel.axis.getExtent(),p=h[0]>h[1]?-1:1,g=["start"===s?h[0]-p*f:"end"===s?h[1]+p*f:(h[0]+h[1])/2,C(s)?e.labelOffset+c*f:0],m=t.get("nameRotate");null!=m&&(m=m*_/180),C(s)?i=S(e.rotation,null!=m?m:e.rotation,c):(i=w(e,s,m||0,h),a=e.axisNameAvailableWidth,null!=a&&(a=Math.abs(a/Math.sin(i.rotation)),!isFinite(a)&&(a=null)));var v=d.getFont(),y=t.get("nameTruncate",!0)||{},E=y.ellipsis,T=r(e.nameTruncateMaxWidth,y.maxWidth,a),I=null!=E&&null!=T?l.truncateText(n,T,v,E,{minChar:2,placeholder:y.placeholder}):n,x=t.get("tooltip",!0),R=t.mainType,D={componentType:R,name:n,$vars:["name"]};D[R+"Index"]=t.componentIndex;var k=new u.Text({anid:"name",__fullText:n,__truncatedText:I,position:g,rotation:i.rotation,silent:A(t),z2:1,tooltip:x&&x.show?o({content:n,formatter:function(){return n},formatterParams:D},x):null});u.setTextStyle(k.style,d,{text:I,textFont:v,textFill:d.getTextColor()||t.get("axisLine.lineStyle.color"),textAlign:i.textAlign,textVerticalAlign:i.textVerticalAlign}),t.get("triggerEvent")&&(k.eventData=b(t),k.eventData.targetType="axisName",k.eventData.name=n),this._dumbGroup.add(k),k.updateTransform(),this.group.add(k),k.decomposeTransform()}}},S=E.innerTextLayout=function(e,t,n){var i,r,a=h(t-e);return f(a)?(r=n>0?"top":"bottom",i="center"):f(a-_)?(r=n>0?"bottom":"top",i="center"):(r="middle",i=a>0&&a<_?n>0?"right":"left":n>0?"left":"right"),{rotation:a,textAlign:i,textVerticalAlign:r}};function w(e,t,n,i){var r,a,o=h(n-e.rotation),s=i[0]>i[1],l="start"===t&&!s||"start"!==t&&s;return f(o-_/2)?(a=l?"bottom":"top",r="center"):f(o-1.5*_)?(a=l?"top":"bottom",r="center"):(a="middle",r=o<1.5*_&&o>_/2?l?"left":"right":l?"right":"left"),{rotation:o,textAlign:r,textVerticalAlign:a}}function A(e){var t=e.get("tooltip");return e.get("silent")||!(e.get("triggerEvent")||t&&t.show)}function I(e,t,n){var i=e.get("axisLabel.showMinLabel"),r=e.get("axisLabel.showMaxLabel");t=t||[],n=n||[];var a=t[0],o=t[1],s=t[t.length-1],l=t[t.length-2],u=n[0],c=n[1],d=n[n.length-1],f=n[n.length-2];!1===i?(x(a),x(u)):R(a,o)&&(i?(x(o),x(c)):(x(a),x(u))),!1===r?(x(s),x(d)):R(l,s)&&(r?(x(l),x(f)):(x(s),x(d)))}function x(e){e&&(e.ignore=!0)}function R(e,t,n){var i=e&&e.getBoundingRect().clone(),r=t&&t.getBoundingRect().clone();if(i&&r){var a=m.identity([]);return m.rotate(a,a,-e.rotation),i.applyTransform(m.mul([],a,e.getLocalTransform())),r.applyTransform(m.mul([],a,t.getLocalTransform())),i.intersect(r)}}function C(e){return"middle"===e||"center"===e}function D(e,t,n){var i=t.axis;if(t.get("axisTick.show")&&!i.scale.isBlank()){for(var r=t.getModel("axisTick"),o=r.getModel("lineStyle"),s=r.get("length"),l=i.getTicksCoords(),c=[],d=[],f=e._transform,h=[],p=0;p<l.length;p++){var g=l[p].coord;c[0]=g,c[1]=0,d[0]=g,d[1]=n.tickDirection*s,f&&(y(c,c,f),y(d,d,f));var m=new u.Line(u.subPixelOptimizeLine({anid:"tick_"+l[p].tickValue,shape:{x1:c[0],y1:c[1],x2:d[0],y2:d[1]},style:a(o.getLineStyle(),{stroke:t.get("axisLine.lineStyle.color")}),z2:2,silent:!0}));e.group.add(m),h.push(m)}return h}}function k(e,t,n){var i=t.axis,a=r(n.axisLabelShow,t.get("axisLabel.show"));if(a&&!i.scale.isBlank()){var o=t.getModel("axisLabel"),l=o.get("margin"),d=i.getViewLabels(),f=(r(n.labelRotate,o.get("rotate"))||0)*_/180,h=S(n.rotation,f,n.labelDirection),p=t.getCategories(!0),g=[],m=A(t),v=t.get("triggerEvent");return s(d,function(r,a){var s=r.tickValue,d=r.formattedLabel,f=r.rawLabel,y=o;p&&p[s]&&p[s].textStyle&&(y=new c(p[s].textStyle,o,t.ecModel));var _=y.getTextColor()||t.get("axisLine.lineStyle.color"),E=i.dataToCoord(s),T=[E,n.labelOffset+n.labelDirection*l],S=new u.Text({anid:"label_"+s,position:T,rotation:h.rotation,silent:m,z2:10});u.setTextStyle(S.style,y,{text:d,textAlign:y.getShallow("align",!0)||h.textAlign,textVerticalAlign:y.getShallow("verticalAlign",!0)||y.getShallow("baseline",!0)||h.textVerticalAlign,textFill:"function"===typeof _?_("category"===i.type?f:"value"===i.type?s+"":s,a):_}),v&&(S.eventData=b(t),S.eventData.targetType="axisLabel",S.eventData.value=f),e._dumbGroup.add(S),S.updateTransform(),g.push(S),e.group.add(S),S.decomposeTransform()}),g}}var M=E;e.exports=M},fb05:function(e,t,n){var i=n("6d8b"),r=i.each,a=i.isArray,o=i.isObject,s=n("26e1"),l=n("e0d3"),u=l.normalizeToArray;function c(e,t){t=t.split(",");for(var n=e,i=0;i<t.length;i++)if(n=n&&n[t[i]],null==n)break;return n}function d(e,t,n,i){t=t.split(",");for(var r,a=e,o=0;o<t.length-1;o++)r=t[o],null==a[r]&&(a[r]={}),a=a[r];(i||null==a[t[o]])&&(a[t[o]]=n)}function f(e){r(h,function(t){t[0]in e&&!(t[1]in e)&&(e[t[1]]=e[t[0]])})}var h=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],p=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"];function g(e,t){s(e,t),e.series=u(e.series),r(e.series,function(e){if(o(e)){var t=e.type;if("pie"!==t&&"gauge"!==t||null!=e.clockWise&&(e.clockwise=e.clockWise),"gauge"===t){var n=c(e,"pointer.color");null!=n&&d(e,"itemStyle.normal.color",n)}f(e)}}),e.dataRange&&(e.visualMap=e.dataRange),r(p,function(t){var n=e[t];n&&(a(n)||(n=[n]),r(n,function(e){f(e)}))})}e.exports=g},fc82:function(e,t,n){var i=n("4e08"),r=(i.__DEV__,n("6d8b")),a=n("1fab"),o=n("2306"),s=n("a4fe"),l=n("80f0"),u=r.curry,c=r.each,d=r.map,f=Math.min,h=Math.max,p=Math.pow,g=1e4,m=6,v=6,y="globalPan",_={w:[0,0],e:[0,1],n:[1,0],s:[1,1]},b={w:"ew",e:"ew",n:"ns",s:"ns",ne:"nesw",sw:"nesw",nw:"nwse",se:"nwse"},E={brushStyle:{lineWidth:2,stroke:"rgba(0,0,0,0.3)",fill:"rgba(0,0,0,0.1)"},transformable:!0,brushMode:"single",removeOnClick:!1},T=0;function S(e){a.call(this),this._zr=e,this.group=new o.Group,this._brushType,this._brushOption,this._panels,this._track=[],this._dragging,this._covers=[],this._creatingCover,this._creatingPanel,this._enableGlobalPan,this._uid="brushController_"+T++,this._handlers={},c(ne,function(e,t){this._handlers[t]=r.bind(e,this)},this)}function w(e,t){var n=e._zr;e._enableGlobalPan||s.take(n,y,e._uid),c(e._handlers,function(e,t){n.on(t,e)}),e._brushType=t.brushType,e._brushOption=r.merge(r.clone(E),t,!0)}function A(e){var t=e._zr;s.release(t,y,e._uid),c(e._handlers,function(e,n){t.off(n,e)}),e._brushType=e._brushOption=null}function I(e,t){var n=re[t.brushType].createCover(e,t);return n.__brushOption=t,C(n,t),e.group.add(n),n}function x(e,t){var n=k(t);return n.endCreating&&(n.endCreating(e,t),C(t,t.__brushOption)),t}function R(e,t){var n=t.__brushOption;k(t).updateCoverShape(e,t,n.range,n)}function C(e,t){var n=t.z;null==n&&(n=g),e.traverse(function(e){e.z=n,e.z2=n})}function D(e,t){k(t).updateCommon(e,t),R(e,t)}function k(e){return re[e.__brushOption.brushType]}function M(e,t,n){var i,r=e._panels;if(!r)return!0;var a=e._transform;return c(r,function(e){e.isTargetByCursor(t,n,a)&&(i=e)}),i}function L(e,t){var n=e._panels;if(!n)return!0;var i=t.__brushOption.panelId;return null==i||n[i]}function P(e){var t=e._covers,n=t.length;return c(t,function(t){e.group.remove(t)},e),t.length=0,!!n}function N(e,t){var n=d(e._covers,function(e){var t=e.__brushOption,n=r.clone(t.range);return{brushType:t.brushType,panelId:t.panelId,range:n}});e.trigger("brush",n,{isEnd:!!t.isEnd,removeOnClick:!!t.removeOnClick})}function O(e){var t=e._track;if(!t.length)return!1;var n=t[t.length-1],i=t[0],r=n[0]-i[0],a=n[1]-i[1],o=p(r*r+a*a,.5);return o>m}function F(e){var t=e.length-1;return t<0&&(t=0),[e[0],e[t]]}function U(e,t,n,i){var r=new o.Group;return r.add(new o.Rect({name:"main",style:V(n),silent:!0,draggable:!0,cursor:"move",drift:u(e,t,r,"nswe"),ondragend:u(N,t,{isEnd:!0})})),c(i,function(n){r.add(new o.Rect({name:n,style:{opacity:0},draggable:!0,silent:!0,invisible:!0,drift:u(e,t,r,n),ondragend:u(N,t,{isEnd:!0})}))}),r}function B(e,t,n,i){var r=i.brushStyle.lineWidth||0,a=h(r,v),o=n[0][0],s=n[1][0],l=o-r/2,u=s-r/2,c=n[0][1],d=n[1][1],f=c-a+r/2,p=d-a+r/2,g=c-o,m=d-s,y=g+r,_=m+r;j(e,t,"main",o,s,g,m),i.transformable&&(j(e,t,"w",l,u,a,_),j(e,t,"e",f,u,a,_),j(e,t,"n",l,u,y,a),j(e,t,"s",l,p,y,a),j(e,t,"nw",l,u,a,a),j(e,t,"ne",f,u,a,a),j(e,t,"sw",l,p,a,a),j(e,t,"se",f,p,a,a))}function G(e,t){var n=t.__brushOption,i=n.transformable,r=t.childAt(0);r.useStyle(V(n)),r.attr({silent:!i,cursor:i?"move":"default"}),c(["w","e","n","s","se","sw","ne","nw"],function(n){var r=t.childOfName(n),a=z(e,n);r&&r.attr({silent:!i,invisible:!i,cursor:i?b[a]+"-resize":null})})}function j(e,t,n,i,r,a,o){var s=t.childOfName(n);s&&s.setShape($(W(e,t,[[i,r],[i+a,r+o]])))}function V(e){return r.defaults({strokeNoScale:!0},e.brushStyle)}function H(e,t,n,i){var r=[f(e,n),f(t,i)],a=[h(e,n),h(t,i)];return[[r[0],a[0]],[r[1],a[1]]]}function K(e){return o.getTransform(e.group)}function z(e,t){if(t.length>1){t=t.split("");var n=[z(e,t[0]),z(e,t[1])];return("e"===n[0]||"w"===n[0])&&n.reverse(),n.join("")}var i={w:"left",e:"right",n:"top",s:"bottom"},r={left:"w",right:"e",top:"n",bottom:"s"};n=o.transformDirection(i[t],K(e));return r[n]}function Z(e,t,n,i,r,a,o,s){var l=i.__brushOption,u=e(l.range),d=Y(n,a,o);c(r.split(""),function(e){var t=_[e];u[t[0]][t[1]]+=d[t[0]]}),l.range=t(H(u[0][0],u[1][0],u[0][1],u[1][1])),D(n,i),N(n,{isEnd:!1})}function q(e,t,n,i,r){var a=t.__brushOption.range,o=Y(e,n,i);c(a,function(e){e[0]+=o[0],e[1]+=o[1]}),D(e,t),N(e,{isEnd:!1})}function Y(e,t,n){var i=e.group,r=i.transformCoordToLocal(t,n),a=i.transformCoordToLocal(0,0);return[r[0]-a[0],r[1]-a[1]]}function W(e,t,n){var i=L(e,t);return i&&!0!==i?i.clipPath(n,e._transform):r.clone(n)}function $(e){var t=f(e[0][0],e[1][0]),n=f(e[0][1],e[1][1]),i=h(e[0][0],e[1][0]),r=h(e[0][1],e[1][1]);return{x:t,y:n,width:i-t,height:r-n}}function X(e,t,n){if(e._brushType){var i=e._zr,r=e._covers,a=M(e,t,n);if(!e._dragging)for(var o=0;o<r.length;o++){var s=r[o].__brushOption;if(a&&(!0===a||s.panelId===a.panelId)&&re[s.brushType].contain(r[o],n[0],n[1]))return}a&&i.setCursorStyle("crosshair")}}function Q(e){var t=e.event;t.preventDefault&&t.preventDefault()}function J(e,t,n){return e.childOfName("main").contain(t,n)}function ee(e,t,n,i){var a,o=e._creatingCover,s=e._creatingPanel,l=e._brushOption;if(e._track.push(n.slice()),O(e)||o){if(s&&!o){"single"===l.brushMode&&P(e);var u=r.clone(l);u.brushType=te(u.brushType,s),u.panelId=!0===s?null:s.panelId,o=e._creatingCover=I(e,u),e._covers.push(o)}if(o){var c=re[te(e._brushType,s)],d=o.__brushOption;d.range=c.getCreatingRange(W(e,o,e._track)),i&&(x(e,o),c.updateCommon(e,o)),R(e,o),a={isEnd:i}}}else i&&"single"===l.brushMode&&l.removeOnClick&&M(e,t,n)&&P(e)&&(a={isEnd:i,removeOnClick:!0});return a}function te(e,t){return"auto"===e?t.defaultBrushType:e}S.prototype={constructor:S,enableBrush:function(e){return this._brushType&&A(this),e.brushType&&w(this,e),this},setPanels:function(e){if(e&&e.length){var t=this._panels={};r.each(e,function(e){t[e.panelId]=r.clone(e)})}else this._panels=null;return this},mount:function(e){e=e||{},this._enableGlobalPan=e.enableGlobalPan;var t=this.group;return this._zr.add(t),t.attr({position:e.position||[0,0],rotation:e.rotation||0,scale:e.scale||[1,1]}),this._transform=t.getLocalTransform(),this},eachCover:function(e,t){c(this._covers,e,t)},updateCovers:function(e){e=r.map(e,function(e){return r.merge(r.clone(E),e,!0)});var t="\0-brush-index-",n=this._covers,i=this._covers=[],a=this,o=this._creatingCover;return new l(n,e,u,s).add(c).update(c).remove(d).execute(),this;function s(e,n){return(null!=e.id?e.id:t+n)+"-"+e.brushType}function u(e,t){return s(e.__brushOption,t)}function c(t,r){var s=e[t];if(null!=r&&n[r]===o)i[t]=n[r];else{var l=i[t]=null!=r?(n[r].__brushOption=s,n[r]):x(a,I(a,s));D(a,l)}}function d(e){n[e]!==o&&a.group.remove(n[e])}},unmount:function(){return this.enableBrush(!1),P(this),this._zr.remove(this.group),this},dispose:function(){this.unmount(),this.off()}},r.mixin(S,a);var ne={mousedown:function(e){if(this._dragging)ie.call(this,e);else if(!e.target||!e.target.draggable){Q(e);var t=this.group.transformCoordToLocal(e.offsetX,e.offsetY);this._creatingCover=null;var n=this._creatingPanel=M(this,e,t);n&&(this._dragging=!0,this._track=[t.slice()])}},mousemove:function(e){var t=this.group.transformCoordToLocal(e.offsetX,e.offsetY);if(X(this,e,t),this._dragging){Q(e);var n=ee(this,e,t,!1);n&&N(this,n)}},mouseup:ie};function ie(e){if(this._dragging){Q(e);var t=this.group.transformCoordToLocal(e.offsetX,e.offsetY),n=ee(this,e,t,!0);this._dragging=!1,this._track=[],this._creatingCover=null,n&&N(this,n)}}var re={lineX:ae(0),lineY:ae(1),rect:{createCover:function(e,t){return U(u(Z,function(e){return e},function(e){return e}),e,t,["w","e","n","s","se","sw","ne","nw"])},getCreatingRange:function(e){var t=F(e);return H(t[1][0],t[1][1],t[0][0],t[0][1])},updateCoverShape:function(e,t,n,i){B(e,t,n,i)},updateCommon:G,contain:J},polygon:{createCover:function(e,t){var n=new o.Group;return n.add(new o.Polyline({name:"main",style:V(t),silent:!0})),n},getCreatingRange:function(e){return e},endCreating:function(e,t){t.remove(t.childAt(0)),t.add(new o.Polygon({name:"main",draggable:!0,drift:u(q,e,t),ondragend:u(N,e,{isEnd:!0})}))},updateCoverShape:function(e,t,n,i){t.childAt(0).setShape({points:W(e,t,n)})},updateCommon:G,contain:J}};function ae(e){return{createCover:function(t,n){return U(u(Z,function(t){var n=[t,[0,100]];return e&&n.reverse(),n},function(t){return t[e]}),t,n,[["w","e"],["n","s"]][e])},getCreatingRange:function(t){var n=F(t),i=f(n[0][e],n[1][e]),r=h(n[0][e],n[1][e]);return[i,r]},updateCoverShape:function(t,n,i,r){var a,o=L(t,n);if(!0!==o&&o.getLinearBrushOtherExtent)a=o.getLinearBrushOtherExtent(e,t._transform);else{var s=t._zr;a=[0,[s.getWidth(),s.getHeight()][1-e]]}var l=[i,a];e&&l.reverse(),B(t,n,l,r)},updateCommon:G,contain:J}}var oe=S;e.exports=oe},fd63:function(e,t,n){var i=n("42e5"),r={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){var n=e.getData(),r=(e.visualColorAccessPath||"itemStyle.color").split("."),a=e.get(r)||e.getColorFromPalette(e.name,null,t.getSeriesCount());if(n.setVisual("color",a),!t.isSeriesFiltered(e)){"function"!==typeof a||a instanceof i||n.each(function(t){n.setItemVisual(t,"color",a(e.getDataParams(t)))});var o=function(e,t){var n=e.getItemModel(t),i=n.get(r,!0);null!=i&&e.setItemVisual(t,"color",i)};return{dataEach:n.hasItemOption?o:null}}}};e.exports=r},fdde:function(e,t){var n={average:function(e){for(var t=0,n=0,i=0;i<e.length;i++)isNaN(e[i])||(t+=e[i],n++);return 0===n?NaN:t/n},sum:function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n]||0;return t},max:function(e){for(var t=-1/0,n=0;n<e.length;n++)e[n]>t&&(t=e[n]);return isFinite(t)?t:NaN},min:function(e){for(var t=1/0,n=0;n<e.length;n++)e[n]<t&&(t=e[n]);return isFinite(t)?t:NaN},nearest:function(e){return e[0]}},i=function(e,t){return Math.round(e.length/2)};function r(e){return{seriesType:e,modifyOutputEnd:!0,reset:function(e,t,r){var a=e.getData(),o=e.get("sampling"),s=e.coordinateSystem;if("cartesian2d"===s.type&&o){var l,u=s.getBaseAxis(),c=s.getOtherAxis(u),d=u.getExtent(),f=d[1]-d[0],h=Math.round(a.count()/f);if(h>1)"string"===typeof o?l=n[o]:"function"===typeof o&&(l=o),l&&e.setData(a.downSample(a.mapDimension(c.dim),1/h,l,i))}}}}e.exports=r},fdef:function(e,t){e.exports="\t\n\v\f\r \u2028\u2029\ufeff"},fe21:function(e,t,n){var i=n("e86a"),r=n("2306"),a=["textStyle","color"],o={getTextColor:function(e){var t=this.ecModel;return this.getShallow("color")||(!e&&t?t.get(a):null)},getFont:function(){return r.getFont({fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},this.ecModel)},getTextRect:function(e){return i.getBoundingRect(e,this.getFont(),this.getShallow("align"),this.getShallow("verticalAlign")||this.getShallow("baseline"),this.getShallow("padding"),this.getShallow("rich"),this.getShallow("truncateText"))}};e.exports=o},ff2e:function(e,t,n){var i=n("6d8b"),r=n("2306"),a=n("e86a"),o=n("eda2"),s=n("1687"),l=n("697e"),u=n("fab22");function c(e){var t,n=e.get("type"),i=e.getModel(n+"Style");return"line"===n?(t=i.getLineStyle(),t.fill=null):"shadow"===n&&(t=i.getAreaStyle(),t.stroke=null),t}function d(e,t,n,i,r){var s=n.get("value"),l=h(s,t.axis,t.ecModel,n.get("seriesDataIndices"),{precision:n.get("label.precision"),formatter:n.get("label.formatter")}),u=n.getModel("label"),c=o.normalizeCssArray(u.get("padding")||0),d=u.getFont(),p=a.getBoundingRect(l,d),g=r.position,m=p.width+c[1]+c[3],v=p.height+c[0]+c[2],y=r.align;"right"===y&&(g[0]-=m),"center"===y&&(g[0]-=m/2);var _=r.verticalAlign;"bottom"===_&&(g[1]-=v),"middle"===_&&(g[1]-=v/2),f(g,m,v,i);var b=u.get("backgroundColor");b&&"auto"!==b||(b=t.get("axisLine.lineStyle.color")),e.label={shape:{x:0,y:0,width:m,height:v,r:u.get("borderRadius")},position:g.slice(),style:{text:l,textFont:d,textFill:u.getTextColor(),textPosition:"inside",fill:b,stroke:u.get("borderColor")||"transparent",lineWidth:u.get("borderWidth")||0,shadowBlur:u.get("shadowBlur"),shadowColor:u.get("shadowColor"),shadowOffsetX:u.get("shadowOffsetX"),shadowOffsetY:u.get("shadowOffsetY")},z2:10}}function f(e,t,n,i){var r=i.getWidth(),a=i.getHeight();e[0]=Math.min(e[0]+t,r)-t,e[1]=Math.min(e[1]+n,a)-n,e[0]=Math.max(e[0],0),e[1]=Math.max(e[1],0)}function h(e,t,n,r,a){e=t.scale.parse(e);var o=t.scale.getLabel(e,{precision:a.precision}),s=a.formatter;if(s){var u={value:l.getAxisRawValue(t,e),seriesData:[]};i.each(r,function(e){var t=n.getSeriesByIndex(e.seriesIndex),i=e.dataIndexInside,r=t&&t.getDataParams(i);r&&u.seriesData.push(r)}),i.isString(s)?o=s.replace("{value}",o):i.isFunction(s)&&(o=s(u))}return o}function p(e,t,n){var i=s.create();return s.rotate(i,i,n.rotation),s.translate(i,i,n.position),r.applyTransform([e.dataToCoord(t),(n.labelOffset||0)+(n.labelDirection||1)*(n.labelMargin||0)],i)}function g(e,t,n,i,r,a){var o=u.innerTextLayout(n.rotation,0,n.labelDirection);n.labelMargin=r.get("label.margin"),d(t,i,r,a,{position:p(i.axis,e,n),align:o.textAlign,verticalAlign:o.textVerticalAlign})}function m(e,t,n){return n=n||0,{x1:e[n],y1:e[1-n],x2:t[n],y2:t[1-n]}}function v(e,t,n){return n=n||0,{x:e[n],y:e[1-n],width:t[n],height:t[1-n]}}function y(e,t,n,i,r,a){return{cx:e,cy:t,r0:n,r:i,startAngle:r,endAngle:a,clockwise:!0}}t.buildElStyle=c,t.buildLabelElOption=d,t.getValueLabel=h,t.getTransformedPosition=p,t.buildCartesianSingleLabelElOption=g,t.makeLineShape=m,t.makeRectShape=v,t.makeSectorShape=y}}]);
//# sourceMappingURL=chunk-vendors.b744968d.js.map